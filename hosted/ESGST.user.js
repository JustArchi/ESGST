/* @preserve
// ==UserScript==
// @name Enhanced SteamGifts & SteamTrades fork by JustArchi (A-ESGST)
// @namespace https://SquishedPotatoe.github.io/esgst
// @description Enhances SteamGifts and SteamTrades by adding some cool features to them.
// @icon https://github.com/JustArchi/ESGST/raw/master/src/assets/images/icon.png
// @version 8.10.7
// @author rafaelgomesxyz
// @contributor Revadike
// @updateURL https://github.com/JustArchi/ESGST/raw/master/hosted/ESGST.meta.js
// @downloadURL https://github.com/JustArchi/ESGST/raw/master/hosted/ESGST.user.js
// @match https://www.steamgifts.com/*
// @match https://www.steamtrades.com/*
// @connect steamtrades.com
// @connect steamgifts.com
// @connect sgtools.info
// @connect api.dropboxapi.com
// @connect api.imgur.com
// @connect api.steampowered.com
// @connect content.dropboxapi.com
// @connect files.1drv.com
// @connect github.com
// @connect googleapis.com
// @connect graph.microsoft.com
// @connect isthereanydeal.com
// @connect esgst.rafaelgomes.xyz
// @connect raw.githubusercontent.com
// @connect script.google.com
// @connect script.googleusercontent.com
// @connect steam-tracker.com
// @connect steamcommunity.com
// @connect store.steampowered.com
// @connect userstyles.org
// @grant GM_addValueChangeListener
// @grant GM_deleteValue
// @grant GM_getValue
// @grant GM_info
// @grant GM_listValues
// @grant GM_setValue
// @grant GM_xmlhttpRequest
// @grant GM_openInTab
// @grant GM_getResourceURL
// @grant GM.addValueChangeListener
// @grant GM.deleteValue
// @grant GM.getValue
// @grant GM.info
// @grant GM.listValues
// @grant GM.setValue
// @grant GM.xmlHttpRequest
// @grant GM.openInTab
// @grant GM.getResourceUrl
// @require https://greasemonkey.github.io/gm4-polyfill/gm4-polyfill.js
// @require https://cdn.jsdelivr.net/npm/interactjs@1.10.27/dist/interact.min.js
// @require https://cdn.jsdelivr.net/npm/jquery@3.7.1/dist/jquery.min.js
// @require https://cdn.jsdelivr.net/npm/jQuery-QueryBuilder@3.0.0/dist/js/query-builder.standalone.js
// @require https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/js/bootstrap.min.js
// @require https://cdn.jsdelivr.net/npm/jquery-ui@1.14.1/dist/jquery-ui.min.js
// @require https://cdn.jsdelivr.net/npm/jszip@3.2.2/dist/jszip.min.js
// @require https://cdn.jsdelivr.net/gh/rossengeorgiev/vdf-parser@0d210ec51a2be4d6186777addf8f98df59f9eb53/vdf.js
// @require https://cdn.jsdelivr.net/npm/emojis-utils@1.0.2/dist/emojis-utils.min.js
// @resource awesome-bootstrap-checkbox https://cdn.jsdelivr.net/npm/awesome-bootstrap-checkbox@2.0.1/awesome-bootstrap-checkbox.css
// @resource jquery-query-builder https://cdn.jsdelivr.net/npm/jQuery-QueryBuilder@3.0.0/dist/css/query-builder.default.min.css
// @run-at document-start
// @noframes
// ==/UserScript==
*/!function(e){var t={};function s(n){if(t[n])return t[n].exports;var a=t[n]={i:n,l:!1,exports:{}};return e[n].call(a.exports,a,a.exports,s),a.l=!0,a.exports}s.m=e,s.c=t,s.d=function(e,t,n){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},s.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(s.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)s.d(n,a,function(t){return e[t]}.bind(null,a));return n},s.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="",s(s.s=116)}([function(e,t,s){var n=s(131);e.exports=function(e,t,s){return(t=n(t))in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e},e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t,s){"use strict";var n=s(32),a=s(42),i=s(35),o=s(22),r=s(18).f,l=s(81),c=s(59),d=s(33),g=s(10),u=o.set,m=o.getterFor("Array Iterator");e.exports=l(Array,"Array",(function(e,t){u(this,{type:"Array Iterator",target:n(e),index:0,kind:t})}),(function(){var e=m(this),t=e.target,s=e.index++;if(!t||s>=t.length)return e.target=null,c(void 0,!0);switch(e.kind){case"keys":return c(s,!1);case"values":return c(t[s],!1)}return c([s,t[s]],!1)}),"values");var h=i.Arguments=i.Array;if(a("keys"),a("values"),a("entries"),!d&&g&&"values"!==h.name)try{r(h,"name",{value:"values"})}catch(e){}},function(e,t,s){"use strict";var n=s(8),a=s(129),i=s(130),o=s(1),r=s(25),l=s(37),c=s(11)("iterator"),d=o.values,g=function(e,t){if(e){if(e[c]!==d)try{r(e,c,d)}catch(t){e[c]=d}if(l(e,t,!0),a[t])for(var s in o)if(e[s]!==o[s])try{r(e,s,o[s])}catch(t){e[s]=o[s]}}};for(var u in a)g(n[u]&&n[u].prototype,u);g(i,"DOMTokenList")},function(e,t,s){"use strict";var n=s(16),a=s(60);n({target:"RegExp",proto:!0,forced:/./.exec!==a},{exec:a})},function(e,t,s){"use strict";var n=s(139),a=s(13),i=s(6),o=s(140),r=s(7),l=s(17),c=s(9),d=s(15),g=s(34),u=s(80),m=s(21),h=s(27),p=s(141),f=s(44),b=s(142),w=s(93),y=s(143),v=s(11)("replace"),_=Math.max,k=Math.min,x=i([].concat),A=i([].push),C=i("".indexOf),S=i("".slice),E="$0"==="a".replace(/./,"$0"),T=!!/./[v]&&""===/./[v]("a","$0");o("replace",(function(e,t,s){var i=T?"$":"$0";return[function(e,s){var n=h(this),i=d(e)?f(e,v):void 0;return i?a(i,e,n,s):a(t,m(n),e,s)},function(e,a){var o=l(this),r=m(e);if("string"==typeof a&&-1===C(a,i)&&-1===C(a,"$<")){var d=s(t,o,r,a);if(d.done)return d.value}var h=c(a);h||(a=m(a));var f,v=m(w(o)),E=-1!==C(v,"g");E&&(f=-1!==C(v,"u"),o.lastIndex=0);for(var T,N=[];null!==(T=y(o,r))&&(A(N,T),E);){""===m(T[0])&&(o.lastIndex=p(r,u(o.lastIndex),f))}for(var P,L="",I=0,B=0;B<N.length;B++){for(var D,G=m((T=N[B])[0]),q=_(k(g(T.index),r.length),0),R=[],M=1;M<T.length;M++)A(R,void 0===(P=T[M])?P:String(P));var O=T.groups;if(h){var U=x([G],R,q,r);void 0!==O&&A(U,O),D=m(n(a,void 0,U))}else D=b(G,r,q,R,O,a);q>=I&&(L+=S(r,I,q)+D,I=q+G.length)}return L+S(r,I)}]}),!!r((function(){var e=/./;return e.exec=function(){var e=[];return e.groups={a:"7"},e},"7"!=="".replace(e,"$<a>")}))||!E||T)},function(e,t,s){"use strict";var n=s(16),a=s(10),i=s(8),o=s(6),r=s(14),l=s(9),c=s(24),d=s(21),g=s(39),u=s(86),m=i.Symbol,h=m&&m.prototype;if(a&&l(m)&&(!("description"in h)||void 0!==m().description)){var p={},f=function(){var e=arguments.length<1||void 0===arguments[0]?void 0:d(arguments[0]),t=c(h,this)?new m(e):void 0===e?m():m(e);return""===e&&(p[t]=!0),t};u(f,m),f.prototype=h,h.constructor=f;var b="Symbol(description detection)"===String(m("description detection")),w=o(h.valueOf),y=o(h.toString),v=/^Symbol\((.*)\)[^)]+$/,_=o("".replace),k=o("".slice);g(h,"description",{configurable:!0,get:function(){var e=w(this);if(r(p,e))return"";var t=y(e),s=b?k(t,7,-1):_(t,v,"$1");return""===s?void 0:s}}),n({global:!0,constructor:!0,forced:!0},{Symbol:f})}},function(e,t,s){"use strict";var n=s(41),a=Function.prototype,i=a.call,o=n&&a.bind.bind(i,i);e.exports=n?o:function(e){return function(){return i.apply(e,arguments)}}},function(e,t,s){"use strict";e.exports=function(e){try{return!!e()}catch(e){return!0}}},function(e,t,s){"use strict";(function(t){var s=function(e){return e&&e.Math===Math&&e};e.exports=s("object"==typeof globalThis&&globalThis)||s("object"==typeof window&&window)||s("object"==typeof self&&self)||s("object"==typeof t&&t)||s("object"==typeof this&&this)||function(){return this}()||Function("return this")()}).call(this,s(117))},function(e,t,s){"use strict";var n="object"==typeof document&&document.all;e.exports=void 0===n&&void 0!==n?function(e){return"function"==typeof e||e===n}:function(e){return"function"==typeof e}},function(e,t,s){"use strict";var n=s(7);e.exports=!n((function(){return 7!==Object.defineProperty({},1,{get:function(){return 7}})[1]}))},function(e,t,s){"use strict";var n=s(8),a=s(48),i=s(14),o=s(51),r=s(69),l=s(71),c=n.Symbol,d=a("wks"),g=l?c.for||c:c&&c.withoutSetter||o;e.exports=function(e){return i(d,e)||(d[e]=r&&i(c,e)?c[e]:g("Symbol."+e)),d[e]}},function(e,t,s){"use strict";var n=s(10),a=s(8),i=s(6),o=s(89),r=s(133),l=s(25),c=s(28),d=s(87).f,g=s(24),u=s(134),m=s(21),h=s(93),p=s(95),f=s(137),b=s(20),w=s(7),y=s(14),v=s(22).enforce,_=s(138),k=s(11),x=s(96),A=s(97),C=k("match"),S=a.RegExp,E=S.prototype,T=a.SyntaxError,N=i(E.exec),P=i("".charAt),L=i("".replace),I=i("".indexOf),B=i("".slice),D=/^\?<[^\s\d!#%&*+<=>@^][^\s!#%&*+<=>@^]*>/,G=/a/g,q=/a/g,R=new S(G)!==G,M=p.MISSED_STICKY,O=p.UNSUPPORTED_Y,U=n&&(!R||M||x||A||w((function(){return q[C]=!1,S(G)!==G||S(q)===q||"/a/i"!==String(S(G,"i"))})));if(o("RegExp",U)){for(var F=function(e,t){var s,n,a,i,o,d,p=g(E,this),f=u(e),b=void 0===t,w=[],_=e;if(!p&&f&&b&&e.constructor===F)return e;if((f||g(E,e))&&(e=e.source,b&&(t=h(_))),e=void 0===e?"":m(e),t=void 0===t?"":m(t),_=e,x&&"dotAll"in G&&(n=!!t&&I(t,"s")>-1)&&(t=L(t,/s/g,"")),s=t,M&&"sticky"in G&&(a=!!t&&I(t,"y")>-1)&&O&&(t=L(t,/y/g,"")),A&&(e=(i=function(e){for(var t,s=e.length,n=0,a="",i=[],o=c(null),r=!1,l=!1,d=0,g="";n<s;n++){if("\\"===(t=P(e,n)))t+=P(e,++n);else if("]"===t)r=!1;else if(!r)switch(!0){case"["===t:r=!0;break;case"("===t:if(a+=t,"?:"===B(e,n+1,n+3))continue;N(D,B(e,n+1))&&(n+=2,l=!0),d++;continue;case">"===t&&l:if(""===g||y(o,g))throw new T("Invalid capture group name");o[g]=!0,i[i.length]=[g,d],l=!1,g="";continue}l?g+=t:a+=t}return[a,i]}(e))[0],w=i[1]),o=r(S(e,t),p?this:E,F),(n||a||w.length)&&(d=v(o),n&&(d.dotAll=!0,d.raw=F(function(e){for(var t,s=e.length,n=0,a="",i=!1;n<s;n++)"\\"!==(t=P(e,n))?i||"."!==t?("["===t?i=!0:"]"===t&&(i=!1),a+=t):a+="[\\s\\S]":a+=t+P(e,++n);return a}(e),s)),a&&(d.sticky=!0),w.length&&(d.groups=w)),e!==_)try{l(o,"source",""===_?"(?:)":_)}catch(e){}return o},$=d(S),W=0;$.length>W;)f(F,S,$[W++]);E.constructor=F,F.prototype=E,b(a,"RegExp",F,{constructor:!0})}_("RegExp")},function(e,t,s){"use strict";var n=s(41),a=Function.prototype.call;e.exports=n?a.bind(a):function(){return a.apply(a,arguments)}},function(e,t,s){"use strict";var n=s(6),a=s(23),i=n({}.hasOwnProperty);e.exports=Object.hasOwn||function(e,t){return i(a(e),t)}},function(e,t,s){"use strict";var n=s(9);e.exports=function(e){return"object"==typeof e?null!==e:n(e)}},function(e,t,s){"use strict";var n=s(8),a=s(82).f,i=s(25),o=s(20),r=s(50),l=s(86),c=s(89);e.exports=function(e,t){var s,d,g,u,m,h=e.target,p=e.global,f=e.stat;if(s=p?n:f?n[h]||r(h,{}):n[h]&&n[h].prototype)for(d in t){if(u=t[d],g=e.dontCallGetSet?(m=a(s,d))&&m.value:s[d],!c(p?d:h+(f?".":"#")+d,e.forced)&&void 0!==g){if(typeof u==typeof g)continue;l(u,g)}(e.sham||g&&g.sham)&&i(u,"sham",!0),o(s,d,u,e)}}},function(e,t,s){"use strict";var n=s(15),a=String,i=TypeError;e.exports=function(e){if(n(e))return e;throw new i(a(e)+" is not an object")}},function(e,t,s){"use strict";var n=s(10),a=s(73),i=s(72),o=s(17),r=s(74),l=TypeError,c=Object.defineProperty,d=Object.getOwnPropertyDescriptor;t.f=n?i?function(e,t,s){if(o(e),t=r(t),o(s),"function"==typeof e&&"prototype"===t&&"value"in s&&"writable"in s&&!s.writable){var n=d(e,t);n&&n.writable&&(e[t]=s.value,s={configurable:"configurable"in s?s.configurable:n.configurable,enumerable:"enumerable"in s?s.enumerable:n.enumerable,writable:!1})}return c(e,t,s)}:c:function(e,t,s){if(o(e),t=r(t),o(s),a)try{return c(e,t,s)}catch(e){}if("get"in s||"set"in s)throw new l("Accessors not supported");return"value"in s&&(e[t]=s.value),e}},function(e,t,s){"use strict";var n=s(16),a=s(78).includes,i=s(7),o=s(42);n({target:"Array",proto:!0,forced:i((function(){return!Array(1).includes()}))},{includes:function(e){return a(this,e,arguments.length>1?arguments[1]:void 0)}}),o("includes")},function(e,t,s){"use strict";var n=s(9),a=s(18),i=s(84),o=s(50);e.exports=function(e,t,s,r){r||(r={});var l=r.enumerable,c=void 0!==r.name?r.name:t;if(n(s)&&i(s,c,r),r.global)l?e[t]=s:o(t,s);else{try{r.unsafe?e[t]&&(l=!0):delete e[t]}catch(e){}l?e[t]=s:a.f(e,t,{value:s,enumerable:!1,configurable:!r.nonConfigurable,writable:!r.nonWritable})}return e}},function(e,t,s){"use strict";var n=s(38),a=String;e.exports=function(e){if("Symbol"===n(e))throw new TypeError("Cannot convert a Symbol value to a string");return a(e)}},function(e,t,s){"use strict";var n,a,i,o=s(123),r=s(8),l=s(15),c=s(25),d=s(14),g=s(49),u=s(55),m=s(53),h=r.TypeError,p=r.WeakMap;if(o||g.state){var f=g.state||(g.state=new p);f.get=f.get,f.has=f.has,f.set=f.set,n=function(e,t){if(f.has(e))throw new h("Object already initialized");return t.facade=e,f.set(e,t),t},a=function(e){return f.get(e)||{}},i=function(e){return f.has(e)}}else{var b=u("state");m[b]=!0,n=function(e,t){if(d(e,b))throw new h("Object already initialized");return t.facade=e,c(e,b,t),t},a=function(e){return d(e,b)?e[b]:{}},i=function(e){return d(e,b)}}e.exports={set:n,get:a,has:i,enforce:function(e){return i(e)?a(e):n(e,{})},getterFor:function(e){return function(t){var s;if(!l(t)||(s=a(t)).type!==e)throw new h("Incompatible receiver, "+e+" required");return s}}}},function(e,t,s){"use strict";var n=s(27),a=Object;e.exports=function(e){return a(n(e))}},function(e,t,s){"use strict";var n=s(6);e.exports=n({}.isPrototypeOf)},function(e,t,s){"use strict";var n=s(10),a=s(18),i=s(36);e.exports=n?function(e,t,s){return a.f(e,t,i(1,s))}:function(e,t,s){return e[t]=s,e}},function(e,t,s){"use strict";var n=s(6),a=n({}.toString),i=n("".slice);e.exports=function(e){return i(a(e),8,-1)}},function(e,t,s){"use strict";var n=s(47),a=TypeError;e.exports=function(e){if(n(e))throw new a("Can't call method on "+e);return e}},function(e,t,s){"use strict";var n,a=s(17),i=s(118),o=s(54),r=s(53),l=s(122),c=s(52),d=s(55),g=d("IE_PROTO"),u=function(){},m=function(e){return"<script>"+e+"<\/script>"},h=function(e){e.write(m("")),e.close();var t=e.parentWindow.Object;return e=null,t},p=function(){try{n=new ActiveXObject("htmlfile")}catch(e){}var e,t;p="undefined"!=typeof document?document.domain&&n?h(n):((t=c("iframe")).style.display="none",l.appendChild(t),t.src=String("javascript:"),(e=t.contentWindow.document).open(),e.write(m("document.F=Object")),e.close(),e.F):h(n);for(var s=o.length;s--;)delete p.prototype[o[s]];return p()};r[g]=!0,e.exports=Object.create||function(e,t){var s;return null!==e?(u.prototype=a(e),s=new u,u.prototype=null,s[g]=e):s=p(),void 0===t?s:i.f(s,t)}},function(e,t,s){"use strict";var n=s(8),a=s(9),i=function(e){return a(e)?e:void 0};e.exports=function(e,t){return arguments.length<2?i(n[e]):n[e]&&n[e][t]}},function(e,t,s){"use strict";var n=s(9),a=s(45),i=TypeError;e.exports=function(e){if(n(e))return e;throw new i(a(e)+" is not a function")}},function(e,t,s){"use strict";var n=s(80);e.exports=function(e){return n(e.length)}},function(e,t,s){"use strict";var n=s(68),a=s(27);e.exports=function(e){return n(a(e))}},function(e,t,s){"use strict";e.exports=!1},function(e,t,s){"use strict";var n=s(121);e.exports=function(e){var t=+e;return t!=t||0===t?0:n(t)}},function(e,t,s){"use strict";e.exports={}},function(e,t,s){"use strict";e.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},function(e,t,s){"use strict";var n=s(18).f,a=s(14),i=s(11)("toStringTag");e.exports=function(e,t,s){e&&!s&&(e=e.prototype),e&&!a(e,i)&&n(e,i,{configurable:!0,value:t})}},function(e,t,s){"use strict";var n=s(135),a=s(9),i=s(26),o=s(11)("toStringTag"),r=Object,l="Arguments"===i(function(){return arguments}());e.exports=n?i:function(e){var t,s,n;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(s=function(e,t){try{return e[t]}catch(e){}}(t=r(e),o))?s:l?i(t):"Object"===(n=i(t))&&a(t.callee)?"Arguments":n}},function(e,t,s){"use strict";var n=s(84),a=s(18);e.exports=function(e,t,s){return s.get&&n(s.get,t,{getter:!0}),s.set&&n(s.set,t,{setter:!0}),a.f(e,t,s)}},function(e,t,s){"use strict";var n=s(99),a=s(30),i=s(41),o=n(n.bind);e.exports=function(e,t){return a(e),void 0===t?e:i?o(e,t):function(){return e.apply(t,arguments)}}},function(e,t,s){"use strict";var n=s(7);e.exports=!n((function(){var e=function(){}.bind();return"function"!=typeof e||e.hasOwnProperty("prototype")}))},function(e,t,s){"use strict";var n=s(11),a=s(28),i=s(18).f,o=n("unscopables"),r=Array.prototype;void 0===r[o]&&i(r,o,{configurable:!0,value:a(null)}),e.exports=function(e){r[o][e]=!0}},function(e,t,s){"use strict";var n=s(8).navigator,a=n&&n.userAgent;e.exports=a?String(a):""},function(e,t,s){"use strict";var n=s(30),a=s(47);e.exports=function(e,t){var s=e[t];return a(s)?void 0:n(s)}},function(e,t,s){"use strict";var n=String;e.exports=function(e){try{return n(e)}catch(e){return"Object"}}},function(e,t,s){"use strict";var n=s(38),a=s(44),i=s(47),o=s(35),r=s(11)("iterator");e.exports=function(e){if(!i(e))return a(e,r)||a(e,"@@iterator")||o[n(e)]}},function(e,t,s){"use strict";e.exports=function(e){return null==e}},function(e,t,s){"use strict";var n=s(49);e.exports=function(e,t){return n[e]||(n[e]=t||{})}},function(e,t,s){"use strict";var n=s(33),a=s(8),i=s(50),o=e.exports=a["__core-js_shared__"]||i("__core-js_shared__",{});(o.versions||(o.versions=[])).push({version:"3.48.0",mode:n?"pure":"global",copyright:"© 2013–2025 Denis Pushkarev (zloirock.ru), 2025–2026 CoreJS Company (core-js.io). All rights reserved.",license:"https://github.com/zloirock/core-js/blob/v3.48.0/LICENSE",source:"https://github.com/zloirock/core-js"})},function(e,t,s){"use strict";var n=s(8),a=Object.defineProperty;e.exports=function(e,t){try{a(n,e,{value:t,configurable:!0,writable:!0})}catch(s){n[e]=t}return t}},function(e,t,s){"use strict";var n=s(6),a=0,i=Math.random(),o=n(1.1.toString);e.exports=function(e){return"Symbol("+(void 0===e?"":e)+")_"+o(++a+i,36)}},function(e,t,s){"use strict";var n=s(8),a=s(15),i=n.document,o=a(i)&&a(i.createElement);e.exports=function(e){return o?i.createElement(e):{}}},function(e,t,s){"use strict";e.exports={}},function(e,t,s){"use strict";e.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},function(e,t,s){"use strict";var n=s(48),a=s(51),i=n("keys");e.exports=function(e){return i[e]||(i[e]=a(e))}},function(e,t,s){"use strict";var n=s(10),a=s(14),i=Function.prototype,o=n&&Object.getOwnPropertyDescriptor,r=a(i,"name"),l=r&&"something"===function(){}.name,c=r&&(!n||n&&o(i,"name").configurable);e.exports={EXISTS:r,PROPER:l,CONFIGURABLE:c}},function(e,t,s){"use strict";var n=s(14),a=s(9),i=s(23),o=s(55),r=s(125),l=o("IE_PROTO"),c=Object,d=c.prototype;e.exports=r?c.getPrototypeOf:function(e){var t=i(e);if(n(t,l))return t[l];var s=t.constructor;return a(s)&&t instanceof s?s.prototype:t instanceof c?d:null}},function(e,t,s){"use strict";var n=s(126),a=s(15),i=s(27),o=s(127);e.exports=Object.setPrototypeOf||("__proto__"in{}?function(){var e,t=!1,s={};try{(e=n(Object.prototype,"__proto__","set"))(s,[]),t=s instanceof Array}catch(e){}return function(s,n){return i(s),o(n),a(s)?(t?e(s,n):s.__proto__=n,s):s}}():void 0)},function(e,t,s){"use strict";e.exports=function(e,t){return{value:e,done:t}}},function(e,t,s){"use strict";var n,a,i=s(13),o=s(6),r=s(21),l=s(94),c=s(95),d=s(48),g=s(28),u=s(22).get,m=s(96),h=s(97),p=d("native-string-replace",String.prototype.replace),f=RegExp.prototype.exec,b=f,w=o("".charAt),y=o("".indexOf),v=o("".replace),_=o("".slice),k=(a=/b*/g,i(f,n=/a/,"a"),i(f,a,"a"),0!==n.lastIndex||0!==a.lastIndex),x=c.BROKEN_CARET,A=void 0!==/()??/.exec("")[1];(k||A||x||m||h)&&(b=function(e){var t,s,n,a,o,c,d,m=this,h=u(m),C=r(e),S=h.raw;if(S)return S.lastIndex=m.lastIndex,t=i(b,S,C),m.lastIndex=S.lastIndex,t;var E=h.groups,T=x&&m.sticky,N=i(l,m),P=m.source,L=0,I=C;if(T&&(N=v(N,"y",""),-1===y(N,"g")&&(N+="g"),I=_(C,m.lastIndex),m.lastIndex>0&&(!m.multiline||m.multiline&&"\n"!==w(C,m.lastIndex-1))&&(P="(?: "+P+")",I=" "+I,L++),s=new RegExp("^(?:"+P+")",N)),A&&(s=new RegExp("^"+P+"$(?!\\s)",N)),k&&(n=m.lastIndex),a=i(f,T?s:m,I),T?a?(a.input=_(a.input,L),a[0]=_(a[0],L),a.index=m.lastIndex,m.lastIndex+=a[0].length):m.lastIndex=0:k&&a&&(m.lastIndex=m.global?a.index+a[0].length:n),A&&a&&a.length>1&&i(p,a[0],s,(function(){for(o=1;o<arguments.length-2;o++)void 0===arguments[o]&&(a[o]=void 0)})),a&&E)for(a.groups=c=g(null),o=0;o<E.length;o++)c[(d=E[o])[0]]=a[d[1]];return a}),e.exports=b},function(e,t,s){"use strict";var n=s(6),a=s(34),i=s(21),o=s(27),r=n("".charAt),l=n("".charCodeAt),c=n("".slice),d=function(e){return function(t,s){var n,d,g=i(o(t)),u=a(s),m=g.length;return u<0||u>=m?e?"":void 0:(n=l(g,u))<55296||n>56319||u+1===m||(d=l(g,u+1))<56320||d>57343?e?r(g,u):n:e?c(g,u,u+2):d-56320+(n-55296<<10)+65536}};e.exports={codeAt:d(!1),charAt:d(!0)}},function(e,t,s){"use strict";var n=s(13),a=s(30),i=s(17),o=s(45),r=s(46),l=TypeError;e.exports=function(e,t){var s=arguments.length<2?r(e):t;if(a(s))return i(n(s,e));throw new l(o(e)+" is not iterable")}},function(e,t,s){"use strict";var n=s(10),a=s(18),i=s(36);e.exports=function(e,t,s){n?a.f(e,t,i(0,s)):e[t]=s}},function(e,t,s){"use strict";var n=s(26);e.exports=Array.isArray||function(e){return"Array"===n(e)}},function(e,t,s){"use strict";var n=s(16),a=s(111),i=s(23),o=s(31),r=s(34),l=s(112);n({target:"Array",proto:!0},{flat:function(){var e=arguments.length?arguments[0]:void 0,t=i(this),s=o(t),n=l(t,0);return a(n,t,t,s,0,void 0===e?1:r(e)),n}})},function(e,t,s){"use strict";s(42)("flat")},function(e,t){function s(){return e.exports=s=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var n in s)({}).hasOwnProperty.call(s,n)&&(e[n]=s[n])}return e},e.exports.__esModule=!0,e.exports.default=e.exports,s.apply(null,arguments)}e.exports=s,e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t,s){"use strict";var n=s(6),a=s(7),i=s(26),o=Object,r=n("".split);e.exports=a((function(){return!o("z").propertyIsEnumerable(0)}))?function(e){return"String"===i(e)?r(e,""):o(e)}:o},function(e,t,s){"use strict";var n=s(70),a=s(7),i=s(8).String;e.exports=!!Object.getOwnPropertySymbols&&!a((function(){var e=Symbol("symbol detection");return!i(e)||!(Object(e)instanceof Symbol)||!Symbol.sham&&n&&n<41}))},function(e,t,s){"use strict";var n,a,i=s(8),o=s(43),r=i.process,l=i.Deno,c=r&&r.versions||l&&l.version,d=c&&c.v8;d&&(a=(n=d.split("."))[0]>0&&n[0]<4?1:+(n[0]+n[1])),!a&&o&&(!(n=o.match(/Edge\/(\d+)/))||n[1]>=74)&&(n=o.match(/Chrome\/(\d+)/))&&(a=+n[1]),e.exports=a},function(e,t,s){"use strict";var n=s(69);e.exports=n&&!Symbol.sham&&"symbol"==typeof Symbol.iterator},function(e,t,s){"use strict";var n=s(10),a=s(7);e.exports=n&&a((function(){return 42!==Object.defineProperty((function(){}),"prototype",{value:42,writable:!1}).prototype}))},function(e,t,s){"use strict";var n=s(10),a=s(7),i=s(52);e.exports=!n&&!a((function(){return 7!==Object.defineProperty(i("div"),"a",{get:function(){return 7}}).a}))},function(e,t,s){"use strict";var n=s(119),a=s(75);e.exports=function(e){var t=n(e,"string");return a(t)?t:t+""}},function(e,t,s){"use strict";var n=s(29),a=s(9),i=s(24),o=s(71),r=Object;e.exports=o?function(e){return"symbol"==typeof e}:function(e){var t=n("Symbol");return a(t)&&i(t.prototype,r(e))}},function(e,t,s){"use strict";var n=s(77),a=s(54);e.exports=Object.keys||function(e){return n(e,a)}},function(e,t,s){"use strict";var n=s(6),a=s(14),i=s(32),o=s(78).indexOf,r=s(53),l=n([].push);e.exports=function(e,t){var s,n=i(e),c=0,d=[];for(s in n)!a(r,s)&&a(n,s)&&l(d,s);for(;t.length>c;)a(n,s=t[c++])&&(~o(d,s)||l(d,s));return d}},function(e,t,s){"use strict";var n=s(32),a=s(79),i=s(31),o=function(e){return function(t,s,o){var r=n(t),l=i(r);if(0===l)return!e&&-1;var c,d=a(o,l);if(e&&s!=s){for(;l>d;)if((c=r[d++])!=c)return!0}else for(;l>d;d++)if((e||d in r)&&r[d]===s)return e||d||0;return!e&&-1}};e.exports={includes:o(!0),indexOf:o(!1)}},function(e,t,s){"use strict";var n=s(34),a=Math.max,i=Math.min;e.exports=function(e,t){var s=n(e);return s<0?a(s+t,0):i(s,t)}},function(e,t,s){"use strict";var n=s(34),a=Math.min;e.exports=function(e){var t=n(e);return t>0?a(t,9007199254740991):0}},function(e,t,s){"use strict";var n=s(16),a=s(13),i=s(33),o=s(56),r=s(9),l=s(90),c=s(57),d=s(58),g=s(37),u=s(25),m=s(20),h=s(11),p=s(35),f=s(91),b=o.PROPER,w=o.CONFIGURABLE,y=f.IteratorPrototype,v=f.BUGGY_SAFARI_ITERATORS,_=h("iterator"),k=function(){return this};e.exports=function(e,t,s,o,h,f,x){l(s,t,o);var A,C,S,E=function(e){if(e===h&&I)return I;if(!v&&e&&e in P)return P[e];switch(e){case"keys":case"values":case"entries":return function(){return new s(this,e)}}return function(){return new s(this)}},T=t+" Iterator",N=!1,P=e.prototype,L=P[_]||P["@@iterator"]||h&&P[h],I=!v&&L||E(h),B="Array"===t&&P.entries||L;if(B&&(A=c(B.call(new e)))!==Object.prototype&&A.next&&(i||c(A)===y||(d?d(A,y):r(A[_])||m(A,_,k)),g(A,T,!0,!0),i&&(p[T]=k)),b&&"values"===h&&L&&"values"!==L.name&&(!i&&w?u(P,"name","values"):(N=!0,I=function(){return a(L,this)})),h)if(C={values:E("values"),keys:f?I:E("keys"),entries:E("entries")},x)for(S in C)(v||N||!(S in P))&&m(P,S,C[S]);else n({target:t,proto:!0,forced:v||N},C);return i&&!x||P[_]===I||m(P,_,I,{name:h}),p[t]=I,C}},function(e,t,s){"use strict";var n=s(10),a=s(13),i=s(83),o=s(36),r=s(32),l=s(74),c=s(14),d=s(73),g=Object.getOwnPropertyDescriptor;t.f=n?g:function(e,t){if(e=r(e),t=l(t),d)try{return g(e,t)}catch(e){}if(c(e,t))return o(!a(i.f,e,t),e[t])}},function(e,t,s){"use strict";var n={}.propertyIsEnumerable,a=Object.getOwnPropertyDescriptor,i=a&&!n.call({1:2},1);t.f=i?function(e){var t=a(this,e);return!!t&&t.enumerable}:n},function(e,t,s){"use strict";var n=s(6),a=s(7),i=s(9),o=s(14),r=s(10),l=s(56).CONFIGURABLE,c=s(85),d=s(22),g=d.enforce,u=d.get,m=String,h=Object.defineProperty,p=n("".slice),f=n("".replace),b=n([].join),w=r&&!a((function(){return 8!==h((function(){}),"length",{value:8}).length})),y=String(String).split("String"),v=e.exports=function(e,t,s){"Symbol("===p(m(t),0,7)&&(t="["+f(m(t),/^Symbol\(([^)]*)\).*$/,"$1")+"]"),s&&s.getter&&(t="get "+t),s&&s.setter&&(t="set "+t),(!o(e,"name")||l&&e.name!==t)&&(r?h(e,"name",{value:t,configurable:!0}):e.name=t),w&&s&&o(s,"arity")&&e.length!==s.arity&&h(e,"length",{value:s.arity});try{s&&o(s,"constructor")&&s.constructor?r&&h(e,"prototype",{writable:!1}):e.prototype&&(e.prototype=void 0)}catch(e){}var n=g(e);return o(n,"source")||(n.source=b(y,"string"==typeof t?t:"")),e};Function.prototype.toString=v((function(){return i(this)&&u(this).source||c(this)}),"toString")},function(e,t,s){"use strict";var n=s(6),a=s(9),i=s(49),o=n(Function.toString);a(i.inspectSource)||(i.inspectSource=function(e){return o(e)}),e.exports=i.inspectSource},function(e,t,s){"use strict";var n=s(14),a=s(124),i=s(82),o=s(18);e.exports=function(e,t,s){for(var r=a(t),l=o.f,c=i.f,d=0;d<r.length;d++){var g=r[d];n(e,g)||s&&n(s,g)||l(e,g,c(t,g))}}},function(e,t,s){"use strict";var n=s(77),a=s(54).concat("length","prototype");t.f=Object.getOwnPropertyNames||function(e){return n(e,a)}},function(e,t,s){"use strict";t.f=Object.getOwnPropertySymbols},function(e,t,s){"use strict";var n=s(7),a=s(9),i=/#|\.prototype\./,o=function(e,t){var s=l[r(e)];return s===d||s!==c&&(a(t)?n(t):!!t)},r=o.normalize=function(e){return String(e).replace(i,".").toLowerCase()},l=o.data={},c=o.NATIVE="N",d=o.POLYFILL="P";e.exports=o},function(e,t,s){"use strict";var n=s(91).IteratorPrototype,a=s(28),i=s(36),o=s(37),r=s(35),l=function(){return this};e.exports=function(e,t,s,c){var d=t+" Iterator";return e.prototype=a(n,{next:i(+!c,s)}),o(e,d,!1,!0),r[d]=l,e}},function(e,t,s){"use strict";var n,a,i,o=s(7),r=s(9),l=s(15),c=s(28),d=s(57),g=s(20),u=s(11),m=s(33),h=u("iterator"),p=!1;[].keys&&("next"in(i=[].keys())?(a=d(d(i)))!==Object.prototype&&(n=a):p=!0),!l(n)||o((function(){var e={};return n[h].call(e)!==e}))?n={}:m&&(n=c(n)),r(n[h])||g(n,h,(function(){return this})),e.exports={IteratorPrototype:n,BUGGY_SAFARI_ITERATORS:p}},function(e,t){function s(t){return e.exports=s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e.exports.__esModule=!0,e.exports.default=e.exports,s(t)}e.exports=s,e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t,s){"use strict";var n=s(13),a=s(14),i=s(24),o=s(136),r=s(94),l=RegExp.prototype;e.exports=o.correct?function(e){return e.flags}:function(e){return o.correct||!i(l,e)||a(e,"flags")?e.flags:n(r,e)}},function(e,t,s){"use strict";var n=s(17);e.exports=function(){var e=n(this),t="";return e.hasIndices&&(t+="d"),e.global&&(t+="g"),e.ignoreCase&&(t+="i"),e.multiline&&(t+="m"),e.dotAll&&(t+="s"),e.unicode&&(t+="u"),e.unicodeSets&&(t+="v"),e.sticky&&(t+="y"),t}},function(e,t,s){"use strict";var n=s(7),a=s(8).RegExp,i=n((function(){var e=a("a","y");return e.lastIndex=2,null!==e.exec("abcd")})),o=i||n((function(){return!a("a","y").sticky})),r=i||n((function(){var e=a("^r","gy");return e.lastIndex=2,null!==e.exec("str")}));e.exports={BROKEN_CARET:r,MISSED_STICKY:o,UNSUPPORTED_Y:i}},function(e,t,s){"use strict";var n=s(7),a=s(8).RegExp;e.exports=n((function(){var e=a(".","s");return!(e.dotAll&&e.test("\n")&&"s"===e.flags)}))},function(e,t,s){"use strict";var n=s(7),a=s(8).RegExp;e.exports=n((function(){var e=a("(?<a>b)","g");return"b"!==e.exec("b").groups.a||"bc"!=="b".replace(e,"$<a>c")}))},function(e,t,s){"use strict";var n=s(16),a=s(144),i=s(63);n({target:"Object",stat:!0},{fromEntries:function(e){var t={};return a(e,(function(e,s){i(t,e,s)}),{AS_ENTRIES:!0}),t}})},function(e,t,s){"use strict";var n=s(26),a=s(6);e.exports=function(e){if("Function"===n(e))return a(e)}},function(e,t,s){"use strict";var n=s(11),a=s(35),i=n("iterator"),o=Array.prototype;e.exports=function(e){return void 0!==e&&(a.Array===e||o[i]===e)}},function(e,t,s){"use strict";var n=s(13),a=s(17),i=s(44);e.exports=function(e,t,s){var o,r;a(e);try{if(!(o=i(e,"return"))){if("throw"===t)throw s;return s}o=n(o,e)}catch(e){r=!0,o=e}if("throw"===t)throw s;if(r)throw o;return a(o),s}},function(e,t,s){"use strict";var n,a=function(){return void 0===n&&(n=Boolean(window&&document&&document.all&&!window.atob)),n},i=function(){var e={};return function(t){if(void 0===e[t]){var s=document.querySelector(t);if(window.HTMLIFrameElement&&s instanceof window.HTMLIFrameElement)try{s=s.contentDocument.head}catch(e){s=null}e[t]=s}return e[t]}}(),o=[];function r(e){for(var t=-1,s=0;s<o.length;s++)if(o[s].identifier===e){t=s;break}return t}function l(e,t){for(var s={},n=[],a=0;a<e.length;a++){var i=e[a],l=t.base?i[0]+t.base:i[0],c=s[l]||0,d="".concat(l," ").concat(c);s[l]=c+1;var g=r(d),u={css:i[1],media:i[2],sourceMap:i[3]};-1!==g?(o[g].references++,o[g].updater(u)):o.push({identifier:d,updater:f(u,t),references:1}),n.push(d)}return n}function c(e){var t=document.createElement("style"),n=e.attributes||{};if(void 0===n.nonce){var a=s.nc;a&&(n.nonce=a)}if(Object.keys(n).forEach((function(e){t.setAttribute(e,n[e])})),"function"==typeof e.insert)e.insert(t);else{var o=i(e.insert||"head");if(!o)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");o.appendChild(t)}return t}var d,g=(d=[],function(e,t){return d[e]=t,d.filter(Boolean).join("\n")});function u(e,t,s,n){var a=s?"":n.media?"@media ".concat(n.media," {").concat(n.css,"}"):n.css;if(e.styleSheet)e.styleSheet.cssText=g(t,a);else{var i=document.createTextNode(a),o=e.childNodes;o[t]&&e.removeChild(o[t]),o.length?e.insertBefore(i,o[t]):e.appendChild(i)}}function m(e,t,s){var n=s.css,a=s.media,i=s.sourceMap;if(a?e.setAttribute("media",a):e.removeAttribute("media"),i&&"undefined"!=typeof btoa&&(n+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(i))))," */")),e.styleSheet)e.styleSheet.cssText=n;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(n))}}var h=null,p=0;function f(e,t){var s,n,a;if(t.singleton){var i=p++;s=h||(h=c(t)),n=u.bind(null,s,i,!1),a=u.bind(null,s,i,!0)}else s=c(t),n=m.bind(null,s,t),a=function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(s)};return n(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap)return;n(e=t)}else a()}}e.exports=function(e,t){(t=t||{}).singleton||"boolean"==typeof t.singleton||(t.singleton=a());var s=l(e=e||[],t);return function(e){if(e=e||[],"[object Array]"===Object.prototype.toString.call(e)){for(var n=0;n<s.length;n++){var a=r(s[n]);o[a].references--}for(var i=l(e,t),c=0;c<s.length;c++){var d=r(s[c]);0===o[d].references&&(o[d].updater(),o.splice(d,1))}s=i}}}},function(e,t,s){"use strict";e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var s=function(e,t){var s=e[1]||"",n=e[3];if(!n)return s;if(t&&"function"==typeof btoa){var a=(o=n,r=btoa(unescape(encodeURIComponent(JSON.stringify(o)))),l="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(r),"/*# ".concat(l," */")),i=n.sources.map((function(e){return"/*# sourceURL=".concat(n.sourceRoot||"").concat(e," */")}));return[s].concat(i).concat([a]).join("\n")}var o,r,l;return[s].join("\n")}(t,e);return t[2]?"@media ".concat(t[2]," {").concat(s,"}"):s})).join("")},t.i=function(e,s,n){"string"==typeof e&&(e=[[null,e,""]]);var a={};if(n)for(var i=0;i<this.length;i++){var o=this[i][0];null!=o&&(a[o]=!0)}for(var r=0;r<e.length;r++){var l=[].concat(e[r]);n&&a[l[0]]||(s&&(l[2]?l[2]="".concat(s," and ").concat(l[2]):l[2]=s),t.push(l))}},t}},function(e,t,s){"use strict";var n=s(7),a=s(11),i=s(10),o=s(33),r=a("iterator");e.exports=!n((function(){var e=new URL("b?a=1&b=2&c=3","https://a"),t=e.searchParams,s=new URLSearchParams("a=1&a=2&b=3"),n="";return e.pathname="c%20d",t.forEach((function(e,s){t.delete("b"),n+=s+e})),s.delete("a",2),s.delete("b",void 0),o&&(!e.toJSON||!s.has("a",1)||s.has("a",2)||!s.has("a",void 0)||s.has("b"))||!t.size&&(o||!i)||!t.sort||"https://a/c%20d?a=1&c=3"!==e.href||"3"!==t.get("c")||"a=1"!==String(new URLSearchParams("?a=1"))||!t[r]||"a"!==new URL("https://a@b").username||"b"!==new URLSearchParams(new URLSearchParams("a=b")).get("a")||"xn--e1aybc"!==new URL("https://тест").host||"#%D0%B1"!==new URL("https://a#б").hash||"a1c3"!==n||"x"!==new URL("https://x",void 0).host}))},function(e,t,s){"use strict";var n=s(24),a=TypeError;e.exports=function(e,t){if(n(t,e))return e;throw new a("Incorrect invocation")}},function(e,t,s){"use strict";var n=s(6),a=s(7),i=s(9),o=s(38),r=s(29),l=s(85),c=function(){},d=r("Reflect","construct"),g=/^\s*(?:class|function)\b/,u=n(g.exec),m=!g.test(c),h=function(e){if(!i(e))return!1;try{return d(c,[],e),!0}catch(e){return!1}},p=function(e){if(!i(e))return!1;switch(o(e)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return m||!!u(g,l(e))}catch(e){return!0}};p.sham=!0,e.exports=!d||a((function(){var e;return h(h.call)||!h(Object)||!h((function(){e=!0}))||e}))?p:h},function(e,t,s){"use strict";var n=s(6);e.exports=n([].slice)},function(e,t,s){"use strict";var n=TypeError;e.exports=function(e,t){if(e<t)throw new n("Not enough arguments");return e}},function(e,t,s){"use strict";s(1),s(157);var n=s(16),a=s(8),i=s(158),o=s(29),r=s(13),l=s(6),c=s(10),d=s(104),g=s(20),u=s(39),m=s(159),h=s(37),p=s(90),f=s(22),b=s(105),w=s(9),y=s(14),v=s(40),_=s(38),k=s(17),x=s(15),A=s(21),C=s(28),S=s(36),E=s(62),T=s(46),N=s(59),P=s(108),L=s(11),I=s(110),B=L("iterator"),D=f.set,G=f.getterFor("URLSearchParams"),q=f.getterFor("URLSearchParamsIterator"),R=i("fetch"),M=i("Request"),O=i("Headers"),U=M&&M.prototype,F=O&&O.prototype,$=a.TypeError,W=a.encodeURIComponent,V=String.fromCharCode,j=o("String","fromCodePoint"),H=parseInt,J=l("".charAt),Y=l([].join),K=l([].push),z=l("".replace),Q=l([].shift),Z=l([].splice),X=l("".split),ee=l("".slice),te=l(/./.exec),se=/\+/g,ne=/^[0-9a-f]+$/i,ae=function(e,t){var s=ee(e,t,t+2);return te(ne,s)?H(s,16):NaN},ie=function(e){for(var t=0,s=128;s>0&&0!=(e&s);s>>=1)t++;return t},oe=function(e){var t=null;switch(e.length){case 1:t=e[0];break;case 2:t=(31&e[0])<<6|63&e[1];break;case 3:t=(15&e[0])<<12|(63&e[1])<<6|63&e[2];break;case 4:t=(7&e[0])<<18|(63&e[1])<<12|(63&e[2])<<6|63&e[3]}return t>1114111?null:t},re=function(e){for(var t=(e=z(e,se," ")).length,s="",n=0;n<t;){var a=J(e,n);if("%"===a){if("%"===J(e,n+1)||n+3>t){s+="%",n++;continue}var i=ae(e,n+1);if(i!=i){s+=a,n++;continue}n+=2;var o=ie(i);if(0===o)a=V(i);else{if(1===o||o>4){s+="�",n++;continue}for(var r=[i],l=1;l<o&&!(++n+3>t||"%"!==J(e,n));){var c=ae(e,n+1);if(c!=c){n+=3;break}if(c>191||c<128)break;K(r,c),n+=2,l++}if(r.length!==o){s+="�";continue}var d=oe(r);null===d?s+="�":a=j(d)}}s+=a,n++}return s},le=/[!'()~]|%20/g,ce={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+"},de=function(e){return ce[e]},ge=function(e){return z(W(e),le,de)},ue=p((function(e,t){D(this,{type:"URLSearchParamsIterator",target:G(e).entries,index:0,kind:t})}),"URLSearchParams",(function(){var e=q(this),t=e.target,s=e.index++;if(!t||s>=t.length)return e.target=null,N(void 0,!0);var n=t[s];switch(e.kind){case"keys":return N(n.key,!1);case"values":return N(n.value,!1)}return N([n.key,n.value],!1)}),!0),me=function(e){this.entries=[],this.url=null,void 0!==e&&(x(e)?this.parseObject(e):this.parseQuery("string"==typeof e?"?"===J(e,0)?ee(e,1):e:A(e)))};me.prototype={type:"URLSearchParams",bindURL:function(e){this.url=e,this.update()},parseObject:function(e){var t,s,n,a,i,o,l,c=this.entries,d=T(e);if(d)for(s=(t=E(e,d)).next;!(n=r(s,t)).done;){if(i=(a=E(k(n.value))).next,(o=r(i,a)).done||(l=r(i,a)).done||!r(i,a).done)throw new $("Expected sequence with length 2");K(c,{key:A(o.value),value:A(l.value)})}else for(var g in e)y(e,g)&&K(c,{key:g,value:A(e[g])})},parseQuery:function(e){if(e)for(var t,s,n=this.entries,a=X(e,"&"),i=0;i<a.length;)(t=a[i++]).length&&(s=X(t,"="),K(n,{key:re(Q(s)),value:re(Y(s,"="))}))},serialize:function(){for(var e,t=this.entries,s=[],n=0;n<t.length;)e=t[n++],K(s,ge(e.key)+"="+ge(e.value));return Y(s,"&")},update:function(){this.entries.length=0,this.parseQuery(this.url.query)},updateURL:function(){this.url&&this.url.update()}};var he=function(){b(this,pe);var e=arguments.length>0?arguments[0]:void 0,t=D(this,new me(e));c||(this.size=t.entries.length)},pe=he.prototype;if(m(pe,{append:function(e,t){var s=G(this);P(arguments.length,2),K(s.entries,{key:A(e),value:A(t)}),c||this.size++,s.updateURL()},delete:function(e){for(var t=G(this),s=P(arguments.length,1),n=t.entries,a=A(e),i=s<2?void 0:arguments[1],o=void 0===i?i:A(i),r=0;r<n.length;){var l=n[r];if(l.key!==a||void 0!==o&&l.value!==o)r++;else if(Z(n,r,1),void 0!==o)break}c||(this.size=n.length),t.updateURL()},get:function(e){var t=G(this).entries;P(arguments.length,1);for(var s=A(e),n=0;n<t.length;n++)if(t[n].key===s)return t[n].value;return null},getAll:function(e){var t=G(this).entries;P(arguments.length,1);for(var s=A(e),n=[],a=0;a<t.length;a++)t[a].key===s&&K(n,t[a].value);return n},has:function(e){for(var t=G(this).entries,s=P(arguments.length,1),n=A(e),a=s<2?void 0:arguments[1],i=void 0===a?a:A(a),o=0;o<t.length;){var r=t[o++];if(r.key===n&&(void 0===i||r.value===i))return!0}return!1},set:function(e,t){var s=G(this);P(arguments.length,1);for(var n,a=s.entries,i=!1,o=A(e),r=A(t),l=0;l<a.length;l++)(n=a[l]).key===o&&(i?Z(a,l--,1):(i=!0,n.value=r));i||K(a,{key:o,value:r}),c||(this.size=a.length),s.updateURL()},sort:function(){var e=G(this);I(e.entries,(function(e,t){return e.key>t.key?1:-1})),e.updateURL()},forEach:function(e){for(var t,s=G(this).entries,n=v(e,arguments.length>1?arguments[1]:void 0),a=0;a<s.length;)n((t=s[a++]).value,t.key,this)},keys:function(){return new ue(this,"keys")},values:function(){return new ue(this,"values")},entries:function(){return new ue(this,"entries")}},{enumerable:!0}),g(pe,B,pe.entries,{name:"entries"}),g(pe,"toString",(function(){return G(this).serialize()}),{enumerable:!0}),c&&u(pe,"size",{get:function(){return G(this).entries.length},configurable:!0,enumerable:!0}),h(he,"URLSearchParams"),n({global:!0,constructor:!0,forced:!d},{URLSearchParams:he}),!d&&w(O)){var fe=l(F.has),be=l(F.set),we=function(e){if(x(e)){var t,s=e.body;if("URLSearchParams"===_(s))return t=e.headers?new O(e.headers):new O,fe(t,"content-type")||be(t,"content-type","application/x-www-form-urlencoded;charset=UTF-8"),C(e,{body:S(0,A(s)),headers:S(0,t)})}return e};if(w(R)&&n({global:!0,enumerable:!0,dontCallGetSet:!0,forced:!0},{fetch:function(e){return R(e,arguments.length>1?we(arguments[1]):{})}}),w(M)){var ye=function(e){return b(this,U),new M(e,arguments.length>1?we(arguments[1]):{})};U.constructor=ye,ye.prototype=U,n({global:!0,constructor:!0,dontCallGetSet:!0,forced:!0},{Request:ye})}}e.exports={URLSearchParams:he,getState:G}},function(e,t,s){"use strict";var n=s(107),a=Math.floor,i=function(e,t){var s=e.length;if(s<8)for(var o,r,l=1;l<s;){for(r=l,o=e[l];r&&t(e[r-1],o)>0;)e[r]=e[--r];r!==l++&&(e[r]=o)}else for(var c=a(s/2),d=i(n(e,0,c),t),g=i(n(e,c),t),u=d.length,m=g.length,h=0,p=0;h<u||p<m;)e[h+p]=h<u&&p<m?t(d[h],g[p])<=0?d[h++]:g[p++]:h<u?d[h++]:g[p++];return e};e.exports=i},function(e,t,s){"use strict";var n=s(64),a=s(31),i=s(162),o=s(40),r=s(63),l=function(e,t,s,c,d,g,u,m){for(var h,p,f=d,b=0,w=!!u&&o(u,m);b<c;)b in s&&(h=w?w(s[b],b,t):s[b],g>0&&n(h)?(p=a(h),f=l(e,t,h,p,f,g-1)-1):(i(f+1),r(e,f,h)),f++),b++;return f};e.exports=l},function(e,t,s){"use strict";var n=s(163);e.exports=function(e,t){return new(n(e))(0===t?0:t)}},function(e,t,s){"use strict";var n=s(8),a=s(99),i=s(7),o=s(30),r=s(110),l=s(164),c=s(166),d=s(167),g=s(70),u=s(168),m=l.aTypedArray,h=l.exportTypedArrayMethod,p=n.Uint16Array,f=p&&a(p.prototype.sort),b=!(!f||i((function(){f(new p(2),null)}))&&i((function(){f(new p(2),{})}))),w=!!f&&!i((function(){if(g)return g<74;if(c)return c<67;if(d)return!0;if(u)return u<602;var e,t,s=new p(516),n=Array(516);for(e=0;e<516;e++)t=e%4,s[e]=515-e,n[e]=e-2*t+3;for(f(s,(function(e,t){return(e/4|0)-(t/4|0)})),e=0;e<516;e++)if(s[e]!==n[e])return!0}));h("sort",(function(e){return void 0!==e&&o(e),w?f(this,e):r(m(this),function(e){return function(t,s){return void 0!==e?+e(t,s)||0:s!=s?-1:t!=t?1:0===t&&0===s?1/t>0&&1/s<0?1:-1:t>s}}(e))}),!w||b)},function(e,t,s){"use strict";var n=s(173).start,a=s(174);e.exports=a("trimStart")?function(){return n(this)}:"".trimStart},function(e,t,s){"use strict";e.exports="\t\n\v\f\r                　\u2028\u2029\ufeff"},function(e,t,s){e.exports=s(175)},function(e,t){var s;s=function(){return this}();try{s=s||new Function("return this")()}catch(e){"object"==typeof window&&(s=window)}e.exports=s},function(e,t,s){"use strict";var n=s(10),a=s(72),i=s(18),o=s(17),r=s(32),l=s(76);t.f=n&&!a?Object.defineProperties:function(e,t){o(e);for(var s,n=r(t),a=l(t),c=a.length,d=0;c>d;)i.f(e,s=a[d++],n[s]);return e}},function(e,t,s){"use strict";var n=s(13),a=s(15),i=s(75),o=s(44),r=s(120),l=s(11),c=TypeError,d=l("toPrimitive");e.exports=function(e,t){if(!a(e)||i(e))return e;var s,l=o(e,d);if(l){if(void 0===t&&(t="default"),s=n(l,e,t),!a(s)||i(s))return s;throw new c("Can't convert object to primitive value")}return void 0===t&&(t="number"),r(e,t)}},function(e,t,s){"use strict";var n=s(13),a=s(9),i=s(15),o=TypeError;e.exports=function(e,t){var s,r;if("string"===t&&a(s=e.toString)&&!i(r=n(s,e)))return r;if(a(s=e.valueOf)&&!i(r=n(s,e)))return r;if("string"!==t&&a(s=e.toString)&&!i(r=n(s,e)))return r;throw new o("Can't convert object to primitive value")}},function(e,t,s){"use strict";var n=Math.ceil,a=Math.floor;e.exports=Math.trunc||function(e){var t=+e;return(t>0?a:n)(t)}},function(e,t,s){"use strict";var n=s(29);e.exports=n("document","documentElement")},function(e,t,s){"use strict";var n=s(8),a=s(9),i=n.WeakMap;e.exports=a(i)&&/native code/.test(String(i))},function(e,t,s){"use strict";var n=s(29),a=s(6),i=s(87),o=s(88),r=s(17),l=a([].concat);e.exports=n("Reflect","ownKeys")||function(e){var t=i.f(r(e)),s=o.f;return s?l(t,s(e)):t}},function(e,t,s){"use strict";var n=s(7);e.exports=!n((function(){function e(){}return e.prototype.constructor=null,Object.getPrototypeOf(new e)!==e.prototype}))},function(e,t,s){"use strict";var n=s(6),a=s(30);e.exports=function(e,t,s){try{return n(a(Object.getOwnPropertyDescriptor(e,t)[s]))}catch(e){}}},function(e,t,s){"use strict";var n=s(128),a=String,i=TypeError;e.exports=function(e){if(n(e))return e;throw new i("Can't set "+a(e)+" as a prototype")}},function(e,t,s){"use strict";var n=s(15);e.exports=function(e){return n(e)||null===e}},function(e,t,s){"use strict";e.exports={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0}},function(e,t,s){"use strict";var n=s(52)("span").classList,a=n&&n.constructor&&n.constructor.prototype;e.exports=a===Object.prototype?void 0:a},function(e,t,s){var n=s(92).default,a=s(132);e.exports=function(e){var t=a(e,"string");return"symbol"==n(t)?t:t+""},e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t,s){var n=s(92).default;e.exports=function(e,t){if("object"!=n(e)||!e)return e;var s=e[Symbol.toPrimitive];if(void 0!==s){var a=s.call(e,t||"default");if("object"!=n(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)},e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t,s){"use strict";var n=s(9),a=s(15),i=s(58);e.exports=function(e,t,s){var o,r;return i&&n(o=t.constructor)&&o!==s&&a(r=o.prototype)&&r!==s.prototype&&i(e,r),e}},function(e,t,s){"use strict";var n=s(15),a=s(26),i=s(11)("match");e.exports=function(e){var t;return n(e)&&(void 0!==(t=e[i])?!!t:"RegExp"===a(e))}},function(e,t,s){"use strict";var n={};n[s(11)("toStringTag")]="z",e.exports="[object z]"===String(n)},function(e,t,s){"use strict";var n=s(8),a=s(7),i=n.RegExp,o=!a((function(){var e=!0;try{i(".","d")}catch(t){e=!1}var t={},s="",n=e?"dgimsy":"gimsy",a=function(e,n){Object.defineProperty(t,e,{get:function(){return s+=n,!0}})},o={dotAll:"s",global:"g",ignoreCase:"i",multiline:"m",sticky:"y"};for(var r in e&&(o.hasIndices="d"),o)a(r,o[r]);return Object.getOwnPropertyDescriptor(i.prototype,"flags").get.call(t)!==n||s!==n}));e.exports={correct:o}},function(e,t,s){"use strict";var n=s(18).f;e.exports=function(e,t,s){s in e||n(e,s,{configurable:!0,get:function(){return t[s]},set:function(e){t[s]=e}})}},function(e,t,s){"use strict";var n=s(29),a=s(39),i=s(11),o=s(10),r=i("species");e.exports=function(e){var t=n(e);o&&t&&!t[r]&&a(t,r,{configurable:!0,get:function(){return this}})}},function(e,t,s){"use strict";var n=s(41),a=Function.prototype,i=a.apply,o=a.call;e.exports="object"==typeof Reflect&&Reflect.apply||(n?o.bind(i):function(){return o.apply(i,arguments)})},function(e,t,s){"use strict";s(3);var n=s(13),a=s(20),i=s(60),o=s(7),r=s(11),l=s(25),c=r("species"),d=RegExp.prototype;e.exports=function(e,t,s,g){var u=r(e),m=!o((function(){var t={};return t[u]=function(){return 7},7!==""[e](t)})),h=m&&!o((function(){var t=!1,s=/a/;if("split"===e){var n={};n[c]=function(){return s},(s={constructor:n,flags:""})[u]=/./[u]}return s.exec=function(){return t=!0,null},s[u](""),!t}));if(!m||!h||s){var p=/./[u],f=t(u,""[e],(function(e,t,s,a,o){var r=t.exec;return r===i||r===d.exec?m&&!o?{done:!0,value:n(p,t,s,a)}:{done:!0,value:n(e,s,t,a)}:{done:!1}}));a(String.prototype,e,f[0]),a(d,u,f[1])}g&&l(d[u],"sham",!0)}},function(e,t,s){"use strict";var n=s(61).charAt;e.exports=function(e,t,s){return t+(s?n(e,t).length:1)}},function(e,t,s){"use strict";var n=s(6),a=s(23),i=Math.floor,o=n("".charAt),r=n("".replace),l=n("".slice),c=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,d=/\$([$&'`]|\d{1,2})/g;e.exports=function(e,t,s,n,g,u){var m=s+e.length,h=n.length,p=d;return void 0!==g&&(g=a(g),p=c),r(u,p,(function(a,r){var c;switch(o(r,0)){case"$":return"$";case"&":return e;case"`":return l(t,0,s);case"'":return l(t,m);case"<":c=g[l(r,1,-1)];break;default:var d=+r;if(0===d)return a;if(d>h){var u=i(d/10);return 0===u?a:u<=h?void 0===n[u-1]?o(r,1):n[u-1]+o(r,1):a}c=n[d-1]}return void 0===c?"":c}))}},function(e,t,s){"use strict";var n=s(13),a=s(17),i=s(9),o=s(26),r=s(60),l=TypeError;e.exports=function(e,t){var s=e.exec;if(i(s)){var c=n(s,e,t);return null!==c&&a(c),c}if("RegExp"===o(e))return n(r,e,t);throw new l("RegExp#exec called on incompatible receiver")}},function(e,t,s){"use strict";var n=s(40),a=s(13),i=s(17),o=s(45),r=s(100),l=s(31),c=s(24),d=s(62),g=s(46),u=s(101),m=TypeError,h=function(e,t){this.stopped=e,this.result=t},p=h.prototype;e.exports=function(e,t,s){var f,b,w,y,v,_,k,x=s&&s.that,A=!(!s||!s.AS_ENTRIES),C=!(!s||!s.IS_RECORD),S=!(!s||!s.IS_ITERATOR),E=!(!s||!s.INTERRUPTED),T=n(t,x),N=function(e){return f&&u(f,"normal"),new h(!0,e)},P=function(e){return A?(i(e),E?T(e[0],e[1],N):T(e[0],e[1])):E?T(e,N):T(e)};if(C)f=e.iterator;else if(S)f=e;else{if(!(b=g(e)))throw new m(o(e)+" is not iterable");if(r(b)){for(w=0,y=l(e);y>w;w++)if((v=P(e[w]))&&c(p,v))return v;return new h(!1)}f=d(e,b)}for(_=C?e.next:f.next;!(k=a(_,f)).done;){try{v=P(k.value)}catch(e){u(f,"throw",e)}if("object"==typeof v&&v&&c(p,v))return v}return new h(!1)}},function(e,t,s){var n=s(102),a=s(146);"string"==typeof(a=a.__esModule?a.default:a)&&(a=[[e.i,a,""]]);var i={injectType:"singletonStyleTag",insert:("html","html"),singleton:!0};n(a,i);e.exports=a.locals||{}},function(e,t,s){(t=s(103)(!1)).push([e.i,".btn-group > .btn-group,\n.btn-toolbar .btn,\n.btn-toolbar .btn-group,\n.btn-toolbar .input-group {\n\tfloat: left;\n}\n.btn-group > .btn-group:first-child:not(:last-child) > .btn:last-child,\n.btn-group > .btn-group:first-child:not(:last-child) > .dropdown-toggle,\n.btn-group > .btn:first-child:not(:last-child):not(.dropdown-toggle) {\n\tborder-bottom-right-radius: 0;\n\tborder-top-right-radius: 0;\n}\n.btn-group > .btn-group:last-child:not(:first-child) > .btn:first-child,\n.btn-group > .btn:last-child:not(:first-child),\n.btn-group > .dropdown-toggle:not(:first-child) {\n\tborder-bottom-left-radius: 0;\n\tborder-top-left-radius: 0;\n}\n.btn-group-vertical > .btn:not(:first-child):not(:last-child),\n.btn-group > .btn-group:not(:first-child):not(:last-child) > .btn,\n.btn-group > .btn:not(:first-child):not(:last-child):not(.dropdown-toggle) {\n\tborder-radius: 0;\n}\n.btn,\n.btn-link {\n\tfont-weight: 400;\n}\n.btn,\n.btn-danger.active,\n.btn-danger:active,\n.btn-default.active,\n.btn-default:active,\n.btn-info.active,\n.btn-info:active,\n.btn-primary.active,\n.btn-primary:active,\n.btn-warning.active,\n.btn-warning:active,\n.btn.active,\n.btn:active,\n.dropdown-menu > .disabled > a:focus,\n.dropdown-menu > .disabled > a:hover,\n.form-control,\n.open > .dropdown-toggle.btn-danger,\n.open > .dropdown-toggle.btn-default,\n.open > .dropdown-toggle.btn-info,\n.open > .dropdown-toggle.btn-primary,\n.open > .dropdown-toggle.btn-warning {\n\tbackground-image: none;\n}\n.btn-group,\n.btn-group-vertical {\n\tposition: relative;\n\tdisplay: inline-block;\n\tvertical-align: middle;\n}\n.btn-group-vertical > .btn,\n.btn-group > .btn {\n\tposition: relative;\n\tfloat: left;\n}\n.btn-group-vertical > .btn.active,\n.btn-group-vertical > .btn:active,\n.btn-group-vertical > .btn:focus,\n.btn-group-vertical > .btn:hover,\n.btn-group > .btn.active,\n.btn-group > .btn:active,\n.btn-group > .btn:focus,\n.btn-group > .btn:hover {\n\tz-index: 2;\n}\n.btn-group .btn + .btn,\n.btn-group .btn + .btn-group,\n.btn-group .btn-group + .btn,\n.btn-group .btn-group + .btn-group {\n\tmargin-left: -1px;\n}\n.btn-toolbar {\n\tmargin-left: -5px;\n}\n.btn-toolbar > .btn,\n.btn-toolbar > .btn-group,\n.btn-toolbar > .input-group {\n\tmargin-left: 5px;\n}\n.btn .caret,\n.btn-group > .btn:first-child {\n\tmargin-left: 0;\n}\n.btn-group .dropdown-toggle:active,\n.btn-group.open .dropdown-toggle {\n\toutline: 0;\n}\n.btn-group > .btn + .dropdown-toggle {\n\tpadding-left: 8px;\n\tpadding-right: 8px;\n}\n.btn-group > .btn-lg + .dropdown-toggle {\n\tpadding-left: 12px;\n\tpadding-right: 12px;\n}\n.btn-group.open .dropdown-toggle {\n\t-webkit-box-shadow: inset 0 3px 5px rgba(0, 0, 0, 0.125);\n\tbox-shadow: inset 0 3px 5px rgba(0, 0, 0, 0.125);\n}\n.btn-group.open .dropdown-toggle.btn-link {\n\t-webkit-box-shadow: none;\n\tbox-shadow: none;\n}\n.btn-lg .caret {\n\tborder-width: 5px 5px 0;\n}\n.dropup .btn-lg .caret {\n\tborder-width: 0 5px 5px;\n}\n.btn-group-vertical > .btn,\n.btn-group-vertical > .btn-group,\n.btn-group-vertical > .btn-group > .btn {\n\tdisplay: block;\n\tfloat: none;\n\twidth: 100%;\n\tmax-width: 100%;\n}\n.btn-group-vertical > .btn-group > .btn {\n\tfloat: none;\n}\n.btn-group-vertical > .btn + .btn,\n.btn-group-vertical > .btn + .btn-group,\n.btn-group-vertical > .btn-group + .btn,\n.btn-group-vertical > .btn-group + .btn-group {\n\tmargin-top: -1px;\n\tmargin-left: 0;\n}\n.btn-group-vertical > .btn:first-child:not(:last-child) {\n\tborder-radius: 4px 4px 0 0;\n}\n.btn-group-vertical > .btn:last-child:not(:first-child) {\n\tborder-radius: 0 0 4px 4px;\n}\n.btn-group-vertical > .btn-group:not(:first-child):not(:last-child) > .btn {\n\tborder-radius: 0;\n}\n.btn-group-vertical > .btn-group:first-child:not(:last-child) > .btn:last-child,\n.btn-group-vertical > .btn-group:first-child:not(:last-child) > .dropdown-toggle {\n\tborder-bottom-right-radius: 0;\n\tborder-bottom-left-radius: 0;\n}\n.btn-group-vertical > .btn-group:last-child:not(:first-child) > .btn:first-child {\n\tborder-top-right-radius: 0;\n\tborder-top-left-radius: 0;\n}\n.btn-group-justified {\n\tdisplay: table;\n\twidth: 100%;\n\ttable-layout: fixed;\n\tborder-collapse: separate;\n}\n.btn-group-justified > .btn,\n.btn-group-justified > .btn-group {\n\tfloat: none;\n\tdisplay: table-cell;\n\twidth: 1%;\n}\n.btn-block,\n.btn-group-justified > .btn-group .btn,\n.form-control,\ninput[type='submit'].btn-block,\ninput[type='reset'].btn-block,\ninput[type='button'].btn-block,\nlegend {\n\twidth: 100%;\n}\n.btn-group-justified > .btn-group .dropdown-menu {\n\tleft: auto;\n}\n[data-toggle='buttons'] > .btn input[type='radio'],\n[data-toggle='buttons'] > .btn input[type='checkbox'],\n[data-toggle='buttons'] > .btn-group > .btn input[type='radio'],\n[data-toggle='buttons'] > .btn-group > .btn input[type='checkbox'] {\n\tposition: absolute;\n\tclip: rect(0, 0, 0, 0);\n\tpointer-events: none;\n}\n.btn {\n\tdisplay: inline-block;\n\tmargin-bottom: 0;\n\ttext-align: center;\n\tvertical-align: middle;\n\ttouch-action: manipulation;\n\tcursor: pointer;\n\tborder: 1px solid transparent;\n\twhite-space: nowrap;\n\tpadding: 6px 12px;\n\tfont-size: 14px;\n\tline-height: 1.428571429;\n\tborder-radius: 4px;\n\t-webkit-user-select: none;\n\t-moz-user-select: none;\n\t-ms-user-select: none;\n\tuser-select: none;\n}\n.btn.active.focus,\n.btn.active:focus,\n.btn.focus,\n.btn:active.focus,\n.btn:active:focus,\n.btn:focus {\n\toutline: -webkit-focus-ring-color auto 5px;\n\toutline-offset: -2px;\n}\n.btn.focus,\n.btn:focus,\n.btn:hover {\n\tcolor: #333;\n\ttext-decoration: none;\n}\n.btn.active,\n.btn:active {\n\toutline: 0;\n\t-webkit-box-shadow: inset 0 3px 5px rgba(0, 0, 0, 0.125);\n\tbox-shadow: inset 0 3px 5px rgba(0, 0, 0, 0.125);\n}\n.btn.disabled,\n.btn[disabled],\nfieldset[disabled] .btn {\n\tcursor: not-allowed;\n\topacity: 0.65;\n\tfilter: alpha(opacity=65);\n\t-webkit-box-shadow: none;\n\tbox-shadow: none;\n}\na.btn.disabled,\nfieldset[disabled] a.btn {\n\tpointer-events: none;\n}\n.btn-default {\n\tcolor: #333;\n\tbackground-color: #fff;\n\tborder-color: #ccc;\n}\n.btn-default.focus,\n.btn-default:focus {\n\tcolor: #333;\n\tbackground-color: #e6e6e6;\n\tborder-color: #8c8c8c;\n}\n.btn-default.active,\n.btn-default:active,\n.btn-default:hover,\n.open > .dropdown-toggle.btn-default {\n\tcolor: #333;\n\tbackground-color: #e6e6e6;\n\tborder-color: #adadad;\n}\n.btn-default.active.focus,\n.btn-default.active:focus,\n.btn-default.active:hover,\n.btn-default:active.focus,\n.btn-default:active:focus,\n.btn-default:active:hover,\n.open > .dropdown-toggle.btn-default.focus,\n.open > .dropdown-toggle.btn-default:focus,\n.open > .dropdown-toggle.btn-default:hover {\n\tcolor: #333;\n\tbackground-color: #d4d4d4;\n\tborder-color: #8c8c8c;\n}\n.btn-default.disabled.focus,\n.btn-default.disabled:focus,\n.btn-default.disabled:hover,\n.btn-default[disabled].focus,\n.btn-default[disabled]:focus,\n.btn-default[disabled]:hover,\nfieldset[disabled] .btn-default.focus,\nfieldset[disabled] .btn-default:focus,\nfieldset[disabled] .btn-default:hover {\n\tbackground-color: #fff;\n\tborder-color: #ccc;\n}\n.btn-default .badge {\n\tcolor: #fff;\n\tbackground-color: #333;\n}\n.btn-primary {\n\tcolor: #fff;\n\tbackground-color: #337ab7;\n\tborder-color: #2e6da4;\n}\n.btn-primary.focus,\n.btn-primary:focus {\n\tcolor: #fff;\n\tbackground-color: #286090;\n\tborder-color: #122b40;\n}\n.btn-primary.active,\n.btn-primary:active,\n.btn-primary:hover,\n.open > .dropdown-toggle.btn-primary {\n\tcolor: #fff;\n\tbackground-color: #286090;\n\tborder-color: #204d74;\n}\n.btn-primary.active.focus,\n.btn-primary.active:focus,\n.btn-primary.active:hover,\n.btn-primary:active.focus,\n.btn-primary:active:focus,\n.btn-primary:active:hover,\n.open > .dropdown-toggle.btn-primary.focus,\n.open > .dropdown-toggle.btn-primary:focus,\n.open > .dropdown-toggle.btn-primary:hover {\n\tcolor: #fff;\n\tbackground-color: #204d74;\n\tborder-color: #122b40;\n}\n.btn-primary.disabled.focus,\n.btn-primary.disabled:focus,\n.btn-primary.disabled:hover,\n.btn-primary[disabled].focus,\n.btn-primary[disabled]:focus,\n.btn-primary[disabled]:hover,\nfieldset[disabled] .btn-primary.focus,\nfieldset[disabled] .btn-primary:focus,\nfieldset[disabled] .btn-primary:hover {\n\tbackground-color: #337ab7;\n\tborder-color: #2e6da4;\n}\n.btn-primary .badge {\n\tcolor: #337ab7;\n\tbackground-color: #fff;\n}\n.btn-success {\n\tcolor: #fff;\n\tbackground-color: #5cb85c;\n\tborder-color: #4cae4c;\n}\n.btn-success.focus,\n.btn-success:focus {\n\tcolor: #fff;\n\tbackground-color: #449d44;\n\tborder-color: #255625;\n}\n.btn-success.active,\n.btn-success:active,\n.btn-success:hover,\n.open > .dropdown-toggle.btn-success {\n\tcolor: #fff;\n\tbackground-color: #449d44;\n\tborder-color: #398439;\n}\n.btn-success.active.focus,\n.btn-success.active:focus,\n.btn-success.active:hover,\n.btn-success:active.focus,\n.btn-success:active:focus,\n.btn-success:active:hover,\n.open > .dropdown-toggle.btn-success.focus,\n.open > .dropdown-toggle.btn-success:focus,\n.open > .dropdown-toggle.btn-success:hover {\n\tcolor: #fff;\n\tbackground-color: #398439;\n\tborder-color: #255625;\n}\n.btn-success.active,\n.btn-success:active,\n.open > .dropdown-toggle.btn-success {\n\tbackground-image: none;\n}\n.btn-success.disabled.focus,\n.btn-success.disabled:focus,\n.btn-success.disabled:hover,\n.btn-success[disabled].focus,\n.btn-success[disabled]:focus,\n.btn-success[disabled]:hover,\nfieldset[disabled] .btn-success.focus,\nfieldset[disabled] .btn-success:focus,\nfieldset[disabled] .btn-success:hover {\n\tbackground-color: #5cb85c;\n\tborder-color: #4cae4c;\n}\n.btn-success .badge {\n\tcolor: #5cb85c;\n\tbackground-color: #fff;\n}\n.btn-info {\n\tcolor: #fff;\n\tbackground-color: #5bc0de;\n\tborder-color: #46b8da;\n}\n.btn-info.focus,\n.btn-info:focus {\n\tcolor: #fff;\n\tbackground-color: #31b0d5;\n\tborder-color: #1b6d85;\n}\n.btn-info.active,\n.btn-info:active,\n.btn-info:hover,\n.open > .dropdown-toggle.btn-info {\n\tcolor: #fff;\n\tbackground-color: #31b0d5;\n\tborder-color: #269abc;\n}\n.btn-info.active.focus,\n.btn-info.active:focus,\n.btn-info.active:hover,\n.btn-info:active.focus,\n.btn-info:active:focus,\n.btn-info:active:hover,\n.open > .dropdown-toggle.btn-info.focus,\n.open > .dropdown-toggle.btn-info:focus,\n.open > .dropdown-toggle.btn-info:hover {\n\tcolor: #fff;\n\tbackground-color: #269abc;\n\tborder-color: #1b6d85;\n}\n.btn-info.disabled.focus,\n.btn-info.disabled:focus,\n.btn-info.disabled:hover,\n.btn-info[disabled].focus,\n.btn-info[disabled]:focus,\n.btn-info[disabled]:hover,\nfieldset[disabled] .btn-info.focus,\nfieldset[disabled] .btn-info:focus,\nfieldset[disabled] .btn-info:hover {\n\tbackground-color: #5bc0de;\n\tborder-color: #46b8da;\n}\n.btn-info .badge {\n\tcolor: #5bc0de;\n\tbackground-color: #fff;\n}\n.btn-warning {\n\tcolor: #fff;\n\tbackground-color: #f0ad4e;\n\tborder-color: #eea236;\n}\n.btn-warning.focus,\n.btn-warning:focus {\n\tcolor: #fff;\n\tbackground-color: #ec971f;\n\tborder-color: #985f0d;\n}\n.btn-warning.active,\n.btn-warning:active,\n.btn-warning:hover,\n.open > .dropdown-toggle.btn-warning {\n\tcolor: #fff;\n\tbackground-color: #ec971f;\n\tborder-color: #d58512;\n}\n.btn-warning.active.focus,\n.btn-warning.active:focus,\n.btn-warning.active:hover,\n.btn-warning:active.focus,\n.btn-warning:active:focus,\n.btn-warning:active:hover,\n.open > .dropdown-toggle.btn-warning.focus,\n.open > .dropdown-toggle.btn-warning:focus,\n.open > .dropdown-toggle.btn-warning:hover {\n\tcolor: #fff;\n\tbackground-color: #d58512;\n\tborder-color: #985f0d;\n}\n.btn-warning.disabled.focus,\n.btn-warning.disabled:focus,\n.btn-warning.disabled:hover,\n.btn-warning[disabled].focus,\n.btn-warning[disabled]:focus,\n.btn-warning[disabled]:hover,\nfieldset[disabled] .btn-warning.focus,\nfieldset[disabled] .btn-warning:focus,\nfieldset[disabled] .btn-warning:hover {\n\tbackground-color: #f0ad4e;\n\tborder-color: #eea236;\n}\n.btn-warning .badge {\n\tcolor: #f0ad4e;\n\tbackground-color: #fff;\n}\n.btn-danger {\n\tcolor: #fff;\n\tbackground-color: #d9534f;\n\tborder-color: #d43f3a;\n}\n.btn-danger.focus,\n.btn-danger:focus {\n\tcolor: #fff;\n\tbackground-color: #c9302c;\n\tborder-color: #761c19;\n}\n.btn-danger.active,\n.btn-danger:active,\n.btn-danger:hover,\n.open > .dropdown-toggle.btn-danger {\n\tcolor: #fff;\n\tbackground-color: #c9302c;\n\tborder-color: #ac2925;\n}\n.btn-danger.active.focus,\n.btn-danger.active:focus,\n.btn-danger.active:hover,\n.btn-danger:active.focus,\n.btn-danger:active:focus,\n.btn-danger:active:hover,\n.open > .dropdown-toggle.btn-danger.focus,\n.open > .dropdown-toggle.btn-danger:focus,\n.open > .dropdown-toggle.btn-danger:hover {\n\tcolor: #fff;\n\tbackground-color: #ac2925;\n\tborder-color: #761c19;\n}\n.btn-danger.disabled.focus,\n.btn-danger.disabled:focus,\n.btn-danger.disabled:hover,\n.btn-danger[disabled].focus,\n.btn-danger[disabled]:focus,\n.btn-danger[disabled]:hover,\nfieldset[disabled] .btn-danger.focus,\nfieldset[disabled] .btn-danger:focus,\nfieldset[disabled] .btn-danger:hover {\n\tbackground-color: #d9534f;\n\tborder-color: #d43f3a;\n}\n.btn-danger .badge {\n\tcolor: #d9534f;\n\tbackground-color: #fff;\n}\n.btn-link {\n\tcolor: #337ab7;\n\tborder-radius: 0;\n}\n.btn-link,\n.btn-link.active,\n.btn-link:active,\n.btn-link[disabled],\nfieldset[disabled] .btn-link {\n\tbackground-color: transparent;\n\t-webkit-box-shadow: none;\n\tbox-shadow: none;\n}\n.btn-link,\n.btn-link:active,\n.btn-link:focus,\n.btn-link:hover {\n\tborder-color: transparent;\n}\n.btn-link:focus,\n.btn-link:hover {\n\tcolor: #23527c;\n\ttext-decoration: underline;\n\tbackground-color: transparent;\n}\n.btn-link[disabled]:focus,\n.btn-link[disabled]:hover,\nfieldset[disabled] .btn-link:focus,\nfieldset[disabled] .btn-link:hover {\n\tcolor: #777;\n\ttext-decoration: none;\n}\n.btn-group-lg > .btn,\n.btn-lg {\n\tpadding: 10px 16px;\n\tfont-size: 18px;\n\tline-height: 1.3333333;\n\tborder-radius: 6px;\n}\n.btn-group-sm > .btn,\n.btn-sm {\n\tpadding: 5px 10px;\n\tfont-size: 12px;\n\tline-height: 1.5;\n\tborder-radius: 3px;\n}\n.btn-group-xs > .btn,\n.btn-xs {\n\tpadding: 1px 5px;\n\tfont-size: 12px;\n\tline-height: 1.5;\n\tborder-radius: 3px;\n}\n.btn-block {\n\tdisplay: block;\n}\n.btn-block + .btn-block {\n\tmargin-top: 5px;\n}\n.caret {\n\tdisplay: inline-block;\n\twidth: 0;\n\theight: 0;\n\tmargin-left: 2px;\n\tvertical-align: middle;\n\tborder-top: 4px dashed;\n\tborder-top: 4px solid\\9;\n\tborder-right: 4px solid transparent;\n\tborder-left: 4px solid transparent;\n}\n.dropdown,\n.dropup {\n\tposition: relative;\n}\n.dropdown-toggle:focus {\n\toutline: 0;\n}\n.dropdown-menu {\n\tposition: absolute;\n\ttop: 100%;\n\tleft: 0;\n\tz-index: 1000;\n\tdisplay: none;\n\tfloat: left;\n\tmin-width: 160px;\n\tpadding: 5px 0;\n\tmargin: 2px 0 0;\n\tlist-style: none;\n\tfont-size: 14px;\n\ttext-align: left;\n\tbackground-color: #fff;\n\tborder: 1px solid #ccc;\n\tborder: 1px solid rgba(0, 0, 0, 0.15);\n\tborder-radius: 4px;\n\t-webkit-box-shadow: 0 6px 12px rgba(0, 0, 0, 0.175);\n\tbox-shadow: 0 6px 12px rgba(0, 0, 0, 0.175);\n\tbackground-clip: padding-box;\n}\n.dropdown-menu-right,\n.dropdown-menu.pull-right {\n\tleft: auto;\n\tright: 0;\n}\n.dropdown-header,\n.dropdown-menu > li > a {\n\tpadding: 3px 20px;\n\tline-height: 1.428571429;\n\tdisplay: block;\n\twhite-space: nowrap;\n}\n.dropdown-menu .divider {\n\theight: 1px;\n\tmargin: 9px 0;\n\toverflow: hidden;\n\tbackground-color: #e5e5e5;\n}\n.dropdown-menu > li > a {\n\tclear: both;\n\tfont-weight: 400;\n\tcolor: #333;\n}\n.dropdown-menu > li > a:focus,\n.dropdown-menu > li > a:hover {\n\ttext-decoration: none;\n\tcolor: #262626;\n\tbackground-color: #f5f5f5;\n}\n.dropdown-menu > .active > a,\n.dropdown-menu > .active > a:focus,\n.dropdown-menu > .active > a:hover {\n\tcolor: #fff;\n\ttext-decoration: none;\n\toutline: 0;\n\tbackground-color: #337ab7;\n}\n.dropdown-menu > .disabled > a,\n.dropdown-menu > .disabled > a:focus,\n.dropdown-menu > .disabled > a:hover {\n\tcolor: #777;\n}\n.dropdown-menu > .disabled > a:focus,\n.dropdown-menu > .disabled > a:hover {\n\ttext-decoration: none;\n\tbackground-color: transparent;\n\tfilter: progid:DXImageTransform.Microsoft.gradient(enabled=false);\n\tcursor: not-allowed;\n}\n.open > .dropdown-menu {\n\tdisplay: block;\n}\n.open > a {\n\toutline: 0;\n}\n.dropdown-menu-left {\n\tleft: 0;\n\tright: auto;\n}\n.dropdown-header {\n\tfont-size: 12px;\n\tcolor: #777;\n}\n.dropdown-backdrop {\n\tposition: fixed;\n\tleft: 0;\n\tright: 0;\n\tbottom: 0;\n\ttop: 0;\n\tz-index: 990;\n}\n.pull-right > .dropdown-menu {\n\tright: 0;\n\tleft: auto;\n}\n.dropup .caret,\n.navbar-fixed-bottom .dropdown .caret {\n\tborder-top: 0;\n\tborder-bottom: 4px dashed;\n\tborder-bottom: 4px solid\\9;\n\tcontent: '';\n}\nfieldset,\nlegend {\n\tpadding: 0;\n\tborder: 0;\n}\n.dropup .dropdown-menu,\n.navbar-fixed-bottom .dropdown .dropdown-menu {\n\ttop: auto;\n\tbottom: 100%;\n\tmargin-bottom: 2px;\n}\n@media (min-width: 768px) {\n\t.navbar-right .dropdown-menu {\n\t\tleft: auto;\n\t\tright: 0;\n\t}\n\t.navbar-right .dropdown-menu-left {\n\t\tleft: 0;\n\t\tright: auto;\n\t}\n}\nfieldset {\n\tmargin: 0;\n\tmin-width: 0;\n}\nlegend {\n\tdisplay: block;\n\tmargin-bottom: 20px;\n\tfont-size: 21px;\n\tline-height: inherit;\n\tcolor: #333;\n\tborder-bottom: 1px solid #e5e5e5;\n}\nlabel {\n\tdisplay: inline-block;\n\tmax-width: 100%;\n\tmargin-bottom: 5px;\n\tfont-weight: 700;\n}\n.checkbox label,\n.checkbox-inline,\n.radio label,\n.radio-inline {\n\tfont-weight: 400;\n\tpadding-left: 20px;\n\tcursor: pointer;\n\tmargin-bottom: 0;\n}\ninput[type='search'] {\n\t-webkit-box-sizing: border-box;\n\t-moz-box-sizing: border-box;\n\tbox-sizing: border-box;\n\t-webkit-appearance: none;\n}\ninput[type='radio'],\ninput[type='checkbox'] {\n\tmargin: 4px 0 0;\n\tmargin-top: 1px\\9;\n\tline-height: normal;\n}\n.form-control,\noutput {\n\tfont-size: 14px;\n\tline-height: 1.428571429;\n\tcolor: #555;\n\tdisplay: block;\n}\ninput[type='file'] {\n\tdisplay: block;\n}\ninput[type='range'] {\n\tdisplay: block;\n\twidth: 100%;\n}\nselect[multiple],\nselect[size] {\n\theight: auto;\n}\ninput[type='radio']:focus,\ninput[type='checkbox']:focus,\ninput[type='file']:focus {\n\toutline: -webkit-focus-ring-color auto 5px;\n\toutline-offset: -2px;\n}\noutput {\n\tpadding-top: 7px;\n}\n.form-control {\n\theight: 34px;\n\tpadding: 6px 12px;\n\tbackground-color: #fff;\n\tborder: 1px solid #ccc;\n\tborder-radius: 4px;\n\t-webkit-box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075);\n\tbox-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075);\n\t-webkit-transition: border-color ease-in-out 0.15s, box-shadow ease-in-out 0.15s;\n\t-o-transition: border-color ease-in-out 0.15s, box-shadow ease-in-out 0.15s;\n\ttransition: border-color ease-in-out 0.15s, box-shadow ease-in-out 0.15s;\n}\n.form-control:focus {\n\tborder-color: #66afe9;\n\toutline: 0;\n\t-webkit-box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075), 0 0 8px rgba(102, 175, 233, 0.6);\n\tbox-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075), 0 0 8px rgba(102, 175, 233, 0.6);\n}\n.form-control::-moz-placeholder {\n\tcolor: #999;\n\topacity: 1;\n}\n.form-control:-ms-input-placeholder {\n\tcolor: #999;\n}\n.form-control::-webkit-input-placeholder {\n\tcolor: #999;\n}\n.has-success .checkbox,\n.has-success .checkbox-inline,\n.has-success .control-label,\n.has-success .form-control-feedback,\n.has-success .help-block,\n.has-success .radio,\n.has-success .radio-inline,\n.has-success.checkbox label,\n.has-success.checkbox-inline label,\n.has-success.radio label,\n.has-success.radio-inline label {\n\tcolor: #3c763d;\n}\n.form-control::-ms-expand {\n\tborder: 0;\n\tbackground-color: transparent;\n}\n.form-control[disabled],\n.form-control[readonly],\nfieldset[disabled] .form-control {\n\tbackground-color: #eee;\n\topacity: 1;\n}\n.form-control[disabled],\nfieldset[disabled] .form-control {\n\tcursor: not-allowed;\n}\ntextarea.form-control {\n\theight: auto;\n}\n@media screen and (-webkit-min-device-pixel-ratio: 0) {\n\tinput[type='date'].form-control,\n\tinput[type='time'].form-control,\n\tinput[type='datetime-local'].form-control,\n\tinput[type='month'].form-control {\n\t\tline-height: 34px;\n\t}\n\t.input-group-sm input[type='date'],\n\t.input-group-sm input[type='time'],\n\t.input-group-sm input[type='datetime-local'],\n\t.input-group-sm input[type='month'],\n\tinput[type='date'].input-sm,\n\tinput[type='time'].input-sm,\n\tinput[type='datetime-local'].input-sm,\n\tinput[type='month'].input-sm {\n\t\tline-height: 30px;\n\t}\n\t.input-group-lg input[type='date'],\n\t.input-group-lg input[type='time'],\n\t.input-group-lg input[type='datetime-local'],\n\t.input-group-lg input[type='month'],\n\tinput[type='date'].input-lg,\n\tinput[type='time'].input-lg,\n\tinput[type='datetime-local'].input-lg,\n\tinput[type='month'].input-lg {\n\t\tline-height: 46px;\n\t}\n}\n.form-group {\n\tmargin-bottom: 15px;\n}\n.checkbox,\n.radio {\n\tposition: relative;\n\tdisplay: inline;\n\tmargin-top: 10px;\n\tmargin-bottom: 10px;\n}\n.checkbox label,\n.radio label {\n\tmin-height: 20px;\n}\n.checkbox input[type='checkbox'],\n.checkbox-inline input[type='checkbox'],\n.radio input[type='radio'],\n.radio-inline input[type='radio'] {\n\tposition: absolute;\n\tmargin-left: -20px;\n\tmargin-top: 4px\\9;\n}\n.checkbox + .checkbox,\n.radio + .radio {\n\tmargin-top: -5px;\n}\n.checkbox-inline,\n.radio-inline {\n\tposition: relative;\n\tdisplay: inline-block;\n\tvertical-align: middle;\n}\n.checkbox-inline + .checkbox-inline,\n.radio-inline + .radio-inline {\n\tmargin-top: 0;\n\tmargin-left: 10px;\n}\n.checkbox-inline.disabled,\n.checkbox.disabled label,\n.radio-inline.disabled,\n.radio.disabled label,\nfieldset[disabled] .checkbox label,\nfieldset[disabled] .checkbox-inline,\nfieldset[disabled] .radio label,\nfieldset[disabled] .radio-inline,\nfieldset[disabled] input[type='radio'],\nfieldset[disabled] input[type='checkbox'],\ninput[type='radio'].disabled,\ninput[type='radio'][disabled],\ninput[type='checkbox'].disabled,\ninput[type='checkbox'][disabled] {\n\tcursor: not-allowed;\n}\n.form-control-static {\n\tpadding-top: 7px;\n\tpadding-bottom: 7px;\n\tmargin-bottom: 0;\n\tmin-height: 34px;\n}\n.form-control-static.input-lg,\n.form-control-static.input-sm {\n\tpadding-left: 0;\n\tpadding-right: 0;\n}\n.form-group-sm .form-control,\n.input-sm {\n\tpadding: 5px 10px;\n\tborder-radius: 3px;\n\tfont-size: 12px;\n}\n.input-sm {\n\theight: 30px;\n\tline-height: 1.5;\n}\nselect.input-sm {\n\theight: 30px;\n\tline-height: 30px;\n}\nselect[multiple].input-sm,\ntextarea.input-sm {\n\theight: auto;\n}\n.form-group-sm .form-control {\n\theight: 30px;\n\tline-height: 1.5;\n}\n.form-group-lg .form-control,\n.input-lg {\n\tborder-radius: 6px;\n\tpadding: 10px 16px;\n\tfont-size: 18px;\n}\n.form-group-sm select.form-control {\n\theight: 30px;\n\tline-height: 30px;\n}\n.form-group-sm select[multiple].form-control,\n.form-group-sm textarea.form-control {\n\theight: auto;\n}\n.form-group-sm .form-control-static {\n\theight: 30px;\n\tmin-height: 32px;\n\tpadding: 6px 10px;\n\tfont-size: 12px;\n\tline-height: 1.5;\n}\n.input-lg {\n\theight: 46px;\n\tline-height: 1.3333333;\n}\nselect.input-lg {\n\theight: 46px;\n\tline-height: 46px;\n}\nselect[multiple].input-lg,\ntextarea.input-lg {\n\theight: auto;\n}\n.form-group-lg .form-control {\n\theight: 46px;\n\tline-height: 1.3333333;\n}\n.form-group-lg select.form-control {\n\theight: 46px;\n\tline-height: 46px;\n}\n.form-group-lg select[multiple].form-control,\n.form-group-lg textarea.form-control {\n\theight: auto;\n}\n.form-group-lg .form-control-static {\n\theight: 46px;\n\tmin-height: 38px;\n\tpadding: 11px 16px;\n\tfont-size: 18px;\n\tline-height: 1.3333333;\n}\n.has-feedback {\n\tposition: relative;\n}\n.has-feedback .form-control {\n\tpadding-right: 42.5px;\n}\n.form-control-feedback {\n\tposition: absolute;\n\ttop: 0;\n\tright: 0;\n\tz-index: 2;\n\tdisplay: block;\n\twidth: 34px;\n\theight: 34px;\n\tline-height: 34px;\n\ttext-align: center;\n\tpointer-events: none;\n}\n.input-group,\n.input-group-btn,\n.input-group-btn > .btn {\n\tposition: relative;\n}\n.form-group-lg .form-control + .form-control-feedback,\n.input-group-lg + .form-control-feedback,\n.input-lg + .form-control-feedback {\n\twidth: 46px;\n\theight: 46px;\n\tline-height: 46px;\n}\n.form-group-sm .form-control + .form-control-feedback,\n.input-group-sm + .form-control-feedback,\n.input-sm + .form-control-feedback {\n\twidth: 30px;\n\theight: 30px;\n\tline-height: 30px;\n}\n.has-success .form-control {\n\tborder-color: #3c763d;\n\t-webkit-box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075);\n\tbox-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075);\n}\n.has-success .form-control:focus {\n\tborder-color: #2b542c;\n\t-webkit-box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075), 0 0 6px #67b168;\n\tbox-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075), 0 0 6px #67b168;\n}\n.has-success .input-group-addon {\n\tcolor: #3c763d;\n\tborder-color: #3c763d;\n\tbackground-color: #dff0d8;\n}\n.has-warning .checkbox,\n.has-warning .checkbox-inline,\n.has-warning .control-label,\n.has-warning .form-control-feedback,\n.has-warning .help-block,\n.has-warning .radio,\n.has-warning .radio-inline,\n.has-warning.checkbox label,\n.has-warning.checkbox-inline label,\n.has-warning.radio label,\n.has-warning.radio-inline label {\n\tcolor: #8a6d3b;\n}\n.has-warning .form-control {\n\tborder-color: #8a6d3b;\n\t-webkit-box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075);\n\tbox-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075);\n}\n.has-warning .form-control:focus {\n\tborder-color: #66512c;\n\t-webkit-box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075), 0 0 6px #c0a16b;\n\tbox-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075), 0 0 6px #c0a16b;\n}\n.has-warning .input-group-addon {\n\tcolor: #8a6d3b;\n\tborder-color: #8a6d3b;\n\tbackground-color: #fcf8e3;\n}\n.has-error .checkbox,\n.has-error .checkbox-inline,\n.has-error .control-label,\n.has-error .form-control-feedback,\n.has-error .help-block,\n.has-error .radio,\n.has-error .radio-inline,\n.has-error.checkbox label,\n.has-error.checkbox-inline label,\n.has-error.radio label,\n.has-error.radio-inline label {\n\tcolor: #a94442;\n}\n.has-error .form-control {\n\tborder-color: #a94442;\n\t-webkit-box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075);\n\tbox-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075);\n}\n.has-error .form-control:focus {\n\tborder-color: #843534;\n\t-webkit-box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075), 0 0 6px #ce8483;\n\tbox-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075), 0 0 6px #ce8483;\n}\n.has-error .input-group-addon {\n\tcolor: #a94442;\n\tborder-color: #a94442;\n\tbackground-color: #f2dede;\n}\n.has-feedback label ~ .form-control-feedback {\n\ttop: 25px;\n}\n.has-feedback label.sr-only ~ .form-control-feedback {\n\ttop: 0;\n}\n.help-block {\n\tdisplay: block;\n\tmargin-top: 5px;\n\tmargin-bottom: 10px;\n\tcolor: #737373;\n}\n@media (min-width: 768px) {\n\t.form-inline .form-control-static,\n\t.form-inline .form-group {\n\t\tdisplay: inline-block;\n\t}\n\t.form-inline .control-label,\n\t.form-inline .form-group {\n\t\tmargin-bottom: 0;\n\t\tvertical-align: middle;\n\t}\n\t.form-inline .form-control {\n\t\tdisplay: inline-block;\n\t\twidth: auto;\n\t\tvertical-align: middle;\n\t}\n\t.form-inline .input-group {\n\t\tdisplay: inline-table;\n\t\tvertical-align: middle;\n\t}\n\t.form-inline .input-group .form-control,\n\t.form-inline .input-group .input-group-addon,\n\t.form-inline .input-group .input-group-btn {\n\t\twidth: auto;\n\t}\n\t.form-inline .input-group > .form-control {\n\t\twidth: 100%;\n\t}\n\t.form-inline .checkbox,\n\t.form-inline .radio {\n\t\tdisplay: inline-block;\n\t\tmargin-top: 0;\n\t\tmargin-bottom: 0;\n\t\tvertical-align: middle;\n\t}\n\t.form-inline .checkbox label,\n\t.form-inline .radio label {\n\t\tpadding-left: 0;\n\t}\n\t.form-inline .checkbox input[type='checkbox'],\n\t.form-inline .radio input[type='radio'] {\n\t\tposition: relative;\n\t\tmargin-left: 0;\n\t}\n\t.form-inline .has-feedback .form-control-feedback {\n\t\ttop: 0;\n\t}\n\t.form-horizontal .control-label {\n\t\ttext-align: right;\n\t\tmargin-bottom: 0;\n\t\tpadding-top: 7px;\n\t}\n}\n.form-horizontal .checkbox,\n.form-horizontal .checkbox-inline,\n.form-horizontal .radio,\n.form-horizontal .radio-inline {\n\tmargin-top: 0;\n\tmargin-bottom: 0;\n\tpadding-top: 7px;\n}\n.form-horizontal .checkbox,\n.form-horizontal .radio {\n\tmin-height: 27px;\n}\n.form-horizontal .form-group {\n\tmargin-left: -15px;\n\tmargin-right: -15px;\n}\n.form-horizontal .has-feedback .form-control-feedback {\n\tright: 15px;\n}\n@media (min-width: 768px) {\n\t.form-horizontal .form-group-lg .control-label {\n\t\tpadding-top: 11px;\n\t\tfont-size: 18px;\n\t}\n\t.form-horizontal .form-group-sm .control-label {\n\t\tpadding-top: 6px;\n\t\tfont-size: 12px;\n\t}\n}\n.input-group {\n\tdisplay: table;\n\tborder-collapse: separate;\n}\n.input-group[class*='col-'] {\n\tfloat: none;\n\tpadding-left: 0;\n\tpadding-right: 0;\n}\n.input-group .form-control {\n\tposition: relative;\n\tz-index: 2;\n\tfloat: left;\n\twidth: 100%;\n\tmargin-bottom: 0;\n}\n.input-group .form-control:focus {\n\tz-index: 3;\n}\n.input-group-lg > .form-control,\n.input-group-lg > .input-group-addon,\n.input-group-lg > .input-group-btn > .btn {\n\theight: 46px;\n\tpadding: 10px 16px;\n\tfont-size: 18px;\n\tline-height: 1.3333333;\n\tborder-radius: 6px;\n}\nselect.input-group-lg > .form-control,\nselect.input-group-lg > .input-group-addon,\nselect.input-group-lg > .input-group-btn > .btn {\n\theight: 46px;\n\tline-height: 46px;\n}\nselect[multiple].input-group-lg > .form-control,\nselect[multiple].input-group-lg > .input-group-addon,\nselect[multiple].input-group-lg > .input-group-btn > .btn,\ntextarea.input-group-lg > .form-control,\ntextarea.input-group-lg > .input-group-addon,\ntextarea.input-group-lg > .input-group-btn > .btn {\n\theight: auto;\n}\n.input-group-sm > .form-control,\n.input-group-sm > .input-group-addon,\n.input-group-sm > .input-group-btn > .btn {\n\theight: 30px;\n\tpadding: 5px 10px;\n\tfont-size: 12px;\n\tline-height: 1.5;\n\tborder-radius: 3px;\n}\nselect.input-group-sm > .form-control,\nselect.input-group-sm > .input-group-addon,\nselect.input-group-sm > .input-group-btn > .btn {\n\theight: 30px;\n\tline-height: 30px;\n}\nselect[multiple].input-group-sm > .form-control,\nselect[multiple].input-group-sm > .input-group-addon,\nselect[multiple].input-group-sm > .input-group-btn > .btn,\ntextarea.input-group-sm > .form-control,\ntextarea.input-group-sm > .input-group-addon,\ntextarea.input-group-sm > .input-group-btn > .btn {\n\theight: auto;\n}\n.input-group .form-control,\n.input-group-addon,\n.input-group-btn {\n\tdisplay: table-cell;\n}\n.input-group .form-control:not(:first-child):not(:last-child),\n.input-group-addon:not(:first-child):not(:last-child),\n.input-group-btn:not(:first-child):not(:last-child) {\n\tborder-radius: 0;\n}\n.input-group-addon,\n.input-group-btn {\n\twidth: 1%;\n\twhite-space: nowrap;\n\tvertical-align: middle;\n}\n.input-group-addon {\n\tpadding: 6px 12px;\n\tfont-size: 14px;\n\tfont-weight: 400;\n\tline-height: 1;\n\tcolor: #555;\n\ttext-align: center;\n\tbackground-color: #eee;\n\tborder: 1px solid #ccc;\n\tborder-radius: 4px;\n}\n.input-group-addon.input-sm {\n\tpadding: 5px 10px;\n\tfont-size: 12px;\n\tborder-radius: 3px;\n}\n.input-group-addon.input-lg {\n\tpadding: 10px 16px;\n\tfont-size: 18px;\n\tborder-radius: 6px;\n}\n.input-group-addon input[type='radio'],\n.input-group-addon input[type='checkbox'] {\n\tmargin-top: 0;\n}\n.input-group .form-control:first-child,\n.input-group-addon:first-child,\n.input-group-btn:first-child > .btn,\n.input-group-btn:first-child > .btn-group > .btn,\n.input-group-btn:first-child > .dropdown-toggle,\n.input-group-btn:last-child > .btn-group:not(:last-child) > .btn,\n.input-group-btn:last-child > .btn:not(:last-child):not(.dropdown-toggle) {\n\tborder-bottom-right-radius: 0;\n\tborder-top-right-radius: 0;\n}\n.input-group-addon:first-child {\n\tborder-right: 0;\n}\n.input-group .form-control:last-child,\n.input-group-addon:last-child,\n.input-group-btn:first-child > .btn-group:not(:first-child) > .btn,\n.input-group-btn:first-child > .btn:not(:first-child),\n.input-group-btn:last-child > .btn,\n.input-group-btn:last-child > .btn-group > .btn,\n.input-group-btn:last-child > .dropdown-toggle {\n\tborder-bottom-left-radius: 0;\n\tborder-top-left-radius: 0;\n}\n.input-group-addon:last-child {\n\tborder-left: 0;\n}\n.input-group-btn {\n\tfont-size: 0;\n\twhite-space: nowrap;\n}\n.input-group-btn > .btn + .btn {\n\tmargin-left: -1px;\n}\n.input-group-btn > .btn:active,\n.input-group-btn > .btn:focus,\n.input-group-btn > .btn:hover {\n\tz-index: 2;\n}\n.input-group-btn:first-child > .btn,\n.input-group-btn:first-child > .btn-group {\n\tmargin-right: -1px;\n}\n.input-group-btn:last-child > .btn,\n.input-group-btn:last-child > .btn-group {\n\tz-index: 2;\n\tmargin-left: -1px;\n}\n.hidden,\n.hide {\n\tdisplay: none !important;\n}\n",""]),e.exports=t},function(e,t,s){var n=s(102),a=s(148);"string"==typeof(a=a.__esModule?a.default:a)&&(a=[[e.i,a,""]]);var i={injectType:"singletonStyleTag",insert:("html","html"),singleton:!0};n(a,i);e.exports=a.locals||{}},function(e,t,s){(t=s(103)(!1)).push([e.i,".rules-group-container {\n\tborder: 1px solid #ccc !important;\n\tbackground: none !important;\n}\n\n.query-builder .btn-primary {\n\ttext-shadow: none !important;\n}\n\n.query-builder .form-control {\n\theight: 22px !important;\n\tfont-size: 12px !important;\n\tpadding: 2px !important;\n}\n\n.query-builder .rule-value-container label {\n\tposition: relative;\n\tleft: 5px;\n\twidth: 40px;\n\ttop: 3px;\n}\n\n.query-builder .radio-default input {\n\tdisplay: inline !important;\n}\n\n.query-builder .rules-group-container[data-esgst-paused='true'] [data-resume='group'] {\n\tdisplay: block !important;\n}\n\n.query-builder .rules-group-container [data-resume='group'],\n.query-builder .rules-group-container[data-esgst-paused='true'] [data-pause='group']\n.query-builder .rule-container [data-resume='rule'],\n.query-builder .rule-container[data-esgst-paused='true'] [data-pause='rule'],\n.rule-operator-container > span {\n\tdisplay: none !important;\n}\n\n.query-builder .rule-container[data-esgst-paused=\"true\"] [data-resume=\"rule\"] {\n  display: block !important;\n  border-radius: 3px 0 0 3px !important;\n}\n\n.query-builder .rule-container[data-esgst-paused='true'],\n.query-builder .rules-group-container[data-esgst-paused='true'] {\n\topacity: 0.5 !important;\n}\n",""]),e.exports=t},function(e,t,s){"use strict";s(150)},function(e,t,s){"use strict";s(151);var n,a=s(16),i=s(10),o=s(104),r=s(8),l=s(40),c=s(6),d=s(20),g=s(39),u=s(105),m=s(14),h=s(152),p=s(153),f=s(107),b=s(61).codeAt,w=s(156),y=s(21),v=s(37),_=s(108),k=s(109),x=s(22),A=x.set,C=x.getterFor("URL"),S=k.URLSearchParams,E=k.getState,T=r.URL,N=r.TypeError,P=r.parseInt,L=Math.floor,I=Math.pow,B=c("".charAt),D=c(/./.exec),G=c([].join),q=c(1.1.toString),R=c([].pop),M=c([].push),O=c("".replace),U=c([].shift),F=c("".split),$=c("".slice),W=c("".toLowerCase),V=c([].unshift),j=/[a-z]/i,H=/[\d+-.a-z]/i,J=/\d/,Y=/^0x/i,K=/^[0-7]+$/,z=/^\d+$/,Q=/^[\da-f]+$/i,Z=/[\0\t\n\r #%/:<>?@[\\\]^|]/,X=/[\0\t\n\r #/:<>?@[\\\]^|]/,ee=/^[\u0000-\u0020]+/,te=/(^|[^\u0000-\u0020])[\u0000-\u0020]+$/,se=/[\t\n\r]/g,ne=function(e){var t,s,n,a;if("number"==typeof e){for(t=[],s=0;s<4;s++)V(t,e%256),e=L(e/256);return G(t,".")}if("object"==typeof e){for(t="",n=function(e){for(var t=null,s=1,n=null,a=0,i=0;i<8;i++)0!==e[i]?(a>s&&(t=n,s=a),n=null,a=0):(null===n&&(n=i),++a);return a>s?n:t}(e),s=0;s<8;s++)a&&0===e[s]||(a&&(a=!1),n===s?(t+=s?":":"::",a=!0):(t+=q(e[s],16),s<7&&(t+=":")));return"["+t+"]"}return e},ae={},ie=h({},ae,{" ":1,'"':1,"<":1,">":1,"`":1}),oe=h({},ie,{"#":1,"?":1,"{":1,"}":1}),re=h({},oe,{"/":1,":":1,";":1,"=":1,"@":1,"[":1,"\\":1,"]":1,"^":1,"|":1}),le=function(e,t){var s=b(e,0);return s>32&&s<127&&!m(t,e)?e:encodeURIComponent(e)},ce={ftp:21,file:null,http:80,https:443,ws:80,wss:443},de=function(e,t){var s;return 2===e.length&&D(j,B(e,0))&&(":"===(s=B(e,1))||!t&&"|"===s)},ge=function(e){var t;return e.length>1&&de($(e,0,2))&&(2===e.length||"/"===(t=B(e,2))||"\\"===t||"?"===t||"#"===t)},ue=function(e){return"."===e||"%2e"===W(e)},me={},he={},pe={},fe={},be={},we={},ye={},ve={},_e={},ke={},xe={},Ae={},Ce={},Se={},Ee={},Te={},Ne={},Pe={},Le={},Ie={},Be={},De=function(e,t,s){var n,a,i,o=y(e);if(t){if(a=this.parse(o))throw new N(a);this.searchParams=null}else{if(void 0!==s&&(n=new De(s,!0)),a=this.parse(o,null,n))throw new N(a);(i=E(new S)).bindURL(this),this.searchParams=i}};De.prototype={type:"URL",parse:function(e,t,s){var a,i,o,r,l,c=this,d=t||me,g=0,u="",h=!1,b=!1,w=!1;for(e=y(e),t||(c.scheme="",c.username="",c.password="",c.host=null,c.port=null,c.path=[],c.query=null,c.fragment=null,c.cannotBeABaseURL=!1,e=O(e,ee,""),e=O(e,te,"$1")),e=O(e,se,""),a=p(e);g<=a.length;){switch(i=a[g],d){case me:if(!i||!D(j,i)){if(t)return"Invalid scheme";d=pe;continue}u+=W(i),d=he;break;case he:if(i&&(D(H,i)||"+"===i||"-"===i||"."===i))u+=W(i);else{if(":"!==i){if(t)return"Invalid scheme";u="",d=pe,g=0;continue}if(t&&(c.isSpecial()!==m(ce,u)||"file"===u&&(c.includesCredentials()||null!==c.port)||"file"===c.scheme&&!c.host))return;if(c.scheme=u,t)return void(c.isSpecial()&&ce[c.scheme]===c.port&&(c.port=null));u="","file"===c.scheme?d=Se:c.isSpecial()&&s&&s.scheme===c.scheme?d=fe:c.isSpecial()?d=ve:"/"===a[g+1]?(d=be,g++):(c.cannotBeABaseURL=!0,M(c.path,""),d=Le)}break;case pe:if(!s||s.cannotBeABaseURL&&"#"!==i)return"Invalid scheme";if(s.cannotBeABaseURL&&"#"===i){c.scheme=s.scheme,c.path=f(s.path),c.query=s.query,c.fragment="",c.cannotBeABaseURL=!0,d=Be;break}d="file"===s.scheme?Se:we;continue;case fe:if("/"!==i||"/"!==a[g+1]){d=we;continue}d=_e,g++;break;case be:if("/"===i){d=ke;break}d=Pe;continue;case we:if(c.scheme=s.scheme,i===n)c.username=s.username,c.password=s.password,c.host=s.host,c.port=s.port,c.path=f(s.path),c.query=s.query;else if("/"===i||"\\"===i&&c.isSpecial())d=ye;else if("?"===i)c.username=s.username,c.password=s.password,c.host=s.host,c.port=s.port,c.path=f(s.path),c.query="",d=Ie;else{if("#"!==i){c.username=s.username,c.password=s.password,c.host=s.host,c.port=s.port,c.path=f(s.path),c.path.length--,d=Pe;continue}c.username=s.username,c.password=s.password,c.host=s.host,c.port=s.port,c.path=f(s.path),c.query=s.query,c.fragment="",d=Be}break;case ye:if(!c.isSpecial()||"/"!==i&&"\\"!==i){if("/"!==i){c.username=s.username,c.password=s.password,c.host=s.host,c.port=s.port,d=Pe;continue}d=ke}else d=_e;break;case ve:if(d=_e,"/"!==i||"/"!==B(u,g+1))continue;g++;break;case _e:if("/"!==i&&"\\"!==i){d=ke;continue}break;case ke:if("@"===i){h&&(u="%40"+u),h=!0,o=p(u);for(var v=0;v<o.length;v++){var _=o[v];if(":"!==_||w){var k=le(_,re);w?c.password+=k:c.username+=k}else w=!0}u=""}else if(i===n||"/"===i||"?"===i||"#"===i||"\\"===i&&c.isSpecial()){if(h&&""===u)return"Invalid authority";g-=p(u).length+1,u="",d=xe}else u+=i;break;case xe:case Ae:if(t&&"file"===c.scheme){d=Te;continue}if(":"!==i||b){if(i===n||"/"===i||"?"===i||"#"===i||"\\"===i&&c.isSpecial()){if(c.isSpecial()&&""===u)return"Invalid host";if(t&&""===u&&(c.includesCredentials()||null!==c.port))return;if(r=c.parseHost(u))return r;if(u="",d=Ne,t)return;continue}"["===i?b=!0:"]"===i&&(b=!1),u+=i}else{if(""===u)return"Invalid host";if(r=c.parseHost(u))return r;if(u="",d=Ce,t===Ae)return}break;case Ce:if(!D(J,i)){if(i===n||"/"===i||"?"===i||"#"===i||"\\"===i&&c.isSpecial()||t){if(""!==u){var x=P(u,10);if(x>65535)return"Invalid port";c.port=c.isSpecial()&&x===ce[c.scheme]?null:x,u=""}if(t)return;d=Ne;continue}return"Invalid port"}u+=i;break;case Se:if(c.scheme="file","/"===i||"\\"===i)d=Ee;else{if(!s||"file"!==s.scheme){d=Pe;continue}switch(i){case n:c.host=s.host,c.path=f(s.path),c.query=s.query;break;case"?":c.host=s.host,c.path=f(s.path),c.query="",d=Ie;break;case"#":c.host=s.host,c.path=f(s.path),c.query=s.query,c.fragment="",d=Be;break;default:ge(G(f(a,g),""))||(c.host=s.host,c.path=f(s.path),c.shortenPath()),d=Pe;continue}}break;case Ee:if("/"===i||"\\"===i){d=Te;break}s&&"file"===s.scheme&&!ge(G(f(a,g),""))&&(de(s.path[0],!0)?M(c.path,s.path[0]):c.host=s.host),d=Pe;continue;case Te:if(i===n||"/"===i||"\\"===i||"?"===i||"#"===i){if(!t&&de(u))d=Pe;else if(""===u){if(c.host="",t)return;d=Ne}else{if(r=c.parseHost(u))return r;if("localhost"===c.host&&(c.host=""),t)return;u="",d=Ne}continue}u+=i;break;case Ne:if(c.isSpecial()){if(d=Pe,"/"!==i&&"\\"!==i)continue}else if(t||"?"!==i)if(t||"#"!==i){if(i!==n&&(d=Pe,"/"!==i))continue}else c.fragment="",d=Be;else c.query="",d=Ie;break;case Pe:if(i===n||"/"===i||"\\"===i&&c.isSpecial()||!t&&("?"===i||"#"===i)){if(".."===(l=W(l=u))||"%2e."===l||".%2e"===l||"%2e%2e"===l?(c.shortenPath(),"/"===i||"\\"===i&&c.isSpecial()||M(c.path,"")):ue(u)?"/"===i||"\\"===i&&c.isSpecial()||M(c.path,""):("file"===c.scheme&&!c.path.length&&de(u)&&(c.host&&(c.host=""),u=B(u,0)+":"),M(c.path,u)),u="","file"===c.scheme&&(i===n||"?"===i||"#"===i))for(;c.path.length>1&&""===c.path[0];)U(c.path);"?"===i?(c.query="",d=Ie):"#"===i&&(c.fragment="",d=Be)}else u+=le(i,oe);break;case Le:"?"===i?(c.query="",d=Ie):"#"===i?(c.fragment="",d=Be):i!==n&&(c.path[0]+=le(i,ae));break;case Ie:t||"#"!==i?i!==n&&("'"===i&&c.isSpecial()?c.query+="%27":c.query+="#"===i?"%23":le(i,ae)):(c.fragment="",d=Be);break;case Be:i!==n&&(c.fragment+=le(i,ie))}g++}},parseHost:function(e){var t,s,n;if("["===B(e,0)){if("]"!==B(e,e.length-1))return"Invalid host";if(!(t=function(e){var t,s,n,a,i,o,r,l=[0,0,0,0,0,0,0,0],c=0,d=null,g=0,u=function(){return B(e,g)};if(":"===u()){if(":"!==B(e,1))return;g+=2,d=++c}for(;u();){if(8===c)return;if(":"!==u()){for(t=s=0;s<4&&D(Q,u());)t=16*t+P(u(),16),g++,s++;if("."===u()){if(0===s)return;if(g-=s,c>6)return;for(n=0;u();){if(a=null,n>0){if(!("."===u()&&n<4))return;g++}if(!D(J,u()))return;for(;D(J,u());){if(i=P(u(),10),null===a)a=i;else{if(0===a)return;a=10*a+i}if(a>255)return;g++}l[c]=256*l[c]+a,2!==++n&&4!==n||c++}if(4!==n)return;break}if(":"===u()){if(g++,!u())return}else if(u())return;l[c++]=t}else{if(null!==d)return;g++,d=++c}}if(null!==d)for(o=c-d,c=7;0!==c&&o>0;)r=l[c],l[c--]=l[d+o-1],l[d+--o]=r;else if(8!==c)return;return l}($(e,1,-1))))return"Invalid host";this.host=t}else if(this.isSpecial()){if(e=w(e),D(Z,e))return"Invalid host";if(null===(t=function(e){var t,s,n,a,i,o,r,l=F(e,".");if(l.length&&""===l[l.length-1]&&l.length--,(t=l.length)>4)return e;for(s=[],n=0;n<t;n++){if(""===(a=l[n]))return e;if(i=10,a.length>1&&"0"===B(a,0)&&(i=D(Y,a)?16:8,a=$(a,8===i?1:2)),""===a)o=0;else{if(!D(10===i?z:8===i?K:Q,a))return e;o=P(a,i)}M(s,o)}for(n=0;n<t;n++)if(o=s[n],n===t-1){if(o>=I(256,5-t))return null}else if(o>255)return null;for(r=R(s),n=0;n<s.length;n++)r+=s[n]*I(256,3-n);return r}(e)))return"Invalid host";this.host=t}else{if(D(X,e))return"Invalid host";for(t="",s=p(e),n=0;n<s.length;n++)t+=le(s[n],ae);this.host=t}},cannotHaveUsernamePasswordPort:function(){return!this.host||this.cannotBeABaseURL||"file"===this.scheme},includesCredentials:function(){return""!==this.username||""!==this.password},isSpecial:function(){return m(ce,this.scheme)},shortenPath:function(){var e=this.path,t=e.length;!t||"file"===this.scheme&&1===t&&de(e[0],!0)||e.length--},serialize:function(){var e=this,t=e.scheme,s=e.username,n=e.password,a=e.host,i=e.port,o=e.path,r=e.query,l=e.fragment,c=t+":";return null!==a?(c+="//",e.includesCredentials()&&(c+=s+(n?":"+n:"")+"@"),c+=ne(a),null!==i&&(c+=":"+i)):"file"===t&&(c+="//"),c+=e.cannotBeABaseURL?o[0]:o.length?"/"+G(o,"/"):"",null!==r&&(c+="?"+r),null!==l&&(c+="#"+l),c},setHref:function(e){var t=this.parse(e);if(t)throw new N(t);this.searchParams.update()},getOrigin:function(){var e=this.scheme,t=this.port;if("blob"===e)try{return new Ge(e.path[0]).origin}catch(e){return"null"}return"file"!==e&&this.isSpecial()?e+"://"+ne(this.host)+(null!==t?":"+t:""):"null"},getProtocol:function(){return this.scheme+":"},setProtocol:function(e){this.parse(y(e)+":",me)},getUsername:function(){return this.username},setUsername:function(e){var t=p(y(e));if(!this.cannotHaveUsernamePasswordPort()){this.username="";for(var s=0;s<t.length;s++)this.username+=le(t[s],re)}},getPassword:function(){return this.password},setPassword:function(e){var t=p(y(e));if(!this.cannotHaveUsernamePasswordPort()){this.password="";for(var s=0;s<t.length;s++)this.password+=le(t[s],re)}},getHost:function(){var e=this.host,t=this.port;return null===e?"":null===t?ne(e):ne(e)+":"+t},setHost:function(e){this.cannotBeABaseURL||this.parse(e,xe)},getHostname:function(){var e=this.host;return null===e?"":ne(e)},setHostname:function(e){this.cannotBeABaseURL||this.parse(e,Ae)},getPort:function(){var e=this.port;return null===e?"":y(e)},setPort:function(e){this.cannotHaveUsernamePasswordPort()||(""===(e=y(e))?this.port=null:this.parse(e,Ce))},getPathname:function(){var e=this.path;return this.cannotBeABaseURL?e[0]:e.length?"/"+G(e,"/"):""},setPathname:function(e){this.cannotBeABaseURL||(this.path=[],this.parse(e,Ne))},getSearch:function(){var e=this.query;return e?"?"+e:""},setSearch:function(e){""===(e=y(e))?this.query=null:("?"===B(e,0)&&(e=$(e,1)),this.query="",this.parse(e,Ie)),this.searchParams.update()},getSearchParams:function(){return this.searchParams.facade},getHash:function(){var e=this.fragment;return e?"#"+e:""},setHash:function(e){""!==(e=y(e))?("#"===B(e,0)&&(e=$(e,1)),this.fragment="",this.parse(e,Be)):this.fragment=null},update:function(){this.query=this.searchParams.serialize()||null}};var Ge=function(e){var t=u(this,qe),s=_(arguments.length,1)>1?arguments[1]:void 0,n=A(t,new De(e,!1,s));i||(t.href=n.serialize(),t.origin=n.getOrigin(),t.protocol=n.getProtocol(),t.username=n.getUsername(),t.password=n.getPassword(),t.host=n.getHost(),t.hostname=n.getHostname(),t.port=n.getPort(),t.pathname=n.getPathname(),t.search=n.getSearch(),t.searchParams=n.getSearchParams(),t.hash=n.getHash())},qe=Ge.prototype,Re=function(e,t){return{get:function(){return C(this)[e]()},set:t&&function(e){return C(this)[t](e)},configurable:!0,enumerable:!0}};if(i&&(g(qe,"href",Re("serialize","setHref")),g(qe,"origin",Re("getOrigin")),g(qe,"protocol",Re("getProtocol","setProtocol")),g(qe,"username",Re("getUsername","setUsername")),g(qe,"password",Re("getPassword","setPassword")),g(qe,"host",Re("getHost","setHost")),g(qe,"hostname",Re("getHostname","setHostname")),g(qe,"port",Re("getPort","setPort")),g(qe,"pathname",Re("getPathname","setPathname")),g(qe,"search",Re("getSearch","setSearch")),g(qe,"searchParams",Re("getSearchParams")),g(qe,"hash",Re("getHash","setHash"))),d(qe,"toJSON",(function(){return C(this).serialize()}),{enumerable:!0}),d(qe,"toString",(function(){return C(this).serialize()}),{enumerable:!0}),T){var Me=T.createObjectURL,Oe=T.revokeObjectURL;Me&&d(Ge,"createObjectURL",l(Me,T)),Oe&&d(Ge,"revokeObjectURL",l(Oe,T))}v(Ge,"URL"),a({global:!0,constructor:!0,forced:!o,sham:!i},{URL:Ge})},function(e,t,s){"use strict";var n=s(61).charAt,a=s(21),i=s(22),o=s(81),r=s(59),l=i.set,c=i.getterFor("String Iterator");o(String,"String",(function(e){l(this,{type:"String Iterator",string:a(e),index:0})}),(function(){var e,t=c(this),s=t.string,a=t.index;return a>=s.length?r(void 0,!0):(e=n(s,a),t.index+=e.length,r(e,!1))}))},function(e,t,s){"use strict";var n=s(10),a=s(6),i=s(13),o=s(7),r=s(76),l=s(88),c=s(83),d=s(23),g=s(68),u=Object.assign,m=Object.defineProperty,h=a([].concat);e.exports=!u||o((function(){if(n&&1!==u({b:1},u(m({},"a",{enumerable:!0,get:function(){m(this,"b",{value:3,enumerable:!1})}}),{b:2})).b)return!0;var e={},t={},s=Symbol("assign detection");return e[s]=7,"abcdefghijklmnopqrst".split("").forEach((function(e){t[e]=e})),7!==u({},e)[s]||"abcdefghijklmnopqrst"!==r(u({},t)).join("")}))?function(e,t){for(var s=d(e),a=arguments.length,o=1,u=l.f,m=c.f;a>o;)for(var p,f=g(arguments[o++]),b=u?h(r(f),u(f)):r(f),w=b.length,y=0;w>y;)p=b[y++],n&&!i(m,f,p)||(s[p]=f[p]);return s}:u},function(e,t,s){"use strict";var n=s(40),a=s(13),i=s(23),o=s(154),r=s(100),l=s(106),c=s(31),d=s(63),g=s(155),u=s(62),m=s(46),h=Array;e.exports=function(e){var t=i(e),s=l(this),p=arguments.length,f=p>1?arguments[1]:void 0,b=void 0!==f;b&&(f=n(f,p>2?arguments[2]:void 0));var w,y,v,_,k,x,A=m(t),C=0;if(!A||this===h&&r(A))for(w=c(t),y=s?new this(w):h(w);w>C;C++)x=b?f(t[C],C):t[C],d(y,C,x);else for(y=s?new this:[],k=(_=u(t,A)).next;!(v=a(k,_)).done;C++)x=b?o(_,f,[v.value,C],!0):v.value,d(y,C,x);return g(y,C),y}},function(e,t,s){"use strict";var n=s(17),a=s(101);e.exports=function(e,t,s,i){try{return i?t(n(s)[0],s[1]):t(s)}catch(t){a(e,"throw",t)}}},function(e,t,s){"use strict";var n=s(10),a=s(64),i=TypeError,o=Object.getOwnPropertyDescriptor,r=n&&!function(){if(void 0!==this)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(e){return e instanceof TypeError}}();e.exports=r?function(e,t){if(a(e)&&!o(e,"length").writable)throw new i("Cannot set read only .length");return e.length=t}:function(e,t){return e.length=t}},function(e,t,s){"use strict";var n=s(6),a=/[^\0-\u007E]/,i=/[.\u3002\uFF0E\uFF61]/g,o="Overflow: input needs wider integers to process",r=RangeError,l=n(i.exec),c=Math.floor,d=String.fromCharCode,g=n("".charCodeAt),u=n([].join),m=n([].push),h=n("".replace),p=n("".split),f=n("".toLowerCase),b=function(e){return e+22+75*(e<26)},w=function(e,t,s){var n=0;for(e=s?c(e/700):e>>1,e+=c(e/t);e>455;)e=c(e/35),n+=36;return c(n+36*e/(e+38))},y=function(e){var t,s,n=[],a=(e=function(e){for(var t=[],s=0,n=e.length;s<n;){var a=g(e,s++);if(a>=55296&&a<=56319&&s<n){var i=g(e,s++);56320==(64512&i)?m(t,((1023&a)<<10)+(1023&i)+65536):(m(t,a),s--)}else m(t,a)}return t}(e)).length,i=128,l=0,h=72;for(t=0;t<e.length;t++)(s=e[t])<128&&m(n,d(s));var p=n.length,f=p;for(p&&m(n,"-");f<a;){var y=2147483647;for(t=0;t<e.length;t++)(s=e[t])>=i&&s<y&&(y=s);var v=f+1;if(y-i>c((2147483647-l)/v))throw new r(o);for(l+=(y-i)*v,i=y,t=0;t<e.length;t++){if((s=e[t])<i&&++l>2147483647)throw new r(o);if(s===i){for(var _=l,k=36;;){var x=k<=h?1:k>=h+26?26:k-h;if(_<x)break;var A=_-x,C=36-x;m(n,d(b(x+A%C))),_=c(A/C),k+=36}m(n,d(b(_))),h=w(l,v,f===p),l=0,f++}}l++,i++}return u(n,"")};e.exports=function(e){var t,s,n=[],o=p(h(f(e),i,"."),".");for(t=0;t<o.length;t++)s=o[t],m(n,l(a,s)?"xn--"+y(s):s);return u(n,".")}},function(e,t,s){"use strict";var n=s(16),a=s(6),i=s(79),o=RangeError,r=String.fromCharCode,l=String.fromCodePoint,c=a([].join);n({target:"String",stat:!0,arity:1,forced:!!l&&1!==l.length},{fromCodePoint:function(e){for(var t,s=[],n=arguments.length,a=0;n>a;){if(t=+arguments[a++],i(t,1114111)!==t)throw new o(t+" is not a valid code point");s[a]=t<65536?r(t):r(55296+((t-=65536)>>10),t%1024+56320)}return c(s,"")}})},function(e,t,s){"use strict";var n=s(8),a=s(10),i=Object.getOwnPropertyDescriptor;e.exports=function(e){if(!a)return n[e];var t=i(n,e);return t&&t.value}},function(e,t,s){"use strict";var n=s(20);e.exports=function(e,t,s){for(var a in t)n(e,a,t[a],s);return e}},function(e,t,s){"use strict";var n=s(16),a=s(13);n({target:"URL",proto:!0,enumerable:!0},{toJSON:function(){return a(URL.prototype.toString,this)}})},function(e,t,s){"use strict";s(109)},function(e,t,s){"use strict";var n=TypeError;e.exports=function(e){if(e>9007199254740991)throw n("Maximum allowed index exceeded");return e}},function(e,t,s){"use strict";var n=s(64),a=s(106),i=s(15),o=s(11)("species"),r=Array;e.exports=function(e){var t;return n(e)&&(t=e.constructor,(a(t)&&(t===r||n(t.prototype))||i(t)&&null===(t=t[o]))&&(t=void 0)),void 0===t?r:t}},function(e,t,s){"use strict";var n,a,i,o=s(165),r=s(10),l=s(8),c=s(9),d=s(15),g=s(14),u=s(38),m=s(45),h=s(25),p=s(20),f=s(39),b=s(24),w=s(57),y=s(58),v=s(11),_=s(51),k=s(22),x=k.enforce,A=k.get,C=l.Int8Array,S=C&&C.prototype,E=l.Uint8ClampedArray,T=E&&E.prototype,N=C&&w(C),P=S&&w(S),L=Object.prototype,I=l.TypeError,B=v("toStringTag"),D=_("TYPED_ARRAY_TAG"),G=o&&!!y&&"Opera"!==u(l.opera),q=!1,R={Int8Array:1,Uint8Array:1,Uint8ClampedArray:1,Int16Array:2,Uint16Array:2,Int32Array:4,Uint32Array:4,Float32Array:4,Float64Array:8},M={BigInt64Array:8,BigUint64Array:8},O=function(e){var t=w(e);if(d(t)){var s=A(t);return s&&g(s,"TypedArrayConstructor")?s.TypedArrayConstructor:O(t)}},U=function(e){if(!d(e))return!1;var t=u(e);return g(R,t)||g(M,t)};for(n in R)(i=(a=l[n])&&a.prototype)?x(i).TypedArrayConstructor=a:G=!1;for(n in M)(i=(a=l[n])&&a.prototype)&&(x(i).TypedArrayConstructor=a);if((!G||!c(N)||N===Function.prototype)&&(N=function(){throw new I("Incorrect invocation")},G))for(n in R)l[n]&&y(l[n],N);if((!G||!P||P===L)&&(P=N.prototype,G))for(n in R)l[n]&&y(l[n].prototype,P);if(G&&w(T)!==P&&y(T,P),r&&!g(P,B))for(n in q=!0,f(P,B,{configurable:!0,get:function(){return d(this)?this[D]:void 0}}),R)l[n]&&h(l[n],D,n);e.exports={NATIVE_ARRAY_BUFFER_VIEWS:G,TYPED_ARRAY_TAG:q&&D,aTypedArray:function(e){if(U(e))return e;throw new I("Target is not a typed array")},aTypedArrayConstructor:function(e){if(c(e)&&(!y||b(N,e)))return e;throw new I(m(e)+" is not a typed array constructor")},exportTypedArrayMethod:function(e,t,s,n){if(r){if(s)for(var a in R){var i=l[a];if(i&&g(i.prototype,e))try{delete i.prototype[e]}catch(s){try{i.prototype[e]=t}catch(e){}}}P[e]&&!s||p(P,e,s?t:G&&S[e]||t,n)}},exportTypedArrayStaticMethod:function(e,t,s){var n,a;if(r){if(y){if(s)for(n in R)if((a=l[n])&&g(a,e))try{delete a[e]}catch(e){}if(N[e]&&!s)return;try{return p(N,e,s?t:G&&N[e]||t)}catch(e){}}for(n in R)!(a=l[n])||a[e]&&!s||p(a,e,t)}},getTypedArrayConstructor:O,isView:function(e){if(!d(e))return!1;var t=u(e);return"DataView"===t||g(R,t)||g(M,t)},isTypedArray:U,TypedArray:N,TypedArrayPrototype:P}},function(e,t,s){"use strict";e.exports="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof DataView},function(e,t,s){"use strict";var n=s(43).match(/firefox\/(\d+)/i);e.exports=!!n&&+n[1]},function(e,t,s){"use strict";var n=s(43);e.exports=/MSIE|Trident/.test(n)},function(e,t,s){"use strict";var n=s(43).match(/AppleWebKit\/(\d+)\./);e.exports=!!n&&+n[1]},function(e,t,s){"use strict";var n=s(16),a=s(111),i=s(30),o=s(23),r=s(31),l=s(112);n({target:"Array",proto:!0},{flatMap:function(e){var t,s=o(this),n=r(s);return i(e),t=l(s,0),a(t,s,s,n,0,1,e,arguments.length>1?arguments[1]:void 0),t}})},function(e,t,s){"use strict";s(42)("flatMap")},function(e,t,s){"use strict";s(172);var n=s(16),a=s(114);n({target:"String",proto:!0,name:"trimStart",forced:"".trimStart!==a},{trimStart:a})},function(e,t,s){"use strict";var n=s(16),a=s(114);n({target:"String",proto:!0,name:"trimStart",forced:"".trimLeft!==a},{trimLeft:a})},function(e,t,s){"use strict";var n=s(6),a=s(27),i=s(21),o=s(115),r=n("".replace),l=RegExp("^["+o+"]+"),c=RegExp("(^|[^"+o+"])["+o+"]+$"),d=function(e){return function(t){var s=i(a(t));return 1&e&&(s=r(s,l,"")),2&e&&(s=r(s,c,"$1")),s}};e.exports={start:d(1),end:d(2),trim:d(3)}},function(e,t,s){"use strict";var n=s(56).PROPER,a=s(7),i=s(115);e.exports=function(e){return a((function(){return!!i[e]()||"​᠎"!=="​᠎"[e]()||n&&i[e].name!==e}))}},function(e,t,s){"use strict";s.r(t);s(1),s(2);let n;var a=s(0),o=s.n(a);const r=new class{set(e,t){window.localStorage.setItem("esgst_"+e,t)}get(e,t){return window.localStorage.getItem("esgst_"+e)||t}delete(e){window.localStorage.removeItem("esgst_"+e)}};s(12),s(3),s(4),s(98);const l=new class{constructor(){o()(this,"getPlural",(e,t,s)=>1===e?t:null!=s?s:t+"s"),o()(this,"getQueryParams",(e=window.location.search)=>Object.fromEntries(e.replace(/^\?/,"").split(/&/).map(e=>e.split(/=/))))}_compareTypes(e,t){return Object.prototype.toString.call(e).toLowerCase()===`[object ${t}]`}_getPath(e){return e.split(/\.|\[|]/).filter(e=>e)}isDeepEqual(e,t){if(Array.isArray(e)&&Array.isArray(t))return e.length===t.length&&!e.find(([e,s])=>!this.isDeepEqual(e,t[s]));if(!("object"!=typeof e||"object"!=typeof t||e instanceof Node||t instanceof Node)){const s=Object.entries(e),n=Object.entries(t);return s.length===n.length&&!s.find(([e,s])=>!this.isDeepEqual(s,t[e]))}return e===t}getProperty(e,t){return Array.isArray(t)||(t=this._getPath(t)),t.reduce((e,t)=>e&&e[t]?e[t]:null,e)}hex2Rgba(e,t){if(1===parseFloat(t))return e;const s=e.match(/[\dA-Fa-f]{2}/g);if(!s)return"";return`rgba(${parseInt(s[0],16)}, ${parseInt(s[1],16)}, ${parseInt(s[2],16)}, ${t})`}is(e,t){if(!this.isSet(e))return!1;switch(t){case"number":return this._compareTypes(e,"number")&&!isNaN(e);case"object":return this._compareTypes(e,"object");case"string":return this._compareTypes(e,"string")}}isSet(e){return null!=e}rgba2Hex(e){const t=e.match(/rgba?\((\d+?),\s*(\d+?),\s*(\d+?)(,\s*(.+?))?\)/);if(!t)return{hex:e,alpha:1};return{hex:`#${("0"+parseInt(t[1]).toString(16)).slice(-2)}${("0"+parseInt(t[2]).toString(16)).slice(-2)}${("0"+parseInt(t[3]).toString(16)).slice(-2)}`,alpha:t[5]&&parseFloat(t[5])||1}}setProperty(e,t,s){Array.isArray(t)||(t=this._getPath(t));const n=t.pop();this.getProperty(e,t)[n]=s}sortArray(e,t,s){if(!this.isSet(e)||!Array.isArray(e))throw'The "array" argument is not an array';const n=t?-1:1;return e.sort((e,t)=>this.is(e,"object")&&this.is(t,"object")?this.is(s,"string")&&this.isSet(e[s])&&this.isSet(t[s])?this.is(e[s],"number")&&this.is(t[s],"number")?e[s]<t[s]?-1*n:e[s]>t[s]?n:0:e[s].localeCompare(t[s],{sensitivity:"base"})*n:0:this.is(e,"number")&&this.is(t,"number")?e<t?-1*n:e>t?n:0:e.localeCompare(t,{sensitivity:"base"})*n)}};const c=new class{constructor(){this.common=null,this.esgst=null,this.header=null,this.footer=null}add(e){for(let t in e)e.hasOwnProperty(t)&&(this[t]=e[t])}};const d=new class{constructor(){this.enableByDefault=!1,this.settings={},this.fullSettings={},this.aliases={},this.defaultValues={limitSteamStore_sg:!0,customAdaReqLim_default:.25,customAdaReqLim_minute50:.5,customAdaReqLim_minute75:1,customAdaReqLim_hourly75:1.5,customAdaReqLim_daily75:2,cgb_levelColors:[],ge_a_sg:!0,glwc_mm_sg:!1,glwc_checkMaxWishlists:!1,glwc_maxWishlists:500,es_g_sg:!0,es_d_sg:!0,es_c_sg:!0,es_c_st:!0,es_l_sg:!0,es_l_st:!0,es_t_st:!0,tds_forums:{},tds_minutes:10,ch_perLoad:5,df_perLoad:5,tf_perLoad:5,gs_sent_sg:!0,gs_received_sg:!0,gs_giftDifference_sg:!0,gs_valueDifference_sg:!0,gs_lastGiveaway_sg:!0,gs_users_sg:!0,deleteOldBackups:!1,deleteOldBackups_days:90,sfi_icon:"user",npth_previousRegex:"back|last|less|prev|<|←",npth_nextRegex:"forw|more|next|onwards?|►|>|→",permissionsDenied:[],egh_c_sg:!0,cewgd_c_sg:!0,cewgd_c_p_sg:!0,cewgd_c_sl_sg:!0,cewgd_c_t_sg:!0,cewgd_c_l_sg:!0,cewgd_c_w_sg:!0,cewgd_e_sg:!0,cewgd_e_p_sg:!0,cewgd_e_sl_sg:!0,cewgd_e_t_sg:!0,cewgd_e_l_sg:!0,cewgd_w_sg:!0,cewgd_w_p_sg:!0,cewgd_w_sl_sg:!0,cewgd_w_t_sg:!0,cewgd_w_l_sg:!0,esgst_st:!0,esgst_sgt:!0,ge_extractOnward:!1,ge_flushCache:!1,ge_flushCacheHours:24,ge_ignoreDiscussionComments:!1,ge_ignoreGiveawayComments:!1,cv_username:"%username%",cv_steamId:"%steamId%",cv_creator:"%creator%",cv_replyUser:"%replyUser%",cv_esgstFeature:"%esgst=(.+?)%",cgc_dateFormat:"M d, yy",cgc_timeFormat:"H:mm",cgc_index_0:1,collapse_general:!1,collapse_giveaways:!1,collapse_discussions:!1,collapse_trades:!1,collapse_comments:!1,collapse_users:!1,collapse_groups:!1,collapse_games:!1,collapse_others:!1,collapse_element_ordering:!1,collapse_steam_api_key:!1,gc_e_color:"#a59d7c",gc_e_bColor:"#e0e0a8",gc_e_bgColor:"#e9e9ca",at_format:"MMM d, yyyy, H:mm:ss",plt_format:"MMM d, yyyy, H:mm:ss",vgb_index:1,vgb_wonFormat:"([FCV] FCV / [RCV] RCV / [NCV] NCV / [NR] NR)",vgb_sentFormat:"([FCV] FCV / [RCV] RCV / [NCV] NCV / [A] A / [NR] NR)",ul_links:[{label:"https://cdn.steamtrades.com/img/favicon.ico",url:"https://www.steamtrades.com/user/%steamid%"},{label:"https://steamcdn-a.akamaihd.net/steamcommunity/public/images/avatars/79/7967e1ee4973a92886fe737d90f0a0b20b6f94a1_full.jpg",url:"https://www.backlog-assassins.net/users/+%steamid%"},{label:"https://steamcdn-a.akamaihd.net/steamcommunity/public/images/avatars/91/91b23515a62b46eaa46cedab5bbe8085aa11ce1d_full.jpg",url:"https://www.playingappreciated.com/profile.php?u=%steamid%"},{label:"https://steamcdn-a.akamaihd.net/steamcommunity/public/images/avatars/0a/0a603fdbfb5d1283132c6558390ef71c1f48fc51_full.jpg",url:"https://touhou.justarchi.net/user/%steamid%/profile"},{label:"https://steamcdn-a.akamaihd.net/steamcommunity/public/images/avatars/1a/1ad341114c26138740b405595f9ecf140f6b647f_full.jpg",url:"https://astats.astats.nl/astats/User_Info.php?steamID64=%steamid%"},{label:"https://steamcdn-a.akamaihd.net/steamcommunity/public/images/avatars/41/41d0a0ca20c6b460c10e03c6ff8ef23bc6bb7f9d_full.jpg",url:"https://barter.vg/steam/%steamid%"},{label:"SteamRep",url:"https://steamrep.com/profiles/%steamid%"}],cgb_b_bgColor:"#f2d9dc",cgb_p_bgColor:"#f2e6dc",cgb_io_bgColor:"#d8d9dc",cgb_rr_bgColor:"#e5d9f6",cgb_g_bgColor:"#d8f3dc",cgb_w_bgColor:"#d8e6f6",cgb_sgt_bgColor:"#d8f3e9",qgs_index:0,lpv_barColor:"#609f60",lpv_projectedBarColor:"rgba(96, 159, 96, 0.5)",lpv_barColorHover:"#6dac6d",lpv_projectedBarColorHover:"rgba(122, 185, 122, 0.5)",lpv_barColorSelected:"#7ab97a",lpv_projectedBarColorSelected:"rgba(147, 210, 147, 0.5)",pv_barColor:"#609f60",pv_barColorHover:"#6dac6d",pv_barColorSelected:"#7ab97a",giveawayLinks:["entries","winners_count","comments"],giveawayLinks_gv:["entries","winners_count","comments"],giveawayExtraPanel:["ggl"],giveawayExtraPanel_gv:["ggl"],giveawayHeading:["gr","gb","gf","egh","name","points","copies","steam","screenshots-videos","search","hideGame","gt"],giveawayHeading_gv:["gr","gb","gf","egh","name","points","copies","steam","screenshots-videos","search","hideGame","gt"],nrf_clearCache:!1,dt_s_sg:!0,gt_s_sg:!0,gt_s_st:!0,gpt_s_sg:!0,gpt_s_st:!0,ut_s_sg:!0,ut_s_st:!0,gc_si_sg:!0,es_pages:1,backupZip_sg:!1,backupZip_st:!1,gc_hltb_index_0:0,gc_hltb_index_1:0,gc_hltb_index_2:0,gc_rt_sg:!0,ugd_playtime:0,ugd_achievements:0,ct_o_sg:!0,ct_o_st:!0,ct_fop_sg:!0,ct_fop_st:!0,ct_f_sg:!0,ct_f_st:!0,gf_m_b_sg:!1,gf_m_a_sg:!1,df_m_b_sg:!1,df_m_a_sg:!1,tf_m_b_st:!1,tf_m_a_st:!1,cf_m_b_sg:!1,cf_m_a_sg:!1,gf_presets:[],df_presets:[],tf_presets:[],gmf_presets:[],gpf_presets:[],cf_presets:[],chfl_key:"ctrlKey + e",getSyncGameNames_sg:!1,getSyncGameNames_st:!1,sgDarkGrey_startTime:"00:00",sgDarkGrey_endTime:"23:59",sgv2Dark_startTime:"00:00",sgv2Dark_endTime:"23:59",steamGiftiesBlack_startTime:"00:00",steamGiftiesBlack_endTime:"23:59",steamGiftiesBlue_startTime:"00:00",steamGiftiesBlue_endTime:"23:59",steamTradiesBlackBlue_startTime:"00:00",steamTradiesBlackBlue_endTime:"23:59",mm_useRegExp:!1,mm_enableGiveaways:!1,mm_enableDiscussions:!1,mm_enableUsers:!1,mm_enableGames:!1,cs_limitPages:!1,cs_minPage:"",cs_maxPage:"",ge_sgt_limit:1,filter_os:0,filter_giveaways_exist_in_account:0,filter_giveaways_missing_base_game:0,filter_giveaways_level:0,filter_giveaways_additional_games:0,dismissedOptions:[],hr_g_format:"🏆",hr_w_format:"(#❤)",hr_p_format:"(#P)",hr_fp_points:400,ef_filters:"",gwc_h_width:"3px",gwr_h_width:"3px",chfl_giveaways_sg:["createANewGiveaway","communityWishlist","viewCreated","viewEntered","viewWon",{color:"grey",description:"View your hidden games.",icon:"fa-eye",id:"hiddenGames",name:"Hidden Games",url:"/account/settings/giveaways/filters"},{color:"grey",description:"Check if a game receives reduced CV.",icon:"fa-calendar-minus-o",id:"reducedCvGames",name:"Reduced CV Games",url:"/bundle-games"},{id:"browseWishlistGiveaways",name:"Browse Wishlist Giveaways",url:"/giveaways/search?type=wishlist"},{id:"browseFollowedGiveaways",name:"Browse Followed Giveaways",url:"/giveaways/search?esgst=fgp"},{id:"browseRecommendedGiveaways",name:"Browse Recommended Giveaways",url:"/giveaways/search?type=recommended"},{id:"browseGroupGiveaways",name:"Browse Group Giveaways",url:"/giveaways/search?type=group"},{id:"browseNewGiveaways",name:"Browse New Giveaways",url:"/giveaways/search?type=new"}],chfl_discussions_sg:["createANewDiscussion","viewCreated","viewBookmarked",{id:"browseAdd",name:"Browse Add-ons / Tools",url:"/discussions/addons-tools"},{id:"browseAnnouncements",name:"Browse Announcements",url:"/discussions/announcements"},{id:"browseBugs",name:"Browse Bugs / Suggestions",url:"/discussions/bugs-suggestions"},{id:"browseDeals",name:"Browse Deals",url:"/discussions/deals"},{id:"browseGameShowcase",name:"Browse Game Showcase",url:"/discussions/game-showcase"},{id:"browseGeneral",name:"Browse General",url:"/discussions/general"},{id:"browseGroupRecruitment",name:"Browse Group Recruitment",url:"/discussions/group-recruitment"},{id:"browseHardware",name:"Browse Hardware",url:"/discussions/hardware"},{id:"browseHelp",name:"Browse Help",url:"/discussions/help"},{id:"browseLet",name:"Browse Let's Play Together",url:"/discussions/lets-play-together"},{id:"browseMovies",name:"Browse Movies / TV",url:"/discussions/movies-tv"},{id:"browseOffTopic",name:"Browse Off Topic",url:"/discussions/off-topic"},{id:"browsePuzzles",name:"Browse Puzzles / Events",url:"/discussions/puzzles-events"},{id:"browseUncategorized",name:"Browse Uncategorized",url:"/discussions/uncategorized"},{id:"browseUserProjects",name:"Browse User Projects",url:"/discussions/user-projects"},{id:"browseWhitelist",name:"Browse Whitelist / Recruitment",url:"/discussions/whitelist-recruitment"}],chfl_support_sg:["createANewTicket",{color:"grey",description:"Check a user`s real CV.",icon:"fa-dollar",id:"realCv",name:"Real CV",url:"https://www.sgtools.info/real-cv"},{color:"red",description:"Check if a user has not activated wins.",icon:"fa-exchange",id:"notActivatedWins",name:"Not Activated Wins",url:"https://www.sgtools.info/activation"},{color:"red",description:"Check if a user has multiple wins.",icon:"fa-clone",id:"multipleWins",name:"Multiple Wins",url:"https://www.sgtools.info/multiple-wins"},{color:"grey",description:"Check the last bundled games.",icon:"fa-percent",id:"lastBundled",name:"Last Bundled",url:"https://www.sgtools.info/lastbundled"}],chfl_help_sg:["commentFormatting","faq","guidelines",{color:"grey",description:"View SteamGifts` change log.",icon:"fa-file-text-o",id:"changeLog",name:"Change Log",url:"/discussion/e9zDo/"}],chfl_account_sg:["syncWithSteam","myStats","myEntryHistory","myCommentHistory",{color:"blue",icon:"fa-heart",id:"whitelist",name:"Whitelist",url:"/account/manage/whitelist"},{color:"red",icon:"fa-ban",id:"blacklist",name:"Blacklist",url:"/account/manage/blacklist"},{color:"grey",icon:"fa-folder",id:"games",name:"Games",url:"/account/steam/games"},{color:"grey",icon:"fa-user",id:"groups",name:"Groups",url:"/account/steam/groups"},{color:"grey",icon:"fa-star",id:"wishlist",name:"Wishlist",url:"/account/steam/wishlist"}],chfl_footer_sg:["archive","stats","roles","users","steamGroup","chat","privacyPolicy","cookiePolicy","termsOfService","advertise"],chfl_trades_st:["newTrade","myTrades"],chfl_account_st:["reviews","comments","settings"],chfl_footer_st:["guidelines","commentFormatting","privacyPolicy","cookiePolicy","termsOfService","advertise"],cdr_days:7,cdr_aDays:7,hgm_addOwned:!1,hgm_addIgnored:!1,hgm_addBanned:!1,hgm_removeTextArea:!1,hgm_removeOwned:!1,hgm_removeWishlisted:!1,hgm_removeFollowed:!1,hgm_removeTagged:!1,hgm_tags:[],hgm_removeBanned:!1,giveawayColumns:["ged","endTime","winners","startTime","touhou","inviteOnly","whitelist","group","regionRestricted","level"],giveawayPanel:["ttec","gwc","gwr","gptw","gp","elgb","sgTools"],giveawayColumns_gv:["sgTools","ged","time","touhou","inviteOnly","whitelist","group","regionRestricted","level"],giveawayPanel_gv:["ttec","gwc","gwr","gptw","gp","elgb"],enableByDefault_sg:!1,enableByDefault_st:!1,cf_m_sg:!0,collapseSections_sg:!1,collapseSections_st:!1,df_m_sg:!0,elgb_d_sg:!0,gb_ue_sg:!0,gc_g_s_sg:!1,ge_o_sg:!1,gf_m_sg:!0,gwc_a_b_sg:!1,gwr_a_b_sg:!1,hpg_sg:!1,pm_a:!1,radb_sg:!0,adtd_sg:!1,activeDiscussions_displayed:7,showChangelog_sg:!0,showChangelog_st:!0,vai_i_sg:!1,avatar:"",steamId:"",steamApiKey:"",username_sg:"",username_st:"",registrationDate_sg:0,adots_index:0,ags_type:"",ags_maxDate:"",ags_minDate:"",ags_maxScore:"",ags_minScore:"",ags_maxLevel:"",ags_minLevel:"",ags_maxEntries:"",ags_minEntries:"",ags_maxCopies:"",ags_minCopies:"",ags_maxPoints:"",ags_minPoints:"",ags_regionRestricted:!1,ags_dlc:!1,ags_app:!1,ags_sub:!1,ap_index:0,plt_index:0,as_searchAppId:!1,autoBackup_days:1,autoBackup_index:0,autoSyncGroups:0,autoSyncWhitelist:0,autoSyncBlacklist:0,autoSyncSteamFriends:0,autoSyncHiddenGames:0,autoSyncGames:0,autoSyncFollowedGames:0,autoSyncWonGames:0,autoSyncReducedCvGames:0,autoSyncNoCvGames:0,autoSyncHltbTimes:0,autoSyncDelistedGames:0,autoSyncGiveaways:0,autoSyncWonGiveaways:0,calculateDelete:!0,calculateExport:!0,calculateImport:!0,cf_enable:!0,cf_preset:null,cfh_pasteFormatting:!0,cfh_img_choice:1,cfh_img_remember:!1,cleanDiscussions:!0,cleanEntries:!0,cleanGiveaways:!0,cleanSgCommentHistory:!0,cleanStCommentHistory:!0,cleanTickets:!0,cleanTrades:!0,cleanDuplicates:!0,cleanDiscussions_days:30,cleanEntries_days:30,cleanGiveaways_days:30,cleanSgCommentHistory_days:30,cleanStCommentHistory_days:30,cleanTickets_days:30,cleanTrades_days:30,df_enable:!0,df_enableCreated:!1,df_preset:null,df_presetCreated:null,tf_enable:!0,tf_enableCreated:!1,tf_preset:null,tf_presetCreated:null,gmf_enable:!0,gmf_preset:null,gpf_enable:!0,gpf_preset:null,ds_auto:!1,ds_option:"sortIndex_asc",elgb_filters:".|(bestof|(g(ood)?)?)(l(uck)?)?(h(ave)?)?(f(un)?)?|enjoy|(h(umble)?)?(b(undle)?)?(g(ift)?)?(l(ink)?)?",exportBackup:!0,exportBackupIndex:0,gas_auto:!1,gas_option:"sortIndex_asc",gas_autoWishlist:!1,gas_optionWishlist:"sortIndex_asc",gas_autoRecommended:!1,gas_optionRecommended:"sortIndex_asc",gas_autoGroup:!1,gas_optionGroup:"sortIndex_asc",gas_autoNew:!1,gas_optionNew:"sortIndex_asc",gas_autoEntered:!1,gas_optionEntered:"sortIndex_asc",gas_autoUser:!1,gas_optionUser:"sortIndex_asc",gas_autoGroups:!1,gas_optionGroups:"sortIndex_asc",gas_autoPopup:!1,gas_optionPopup:"sortIndex_asc",gb_hours:1,gc_categories:["gc_gi","gc_r","gc_hltb","gc_ocv","gc_fcv","gc_rcv","gc_ncv","gc_h","gc_i","gc_o","gc_w","gc_f","gc_pw","gc_a","gc_bd","gc_bvg","gc_sp","gc_mp","gc_sc","gc_tc","gc_l","gc_m","gc_ea","gc_lg","gc_rm","gc_dlc","gc_p","gc_rd","gc_g"],gc_categories_gv:["gc_gi","gc_r","gc_hltb","gc_ocv","gc_fcv","gc_rcv","gc_ncv","gc_h","gc_i","gc_o","gc_w","gc_f","gc_pw","gc_a","gc_bd","gc_bvg","gc_sp","gc_mp","gc_sc","gc_tc","gc_l","gc_m","gc_ea","gc_lg","gc_rm","gc_dlc","gc_p","gc_rd","gc_g"],gc_o_altAccounts:[],gc_g_colors:[],gc_g_filters:"",gc_r_colors:[{bgColor:"#a34c25",color:"#ffffff",icon:"thumbs-down",lower:0,upper:39},{bgColor:"#b9a074",color:"#ffffff",icon:"minus-circle",lower:40,upper:69},{bgColor:"#66c0f4",color:"#ffffff",icon:"thumbs-up",lower:70,upper:100}],gc_ocvIcon:"history",gc_fcvIcon:"calendar",gc_rcvIcon:"calendar-minus-o",gc_ncvIcon:"calendar-times-o",gc_hIcon:"eye-slash",gc_iIcon:"ban",gc_oIcon:"folder",gc_wIcon:"heart",gc_fIcon:"plus",gc_pwIcon:"gift",gc_aIcon:"trophy",gc_bdIcon:"times",gc_bvgIcon:"retweet",gc_spIcon:"user",gc_mpIcon:"users",gc_scIcon:"cloud",gc_tcIcon:"clone",gc_lIcon:"linux",gc_mIcon:"apple",gc_eaIcon:"unlock",gc_lgIcon:"spinner",gc_rmIcon:"trash",gc_dlcIcon:"download",gc_pIcon:"suitcase",gc_rdIcon:"clock-o",gc_hltbIcon:"gamepad",gc_ocvLabel:"Was ",gc_fcvLabel:"Full CV",gc_rcvLabel:"Reduced CV",gc_ncvLabel:"No CV",gc_hLabel:"Hidden",gc_iLabel:"Ignored",gc_oLabel:"Owned",gc_wLabel:"Wishlisted",gc_fLabel:"Followed",gc_pwLabel:"Previously Won",gc_aLabel:"Achievements",gc_bdLabel:"Banned",gc_bvgLabel:"Barter.vg",gc_spLabel:"Singleplayer",gc_mpLabel:"Multiplayer",gc_scLabel:"Steam Cloud",gc_tcLabel:"Trading Cards",gc_lLabel:"Linux",gc_mLabel:"Mac",gc_eaLabel:"Early Access",gc_lgLabel:"Learning",gc_rmLabel:"Removed",gc_dlcLabel:"DLC",gc_pLabel:"Package",gc_rdLabel:"Mon DD, YYYY",gc_hltbLabel:"HowLongToBeat: ",gc_ocvUrl:"https://www.steamgifts.com/bundle-games/search?q=%game-search-name%",gc_fcvUrl:"https://www.steamgifts.com/bundle-games/search?q=%game-search-name%",gc_rcvUrl:"https://www.steamgifts.com/bundle-games/search?q=%game-search-name%",gc_ncvUrl:"https://www.steamgifts.com/bundle-games/search?q=%game-search-name%",gc_hUrl:"https://www.steamgifts.com/account/settings/giveaways/filters/search?q=%game-search-name%",gc_iUrl:"https://store.steampowered.com/%game-type%/%game-id%",gc_oUrl:"https://www.steamgifts.com/account/steam/games/search?q=%game-search-name%",gc_o_aUrl:"https://steamcommunity.com/profiles/%steam-id%/games",gc_wUrl:"https://www.steamgifts.com/account/steam/wishlist/search?q=%game-search-name%",gc_fUrl:"https://steamcommunity.com/my/followedgames/",gc_pwUrl:"https://www.steamgifts.com/user/%username%/giveaways/won/search?q=%game-search-name%",gc_giUrl:"https://www.steamgifts.com/user/%username%",gc_rUrl:"https://store.steampowered.com/%game-type%/%game-id%",gc_aUrl:"https://steamcommunity.com/stats/%game-id%/achievements",gc_bdUrl:"https://steamdb.info/app/%game-id%",gc_bvgUrl:"https://barter.vg/steam/%game-type%/%game-id%",gc_spUrl:"https://store.steampowered.com/%game-type%/%game-id%",gc_mpUrl:"https://store.steampowered.com/%game-type%/%game-id%",gc_scUrl:"https://store.steampowered.com/%game-type%/%game-id%",gc_tcUrl:"https://www.steamcardexchange.net/index.php?gamepage-%game-type%id-%game-id%",gc_lUrl:"https://store.steampowered.com/%game-type%/%game-id%",gc_mUrl:"https://store.steampowered.com/%game-type%/%game-id%",gc_eaUrl:"https://store.steampowered.com/%game-type%/%game-id%",gc_lgUrl:"https://store.steampowered.com/%game-type%/%game-id%",gc_rmUrl:"https://steamdb.info/%game-type%/%game-id%",gc_dlcUrl:"https://store.steampowered.com/%game-type%/%game-id%",gc_pUrl:"https://store.steampowered.com/%game-type%/%game-id%",gc_rdUrl:"https://store.steampowered.com/%game-type%/%game-id%",gc_gUrl:"https://store.steampowered.com/%game-type%/%game-id%",gc_hltbUrl:"https://howlongtobeat.com/game.php?id=%hltb-id%",gc_h_color:"#ffffff",gc_hltb_color:"#ffffff",gc_gi_color:"#ffffff",gc_ocv_fcv_color:"#ffffff",gc_ocv_rcv_color:"#ffffff",gc_fcv_color:"#ffffff",gc_rcv_color:"#ffffff",gc_ncv_color:"#ffffff",gc_w_color:"#ffffff",gc_f_color:"#ffffff",gc_o_color:"#ffffff",gc_pw_color:"#ffffff",gc_i_color:"#ffffff",gc_lg_color:"#ffffff",gc_rm_color:"#ffffff",gc_ea_color:"#ffffff",gc_tc_color:"#ffffff",gc_a_color:"#ffffff",gc_bd_color:"#ffffff",gc_bvg_color:"#ffffff",gc_sp_color:"#ffffff",gc_mp_color:"#ffffff",gc_sc_color:"#ffffff",gc_l_color:"#ffffff",gc_m_color:"#ffffff",gc_dlc_color:"#ffffff",gc_p_color:"#ffffff",gc_rd_color:"#ffffff",gc_g_color:"#ffffff",gc_h_bgColor:"#e74c3c",gc_hltb_bgColor:"#328ed6",gc_gi_bgColor:"#555555",gc_ocv_fcv_bgColor:"#641e16",gc_ocv_rcv_bgColor:"#641e16",gc_fcv_bgColor:"#641e16",gc_rcv_bgColor:"#641e16",gc_ncv_bgColor:"#641e16",gc_o_bgColor:"#16a085",gc_o_t_bgColor:"rgba(22, 160, 133, 0.2)",gc_o_a_t_bgColor:"rgba(100, 30, 22, 0.2)",gc_w_bgColor:"#3498db",gc_w_t_bgColor:"rgba(52, 152, 219, 0.2)",gc_f_bgColor:"#2084C7",gc_pw_bgColor:"#16a085",gc_i_bgColor:"#e74c3c",gc_i_t_bgColor:"rgba(231, 76, 60, 0.2)",gc_lg_bgColor:"#555555",gc_rm_bgColor:"#e74c3c",gc_ea_bgColor:"#3498db",gc_tc_bgColor:"#2ecc71",gc_a_bgColor:"#145a32",gc_bd_bgColor:"#e74c3c",gc_bvg_bgColor:"#555555",gc_sp_bgColor:"#5eb2a1",gc_mp_bgColor:"#0e6251",gc_sc_bgColor:"#154360",gc_l_bgColor:"#f39c12",gc_m_bgColor:"#d35400",gc_dlc_bgColor:"#8e44ad",gc_p_bgColor:"#8e44ad",gc_p_t_bgColor:"rgba(142, 68, 173, 0.2)",gc_rd_bgColor:"#7f8c8d",gc_g_bgColor:"#7f8c8d",gcl_index:0,ged:!0,gf_enable:!0,gf_enableWishlist:!0,gf_enableRecommended:!0,gf_enableNew:!0,gf_enableGroup:!0,gf_enableCreated:!0,gf_enableEntered:!0,gf_enableWon:!0,gf_enableGroups:!0,gf_enableUser:!0,gf_enableGb:!0,gf_enableGe:!0,gf_enableGed:!0,cf_enableElgb:!0,gf_preset:null,gf_presetWishlist:null,gf_presetRecommended:null,gf_presetNew:null,gf_presetGroup:null,gf_presetCreated:null,gf_presetEntered:null,gf_presetWon:null,gf_presetGroups:null,gf_presetUser:null,gf_presetGb:null,gf_presetGe:null,gf_presetGed:null,cf_presetElgb:null,ggl_index:0,dt_colors:{},gpt_colors:{},gt_colors:{},gts_preciseStart:!1,gts_preciseEnd:!1,gts_preciseStartDate:!1,gts_preciseEndDate:!1,gv_spacing:0,gch_colors:[],glh_colors:[],gwc_colors:[],gwr_colors:[],gptw_colors:[],geth_colors:[],hr_minutes:1,hr_w_hours:24,lastBackup:0,lastSyncGroups:0,lastSyncWhitelist:0,lastPageWhitelist:0,lastSyncBlacklist:0,lastPageBlacklist:0,lastSyncSteamFriends:0,lastSyncHiddenGames:0,lastPageHiddenGames:0,lastSyncGames:0,lastSyncFollowedGames:0,lastSyncWonGames:0,lastSyncReducedCvGames:0,lastSyncNoCvGames:0,lastSyncHltbTimes:0,lastSyncDelistedGames:0,lastSyncGiveaways:0,lastSyncWonGiveaways:0,leftMainPageHeadingIds:["wbsDesc","wbsAsc","wbm","wbc","usc","ugs","uf_s_s","tf_s_s","tf","tb","sks","rbp","namwc","mpp","hgm","gv","gts","glwc","gf_s_s","gf","ge","gas","ds","df_s_s","df","ctUnread","ctRead","ctGo","cs","cf","cec","as","aic"],leftButtonIds:[],mgc_createTrain:!0,mgc_bumpLast:!0,mgc_groupKeys:!1,mgc_groupAllKeys:!1,mgc_reversePosition:!1,mgc_removeLinks:!0,namwc_checkNotActivated:!1,namwc_checkMultiple:!1,npth_previousKey:"ArrowLeft",npth_nextKey:"ArrowRight",nrf_searchMultiple:!1,rightMainPageHeadingIds:["esResume","esPause","esContinuous","esNext","esRefresh","esRefreshAll","stbb","sttb","mm"],rightButtonIds:[],sal_index:2,sk_closePopups:"escape",sk_searchBox:"ctrlKey + q",sk_firstPage:"ctrlKey + arrowup",sk_previousPage:"ctrlKey + arrowleft",sk_nextPage:"ctrlKey + arrowright",sk_lastPage:"ctrlKey + arrowdown",sk_toggleFilters:"altKey + q",sk_hideGame:"altKey + g",sk_hideGiveaway:"altKey + h",sk_giveawayEntry:"ctrlKey + enter",sk_creator:"altKey + c",sk_replyBox:"ctrlKey +  ",sk_replyUser:"altKey + u",sk_submitReply:"ctrlKey + enter",sks_exportKeys:!1,sks_searchCurrent:!1,sks_limitDate:!1,sks_limitPages:!1,sks_minDate:"",sks_maxDate:"",sks_minPage:"",sks_maxPage:"",stbb_index:0,sttb_index:0,syncGroups:!1,syncWhitelist:!1,syncBlacklist:!1,syncSteamFriends:!1,syncHiddenGames:!1,syncGames:!1,syncFollowedGames:!1,syncWonGames:!1,syncReducedCvGames:!1,syncNoCvGames:!1,syncHltbTimes:!1,syncDelistedGames:!1,syncGiveaways:!1,syncWonGiveaways:!1,ugd_getPlaytime:!0,ugd_getAchievements:!1,ugd_clearCache:!1,ugs_checkRules:!1,ugs_checkWhitelist:!1,ugs_checkBlacklist:!1,ugs_checkMember:!1,ugs_checkDifference:!1,ugs_difference:0,ut_colors:{},wbc_hb_sg:!1,usc_checkSingle:!1,usc_checkAll:!1,usc_checkPages:!1,usc_minPage:"",usc_maxPage:"",usc_checkSelected:!1,wbc_checkSingle:!1,wbc_checkBlacklist:!1,wbc_checkAll:!1,wbc_checkPages:!1,wbc_minPage:"",wbc_maxPage:"",wbc_returnWhitelists:!1,wbc_returnBlacklists:!1,wbc_checkSelected:!1,wbc_checkFromList:!1,wbc_userList:[],wbc_pages:0,wbc_skipUsers:!1,wbm_clearTags:!1,wbm_useCache:!1,wbm_exportSteamIds:!1,wbm_tags:[],wbc_checkNew:!1,wbc_clearCache:!1,wbh_w_color:"#ffffff",wbh_w_bgColor:"#228b22",wbh_b_color:"#ffffff",wbh_b_bgColor:"#ff4500"},this.oldValues={df_puzzles_sg:"df_puzzlesEvents_sg",gc_o_a_sg:()=>this.settings.gc_o_altAccounts&&this.settings.gc_o_altAccounts.length>0?1:0,idb_sg:"dh_sg",idb_t_sg:"dh_t_sg",cl_gc_index:()=>(this.settings.gcl_index||0)+1,cl_gi_index:()=>(this.settings.ap_index||0)+1,cl_ui_index:()=>(this.settings.ap_index||0)+1,cl_sg:()=>this.settings.ap_sg||this.settings.gcl_sg||this.settings.ggl_sg,cl_gc_sg:"gcl_sg",cl_gi_sg:"ggl_sg",cl_ui_sg:"ap_sg",gs_type_sg:"gs_t_sg",uf_gp_sg:"uf_p_sg",uf_dp_sg:"uf_p_sg",makeSectionsCollapsible_sg:"makeSecionsCollapsible_sg",makeSectionsCollapsible_st:"makeSecionsCollapsible_st",collapse_general:"collapseSections_sg",collapse_giveaways:"collapseSections_sg",collapse_discussions:"collapseSections_sg",collapse_trades:"collapseSections_sg",collapse_comments:"collapseSections_sg",collapse_users:"collapseSections_sg",collapse_groups:"collapseSections_sg",collapse_games:"collapseSections_sg",collapse_others:"collapseSections_sg",collapse_element_ordering:"collapseSections_sg",collapse_steam_api_key:"collapseSections_sg",hgm_sg:"hgr_sg",hgm_removeOwned:"hgr_removeOwned",hgm_removeWishlisted:"hgr_removeWishlisted",mm_useRegExp:"gm_useRegExp",mm_enableGiveaways:"gm_enable",mm_enableDiscussions:"gm_enable",mm_enableUsers:"gm_enable",mm_enableGames:"gm_enable",pl_sg:"wbl_sg",pl_w_sg:"wbl_sg",pl_b_sg:"wbl_sg",gdttt_vg_sg:"gdttt_v_sg",gdttt_vd_sg:"gdttt_v_sg",gdttt_vt_sg:"gdttt_v_sg",gdttt_vts_st:"gdttt_v_st",wbc_hb_sg:"wbc_b_sg",wbc_checkBlacklist:"wbc_checkWhitelist"}}init(){const e=c.esgst.settings,t=e["enableByDefault_"+c.esgst.name];this.enableByDefault=!!("object"==typeof t?t.enabled:t);for(const t of Object.keys(e)){const s=t.match(/(.+?)_(sg|st|sgt)$/);s?s[2]===c.esgst.name&&(this.settings[t]=this.settings[s[1]]=e[t]):this.settings[t]=e[t]}for(const e of Object.keys(this.oldValues).concat(Object.keys(this.defaultValues))){const t=e.replace(new RegExp(`(.+?)_${c.esgst.name}$`),"$1");l.isSet(this.settings[t])||(this.settings[e]=this.settings[t]=this.getSetting(e))}for(const e of Object.keys(c.esgst.featuresById)){const t=c.esgst.featuresById[e];if(c.common.dismissFeature(t,e),t.alias&&(this.aliases[e]=t.alias,this.aliases[e+"_sg"]=t.alias+"_sg",this.aliases[e+"_st"]=t.alias+"_st"),t.sg){const s=this.getFeatureSetting(t,e,"sg");this.settings[e+"_sg"]=s.current,this.fullSettings[e+"_sg"]=s.full}if(t.st){const s=this.getFeatureSetting(t,e,"st");this.settings[e+"_st"]=s.current,this.fullSettings[e+"_st"]=s.full}this.settings[e]=this.settings[`${e}_${c.esgst.name}`],this.fullSettings[e]=this.fullSettings[`${e}_${c.esgst.name}`]}}set(e,t){var s;this.settings[null!==(s=this.aliases[e])&&void 0!==s?s:e]=t}get(e){var t;return this.settings[null!==(t=this.aliases[e])&&void 0!==t?t:e]}setFull(e,t){var s;this.fullSettings[null!==(s=this.aliases[e])&&void 0!==s?s:e]=t}getFull(e){var t;return this.fullSettings[null!==(t=this.aliases[e])&&void 0!==t?t:e]}getSetting(e){let t=c.esgst.settings[e];if(void 0===t){const s=this.oldValues[e];if("function"==typeof s?t=s():void 0!==s&&(t=c.esgst.settings[s]),void 0===t){let s=this.defaultValues[e];void 0===s&&(s=this.enableByDefault||0),t=s}else e.match(/^(wbc_checkBlacklist|wbc_hb_sg)$/)&&(t=!t)}return t}getFeaturePath(e,t,s){e||(e=c.esgst.featuresById[t]);const n=`${t}_${s}`;let a=c.esgst.settings[n];return void 0!==a&&a.include&&Array.isArray(a.include)||(a={enabled:this.getSetting(n)?1:0,include:[],exclude:[],new:void 0===a},e[s].include?(a.include=e[s].include,e[s].exclude&&(a.exclude=e[s].exclude)):a.include=[{enabled:a.enabled,pattern:".*"}],a.new&&a.enabled&&(a.include[0].enabled=1)),a}getFeatureSetting(e,t,s,n){let a=null,i=!1;if(e[s]&&(a=this.getFeaturePath(e,t,s),a.enabled)){n||(n=`${window.location.pathname}${window.location.search}`);let e=a.include.length-1;for(;e>-1&&(!a.include[e].enabled||!n.match(new RegExp(a.include[e].pattern)));)e--;for(e>-1&&(i=a.include[e]||!0),e=a.exclude.length-1;e>-1&&(!a.exclude[e].enabled||!n.match(new RegExp(a.exclude[e].pattern)));)e--;e>-1&&(i=!1)}return{full:a,current:i}}};const g=new class{constructor(){o()(this,"queue",{}),o()(this,"isChecking",!1),o()(this,"isCheckingLocalRequests",!1),o()(this,"init",async()=>{await this.loadRequestThreshold(),this.continuouslyCheck(),this.continuouslyCheckLocalRequests()}),o()(this,"continuouslyCheck",()=>{this.check(),setTimeout(this.continuouslyCheck,100)}),o()(this,"check",()=>{if(this.isChecking)return;this.isChecking=!0;const e=Date.now();for(const[t,s]of Object.entries(this.queue)){if(0===s.requests.length)continue;const n=this.getLastRequest(t);if(0===n||e-s.threshold>n){this.setLastRequest(t,e);const n=s.requests.shift();n&&n()}}this.isChecking=!1}),o()(this,"getLastRequest",e=>parseInt(r.get("request_"+e,"0"))),o()(this,"setLastRequest",(e,t)=>{r.set("request_"+e,t.toString())}),o()(this,"continuouslyCheckLocalRequests",async()=>{await this.checkLocalRequests(),setTimeout(this.continuouslyCheckLocalRequests,15e3)}),o()(this,"checkLocalRequests",async()=>{if(this.isCheckingLocalRequests||!this.queue.sg.wasRequesting)return;this.isCheckingLocalRequests=!0,this.queue.sg.wasRequesting=!1,this.queue.sg.thresholds||(this.queue.sg.thresholds=await this.getRequestThresholds());const e=new Date,t=e.getTime(),s=e.getDate(),n=e.getHours(),a=e.getMinutes();let i=0,o=0,r=0,l=await this.getRequestLog();l=l.filter(e=>t-e.timestamp<=864e5);for(const e of l){const t=new Date(e.timestamp),l=t.getDate(),c=t.getHours(),d=t.getMinutes();if(l!==s)break;r+=1,c===n&&(o+=1,d===a&&(i+=1))}r>.75*this.queue.sg.day_limit?this.queue.sg.threshold=1e3*this.queue.sg.thresholds.daily75:o>.75*this.queue.sg.hour_limit?this.queue.sg.threshold=1e3*this.queue.sg.thresholds.hourly75:i>.75*this.queue.sg.minute_limit?this.queue.sg.threshold=1e3*this.queue.sg.thresholds.minute75:i>.5*this.queue.sg.minute_limit?this.queue.sg.threshold=1e3*this.queue.sg.thresholds.minute50:this.queue.sg.threshold=1e3*this.queue.sg.thresholds.default,this.isCheckingLocalRequests=!1}),o()(this,"loadRequestThreshold",async()=>{this.queue.sg.thresholds=await this.getRequestThresholds(),this.queue.sg.threshold=1e3*this.queue.sg.thresholds.default}),o()(this,"getRequestThresholds",async()=>{if(d.get("useCustomAdaReqLim")){const t={};for(const[s,n]of Object.entries(this.queue.sg.minThresholds)){var e;t[s]=parseFloat(null!==(e=d.get("customAdaReqLim_"+s))&&void 0!==e?e:0),t[s]<n&&(t[s]=n)}return t}return{...this.queue.sg.minThresholds}}),o()(this,"getRequestLog",async()=>c.esgst.requestLog),o()(this,"enqueue",e=>{const t=new Promise(t=>{var s;this.queue[e]=null!==(s=this.queue[e])&&void 0!==s?s:{threshold:100,requests:[],wasRequesting:!1},this.queue[e].requests.push(t),this.queue[e].wasRequesting=!0});return this.check(),t}),this.queue.sg={threshold:250,thresholds:null,minThresholds:{default:.25,minute50:.5,minute75:1,hourly75:1.5,daily75:2},minute_limit:120,hour_limit:2400,day_limit:14400,requests:[],wasRequesting:!1}}};g.init();let u=[];const m={gm:null,runtime:{onMessage:{addListener:e=>m.gm.listener=e},getBrowserInfo:()=>Promise.resolve({name:"userscript"}),getManifest:()=>Promise.resolve(m.gm.info.script),sendMessage:e=>new Promise(async t=>{switch(e.action){case"get-tds":t(JSON.stringify(u));break;case"notify-tds":u=JSON.parse(e.data),m.gm.listener(JSON.stringify({action:"notify-tds",values:u})),t();break;case"permissions_contains":t(!0);break;case"getBrowserInfo":{const e=await m.runtime.getBrowserInfo();t(JSON.stringify(e));break}case"queue_request":await g.enqueue(e.key),t();break;case"do_lock":{const s=JSON.parse(e.lock);t(await m.gm.doLock(s));break}case"update_lock":{const s=JSON.parse(e.lock),n=JSON.parse(await m.gm.getValue(s.key,"{}"));n.uuid===s.uuid&&(n.timestamp=Date.now(),await m.gm.setValue(s.key,JSON.stringify(n))),t();break}case"do_unlock":{const s=JSON.parse(e.lock);await m.gm.setValue(s.key,"{}"),t();break}case"fetch":{var s;const n=JSON.parse(e.parameters);"omit"===n.credentials&&(n.headers["Esgst-Cookie"]=""),m.gm.xmlHttpRequest({binary:!!e.fileName,data:e.fileName?await c.common.getZip(n.body,e.fileName,"binarystring"):n.body,headers:n.headers,method:n.method,overrideMimeType:e.blob?"text/plain; charset=x-user-defined":"",timeout:null!==(s=e.timeout)&&void 0!==s?s:1e4,url:e.url,onload:async s=>{e.blob&&(s.responseText=(await c.common.readZip(s.responseText))[0].value),t({status:s.status,url:s.finalUrl,redirected:void 0!==s.finalUrl&&s.finalUrl!==e.url,text:s.responseText})},onerror:e=>t({error:e.responseText})});break}case"open_tab":m.gm.openInTab(e.url,!1),t();break;case"register_tab":t();break;case"update_adareqlim":await g.loadRequestThreshold(),t()}})},storage:{local:{get:async()=>{const e=await m.gm.listValues(),t=[],s={};for(const n of e){const e=m.gm.getValue(n);e.then(e=>s[n]=e),t.push(e)}return await Promise.all(t),s},remove:async e=>{const t=[];for(const s of e)t.push(m.gm.deleteValue(s));await Promise.all(t),await m.gm.setValue("storageChanged",JSON.stringify(Date.now()))},set:async e=>{const t=[];for(const s in e)e.hasOwnProperty(s)&&t.push(m.gm.setValue(s,e[s]));await Promise.all(t),await m.gm.setValue("storageChanged",JSON.stringify(Date.now()))}},onChanged:{addListener:()=>{}}}};m.gm=GM,m.gm.lastUpdate=0,m.gm.addValueChangeListener||(m.gm.hasValueChanged=async(e,t,s)=>{const n=await m.gm.getValue(e);n!==t&&(s(e,t,n,!0),t=n),window.setTimeout(m.gm.hasValueChanged,5e3,e,t,s)},m.gm.addValueChangeListener=async(e,t)=>{const s=await m.gm.getValue(e);m.gm.hasValueChanged(e,s,t)}),m.gm.addValueChangeListener("storageChanged",async(e,t,s,n)=>{if(!n||!s||"undefined"===s)return;const a=JSON.parse(s);if(a>m.gm.lastUpdate){m.gm.lastUpdate=a;const e=await m.storage.local.get(null),t={};for(const s in e)t[s]={newValue:e[s]};m.gm.listener(JSON.stringify({action:"storageChanged",values:{changes:t,areaName:"local"}}))}}),m.gm.doLock=async e=>{let t=JSON.parse(await m.gm.getValue(e.key,"{}"));return!t||!t.uuid||t.timestamp<Date.now()-(e.threshold+e.timeout)?(await m.gm.setValue(e.key,JSON.stringify({timestamp:Date.now(),uuid:e.uuid})),await c.common.timeout(e.threshold/2),t=JSON.parse(await m.gm.getValue(e.key,"{}")),t&&t.uuid===e.uuid?"true":e.tryOnce?"false":m.gm.doLock(e)):e.tryOnce?"false":(await c.common.timeout(e.threshold/3),m.gm.doLock(e))},n=m;s(145),s(147);function h(e,t){return t=t?(""+t).replace(/([[\]().?/*{}+$^:])/g,"\\$1"):" \\s ",(""+e).replace(new RegExp("[' + charList + ']+$","g"),"")}function p(e,t){let s,n,a;for(e+="",a=" \n\r\t\f\v            ​\u2028\u2029　",t&&(a=(""+t).replace(/([[\]().?/*{}+$^:])/g,"$1")),s=0,n=e.length;s<n;++s)if(-1===a.indexOf(e.charAt(s))){e=e.substring(s);break}for(s=e.length-1;s>-1;--s)if(-1===a.indexOf(e.charAt(s))){e=e.substring(0,s+1);break}return-1===a.indexOf(e.charAt(0))?e:""}function f(e){let t,s,n,a=(e,t)=>{let s,n,a;if(s=e.charCodeAt(t),n=a="",s>=55296&&s<=56319){if(e.length<=t+1)throw new Error("High surrogate without following low surrogate");if(n=e.charCodeAt(t+1),n<56320||n>57343)throw new Error("High surrogate without following low surrogate");return e.charAt(t)+e.charAt(t+1)}if(s>=56320&&s<=57343){if(0===t)throw new Error("Low surrogate without preceding high surrogate");if(a=e.charCodeAt(t-1),a<55296||a>56319)throw new Error("Low surrogate without preceding high surrogate");return!1}return e.charAt(t)};for(s=0,t=0,n=(e=""+e).length;t<n;++t)!1!==a(e,t)&&(s+=1);return s}function b(e,t){let s,n;for(s=0,n=e.length;s<n;++s)if(t.indexOf(e.charAt(s))>=0)return e.slice(s);return!1}let w,y;y={blockTypes:{"#":["Header"],"*":["Rule","List"],"+":["List"],"-":["SetextHeader","Table","Rule","List"],0:["List"],1:["List"],2:["List"],3:["List"],4:["List"],5:["List"],6:["List"],7:["List"],8:["List"],9:["List"],":":["Table"],"<":["Comment","Markup"],"=":["SetextHeader"],">":["Quote"],"[":["Reference"],_:["Rule"],"`":["FencedCode"],"|":["Table"],"~":["FencedCode"]},breaksEnabled:!1,definitionData:{},emRegex:{"*":/^[*]((?:\\\\\*|[^*]|[*][*][^*]+?[*][*])+?)[*](?![*])/,_:/^_((?:\\\\_|[^_]|__[^_]*__)+?)_(?!_)\b/u},inlineMarkerList:'!"*_&[:<>`~\\',inlineTypes:{'"':["SpecialCharacter"],"!":["Image"],"&":["SpecialCharacter"],"*":["Emphasis"],":":["Url"],"<":["UrlTag","EmailTag","Markup","SpecialCharacter"],">":["SpecialCharacter"],"[":["Link"],_:["Emphasis"],"`":["Code"],"~":["Strikethrough"],"\\":["EscapeSequence"]},markupEscaped:!1,regexHtmlAttribute:"[a-zA-Z_:][:.-\\w]*(?:\\s*=\\s*(?:[^\"'=<>`\\s]+|\"[^\"]*\"|'[^']*'))?",specialCharacters:["\\","`","*","_","{","}","[","]","(",")",">","#","+","-",".","!","|"],strongRegex:{"*":/^[*]{2}((?:\\\\\*|[^*]|[*][^*]*[*])+?)[*]{2}(?![*])/,_:/^__((?:\\\\_|[^_]|_[^_]*_)+?)__(?!_)/u},textLevelElements:["a","br","bdo","abbr","blink","nextid","acronym","basefont","b","em","big","cite","small","spacer","listing","i","rp","del","code","strike","marquee","q","rt","ins","font","strong","s","tt","kbd","mark","u","xm","sub","nobr","sup","ruby","var","span","wbr","time"],unmarkedBlockTypes:["Code"],urlsLinked:!0,voidElements:["area","base","br","col","command","embed","hr","img","input","link","meta","param","source"]},w={lines:e=>{let t,s,n,a,i,o,r,l,c,d,g,u,m,p,f;i=null,s=[];e:for(o=0,u=e.length;o<u;++o)if(c=e[o],""!==h(c)){for(c.indexOf("\t")>-1&&(p=c.split("\t"),c=p.shift(),p.forEach(e=>{c+=`${" ".repeat(4-c.length%4)}${e}`})),l=0;w.isSet(c[l])&&" "===c[l];)l+=1;if(f=l>0?c.slice(l):c,c={body:c,indent:l,text:f},w.isSet(i)&&w.isSet(i.continuable)){if(t=w[`block${i.type}Continue`](c,i),w.isSet(t)){i=t;continue}w.isBlockCompletable(i.type)&&(i=w[`block${i.type}Complete`](i))}for(d=f[0],a=y.unmarkedBlockTypes.slice(0),w.isSet(y.blockTypes[d])&&y.blockTypes[d].forEach(e=>a.push(e)),r=0,m=a.length;r<m;++r)if(n=a[r],t=w["block"+n](c,i),w.isSet(t)){t.type=n,w.isSet(t.identified)||(s.push(i),t.identified=!0),w.isBlockContinuable(n)&&(t.continuable=!0),i=t;continue e}!w.isSet(i)||w.isSet(i.type)||w.isSet(i.interrupted)?(s.push(i),i=w.paragraph(c),i.identified=!0):i.element.text+="\n"+f}else w.isSet(i)&&(i.interrupted=!0);for(w.isSet(i)&&w.isSet(i.continuable)&&w.isBlockCompletable(i.type)&&(i=w[`block${i.type}Complete`](i)),s.push(i),s.shift(),g="",o=0,u=s.length;o<u;++o)t=s[o],w.isSet(t.hidden)||(g+="\n"+(w.isSet(t.markup)?t.markup:w.element(t.element)));return g+="\n",g},isBlockContinuable:e=>void 0!==w[`block${e}Continue`],isBlockCompletable:e=>void 0!==w[`block${e}Complete`],isSet:e=>null!=e,blockCode:(e,t=null)=>{if(!w.isSet(t)||w.isSet(t.type)||w.isSet(t.interrupted))return e.indent>=4?{element:{handler:"element",name:"pre",text:{name:"code",text:e.body.slice(4)}}}:void 0},blockCodeContinue:(e,t)=>{if(e.indent>=4)return w.isSet(t.interrupted)&&(t.element.text.text+="\n",delete t.interrupted),t.element.text.text+="\n"+e.body.slice(4),t},blockCodeComplete:e=>(e.element.text.text=e.element.text.text.replace(/</g,"&lt;").replace(/>/g,"&gt;"),e),blockComment:e=>{if(!y.markupEscaped&&w.isSet(e.text[3])&&"-"===e.text[3]&&"-"===e.text[2]&&"!"===e.text[1]){let t={markup:e.body};return e.text.match(/-->$/)&&(t.closed=!0),t}},blockCommentContinue:(e,t)=>{if(!w.isSet(t.closed))return t.markup+="\n"+e.body,e.text.match(/-->$/)&&(t.closed=!0),t},blockFencedCode:e=>{let t=e.text.match(new RegExp("^["+e.text[0]+"]{3,}[ ]*([\\w-]+)?[ ]*$"));if(t){let s={name:"code",text:""};return w.isSet(t[1])&&(s.attributes={class:"language-"+t[1]}),{char:e.text[0],element:{handler:"element",name:"pre",text:s}}}},blockFencedCodeContinue:(e,t)=>{if(!w.isSet(t.complete))return w.isSet(t.interrupted)&&(t.element.text.text+="\n",delete t.interrupted),e.text.match(new RegExp(`^${t.char}{3,}[ ]*$`))?(t.element.text.text=t.element.text.text.slice(1),t.complete=!0,t):(t.element.text.text+="\n"+e.body,t)},blockFencedCodeComplete:e=>(e.element.text.text=e.element.text.text.replace(/</g,"&lt;").replace(/>/g,"&gt;"),e),blockHeader:e=>{if(w.isSet(e.text[1])){let t=1;for(;w.isSet(e.text[t])&&"#"===e.text[t];)t+=1;if(t>6)return;return{element:{handler:"line",name:"h"+Math.min(6,t),text:p(e.text,"# ")}}}},blockList:e=>{let t,s,n;if([s,n]=e.text[0]<="-"?["ul","[*+-]"]:["ol","[0-9]+[.]"],t=e.text.match(new RegExp(`^(${n}[ ]+)(.*)`)),t){let a={element:{handler:"elements",name:s},indent:e.indent,pattern:n};if("ol"===s){let e=t[0].slice(0,t[0].indexOf("."));"1"!==e&&(a.element.attributes={start:e})}return a.li={handler:"li",name:"li",text:[t[2]]},a.element.text=[a.li],a}},blockListContinue:(e,t)=>{let s=e.text.match(new RegExp(`^${t.pattern}(?:[ ]+(.*)|$)`));return t.indent===e.indent&&s?(w.isSet(t.interrupted)&&(t.li.text.push(""),delete t.interrupted),delete t.li,t.li={handler:"li",name:"li",text:[w.isSet(s[1])?s[1]:""]},t.element.text.push(t.li),t):"["===e.text[0]&&w.blockReference(e)?t:w.isSet(t.interrupted)?e.indent>0?(t.li.text.push(""),t.li.text.push(e.body.replace(/^[ ]{0,4}/,"")),delete t.interrupted,t):void 0:(t.li.text.push(e.body.replace(/^[ ]{0,4}/,"")),t)},blockQuote:e=>{let t=e.text.match(/^>[ ]?(.*)/);if(t)return{element:{handler:"lines",name:"blockquote",text:[t[1]]}}},blockQuoteContinue:(e,t)=>{let s=e.text.match(/^>[ ]?(.*)/);return">"===e.text[0]&&s?(w.isSet(t.interrupted)&&(t.element.text.push(""),delete t.interrupted),t.element.text.push(s[1]),t):w.isSet(t.interrupted)?void 0:(t.element.text.push(e.text),t)},blockRule:e=>{if(e.text.match(new RegExp("^(["+e.text[0]+"])([ ]*\\1){2,}[ ]*$")))return{element:{name:"hr"}}},blockSetextHeader:(e,t=null)=>{if(w.isSet(t)&&!w.isSet(t.type)&&!w.isSet(t.interrupted))return""===h(e.text,e.text[0])?(t.element.name="="===e.text[0]?"h1":"h2",t):void 0},blockMarkup:e=>{if(y.markupEscaped)return;let t=e.text.match(new RegExp(`^<(\\w*)(?:[ ]*${y.regexHtmlAttribute})*[ ]*(/)?>`));if(t){if(y.textLevelElements.indexOf(t[1].toLowerCase())>-1)return;let s,n;if(s={depth:0,markup:e.text,name:t[1],closed:!1,void:!1},n=e.text.slice(f(t[0])),""===p(n))(w.isSet(t[2])||y.voidElements.indexOf(t[1])>-1)&&(s.closed=!0,s.void=!0);else{if(w.isSet(t[2])||y.voidElements.indexOf(t[1])>-1)return;n.match(new RegExp(`</${t[1]}>[ ]*$`,"i"))&&(s.closed=!0)}return s}},blockMarkupContinue:(e,t)=>{if(w.isSet(t.closed))return;return e.text.match(new RegExp(`^<${t.name}(?:[ ]*${y.regexHtmlAttribute})*[ ]*>`,"i"))&&(t.depth+=1),e.text.match(new RegExp(`(.*?)</${t.name}>[ ]*$`,"i"))&&(t.depth>0?t.depth-=1:t.closed=!0),w.isSet(t.interrupted)&&(t.markup+="\n",delete t.interrupted),t.markup+="\n"+e.body,t},blockReference:e=>{let t=e.text.match(/^\[(.+?)]:[ ]*<?(\S+?)>?(?:[ ]+["'(](.+)["')])?[ ]*$/);if(t){let e={title:null,url:t[2]};return w.isSet(t[3])&&(e.title=t[3]),y.definitionData.Reference[t[1].toLowerCase()]=e,{hidden:!0}}},blockTable:(e,t=null)=>{if(w.isSet(t)&&!w.isSet(t.type)&&!w.isSet(t.interrupted)&&t.element.text.indexOf("|")>-1&&""===h(e.text," -:|")){let s,n,a,i,o,r,l,c,d,g;for(n=[],i=p(p(e.text),"|").split("|"),d=0,g=i.length;d<g;++d)a=p(i[d]),""!==a&&(s=null,":"===a[0]&&(s="left"),":"===a.slice(-1)&&(s="left"===s?"center":"right"),n.push(s));for(c=[],r=p(p(t.element.text),"|").split("|"),d=0,g=r.length;d<g;++d)o=p(r[d]),l={handler:"line",name:"th",text:o,attributes:{}},w.isSet(n[d])&&(s=n[d],l.attributes={style:`text-align: ${s};`}),c.push(l);return(t={alignments:n,element:{handler:"elements",name:"table",text:[]},identified:!0}).element.text.push({handler:"elements",name:"thead",text:[]}),t.element.text.push({handler:"elements",name:"tbody",text:[]}),t.element.text[0].text.push({handler:"elements",name:"tr",text:c}),t}},blockTableContinue:(e,t)=>{if(!w.isSet(t.interrupted)&&("|"===e.text[0]||e.text.indexOf("|")>-1)){let s,n,a,i,o;for(n=[],i=p(p(e.text),"|").match(/(?:(\\\\[|])|[^|`]|`[^`]+'|')+/g),a=0,o=i.length;a<o;++a)s={handler:"line",name:"td",text:p(i[a]),attributes:{}},w.isSet(t.alignments[a])&&(s.attributes={style:`text-align: ${t.alignments[a]};`}),n.push(s);return s={handler:"elements",name:"tr",text:n},t.element.text[1].text.push(s),t}},paragraph:e=>({element:{handler:"line",name:"p",text:e.text}}),line:e=>{let t,s,n,a,i,o,r,l;r="";e:for(;t=b(e,y.inlineMarkerList);){for(i=t[0],o=e.indexOf(i),t={context:e,text:t},s=0,l=y.inlineTypes[i].length;s<l;++s)if(a=y.inlineTypes[i][s],n=w["inline"+a](t),w.isSet(n)&&!(w.isSet(n.position)&&n.position>o)){w.isSet(n.position)||(n.position=o),r+=`${w.unmarkedText(e.slice(0,n.position))}${w.isSet(n.markup)?n.markup:w.element(n.element)}`,e=e.slice(n.position+n.extent);continue e}r+=w.unmarkedText(e.slice(0,o+1)),e=e.slice(o+1)}return r+=w.unmarkedText(e),r},inlineCode:e=>{let t,s;if(t=e.text[0],s=e.text.match(new RegExp(`^(${t}+)[ ]*([\\S\\s]+?)[ ]*(${t})?\\1`)),s&&!s[3])return{element:{name:"code",text:s[2].replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/[ ]*\n/,"")},extent:f(s[0])}},inlineEmailTag:e=>{let t=e.text.match(/^<((mailto:)?\S+?@\S+?)>/i);if(e.text.indexOf(">")>-1&&t){let e=t[1];return w.isSet(t[2])||(e="mailto:"+e),{element:{name:"a",text:t[1],attributes:{href:e}},extent:f(t[0])}}},inlineEmphasis:e=>{if(!w.isSet(e.text[1]))return;let t,s,n;if(s=e.text[0],e.text[1]===s&&(n=e.text.match(y.strongRegex[s])))t="strong";else{if(!(n=e.text.match(y.emRegex[s])))return;t="em"}return{element:{handler:"line",name:t,text:n[1]},extent:f(n[0])}},inlineEscapeSequence:e=>{if(w.isSet(e.text[1])&&y.specialCharacters.indexOf(e.text[1])>-1)return{extent:2,markup:e.text[1]}},inlineImage:e=>{if(!w.isSet(e.text[1])||"["!==e.text[1])return;let t,s,n;if(e.text=e.text.slice(1),s=w.inlineLink(e),w.isSet(s)){for(n in t={element:{attributes:{src:s.element.attributes.href,alt:s.element.text,title:s.element.text},name:"img"},extent:s.extent+1},s.element.attributes)s.element.attributes.hasOwnProperty(n)&&s.element.attributes[n]&&(t.element.attributes[n]=s.element.attributes[n]);return delete t.element.attributes.href,t}},inlineLink:e=>{let t,s,n,a;if(t={attributes:{href:null,title:null},handler:"line",name:"a",text:null},s=0,a=e.text,n=a.match(/\[(.*?)]/),n&&(n=n[0].match(/\[(?:(.*\[)*)(.*?)]/),n)){if(t.text=n[2],s+=f(n[2])+2,a=a.slice(s),n=a.match(/^\(\s*([^\s]+?)\s*\)/),n)t.attributes.href=n[1],w.isSet(n[2])&&(t.attributes.title=n[2].slice(1,-1)),s+=f(n[0]);else{let e;if(n=a.match(/^\s*\[(.*?)]/),n?(e=(f(n[1])?n[1]:t.text).toLowerCase(),s+=f(n[0])):e=t.text.toLowerCase(),!w.isSet(y.definitionData.Reference[e]))return;e=y.definitionData.Reference[e],t.attributes.href=e.url,t.attributes.title=e.title}return t.attributes.href=t.attributes.href.replace(/&/g,"&amp;").replace(/</g,"&lt;"),{element:t,extent:s}}},inlineMarkup:e=>{if(y.markupEscaped||e.text.indexOf(">")<0)return;let t=e.text.match(/^<\/\w*[ ]*>/);return"/"===e.text[1]&&t?{extent:f(t[0]),markup:t[0]}:(t=e.text.match(/^<!---?[^>-](?:-?[^-])*-->/),"!"===e.text[1]&&t?{extent:f(t[0]),markup:t[0]}:(t=e.text.match(new RegExp(`^<\\w*(?:[ ]*${y.regexHtmlAttribute})*[ ]*/?>`))," "!==e.text[1]&&t?{extent:f(t[0]),markup:t[0]}:void 0))},inlineSpecialCharacter:e=>{if("&"===e.text[0]&&!e.text.match(/^&#?\w+;/))return{extent:1,markup:"&amp;"};let t={">":"gt","<":"lt",'"':"quot"};return w.isSet(t[e.text[0]])?{extent:1,markup:`&${t[e.text[0]]};`}:void 0},inlineStrikethrough:e=>{if(!w.isSet(e.text[1]))return;let t,s,n;if((t=e.text.match(/^~([^~]+?)(~+)/))&&1===t[2].length)s="span",n=t[1];else if((t=e.text.match(/^~~([^~]+?)(~+)/))&&2===t[2].length)s="del",n=t[1];else if(t=e.text.match(/^~~~([^~]+?)(~+)/))switch(t[2].length){case 3:s="span",n=`~~${t[1]}~~`;break;case 4:s="del",n=`~${t[1]}~~`}if(s)switch(s){case"del":return{element:{handler:"line",name:"del",text:n},extent:f(t[0])};case"span":return{element:{attributes:{class:"spoiler"},handler:"line",name:"span",text:n},extent:f(t[0])}}},inlineUrl:e=>{if(!0!==y.urlsLinked||!w.isSet(e.text[2])||"/"!==e.text[2])return;let t=/\bhttps?:[/]{2}[^\s<]+\b\/*/iu.exec(e.context);return t?{element:{attributes:{href:t[0]},name:"a",text:t[0]},extent:f(t[0]),position:t.index}:void 0},inlineUrlTag:e=>{let t=e.text.match(/^<(\w+:\/{2}[^ >]+)>/i);if(e.text.indexOf(">")>-1&&t){let e=t[1].replace(/&/g,"&amp;").replace(/</g,"&lt;");return{element:{name:"a",text:e,attributes:{href:e}},extent:f(t[0])}}},unmarkedText:e=>e?y.breaksEnabled?e.replace(/[ ]*\n/g,"<br />\n"):e.replace(/(?:[ ][ ]+|[ ]*\\\\)\n/g,"<br />\n").replace(/\s\n/g,"\n"):"",element:e=>{let t="<"+e.name;if(w.isSet(e.attributes)){let s,n;for(s in e.attributes)if(e.attributes.hasOwnProperty(s)){if(n=e.attributes[s],null===n)continue;t+=` ${s}="${n}"`}}return w.isSet(e.text)?(t+=">",w.isSet(e.handler)?t+=w[e.handler](e.text):t+=e.text,t+=`</${e.name}>`):t+=" />",t},elements:e=>{let t="";return e.forEach(e=>t+="\n"+w.element(e)),t+="\n",t},li:e=>{let t,s,n;return t=w.lines(e),s=p(t),e.indexOf("")<0&&"<p>"===s.slice(0,3)&&(t=s.slice(3),n=t.indexOf("</p>"),t=`${t.slice(0,n)}${t.slice(n+4)}`),t}};class v{text(e){y.definitionData={Reference:{}};let t=w.lines(p(e.replace(/\r\n|\r/g,"\n"),"\n").split("\n"));return t=p(t,"\n"),t}setBreaksEnabled(e){return y.breaksEnabled=e,this}setMarkupEscaped(e){return y.markupEscaped=e,this}setUrlsLinked(e){return y.urlsLinked=e,this}}s(5),s(19),s(149),s(160),s(161);function _(e){return(_="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function k(e,t){if(t.length<e)throw new TypeError(e+" argument"+(e>1?"s":"")+" required, but only "+t.length+" present")}function x(e){return k(1,arguments),e instanceof Date||"object"===_(e)&&"[object Date]"===Object.prototype.toString.call(e)}function A(e){k(1,arguments);var t=Object.prototype.toString.call(e);return e instanceof Date||"object"===_(e)&&"[object Date]"===t?new Date(e.getTime()):"number"==typeof e||"[object Number]"===t?new Date(e):("string"!=typeof e&&"[object String]"!==t||"undefined"==typeof console||(console.warn("Starting with v2.0.0-beta.1 date-fns doesn't accept strings as date arguments. Please use `parseISO` to parse strings. See: https://github.com/date-fns/date-fns/blob/master/docs/upgradeGuide.md#string-arguments"),console.warn((new Error).stack)),new Date(NaN))}function C(e){if(k(1,arguments),!x(e)&&"number"!=typeof e)return!1;var t=A(e);return!isNaN(Number(t))}function S(e){if(null===e||!0===e||!1===e)return NaN;var t=Number(e);return isNaN(t)?t:t<0?Math.ceil(t):Math.floor(t)}function E(e,t){k(2,arguments);var s=A(e).getTime(),n=S(t);return new Date(s+n)}function T(e,t){k(2,arguments);var s=S(t);return E(e,-s)}function N(e){k(1,arguments);var t=1,s=A(e),n=s.getUTCDay(),a=(n<t?7:0)+n-t;return s.setUTCDate(s.getUTCDate()-a),s.setUTCHours(0,0,0,0),s}function P(e){k(1,arguments);var t=A(e),s=t.getUTCFullYear(),n=new Date(0);n.setUTCFullYear(s+1,0,4),n.setUTCHours(0,0,0,0);var a=N(n),i=new Date(0);i.setUTCFullYear(s,0,4),i.setUTCHours(0,0,0,0);var o=N(i);return t.getTime()>=a.getTime()?s+1:t.getTime()>=o.getTime()?s:s-1}function L(e){k(1,arguments);var t=P(e),s=new Date(0);s.setUTCFullYear(t,0,4),s.setUTCHours(0,0,0,0);var n=N(s);return n}function I(e){k(1,arguments);var t=A(e),s=N(t).getTime()-L(t).getTime();return Math.round(s/6048e5)+1}var B={};function D(){return B}function G(e,t){var s,n,a,i,o,r,l,c;k(1,arguments);var d=D(),g=S(null!==(s=null!==(n=null!==(a=null!==(i=null==t?void 0:t.weekStartsOn)&&void 0!==i?i:null==t||null===(o=t.locale)||void 0===o||null===(r=o.options)||void 0===r?void 0:r.weekStartsOn)&&void 0!==a?a:d.weekStartsOn)&&void 0!==n?n:null===(l=d.locale)||void 0===l||null===(c=l.options)||void 0===c?void 0:c.weekStartsOn)&&void 0!==s?s:0);if(!(g>=0&&g<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");var u=A(e),m=u.getUTCDay(),h=(m<g?7:0)+m-g;return u.setUTCDate(u.getUTCDate()-h),u.setUTCHours(0,0,0,0),u}function q(e,t){var s,n,a,i,o,r,l,c;k(1,arguments);var d=A(e),g=d.getUTCFullYear(),u=D(),m=S(null!==(s=null!==(n=null!==(a=null!==(i=null==t?void 0:t.firstWeekContainsDate)&&void 0!==i?i:null==t||null===(o=t.locale)||void 0===o||null===(r=o.options)||void 0===r?void 0:r.firstWeekContainsDate)&&void 0!==a?a:u.firstWeekContainsDate)&&void 0!==n?n:null===(l=u.locale)||void 0===l||null===(c=l.options)||void 0===c?void 0:c.firstWeekContainsDate)&&void 0!==s?s:1);if(!(m>=1&&m<=7))throw new RangeError("firstWeekContainsDate must be between 1 and 7 inclusively");var h=new Date(0);h.setUTCFullYear(g+1,0,m),h.setUTCHours(0,0,0,0);var p=G(h,t),f=new Date(0);f.setUTCFullYear(g,0,m),f.setUTCHours(0,0,0,0);var b=G(f,t);return d.getTime()>=p.getTime()?g+1:d.getTime()>=b.getTime()?g:g-1}function R(e,t){var s,n,a,i,o,r,l,c;k(1,arguments);var d=D(),g=S(null!==(s=null!==(n=null!==(a=null!==(i=null==t?void 0:t.firstWeekContainsDate)&&void 0!==i?i:null==t||null===(o=t.locale)||void 0===o||null===(r=o.options)||void 0===r?void 0:r.firstWeekContainsDate)&&void 0!==a?a:d.firstWeekContainsDate)&&void 0!==n?n:null===(l=d.locale)||void 0===l||null===(c=l.options)||void 0===c?void 0:c.firstWeekContainsDate)&&void 0!==s?s:1),u=q(e,t),m=new Date(0);m.setUTCFullYear(u,0,g),m.setUTCHours(0,0,0,0);var h=G(m,t);return h}function M(e,t){k(1,arguments);var s=A(e),n=G(s,t).getTime()-R(s,t).getTime();return Math.round(n/6048e5)+1}function O(e,t){for(var s=e<0?"-":"",n=Math.abs(e).toString();n.length<t;)n="0"+n;return s+n}var U={y:function(e,t){var s=e.getUTCFullYear(),n=s>0?s:1-s;return O("yy"===t?n%100:n,t.length)},M:function(e,t){var s=e.getUTCMonth();return"M"===t?String(s+1):O(s+1,2)},d:function(e,t){return O(e.getUTCDate(),t.length)},a:function(e,t){var s=e.getUTCHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return s.toUpperCase();case"aaa":return s;case"aaaaa":return s[0];case"aaaa":default:return"am"===s?"a.m.":"p.m."}},h:function(e,t){return O(e.getUTCHours()%12||12,t.length)},H:function(e,t){return O(e.getUTCHours(),t.length)},m:function(e,t){return O(e.getUTCMinutes(),t.length)},s:function(e,t){return O(e.getUTCSeconds(),t.length)},S:function(e,t){var s=t.length,n=e.getUTCMilliseconds();return O(Math.floor(n*Math.pow(10,s-3)),t.length)}},F="midnight",W="noon",V="morning",j="afternoon",H="evening",J="night";function Y(e,t){var s=e>0?"-":"+",n=Math.abs(e),a=Math.floor(n/60),i=n%60;if(0===i)return s+String(a);var o=t||"";return s+String(a)+o+O(i,2)}function K(e,t){return e%60==0?(e>0?"-":"+")+O(Math.abs(e)/60,2):z(e,t)}function z(e,t){var s=t||"",n=e>0?"-":"+",a=Math.abs(e);return n+O(Math.floor(a/60),2)+s+O(a%60,2)}var Q={G:function(e,t,s){var n=e.getUTCFullYear()>0?1:0;switch(t){case"G":case"GG":case"GGG":return s.era(n,{width:"abbreviated"});case"GGGGG":return s.era(n,{width:"narrow"});case"GGGG":default:return s.era(n,{width:"wide"})}},y:function(e,t,s){if("yo"===t){var n=e.getUTCFullYear(),a=n>0?n:1-n;return s.ordinalNumber(a,{unit:"year"})}return U.y(e,t)},Y:function(e,t,s,n){var a=q(e,n),i=a>0?a:1-a;return"YY"===t?O(i%100,2):"Yo"===t?s.ordinalNumber(i,{unit:"year"}):O(i,t.length)},R:function(e,t){return O(P(e),t.length)},u:function(e,t){return O(e.getUTCFullYear(),t.length)},Q:function(e,t,s){var n=Math.ceil((e.getUTCMonth()+1)/3);switch(t){case"Q":return String(n);case"QQ":return O(n,2);case"Qo":return s.ordinalNumber(n,{unit:"quarter"});case"QQQ":return s.quarter(n,{width:"abbreviated",context:"formatting"});case"QQQQQ":return s.quarter(n,{width:"narrow",context:"formatting"});case"QQQQ":default:return s.quarter(n,{width:"wide",context:"formatting"})}},q:function(e,t,s){var n=Math.ceil((e.getUTCMonth()+1)/3);switch(t){case"q":return String(n);case"qq":return O(n,2);case"qo":return s.ordinalNumber(n,{unit:"quarter"});case"qqq":return s.quarter(n,{width:"abbreviated",context:"standalone"});case"qqqqq":return s.quarter(n,{width:"narrow",context:"standalone"});case"qqqq":default:return s.quarter(n,{width:"wide",context:"standalone"})}},M:function(e,t,s){var n=e.getUTCMonth();switch(t){case"M":case"MM":return U.M(e,t);case"Mo":return s.ordinalNumber(n+1,{unit:"month"});case"MMM":return s.month(n,{width:"abbreviated",context:"formatting"});case"MMMMM":return s.month(n,{width:"narrow",context:"formatting"});case"MMMM":default:return s.month(n,{width:"wide",context:"formatting"})}},L:function(e,t,s){var n=e.getUTCMonth();switch(t){case"L":return String(n+1);case"LL":return O(n+1,2);case"Lo":return s.ordinalNumber(n+1,{unit:"month"});case"LLL":return s.month(n,{width:"abbreviated",context:"standalone"});case"LLLLL":return s.month(n,{width:"narrow",context:"standalone"});case"LLLL":default:return s.month(n,{width:"wide",context:"standalone"})}},w:function(e,t,s,n){var a=M(e,n);return"wo"===t?s.ordinalNumber(a,{unit:"week"}):O(a,t.length)},I:function(e,t,s){var n=I(e);return"Io"===t?s.ordinalNumber(n,{unit:"week"}):O(n,t.length)},d:function(e,t,s){return"do"===t?s.ordinalNumber(e.getUTCDate(),{unit:"date"}):U.d(e,t)},D:function(e,t,s){var n=function(e){k(1,arguments);var t=A(e),s=t.getTime();t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0);var n=t.getTime(),a=s-n;return Math.floor(a/864e5)+1}(e);return"Do"===t?s.ordinalNumber(n,{unit:"dayOfYear"}):O(n,t.length)},E:function(e,t,s){var n=e.getUTCDay();switch(t){case"E":case"EE":case"EEE":return s.day(n,{width:"abbreviated",context:"formatting"});case"EEEEE":return s.day(n,{width:"narrow",context:"formatting"});case"EEEEEE":return s.day(n,{width:"short",context:"formatting"});case"EEEE":default:return s.day(n,{width:"wide",context:"formatting"})}},e:function(e,t,s,n){var a=e.getUTCDay(),i=(a-n.weekStartsOn+8)%7||7;switch(t){case"e":return String(i);case"ee":return O(i,2);case"eo":return s.ordinalNumber(i,{unit:"day"});case"eee":return s.day(a,{width:"abbreviated",context:"formatting"});case"eeeee":return s.day(a,{width:"narrow",context:"formatting"});case"eeeeee":return s.day(a,{width:"short",context:"formatting"});case"eeee":default:return s.day(a,{width:"wide",context:"formatting"})}},c:function(e,t,s,n){var a=e.getUTCDay(),i=(a-n.weekStartsOn+8)%7||7;switch(t){case"c":return String(i);case"cc":return O(i,t.length);case"co":return s.ordinalNumber(i,{unit:"day"});case"ccc":return s.day(a,{width:"abbreviated",context:"standalone"});case"ccccc":return s.day(a,{width:"narrow",context:"standalone"});case"cccccc":return s.day(a,{width:"short",context:"standalone"});case"cccc":default:return s.day(a,{width:"wide",context:"standalone"})}},i:function(e,t,s){var n=e.getUTCDay(),a=0===n?7:n;switch(t){case"i":return String(a);case"ii":return O(a,t.length);case"io":return s.ordinalNumber(a,{unit:"day"});case"iii":return s.day(n,{width:"abbreviated",context:"formatting"});case"iiiii":return s.day(n,{width:"narrow",context:"formatting"});case"iiiiii":return s.day(n,{width:"short",context:"formatting"});case"iiii":default:return s.day(n,{width:"wide",context:"formatting"})}},a:function(e,t,s){var n=e.getUTCHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return s.dayPeriod(n,{width:"abbreviated",context:"formatting"});case"aaa":return s.dayPeriod(n,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return s.dayPeriod(n,{width:"narrow",context:"formatting"});case"aaaa":default:return s.dayPeriod(n,{width:"wide",context:"formatting"})}},b:function(e,t,s){var n,a=e.getUTCHours();switch(n=12===a?W:0===a?F:a/12>=1?"pm":"am",t){case"b":case"bb":return s.dayPeriod(n,{width:"abbreviated",context:"formatting"});case"bbb":return s.dayPeriod(n,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return s.dayPeriod(n,{width:"narrow",context:"formatting"});case"bbbb":default:return s.dayPeriod(n,{width:"wide",context:"formatting"})}},B:function(e,t,s){var n,a=e.getUTCHours();switch(n=a>=17?H:a>=12?j:a>=4?V:J,t){case"B":case"BB":case"BBB":return s.dayPeriod(n,{width:"abbreviated",context:"formatting"});case"BBBBB":return s.dayPeriod(n,{width:"narrow",context:"formatting"});case"BBBB":default:return s.dayPeriod(n,{width:"wide",context:"formatting"})}},h:function(e,t,s){if("ho"===t){var n=e.getUTCHours()%12;return 0===n&&(n=12),s.ordinalNumber(n,{unit:"hour"})}return U.h(e,t)},H:function(e,t,s){return"Ho"===t?s.ordinalNumber(e.getUTCHours(),{unit:"hour"}):U.H(e,t)},K:function(e,t,s){var n=e.getUTCHours()%12;return"Ko"===t?s.ordinalNumber(n,{unit:"hour"}):O(n,t.length)},k:function(e,t,s){var n=e.getUTCHours();return 0===n&&(n=24),"ko"===t?s.ordinalNumber(n,{unit:"hour"}):O(n,t.length)},m:function(e,t,s){return"mo"===t?s.ordinalNumber(e.getUTCMinutes(),{unit:"minute"}):U.m(e,t)},s:function(e,t,s){return"so"===t?s.ordinalNumber(e.getUTCSeconds(),{unit:"second"}):U.s(e,t)},S:function(e,t){return U.S(e,t)},X:function(e,t,s,n){var a=(n._originalDate||e).getTimezoneOffset();if(0===a)return"Z";switch(t){case"X":return K(a);case"XXXX":case"XX":return z(a);case"XXXXX":case"XXX":default:return z(a,":")}},x:function(e,t,s,n){var a=(n._originalDate||e).getTimezoneOffset();switch(t){case"x":return K(a);case"xxxx":case"xx":return z(a);case"xxxxx":case"xxx":default:return z(a,":")}},O:function(e,t,s,n){var a=(n._originalDate||e).getTimezoneOffset();switch(t){case"O":case"OO":case"OOO":return"GMT"+Y(a,":");case"OOOO":default:return"GMT"+z(a,":")}},z:function(e,t,s,n){var a=(n._originalDate||e).getTimezoneOffset();switch(t){case"z":case"zz":case"zzz":return"GMT"+Y(a,":");case"zzzz":default:return"GMT"+z(a,":")}},t:function(e,t,s,n){var a=n._originalDate||e;return O(Math.floor(a.getTime()/1e3),t.length)},T:function(e,t,s,n){return O((n._originalDate||e).getTime(),t.length)}},Z=function(e,t){switch(e){case"P":return t.date({width:"short"});case"PP":return t.date({width:"medium"});case"PPP":return t.date({width:"long"});case"PPPP":default:return t.date({width:"full"})}},X=function(e,t){switch(e){case"p":return t.time({width:"short"});case"pp":return t.time({width:"medium"});case"ppp":return t.time({width:"long"});case"pppp":default:return t.time({width:"full"})}},ee={p:X,P:function(e,t){var s,n=e.match(/(P+)(p+)?/)||[],a=n[1],i=n[2];if(!i)return Z(e,t);switch(a){case"P":s=t.dateTime({width:"short"});break;case"PP":s=t.dateTime({width:"medium"});break;case"PPP":s=t.dateTime({width:"long"});break;case"PPPP":default:s=t.dateTime({width:"full"})}return s.replace("{{date}}",Z(a,t)).replace("{{time}}",X(i,t))}};function te(e){var t=new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()));return t.setUTCFullYear(e.getFullYear()),e.getTime()-t.getTime()}var se=["D","DD"],ne=["YY","YYYY"];function ae(e){return-1!==se.indexOf(e)}function ie(e){return-1!==ne.indexOf(e)}function oe(e,t,s){if("YYYY"===e)throw new RangeError("Use `yyyy` instead of `YYYY` (in `".concat(t,"`) for formatting years to the input `").concat(s,"`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md"));if("YY"===e)throw new RangeError("Use `yy` instead of `YY` (in `".concat(t,"`) for formatting years to the input `").concat(s,"`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md"));if("D"===e)throw new RangeError("Use `d` instead of `D` (in `".concat(t,"`) for formatting days of the month to the input `").concat(s,"`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md"));if("DD"===e)throw new RangeError("Use `dd` instead of `DD` (in `".concat(t,"`) for formatting days of the month to the input `").concat(s,"`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md"))}var re={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},le=function(e,t,s){var n,a=re[e];return n="string"==typeof a?a:1===t?a.one:a.other.replace("{{count}}",t.toString()),null!=s&&s.addSuffix?s.comparison&&s.comparison>0?"in "+n:n+" ago":n};function ce(e){return function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},s=t.width?String(t.width):e.defaultWidth,n=e.formats[s]||e.formats[e.defaultWidth];return n}}var de={date:ce({formats:{full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},defaultWidth:"full"}),time:ce({formats:{full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},defaultWidth:"full"}),dateTime:ce({formats:{full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},defaultWidth:"full"})},ge={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"};function ue(e){return function(t,s){var n;if("formatting"===(null!=s&&s.context?String(s.context):"standalone")&&e.formattingValues){var a=e.defaultFormattingWidth||e.defaultWidth,i=null!=s&&s.width?String(s.width):a;n=e.formattingValues[i]||e.formattingValues[a]}else{var o=e.defaultWidth,r=null!=s&&s.width?String(s.width):e.defaultWidth;n=e.values[r]||e.values[o]}return n[e.argumentCallback?e.argumentCallback(t):t]}}function me(e){return function(t){var s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=s.width,a=n&&e.matchPatterns[n]||e.matchPatterns[e.defaultMatchWidth],i=t.match(a);if(!i)return null;var o,r=i[0],l=n&&e.parsePatterns[n]||e.parsePatterns[e.defaultParseWidth],c=Array.isArray(l)?pe(l,(function(e){return e.test(r)})):he(l,(function(e){return e.test(r)}));o=e.valueCallback?e.valueCallback(c):c,o=s.valueCallback?s.valueCallback(o):o;var d=t.slice(r.length);return{value:o,rest:d}}}function he(e,t){for(var s in e)if(e.hasOwnProperty(s)&&t(e[s]))return s}function pe(e,t){for(var s=0;s<e.length;s++)if(t(e[s]))return s}var fe,be={code:"en-US",formatDistance:le,formatLong:de,formatRelative:function(e,t,s,n){return ge[e]},localize:{ordinalNumber:function(e,t){var s=Number(e),n=s%100;if(n>20||n<10)switch(n%10){case 1:return s+"st";case 2:return s+"nd";case 3:return s+"rd"}return s+"th"},era:ue({values:{narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},defaultWidth:"wide"}),quarter:ue({values:{narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},defaultWidth:"wide",argumentCallback:function(e){return e-1}}),month:ue({values:{narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},defaultWidth:"wide"}),day:ue({values:{narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},defaultWidth:"wide"}),dayPeriod:ue({values:{narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},defaultWidth:"wide",formattingValues:{narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},defaultFormattingWidth:"wide"})},match:{ordinalNumber:(fe={matchPattern:/^(\d+)(th|st|nd|rd)?/i,parsePattern:/\d+/i,valueCallback:function(e){return parseInt(e,10)}},function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=e.match(fe.matchPattern);if(!s)return null;var n=s[0],a=e.match(fe.parsePattern);if(!a)return null;var i=fe.valueCallback?fe.valueCallback(a[0]):a[0];i=t.valueCallback?t.valueCallback(i):i;var o=e.slice(n.length);return{value:i,rest:o}}),era:me({matchPatterns:{narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},defaultMatchWidth:"wide",parsePatterns:{any:[/^b/i,/^(a|c)/i]},defaultParseWidth:"any"}),quarter:me({matchPatterns:{narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},defaultMatchWidth:"wide",parsePatterns:{any:[/1/i,/2/i,/3/i,/4/i]},defaultParseWidth:"any",valueCallback:function(e){return e+1}}),month:me({matchPatterns:{narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},defaultMatchWidth:"wide",parsePatterns:{narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},defaultParseWidth:"any"}),day:me({matchPatterns:{narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},defaultMatchWidth:"wide",parsePatterns:{narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},defaultParseWidth:"any"}),dayPeriod:me({matchPatterns:{narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},defaultMatchWidth:"any",parsePatterns:{any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},defaultParseWidth:"any"})},options:{weekStartsOn:0,firstWeekContainsDate:1}},we=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,ye=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,ve=/^'([^]*?)'?$/,_e=/''/g,ke=/[a-zA-Z]/;function xe(e,t,s){var n,a,i,o,r,l,c,d,g,u,m,h,p,f,b,w,y,v;k(2,arguments);var _=String(t),x=D(),E=null!==(n=null!==(a=null==s?void 0:s.locale)&&void 0!==a?a:x.locale)&&void 0!==n?n:be,N=S(null!==(i=null!==(o=null!==(r=null!==(l=null==s?void 0:s.firstWeekContainsDate)&&void 0!==l?l:null==s||null===(c=s.locale)||void 0===c||null===(d=c.options)||void 0===d?void 0:d.firstWeekContainsDate)&&void 0!==r?r:x.firstWeekContainsDate)&&void 0!==o?o:null===(g=x.locale)||void 0===g||null===(u=g.options)||void 0===u?void 0:u.firstWeekContainsDate)&&void 0!==i?i:1);if(!(N>=1&&N<=7))throw new RangeError("firstWeekContainsDate must be between 1 and 7 inclusively");var P=S(null!==(m=null!==(h=null!==(p=null!==(f=null==s?void 0:s.weekStartsOn)&&void 0!==f?f:null==s||null===(b=s.locale)||void 0===b||null===(w=b.options)||void 0===w?void 0:w.weekStartsOn)&&void 0!==p?p:x.weekStartsOn)&&void 0!==h?h:null===(y=x.locale)||void 0===y||null===(v=y.options)||void 0===v?void 0:v.weekStartsOn)&&void 0!==m?m:0);if(!(P>=0&&P<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");if(!E.localize)throw new RangeError("locale must contain localize property");if(!E.formatLong)throw new RangeError("locale must contain formatLong property");var L=A(e);if(!C(L))throw new RangeError("Invalid time value");var I=te(L),B=T(L,I),G={firstWeekContainsDate:N,weekStartsOn:P,locale:E,_originalDate:L},q=_.match(ye).map((function(e){var t=e[0];return"p"===t||"P"===t?(0,ee[t])(e,E.formatLong):e})).join("").match(we).map((function(n){if("''"===n)return"'";var a=n[0];if("'"===a)return Ae(n);var i=Q[a];if(i)return null!=s&&s.useAdditionalWeekYearTokens||!ie(n)||oe(n,t,String(e)),null!=s&&s.useAdditionalDayOfYearTokens||!ae(n)||oe(n,t,String(e)),i(B,n,E.localize,G);if(a.match(ke))throw new RangeError("Format string contains an unescaped latin alphabet character `"+a+"`");return n})).join("");return q}function Ae(e){var t=e.match(ve);return t?t[1].replace(_e,"'"):e}function Ce(e,t){var s,n,a,i,o,r,l,c;k(1,arguments);var d=D(),g=S(null!==(s=null!==(n=null!==(a=null!==(i=null==t?void 0:t.weekStartsOn)&&void 0!==i?i:null==t||null===(o=t.locale)||void 0===o||null===(r=o.options)||void 0===r?void 0:r.weekStartsOn)&&void 0!==a?a:d.weekStartsOn)&&void 0!==n?n:null===(l=d.locale)||void 0===l||null===(c=l.options)||void 0===c?void 0:c.weekStartsOn)&&void 0!==s?s:0);if(!(g>=0&&g<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");var u=A(e),m=u.getDay(),h=(m<g?7:0)+m-g;return u.setDate(u.getDate()-h),u.setHours(0,0,0,0),u}const Se=new class{constructor(){o()(this,"parser",new DOMParser),o()(this,"element",(e,t,...s)=>{try{if("function"==typeof e){const t=e();return s&&this.appendChildren(t,s),t}if("fragment"===e){const e=document.createDocumentFragment();return s&&this.appendChildren(e,s),e}const n=document.createElement(e);return t&&this.setElementAttributes(n,t),s&&this.appendChildren(n,s),n}catch(n){throw window.console.log(n.message),window.console.log(e,t,s),n}}),o()(this,"setElementAttributes",(e,t)=>{const s=Object.entries(t).filter(([,e])=>l.isSet(e));for(const[n,a]of s)if("attrs"===n&&"object"==typeof a)this.setCustomElementAttributes(e,a);else if("extend"===n&&"function"==typeof a)t.extend=a.bind(null,e);else if("ref"===n&&"function"==typeof a)a(e);else if(n.startsWith("on")&&"function"==typeof a){const t=n.slice(2);e.addEventListener(t,a)}else"object"==typeof a?this.setElementProperties(e,n,a):n.includes("-")?this.setCustomElementAttributes(e,{[n]:a}):e[n]=a}),o()(this,"setCustomElementAttributes",(e,t)=>{const s=Object.entries(t).filter(([,e])=>l.isSet(e));for(const[t,n]of s)e.setAttribute(t,n)}),o()(this,"setElementProperties",(e,t,s)=>{const n=Object.entries(s).filter(([,e])=>l.isSet(e));for(const[s,a]of n)e[t][s]=a}),o()(this,"appendChildren",(e,t)=>{for(const s of t)if("string"==typeof s||"number"==typeof s){const t=document.createTextNode(s);e.appendChild(t)}else s instanceof Node?e.appendChild(s):Array.isArray(s)&&this.appendChildren(e,s)}),o()(this,"fragment",()=>document.createDocumentFragment()),o()(this,"insert",(e,t,s)=>{const n=s instanceof DocumentFragment?Array.from(s.children):[s];try{const n=e.parentElement;switch(t){case"beforebegin":n&&n.insertBefore(s,e);break;case"afterbegin":e.insertBefore(s,e.firstChild);break;case"beforeend":e.appendChild(s);break;case"afterend":n&&n.insertBefore(s,e.nextSibling);break;case"atouter":n&&(n.insertBefore(s,e.nextSibling),e.remove());break;case"atinner":e.innerHTML="",e.appendChild(s)}if(s instanceof DocumentFragment&&s.children.length>0)throw new Error("Failed to insert elements")}catch(n){window.console.log(n.message),window.console.log(e,t,s)}return n}),o()(this,"parse",e=>this.parser.parseFromString(e,"text/html"))}};const Ee=new class{constructor(){this.subscribers={}}subscribe(e,t){return this.subscribers[e]||(this.subscribers[e]=[]),this.subscribers[e].push(t),this.unsubscribe.bind(this,e,t)}unsubscribe(e,t){this.subscribers[e]&&(this.subscribers[e]=this.subscribers[e].filter(e=>e!==t))}async dispatch(e,...t){if(this.subscribers[e])for(const s of this.subscribers[e])try{await s(...t)}catch(e){window.console.log(e.message)}}};class Te{constructor(e,t={}){o()(this,"data",void 0),o()(this,"locked",!1),o()(this,"lock",async()=>{const e=await n.runtime.sendMessage({action:"do_lock",lock:JSON.stringify(this.data)});this.locked=JSON.parse(e)}),o()(this,"update",()=>n.runtime.sendMessage({action:"update_lock",lock:JSON.stringify(this.data)})),o()(this,"unlock",()=>n.runtime.sendMessage({action:"do_unlock",lock:JSON.stringify(this.data)})),this.data={uuid:crypto.randomUUID(),key:e+"Lock",threshold:100,timeout:15e3,tryOnce:!1,...t}}get isLocked(){return this.locked}}class Ne{static delete(e,t={}){return Ne.send(e,{...t,method:"DELETE"})}static get(e,t={}){return Ne.send(e,{...t,method:"GET"})}static patch(e,t={}){return Ne.send(e,{...t,method:"PATCH"})}static post(e,t={}){return Ne.send(e,{...t,method:"POST"})}static put(e,t={}){return Ne.send(e,{...t,method:"PUT"})}static async send(e,t){Ne.REQUIRED_HEADERS["Esgst-Version"]||(Ne.REQUIRED_HEADERS["Esgst-Version"]=c.esgst.currentVersion);let s=null,a=null;e=e.replace(/^\//,`https://${window.location.hostname}/`).replace(/^https?:/,c.esgst.locationHref.match(/^http:/)?"http:":"https:"),t.pathParams&&(e=Ne.addPathParams(e,t.pathParams)),t.queryParams&&(e=Ne.addQueryParams(e,t.queryParams)),t.headers={...Ne.DEFAULT_HEADERS,...t.headers,...Ne.REQUIRED_HEADERS};try{const i=e.match(new RegExp(window.location.hostname));t.queue?a=new Te("request",{threshold:"number"==typeof t.queue?t.queue:1e3}):i&&!t.doNotQueue?await n.runtime.sendMessage({action:"queue_request",key:"sg"}):e.match(/^https?:\/\/store.steampowered.com/)&&d.get("limitSteamStore")&&(a=new Te("steamStore",{threshold:200})),a&&await a.lock(),i?(s=await Ne.sendInternal(e,t),c.esgst.requestLog.unshift({url:e,timestamp:Date.now()}),s.redirected&&c.esgst.requestLog.unshift({url:s.url,timestamp:Date.now()}),await c.common.setValue("requestLog",JSON.stringify(c.esgst.requestLog))):s=await Ne.sendExternal(e,t),a&&await a.unlock(),s.json=null,s.html=null;try{s.json=JSON.parse(s.text)}catch(e){}if(!s.json)try{s.html=Se.parse(s.text)}catch(e){}return s.url.match(/www.steamgifts.com/)&&s.html&&c.common.lookForPopups(s),s}catch(e){throw a&&await a.unlock(),e}}static async sendInternal(e,t){const{fetchObj:s,fetchOptions:n,abortController:a}=await Ne.getFetchObj(t),{timeout:i=1e4}=t,o=window.setTimeout(()=>a.abort(),i);n.signal=a.signal;const r=await s(e,n);window.clearTimeout(o);const l=await r.text();if(!r.ok)throw new Error(l);return{status:r.status,url:r.url,redirected:r.redirected,text:l}}static async sendExternal(e,t){const s="Firefox"===(await c.common.getBrowserInfo()).name&&d.get("manipulateCookies"),a={action:"fetch",blob:t.blob,fileName:t.fileName,manipulateCookies:s,parameters:JSON.stringify(Ne.getFetchOptions(t,s)),timeout:t.timeout,url:e};let i=await n.runtime.sendMessage(a);if("string"==typeof i&&(i=JSON.parse(i)),l.isSet(i.error))throw new Error(i.error);return{status:i.status,url:i.url,redirected:i.redirected,text:i.text}}static async getFetchObj(e){let t=null,s=Ne.getFetchOptions(e),n=null;return"Firefox"===(await c.common.getBrowserInfo()).name&&"wrappedJSObject"in window&&window.wrappedJSObject?(t=XPCNativeWrapper(window.wrappedJSObject.fetch),window.wrappedJSObject.fetchOptions=cloneInto(s,window),s=XPCNativeWrapper(window.wrappedJSObject.fetchOptions),n=new(XPCNativeWrapper(window.wrappedJSObject.AbortController))):(t=window.fetch,n=new AbortController),{fetchObj:t,fetchOptions:s,abortController:n}}static getFetchOptions(e,t=!1){return{body:e.data,credentials:e.anon||t?"omit":"include",headers:e.headers,method:e.method,redirect:"follow"}}static addPathParams(e,t={}){if(!Object.keys(t).length)return e;for(const s in t)e=e.replace(new RegExp(`%${s}%`),encodeURIComponent(t[s]));return e}static addQueryParams(e,t={}){if(!Object.keys(t).length)return e;const s=[];for(const e in t)s.push(`${encodeURIComponent(e)}=${encodeURIComponent(t[e])}`);return`${e}?${s.join("&")}`}}o()(Ne,"DEFAULT_HEADERS",{"Content-Type":"application/x-www-form-urlencoded"}),o()(Ne,"REQUIRED_HEADERS",{"Esgst-Version":"",From:"esgst.extension@gmail.com"});const Pe=0,Le=1;class Ie{static extractXsrfToken(e){return e.match(/xsrf_token=(.+)/)[1]}}const Be=new class extends Ie{constructor(){super(),this.counters={created:0,level:{base:0,full:0},messages:0,points:0,reputation:{negative:0,positive:0},won:0,wonDelivered:!1},this.isLoggedIn=!1,this.namespace=Pe,this.user=null,this.xsrfToken=null}init(){switch(window.location.hostname){case"www.steamgifts.com":this.namespace=Pe;break;case"www.steamtrades.com":this.namespace=Le;break;default:throw"Invalid namespace."}}},De={button:"esgst-button",buttonContainer:"esgst-button-container",mmButtonGroup:"esgst-mm-button-group",notification:"esgst-notification-bar"},Ge={[Pe]:{button:{root:"",colors:{white:"form__saving-button","alternate-white":"page__heading__button",green:"form__submit-button",yellow:"sidebar__entry-delete",red:"sidebar__error",gray:"form__saving-button form__saving-button--gray"},reversedColors:{"form__saving-button":"white",page__heading__button:"alternate-white","form__submit-button":"green","sidebar__entry-delete":"yellow",sidebar__error:"red","form__saving-button form__saving-button--gray":"gray"}},disabled:"is-disabled",giveawayColumns:"giveaway__columns",hidden:"is-hidden",notification:{root:"notification",marginTop:"notification--margin-top-small",colors:{blue:"notification--info",green:"notification--success",yellow:"notification--warning",red:"notification--danger",gray:"notification--default"},reversedColors:{"notification--info":"blue","notification--success":"green","notification--warning":"yellow","notification--danger":"red","notification--default":"gray"}},pageHeading:"page__heading",pageHeadingBreadcrumbs:"page__heading__breadcrumbs",pageHeadingButton:"page__heading__button",selected:"is-selected"},[Le]:{button:{root:"btn_action",colors:{white:"white","alternate-white":"page_heading_btn",green:"green",yellow:"yellow",red:"red",gray:"grey"},reversedColors:{white:"white",page_heading_btn:"alternate-white",green:"green",yellow:"yellow",red:"red",grey:"gray"}},disabled:"is_disabled",hidden:"is_hidden",notification:{root:"notification",marginTop:"",colors:{blue:"blue",green:"green",yellow:"yellow",red:"red",gray:"gray"},reversedColors:{blue:"blue",green:"green",yellow:"yellow",red:"red",gray:"gray"}},pageHeading:"page_heading",pageHeadingBreadcrumbs:"page_heading_breadcrumbs",pageHeadingButton:"page_heading_btn",selected:"is_selected"}},qe=0,Re=1,Me=2,Oe=3,Ue=4,Fe=5,$e=6,We=7,Ve=8,je=9,He=10,Je=11,Ye=12,Ke=13,ze=14;class Qe{constructor(e){o()(this,"_namespace",void 0),o()(this,"_data",{isHidden:!1}),o()(this,"_nodes",{outer:null}),o()(this,"_hasBuilt",!1),o()(this,"insert",(e,t)=>{if(this._nodes.outer||this.build(),!this._nodes.outer)throw this.getError("failed to insert");return Se.insert(e,t,this._nodes.outer),this}),o()(this,"destroy",()=>{if(!this._nodes.outer)throw this.getError("failed to destroy");return this._nodes.outer.remove(),this._nodes.outer=null,this._hasBuilt=!1,this.reset(),this}),o()(this,"hide",()=>{if(!this._nodes.outer)throw this.getError("failed to hide");return this._data.isHidden=!0,this._nodes.outer.classList.add(Ge[this._namespace].hidden),this}),o()(this,"show",()=>{if(!this._nodes.outer)throw this.getError("failed to show");return this._data.isHidden=!1,this._nodes.outer.classList.remove(Ge[this._namespace].hidden),this}),o()(this,"toggleHidden",e=>{if(!this._nodes.outer)throw this.getError("failed to show");return this._data.isHidden=e,this._nodes.outer.classList.toggle(Ge[this._namespace].hidden,this._data.isHidden),this}),o()(this,"getError",e=>new Error(`${this.constructor.name}: ${e}`)),this._namespace=e}static getError(e){return new Error(`${this.name}: ${e}`)}get namespace(){return this._namespace}get data(){return this._data}get nodes(){return this._nodes}get hasBuilt(){return this._hasBuilt}}var Ze,Xe,et;class tt extends Qe{constructor(e,t){super(t),o()(this,"_data",void 0),o()(this,"_nodes",void 0),o()(this,"_isBusy",!1),o()(this,"_currentStateNumber",void 0),o()(this,"_conflicts",[]),o()(this,"_queue",0),o()(this,"insert",(e,t)=>{if(this._nodes.outer||this.build(),!this._nodes.outer)throw this.getError("failed to insert");return this._nodes.container?Se.insert(e,t,this._nodes.container):e.matches(tt.containerSelectors[this._namespace])?Se.insert(e,t,Se.element("div",{className:`${De.buttonContainer} ${this._data.additionalContainerClass}`,ref:e=>this._nodes.container=e},this._nodes.outer)):Se.insert(e,t,this._nodes.outer),this}),o()(this,"destroy",()=>{if(!this._nodes.outer)throw this.getError("failed to destroy");return this._nodes.outer.remove(),this._nodes.container&&this._nodes.container.remove(),this._nodes.outer=null,this._hasBuilt=!1,this.reset(),this}),o()(this,"reset",()=>{const e=this._nodes.container,t=this._nodes.outer,s=this._nodes.name;return this._data=tt.getInitialData(),this._nodes=tt.getInitialNodes(),t&&(this._nodes.container=e,this._nodes.outer=t,this._nodes.name=s,this._hasBuilt=!1,this._currentStateNumber=this._data.initialStateNumber,this.build()),this}),o()(this,"setColor",e=>{if(!this._nodes.outer)throw this.getError("failed to set color");if(this._hasBuilt&&this._data.color===e)return this;const t=Ge[this._namespace].button;return this._data.color=e,this._nodes.outer.className=[De.button,t.root,t.colors[this._data.color]].join(" ").trim(),this}),o()(this,"setDisabled",e=>{if(!this._nodes.outer)throw this.getError("failed to set disabled");return this._hasBuilt&&this._data.isDisabled===e||(this._data.isDisabled=e,this._nodes.outer.classList.toggle(Ge[this._namespace].disabled,this._data.isDisabled)),this}),o()(this,"setTooltip",e=>{if(!this._nodes.outer)throw this.getError("failed to set tooltip");return this._hasBuilt&&this._data.tooltip===e||(this._data.tooltip=e,this._nodes.outer.title=e),this}),o()(this,"setContent",(e,t)=>(this.setIcons(e),this.setName(t),this)),o()(this,"setName",e=>{if(!this._nodes.name)throw this.getError("failed to set name");return this._hasBuilt&&this._data.name===e||(this._data.name=e,this._nodes.name.textContent=this._data.name),this}),o()(this,"parse",e=>{if(!e.matches(tt.selectors[this._namespace]))throw this.getError("failed to parse");this._nodes.outer=e;const t=this._nodes.outer.parentElement;return null!=t&&t.matches("."+De.buttonContainer)&&(this._nodes.container=t),this.parseColor(),this.parseDisabled(),this.parseTooltip(),this.parseIcons(),this.parseName(),this._data.states=[{color:this._data.color,isDisabled:this._data.isDisabled,tooltip:this._data.tooltip,icons:this._data.icons,name:this._data.name}],this._data.initialStateNumber=1,this}),o()(this,"parseColor",()=>{var e;if(!this._nodes.outer)throw this.getError("failed to parse color");const t=null===(e=tt.colorRegExps[this._namespace].exec(this._nodes.outer.className))||void 0===e?void 0:e[1];return this._data.color=Ge[this._namespace].button.reversedColors[t],this}),o()(this,"parseDisabled",()=>{if(!this._nodes.outer)throw this.getError("failed to parse tooltip");return this._data.isDisabled=this._nodes.outer.classList.contains(Ge[this._namespace].disabled),this}),o()(this,"parseTooltip",()=>{if(!this._nodes.outer)throw this.getError("failed to parse tooltip");return this._data.tooltip=this._nodes.outer.title,this}),o()(this,"parseIcons",()=>{if(!this._nodes.outer)throw this.getError("failed to parse icons");this._data.icons=[],this._nodes.icons=Array.from(this._nodes.outer.querySelectorAll("i"));for(const e of this._nodes.icons){const t=[];let s;for(;null!==(s=tt.iconsRegExp.exec(e.className));)t.push(s[0]);this._data.icons.push(t.join(" "))}return this}),o()(this,"onClick",async e=>{var t,s;if(this._data.isDisabled)return e&&(this._queue+=1),this;const n=this._data.states[this._currentStateNumber-1];if(!n)throw this.getError("current state does not exist");this._isBusy=!0,this.disableConflicts();let a=null!==(t=null===(s=n.switchTo)||void 0===s?void 0:s.onClick)&&void 0!==t?t:this._currentStateNumber%this._data.states.length+1;var i,o;(a>0&&this.build(a),!n.isDisabled&&n.onClick&&await n.onClick(this),this._currentStateNumber===a)&&(a=null!==(i=null===(o=n.switchTo)||void 0===o?void 0:o.onReturn)&&void 0!==i?i:this._currentStateNumber%this._data.states.length+1,a>0&&this.build(a));return this.enableConflicts(),this._isBusy=!1,this._queue>0&&(this._queue-=1,this.onClick()),this}),o()(this,"addConflict",e=>(this._conflicts.push(e),this)),o()(this,"disableConflicts",()=>{for(const e of this._conflicts)e.setDisabled(!0);return this}),o()(this,"enableConflicts",()=>{for(const e of this._conflicts)e.setDisabled(!1);return this}),this._data=tt.getInitialData(e),this._nodes=tt.getInitialNodes(),this._currentStateNumber=this._data.initialStateNumber}get isBusy(){return this._isBusy}}Ze=tt,o()(tt,"defaultColor","gray"),o()(tt,"colorRegExps",{[Pe]:new RegExp(`(${Object.keys(Ge[Pe].button.reversedColors).join("|")})`),[Le]:new RegExp(`${Ge[Le].button.root}\\s(${Object.keys(Ge[Le].button.colors).join("|")})`)}),o()(tt,"iconsRegExp",/fa-(?!fw)[\w-]+/g),o()(tt,"selectors",{[Pe]:Object.values(Ge[Pe].button.colors).map(e=>"."+e.replace(" ",".")).join(", "),[Le]:Object.values(Ge[Le].button.colors).map(e=>`.${Ge[Pe].button.root}.${e}`).join(", ")}),o()(tt,"containerKeys",["mmButtonGroup","giveawayColumns","pageHeading"]),o()(tt,"containerSelectors",{[Pe]:Ze.containerKeys.map(e=>{var t;return"."+(null!==(t=Ge[Pe][e])&&void 0!==t?t:De[e])}).join(", "),[Le]:Ze.containerKeys.map(e=>{var t;return"."+(null!==(t=Ge[Le][e])&&void 0!==t?t:De[e])}).join(", ")}),o()(tt,"templates",{[Pe]:{loading:{color:"white",icons:["fa-circle-o-notch fa-spin"]},success:{color:"green",icons:["fa-check-circle"]},warning:{color:"yellow",icons:["fa-exclamation-circle"]},error:{color:"red",icons:["fa-times-circle"]},info:{color:"gray",icons:[]}},[Le]:{loading:{color:"white",icons:["fa-circle-o-notch fa-spin"]},success:{color:"green",icons:["fa-check"]},warning:{color:"yellow",icons:["fa-exclamation"]},error:{color:"red",icons:["fa-times"]},info:{color:"gray",icons:[]}}}),o()(tt,"getInitialData",(e={})=>{let t,s="",n="",a=1;if(Array.isArray(e))t=e;else if("color"in e||"template"in e)t=[e];else{var i,o,r,l;s=null!==(i=e.additionalContainerClass)&&void 0!==i?i:"",n=null!==(o=e.additionalClass)&&void 0!==o?o:"",t=[...null!==(r=e.states)&&void 0!==r?r:[]],a=null!==(l=e.initialStateNumber)&&void 0!==l?l:1}return{additionalContainerClass:s,additionalClass:n,color:Ze.defaultColor,isHidden:!1,isDisabled:!1,tooltip:"",icons:[],name:"",states:t,initialStateNumber:a}}),o()(tt,"getInitialNodes",()=>({container:null,outer:null,icons:[],name:null})),o()(tt,"create",(e={},t=Be.namespace)=>{switch(t){case Pe:return new st(e);case Le:return new nt(e);default:throw Ze.getError("failed to create")}}),o()(tt,"getAll",(e,t=Be.namespace)=>{const s=[],n=e.querySelectorAll(Ze.selectors[t]);for(const e of n){const n=Ze.create({},t);n.parse(e),s.push(n)}return s});class st extends tt{constructor(e){super(e,Pe),o()(this,"build",(e=this._currentStateNumber)=>{var t,s,n;if(this._hasBuilt&&this._currentStateNumber===e)return this;this._nodes.outer||(this._nodes.outer=Se.element("div",{onclick:this.onClick}),this._nodes.name=document.createTextNode(""),null===(n=this._nodes.outer)||void 0===n||n.appendChild(this._nodes.name));const a=this._data.states[e-1];if(!a)throw this.getError("state does not exist");let i,o;var r;(({color:i,icons:o}="template"in a?tt.templates[this._namespace][a.template]:a),this.setColor(i),this._data.additionalClass)&&(null===(r=this._nodes.outer)||void 0===r||r.classList.add(this._data.additionalClass));return this.toggleHidden(this._data.isHidden),this.setDisabled(null!==(t=a.isDisabled)&&void 0!==t&&t),a.tooltip&&this.setTooltip(a.tooltip),this.setContent(null!=o?o:[],null!==(s=a.name)&&void 0!==s?s:""),this._hasBuilt=!0,this._currentStateNumber=e,Ee.dispatch(He,this),this}),o()(this,"setIcons",e=>{if(!this._nodes.outer)throw this.getError("failed to set icons");return this._hasBuilt&&l.isDeepEqual(this._data.icons,e)||(this.removeIcons(),this._data.icons=e,this._nodes.icons=[],Se.insert(this._nodes.outer,"afterbegin",Se.element("fragment",null,this._data.icons.map(e=>Se.element("fragment",null,Se.element("i",{className:"fa "+e,ref:e=>this._nodes.icons.push(e)})," "))))),this}),o()(this,"removeIcons",()=>{if(0===this._data.icons.length)return this;for(const e of this._nodes.icons){const t=e.nextSibling;e.remove(),(null==t?void 0:t.nodeType)===Node.TEXT_NODE&&" "===t.textContent&&t.remove()}return this._data.icons=[],this._nodes.icons=[],this}),o()(this,"parseName",()=>{if(!this._nodes.outer)throw this.getError("failed to parse name");if(this._data.icons.length>0){var e;let t=this._nodes.icons[this._nodes.icons.length-1].nextSibling;(null===(e=t)||void 0===e?void 0:e.nodeType)===Node.TEXT_NODE&&" "===t.textContent&&(t=t.nextSibling),this._nodes.name=t}else this._nodes.name=this._nodes.outer.firstChild;if(!this._nodes.name)throw this.getError("failed to parse name");return this._data.name=this._nodes.name.textContent.trim(),this})}}class nt extends tt{constructor(e){super(e,Le),o()(this,"build",(e=this._currentStateNumber)=>{var t,s;if(this._hasBuilt&&this._currentStateNumber===e)return this;this._nodes.outer||(this._nodes.outer=Se.element("div",{onclick:this.onClick},Se.element("span",{ref:e=>this._nodes.name=e})));const n=this._data.states[e-1];if(!n)throw this.getError("state does not exist");let a,i;var o;(({color:a,icons:i}="template"in n?tt.templates[this._namespace][n.template]:n),this.setColor(a),this._data.additionalClass)&&(null===(o=this._nodes.outer)||void 0===o||o.classList.add(this._data.additionalClass));return this.toggleHidden(this._data.isHidden),this.setDisabled(null!==(t=n.isDisabled)&&void 0!==t&&t),n.tooltip&&this.setTooltip(n.tooltip),this.setContent(null!=i?i:[],null!==(s=n.name)&&void 0!==s?s:""),this._hasBuilt=!0,this._currentStateNumber=e,Ee.dispatch(He,this),this}),o()(this,"setIcons",e=>{if(!this._nodes.outer)throw this.getError("failed to set icons");return this._hasBuilt&&l.isDeepEqual(this._data.icons,e)||(this.removeIcons(),this._data.icons=e,this._nodes.icons=[],Se.insert(this._nodes.outer,"afterbegin",Se.element("fragment",null,this._data.icons.map(e=>Se.element("i",{className:"fa "+e,ref:e=>this._nodes.icons.push(e)}))))),this}),o()(this,"removeIcons",()=>{if(0===this._data.icons.length)return this;for(const e of this._nodes.icons)e.remove();return this._data.icons=[],this._nodes.icons=[],this}),o()(this,"parseName",()=>{if(!this._nodes.outer)throw this.getError("failed to parse name");if(this._nodes.name=this._nodes.outer.querySelector("span:last-child"),!this._nodes.name)throw this.getError("failed to parse name");return this._data.name=this._nodes.name.textContent.trim(),this})}}class at extends Qe{constructor(e,t){super(t),o()(this,"_data",void 0),o()(this,"_nodes",void 0),o()(this,"setLoading",e=>(this.setColor("blue").setContent(["fa-circle-o-notch fa-spin"],void 0===e?this._data.message:e),this)),o()(this,"setSuccess",e=>(this.setColor("green").setContent(["fa-check-circle"],void 0===e?this._data.message:e),this)),o()(this,"setWarning",e=>(this.setColor("yellow").setContent(["fa-exclamation-circle"],void 0===e?this._data.message:e),this)),o()(this,"setError",e=>(this.setColor("red").setContent(["fa-times-circle"],void 0===e?this._data.message:e),this)),o()(this,"setInfo",e=>(this.setColor("gray").setContent([],void 0===e?this._data.message:e),this)),o()(this,"setColor",e=>{if(!this._nodes.outer)throw this.getError("failed to set color");if(this._hasBuilt&&this._data.color===e)return this;const t=Ge[this._namespace].notification;return this._data.color=e,this._nodes.outer.className=[De.notification,t.root,t.colors[this._data.color],t.marginTop].join(" ").trim(),this}),o()(this,"parse",e=>{if(!e.matches(at.selectors[this._namespace]))throw this.getError("failed to parse");return this._nodes.outer=e,this.parseColor(),this.parseIcons(),this.parseMessage(),this}),o()(this,"parseColor",()=>{var e;if(!this._nodes.outer)throw this.getError("failed to parse color");const t=null===(e=at.colorRegExps[this._namespace].exec(this._nodes.outer.className))||void 0===e?void 0:e[1];return this._data.color=Ge[this._namespace].notification.reversedColors[t],this}),o()(this,"parseIcons",()=>{if(!this._nodes.outer)throw this.getError("failed to parse icons");this._data.icons=[],this._nodes.icons=Array.from(this._nodes.outer.querySelectorAll("i"));for(const e of this._nodes.icons){const t=[];let s;for(;null!==(s=at.iconsRegExp.exec(e.className));)t.push(s[0]);this._data.icons.push(t.join(" "))}return this}),this._data=at.getInitialData(e),this._nodes=at.getInitialNodes()}}Xe=at,o()(at,"defaultColor","gray"),o()(at,"colorRegExps",{[Pe]:new RegExp(`(${Object.keys(Ge[Pe].notification.reversedColors).join("|")})`),[Le]:new RegExp(`${Ge[Le].notification.root}\\s(${Object.keys(Ge[Le].notification.colors).join("|")})`)}),o()(at,"iconsRegExp",/fa-(?!fw)[\w-]+/g),o()(at,"selectors",{[Pe]:Object.values(Ge[Pe].notification.colors).map(e=>`.${Ge[Pe].notification.root}.${e}`).join(", "),[Le]:Object.values(Ge[Le].notification.colors).map(e=>`.${Ge[Pe].notification.root}.${e}`).join(", ")}),o()(at,"getInitialData",(e={})=>{var t,s,n,a;return{color:null!==(t=e.color)&&void 0!==t?t:Xe.defaultColor,isHidden:null!==(s=e.isHidden)&&void 0!==s&&s,icons:[...null!==(n=e.icons)&&void 0!==n?n:[]],message:null!==(a=e.message)&&void 0!==a?a:null}}),o()(at,"getInitialNodes",()=>({outer:null,icons:[],message:[]})),o()(at,"create",(e={},t=Be.namespace)=>{switch(t){case Pe:return new it(e);case Le:return new ot(e);default:throw Xe.getError("failed to create")}}),o()(at,"getAll",(e,t=Be.namespace)=>{const s=[],n=e.querySelectorAll(Xe.selectors[t]);for(const e of n){const n=Xe.create({},t);n.parse(e),s.push(n)}return s});class it extends at{constructor(e){super(e,Pe),o()(this,"_nodes",void 0),o()(this,"build",()=>(this._nodes.outer||(this._nodes.outer=Se.element("div",null)),this.setColor(this._data.color),this.toggleHidden(this._data.isHidden),this.setContent(this._data.icons,this._data.message),this._hasBuilt=!0,Ee.dispatch(je,this),this)),o()(this,"reset",()=>{const e=this._nodes.outer;return this._data=at.getInitialData(),this._nodes=it.getInitialNodes(),e&&(this._nodes.outer=e,this._hasBuilt=!1,this.build()),this}),o()(this,"setContent",(e,t)=>{if(!this._nodes.outer)throw this.getError("failed to set content");const s=this._hasBuilt&&l.isDeepEqual(this._data.icons,e),n=this._hasBuilt&&this._data.message===t;return s||n||(this._nodes.outer.innerHTML="",this._data.icons=[],this._data.message=null,this._nodes.icons=[],this._nodes.message=[]),this.setIcons(e),this.setMessage(t),this}),o()(this,"setIcons",e=>{if(!this._nodes.outer)throw this.getError("failed to set icons");return this._hasBuilt&&l.isDeepEqual(this._data.icons,e)||(this.removeIcons(),this._data.icons=e,this._nodes.icons=[],Se.insert(this._nodes.outer,"afterbegin",Se.element("fragment",null,this._data.icons.map(e=>Se.element("fragment",null,Se.element("i",{className:"fa "+e,ref:e=>this._nodes.icons.push(e)})," "))))),this}),o()(this,"setMessage",e=>{if(!this._nodes.outer)throw this.getError("failed to set message");if(this._hasBuilt&&this._data.message===e)return this;this.removeMessage(),this._data.message=e;const t=Se.element("fragment",null,this._data.message);return this._nodes.message=Array.from(t.childNodes),Se.insert(this._nodes.outer,"beforeend",t),this}),o()(this,"removeIcons",()=>{if(0===this._data.icons.length)return this;if(!this._nodes.outer)throw this.getError("failed to remove icons");if(this._data.message)for(const e of this._nodes.icons){const t=e.nextSibling;e.remove(),(null==t?void 0:t.nodeType)===Node.TEXT_NODE&&" "===t.textContent&&t.remove()}else this._nodes.outer.innerHTML="";return this._data.icons=[],this._nodes.icons=[],this}),o()(this,"removeMessage",()=>{if(!this._data.message)return this;if(!this._nodes.outer)throw this.getError("failed to remove message");if(this._data.icons.length>0)for(const e of this._nodes.message)e.remove();else this._nodes.outer.innerHTML="";return this._data.message=null,this._nodes.message=[],this}),o()(this,"parseMessage",()=>{if(!this._nodes.outer)throw this.getError("failed to parse message");if(this._data.icons.length>0){var e;this._nodes.message=[];let t=this._nodes.icons[this._nodes.icons.length-1].nextSibling;for((null===(e=t)||void 0===e?void 0:e.nodeType)===Node.TEXT_NODE&&" "===t.textContent&&(t=t.nextSibling);t;)this._nodes.message.push(t),t=t.nextSibling}else this._nodes.message=Array.from(this._nodes.outer.childNodes);return this._data.message=this._nodes.outer.textContent.trim(),this}),this._nodes=it.getInitialNodes()}}o()(it,"getInitialNodes",()=>({outer:null,icons:[],message:[]}));class ot extends at{constructor(e){super(e,Le),o()(this,"_nodes",void 0),o()(this,"build",()=>(this._nodes.outer||(this._nodes.outer=Se.element("div",{style:{marginTop:"5px"}},Se.element("div",{ref:e=>this._nodes.message=e}))),this.setColor(this._data.color),this.toggleHidden(this._data.isHidden),this.setContent(this._data.icons,this._data.message),this._hasBuilt=!0,Ee.dispatch(je,this),this)),o()(this,"reset",()=>{const e=this._nodes.outer,t=this._nodes.message;return this._data=at.getInitialData(),this._nodes=ot.getInitialNodes(),e&&(this._nodes.outer=e,this._nodes.message=t,this._hasBuilt=!1,this.build()),this}),o()(this,"setContent",(e,t)=>(this.setIcons(e),this.setMessage(t),this)),o()(this,"setIcons",e=>{if(!this._nodes.outer)throw this.getError("failed to set icons");return this._hasBuilt&&l.isDeepEqual(this._data.icons,e)||(this.removeIcons(),this._data.icons=e,this._nodes.icons=[],Se.insert(this._nodes.outer,"afterbegin",Se.element("fragment",null,this._data.icons.map(e=>Se.element("i",{className:"fa "+e,ref:e=>this._nodes.icons.push(e)}))))),this}),o()(this,"setMessage",e=>{if(!this._nodes.message)throw this.getError("failed to set message");return this._hasBuilt&&this._data.message===e||(this._data.message=e,Se.insert(this._nodes.message,"atinner",Se.element("fragment",null,this._data.message))),this}),o()(this,"removeIcons",()=>{if(0===this._data.icons.length)return this;for(const e of this._nodes.icons)e.remove();return this._data.icons=[],this._nodes.icons=[],this}),o()(this,"removeMessage",()=>{if(!this._data.message)return this;if(!this._nodes.message)throw this.getError("failed to remove message");return this._nodes.message.innerHTML="",this._data.message=null,this}),o()(this,"parseMessage",()=>{if(!this._nodes.outer)throw this.getError("failed to parse message");if(this._nodes.message=this._nodes.outer.querySelector("div:last-child"),!this._nodes.message)throw this.getError("failed to parse message");return this._data.message=this._nodes.message.textContent.trim(),this}),this._nodes=ot.getInitialNodes()}}o()(ot,"getInitialNodes",()=>({outer:null,icons:[],message:null}));class rt{constructor(e,t){o()(this,"id",void 0),o()(this,"context",void 0),o()(this,"data",void 0),o()(this,"pages",void 0),o()(this,"sourceLink",null),o()(this,"addData",(e,t,s=1)=>{if(this.data[e].push(...t),s>0){this.addPage(s);const n=this.pages.get(s);n&&n[e].push(...t)}}),o()(this,"addPage",e=>{this.pages.has(e)||this.pages.set(e,rt.getInitialData())}),o()(this,"resetData",e=>{this.data[e]=[];for(const t of this.pages.values())t[e]=[]}),this.findData=this.findData.bind(this),this.id=e||crypto.randomUUID(),this.context=t,this.data=rt.getInitialData(),this.pages=new Map}findData(e,t=0){let s;const n=0===t?this.data:this.pages.get(t);if("string"==typeof e)s=n?n[e]:[];else if(s=rt.getInitialData(),n)for(const t of e)s[t]=n[t];return s}static findData(e,t,s=0){let n;if("string"==typeof t)if(n=[],e){const a=rt.find(e);a&&(n=a.findData(t,s))}else for(const e of rt.scopes.values()){const a=e.findData(t,s);n.push(...a)}else if(n=rt.getInitialData(),e){const a=rt.find(e);a&&(n=a.findData(t,s))}else for(const e of rt.scopes.values()){const a=e.findData(t,s);for(const[e,t]of Object.entries(a))n[e].push(...t)}return n}}et=rt,o()(rt,"scopes",new Map),o()(rt,"history",[]),o()(rt,"current",null),o()(rt,"getInitialData",()=>({comments:[],commentsV2:[],discussions:[],games:[],giveaways:[],groups:[],trades:[],users:[]})),o()(rt,"create",(e,t)=>{if(e&&et.scopes.has(e))throw new Error("Scope ID already exists.");const s=new et(e,t);return et.scopes.set(s.id,s),s}),o()(rt,"addData",(e,t,s,n=1)=>{const a="current"===e?et.current:et.scopes.get(e);a&&a.addData(t,s,n)}),o()(rt,"find",e=>("current"===e?et.current:et.scopes.get(e))||null),o()(rt,"remove",e=>{et.scopes.has(e)&&et.scopes.delete(e)}),o()(rt,"setCurrent",e=>{et.history.push(e),et.current=et.find(e)}),o()(rt,"resetCurrent",()=>{if(et.history.pop(),et.history.length>0){const e=et.history[et.history.length-1];et.current=et.find(e)}else et.current=null}),o()(rt,"purge",()=>{for(const e of et.scopes.values())for(const t of Object.values(e.data))for(let e=t.length-1;e>-1;e--){const s=t[e].nodes?t[e].nodes.outer:t[e].outerWrap;s&&!document.contains(s)&&t.splice(e,1)}});class lt{constructor(e={}){if(this.custom={},this.results=void 0,this.Options=void 0,this.Results=void 0,this.textArea=void 0,this.temp=e.isTemp,Se.insert(document.body,"beforeend",Se.element("div",{className:"esgst-hidden esgst-popup-layer",ref:e=>this.layer=e},e.popup||Se.element("div",{className:"esgst-popup"},Se.element("div",{className:"esgst-popup-heading "+(e.icon||e.title?"":"esgst-hidden")},Se.element("i",{className:`fa ${e.icon} esgst-popup-icon${e.icon?"":" esgst-hidden"}`}),Se.element("div",{className:"esgst-popup-title"+(e.title?"":" esgst-hidden")},e.title)),Se.element("div",{className:"esgst-popup-description"}),Se.element("div",{className:"esgst-popup-scrollable "+("left"===e.addScrollable?"esgst-text-left":"")},e.scrollableContent),Se.element("div",{className:"esgst-popup-actions"},Se.element("a",{className:"esgst-hidden",href:c.esgst.settingsUrl},"Settings"),Se.element("a",{className:"esgst-popup-close"},"Close"))),Se.element("div",{className:"esgst-popup-modal",title:"Click to close the modal"}))),this.onCloseByUser=e.onCloseByUser,this.onClose=e.onClose,this.popup=this.layer.firstElementChild,this.modal=this.layer.lastElementChild,e.popup)this.popup.classList.add("esgst-popup"),this.popup.style.display="block",this.popup.style.maxHeight="calc(100% - 150px)",this.popup.style.maxWidth="calc(100% - 150px)";else{this.popup.style.maxHeight="calc(100% - 50px)",this.popup.style.maxWidth="calc(100% - 50px)",this.icon=this.popup.firstElementChild.firstElementChild,this.title=this.icon.nextElementSibling,this.description=this.popup.firstElementChild.nextElementSibling,this.scrollable=this.description.nextElementSibling,this.actions=this.scrollable.nextElementSibling;let t=this.actions.firstElementChild;e.settings||(t.classList.remove("esgst-hidden"),t.addEventListener("click",e=>{d.get("openSettingsInTab")||(e.preventDefault(),c.esgst.modules.settingsModule.loadMenu(!0))}))}let t=this.popup.querySelector(".esgst-popup-close, .b-close");if(t&&t.addEventListener("click",()=>this.close(!0)),this.modal.addEventListener("click",()=>this.close(!0)),e.textInputs&&(this.textInputs=[],e.textInputs.forEach(e=>{let t;Se.insert(this.description,"beforeend",Se.element("fragment",null,e.title||null,Se.element("input",{placeholder:e.placeholder||"",ref:e=>t=e,type:"text"}))),t.addEventListener("keydown",e=>{var t;"Enter"!==e.key||null!==(t=this.buttons[0])&&void 0!==t&&t.isBusy||this.buttons[0].onClick()}),this.textInputs.push(t)})),e.options){this.description.appendChild(c.common.createOptions(e.options));let t=this.description.lastElementChild.getElementsByTagName("input");for(let e of t)switch(e.getAttribute("type")){case"number":c.common.observeNumChange(e,e.getAttribute("name"),!0);break;case"text":c.common.observeChange(e,e.getAttribute("name"),!0)}}e.buttons&&(this.buttons=[],e.buttons.forEach(e=>{const t=tt.create(e).insert(this.description,"beforeend");this.buttons.push(t)})),e.addProgress&&(this.progressBar=at.create().insert(this.description,"beforeend").hide(),this.overallProgressBar=at.create().insert(this.description,"beforeend").hide()),this.id=rt.create(null,this.popup).id}open(e){rt.setCurrent(this.id),this.isOpen=!0;let t=1e3+document.querySelectorAll(".esgst-popup-layer:not(.esgst-hidden), .esgst-popout:not(.esgst-hidden)").length;if(c.esgst.openPopups>0){const e=parseInt(c.esgst.popups[c.esgst.openPopups-1].popup.style.zIndex||0);t<=e&&(t=e+1)}c.esgst.openPopups+=1,c.esgst.popups.push(this),this.layer.classList.remove("esgst-hidden"),this.layer.style.zIndex=t,this.textInputs&&this.textInputs[0].focus(),e&&e()}close(e){rt.resetCurrent(),this.temp?(rt.remove(this.id),this.layer.remove()):(this.layer.classList.add("esgst-hidden"),d.get("minimizePanel")&&c.common.minimizePanel_addItem(this)),e&&this.onCloseByUser&&this.onCloseByUser(),this.onClose&&this.onClose(),c.esgst.openPopups-=1,c.esgst.popups.pop(),this.isOpen=!1}getTextInputValue(e){return this.textInputs[e].value}setScrollable(e){Se.insert(this.scrollable,"beforeend",Se.element("div",null,e))}getScrollable(e){let t;return Se.insert(this.scrollable,"beforeend",Se.element("div",{ref:e=>t=e},e)),t}clear(){this.progressBar.reset().hide(),this.overallProgressBar.reset().hide(),this.scrollable.innerHTML=""}setIcon(e){this.icon.className="fa "+e}setTitle(e){Se.insert(this.title,"atinner","string"==typeof e?Se.element("fragment",null,e):e)}setDone(e){this.temp=e,d.get("minimizePanel")&&!this.isOpen&&c.common.minimizePanel_alert(this)}reposition(){}}const ct=["error","warning","info"];const dt=new class{constructor(){this.logs=[],this.button=null,this.currentMaxLevel="info"}info(){const e=this.getMessage(arguments);window.console.info(e),this.logs.push({level:"info",message:e}),d.get("notifyLogs")&&this.addButton("info")}warning(){const e=this.getMessage(arguments);window.console.warn(e),this.logs.push({level:"warning",message:e}),d.get("notifyLogs")&&this.addButton("warning")}error(){const e=this.getMessage(arguments);window.console.error(e),this.logs.push({level:"error",message:e}),d.get("notifyLogs")&&this.addButton("error")}getMessage(e){return"[ESGST] "+Array.from(e).map(e=>"string"==typeof e?e:JSON.stringify(e)).join(" ")}addButton(e){this.button?ct.indexOf(e)<ct.indexOf(this.currentMaxLevel)&&(this.button.nodes.outer.classList.remove("esgst-logs-"+this.currentMaxLevel),this.button.nodes.outer.classList.add("esgst-logs-"+e),this.currentMaxLevel=e):(this.button=c.header.addButtonContainer({buttonIcon:"fa fa-bug",buttonName:"ESGST Logs",isActive:!0,isNotification:!0,side:"right"}),this.button.nodes.outer.classList.add("esgst-logs","esgst-logs-"+e),this.button.nodes.buttonIcon.title=c.common.getFeatureTooltip("notifyLogs","View logs"),this.button.nodes.outer.addEventListener("click",this.showPopup.bind(this)),this.currentMaxLevel=e)}showPopup(){const e=new lt({addScrollable:"left",icon:"fa-bug",isTemp:!0,title:"Logs"});Se.insert(e.scrollable,"beforeend",Se.element("div",{className:"popup__keys__list"},this.logs.map(e=>Se.element("div",{className:"esgst-log esgst-log-"+e.level},e.message)))),e.open()}};class gt{constructor(){this.esgst=null,this.info={id:"unknown",name:"Unknown",type:""}}init(){}setEsgst(e){return this.esgst=e,this}}const ut=new class{constructor(){o()(this,"permissions",void 0),this.permissions={allUrls:{isOrigin:!0,messages:{ge:"Required by Giveaway Extractor to extract giveaways from any URL."},values:["<all_urls>"]},cookies:{messages:{manipulateCookies:"Required if the option to manipulate cookies is enabled."},values:["cookies","webRequest","webRequestBlocking"]},dropbox:{isOrigin:!0,messages:{storage:"Required to back up / restore data to / from Dropbox."},values:["*://*.api.dropboxapi.com/*","*://*.content.dropboxapi.com/*"]},github:{isOrigin:!0,messages:{showChangelog:"Required to retrieve the changelog from GitHub when updating."},values:["*://*.github.com/*","*://*.raw.githubusercontent.com/*"]},googleDrive:{isOrigin:!0,messages:{storage:"Required to back up / restore data to / from Google Drive."},values:["*://*.googleapis.com/*"]},googleWebApp:{isOrigin:!0,messages:{sync:"Required to sync HLTB times."},values:["*://*.script.google.com/*","*://*.script.googleusercontent.com/*"]},imgur:{isOrigin:!0,messages:{cfh:"Required by Comment Formatting Helper to upload images."},values:["*://*.api.imgur.com/*"]},isThereAnyDeal:{isOrigin:!0,messages:{itadi:"Required by IsThereAnyDeal Info to retrieve the deals."},values:["*://*.isthereanydeal.com/*"]},oneDrive:{isOrigin:!0,messages:{storage:"Required to back up / restore data to / from OneDrive."},values:["*://*.files.1drv.com/*","*://*.graph.microsoft.com/*"]},sgTools:{isOrigin:!0,messages:{ge:"Required by Giveaway Extractor to extract SGTools giveaways.",namwc:"Required by Not Activated / Multiple Wins Checker to check users.",ugs:"Required by Unsent Gifts Sender if the option to check not activated / multiple wins is enabled."},values:["*://*.sgtools.info/*"]},server:{isOrigin:!0,messages:{gc:"Required by Game Categories to retrieve categories that need to be retrieved from Steam.",uh:"Required by Username History to retrieve the user's username history and the list of recent changes from the database.",ncv:"Required to update the no CV games database when creating a new giveaway.",sync:"Required to sync reduced CV and no CV games and optional to hide games when syncing.",hgm:"Optional for Hidden Game Manager to hide games, by converting Steam app IDs to SteamGifts game IDs.",mm:"Optional for Multi Manager to hide games."},values:["*://*.esgst.rafaelgomes.xyz/*"]},steamApi:{isOrigin:!0,messages:{glwc:"Required by Group Libraries / Wishlists Checker to retrieve the users' owned games.",hwlc:"Required by Have / Want List Checker to retrieve the user's owned games.",sync:"Required to sync owned / wishlisted / ignored games.",ugd:"Required by User Giveaway Data to retrieve the user's playtimes / achievement stats."},values:["*://*.api.steampowered.com/*"]},steamCommunity:{isOrigin:!0,messages:{as:"Required by Archive Searcher to retrieve the title of a game when searching by app id.",glwc:"Required by Group Libraries / Wishlists Checker to retrieve the group's members.",gs:"Required by Groups Stats to retrieve the group's type.",sgc:"Required by Shared Groups Checker to retrieve the user's groups.",sync:"Required to sync followed games.",ugs:"Required by Unsent Gifts Sender if the option to check group members is enabled."},values:["*://*.steamcommunity.com/*"]},steamStore:{isOrigin:!0,messages:{gc:"Required by Game Categories to retrieve categories that need to be retrieved from Steam.",glwc:"Required by Group Libraries / Wishlists Checker to retrieve the users' wishlists.",hwlc:"Required by Have / Want List Checker to retrieve the user's wishlist.",rcvc:"Required by Real CV Calculator to retrieve the game's price.",sync:"Required to sync owned / wishlisted / ignored games.",ugd:"Required by User Giveaway Data to get list of games in packages."},values:["*://*.store.steampowered.com/*"]},steamTracker:{isOrigin:!0,messages:{sync:"Required to sync delisted games."},values:["*://*.steam-tracker.com/*"]}}}async contains(e){let t=!1;for(const s of e){const{permissions:e,origins:a}=this.getValues(s);if(t=t||await n.runtime.sendMessage({action:"permissions_contains",permissions:JSON.stringify({permissions:e,origins:a})}),t)break}return t}request(e,t){const{permissions:s,origins:a}=this.getValues(e);n.permissions.request({permissions:s,origins:a}).then(t)}remove(e,t){const{permissions:s,origins:a}=this.getValues(e);n.permissions.remove({permissions:s,origins:a}).then(t)}getValues(e=[]){const t=[],s=[];for(const n of e){const e=this.permissions[n];e.isOrigin?s.push(...e.values):t.push(...e.values)}return{permissions:t,origins:s}}getMessage(e,t){const s=[];for(const t of e){const{permissions:e,origins:n}=this.getValues(t);s.push(e.concat(n).join(" + "))}return t?'If you want to perform this action faster, please go to the "Permissions" section of the settings menu and grant permissions for one (or all) of the combos: '+s.join(" OR "):'No permission to perform this action. Please go to the "Permissions" section of the settings menu and grant permissions for one (or all) of the combos: '+s.join(" OR ")}};class mt{constructor(e="",t=null,s=1e3,n=!1,a=null,i=null){if(this.custom={},"esgst-hidden-buttons"===e&&(this.isDynamicHeight=!0),this.onClose=null,this.onOpen=i,this.onFirstOpen=null,this.hasOpened=!1,this.context=t,a?this.popout=a:Se.insert(document.body,"beforeend",Se.element("div",{className:e,ref:e=>this.popout=e})),this.popout.classList.add("esgst-popout","esgst-hidden"),this.popup=this.popout.closest(".esgst-popup"),this.hoverSpeed=s,n)this.context&&this.context.addEventListener("click",()=>{this.isOpen?this.close():this.open()}),document.addEventListener("click",e=>{const t=e.target;!this.context||this.context.contains(t)||this.popout.contains(t)||this.close()});else{if(this.context){let e=null;this.context.addEventListener("mouseenter",()=>{e=window.setTimeout(()=>{this.open()},this.hoverSpeed)}),this.context.addEventListener("mouseleave",t=>{e&&(window.clearTimeout(e),e=null),this.popout.contains(t.relatedTarget)||this.close()})}let e=null;this.popout.addEventListener("mouseenter",()=>{e&&(window.clearTimeout(e),e=null)}),this.popout.addEventListener("mouseleave",t=>{e=window.setTimeout(()=>{t.relatedTarget&&!this.context.contains(t.relatedTarget)&&(this.ancestor&&this.ancestor.contains(t.relatedTarget)||!t.relatedTarget.closest(".esgst-popout"))&&(this.context.classList.remove("esgst-qgs-container-expanded"),this.close())},this.hoverSpeed)}),document.addEventListener("click",e=>{const t=e.target;this.context&&!this.context.contains(t)&&!this.popout.contains(t)&&(this.ancestor&&this.ancestor.contains(t)||!t.closest(".esgst-popout"))&&this.close()},!0)}this.isOpen=!1}open(e=null,t=!1){this.context=e||this.context,this.ancestor=this.context.closest(".esgst-popout"),this.isFixed=t,this.popout.classList.remove("esgst-hidden");let s=1e3+document.querySelectorAll(".esgst-popup:not(.esgst-hidden), .esgst-popout:not(.esgst-hidden)").length;if(c.esgst.openPopups>0){const e=parseInt(c.esgst.popups[c.esgst.openPopups-1].popup.style.zIndex||0);s<=e&&(s=e+1)}this.popout.style.zIndex=s,this.isFixed&&this.popout.classList.add("esgst-fixed"),this.reposition(),this.isOpen=!0,this.onOpen&&this.onOpen(this.popout),this.hasOpened||(this.hasOpened=!0,this.onFirstOpen&&this.onFirstOpen(this.popout))}close(){this.popout.classList.add("esgst-hidden"),this.isOpen&&this.onClose&&this.onClose(),this.isOpen=!1}reposition(e=null){let t,s,n,a,i,o;this.isDynamicHeight||(this.popout.style.height=""),this.popout.style.left="0",this.popout.style.top="0",this.context=e||this.context,s=this.context.getBoundingClientRect(),t=s.left,n=s.top,n>window.innerHeight-(n+s.height)?this.popout.style.maxHeight=n+"px":this.popout.style.maxHeight=window.innerHeight-(n+s.height)+"px";const r=parseFloat(window.getComputedStyle(this.popout).getPropertyValue("height")),l=this.popout.offsetHeight-r+10,g=Math.max(Math.min(r,document.documentElement.clientHeight-(n+s.height+l)),Math.min(r,n-l));this.isDynamicHeight||(this.popout.style.height=g+"px"),d.get("qiv")&&c.esgst.qiv.popout===this&&c.esgst.qiv.comments&&(c.esgst.qiv.comments.style.maxHeight=g-c.esgst.qiv.comments.offsetTop+"px"),a=this.popout.offsetHeight,i=this.popout.offsetWidth,o=this.popup&&this.popup.getBoundingClientRect(),t+i>document.documentElement.clientWidth?this.popout.style.left=t-i+s.width-(this.popup?o.left:0)+window.scrollX+"px":this.popout.style.left=t-(this.popup?o.left:0)+window.scrollX+"px",n+s.height+a>document.documentElement.clientHeight?this.popout.style.top=n-a+(this.isFixed||this.popup?0:window.scrollY)-(this.popup?o.top:0)+"px":this.popout.style.top=n+s.height+(this.isFixed||this.popup?0:window.scrollY)-(this.popup?o.top:0)+"px"}}var ht;s(65),s(66);class pt extends Qe{constructor(e,t,s){super(s),o()(this,"_featureId",void 0),o()(this,"_data",void 0),o()(this,"_nodes",void 0),o()(this,"build",()=>(this._nodes.outer||(this._nodes.outer=Se.element("div",{className:Ge[this._namespace].pageHeading,dataset:{esgst:this._featureId}},Se.element("div",{className:Ge[this._namespace].pageHeadingBreadcrumbs,ref:e=>this._nodes.breadcrumbsContainer=e}))),this.setBreadcrumbs(this._data.breadcrumbs),this._hasBuilt=!0,Ee.dispatch(Je,this),this)),o()(this,"reset",()=>{const e=this._nodes.outer,t=this._nodes.breadcrumbsContainer;return this._data=pt.getInitialData(),this._nodes=pt.getInitialNodes(),e&&(this._nodes.outer=e,this._nodes.breadcrumbsContainer=t,this._hasBuilt=!1,this.build()),this}),o()(this,"parse",e=>{if(!e.matches(pt.selectors[this._namespace]))throw this.getError("failed to parse");return this._nodes.outer=e,this.parseBreadcrumbs(),this}),o()(this,"parseBreadcrumbs",()=>{if(!this._nodes.outer)throw this.getError("failed to parse breadcrumbs");if(this._nodes.breadcrumbsContainer=this._nodes.outer.querySelector(Ge[this._namespace].pageHeadingBreadcrumbs),!this._nodes.breadcrumbsContainer)throw this.getError("failed to parse breadcrumbs");this._data.breadcrumbs=[],this._nodes.breadcrumbs=Array.from(this._nodes.breadcrumbsContainer.children);for(const t of this._nodes.breadcrumbs){var e;this._data.breadcrumbs.push({url:null!==(e=t.getAttribute("href"))&&void 0!==e?e:"",name:t.textContent.trim()})}return this}),this._featureId=e,this._data=pt.getInitialData(t),this._nodes=pt.getInitialNodes()}setBreadcrumbs(e){if(!this._nodes.breadcrumbsContainer)throw this.getError("failed to set breadcrumbs");return this._hasBuilt&&l.isDeepEqual(this._data.breadcrumbs,e)||(this._data.breadcrumbs=e,this._nodes.breadcrumbs=[],Se.insert(this._nodes.breadcrumbsContainer,"atinner",Se.element("fragment",null,this._data.breadcrumbs.map(e=>["string"==typeof e||e instanceof Node?Se.element("span",{ref:e=>this._nodes.breadcrumbs.push(e)},e):Se.element("a",{href:e.url,ref:e=>this._nodes.breadcrumbs.push(e)},e.name),Se.element("i",{className:"fa fa-angle-right"})]).flat().slice(0,-1)))),this}}ht=pt,o()(pt,"selectors",{[Pe]:"."+Ge[Pe].pageHeading,[Le]:"."+Ge[Le].pageHeading}),o()(pt,"getInitialData",(e={})=>{let t;var s;Array.isArray(e)?t=e:t=[...null!==(s=e.breadcrumbs)&&void 0!==s?s:[]];return{isHidden:!1,breadcrumbs:t}}),o()(pt,"getInitialNodes",()=>({outer:null,breadcrumbsContainer:null,breadcrumbs:[]})),o()(pt,"create",(e,t={},s=Be.namespace)=>{switch(s){case Pe:return new ft(e,t);case Le:return new bt(e,t);default:throw ht.getError("failed to create")}}),o()(pt,"getAll",(e,t,s=Be.namespace)=>{const n=[],a=t.querySelectorAll(ht.selectors[s]);for(const t of a){const a=ht.create(e,{},s);a.parse(t),n.push(a)}return n});class ft extends pt{constructor(e,t){super(e,t,Pe)}}class bt extends pt{constructor(e,t){super(e,t,Le)}}const wt=new class{constructor(){o()(this,"steps",[{doShow:()=>c.esgst.isFirstRun,isConfirmStep:!0,title:"Get started with ESGST",description:()=>Se.element("fragment",null,"All good, ",d.get("username"),'! You\'ll now be guided through a series of feature combos, so you can shape your ESGST experience based on your needs. Choose "Yes" for the combos you want and "No" for the ones you don\'t. When you\'re ready, click "Next" to proceed.'),settings:{},permissions:[],sync:[]},{doShow:()=>!0,title:"Always within reach",description:Se.element("ul",null,Se.element("li",null,"See the header, main page heading and sidebar at all times"),Se.element("li",null,"The pagination navigation is moved to the main page heading"),Se.element("li",null,"Quickly scroll to the top of the page")),settings:{fh_sg:1,fh_st:1,fmph_sg:1,fmph_st:1,fs_sg:1,pnot_sg:1,pnot_st:1,pnot_s_sg:1,pnot_s_st:1,sttb_sg:1,sttb_st:1},permissions:[],sync:[]},{doShow:()=>!0,title:"Infinite content",description:Se.element("ul",null,Se.element("li",null,"Endlessly load new content as you scroll down the page")),settings:{es_sg:1,es_st:1,es_murl_sg:1,es_murl_st:1,es_gb_sg:1,es_ge_sg:1},permissions:[],sync:[]},{doShow:()=>!0,title:"Less is more",description:Se.element("ul",null,Se.element("li",null,"The active discussions in the main page are moved to the sidebar"),Se.element("li",null,"Giveaways are shown as a grid instead of a list"),Se.element("li",null,"The sidebar size is reduced")),settings:{adots_sg:1,adots_index:1,gv_sg:1,gv_gb_sg:1,gv_ge_sg:1,ns_sg:1},permissions:[],sync:[]},{doShow:()=>!0,title:"More is less",description:Se.element("ul",null,Se.element("li",null,"Linked YouTube/Vimeo videos are automatically embedded in posts"),Se.element("li",null,"Attached images are automatically embedded in posts")),settings:{ev_sg:1,ev_st:1,vai_sg:1,vai_st:1,vai_gifv_sg:1,vai_gifv_st:1},permissions:[],sync:[]},{doShow:()=>!0,title:"General improvements",description:Se.element("ul",null,Se.element("li",null,"Attached images are loaded on demand to improve page loading times (note that if you enable this combo, it will overwrite the previous combo's setting to embed images in posts)"),Se.element("li",null,"Broken giveaway URLs are automatically fixed"),Se.element("li",null,'"Last Page" links are added to pages that don\'t have them, when possible')),settings:{ail_sg:1,ail_st:1,urlr_sg:1,lpl_sg:1,lpl_st:1,vai_sg:0,vai_st:0},permissions:[],sync:[]},{doShow:()=>!0,title:"Starter kit for creating giveaways",description:Se.element("ul",null,Se.element("li",null,"See stats about who commented/entered your giveaways"),Se.element("li",null,"See more information about your giveaways in the created page"),Se.element("li",null,"Filter giveaways by status (received, not received, awaiting feedback) and winners"),Se.element("li",null,"Quickly recreate giveaways that ended with 0 entries"),Se.element("li",null,"Save giveaway templates to quickly create giveaways using the same template"),Se.element("li",null,"Create multiple giveaways at once and easily create trains (giveaways are automatically connected to each other through previous/next links)"),Se.element("li",null,"Search for a specific key or set of keys in your giveaways and export all of your keys"),Se.element("li",null,"Sticky your most used countries/groups to the top in the new giveaway page, for quick access"),Se.element("li",null,"Send all of your unsent gifts to the winners at once and check the winners for not activated / multiple wins / group membership / other criteria before sending")),settings:{cec_sg:1,cewgd_sg:1,cewgd_c_sg:1,cewgd_c_p_sg:1,cewgd_c_sl_sg:1,cewgd_c_t_sg:1,cewgd_c_l_sg:1,cewgd_c_w_sg:1,gf_sg:1,gf_m_sg:1,gf_m_a_sg:1,gf_received_sg:1,gf_notReceived_sg:1,gf_awaitingFeedback_sg:1,gf_winners_sg:1,gf_enableCreated:1,gr_sg:1,gr_r_sg:1,gts_sg:1,mgc_sg:1,sks_sg:1,sgac_sg:1,sgg_sg:1,ugs_sg:1},permissions:["sgTools","steamCommunity"],sync:[]},{doShow:()=>!0,title:"Starter kit for entering/winning giveaways",description:Se.element("ul",null,Se.element("li",null,"Quickly use SteamGifts' advanced giveaway search options"),Se.element("li",null,"See more information about your entered/won giveaways in the entered/won pages"),Se.element("li",null,"Enter/leave giveaways without having to access them"),Se.element("li",null,"Keep track of your entries"),Se.element("li",null,"Bookmark giveaways to enter later"),Se.element("li",null,"Quickly extract all giveaways from a train"),Se.element("li",null,"Filter giveaways by level, entries, points, etc. (entered giveaways are automatically hidden)"),Se.element("li",null,"Sort giveaways by entries, points, etc."),Se.element("li",null,"See your current chance of winning a giveaway"),Se.element("li",null,"See the current entries/copy ratio of a giveaway"),Se.element("li",null,"Navigate through trains using the arrow keys"),Se.element("li",null,"Hide giveaways with one click"),Se.element("li",null,"Quickly activate a key from a won game on Steam"),Se.element("li",null,"If you don't have enough points to enter a giveaway, see how long you have to wait until you have enough points"),Se.element("li",null,"See information about games (such as whether a game has achievements, trading cards, etc.) and filter giveaways by this information"),Se.element("li",null,"Keep track of games by tagging them")),settings:{ags_sg:1,cewgd_sg:1,cewgd_e_sg:1,cewgd_e_p_sg:1,cewgd_e_sl_sg:1,cewgd_e_t_sg:1,cewgd_e_l_sg:1,cewgd_w_sg:1,cewgd_w_p_sg:1,cewgd_w_sl_sg:1,cewgd_w_t_sg:1,cewgd_w_l_sg:1,cewgd_w_e_sg:1,elgb_sg:1,et_sg:1,gb_sg:1,gb_h_sg:1,ge_sg:1,ge_a_sg:1,gf_sg:1,gf_m_sg:1,gf_m_a_sg:1,gf_level_sg:1,gf_entries_sg:1,gf_copies_sg:1,gf_points_sg:1,gf_comments_sg:1,gf_minutesToEnd_sg:1,gf_chance_sg:1,gf_ratio_sg:1,gf_rating_sg:1,gf_reviews_sg:1,gf_releaseDate_sg:1,gf_pinned_sg:1,gf_public_sg:1,gf_inviteOnly_sg:1,gf_group_sg:1,gf_whitelist_sg:1,gf_regionRestricted_sg:1,gf_created_sg:1,gf_entered_sg:1,gf_owned_sg:1,gf_wishlisted_sg:1,gf_followed_sg:1,gf_ignored_sg:1,gf_bookmarked_sg:1,gf_fullCV_sg:1,gf_reducedCV_sg:1,gf_noCV_sg:1,gf_creators_sg:1,gf_learning_sg:1,gf_removed_sg:1,gf_tradingCards_sg:1,gf_achievements_sg:1,gf_singleplayer_sg:1,gf_multiplayer_sg:1,gf_steamCloud_sg:1,gf_linux_sg:1,gf_mac_sg:1,gf_dlc_sg:1,gf_dlcOwned_sg:1,gf_package_sg:1,gf_earlyAccess_sg:1,gf_genres_sg:1,gf_tags_sg:1,gf_enable:1,gf_enableGroups:1,gf_enableWishlist:1,gf_enableRecommended:1,gf_enableGroup:1,gf_enableNew:1,gf_enableEntered:1,gf_enableWon:1,gf_enableUser:1,gf_preset:"HideEntered",gf_presetGroups:"HideEntered",gf_presetWishlist:"HideEntered",gf_presetRecommended:"HideEntered",gf_presetGroup:"HideEntered",gf_presetNew:"HideEntered",gf_presetEntered:"HideEntered",gf_presetWon:"HideEntered",gf_presetUser:"HideEntered",gf_presets:[{name:"HideEntered",rules:{condition:"AND",rules:[{id:"entered",field:"entered",type:"boolean",input:"radio",operator:"equal",value:!1}],not:!1,valid:!0}}],gas_sg:1,gwc_sg:1,gwr_sg:1,npth_sg:1,ochgb_sg:1,sal_sg:1,ttec_sg:1,gc_sg:1,gc_a_sg:1,gc_dlc_sg:1,gc_dlc_o_sg:1,gc_ea_sg:1,gc_f_sg:1,gc_fcv_sg:1,gc_g_sg:1,gc_i_sg:1,gc_lg_sg:1,gc_l_sg:1,gc_m_sg:1,gc_mp_sg:1,gc_ncv_sg:1,gc_o_sg:1,gc_p_sg:1,gc_r_sg:1,gc_rcv_sg:1,gc_rd_sg:1,gc_rm_sg:1,gc_sp_sg:1,gc_sc_sg:1,gc_tc_sg:1,gc_w_sg:1,gt_sg:1,gt_s_sg:1},permissions:["server","steamCommunity","steamStore"],sync:["Games","FollowedGames","NoCvGames","ReducedCvGames"]},{doShow:()=>!0,title:"Starter kit for commenting",description:Se.element("ul",null,Se.element("li",null,"Quickly use comment formatting"),Se.element("li",null,"Mark comments as read/unread and keep track of which comments you've read"),Se.element("li",null,"Reply to multiple comments at the same time, without having to reload the page"),Se.element("li",null,"Reply to main posts faster, by having the reply box below the OP instead of at the bottom of the page"),Se.element("li",null,"Reply to comments from your inbox"),Se.element("li",null,"See who replied to whom (useful for deep nested replies)")),settings:{cfh_sg:1,cfh_st:1,cfh_bq_sg:1,cfh_bq_st:1,cfh_b_sg:1,cfh_b_st:1,cfh_h1_sg:1,cfh_h1_st:1,cfh_h2_sg:1,cfh_h2_st:1,cfh_h3_sg:1,cfh_h3_st:1,cfh_ic_sg:1,cfh_ic_st:1,cfh_i_sg:1,cfh_i_st:1,cfh_lb_sg:1,cfh_lb_st:1,cfh_lc_sg:1,cfh_lc_st:1,cfh_ol_sg:1,cfh_ol_st:1,cfh_pc_sg:1,cfh_pc_st:1,cfh_s_sg:1,cfh_s_st:1,cfh_st_sg:1,cfh_st_st:1,cfh_ul_sg:1,cfh_ul_st:1,cfh_img_sg:1,cfh_img_st:1,cfh_l_sg:1,cfh_l_st:1,cfh_t_sg:1,cfh_t_st:1,cfh_e_sg:1,cfh_e_st:1,cfh_p_sg:1,cfh_p_st:1,cfh_sr_sg:1,cfh_sr_st:1,cfh_cf_sg:1,cfh_cf_st:1,ct_sg:1,ct_st:1,ct_a_sg:1,ct_a_st:1,ct_o_sg:1,ct_o_st:1,ct_f_sg:1,ct_f_st:1,mr_sg:1,mr_st:1,rbot_sg:1,rbot_st:1,rfi_sg:1,rfi_st:1,rfi_s_sg:1,rfi_s_st:1,rml_sg:1,rml_st:1},permissions:[],sync:[]},{doShow:()=>!0,title:"Starter kit for group/whitelist/blacklist management",description:Se.element("ul",null,Se.element("li",null,"See what games members of a group or your whitelist/blacklist have in their libraries/wishlists"),Se.element("li",null,"See more information about your groups in the groups page"),Se.element("li",null,"See when users in your whitelist/blacklist were online and more information about them"),Se.element("li",null,"Quickly export/clear your whitelist/blacklist")),settings:{glwc_sg:1,gs_sg:1,gs_sent_sg:1,gs_received_sg:1,gs_giftDifference_sg:1,gs_valueDifference_sg:1,gs_firstGiveaway_sg:1,gs_lastGiveaway_sg:1,gs_averageEntries_sg:1,gs_users_sg:1,us_sg:1,wbm_sg:1},permissions:["steamApi","steamCommunity","steamStore"],sync:[]},{doShow:()=>!0,title:"Starter kit for user management",description:Se.element("ul",null,Se.element("li",null,"Quickly see information about a user without having to leave the page"),Se.element("li",null,"Check if a user has any not activated / multiple wins"),Se.element("li",null,"See a user's sent/won ratio"),Se.element("li",null,"Check which groups you share with another user"),Se.element("li",null,"See a user's username history, if that information is available"),Se.element("li",null,"Add notes/tags to users"),Se.element("li",null,"Check a list of users to see who has whitelisted/blacklisted you, if that information is available"),Se.element("li",null,"Quickly see if a user is on your whitelist/blacklist")),settings:{cl_sg:1,cl_ui_sg:1,namwc_sg:1,namwc_h_sg:1,namwc_h_st:1,namwc_h_m_sg:1,namwc_h_m_st:1,namwc_h_i_sg:1,namwc_h_i_st:1,swr_sg:1,sgc_sg:1,uh_sg:1,un_sg:1,un_st:1,ut_sg:1,ut_st:1,wbc_sg:1,wbc_h_sg:1,wbc_h_st:1,wbh_sg:1,wbh_st:1},permissions:["server","sgTools","steamCommunity"],sync:["Groups"]},{doShow:()=>!0,title:"Run ESGST on SteamTrades",description:null,settings:{esgst_sg:1},permissions:[],sync:[]},{doShow:()=>!0,title:"Saving settings...",description:null,settings:{},permissions:[],sync:[],runOp:()=>c.common.lockAndSaveSettings(this.settingsToSave)},{doShow:()=>n.runtime.getURL&&this.permissionsToGrant.size>0,isConfirmStep:!0,title:"Required permissions",description:()=>Se.element("fragment",null,"Some of the features you enabled require permissions in order to work. Go"," ",Se.element("a",{className:"esgst-bold table__column__secondary-link",href:`${n.runtime.getURL("permissions.html")}?keys=${Array.from(this.permissionsToGrant).join(",")}`,target:"_blank"},"here")," ",'and click the "Grant" button to grant them. Then click "Next" to proceed.'),settings:{},permissions:[],sync:[]},{doShow:()=>this.dataToSync.size>0,isConfirmStep:!0,title:"Required sync",description:()=>Se.element("fragment",null,"Some of the features you enabled require you to sync your data in order to work. Go"," ",Se.element("a",{className:"esgst-bold table__column__secondary-link",href:"https://www.steamgifts.com/account/settings/profile?esgst=sync&autoSync=true&"+Array.from(this.dataToSync).map(e=>e+"=1").join("&"),target:"_blank"},"here")," ",'and wait until the sync is complete. You might also want to enable the automatic sync in that page, since you\'ll need to perform this sync every once in a while to keep your data up-to-date. Then click "Next" to proceed.'),settings:{},permissions:[],sync:[]}]),o()(this,"settingsToSave",{}),o()(this,"permissionsToGrant",new Set),o()(this,"dataToSync",new Set),o()(this,"currentStep",-1),o()(this,"stepNode",void 0),o()(this,"run",()=>{this.settingsToSave={},this.permissionsToGrant=new Set,this.dataToSync=new Set,this.currentStep=-1;const e=new lt({isTemp:!0});pt.create("sm",{breadcrumbs:["Settings Wizard"]}).insert(e.description,"beforeend"),this.stepNode=e.getScrollable(),this.stepNode.classList.add("markdown"),e.onClose=()=>window.location.reload(),e.open(),this.nextStep()}),o()(this,"nextStep",async()=>{if(!this.stepNode)return;let e;do{this.currentStep+=1,e=this.steps[this.currentStep]}while(e&&!e.doShow());if(e){Se.insert(this.stepNode,"atinner",Se.element("fragment",null,Se.element("h3",null,e.title),e.description&&Se.element("p",null,"function"==typeof e.description?e.description():e.description)));const[t]=Se.insert(this.stepNode,"beforeend",Se.element("div",{className:"esgst-button-group"}));e.runOp?(await e.runOp(),window.setTimeout(this.nextStep,0)):e.isConfirmStep?tt.create({template:"success",name:"Next",onClick:()=>{window.setTimeout(this.nextStep,0)}}).insert(t,"beforeend"):(tt.create({template:"success",name:"Yes",onClick:()=>{this.settingsToSave={...this.settingsToSave,...e.settings};for(const t of e.permissions)this.permissionsToGrant.add(t);for(const t of e.sync)this.dataToSync.add(t);window.setTimeout(this.nextStep,0)}}).insert(t,"beforeend"),tt.create({template:"error",name:"No",onClick:()=>{window.setTimeout(this.nextStep,0)}}).insert(t,"beforeend"))}else Se.insert(this.stepNode,"atinner",Se.element("fragment",null,Se.element("h3",null,"All done!"),Se.element("p",null,"You can customize your experience even more by going to the"," ",Se.element("a",{href:"https://www.steamgifts.com/account/settings/profile?esgst=settings"},"settings page")," ","(also available as a popup through the ESGST button at the header).",Se.element("br",null),Se.element("br",null),"Remember to backup your data often in the"," ",Se.element("a",{href:"https://www.steamgifts.com/account/settings/profile?esgst=backup"},"backup page")," ","to prevent data loss. You can also restore/delete your data in the"," ",Se.element("a",{href:"https://www.steamgifts.com/account/settings/profile?esgst=restore"},"restore"),"/",Se.element("a",{href:"https://www.steamgifts.com/account/settings/profile?esgst=delete"},"delete")," ","pages. These pages are also available as a popup from the settings popup.",Se.element("br",null),Se.element("br",null),"And that's the basics, enjoy ESGST! And please report any bugs/suggestions in the SteamGifts thread or on GitHub (both are accessible from the ESGST dropdown at the header).",Se.element("br",null),Se.element("br",null),"You can close this popup now. When you do, the page will be refreshed for the settings to take effect.")))})}};const yt=new class{open(e){return n.runtime.sendMessage({action:"open_tab",url:e})}};class vt{constructor(e,t,s,n,a,i,o,r){this.onChange=void 0,this.onEnabled=null,this.onDisabled=null,this.dependencies=[],this.exclusions=[],this.id=t,this.sg=a,this.st=i,this.value=r,this.container=Se.element("div",{className:"esgst-toggle-switch-container "+(s?"inline":"")},Se.element("label",{className:"esgst-toggle-switch"},Se.element("input",{type:"checkbox"}),Se.element("div",{className:"esgst-toggle-switch-slider"})),Se.element("span",null,n),o?Se.element("i",{className:"fa fa-question-circle",title:o}):null),e&&Se.insert(e,"beforeend",this.container),this.switch=this.container.firstElementChild,this.input=this.switch.firstElementChild,this.name=this.switch.nextElementSibling,this.input.checked=this.value,this.input.addEventListener("change",()=>this.change())}async change(e){let t;if(this.value=this.input.checked,this.id){let s=this.id;if(this.sg?s+="_sg":this.st&&(s+="_st"),t=d.get(s),void 0!==t&&t.include?t.enabled=this.value?1:0:t=this.value,!e){let e;Se.insert(this.container,"beforeend",Se.element("div",{className:"esgst-description esgst-bold",ref:t=>e=t},Se.element("i",{className:"fa fa-circle-o-notch fa-spin",title:"Saving..."}))),await c.common.setSetting(s,t),e.classList.add("esgst-green"),Se.insert(e,"atinner",Se.element("i",{className:"fa fa-check",title:"Saved!"})),window.setTimeout(()=>e.remove(),2500)}}if(this.value?(this.dependencies.forEach(e=>e instanceof tt?e.show():e.classList.remove("esgst-hidden")),this.exclusions.forEach(e=>e.classList.add("esgst-hidden")),!e&&this.onEnabled&&this.onEnabled()):(this.dependencies.forEach(e=>e instanceof tt?e.hide():e.classList.add("esgst-hidden")),this.exclusions.forEach(e=>e.classList.remove("esgst-hidden")),!e&&this.onDisabled&&this.onDisabled()),e)return t;this.onChange&&this.onChange(this.value)}enable(e){return this.input.checked=!0,this.change(e)}disable(e){return this.input.checked=!1,this.change(e)}toggle(e){return this.input.checked=!this.input.checked,this.change(e)}}const _t=new class{constructor(){o()(this,"create",(e,t,s)=>{const[n]=Se.insert(e,"afterbegin",Se.element("fragment",null,Se.element("i",{className:"fa fa-minus-square esgst-clickable",title:"Collapse section"})," ")),[a]=Se.insert(e,"afterbegin",Se.element("fragment",null,Se.element("i",{className:"fa fa-plus-square esgst-clickable esgst-hidden",title:"Expand section"})," "));return n.addEventListener("click",()=>this.collapse(n,a,t,s)),a.addEventListener("click",()=>this.expand(n,a,t,s)),s&&d.get(s+"_collapsed")&&this.collapse(n,a,t),Se.element("fragment",null,e,t)}),o()(this,"collapse",async(e,t,s,n)=>{e.classList.add("esgst-hidden"),t.classList.remove("esgst-hidden"),s.classList.add("esgst-hidden"),n&&await c.common.setSetting(n+"_collapsed",!0)}),o()(this,"expand",async(e,t,s,n)=>{t.classList.add("esgst-hidden"),e.classList.remove("esgst-hidden"),s.classList.remove("esgst-hidden"),n&&await c.common.setSetting(n+"_collapsed",!1)})}};s(113);function kt(e,t){k(2,arguments);var s=A(e),n=A(t),a=s.getTime()-n.getTime();return a<0?-1:a>0?1:a}function xt(e,t){if(null==e)throw new TypeError("assign requires that input parameter not be null or undefined");for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s]);return e}function At(e){return xt({},e)}function Ct(e,t,s){var n,a,i;k(2,arguments);var o=D(),r=null!==(n=null!==(a=null==s?void 0:s.locale)&&void 0!==a?a:o.locale)&&void 0!==n?n:be;if(!r.formatDistance)throw new RangeError("locale must contain localize.formatDistance property");var l=kt(e,t);if(isNaN(l))throw new RangeError("Invalid time value");var c,d,g=xt(At(s),{addSuffix:Boolean(null==s?void 0:s.addSuffix),comparison:l});l>0?(c=A(t),d=A(e)):(c=A(e),d=A(t));var u,m=String(null!==(i=null==s?void 0:s.roundingMethod)&&void 0!==i?i:"round");if("floor"===m)u=Math.floor;else if("ceil"===m)u=Math.ceil;else{if("round"!==m)throw new RangeError("roundingMethod must be 'floor', 'ceil' or 'round'");u=Math.round}var h,p=d.getTime()-c.getTime(),f=p/6e4,b=te(d)-te(c),w=(p-b)/6e4,y=null==s?void 0:s.unit;if("second"===(h=y?String(y):f<1?"second":f<60?"minute":f<1440?"hour":w<43200?"day":w<525600?"month":"year")){var v=u(p/1e3);return r.formatDistance("xSeconds",v,g)}if("minute"===h){var _=u(f);return r.formatDistance("xMinutes",_,g)}if("hour"===h){var x=u(f/60);return r.formatDistance("xHours",x,g)}if("day"===h){var C=u(w/1440);return r.formatDistance("xDays",C,g)}if("month"===h){var S=u(w/43200);return 12===S&&"month"!==y?r.formatDistance("xYears",1,g):r.formatDistance("xMonths",S,g)}if("year"===h){var E=u(w/525600);return r.formatDistance("xYears",E,g)}throw new RangeError("unit must be 'second', 'minute', 'hour', 'day', 'month' or 'year'")}class St{constructor(e,t,s,n={}){this.onPreEnabled=null,this.onPreDisabled=null,this.onEnabled=null,this.onDisabled=null,this.onChange=null,this.isBlocked=!1,this.value=t,this.isThreeState=s,Se.insert(e||Se.fragment(),"afterbegin",Se.element("span",{className:"esgst-checkbox",ref:e=>this.checkbox=e},Se.element("input",{className:"esgst-hidden",type:"checkbox"}),Se.element("i",{className:"fa fa-square-o"}),Se.element("i",{className:"fa fa-square",title:n.select||""}),Se.element("i",{className:"fa fa-check-square",title:n.unselect||""}))),this.input=this.checkbox.firstElementChild,this.disabled=this.input.nextElementSibling,this.none=this.disabled.nextElementSibling,this.enabled=this.none.nextElementSibling,this.isThreeState?("disabled"===this.value?(this.none.classList.add("esgst-hidden"),this.enabled.classList.add("esgst-hidden")):"none"===this.value?(this.disabled.classList.add("esgst-hidden"),this.enabled.classList.add("esgst-hidden")):(this.disabled.classList.add("esgst-hidden"),this.none.classList.add("esgst-hidden")),this.checkbox.addEventListener("click",e=>this.change(!1,null,null,e))):(this.input.checked=this.value,this.value?(this.disabled.classList.add("esgst-hidden"),this.none.classList.add("esgst-hidden")):(this.none.classList.add("esgst-hidden"),this.disabled.classList.add("esgst-hidden")),this.checkbox.addEventListener("click",e=>this.change(!0,null,null,e)),this.checkbox.addEventListener("mouseenter",()=>this.showNone()),this.checkbox.addEventListener("mouseleave",()=>this.hideNone()),this.change())}change(e,t,s,n){n&&n.stopPropagation(),this.isThreeState?"disabled"===this.value&&!t||"none"===t?(this.enabled.classList.add("esgst-hidden"),this.disabled.classList.add("esgst-hidden"),this.none.classList.remove("esgst-hidden"),this.value="none"):"none"===this.value&&!t||"enabled"===t?(this.none.classList.add("esgst-hidden"),this.disabled.classList.add("esgst-hidden"),this.enabled.classList.remove("esgst-hidden"),this.value="enabled"):t&&"disabled"!==t||(this.enabled.classList.add("esgst-hidden"),this.none.classList.add("esgst-hidden"),this.disabled.classList.remove("esgst-hidden"),this.value="disabled"):(this.preValue=e?this.input.checked=!this.input.checked:this.input.checked,this.preValue?(this.onPreEnabled&&!this.isBlocked&&this.onPreEnabled(n),this.value=this.preValue,this.disabled.classList.add("esgst-hidden"),this.none.classList.add("esgst-hidden"),this.enabled.classList.remove("esgst-hidden"),this.onEnabled&&!this.isBlocked&&this.onEnabled(n)):(this.onPreDisabled&&!this.isBlocked&&this.onPreDisabled(n),this.value=this.preValue,this.enabled.classList.add("esgst-hidden"),this.none.classList.add("esgst-hidden"),this.disabled.classList.remove("esgst-hidden"),this.onDisabled&&!this.isBlocked&&this.onDisabled(n))),n&&this.onChange&&this.onChange()}showNone(){this.value||(this.disabled.classList.add("esgst-hidden"),this.none.classList.remove("esgst-hidden"))}hideNone(){this.value||(this.disabled.classList.remove("esgst-hidden"),this.none.classList.add("esgst-hidden"))}check(e){this.preValue=this.input.checked=!0,this.change(!1,null,e),this.onChange&&this.onChange()}uncheck(e){this.preValue=this.input.checked=!1,this.change(!1,null,e),this.onChange&&this.onChange()}toggle(e){this.change(!0,null,e),this.onChange&&this.onChange()}}let Et={};const Tt={syncGroups:{dependencies:[],key:"Groups",name:"Groups"},syncWhitelist:{dependencies:[],key:"Whitelist",name:"Whitelist"},syncBlacklist:{dependencies:[],key:"Blacklist",name:"Blacklist"},syncSteamFriends:{dependencies:[],key:"SteamFriends",name:"Steam Friends (requires Steam API key)"},syncHiddenGames:{dependencies:[],key:"HiddenGames",name:"Hidden Games"},syncGames:{dependencies:[],key:"Games",name:"Owned/Wishlisted/Ignored Games"},syncFollowedGames:{dependencies:[],key:"FollowedGames",name:"Followed Games"},syncWonGames:{dependencies:[],key:"WonGames",name:"Won Games"},syncReducedCvGames:{dependencies:[],key:"ReducedCvGames",name:"Reduced CV Games"},syncNoCvGames:{dependencies:[],key:"NoCvGames",name:"No CV Games"},syncHltbTimes:{dependencies:[],key:"HltbTimes",name:"HLTB Times"},syncDelistedGames:{dependencies:[],key:"DelistedGames",name:"Delisted Games"},syncGiveaways:{dependencies:[],key:"Giveaways",name:"Giveaways"},syncWonGiveaways:{dependencies:[],key:"WonGiveaways",name:"Won Giveaways"}};async function Nt(e){const t=c.header.addButtonContainer({buttonIcon:"fa fa-refresh fa-spin",buttonName:"ESGST Sync",isActive:!0,isNotification:!0,side:"right"});t.nodes.buttonIcon.title="ESGST is syncing your data... Please do not close this window.",c.esgst.parameters={...c.esgst.parameters,...l.getQueryParams("?autoSync=true&"+e.replace(/&$/,""))};const s=await Lt(!1,!0);t.nodes.outer.addEventListener("click",()=>s.popup.open()),c.esgst.isSyncing=!0,await Gt(s),c.esgst.isSyncing=!1,t.nodes.outer.classList.remove("nav__button-container--active"),t.nodes.outer.classList.add("nav__button-container--inactive"),t.nodes.buttonIcon.className="fa fa-check",t.nodes.buttonIcon.title="ESGST has finished syncing, click here to see the results."}function Pt(e,t,s){if(t.syncKeys)for(const n of t.syncKeys)e.switchesKeys["sync"+n].dependencies.push(s);if(t.features)for(const s in t.features)Pt(e,t.features[s],s)}async function Lt(e=!1,t=!1){let s={canceled:!1};s.isSilent=t||c.esgst.isFirstRun,c.esgst.parameters.autoSync&&(s.parameters=c.esgst.parameters);let n=null,a=null,i=null;e||s.isSilent?(s.popup=i=new lt({addScrollable:"left",settings:!0}),n=i.description,a=i.scrollable,c.esgst.isFirstRun||s.isSilent&&!d.get("openAutoSyncPopup")||i.open()):(n=a=c.esgst.sidebar.nextElementSibling,n.innerHTML="",a.setAttribute("data-esgst-popup","true"));const o=pt.create("sync",[{name:"ESGST",url:c.esgst.settingsUrl},{name:"Sync",url:c.esgst.syncUrl}]).insert(n,"afterbegin").nodes.outer;if(e||s.isSilent||(c.esgst.mainPageHeading=o),s.isSilent)Se.insert(a,"beforeend",Se.element("div",{ref:e=>s.area=e}));else{Se.insert(a,"beforeend",Se.element("div",{className:"esgst-menu-split"},Se.element("div",{className:"esgst-sync-options"}),Se.element("div",{className:"esgst-sync-area"}))),tt.create([{color:"green",icons:[],name:"Save Changes",onClick:async()=>{await c.common.lockAndSaveSettings(Et),Et={},e?i.close():window.location.reload()}},{color:"white",icons:[],name:"Saving..."}]).insert(a,"beforeend"),s.container=a.querySelector(".esgst-sync-options"),s.area=a.querySelector(".esgst-sync-area"),Se.insert(s.area,"beforeend",Se.element("div",{ref:e=>s.notificationArea=e})),s.manual={check:!0,content:[],name:"Manual"},s.automatic={check:!0,content:[],name:"Automatic"},s.switchesKeys=Tt,s.switches={};for(const e in c.esgst.features)for(const t in c.esgst.features[e].features)Pt(s,c.esgst.features[e].features[t],t);for(let e in s.switchesKeys)if(s.switchesKeys.hasOwnProperty(e)){const t=s.switchesKeys[e],n=new St(null,d.get(e));n.onChange=()=>{Et["sync"+t.key]=n.value,d.set("sync"+t.key,n.value)},s.switches[e]=n,s.manual.content.push(Se.element("div",null,Se.element("i",{className:"fa fa-question-circle",title:"This is required for the following features:\n\n"+t.dependencies.map(e=>c.common.getFeatureName(null,e)).join("\n")})," ",n.checkbox," ",Se.element("span",null,t.name))),"HiddenGames"!==t.key&&"Whitelist"!==t.key&&"Blacklist"!==t.key&&Bt(t.key,t.name,s),It(s,t)}s.button=tt.create([{color:"green",icons:["fa-refresh"],name:"Sync",onClick:Gt.bind(null,s)},{template:"error",name:"Cancel",switchTo:{onReturn:0},onClick:Dt.bind(null,s)}]).build(),s.manual.content.push(Se.element("div",{className:"esgst-button-group"},Se.element("span",null,"Select:"),tt.create([{color:"white",icons:["fa-square"],name:"All",onClick:c.common.selectSwitches.bind(c.common,s.switches,"check",null)},{template:"loading",isDisabled:!0,name:""}]).build().nodes.outer,tt.create([{color:"white",icons:["fa-square-o"],name:"None",onClick:c.common.selectSwitches.bind(c.common,s.switches,"uncheck",null)},{template:"loading",isDisabled:!0,name:""}]).build().nodes.outer,tt.create([{color:"white",icons:["fa-plus-square-o"],name:"Inverse",onClick:c.common.selectSwitches.bind(c.common,s.switches,"toggle",null)},{template:"loading",isDisabled:!0,name:""}]).build().nodes.outer),s.button.nodes.outer),s.automatic.content.push(Se.element("div",{className:"esgst-description"},"Select how often you want the automatic sync to run (in days) or 0 to disable it.")),c.common.createFormRows(s.container,"beforeend",{items:[s.manual,s.automatic]}),d.get("at")&&c.esgst.modules.generalAccurateTimestamp.at_getTimestamps(s.notificationArea)}return s.progressBar=at.create().insert(s.area,"beforeend").hide(),s.results=c.common.createElements(s.area,"beforeend",[{type:"div"}]),!s.isSilent&&!c.esgst.isSyncing&&s.parameters&&s.button&&s.button.onClick(),s}function It(e,t){const s=at.create().build();let n=d.get("lastSync"+t.key);n?s.setSuccess(Se.element("fragment",null,"Synced ",Se.element("span",null,t.name)," ",Se.element("span",{"data-timestamp":n/1e3},Ct(n,new Date))," ago.")):s.setWarning(Se.element("fragment",null,"Never synced ",Se.element("span",null,t.name))),s.insert(e.notificationArea,"beforeend")}function Bt(e,t,s){let n=[];for(let t=0;t<31;++t)n.push(Se.element("option",{selected:t===d.get("autoSync"+e)||null},t));s.automatic.content.push(Se.element("div",null,Se.element("select",{className:"esgst-auto-sync",onchange:t=>{d.set("autoSync"+e,parseInt(t.currentTarget.value)),Et["autoSync"+e]=parseInt(t.currentTarget.value)}},n),Se.element("span",null,t)))}function Dt(e){e.process&&e.process.stop(),e.progressBar.reset().hide(),e.canceled=!0}async function Gt(e){const t=Date.now();if((e.parameters&&e.parameters.HiddenGames||!e.parameters&&d.get("syncHiddenGames"))&&t-d.get("lastSyncHiddenGames")>0&&0===d.get("lastPageHiddenGames")){if(!await c.common.createConfirmationAsync(Se.element("fragment",null,Se.element("div",{className:"notification yellow notification--warning esgst-sync-warning"},"WARNING: Syncing your hidden games may take a long time depending on the amount of games."),Se.element("br",null),Se.element("div",{className:"esgst-text-left"},"The requests will be limited to 1 per second to avoid SteamGifts timing you out for 'Too Many Requests' in a short period of time.",Se.element("br",null),"This is a cumulative sync, so it will pick up where it left off if cancelled.",Se.element("hr",null)),d.get("lastSyncHiddenGames")>0?Se.element("fragment",null,Se.element("div",{className:"esgst-text-left"},"You should only need to perform a manual sync in rare cases, as ESGST automatically detects and updates your hidden game changes.",Se.element("br",null),"By syncing as little as possible, you help keep SteamGifts running smoothly for everyone. ❤️")):"",Se.element("br",null),"If you're sure you want to continue, click 'Yes', otherwise click 'No' and disable hidden games sync.")))return}if((e.parameters&&(e.parameters.Whitelist||e.parameters.Blacklist)||!e.parameters&&(d.get("syncWhitelist")||d.get("syncBlacklist")))&&(t-d.get("lastSyncWhitelist")>0||t-d.get("lastSyncBlacklist")>0)&&(0===d.get("lastPagewhitelisted")||0===d.get("lastPageblacklisted"))){if(!await c.common.createConfirmationAsync(Se.element("fragment",null,Se.element("div",{className:"notification yellow notification--warning esgst-sync-warning"},"WARNING: Syncing your whitelist or blacklist may take a long time depending on the amount of users."),Se.element("br",null),Se.element("div",{className:"esgst-text-left"},"The requests will be limited to 1 per second to avoid SteamGifts timing you out for 'Too Many Requests' in a short period of time.",Se.element("br",null),"This is a cumulative sync, so it will pick up where it left off if cancelled.",Se.element("hr",null)),d.get("lastSyncHiddenGames")>0?Se.element("fragment",null,Se.element("div",{className:"esgst-text-left"},"You should only need to perform a manual sync in rare cases, as ESGST automatically detects and updates your hidden game changes.",Se.element("br",null),"By syncing as little as possible, you help keep SteamGifts running smoothly for everyone. ❤️")):"",Se.element("br",null),"If you're sure you want to continue, click 'Yes', otherwise click 'No' and disable whitelist or blacklist sync.")))return}if(e.canceled=!1,c.esgst.isFirstRun||(await c.common.setSetting("lastSync",t),e.results.innerHTML="",e.progressBar.setLoading(null).show()),!c.esgst.isFirstRun&&!e.canceled){if(e.failed={},c.esgst.sg&&(e.parameters&&e.parameters.Groups||!e.parameters&&d.get("syncGroups"))){e.progressBar.setMessage("Syncing your Steam groups..."),e.groups={};let t=JSON.parse(c.common.getValue("groups"));if(!Array.isArray(t)){let e,s;e=[];for(let s in t)t.hasOwnProperty(s)&&e.push(t[s]);t=e,await c.common.setValue("groups",JSON.stringify(t)),s=JSON.parse(c.common.getValue("giveaways"));for(let e in s)s.hasOwnProperty(e)&&delete s[e].groups;await c.common.setValue("giveaways",JSON.stringify(s))}e.currentGroups={};for(let s=0,n=t.length;s<n;++s)t[s]&&t[s].member&&t[s].steamId&&(e.currentGroups[t[s].steamId]=t[s].name);e.newGroups={},e.savedGroups=t;let s,n,a=1,i=null;do{let t,s;s=(await Ne.get("https://www.steamgifts.com/account/steam/groups/search?page="+a)).html,t=s.getElementsByClassName("table__row-outer-wrap");for(let s=0,n=t.length;!e.canceled&&s<n;s++){let n,a,i,o;a=t[s],i=a.getElementsByClassName("table__column__heading")[0],n=i.getAttribute("href").match(/\/group\/(.+?)\/(.+)/)[1];const r=a.querySelector('a[href*="/group/"]');let l;for(o=i.textContent.trim()||r&&r.getAttribute("href").split("/").pop(),l=e.savedGroups.length-1;l>=0&&e.savedGroups[l].code!==n;--l);if(l>=0&&e.savedGroups[l].steamId){e.savedGroups[l].steamId;e.groups[n]={member:!0},e.savedGroups[l].name&&e.savedGroups[l].name.trim()||(e.savedGroups[l].name=o),e.newGroups[e.savedGroups[l].steamId]=e.savedGroups[l].name}else{let t,s;t=a.getElementsByClassName("table_image_avatar")[0].style.backgroundImage.match(/url\("(.+)"\)/)[1],s=(await Ne.get(`/group/${n}/`)).html.getElementsByClassName("sidebar__shortcut-inner-wrap")[0].firstElementChild.getAttribute("href").match(/\d+/)[0],e.groups[n]={avatar:t,code:n,member:!0,name:o,steamId:s},e.newGroups[s]=o}}i=s.getElementsByClassName("pagination__navigation")[0],a+=1}while(!e.canceled&&i&&!i.lastElementChild.classList.contains("is-selected"));await c.common.lockAndSaveGroups(e.groups,!0),s=[],n=[];for(let t in e.currentGroups)e.currentGroups.hasOwnProperty(t)&&(e.newGroups[t]||s.push(Se.element("a",{href:"http://steamcommunity.com/gid/"+t},e.currentGroups[t]),", "));for(let t in e.newGroups)e.newGroups.hasOwnProperty(t)&&(e.currentGroups[t]||n.push(Se.element("a",{href:"http://steamcommunity.com/gid/"+t},e.newGroups[t]),", "));s.pop(),n.pop(),e.jsx=[],s.length&&e.jsx.push(Se.element("div",null,Se.element("span",{className:"esgst-bold"},"Missing groups:")," ",s)),n.length&&e.jsx.push(Se.element("div",null,Se.element("span",{className:"esgst-bold"},"New groups:")," ",n)),Se.insert(e.results,"beforeend",Se.element("fragment",null,Se.element("div",null,"Groups synced."),e.jsx))}if(!e.canceled){if((e.parameters&&e.parameters.Whitelist||!e.parameters&&d.get("syncWhitelist"))&&(t-d.get("lastSyncWhitelist")>0||d.get("lastPagewhitelisted")>0)||(e.parameters&&e.parameters.Blacklist||!e.parameters&&d.get("syncBlacklist"))&&(t-d.get("lastSyncBlacklist")>0||d.get("lastPageblacklisted")>0)){if((e.parameters&&e.parameters.Whitelist||!e.parameters&&d.get("syncWhitelist"))&&(0===d.get("lastPagewhitelisted")&&await c.common.deleteUserValues(["whitelisted","whitelistedDate"]),e.progressBar.setMessage("Syncing your whitelist..."),await qt("whitelisted",e,"https://www.steamgifts.com/account/manage/whitelist/search?page="),e.canceled||await c.common.setSetting("lastPagewhitelisted",0)),e.canceled)return;(e.parameters&&e.parameters.Blacklist||!e.parameters&&d.get("syncBlacklist"))&&(0===d.get("lastPageblacklisted")&&await c.common.deleteUserValues(["blacklisted","blacklistedDate"]),e.progressBar.setMessage("Syncing your blacklist..."),await qt("blacklisted",e,"https://www.steamgifts.com/account/manage/blacklist/search?page="),e.canceled||await c.common.setSetting("lastPageblacklisted",0)),e.canceled||Se.insert(e.results,"beforeend",Se.element("div",null,"Whitelist/blacklist synced."))}if(!e.canceled){if(e.parameters&&e.parameters.SteamFriends||!e.parameters&&d.get("syncSteamFriends")){if(await ut.contains([["steamApi"]]))try{const t=[];e.progressBar.setMessage("Syncing your Steam friends..."),await c.common.deleteUserValues(["steamFriend"]);const s=await Ne.get(`http://api.steampowered.com/ISteamUser/GetFriendList/v0001/?key=${d.get("steamApiKey")}&steamid=${d.get("steamId")}&relationship=friend`);for(const e of s.json.friendslist.friends)t.push({steamId:e.steamid,values:{steamFriend:e.friend_since}});e.progressBar.setMessage("Saving your Steam friends (this may take a while)..."),await c.common.saveUsers(t),Se.insert(e.results,"beforeend",Se.element("div",null,"Steam friends synced."))}catch(t){e.failed.SteamFriends=!0,Se.insert(e.results,"beforeend",Se.element("div",null,"Failed to sync your Steam friends. Check if you have a valid Steam API key set or if your profile is public."))}else e.failed.SteamFriends=!0,Se.insert(e.results,"beforeend",Se.element("div",null,ut.getMessage([["steamApi"]])))}if(!e.canceled){if((e.parameters&&e.parameters.HiddenGames||!e.parameters&&d.get("syncHiddenGames"))&&(t-d.get("lastSyncHiddenGames")>0||d.get("lastPageHiddenGames")>0)){if(e.progressBar.setMessage("Syncing your hidden games..."),0===d.get("lastPageHiddenGames")){const e=new Te("game",{threshold:300});await e.lock();let t=JSON.parse(c.common.getValue("games"));for(let e in t.apps)t.apps.hasOwnProperty(e)&&delete t.apps[e].hidden;for(let e in t.subs)t.subs.hasOwnProperty(e)&&delete t.subs[e].hidden;await c.common.setValue("games",JSON.stringify(t)),await e.unlock()}let t=d.get("lastPageHiddenGames")>0?d.get("lastPageHiddenGames"):1,s=null;do{const n={apps:[],subs:[]};let a,i;e.progressBar.setMessage(`Syncing your hidden games (page ${t})...`),i=(await Ne.get("https://www.steamgifts.com/account/settings/giveaways/filters/search?page="+t,{queue:!0})).html,a=i.querySelectorAll('.table__column__secondary-link[href*="store.steampowered.com"]');for(let e=0,t=a.length;e<t;++e){let t=a[e].getAttribute("href").match(/(app|sub)\/(\d+)/);t&&n[t[1]+"s"].push(t[2])}s=i.getElementsByClassName("pagination__navigation")[0],t+=1;const o=new Te("game",{threshold:300});await o.lock();let r=JSON.parse(c.common.getValue("games"));for(let e=0,t=n.apps.length;e<t;++e)r.apps[n.apps[e]]||(r.apps[n.apps[e]]={}),r.apps[n.apps[e]].hidden=!0;for(let e=0,t=n.subs.length;e<t;++e)r.subs[n.subs[e]]||(r.subs[n.subs[e]]={}),r.subs[n.subs[e]].hidden=!0;await c.common.setValue("games",JSON.stringify(r)),await o.unlock(),await c.common.setSetting("lastPageHiddenGames",t)}while(!e.canceled&&s&&!s.lastElementChild.classList.contains("is-selected"));e.canceled||(await c.common.setSetting("lastPageHiddenGames",0),Se.insert(e.results,"beforeend",Se.element("div",null,"Hidden games synced.")))}if(!e.canceled){if(d.get("hgm_s")&&(e.hgm={toAdd:{apps:new Set,subs:new Set},toRemove:{apps:new Set,subs:new Set}}),e.parameters&&e.parameters.Games||!e.parameters&&d.get("syncGames")){if(await ut.contains([["steamApi"],["steamStore"]])){e.progressBar.setMessage("Syncing your wishlisted/owned/ignored games...");try{e.jsx=[];let t=null;d.get("steamApiKey")&&(t=await Ne.get(`http://api.steampowered.com/IPlayerService/GetOwnedGames/v0001/?key=${d.get("steamApiKey")}&steamid=${d.get("steamId")}&format=json`));let s=await Ne.get("http://store.steampowered.com/dynamicstore/userdata?"+Math.random().toString().split(".")[1]);if(await Rt(null,e,t,s),d.get("gc_o_a")){const s=d.get("gc_o_altAccounts");if((null==s?void 0:s.length)>0)if(d.get("steamApiKey")){for(const n of s){if(e.canceled)break;t=await Ne.get(`http://api.steampowered.com/IPlayerService/GetOwnedGames/v0001/?key=${d.get("steamApiKey")}&steamid=${n.steamId}&format=json`),await Rt(n,e,t)}await c.common.setSetting("gc_o_altAccounts",s)}else e.jsx.push(Se.element("div",null,"Failed to sync your owned games from alt accounts. Check if you have a valid Steam API key set in the settings menu."))}Se.insert(e.results,"beforeend",Se.element("fragment",null,Se.element("div",null,"Owned/wishlisted/ignored games synced."),e.jsx)),d.get("getSyncGameNames")&&c.common.getGameNames(e.results)}catch(t){e.failed.Games=!0,Se.insert(e.results,"beforeend",Se.element("div",null,"Failed to sync your owned / wishlisted / ignored games. Try again later."))}}else e.failed.Games=!0,Se.insert(e.results,"beforeend",Se.element("div",null,ut.getMessage([["steamApi"],["steamStore"]])))}if(!e.canceled){if(e.parameters&&e.parameters.FollowedGames||!e.parameters&&d.get("syncFollowedGames")){if(await ut.contains([["steamCommunity"]])){e.progressBar.setMessage("Syncing your followed games...");const t=(await Ne.get("https://steamcommunity.com/my/followedgames/")).html.querySelectorAll(".gameListRow.followed"),s=JSON.parse(c.common.getValue("games"));for(const e in s.apps)s.apps.hasOwnProperty(e)&&(s.apps[e].followed=null);for(const e of t){const t=parseInt(e.getAttribute("data-appid"));s.apps[t]||(s.apps[t]={}),s.apps[t].followed=!0}await c.common.lockAndSaveGames(s),Se.insert(e.results,"beforeend",Se.element("div",null,"Followed games synced."))}else e.failed.FollowedGames=!0,Se.insert(e.results,"beforeend",Se.element("div",null,ut.getMessage([["steamCommunity"]])))}if(!e.canceled&&((e.parameters&&e.parameters.WonGames||!e.parameters&&d.get("syncWonGames"))&&(e.progressBar.setMessage("Syncing your won games..."),await c.common.getWonGames(e),Se.insert(e.results,"beforeend",Se.element("div",null,"Won games synced."))),!e.canceled)){if(e.parameters&&e.parameters.ReducedCvGames||!e.parameters&&d.get("syncReducedCvGames")){if(await ut.contains([["server"]])){e.progressBar.setMessage("Syncing reduced CV games...");try{await async function(){const e=(await Ne.get("https://esgst.rafaelgomes.xyz/api/games/rcv")).json.result.found;for(const t in e.apps)e.apps.hasOwnProperty(t)&&(e.apps[t].reducedCV=c.common.dateFromServer(e.apps[t].effective_date),delete e.apps[t].effective_date);for(const t in e.subs)e.subs.hasOwnProperty(t)&&(e.subs[t].reducedCV=c.common.dateFromServer(e.subs[t].effective_date),delete e.subs[t].effective_date);for(const t in c.esgst.games.apps)c.esgst.games.apps.hasOwnProperty(t)&&!e.apps[t]&&(e.apps[t]={reducedCV:null});for(const t in c.esgst.games.subs)c.esgst.games.subs.hasOwnProperty(t)&&!e.subs[t]&&(e.subs[t]={reducedCV:null});await c.common.lockAndSaveGames(e)}(),Se.insert(e.results,"beforeend",Se.element("div",null,Se.element("i",{className:"fa fa-check"})," Reduced CV games synced."))}catch(t){dt.warning(t.message),e.failed.ReducedCvGames=!0,Se.insert(e.results,"beforeend",Se.element("div",null,Se.element("i",{className:"fa fa-times"})," Failed to sync reduced CV games."))}}else e.failed.ReducedCvGames=!0,Se.insert(e.results,"beforeend",Se.element("div",null,Se.element("i",{className:"fa fa-times"})," ",ut.getMessage([["server"]])))}if(!e.canceled){if(e.parameters&&e.parameters.NoCvGames||!e.parameters&&d.get("syncNoCvGames")){if(await ut.contains([["server"]])){e.progressBar.setMessage("Syncing no CV games...");try{await async function(){const e=(await Ne.get("https://esgst.rafaelgomes.xyz/api/games/ncv")).json.result.found;for(const t in e.apps)e.apps.hasOwnProperty(t)&&(e.apps[t].noCV=c.common.dateFromServer(e.apps[t].effective_date),delete e.apps[t].effective_date);for(const t in e.subs)e.subs.hasOwnProperty(t)&&(e.subs[t].noCV=c.common.dateFromServer(e.subs[t].effective_date),delete e.subs[t].effective_date);for(const t in c.esgst.games.apps)c.esgst.games.apps.hasOwnProperty(t)&&!e.apps[t]&&(e.apps[t]={noCV:null});for(const t in c.esgst.games.subs)c.esgst.games.subs.hasOwnProperty(t)&&!e.subs[t]&&(e.subs[t]={noCV:null});await c.common.lockAndSaveGames(e)}(),Se.insert(e.results,"beforeend",Se.element("div",null,Se.element("i",{className:"fa fa-check"})," No CV games synced."))}catch(t){dt.warning(t.message),e.failed.NoCvGames=!0,Se.insert(e.results,"beforeend",Se.element("div",null,Se.element("i",{className:"fa fa-times"})," Failed to sync no CV games."))}}else e.failed.NoCvGames=!0,Se.insert(e.results,"beforeend",Se.element("div",null,Se.element("i",{className:"fa fa-times"})," ",ut.getMessage([["server"]])))}if(e.parameters&&e.parameters.HltbTimes||!e.parameters&&d.get("syncHltbTimes")){if(await ut.contains([["googleWebApp"]])){e.progressBar.setMessage("Syncing HLTB times...");try{const e=(await Ne.get("https://script.google.com/macros/s/AKfycbysBF72c0VNylStaslLlOL7X4M0KQIgY0VVv6Q0x2vh72iGAtE/exec")).json,t={};for(const s of e)s.steamId&&(t[s.steamId]=s);let s=JSON.parse(r.get("gcCache",'{ "apps": {}, "subs": {}, "hltb": {}, "timestamp": 0, "version": 7 }'));7!==s.version&&(s={apps:{},subs:{},hltb:s.hltb,timestamp:0,version:7}),s.hltb=t,r.set("gcCache",JSON.stringify(s))}catch(e){dt.warning(e.message,e.stack)}Se.insert(e.results,"beforeend",Se.element("div",null,"HLTB times synced."))}else e.failed.HltbTimes=!0,Se.insert(e.results,"beforeend",Se.element("div",null,ut.getMessage([["googleWebApp"]])))}if(!e.canceled){if(e.parameters&&e.parameters.DelistedGames||!e.parameters&&d.get("syncDelistedGames")){if(await ut.contains([["steamTracker"]])){e.progressBar.setMessage("Syncing delisted games...");const t=await Ne.get("https://steam-tracker.com/api?action=GetAppListV3");try{if(t.json.success){const s=t.json.removed_apps.filter(e=>"game"===e.type&&"Banned"===e.category).map(e=>parseInt(e.appid)),n=t.json.removed_apps.filter(e=>"game"===e.type&&"Delisted"===e.category).map(e=>parseInt(e.appid));if(await c.common.setValue("delistedGames",JSON.stringify({banned:s,removed:n})),d.get("hgm_s"))if(d.get("hgm_addBanned"))for(const t of s)e.hgm.toAdd.apps.add(t);else if(d.get("hgm_removeBanned"))for(const t of s)e.hgm.toRemove.apps.add(t)}Se.insert(e.results,"beforeend",Se.element("div",null,"Delisted games synced."))}catch(t){Se.insert(e.results,"beforeend",Se.element("div",null,"Failed to sync delisted games (check the console log for more info).")),dt.warning(t.message,t.stack)}}else e.failed.DelistedGames=!0,Se.insert(e.results,"beforeend",Se.element("div",null,ut.getMessage([["steamTracker"]])))}if(!e.canceled){if(d.get("hgm_s")){const t=await c.common.hideGames({appIds:e.hgm.toAdd.apps,subIds:e.hgm.toAdd.subs,update:t=>e.progressBar.setMessage(t)}),s=await c.common.hideGames({appIds:e.hgm.toRemove.apps,subIds:e.hgm.toRemove.subs,update:t=>e.progressBar.setMessage(t)},!0);t.apps=t.apps.concat(s.apps),t.subs=t.subs.concat(s.subs);let n="";t.apps.length&&(n+=`The following apps were not found and therefore not hidden / unhidden (they are most likely internal apps, such as demos, game editors etc): ${t.apps.join(", ")}\n`),t.subs.length&&(n+=`The following subs were not found and therefore not hidden / unhidden: ${t.subs.join(", ")}\n`),n&&window.alert(n)}if(!e.canceled){if((e.parameters&&e.parameters.Giveaways||!e.parameters&&d.get("syncGiveaways"))&&c.esgst.sg){e.progressBar.setMessage("Syncing your giveaways...");const t="sent",s={steamId:d.get("steamId"),username:d.get("username")};e.process=await c.esgst.modules.usersUserGiveawayData.ugd_add(null,t,s,e),await e.process.start(),Se.insert(e.results,"beforeend",Se.element("div",null,"Giveaways synced."))}if((e.parameters&&e.parameters.WonGiveaways||!e.parameters&&d.get("syncWonGiveaways"))&&c.esgst.sg){e.progressBar.setMessage("Syncing your won giveaways...");const t="won",s={steamId:d.get("steamId"),username:d.get("username")};e.process=await c.esgst.modules.usersUserGiveawayData.ugd_add(null,t,s,e),await e.process.start(),Se.insert(e.results,"beforeend",Se.element("div",null,"Won giveaways synced."))}if(!c.esgst.isFirstRun){e.progressBar.setMessage("Updating last sync date...");let s=["Groups","Whitelist","Blacklist","SteamFriends","HiddenGames","Games","FollowedGames","WonGames","ReducedCvGames","NoCvGames","HltbTimes","DelistedGames","Giveaways","WonGiveaways"];for(let n=s.length-1;n>-1;n--){let a=s[n],i="sync"+a;!e.failed[a]&&(e.parameters&&e.parameters[a]||!e.parameters&&d.get(i))&&(d.set("lastSync"+a,t),Et["lastSync"+a]=t)}await c.common.lockAndSaveSettings(Et),Et={},e.progressBar.setSuccess("Synced!"),r.delete("isSyncing")}e.isSilent||function(e){e.notificationArea.innerHTML="";for(let t in e.switchesKeys)if(e.switchesKeys.hasOwnProperty(t)){It(e,e.switchesKeys[t])}d.get("at")&&c.esgst.modules.generalAccurateTimestamp.at_getTimestamps(e.notificationArea)}(e)}}}}}}}}}}}}async function qt(e,t,s){const n="whitelisted"===e?"Whitelist":"Blacklist";let a=d.get("lastPage"+e)>0?d.get("lastPage"+e):1,i=null;do{const o=[];let r,l;t.progressBar.setMessage(`Syncing your ${n.toLowerCase()} (page ${a})...`),l=(await Ne.get(`${s}${a}`,{queue:!0})).html,r=l.getElementsByClassName("table__row-outer-wrap");for(let t=0,s=r.length;t<s;++t){let s,n;s=r[t],n={id:s.querySelector('[name="child_user_id"]').value,username:s.getElementsByClassName("table__column__heading")[0].textContent,values:{}},n.values[e]=!0,n.values[e+"Date"]=1e3*parseInt(s.querySelector("[data-timestamp]").getAttribute("data-timestamp")),o.push(n)}i=l.getElementsByClassName("pagination__navigation")[0],a+=1,await c.common.saveUsers(o),await c.common.setSetting("lastPage"+e,a)}while(!t.canceled&&i&&!i.lastElementChild.classList.contains("is-selected"))}async function Rt(e,t,s,n){const a=s&&s.json,i=n&&n.json,o=a&&a.response&&a.response.games&&a.response.games.length,r=i&&i.rgOwnedApps&&i.rgOwnedApps.length;if((e&&!d.get("steamApiKey")||!e&&d.get("steamApiKey"))&&!o&&t.jsx.push(Se.element("div",null,e?Se.element("span",{className:"esgst-bold"},e.name+": "):null,"Unable to sync through the Steam API. Check if you have a valid Steam API key set in the settings menu.",e?"Also check the privacy settings of your alt account.":null)),e||r||t.jsx.push("Unable to sync through the Steam store. Check if you are logged in to Steam on your current browser session. If you are, try again later. Some games may not be available through the Steam API (if you have a Steam API key set)."),!(o&&d.get("fallbackSteamApi")||r))return;const l=e&&e.games||JSON.parse(c.common.getValue("games")),g={apps:[],subs:[]},u={apps:[],subs:[]},m={apps:[],subs:[]};for(const e in l.apps)l.apps.hasOwnProperty(e)&&(l.apps[e].owned&&(m.apps.push(e),l.apps[e].owned=null),r&&(l.apps[e].wishlisted&&(g.apps.push(e),l.apps[e].wishlisted=null),l.apps[e].ignored&&(u.apps.push(e),l.apps[e].ignored=null)));if(r)for(const e in l.subs)l.subs.hasOwnProperty(e)&&(l.subs[e].owned&&(m.subs.push(e),l.subs[e].owned=null),l.subs[e].wishlisted&&(g.subs.push(e),l.subs[e].wishlisted=null),l.subs[e].ignored&&(u.subs.push(e),l.subs[e].ignored=null));const h={apps:[],subs:[]},p={apps:[],subs:[]},f={apps:[],subs:[]};let b=0;if(o&&a.response.games.forEach(e=>{const t=e.appid;l.apps[t]||(l.apps[t]={}),l.apps[t].owned=!0,f.apps.push(t.toString()),b+=1}),!e){r&&[{jsonKey:"rgWishlist",key:"wishlisted",type:"apps"},{jsonKey:"rgOwnedApps",key:"owned",type:"apps"},{jsonKey:"rgOwnedPackages",key:"owned",type:"subs"},{jsonKey:"rgIgnoredApps",key:"ignored",type:"apps"},{jsonKey:"rgIgnoredPackages",key:"ignored",type:"subs"}].forEach(e=>{const t=e.jsonKey,s=e.key,n=e.type;let a=[];a=Array.isArray(i[t])?i[t]:Object.keys(i[t]);for(const e of a){l[n][e]||(l[n][e]={});const t=l[n][e][s];l[n][e][s]=!0,"owned"!==s||t?"wishlisted"===s?h[n].push(e.toString()):"ignored"===s&&p[n].push(e.toString()):(f[n].push(e.toString()),b+=1)}}),b!==c.common.getValue("ownedGames",0)&&await c.common.setValue("ownedGames",b);try{const e=(await Ne.get(`https://api.steampowered.com/IWishlistService/GetWishlist/v1/?key=${d.get("steamApiKey")}&steamid=${d.get("steamId")}&format=json`)).json.response.items;e&&e.forEach(e=>{const t=e.appid;l.apps[t]||(l.apps[t]={}),l.apps[t].wishlisted=e.date_added})}catch(e){console.error("Error fetching wishlist data:",e)}}const w={},y={},v={},_={},k={},x={};for(const s of["apps","subs"]){if(w[s]=m[s].filter(e=>f[s].indexOf(e)<0),y[s]=f[s].filter(e=>m[s].indexOf(e)<0),v[s]=g[s].filter(e=>h[s].indexOf(e)<0),_[s]=h[s].filter(e=>g[s].indexOf(e)<0),k[s]=u[s].filter(e=>p[s].indexOf(e)<0),x[s]=p[s].filter(e=>u[s].indexOf(e)<0),d.get("hgm_s")){if(d.get("hgm_addOwned")){for(const e of y[s])t.hgm.toAdd[s].add(e);for(const e of w[s])t.hgm.toRemove[s].add(e)}else if(d.get("hgm_removeOwned"))for(const e of y[s])t.hgm.toRemove[s].add(e);if(d.get("hgm_removeWishlisted"))for(const e of _[s])t.hgm.toRemove[s].add(e);if(d.get("hgm_addIgnored")){for(const e of x[s])t.hgm.toAdd[s].add(e);for(const e of k[s])t.hgm.toRemove[s].add(e)}}if(console.log(v),!e)for(const e of v[s])l[s][e].previouslyWishlisted=!0}e||await c.common.lockAndSaveGames(l),e&&(w.apps.length>0||w.subs.length>0||y.apps.length>0||y.subs.length>0)&&t.jsx.push(Se.element("br",null),Se.element("div",{className:"esgst-bold"},"Alt Account - "+e.name),Se.element("br",null)),w.apps.length>0&&t.jsx.push(Se.element("div",null,Se.element("span",{className:"esgst-bold"},"Removed apps: "),w.apps.map((e,t)=>(e=Se.element("a",{href:"http://store.steampowered.com/app/"+e},e),t<w.apps.length-1?[e,", "]:[e])).flat())),w.subs.length>0&&t.jsx.push(Se.element("div",null,Se.element("span",{className:"esgst-bold"},"Removed packages: "),w.subs.map((e,t)=>(e=Se.element("a",{href:"http://store.steampowered.com/sub/"+e},e),t<w.subs.length-1?[e,", "]:[e])).flat())),y.apps.length>0&&t.jsx.push(Se.element("div",null,Se.element("span",{className:"esgst-bold"},"Added apps: "),y.apps.map((e,t)=>(e=Se.element("a",{href:"http://store.steampowered.com/app/"+e},e),t<y.apps.length-1?[e,", "]:[e])).flat())),y.subs.length>0&&t.jsx.push(Se.element("div",null,Se.element("span",{className:"esgst-bold"},"Added packages: "),y.subs.map((e,t)=>(e=Se.element("a",{href:"http://store.steampowered.com/sub/"+e},e),t<y.subs.length-1?[e,", "]:[e])).flat()))}const Mt=new class{constructor(){this.toSave={},this.requiredPermissions={},this.collapseButtons=[]}preSave(e,t){const s=e.match(/_(sg|st)$/);if(s){const n=e.replace(s[0],""),a=s[1];if(c.esgst.featuresById[n]){let s;"object"==typeof t?s=t:(s=d.getFull(e)||c.common.getFeaturePath(null,n,a),s.enabled=t?1:0);const i=s.include.filter(e=>".*"===e.pattern)[0];return i&&(i.enabled=s.enabled),d.set(n,s.enabled),d.setFull(e,s),void(this.toSave[e]=s)}}this.toSave[e]=t,d.set(e,t)}loadMenu(e){let t,s,a=null,i=null,o=null;e?(o=new lt({addScrollable:"left",settings:!0,isTemp:!0}),o.popup.classList.add("esgst-text-left"),a=o.description,i=o.scrollable):(i=a=c.esgst.sidebar.nextElementSibling,a.innerHTML=""),Se.insert(e?a:c.esgst.sidebar,"afterbegin",Se.element("div",{className:"sidebar__search-container"},Se.element("input",{className:"sidebar__search-input",type:"text",placeholder:"Search...",ref:e=>s=e}))),e&&d.get("scb")&&c.esgst.modules.generalSearchClearButton.getInputs(a);let r,l=null;Se.insert(a,"beforeend",Se.element("div",{className:"esgst-button-group",ref:e=>r=e})),tt.create({color:"green",icons:[],name:"Run Wizard",onClick:()=>wt.run()}).insert(r,"beforeend"),tt.create([{color:"green",icons:[],name:"Collapse All",onClick:async()=>{for(const e of this.collapseButtons)this.collapseSection(e.collapseButton,e.id,e.subMenu)}},{template:"loading",isDisabled:!0,name:"Collapsing"}]).insert(r,"beforeend"),tt.create([{color:"green",icons:[],name:"Expand All",onClick:async()=>{for(const e of this.collapseButtons)this.expandSection(e.collapseButton,e.id,e.subMenu)}},{template:"loading",isDisabled:!0,name:"Expanding"}]).insert(r,"beforeend");const g=tt.create([{color:"green",icons:[],name:"Dismiss All New",onClick:async()=>{await c.common.setSetting("dismissedOptions",c.esgst.toDismiss);for(let e=l.length-1;e>-1;e--)l[e].remove()}},{template:"loading",isDisabled:!0,name:"Dismissing"}]).insert(r,"beforeend").hide();a.setAttribute("data-esgst-popup",!0);const u=[{check:!0,options:{color:"alternate-white",tooltip:"Sync data",icons:["fa-refresh"],onClick:()=>Lt(!0)}},{check:!0,options:{color:"alternate-white",tooltip:"Restore data",icons:["fa-sign-in esgst-rotate-90"],onClick:()=>c.esgst.modules.loadDataManagement("import",!0)}},{check:!0,options:{color:"alternate-white",tooltip:"Backup data",icons:["fa-sign-out esgst-rotate-270"],onClick:()=>c.esgst.modules.loadDataManagement("export",!0)}},{check:!0,options:{color:"alternate-white",tooltip:"Delete data",icons:["fa-trash"],onClick:()=>c.esgst.modules.loadDataManagement("delete",!0)}},{check:!0,options:{color:"alternate-white",tooltip:"Download settings (downloads your settings to your computer without your personal data so you can easily share them with other users)",icons:["fa-gear","fa-arrow-circle-down"],onClick:()=>c.common.exportSettings()}},{check:!0,options:{color:"alternate-white",tooltip:"Clean old data",icons:["fa-paint-brush"],onClick:()=>c.esgst.modules.loadDataCleaner(!0)}},{check:!c.esgst.parameters.esgst,options:{color:"alternate-white",tooltip:"View recent username changes",icons:["fa-user","fa-history"],onClick:()=>c.common.setSMRecentUsernameChanges()}},{check:!c.esgst.parameters.esgst&&d.get("uf"),options:{color:"alternate-white",tooltip:"See list of filtered users",icons:["fa-user","fa-eye-slash"],onClick:()=>c.common.setSMManageFilteredUsers()}},{check:!c.esgst.parameters.esgst&&c.esgst.sg&&d.get("gf")&&d.get("gf_s"),options:{color:"alternate-white",tooltip:"Manage hidden giveaways",icons:["fa-gift","fa-eye-slash"],onClick:()=>c.common.setSMManageFilteredGiveaways()}},{check:!c.esgst.parameters.esgst&&c.esgst.sg&&d.get("df")&&d.get("df_s"),options:{color:"alternate-white",tooltip:"Manage hidden discussions",icons:["fa-comments","fa-eye-slash"]},ref:e=>c.esgst.modules.discussionsDiscussionFilters.df_menu({},e)},{check:!c.esgst.parameters.esgst&&c.esgst.st&&d.get("tf")&&d.get("tf_s"),options:{color:"alternate-white",tooltip:"Manage hidden trades",icons:["fa-retweet","fa-eye-slash"]},ref:e=>c.esgst.modules.tradesTradeFilters.tf_menu({},e)},{check:!c.esgst.parameters.esgst&&c.esgst.sg&&d.get("dt"),options:{color:"alternate-white",tooltip:"Manage discussion tags",icons:["fa-comments","fa-tags"],onClick:()=>c.common.openManageDiscussionTagsPopup()}},{check:!c.esgst.parameters.esgst&&c.esgst.sg&&d.get("ut"),options:{color:"alternate-white",tooltip:"Manage user tags",icons:["fa-user","fa-tags"],onClick:()=>c.common.openManageUserTagsPopup()}},{check:!c.esgst.parameters.esgst&&d.get("gt"),options:{color:"alternate-white",tooltip:"Manage game tags",icons:["fa-gamepad","fa-tags"],onClick:()=>c.common.openManageGameTagsPopup()}},{check:!c.esgst.parameters.esgst&&d.get("gpt"),options:{color:"alternate-white",tooltip:"Manage group tags",icons:["fa-users","fa-tags"],onClick:()=>c.common.openManageGroupTagsPopup()}},{check:!c.esgst.parameters.esgst&&d.get("wbc"),options:{color:"alternate-white",tooltip:"Manage Whitelist / Blacklist Checker caches",icons:["fa-heart","fa-ban","fa-cog"]},ref:e=>c.esgst.modules.usersWhitelistBlacklistChecker.wbc_addButton(!1,e)},{check:!c.esgst.parameters.esgst&&d.get("namwc"),options:{color:"alternate-white",tooltip:"Manage Not Activated / Multiple Wins Checker caches",icons:["fa-trophy","fa-cog"]},ref:e=>c.esgst.modules.usersNotActivatedMultipleWinChecker.namwc_setPopup(e)}].filter(e=>e.check),m=pt.create("sm",[{name:"ESGST",url:c.esgst.settingsUrl},{name:"Settings",url:c.esgst.settingsUrl}]).insert(a,"afterbegin");var h;c.esgst.st&&(null===(h=m.nodes.outer)||void 0===h||h.classList.remove("esgst-fmph"));for(const e of u){const t=tt.create(e.options).insert(m.nodes.outer,"beforeend");e.ref&&e.ref(t.nodes.outer)}e||(c.esgst.mainPageHeading=m.nodes.outer),s.addEventListener("input",e=>this.filterSm(e)),s.addEventListener("change",e=>this.filterSm(e)),i.classList.add("esgst-menu-layer"),Se.insert(i,"beforeend",Se.element("div",{className:"esgst-menu-split"},Se.element("div",{className:"esgst-settings-menu"}),Se.element("div",{className:"esgst-settings-menu-feature "+(e?"":"esgst-menu-split-fixed")},"Click on a feature/option to manage it here."))),tt.create([{color:"green",icons:[],name:"Save Changes",onClick:async()=>{try{const e=[],t=new Set(Object.values(this.requiredPermissions).flat());for(const s of t)await ut.contains([[s]])||e.push(s);if(n.runtime.getURL&&e.length>0){new lt({addScrollable:!0,icon:"fa-exclamation",isTemp:!0,title:Se.element("fragment",null,"Some of the features you enabled require permissions in order to work. Go"," ",Se.element("a",{className:"esgst-bold table__column__secondary-link",href:`${n.runtime.getURL("permissions.html")}?keys=${e.join(",")}`,target:"_blank"},"here")," ",'and click the "Grant" button to grant them.')}).open(),this.requiredPermissions={}}await c.common.lockAndSaveSettings(this.toSave);Object.keys(this.toSave).some(e=>e.startsWith("customAdaReqLim"))&&await n.runtime.sendMessage({action:"update_adareqlim"}),this.toSave={},new lt({icon:"fa-check",isTemp:!0,title:"Settings saved!"}).open()}catch(e){dt.error(e.message)}}},{color:"white",isDisabled:!0,icons:[],name:"Saving..."}]).insert(m.nodes.outer,"beforeend"),i.addEventListener("click",e=>this.loadFeatureDetails(null,null,o&&o.scrollable.offsetTop,e));let p,f,b=i.getElementsByClassName("esgst-settings-menu")[0];for(const e of Object.keys(ut.permissions)){const t=ut.permissions[e];for(const s of Object.keys(t.messages)){const t=c.esgst.featuresById[s];t&&(t.permissions||(t.permissions=[]),t.permissions.push(e))}}if(p=1,n.runtime.getURL){this.createMenuSection(b,null,p,"Permissions","permissions").lastElementChild.innerHTML=`\n\t\t\t\tGo <a class="esgst-bold table__column__secondary-link" href="${n.runtime.getURL("permissions.html")}" target="_blank">here</a> to grant / deny permissions.\n\t\t\t`,p+=1}for(f in c.esgst.features)if(c.esgst.features.hasOwnProperty(f)&&("trades"!==f||d.get("esgst_st"))){let e,t,s,n,a=!1;for(e in n=f.replace(/^./,e=>e.toUpperCase()),s=this.createMenuSection(b,null,p,n,f),t=1,c.esgst.features[f].features)if(c.esgst.features[f].features.hasOwnProperty(e)){if("common"===e)continue;let n,i;if(n=c.esgst.features[f].features[e],!n.sg&&n.st&&!d.get("esgst_st")&&"esgst"!==e)continue;i=this.getSMFeature(n,e,t,`${p}.${t}`,o),i&&(i.isNew&&(a=!0),s.lastElementChild.appendChild(i.menu),t+=1)}a&&c.common.createElements(s.firstElementChild.lastElementChild,"afterbegin",[{attributes:{class:"esgst-bold esgst-red esgst-new-indicator",title:"There is a new feature/option in this section"},type:"span",children:[{attributes:{class:"fa fa-star"},type:"i"}]}]),p+=1}const w=this.createMenuSection(b,null,p,"Element Ordering","element_ordering");this.setElementOrderingSection(w.lastElementChild),p+=1,this.createMenuSection(b,[{attributes:{class:"esgst-steam-api-key",type:"text"},type:"input"},{attributes:{class:"esgst-description"},type:"div",children:[{text:"This is optional for syncing owned games faster and required for syncing alt accounts. Get a Steam API Key ",type:"node"},{attributes:{class:"esgst-bold",href:"https://steamcommunity.com/dev/apikey",target:"_blank"},text:"here",type:"a"},{text:'. You can enter any domain in there, it is irrelevant, for example, "https://www.steamgifts.com".',type:"node"}]}],p,"Steam API Key","steam_api_key"),t=i.getElementsByClassName("esgst-steam-api-key")[0];let y=d.get("steamApiKey");y&&(t.value=y),t.addEventListener("input",()=>{this.preSave("steamApiKey",t.value)}),"settings"===c.esgst.parameters.esgst&&c.esgst.parameters.id&&this.loadFeatureDetails(c.esgst.parameters.id,c.common.getFeatureNumber(c.esgst.parameters.id).number,o&&o.scrollable.offsetTop),e&&o.open(),l=document.querySelectorAll(".esgst-new-indicator"),l.length&&g.show()}showExtensionOnlyPopup(){new lt({addScrollable:!0,icon:"fa-exclamation",isTemp:!0,title:Se.element("fragment",null,"This feature is only available in the extension version of ESGST. Please upgrade to the extension to use it. Visit the instructions in the readme on how to install the extension.",Se.element("br",null),Se.element("br",null),Se.element("a",{href:"https://github.com/SquishedPotatoe/esgst#installation"},"https://github.com/SquishedPotatoe/esgst#installation"),Se.element("br",null),Se.element("br",null),"To transfer your data from the userscript to the extension, backup your data in the backup menu of the userscript, then disable the userscript, install the extension and restore your data in the restore menu of the extension. Below are the links to the backup/restore pages:",Se.element("br",null),Se.element("br",null),Se.element("a",{href:"https://www.steamgifts.com/account/settings/profile?esgst=backup"},"https://www.steamgifts.com/account/settings/profile?esgst=backup"),Se.element("br",null),Se.element("br",null),Se.element("a",{href:"https://www.steamgifts.com/account/settings/profile?esgst=restore"},"https://www.steamgifts.com/account/settings/profile?esgst=restore"))}).open()}loadFeatureDetails(e,t,s,a){var i;if(s||(s=0),!e){if(!a.target.matches(".esgst-settings-feature"))return;e=a.target.getAttribute("data-id"),t=a.target.getAttribute("data-number")}const o=c.esgst.featuresById[e];if(!o)return;const r=`${c.esgst.settingsUrl}&id=${e}`,l=null!==(i=o.alias)&&void 0!==i?i:e;let g;o.customName?(g=o.customName(),this.replaceFeatureNamePlaceholders(g)):g=o.name.replace(/\[id=(.+?)]/g,c.common.getFeatureName.bind(c.common));const u=[{check:!0,content:g,name:"Name"},{check:!0,content:Se.element("fragment",null,Se.element("div",null,t,Se.element("i",{"data-clipboard-text":t,className:"icon_to_clipboard fa fa-fw fa-copy"})),Se.element("div",null,r,Se.element("i",{"data-clipboard-text":r,className:"icon_to_clipboard fa fa-fw fa-copy"}))),name:"Number / Link"}];let m,h;if(o.sg){const e=(d.getFull(l+"_sg")||c.common.getFeaturePath(o,l,"sg")).enabled;m=Se.element("div",null);const t=new vt(m,null,!0,d.get("esgst_st")?"SteamGifts":"",!0,!1,null,e);o.sgFeatureSwitch=t,t.onEnabled=()=>{if(o.extensionOnly&&n.gm)return t.disable(!0),void this.showExtensionOnlyPopup();if(o.conflicts)for(const e of o.conflicts){const s=d.getFull(e+"_sg");if("object"==typeof s?s.enabled:s)return t.disable(!0),void new lt({addScrollable:!0,icon:"fa-exclamation",isTemp:!0,title:`This feature conflicts with ${c.common.getFeatureName(null,e)}. While that feature is enabled, this feature cannot be enabled.`}).open()}this.preSave(l+"_sg",!0),o.sgSwitch&&o.sgSwitch.enable(!0),Se.insert(document.querySelector("#esgst-paths-sg"),"atinner",this.openPathsPopup(o,l,"sg"))},t.onDisabled=async()=>{this.preSave(l+"_sg",!1),o.sgSwitch&&o.sgSwitch.disable(!0),Se.insert(document.querySelector("#esgst-paths-sg"),"atinner",this.openPathsPopup(o,l,"sg"))}}if(o.st&&(d.get("esgst_st")||"esgst"===l)){const e=(d.getFull(l+"_st")||c.common.getFeaturePath(o,l,"st")).enabled;h=Se.element("div",null);const t=new vt(h,null,!0,"SteamTrades",!1,!0,null,e);o.stFeatureSwitch=t,t.onEnabled=()=>{if(o.extensionOnly&&n.gm)return t.disable(!0),void this.showExtensionOnlyPopup();if(o.conflicts)for(const e of o.conflicts){const s=d.getFull(e+"_st");if("object"==typeof s?s.enabled:s)return t.disable(!0),void new lt({addScrollable:!0,icon:"fa-exclamation",isTemp:!0,title:`This feature conflicts with ${c.common.getFeatureName(null,e)}. While that feature is enabled, this feature cannot be enabled.`}).open()}this.preSave(l+"_st",!0),o.stSwitch&&o.stSwitch.enable(!0),Se.insert(document.querySelector("#esgst-paths-st"),"atinner",this.openPathsPopup(o,l,"st"))},t.onDisabled=async()=>{this.preSave(l+"_st",!1),o.stSwitch&&o.stSwitch.disable(!0),Se.insert(document.querySelector("#esgst-paths-st"),"atinner",this.openPathsPopup(o,l,"st"))}}if(u.push({check:!0,content:Se.element("fragment",null,m,h),name:"Enable/Disable"}),o.description){const e=o.description();this.replaceFeatureNamePlaceholders(e),u.push({check:!0,content:Se.element("div",{className:"markdown"},e),name:"What does it do?"})}const p=this.getSmFeatureAdditionalOptions(o,l);p.length>0&&u.push({check:!0,content:Se.element("fragment",null,p),name:"Additional Options"}),o.sync&&u.push({check:!0,content:Se.element("fragment",null,Se.element("p",null,"This feature requires the following data to be synced in order to function properly:"," ",Se.element("strong",null,o.sync)),Se.element("br",null),Se.element("p",null,"To sync these now, click"," ",Se.element("a",{className:"table__column__secondary-link",href:`${c.esgst.syncUrl}&autoSync=true&${o.syncKeys.map(e=>e+"=1").join("&")}`,target:"_blank"},"here"),".")),name:"Sync Requirements"}),!o.sg||o.sgPaths&&"string"==typeof o.sgPaths||u.push({check:!0,content:this.openPathsPopup(o,l,"sg"),id:"esgst-paths-sg",name:"Where to run it on SteamGifts?"}),!o.st||!d.get("esgst_st")||o.stPaths&&"string"==typeof o.stPaths||u.push({check:!0,content:this.openPathsPopup(o,l,"st"),id:"esgst-paths-st",name:"Where to run it on SteamTrades?"});const f=document.querySelector(".esgst-settings-menu-feature");f.classList.contains("esgst-menu-split-fixed")||(f.style.maxHeight=f.closest(".esgst-menu-layer").offsetHeight-24+"px"),f.innerHTML="Click on a feature/option to manage it here.",c.common.createFormRows(f,"beforeend",{items:u})}setElementOrderingSection(e){const t={elementOrdering:!0,outerWrap:c.common.createElements(e,"beforeend",[{attributes:{class:"esgst-element-ordering-container"},type:"div"}])},s={elementOrdering:!0,outerWrap:c.common.createElements(e,"beforeend",[{attributes:{class:"esgst-element-ordering-container"},type:"div"}])},n=[{includeGridView:!0,group:"giveaways",id:"gc_categories",key:"gcPanel",name:"Game Categories",labels:{gc_ocv:"Original CV",gc_fcv:"Full CV",gc_rcv:"Reduced CV",gc_ncv:"No CV",gc_h:"Hidden",gc_i:"Ignored",gc_o:"Owned",gc_w:"Wishlisted",gc_f:"Followed",gc_pw:"Previously Won",gc_a:"Achievements",gc_bd:"Banned",gc_bvg:"Barter.vg",gc_sp:"Singleplayer",gc_mp:"Multiplayer",gc_sc:"Steam Cloud",gc_tc:"Trading Cards",gc_l:"Linux",gc_m:"Mac",gc_ea:"Early Access",gc_lg:"Learning",gc_rm:"Removed",gc_dlc:"DLC",gc_p:"Package",gc_gi:"Giveaway Info",gc_r:"Rating",gc_hltb:"HLTB",gc_rd:"Release Date",gc_g:"Genres"}},{includeGridView:!0,group:"giveaways",id:"giveawayHeading",key:"heading",name:"Giveaway Heading",labels:{gr:"Giveaway Recreator",gb:"Giveaway Bookmarks",gf:"Giveaway Filters",egh:"Entered Game Highlighter",name:"Game Name",points:"Points",copies:"Copies",steam:"Steam Link","screenshots-videos":"Screenshots / Videos",search:"Search Link",hideGame:"Hide Game",gt:"Game Tags"}},{group:"giveaways",id:"giveawayColumns",key:"columns",name:"Giveaway Columns",labels:{ged:"Giveaway Encrypter/Decrypter",endTime:"End Time",winners:"Winners",startTime:"Start Time",touhou:"Touhou",inviteOnly:"Invite Only",whitelist:"Whitelist",group:"Group",regionRestricted:"Region Restricted",level:"Level"}},{isGridView:!0,group:"giveaways_gv",id:"giveawayColumns_gv",key:"gvIcons",name:"Giveaway Columns",labels:{sgTools:"SGTools",ged:"Giveaway Encrypter/Decrypter",time:"End/Start Time",touhou:"Touhou",inviteOnly:"Invite Only",whitelist:"Whitelist",group:"Group",regionRestricted:"Region Restricted",level:"Level"}},{group:"giveaways",id:"giveawayPanel",key:"panel",name:"Giveaway Panel",labels:{ttec:"Time To Enter Calculator",gwc:"Giveaway Winning Chance",gwr:"Giveaway Winning Ratio",gptw:"Giveaway Points To Win",gp:"Giveaway Popup",elgb:"Enter/Leave Giveaway Button",sgTools:"SGTools"}},{isGridView:!0,group:"giveaways_gv",id:"giveawayPanel_gv",key:"panel",name:"Giveaway Panel",labels:{ttec:"Time To Enter Calculator",gwc:"Giveaway Winning Chance",gwr:"Giveaway Winning Ratio",gptw:"Giveaway Points To Win",gp:"Giveaway Popup",elgb:"Enter/Leave Giveaway Button"}},{includeGridView:!0,group:"giveaways",id:"giveawayLinks",key:"links",name:"Giveaway Links",labels:{entries:"Entries",winners_count:"Winners Count",comments:"Comments"}},{includeGridView:!0,group:"giveaways",id:"giveawayExtraPanel",key:"extraPanel",name:"Giveaway Extra Panel",labels:{ggl:"Giveaway Groups Loader"}},{group:"mainPageHeading",id:"leftButtonIds",key:"leftButtons",name:"Left Main Page Heading Buttons (Hidden)",tooltip:"Moving an element to this group will hide it from the main page heading. It will be accessible by clicking on the button with the vertical ellipsis located at the left side of the heading.",labels:{}},{group:"mainPageHeading",id:"rightButtonIds",key:"rightButtons",name:"Right Main Page Heading Buttons (Hidden)",tooltip:"Moving an element to this group will hide it from the main page heading. It will be accessible by clicking on the button with the vertical ellipsis located at the  right side of the heading.",labels:{}},{group:"mainPageHeading",id:"leftMainPageHeadingIds",key:"leftMainPageHeadingButtons",name:"Left Main Page Heading Buttons",labels:{aic:"Attached Images Carousel",as:"Archive Searcher",cec:"Comment/Entry Checker",cf:"Comment Filters",cs:"Comment Searcher",ctGo:"Comment Tracker (Go To Unread)",ctRead:"Comment Tracker (Mark As Read)",ctUnread:"Comment Tracker (Mark As Unread)",df:"Discussion Filters",df_s_s:"Discussion Filters (Single Filters Switch)",tf:"Trade Filters",tf_s_s:"Trade Filters (Single Filters Switch)",gmf:"Game Filters",gpf:"Group Filters",ds:"Discussion Sorter",gas:"Giveaway Sorter",ge:"Giveaway Extractor",gf:"Giveaway Filters",gf_s_s:"Giveaway Filters (Single Filters Switch)",glwc:"Group Library/Wishlist Checker",gts:"Giveaway Templates",gv:"Grid View",hgm:"Hidden Games Manager",mpp:"Main Post Popup",namwc:"Not Activated/Multiple Wins Checker",rbp:"Reply Box Popup",sks:"Sent Keys Searcher",tb:"Trade Bumper",uf_s_s:"User Filters (Single Filters Switch)",ugs:"Unsent Gifts Sender",usc:"User Suspension Checker",wbc:"Whitelist/Blacklist Checker",wbm:"Whitelist/Blacklist Manager",wbsAsc:"Whitelist/Blacklist Sorter (Ascending)",wbsDesc:"Whitelist/Blacklist Sorter (Descending)"}},{group:"mainPageHeading",id:"rightMainPageHeadingIds",key:"rightMainPageHeadingButtons",name:"Right Main Page Heading Buttons",labels:{esContinuous:"Endless Scrolling (Continuously Load)",esNext:"Endless Scrolling (Load Next),",esResume:"Endless Scrolling (Resume)",esPause:"Endless Scrolling (Pause)",esRefresh:"Endless Scrolling (Refresh)",esRefreshAll:"Endless Scrolling (Refresh All)",mm:"Multi-Manager",stbb:"Scroll To Bottom Button",sttb:"Scroll To Top Button"}}];for(const e of n){const n=[];for(const t in e.labels)e.labels.hasOwnProperty(t)&&n.push({attributes:{"data-draggable-id":t,"data-draggable-group":e.group},text:e.labels[t],type:"div"});const a=c.common.createElements((e.isGridView?s:t).outerWrap,"beforeend",[{text:`${e.name}${e.isGridView?" (Grid View)":""}`,type:"strong"},e.tooltip?{attributes:{class:"fa fa-question-circle",title:e.tooltip},type:"i"}:null,{attributes:{class:"esgst-element-ordering-box"},type:"div",children:n}]);if(tt.create([{color:"white",icons:["fa-undo"],name:"Reset",onClick:this.resetElementOrdering.bind(this,e.id,t,s)},{template:"loading",isDisabled:!0,name:"Resetting"}]).insert(a,"beforebegin"),(e.isGridView?s:t)[e.key]=a,a.addEventListener("dragenter",c.common.draggable_enter.bind(c.common,{context:a,item:{outerWrap:a}})),c.common.draggable_set({context:a,id:e.id,item:{outerWrap:a},onDragEnd:e=>{for(const t in e)this.preSave(t,e[t])}}),e.includeGridView){const n=[];for(const t in e.labels){if(!e.labels.hasOwnProperty(t))return;n.push({attributes:{"data-draggable-id":t,"data-draggable-group":e.group+"_gv"},text:e.labels[t],type:"div"})}const a=c.common.createElements(s.outerWrap,"beforeend",[{text:e.name+" (Grid View)",type:"strong"},{attributes:{class:"esgst-element-ordering-box"},type:"div",children:n}]);tt.create([{color:"white",icons:["fa-undo"],name:"Reset",onClick:this.resetElementOrdering.bind(this,e.id+"_gv",t,s)},{template:"loading",isDisabled:!0,name:"Resetting"}]).insert(a,"beforebegin"),s[e.key]=a,a.addEventListener("dragenter",c.common.draggable_enter.bind(c.common,{context:a,item:{outerWrap:a}})),c.common.draggable_set({context:a,id:e.id+"_gv",item:{outerWrap:a},onDragEnd:e=>{for(const t in e)this.preSave(t,e[t])}})}}c.esgst.modules.giveaways.giveaways_reorder(t),c.esgst.modules.giveaways.giveaways_reorder(s),c.common.reorderButtons(t)}async resetElementOrdering(e,t,s){this.preSave(e,d.defaultValues[e]),c.esgst.modules.giveaways.giveaways_reorder(t),c.esgst.modules.giveaways.giveaways_reorder(s),c.common.reorderButtons(t)}openPathsPopup(e,t,s){e.id=t;let n={exclude:{extend:this.addPath.bind(this)},excludeItems:[],include:{extend:this.addPath.bind(this)},includeItems:[],name:s};const a=Se.element("fragment",null,Se.element("div",{className:"esgst-bold"},"Run it here:"," ",Se.element("i",{className:"fa fa-question-circle",title:"Select the places where you want the feature to run. If you cannot find the place you want, select 'Custom' and enter the place manually (you have to use regular expressions)."})),Se.element("div",n.include),Se.element("div",{className:"esgst-button-group"},tt.create({color:"white",icons:["fa-plus-circle"],name:"Add New",onClick:()=>n.include.extend(e,"include",n,{enabled:1,pattern:""},!0)}).build().nodes.outer),Se.element("div",{className:"esgst-bold"},"Do NOT run it here:"," ",Se.element("i",{className:"fa fa-question-circle",title:"Select the places where you don't want the feature to run. If you cannot find the place you want, select 'Custom' and enter the place manually (you have to use regular expressions)."})),Se.element("div",n.exclude),Se.element("div",{className:"esgst-button-group"},tt.create({color:"white",icons:["fa-plus-circle"],name:"Add New",onClick:()=>n.exclude.extend(e,"exclude",n,{enabled:1,pattern:""},!0)}).build().nodes.outer));return n.setting=d.getFull(`${t}_${n.name}`)||c.common.getFeaturePath(e,t,n.name),n.setting.include.forEach(t=>n.include.extend(e,"include",n,t)),n.setting.exclude.forEach(t=>n.exclude.extend(e,"exclude",n,t)),a}addPath(e,t,s,n,a,i){let o={};o.container=c.common.createElements(e,"beforeend",[{type:"div"}]),o.switch=new vt(o.container,null,!0,"",!1,!1,null,a.enabled);let r=!1;if(o.switch.onChange=()=>{this.savePaths(t.id,n)},Se.insert(o.container,"beforeend",Se.element("select",{className:"esgst-switch-input esgst-switch-input-large",ref:e=>o.select=e},c.esgst.paths[n.name].filter(e=>!t[n.name+"Paths"]||"Everywhere"===e.name||e.name.match(t[n.name+"Paths"])).map(e=>Se.element("option",{value:e.pattern,selected:e.pattern===a.pattern&&(r=!0)||null},e.name)),t[n.name+"Paths"]?null:Se.element("option",{value:"custom",selected:!r||null},"Custom"))),Se.insert(o.container,"beforeend",Se.element("input",{className:"esgst-switch-input esgst-switch-input-large",type:"text",disabled:"custom"!==o.select.value||null,ref:e=>o.input=e})),o.select.addEventListener("change",()=>{"custom"===o.select.value?(o.input.disabled=!1,o.input.value=""):(o.input.disabled=!0,o.input.value=o.select.value),this.savePaths(t.id,n)}),o.input.value=a.pattern,o.input.addEventListener("input",()=>{this.validatePathRegex(o),this.savePaths(t.id,n)}),c.common.createElements(o.container,"beforeend",[{attributes:{class:"fa fa-times-circle esgst-clickable",title:"Remove"},type:"i"}]).addEventListener("click",()=>this.removePath(t,o,s,n)),o.invalid=c.common.createElements(o.container,"beforeend",[{attributes:{class:"fa fa-exclamation esgst-hidden esgst-red",title:"Invalid Regular Expression"},type:"i"}]),n[s+"Items"].push(o),"include"===s&&t.includeOptions){o.options=[];const e=c.common.createElements(o.container,"beforeend",[{attributes:{class:"esgst-form-row-indent"},type:"div"}]);for(const s of t.includeOptions){const i={id:s.id,switch:new vt(e,null,!0,s.name,!1,!1,null,!(!a.options||!a.options[s.id]))};i.switch.onChange=()=>this.savePaths(t.id,n),o.options.push(i)}}i&&this.savePaths(t.id,n)}removePath(e,t,s,n){let a=n[s+"Items"].length-1;if(0!==a||"include"!==s){for(;a>-1&&n[s+"Items"][a].input.value!==t.input.value;)a--;a>-1&&n[s+"Items"].splice(a,1),t.container.remove(),this.savePaths(e.id,n)}else window.alert("At least 1 place is required!")}validatePathRegex(e){e.invalid.classList.add("esgst-hidden");try{new RegExp(e.input.value)}catch(t){dt.warning(t.message,t.stack),e.invalid.classList.remove("esgst-hidden")}}async savePaths(e,t){t.setting.include=[],t.setting.exclude=[];for(const e of t.includeItems){const s={enabled:e.switch.value?1:0,pattern:e.input.value};if(e.options){s.options={};for(const t of e.options)s.options[t.id]=t.switch.value?1:0}t.setting.include.push(s)}for(const e of t.excludeItems)t.setting.exclude.push({enabled:e.switch.value?1:0,pattern:e.input.value});this.preSave(`${e}_${t.name}`,t.setting)}dismissNewOption(e,t){t.currentTarget.remove();const s=d.get("dismissedOptions");s.indexOf(e)<0&&(s.push(e),this.preSave("dismissedOptions",s))}getSMFeature(e,t,s,a,i){var o;const r=null!==(o=e.alias)&&void 0!==o?o:t,g=document.createElement("div");let u;g.className="esgst-sm-feature-container",g.id="esgst_"+t,Se.insert(g,"atinner",Se.element("div",{className:"esgst-sm-feature",ref:e=>u=e})),c.common.createElements(u,"beforeend",[{attributes:{class:"esgst-sm-small-number esgst-form-heading-number"},text:s+".",type:"div"}]);let m=d.get("dismissedOptions").indexOf(r)<0&&!l.isSet(c.esgst.settings[r+"_sg"])&&!l.isSet(c.esgst.settings[r+"_st"]);m&&(e.isNew=!0,c.common.createElements(u.firstElementChild,"afterend",[{attributes:{class:"esgst-bold esgst-red esgst-clickable esgst-new-indicator",title:"This is a new feature/option. Click to dismiss."},text:"[NEW]",type:"span"}]).addEventListener("click",e=>this.dismissNewOption(r,e)));let h,p,f,b,w,y,v=!0;if(e.sg){const s=(d.getFull(r+"_sg")||c.common.getFeaturePath(e,r,"sg")).enabled;s&&(v=!1),h=Se.element("div",null);const o=new vt(h,null,!0,d.get("esgst_st")?"[SG]":"",!0,!1,null,s);e.sgSwitch=o,o.onEnabled=()=>{if(e.extensionOnly&&n.gm)return o.disable(!0),void this.showExtensionOnlyPopup();if(e.conflicts)for(const t of e.conflicts){const e=d.getFull(t+"_sg");if("object"==typeof e?e.enabled:e)return o.disable(!0),void new lt({addScrollable:!0,icon:"fa-exclamation",isTemp:!0,title:`This feature conflicts with ${c.common.getFeatureName(null,t)}. While that feature is enabled, this feature cannot be enabled.`}).open()}e.permissions&&(this.requiredPermissions[r]=e.permissions),this.loadFeatureDetails(t,a,i&&i.scrollable.offsetTop),e.sgFeatureSwitch?e.sgFeatureSwitch.enable():this.preSave(r+"_sg",!0),w.classList.contains("esgst-hidden")&&(this.expandSection(f,t,w),b=!0),e.dependencies&&c.common.createConfirmation(Se.element("fragment",null,"This feature depends on the following features to work properly: ",Se.element("br",null),Se.element("br",null),e.dependencies.map(e=>[`"${c.common.getFeatureName(null,e)}"`,Se.element("br",null)]).flat(),Se.element("br",null),"Would you like ESGST to automatically enable these features now if they're not already enabled?"),()=>this.enableDependencies(e.dependencies,"sg"))},o.onDisabled=()=>{e.permissions&&delete this.requiredPermissions[r],this.loadFeatureDetails(t,a,i&&i.scrollable.offsetTop),e.sgFeatureSwitch?e.sgFeatureSwitch.disable():this.preSave(r+"_sg",!1),e.stSwitch&&e.stSwitch.value||(this.collapseSection(f,t,w),b=!1)}}if(e.st&&(d.get("esgst_st")||"esgst"===r)){const s=(d.getFull(r+"_st")||c.common.getFeaturePath(e,r,"st")).enabled;s&&(v=!1),p=Se.element("div",null);const o=new vt(p,null,!0,"[ST]",!1,!0,null,s);e.stSwitch=o,o.onEnabled=()=>{if(e.extensionOnly&&n.gm)return o.disable(!0),void this.showExtensionOnlyPopup();if(e.conflicts)for(const t of e.conflicts){const e=d.getFull(t+"_st");if("object"==typeof e?e.enabled:e)return o.disable(!0),void new lt({addScrollable:!0,icon:"fa-exclamation",isTemp:!0,title:`This feature conflicts with ${c.common.getFeatureName(null,t)}. While that feature is enabled, this feature cannot be enabled.`}).open()}e.permissions&&(this.requiredPermissions[r]=e.permissions),this.loadFeatureDetails(t,a,i&&i.scrollable.offsetTop),e.stFeatureSwitch?e.stFeatureSwitch.enable():this.preSave(r+"_st",!0),w.classList.contains("esgst-hidden")&&(this.expandSection(f,t,w),b=!0),e.dependencies&&c.common.createConfirmation(Se.element("fragment",null,"This feature depends on the following features to work properly: ",Se.element("br",null),Se.element("br",null),e.dependencies.map(e=>[`"${c.common.getFeatureName(null,e)}"`,Se.element("br",null)]).flat(),Se.element("br",null),"Would you like ESGST to automatically enable these features now if they're not already enabled?"),()=>this.enableDependencies(e.dependencies,"st"))},o.onDisabled=()=>{e.permissions&&delete this.requiredPermissions[r],this.loadFeatureDetails(t,a,i&&i.scrollable.offsetTop),e.stFeatureSwitch?e.stFeatureSwitch.disable():this.preSave(r+"_st",!1),e.sgSwitch&&e.sgSwitch.value||(this.collapseSection(f,t,w),b=!1)}}if(e.customName?(y=e.customName(),this.replaceFeatureNamePlaceholders(y)):y=e.name.replace(/\[id=(.+?)]/g,c.common.getFeatureName.bind(c.common)),Se.insert(u,"beforeend",Se.element("span",{className:"esgst-sm-feature-name"},h&&h.firstElementChild,p&&p.firstElementChild,Se.element("a",{className:"esgst-settings-feature table__column__secondary-link esgst-clickable","data-id":t,"data-number":a},y))),Se.insert(g,"beforeend",Se.element("div",{className:"esgst-form-row-indent SMFeatures "+(v?"esgst-hidden":""),ref:e=>w=e})),e.features){let s=1,n=!1;for(const t in e.features){if(!e.features.hasOwnProperty(t))continue;const o=e.features[t];if(!o.sg&&o.st&&!d.get("esgst_st")&&"esgst"!==r)continue;const l=this.getSMFeature(o,t,s,`${a}.${s}`,i);l&&(l.isNew&&(n=!0),w.appendChild(l.menu),s+=1)}m=m||n,n&&c.common.createElements(u.firstElementChild,"afterend",[{attributes:{class:"esgst-bold esgst-red esgst-new-indicator",title:"There is a new feature/option in this section"},type:"span",children:[{attributes:{class:"fa fa-star"},type:"i"}]}]),d.get("makeSectionsCollapsible")&&(f=c.common.createElements(u,"afterbegin",[{attributes:{class:"esgst-clickable",style:"margin-right: 5px;"},type:"span",children:[{attributes:{class:`fa fa-${d.get("collapse_"+t)?"plus":"minus"}-square`,title:(d.get("collapse_"+t)?"Expand":"Collapse")+" options"},type:"i"}]}]),d.get("collapse_"+t)?(w.classList.add("esgst-hidden"),b=!1):b=!0,this.collapseButtons.push({collapseButton:f,id:t,subMenu:w}),f.addEventListener("click",()=>b=this.collapseOrExpandSection(f,t,w,b)))}else d.get("makeSectionsCollapsible")&&(g.style.marginLeft="17px");return{isNew:m,menu:g}}resetColor(e,t,s,n){const a=l.rgba2Hex(d.defaultValues[`${s}_${n}`]);e.value=a.hex,t.value=a.alpha,this.preSave(`${s}_${n}`,l.hex2Rgba(e.value,t.value))}getSmFeatureAdditionalOptions(e,t){let s=[];if(t.startsWith("gc_")&&(e.isCategory&&s.push(this.addGcCategoryPanel(t,e)),"gc_r"===t?s.push(this.addGcRatingPanel()):"gc_o_a"===t&&s.push(this.addGcAltMenuPanel())),"ul"===t)s.push(this.addUlMenuPanel("ul_links"));else if("cgb"===t)s.push(this.addGwcrMenuPanel("cgb_levelColors","level",!1,"10"));else if("gch"===t)s.push(this.addGwcrMenuPanel("gch_colors","copies",!0));else if("glh"===t)s.push(this.addGwcrMenuPanel("glh_colors","level",!0,"10"));else if("gwc"===t)s.push(this.addGwcrMenuPanel("gwc_colors","chance"));else if("gwr"===t)s.push(this.addGwcrMenuPanel("gwr_colors","ratio"));else if("gptw"===t)s.push(this.addGwcrMenuPanel("gptw_colors","points to win"));else if("geth"===t)s.push(this.addGwcrMenuPanel("geth_colors","hours"));else if(e.colors||e.background){"boolean"==typeof e.background?e.colors={bgColor:"Background"}:"boolean"==typeof e.colors&&(e.colors={color:"Text",bgColor:"Background"});const n=[];for(const s in e.colors){const a=l.rgba2Hex(d.get(`${t}_${s}`));n.push(Se.element("fragment",null,Se.element("div",null,Se.element("strong",null,e.colors[s]+":")),Se.element("div",null,Se.element("input",{"data-color-id":s,type:"color",value:a.hex}),"Opacity:",Se.element("input",{max:"1.0",min:"0.0",step:"0.1",type:"number",value:a.alpha}),Se.element("div",{className:"form__saving-button"},"Reset"))))}const a=Se.element("div",{className:"esgst-sm-additional-option"},n),i=a.querySelectorAll("[data-color-id]");for(const e of i){const s=e.getAttribute("data-color-id"),n=e.nextElementSibling;this.addColorObserver(e,n,t,s),n.nextElementSibling.addEventListener("click",this.resetColor.bind(this,e,n,t,s))}if(s.push(a),"gc_g"===t){let e;const t=Se.element("div",{className:"esgst-sm-additional-option"},Se.element("div",null,"Only show the following genres:"),Se.element("div",null,Se.element("input",{type:"text",value:d.get("gc_g_filters"),ref:t=>e=t}),Se.element("i",{className:"fa fa-question-circle",title:"If you enter genres here, a genre category will only appear if the game has the listed genre. Separate genres with a comma, for example: Genre1, Genre2"})));c.common.observeChange(e,"gc_g_filters",this.toSave),s.push(t),s.push(this.addGcMenuPanel())}}else if(e.inputItems){let n=Se.element("div",{className:"esgst-sm-additional-option"});t.match(/^(chfl|sk_)/)?e.inputItems=[{event:"keydown",id:e.inputItems,shortcutKey:!0,prefix:"Enter the key combo you want to use for this task: "}]:t.match(/^hr_.+_s$/)&&(e.inputItems=[{id:t+"_sound",play:!0}]),e.inputItems.forEach(s=>{const a=[],i=s.attributes||{};s.play?(i.style="width: 200px",i.type="file",a.push({attributes:i,type:"input"},{attributes:{class:"fa fa-play-circle esgst-clickable"},type:"i"})):(i.class="esgst-switch-input esgst-switch-input-large",i.type=i.type||"text",i.value=d.get(s.id),a.push({text:s.prefix||"",type:"node"},{attributes:i,type:"input"},{text:s.suffix||"",type:"node"}),s.tooltip&&a.push({attributes:{class:"fa fa-question-circle",title:s.tooltip},type:"i"}));let o,r="",l=c.common.createElements(n,"beforeend",[{type:"div",children:a}]);o=l.firstElementChild,s.play&&o.nextElementSibling.addEventListener("click",async()=>(await c.esgst.modules.generalHeaderRefresher.createPlayer(d.get(s.id)||c.esgst.modules.generalHeaderRefresher.getDefaultSound())).play()),void 0===d.get(s.id)&&d.get("dismissedOptions").indexOf(s.id)<0&&(e.isNew=!0,c.common.createElements(l,"afterbegin",[{attributes:{class:"esgst-bold esgst-red esgst-clickable esgst-new-indicator",title:"This is a new feature/option. Click to dismiss."},text:"[NEW]",type:"span"}]).addEventListener("click",e=>this.dismissNewOption(s.id,e))),o.addEventListener(s.event||"change",e=>{s.shortcutKey?(e.preventDefault(),e.stopPropagation(),e.repeat||(r="",e.ctrlKey?r+="ctrlKey + ":e.shiftKey?r+="shiftKey + ":e.altKey&&(r+="altKey + "),r+=e.key.toLowerCase())):s.play?this.readHrAudioFile(t,e):"keydown"===s.event?(e.preventDefault(),this.preSave(s.id,e.key),o.value=e.key):this.preSave(s.id,o.value)},s.shortcutKey||!1),s.shortcutKey&&o.addEventListener("keyup",()=>{this.preSave(s.id,r),o.value=r})}),s.push(n)}if(e.options){const[n,a]=Array.isArray(e.options)?["_index_*",e.options]:["_index",[e.options]];for(const[e,i]of a.entries()){const a=n.replace(/\*/,e),o=d.get(`${t}${a}`),r=[];for(const e of i.values)r.push(e.match(/~/)?Se.element("option",{disabled:!0},e.replace(/~/,"")):Se.element("option",null,e));let l;const g=Se.element("div",{className:"esgst-sm-additional-option"},Se.element("div",null,i.title,Se.element("select",{ref:e=>l=e},r)));l.selectedIndex=o,c.common.observeNumChange(l,`${t}${a}`,this.toSave,"selectedIndex"),s.push(g)}}return s}readHrAudioFile(e,t){let s=new lt({addScrollable:!0,icon:"fa-circle-o-notch fa-spin",title:"Uploading..."});s.open();try{let n=new FileReader;n.onload=()=>this.saveHrFile(e,s,n),n.readAsArrayBuffer(t.currentTarget.files[0])}catch(e){dt.warning(e.message,e.stack),s.icon.classList.remove("fa-circle-o-notch"),s.icon.classList.remove("fa-spin"),s.icon.classList.add("fa-times"),s.title.textContent="An error happened."}}async saveHrFile(e,t,s){try{let n=new Uint8Array(s.result),a="";for(let e=0,t=s.result.byteLength;e<t;e++)a+=String.fromCharCode(n[e]);let i=window.btoa(a);(await c.esgst.modules.generalHeaderRefresher.createPlayer(i)).play(),this.preSave(e+"_sound",i),t.close()}catch(e){dt.warning(e.message,e.stack),t.icon.classList.remove("fa-circle-o-notch"),t.icon.classList.remove("fa-spin"),t.icon.classList.add("fa-times"),t.title.textContent="An error happened."}}addGwcrMenuPanel(e,t,s,n="100"){let a;const i=Se.element("div",{className:"esgst-sm-additional-option"},Se.element("div",null,Se.element("div",{className:"form__saving-button",ref:e=>a=e},Se.element("span",null,"Add Color Setting")),Se.element("i",{className:"fa fa-question-circle",title:`Allows you to set different colors for different ${t} ranges.`})));for(let n=0,a=d.get(e).length;n<a;++n)this.addGwcColorSetting(d.get(e)[n],e,t,i,s);return a.addEventListener("click",()=>{const a={color:"#ffffff",lower:"0",upper:n};s&&(a.bgColor="");const o=d.get(e);o.push(a),this.preSave(e,o),this.addGwcColorSetting(a,e,t,i,s)}),i}addGwcColorSetting(e,t,s,n,a){let i,o,r,l,g,u,m,h;m=c.common.createElements(n,"beforeend",[{type:"div",children:[{text:"From: ",type:"node"},{attributes:{step:"0.01",type:"number",value:e.lower},type:"input"},{text:" to ",type:"node"},{attributes:{step:"0.01",type:"number",value:e.upper},type:"input"},{text:` ${s}, color it as `,type:"node"},{attributes:{type:"color",value:e.color},type:"input"},...a?[{text:" with the background ",type:"node"},{attributes:{type:"color",value:e.bgColor},type:"input"}]:[],{attributes:{class:"esgst-clickable fa fa-times",title:"Delete this setting"},type:"i"}]}]),l=m.firstElementChild,h=l.nextElementSibling,o=h.nextElementSibling,a?(i=o.nextElementSibling,u=i.nextElementSibling):u=o.nextElementSibling,l.addEventListener("change",()=>{e.lower=l.value,this.preSave(t,d.get(t))}),h.addEventListener("change",()=>{e.upper=h.value,this.preSave(t,d.get(t))}),o.addEventListener("change",()=>{e.color=o.value,this.preSave(t,d.get(t))}),i&&i.addEventListener("change",()=>{e.bgColor=i.value,this.preSave(t,d.get(t))}),u.addEventListener("click",()=>{if(window.confirm("Are you sure you want to delete this setting?")){const s=d.get(t);for(r=0,g=s.length;r<g&&s[r]!==e;++r);r<g&&(s.splice(r,1),this.preSave(t,s),m.remove())}})}addUlMenuPanel(e){let t;const s=Se.element("fragment",null,Se.element("div",{className:"esgst-sm-additional-option",ref:e=>t=e}),Se.element("div",{className:"esgst-sm-additional-option"},Se.element("div",null,Se.element("div",{className:"form__saving-button",onclick:()=>this.addUlMenuItem(e,t)},Se.element("span",null,"Add Link")),Se.element("div",{className:"form__saving-button",onclick:()=>{this.preSave(e,d.defaultValues[e]),t.innerHTML="",this.addUlMenuItems(e,t)}},Se.element("span",null,"Reset")),Se.element("div",{className:"form__saving-button",title:"This will merge your list with the default list, meaning that any new items in the default list will be added to your list. Also, if you previously deleted an item from the default list, it will come back.",onclick:()=>this.mergeValues(e,t,this.addUlMenuItems.bind(this))},Se.element("span",null,"Merge"))),Se.element("div",null,Se.element("div",{className:"form__input-description"},"The default links should give you an idea of how the format works.",Se.element("br",null),Se.element("br",null),'As label, you can use FontAwesome icons (for example, "fa-icon"), image URLs (for example, "https://www.example.com/image.jpg") and plain text (for example, "Text"). You can also combine them (for example, "fa-icon https://www.example.com/image.jpg Text"). Images will be resized to 16x16.',Se.element("br",null),Se.element("br",null),"In the URL, you can use the templates %username% and %steamid%, they will be replaced with the user's username/Steam id.`"))));return c.common.draggable_set({addTrash:!0,context:t,id:"ul_links",item:{},onDragEnd:e=>{for(const t in e)this.preSave(t,e[t])}}),this.addUlMenuItems(e,t),s}mergeValues(e,t,s){const n=d.get(e);for(const t of d.defaultValues[e]){const e=JSON.stringify(t);n.filter(t=>JSON.stringify(t)===e)[0]||n.push(t)}this.preSave(e,n),t.innerHTML="",s&&s(e,t)}addUlMenuItems(e,t){for(const[s,n]of d.get(e).entries())this.addUlLink(s,e,n,t)}addUlMenuItem(e,t){const s={label:"",url:""},n=d.get(e);n.push(s),this.preSave(e,n),this.addUlLink(n.length-1,e,s,t)}addUlLink(e,t,s,n){let a;Se.insert(n,"beforeend",Se.element("div",{"data-draggable-id":e,"data-draggable-obj":JSON.stringify(s),ref:e=>a=e},"Label:",Se.element("input",{onchange:e=>{s.label=e.currentTarget.value,this.preSave(t,d.get(t)),a.setAttribute("data-draggable-obj",JSON.stringify(s))},type:"text",value:s.label}),"URL:",Se.element("input",{onchange:e=>{s.url=e.currentTarget.value,this.preSave(t,d.get(t)),a.setAttribute("data-draggable-obj",JSON.stringify(s))},type:"text",value:s.url}))),c.common.draggable_set({addTrash:!0,context:n,id:"ul_links",item:{},onDragEnd:e=>{for(const t in e)this.preSave(t,e[t])}})}addGcCategoryPanel(e,t){let s,n,a,i,o,r,l;const g=Se.element("div",{className:"esgst-sm-additional-option"},t.allowCustomDisplay?Se.element("div",null,Se.element("strong",null,"Show:"),Se.element("select",{onchange:t=>{switch(t.currentTarget.value){case"label":this.preSave(e+"_s",!1),this.preSave(e+"_s_i",!1),n.classList.remove("esgst-hidden"),"gc_rd"===e&&a.classList.remove("esgst-hidden"),i.classList.add("esgst-hidden"),o.classList.add("esgst-hidden");break;case"initials":this.preSave(e+"_s",!0),this.preSave(e+"_s_i",!1),n.classList.add("esgst-hidden"),a.classList.add("esgst-hidden"),i.classList.add("esgst-hidden"),o.classList.add("esgst-hidden");break;case"icon":this.preSave(e+"_s",!0),this.preSave(e+"_s_i",!0),n.classList.add("esgst-hidden"),a.classList.add("esgst-hidden"),i.classList.remove("esgst-hidden"),o.classList.remove("esgst-hidden")}},ref:e=>s=e},Se.element("option",{value:"label"},"Label"),Se.element("option",{value:"initials"},"Initials"),Se.element("option",{value:"icon"},"Icon")),Se.element("input",{className:"esgst-hidden",type:"text",value:d.get(e+"Label"),ref:e=>n=e}),Se.element("i",{className:"esgst-clickable esgst-hidden fa fa-question-circle",ref:e=>a=e}),Se.element("input",{className:"esgst-hidden",type:"text",value:d.get(e+"Icon"),ref:e=>i=e}),Se.element("i",{className:"esgst-clickable esgst-hidden fa fa-question-circle",ref:e=>o=e})):null,Se.element("div",null,Se.element("strong",null,"URL:"),Se.element("input",{type:"text",value:d.get(e+"Url"),ref:e=>r=e}),Se.element("i",{className:"esgst-clickable fa fa-question-circle",ref:e=>l=e})));return t.allowCustomDisplay&&(c.common.createTooltip(a,"Enter the date format here, using the following keywords:\n\t\t\t<br/>\n\t\t\t<br/>\n\t\t\tDD - Day<br/>\n\t\t\tMM - Month in numbers (i.e. 1)<br/>\n\t\t\tMon - Month in short name (i.e. Jan)<br/>\n\t\t\tMonth - Month in full name (i.e. January)<br/>\n\t\t\tYYYY - Year"),c.common.createTooltip(o,'The name of the icon must be any name in this page: <a href="https://fontawesome.com/v4.7.0/icons/">https://fontawesome.com/v4.7.0/icons/</a>')),c.common.createTooltip(l,'You can use the following placeholders here:\n\t\t\t<br/>\n\t\t\t<span class="esgst-bold">%steam-id%</span> - Your Steam ID.<br/>\n\t\t\t<span class="esgst-bold">%username%</span> - Your username.<br/>\n\t\t\t<span class="esgst-bold">%game-type%</span> - The type of the game e.g. "app" or "sub".<br/>\n\t\t\t<span class="esgst-bold">%game-id%</span> - The Steam ID of the game.<br/>\n\t\t\t<span class="esgst-bold">%game-name%</span> - The name of the game.<br/>\n\t\t\t<span class="esgst-bold">%game-search-name%</span> - The name of the game as a URI encoded string, useful for search URLs.<br/>\n\t\t\t<span class="esgst-bold">%hltb-id%</span> - The HLTB ID of the game.<br/>'),t.allowCustomDisplay&&(d.get(e+"_s")?d.get(e+"_s_i")?(s.selectedIndex=2,i.classList.remove("esgst-hidden"),o.classList.remove("esgst-hidden")):s.selectedIndex=1:(s.selectedIndex=0,n.classList.remove("esgst-hidden"),"gc_rd"===e&&a.classList.remove("esgst-hidden")),c.common.observeChange(n,e+"Label",this.toSave),c.common.observeChange(i,e+"Icon",this.toSave)),c.common.observeChange(r,e+"Url",this.toSave),g}addGcRatingPanel(){let e;const t=Se.element("div",{className:"esgst-sm-additional-option"},Se.element("div",null,Se.element("div",{className:"form__saving-button",ref:t=>e=t},Se.element("span",null,"Add Rating Setting")),Se.element("i",{className:"fa fa-question-circle",title:"Allows you to set different colors/icons for different rating ranges."})));for(let e=0,s=d.get("gc_r_colors").length;e<s;++e)this.addGcRatingColorSetting(d.get("gc_r_colors")[e],t);return e.addEventListener("click",()=>{let e={color:"",bgColor:"",icon:"",lower:"",upper:""};const s=d.get("gc_r_colors");s.push(e),this.preSave("gc_r_colors",s),this.addGcRatingColorSetting(e,t)}),t}addGcRatingColorSetting(e,t){let s,n,a,i,o,r,l,g;Se.insert(t,"beforeend",Se.element("div",{className:"esgst-sm-additional-option",ref:e=>s=e},Se.element("div",null,"Rating Range:",Se.element("input",{type:"number",value:e.lower,ref:e=>n=e}),"% -",Se.element("input",{type:"number",value:e.upper,ref:e=>a=e}),"%"),Se.element("div",null,"Color:",Se.element("input",{type:"color",value:e.color,ref:e=>i=e}),"Background Color:",Se.element("input",{type:"color",value:e.bgColor,ref:e=>o=e}),"Icon:",Se.element("input",{type:"text",value:e.icon,ref:e=>r=e}),Se.element("i",{className:"fa fa-question-circle",ref:e=>l=e})),Se.element("div",null,Se.element("div",{className:"form__saving-button",ref:e=>g=e},Se.element("span",null,"Delete"))))),c.common.createTooltip(l,'The name of the icon can be any name from <a href="https://fontawesome.com/v4.7.0/icons/">FontAwesome</a> or any text. For example, if you want to use alt symbols like ▲ (Alt + 3 + 0) and ▼ (Alt + 3 + 1), you can.'),n.addEventListener("change",()=>{e.lower=n.value,this.preSave("gc_r_colors",d.get("gc_r_colors"))}),a.addEventListener("change",()=>{e.upper=a.value,this.preSave("gc_r_colors",d.get("gc_r_colors"))}),i.addEventListener("change",()=>{e.color=i.value,this.preSave("gc_r_colors",d.get("gc_r_colors"))}),o.addEventListener("change",()=>{e.bgColor=o.value,this.preSave("gc_r_colors",d.get("gc_r_colors"))}),r.addEventListener("change",()=>{e.icon=r.value,this.preSave("gc_r_colors",d.get("gc_r_colors"))}),g.addEventListener("click",()=>{if(window.confirm("Are you sure you want to delete this setting?")){let t,n;const a=d.get("gc_r_colors");for(t=0,n=a.length;t<n&&a[t]!==e;++t);t<n&&(a.splice(t,1),this.preSave("gc_r_colors",a),s.remove())}})}addGcMenuPanel(){let e,t,s,n;const a=Se.element("div",{className:"esgst-sm-additional-option"},Se.element("div",null,Se.element("div",{className:"form__saving-button",ref:t=>e=t},Se.element("span",null,"Add Custom Genre Setting")),Se.element("i",{className:"fa fa-question-circle",title:"Allows you to color genres (colored genres will appear at the beginning of the list)."})));for(s=0,n=d.get("gc_g_colors").length;s<n;++s)this.addGcColorSetting(d.get("gc_g_colors")[s],a);return e.addEventListener("click",()=>{t={bgColor:"#7f8c8d",color:"#ffffff",genre:""};const e=d.get("gc_g_colors");e.push(t),this.preSave("gc_g_colors",e),this.addGcColorSetting(t,a)}),a}addGcColorSetting(e,t){let s,n,a,i,o,r,l;Se.insert(t,"beforeend",Se.element("div",{className:"esgst-sm-additional-option",ref:e=>l=e},Se.element("div",null,"Genre:",Se.element("input",{type:"text",value:e.genre,ref:e=>a=e})),Se.element("div",null,"Color:",Se.element("input",{type:"color",value:e.color,ref:e=>n=e}),"Background Color:",Se.element("input",{type:"color",value:e.bgColor,ref:e=>s=e})),Se.element("div",null,Se.element("div",{className:"form__saving-button",ref:e=>r=e},Se.element("span",null,"Delete"))))),a.addEventListener("change",()=>{e.genre=a.value,this.preSave("gc_g_colors",d.get("gc_g_colors"))}),n.addEventListener("change",()=>{e.color=n.value,this.preSave("gc_g_colors",d.get("gc_g_colors"))}),s.addEventListener("change",()=>{e.bgColor=s.value,this.preSave("gc_g_colors",d.get("gc_g_colors"))}),r.addEventListener("click",()=>{if(window.confirm("Are you sure you want to delete this setting?")){const t=d.get("gc_g_colors");for(i=0,o=t.length;i<o&&t[i]!==e;++i);i<o&&(t.splice(i,1),d.set("gc_g_colors",t),this.preSave("gc_g_colors",d.get("gc_g_colors")),l.remove())}})}addGcAltMenuPanel(){let e,t,s,n;const a=Se.element("div",{className:"esgst-sm-additional-option"},Se.element("div",null,Se.element("div",{className:"form__saving-button",ref:e=>t=e},Se.element("span",null,"Add Alt Account"))));for(c.common.createTooltip(c.common.createElements(a.firstElementChild,"beforeend",[{attributes:{class:"fa fa-question-circle"},type:"i"}]),'\n\t\t<div>You must sync your owned games normally for the script to pick up the games owned by your alt accounts. Syncing with alt accounts only works with a Steam API Key though, so make sure one is set at the last section of this menu.</div>\n\t\t<br/>\n\t\t<div>Steam ID is the number that comes after "steamcommunity.com/profiles/" in your alt account\'s URL. If your alt account has a URL in the format "steamcommunity.com/id/" though, you can get your Steam ID <a href="https://steamid.io/">here</a> by entering your URL in the input (you want the steamID64 one).</div>\n\t\t<br/>\n\t\t<div>You must fill the fields relative to your settings. For example, if you have simplified version enabled with icons, you must fill the "icon" field. If you don\'t have simplified version enabled, you must fill the "label" field. The current text in the fields are simply placeholders.</div>\n\t'),s=0,n=d.get("gc_o_altAccounts").length;s<n;++s)this.addGcAltSetting(d.get("gc_o_altAccounts")[s],a);return t.addEventListener("click",()=>{e={bgColor:"#000000",color:"#ffffff",games:{apps:{},subs:{}},icon:"",label:"",name:"",steamId:""};const t=d.get("gc_o_altAccounts");t.push(e),this.preSave("gc_o_altAccounts",t),this.addGcAltSetting(e,a)}),a}addGcAltSetting(e,t){let s,n,a,i,o,r,l,c,g,u;Se.insert(t,"beforeend",Se.element("div",{className:"esgst-sm-additional-option",ref:e=>g=e},Se.element("div",null,"Steam ID:",Se.element("input",{type:"text",placeholder:"0000000000000000",value:e.steamId,ref:e=>u=e}),"Nickname:",Se.element("input",{type:"text",placeholder:"alt1",value:e.name,ref:e=>l=e})),Se.element("div",null,"Color:",Se.element("input",{type:"color",value:e.color,ref:e=>s=e}),"Background Color:",Se.element("input",{type:"color",value:e.bgColor,ref:e=>n=e})),Se.element("div",null,"Icon:",Se.element("input",{type:"text",placeholder:"folder",value:e.icon,ref:e=>i=e}),"Label:",Se.element("input",{type:"text",placeholder:"Owned by alt1",value:e.label,ref:e=>o=e})),Se.element("div",null,Se.element("div",{className:"form__saving-button",ref:e=>c=e},Se.element("span",null,"Delete"))))),u.addEventListener("change",()=>{e.steamId=u.value,this.preSave("gc_o_altAccounts",d.get("gc_o_altAccounts"))}),l.addEventListener("change",()=>{e.name=l.value,this.preSave("gc_o_altAccounts",d.get("gc_o_altAccounts"))}),s.addEventListener("change",()=>{e.color=s.value,this.preSave("gc_o_altAccounts",d.get("gc_o_altAccounts"))}),n.addEventListener("change",()=>{e.bgColor=n.value,this.preSave("gc_o_altAccounts",d.get("gc_o_altAccounts"))}),i.addEventListener("change",()=>{e.icon=i.value,this.preSave("gc_o_altAccounts",d.get("gc_o_altAccounts"))}),o.addEventListener("change",()=>{e.label=o.value,this.preSave("gc_o_altAccounts",d.get("gc_o_altAccounts"))}),c.addEventListener("click",()=>{if(window.confirm("Are you sure you want to delete this setting?")){const t=d.get("gc_o_altAccounts");for(a=0,r=t.length;a<r&&t[a]!==e;++a);a<r&&(t.splice(a,1),this.preSave("gc_o_altAccounts",t),g.remove())}})}addColorObserver(e,t,s,n){e.addEventListener("change",()=>{this.preSave(`${s}_${n}`,l.hex2Rgba(e.value,t.value))}),t.addEventListener("change",()=>{this.preSave(`${s}_${n}`,l.hex2Rgba(e.value,t.value))})}createMenuSection(e,t,s,n,a){let i=c.common.createElements(e,"beforeend",[{attributes:{class:"esgst-form-row",id:"esgst_"+a,"data-id":a,"data-number":s},type:"div",children:[{attributes:{class:"esgst-form-heading"},type:"div",children:[{attributes:{class:"esgst-form-heading-number"},text:s+".",type:"div"},{attributes:{class:"icon_to_clipboard fa fa-fw fa-copy","data-clipboard-text":"https://www.steamgifts.com/account/settings/profile?esgst=settings&id="+a},type:"i"},{attributes:{class:"esgst-form-heading-text"},type:"div",children:[{text:n,type:"span"}]}]},{attributes:{class:"esgst-form-row-indent"},type:"div",children:t}]}]);if(d.get("makeSectionsCollapsible")&&!n.match(/Backup|Restore|Delete/)){let e,t,s;e=c.common.createElements(i.firstElementChild,"afterbegin",[{attributes:{class:"esgst-clickable",style:"margin-right: 5px;"},type:"span",children:[{attributes:{class:`fa fa-${d.get("collapse_"+a)?"plus":"minus"}-square`,title:(d.get("collapse_"+a)?"Expand":"Collapse")+" section"},type:"i"}]}]),t=i.lastElementChild,d.get("collapse_"+a)?(t.classList.add("esgst-hidden"),s=!1):s=!0,this.collapseButtons.push({collapseButton:e,id:a,subMenu:t}),e.addEventListener("click",()=>s=this.collapseOrExpandSection(e,a,t,s))}return i}collapseOrExpandSection(e,t,s,n){return n?this.collapseSection(e,t,s):this.expandSection(e,t,s),!n}collapseSection(e,t,s){s.classList.add("esgst-hidden"),e&&(c.common.createElements(e,"atinner",[{attributes:{class:"fa fa-plus-square",title:"Expand section"},type:"i"}]),this.preSave("collapse_"+t,!0))}expandSection(e,t,s){s.classList.remove("esgst-hidden"),e&&(c.common.createElements(e,"atinner",[{attributes:{class:"fa fa-minus-square",title:"Collapse section"},type:"i"}]),this.preSave("collapse_"+t,null))}filterSm(e){let t,s,n,a,i,o,r,l;for(o in l=e.currentTarget.value.toLowerCase().trim().replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),c.esgst.features)if(c.esgst.features.hasOwnProperty(o)){for(i in a=!1,r=!1,c.esgst.features[o].features)c.esgst.features[o].features.hasOwnProperty(i)&&(this.unfadeSmFeatures(c.esgst.features[o].features[i],i),a=this.filterSmFeature(c.esgst.features[o].features[i],i,l),a&&(r=!0,this.unhideSmFeature(c.esgst.features[o].features[i],i)));s=document.getElementById("esgst_"+o),s&&(r?s.classList.remove("esgst-hidden"):s.classList.add("esgst-hidden"),l?(n=s.getElementsByClassName("fa-plus-square")[0],n&&n.click()):(t=s.getElementsByClassName("fa-minus-square")[0],t&&t.click()))}for(o of["element_ordering","steam_api_key"])s=document.getElementById("esgst_"+o),s&&(s.textContent.toLowerCase().trim().match(l)?s.classList.remove("esgst-hidden"):s.classList.add("esgst-hidden"),l?(n=s.getElementsByClassName("fa-plus-square")[0],n&&n.click()):(t=s.getElementsByClassName("fa-minus-square")[0],t&&t.click()))}unfadeSmFeatures(e,t){let s=document.getElementById("esgst_"+t);if(s&&s.classList.remove("esgst-sm-faded"),e.features)for(t in e.features)e.features.hasOwnProperty(t)&&this.unfadeSmFeatures(e.features[t],t)}filterSmFeature(e,t,s){let n=!s||e.name.toLowerCase().match(s)||"\\[new\\]"===s&&e.isNew,a=n;if((!s||!n)&&(n||(a=n=(e.description?e.description().textContent:"").toLowerCase().match(s)),(!s||!n)&&e.features))for(const t in e.features)e.features.hasOwnProperty(t)&&(n=this.filterSmFeature(e.features[t],t,s)||n);let i=document.getElementById("esgst_"+t);return i&&(n?i.classList.remove("esgst-hidden"):i.classList.add("esgst-hidden"),a?i.classList.remove("esgst-sm-faded"):i.classList.add("esgst-sm-faded")),n}unhideSmFeature(e,t){let s=document.getElementById("esgst_"+t);if(s&&s.classList.remove("esgst-hidden"),e.features)for(t in e.features)e.features.hasOwnProperty(t)&&this.unhideSmFeature(e.features[t],t)}enableDependencies(e,t){for(const s of e){const e=c.esgst.featuresById[s];e&&e[t+"Switch"]&&e[t+"Switch"].enable()}}addCombos(){}replaceFeatureNamePlaceholders(e){const t=e.querySelectorAll("[data-esgst-feature-id]");for(const e of t)e.textContent=c.common.getFeatureName(null,e.dataset.esgstFeatureId)}};class Ot{constructor(e){o()(this,"namespace",void 0),o()(this,"nodes",Ot.getDefaultNodes()),o()(this,"data",Ot.getDefaultData()),o()(this,"built",!1),o()(this,"getError",e=>new Error(`${this.constructor.name}: ${e}`)),o()(this,"insert",(e,t)=>{if(this.nodes.outer||this.build(),!this.nodes.outer)throw this.getError("failed to insert");return Se.insert(e,t,this.nodes.outer),this}),o()(this,"destroy",()=>{if(!this.nodes.outer)throw this.getError("failed to destroy");return this.nodes.outer.remove(),this.nodes.outer=null,this.built=!1,this.reset(),this}),o()(this,"hide",()=>{if(!this.nodes.outer)throw this.getError("failed to hide");return this.nodes.outer.classList.add(Ge[this.namespace].hidden),this.data.hidden=!0,this}),o()(this,"show",()=>{if(!this.nodes.outer)throw this.getError("failed to show");return this.nodes.outer.classList.remove(Ge[this.namespace].hidden),this.data.hidden=!1,this}),o()(this,"toggleHidden",e=>{if(!this.nodes.outer)throw this.getError("failed to show");return this.nodes.outer.classList.toggle(Ge[this.namespace].hidden,this.data.hidden),this.data.hidden=e,this}),this.namespace=e}static getError(e){return new Error(`${this.name}: ${e}`)}static getDefaultNodes(){return{outer:null}}static getDefaultData(){return{hidden:!1}}}var Ut;class Ft extends Ot{constructor(e){super(e),o()(this,"parse",e=>(this.parseNodes(e),this.parseData(),this.parseExtraData(),this)),o()(this,"parseNodes",e=>this),o()(this,"build",()=>this),o()(this,"reset",()=>{const e=this.nodes.outer;return this.nodes=Ft.getDefaultNodes(),this.data=Ft.getDefaultData(),e&&(this.nodes.outer=e,this.built=!1,this.build()),this}),this.nodes=Ft.getDefaultNodes(),this.data=Ft.getDefaultData()}}Ut=Ft,o()(Ft,"getDefaultNodes",()=>({...Ot.getDefaultNodes(),usernameOuter:null,usernameInner:null,role:null,patreon:null,reputation:null,positiveReputation:null,negativeReputation:null,avatarOuter:null,avatarInner:null})),o()(Ft,"getDefaultData",()=>({...Ot.getDefaultData(),...Ut.getDefaultBaseData(),...Ut.getDefaultExtraData()})),o()(Ft,"getDefaultBaseData",()=>({id:null,steamId:null,username:null,op:null,roleId:null,roleName:null,patron:null,positiveReputation:null,negativeReputation:null,avatar:null})),o()(Ft,"getDefaultExtraData",()=>({url:null})),o()(Ft,"create",(e=Be.namespace)=>{switch(e){case Pe:return new $t;case Le:return new Wt;default:return null}}),o()(Ft,"extractUser",e=>e.slice(6)||null),o()(Ft,"extractAvatar",e=>e.slice(5,-2)||null);class $t extends Ft{constructor(){super(Pe),o()(this,"parseData",()=>{var e,t,s,n;const a=this.nodes,i=Ft.getDefaultData(),o=(null===(e=a.usernameInner)||void 0===e?void 0:e.getAttribute("href"))||(null===(t=a.avatarOuter)||void 0===t?void 0:t.getAttribute("href"));var r;(o&&(i.username=Ft.extractUser(o)),a.usernameOuter&&(i.op=a.usernameOuter.classList.contains("comment__username--op")),a.role)&&(i.roleId=(null===(r=a.role.getAttribute("href"))||void 0===r?void 0:r.slice(7))||null,i.roleName=a.role.textContent.trim().slice(1,-1)||null);i.patron=!!a.patreon;const l=(null===(s=a.avatarOuter)||void 0===s?void 0:s.style.backgroundImage)||(null===(n=a.avatarInner)||void 0===n?void 0:n.style.backgroundImage);return l&&(i.avatar=Ft.extractAvatar(l)),this.data=i,this}),o()(this,"parseExtraData",()=>{const e=this.data;return e.username&&(e.url="/user/"+e.username),this})}}class Wt extends Ft{constructor(){super(Le),o()(this,"parseData",()=>{var e,t,s,n;const a=this.nodes,i=Ft.getDefaultData(),o=(null===(e=a.usernameInner)||void 0===e?void 0:e.getAttribute("href"))||(null===(t=a.avatarOuter)||void 0===t?void 0:t.getAttribute("href"));o&&(i.steamId=Ft.extractUser(o)),a.usernameOuter&&(i.username=a.usernameOuter.textContent.trim()||null,i.op=a.usernameOuter.classList.contains("is_op")),a.reputation&&a.positiveReputation&&a.negativeReputation&&(i.positiveReputation=parseInt(a.positiveReputation.textContent.slice(1).replace(",","")),i.negativeReputation=parseInt(a.negativeReputation.textContent.slice(1).replace(",","")));const r=(null===(s=a.avatarOuter)||void 0===s?void 0:s.style.backgroundImage)||(null===(n=a.avatarInner)||void 0===n?void 0:n.style.backgroundImage);return r&&(i.avatar=Ft.extractAvatar(r)),this.data=i,this}),o()(this,"parseExtraData",()=>{const e=this.data;return e.steamId&&(e.url="/user/"+e.steamId),this})}}class Vt{constructor(){this.nodes={inner:null,leftNav:null,nav:null,outer:null,rightNav:null},this.buttonContainers={}}async updateCounter(e,t,s){}async updatePoints(e){}async updateLevel(e){}async updateReputation(e){}static extractCounter(e){return parseInt(e.replace(/,/g,""))}static extractLevel(e){const t=parseFloat(e.replace(/[^\d.]/g,""));return{base:Math.trunc(t),full:t}}static extractPoints(e){return parseInt(e.replace(/,/g,"").match(/\d+/)[0])}static extractReputation(e){const t=e.match(/\(\+(.+?)\/-(.+?)\)/);return{positive:parseInt(t[1].replace(/,/g,"")),negative:parseInt(t[2].replace(/,/g,""))}}static generateId(e){return e.replace(/[^A-Za-z\s].*/,"").trim().split(" ").filter(e=>e).map(e=>`${e[0].toUpperCase()}${e.slice(1).toLowerCase()}`).join("").replace(/^(.)/,(e,t)=>t.toLowerCase())}}class jt extends Vt{constructor(){super()}addButtonContainer(e){const[t,s]=e.context?[e.context,e.position]:"left"===e.side?[this.nodes.leftNav,"beforeend"]:[this.nodes.rightNav,"afterbegin"];let n=null;e.isDropdown?Se.insert(t,s,Se.element("div",{className:"nav__button-container",ref:e=>n=e},Se.element("div",{className:"nav__relative-dropdown is-hidden"},Se.element("div",{className:"nav__absolute-dropdown"})),Se.element("a",{className:"nav__button nav__button--is-dropdown",href:e.url||null,onclick:e.onClick,target:e.openInNewTab?"_blank":null},e.buttonIcon?Se.element("i",{className:e.buttonIcon}):null,e.buttonImage?Se.element("img",{src:e.buttonImage}):null,e.buttonName),Se.element("div",{className:"nav__button nav__button--is-dropdown-arrow"},Se.element("i",{className:"fa fa-angle-down"})))):e.isNotification?Se.insert(t,s,Se.element("div",{className:"nav__button-container nav__button-container--notification "+(e.isActive?"nav__button-container--active":"nav__button-container--inactive"),ref:e=>n=e},Se.element("a",{className:"nav__button",href:e.url||null,target:e.openInNewTab?"_blank":null,title:e.buttonName},e.buttonIcon?Se.element("i",{className:e.buttonIcon}):null,e.buttonImage?Se.element("img",{src:e.buttonImage}):null,e.isActive&&e.counter?Se.element("div",{className:"nav__notification "+(e.isFlashing?"fade_infinite":"")},e.counter.toLocaleString("en-US")):null))):Se.insert(t,s,Se.element("div",{className:"nav__button-container",ref:e=>n=e},Se.element("a",{className:"nav__button",href:e.url||null,target:e.openInNewTab?"_blank":null},e.buttonName)));const a=this.parseButtonContainer(n);for(const t in e.dropdownItems){const s=e.dropdownItems[t];s.buttonContainerId=a.data.id,this.addDropdownItem(s)}return a}addDropdownItem(e){const t=this.buttonContainers[e.buttonContainerId];if(!t)throw"Invalid button container id.";if(!t.data.isDropdown)throw"Button container is not dropdown.";let s;const n={className:"nav__row "+(e.url?"":"is-clickable"),href:e.url||null,onclick:e.onClick,target:e.openInNewTab?"_blank":null,ref:e=>s=e},a=Se.element("fragment",null,Se.element("i",{className:e.icon}),Se.element("div",{className:"nav__row__summary"},Se.element("p",{className:"nav__row__summary__name"},e.name),Se.element("p",{className:"nav__row__summary__description"},e.description)));return Se.insert(t.nodes.absoluteDropdown,"beforeend",e.url?Se.element("a",n,a):Se.element("div",n,a)),this.parseDropdownItem(t.dropdownItems,s)}parse(e){const t=e.querySelector("header");if(!t)throw"No header present.";if(t.dataset.esgstParsed)throw"Header already parsed.";this.nodes.outer=t,this.nodes.inner=this.nodes.outer,this.nodes.nav=this.nodes.inner.querySelector("nav"),this.nodes.leftNav=this.nodes.nav.querySelector(".nav__left-container"),this.nodes.rightNav=this.nodes.nav.querySelector(".nav__right-container");const s=Array.from(this.nodes.nav.querySelectorAll(".nav__button-container"));for(const e of s)this.parseButtonContainer(e);this.buttonContainers.account&&Be.namespace===Pe&&(Be.isLoggedIn=!0,Be.xsrfToken=Ie.extractXsrfToken(this.buttonContainers.account.dropdownItems.logout.nodes.outer.dataset.form)),this.nodes.outer.dataset.esgstParsed="true"}parseButtonContainer(e){const t={nodes:{outer:e},data:{id:"",buttonName:"",counter:0,isFlashing:!1,level:{base:0,full:0},points:0,reputation:{positive:0,negative:0}}},s=t.nodes.outer.querySelector(".nav__relative-dropdown");if(s){t.nodes.relativeDropdown=s,t.nodes.absoluteDropdown=t.nodes.relativeDropdown.querySelector(".nav__absolute-dropdown"),t.dropdownItems={};const e=t.nodes.absoluteDropdown.querySelectorAll(".nav__row:not(.category):not(.sg-info-row)");for(const s of e)this.parseDropdownItem(t.dropdownItems,s);t.nodes.button=t.nodes.outer.querySelector(".nav__button--is-dropdown"),t.nodes.arrow=t.nodes.outer.querySelector(".nav__button--is-dropdown-arrow"),t.nodes.arrowIcon=t.nodes.arrow.querySelector(".fa");const n=t.nodes.button.querySelector(".nav__points");n&&(t.nodes.points=n,t.data.points=Vt.extractPoints(t.nodes.points.textContent),Be.namespace===Pe&&(Be.counters.points=t.data.points));const a=t.nodes.button.querySelector("[title]");a&&(t.nodes.level=a,t.data.level=Vt.extractLevel(t.nodes.level.title),Be.namespace===Pe&&(Be.counters.level=t.data.level)),t.data.isDropdown=!0}else{const e=t.nodes.outer.querySelector(".nav__button");if(e)t.nodes.button=e;else{t.data.buttonName="Avatar";const e=Ft.create(Pe);e.nodes.outer=t.nodes.outer,e.nodes.avatarOuter=e.nodes.outer.querySelector(".nav__avatar-outer-wrap"),e.nodes.avatarInner=e.nodes.avatarOuter.querySelector(".nav__avatar-inner-wrap"),e.parseData(),e.parseExtraData(),t.user=e,Be.namespace===Pe&&(Be.user=Object.assign({},t.user.data))}}if(t.nodes.button){t.nodes.buttonName=t.nodes.button;const e=t.nodes.button.querySelector(".fa");e&&(t.nodes.buttonIcon=e,t.data.buttonIcon=t.nodes.buttonIcon.className);const s=t.nodes.button.querySelector("img");s&&(t.nodes.buttonImage=s,t.data.buttonImage=t.nodes.buttonImage.className),t.data.url=t.nodes.button.getAttribute("href"),t.data.buttonName=t.nodes.buttonName.title||t.nodes.buttonName.textContent.trim()}if(t.nodes.outer.classList.contains("nav__button-container--notification")&&(t.nodes.counter=t.nodes.outer.querySelector(".nav__notification"),t.nodes.counter&&(t.data.counter=Vt.extractCounter(t.nodes.counter.textContent),t.data.isFlashing=t.nodes.counter.classList.contains("fade_infinite")),t.data.isActive=t.nodes.outer.classList.contains("nav__button-container--active"),t.data.isNotification=!0),t.data.id=Vt.generateId(t.data.buttonName),Be.namespace===Pe)switch(t.data.id){case"giveawaysCreated":Be.counters.created=t.data.counter;break;case"giveawaysWon":Be.counters.won=t.data.counter,Be.counters.wonDelivered=t.data.isFlashing;break;case"messages":Be.counters.messages=t.data.counter}return this.buttonContainers[t.data.id]=t,t}parseDropdownItem(e,t){const s={nodes:{outer:t,icon:null,name:null},data:{id:"",icon:"",name:"",url:""}};return s.nodes.icon=s.nodes.outer.querySelector(".fa"),s.nodes.summary=s.nodes.outer.querySelector(".nav__row__summary"),s.nodes.name=s.nodes.summary.querySelector(".nav__row__summary__name"),s.nodes.description=s.nodes.summary.querySelector(".nav__row__summary__description"),s.data.url=s.nodes.outer.getAttribute("href")||"",s.data.icon=s.nodes.icon.className,s.data.name=s.nodes.name.textContent.trim(),s.data.description=s.nodes.description.textContent.trim(),s.data.id=Vt.generateId(s.data.name),e[s.data.id]=s,s}async updateCounter(e,t,s){const n=this.buttonContainers[e];if(!n)throw"Invalid button container id.";n.nodes.counter||Se.insert(n.nodes.outer,"beforeend",Se.element("div",{className:"nav__notification",ref:e=>n.nodes.counter=e}));const a=n.data.counter;if(a!==t||s!==n.data.isFlashing)switch(t?(n.nodes.outer.classList.remove("nav__button-container--inactive"),n.nodes.outer.classList.add("nav__button-container--active"),n.nodes.counter.classList.remove("is-hidden"),n.nodes.counter.textContent=t.toLocaleString("en-US")):(n.nodes.outer.classList.remove("nav__button-container--active"),n.nodes.outer.classList.add("nav__button-container--inactive"),n.nodes.counter.classList.add("is-hidden"),n.nodes.counter.textContent=""),s?n.nodes.counter.classList.add("fade_infinite"):n.nodes.counter.classList.remove("fade_infinite"),n.data.counter=t,n.data.isFlashing=s,e){case"giveawaysCreated":Be.counters.created=t,await Ee.dispatch(qe,a,t);break;case"giveawaysWon":Be.counters.won=t,Be.counters.wonDelivered=s,await Ee.dispatch(Re,a,t,s);break;case"messages":Be.counters.messages=t,await Ee.dispatch(Me,a,t)}}async updatePoints(e){const t=this.buttonContainers.account;if(!t||!t.nodes.points)return;const s=t.data.points;"string"==typeof e&&(e=parseInt(e.replace(/,/g,""))),s!==e&&(t.nodes.points.textContent=e.toLocaleString("en-US"),t.data.points=e,Be.counters.points=e,await Ee.dispatch(Oe,s,e))}async updateLevel(e){const t=this.buttonContainers.account;if(!t||!t.nodes.level)return;const s=t.data.level;s.full!==e.full&&(t.nodes.level.textContent="Level "+e.base,t.nodes.level.title=e.full,t.data.level=e,Be.counters.level=e,await Ee.dispatch(Ue,s,e))}}class Ht extends Vt{constructor(){super()}addButtonContainer(e){const[t,s]=e.context?[e.context,e.position]:[this.nodes.rightNav,"afterbegin"];let n=null;e.isDropdown?Se.insert(t,s,Se.element("div",{className:"nav_btn_container",ref:e=>n=e},Se.element("div",{className:"dropdown is_hidden"},Se.element("div",null)),Se.element("a",{className:"nav_btn nav_btn_left",href:e.url||null,onclick:e.onClick,target:e.openInNewTab?"_blank":null},e.buttonIcon?Se.element("i",{className:e.buttonIcon}):null,e.buttonImage?Se.element("img",{src:e.buttonImage}):null,Se.element("span",null,e.buttonName,e.isNotification&&e.counter?Se.element("span",{className:"message_count"},e.counter.toLocaleString("en-US")):null)),Se.element("div",{className:"nav_btn nav_btn_right nav_btn_dropdown"},Se.element("i",{className:"fa fa-angle-down"})))):e.isNotification?Se.insert(t,s,Se.element("div",{className:"nav_btn_container",ref:e=>n=e},Se.element("a",{className:"nav_btn",href:e.url||null,target:e.openInNewTab?"_blank":null},e.buttonIcon?Se.element("i",{className:e.buttonIcon}):null,e.buttonImage?Se.element("img",{src:e.buttonImage}):null,e.counter?Se.element("span",null,Se.element("span",{className:"message_count"},e.counter.toLocaleString("en-US"))):null))):Se.insert(t,s,Se.element("div",{className:"nav_btn_container",ref:e=>n=e},Se.element("a",{className:"nav_btn",href:e.url||null,target:e.openInNewTab?"_blank":null},e.buttonIcon?Se.element("i",{className:e.buttonIcon}):null,e.buttonImage?Se.element("img",{src:e.buttonImage}):null,Se.element("span",null,e.buttonName,e.isNotification&&e.counter?Se.element("span",{className:"message_count"},e.counter.toLocaleString("en-US")):null))));const a=this.parseButtonContainer(n);for(const t in e.dropdownItems){const s=e.dropdownItems[t];s.buttonContainerId=a.data.id,this.addDropdownItem(s)}return a}addDropdownItem(e){const t=this.buttonContainers[e.buttonContainerId];if(!t)throw"Invalid button container id.";if(!t.data.isDropdown)throw"Button container is not dropdown.";let s;const n={className:"dropdown_btn",href:e.url||null,onclick:e.onClick,target:e.openInNewTab?"_blank":null,ref:e=>s=e},a=Se.element("fragment",null,Se.element("i",{className:e.icon}),Se.element("span",null,e.name));return Se.insert(t.nodes.absoluteDropdown,"beforeend",e.url?Se.element("a",n,a):Se.element("div",n,a)),this.parseDropdownItem(t.dropdownItems,s)}parse(e){const t=e.querySelector("header");if(!t)throw"No header present.";if(t.dataset.esgstParsed)throw"Header already parsed.";this.nodes.outer=t,this.nodes.inner=this.nodes.outer.querySelector(".header_inner_wrap"),this.nodes.nav=this.nodes.inner.querySelector("nav"),this.nodes.leftNav=this.nodes.nav.querySelector(".nav_btns"),this.nodes.rightNav=this.nodes.leftNav,this.nodes.logo=this.nodes.nav.querySelector(".nav_logo");const s=Array.from(this.nodes.nav.querySelectorAll(".nav_btn_container, .nav_avatar"));for(const e of s)this.parseButtonContainer(e);this.buttonContainers.myProfile&&Be.namespace===Le&&(Be.isLoggedIn=!0,Be.xsrfToken=Ie.extractXsrfToken(this.buttonContainers.myProfile.dropdownItems.logout.nodes.outer.dataset.form)),this.nodes.outer.dataset.esgstParsed="true"}parseButtonContainer(e){const t={nodes:{outer:e},data:{id:"",buttonName:"",counter:0,isFlashing:!1,level:{base:0,full:0},points:0,reputation:{positive:0,negative:0}}},s=t.nodes.outer.querySelector(".dropdown");if(s){t.nodes.relativeDropdown=s,t.nodes.absoluteDropdown=t.nodes.relativeDropdown.querySelector(":scope > div"),t.dropdownItems={};const e=t.nodes.absoluteDropdown.querySelectorAll(".dropdown_btn");for(const s of e)this.parseDropdownItem(t.dropdownItems,s);t.nodes.button=t.nodes.outer.querySelector(".nav_btn_left"),t.nodes.arrow=t.nodes.outer.querySelector(".nav_btn_right"),t.nodes.arrowIcon=t.nodes.arrow.querySelector(".fa");const n=t.nodes.button.querySelector(".is_faded");n&&(t.nodes.reputation=n,t.data.reputation=Vt.extractReputation(t.nodes.reputation.textContent),Be.namespace===Le&&(Be.counters.reputation=t.data.reputation)),t.data.isDropdown=!0}else{const e=t.nodes.outer.querySelector(".nav_btn");if(e)t.nodes.button=e;else{t.data.buttonName="Avatar";const e=Ft.create(Le);e.nodes.outer=t.nodes.outer,e.nodes.avatarOuter=e.nodes.outer,e.parseData(),e.parseExtraData(),t.user=e,Be.namespace===Le&&(Be.user=Object.assign({},t.user.data))}}if(t.nodes.button){t.nodes.buttonName=!t.data.isDropdown&&t.nodes.button.querySelector("span")||t.nodes.button;const e=t.nodes.button.querySelector(".fa");e&&(t.nodes.buttonIcon=e,t.data.buttonIcon=t.nodes.buttonIcon.className);const s=t.nodes.button.querySelector("img");s&&(t.nodes.buttonImage=s,t.data.buttonImage=t.nodes.buttonImage.className);const n=t.nodes.buttonName.querySelector(".message_count");n&&(t.nodes.counter=n,t.nodes.counter&&(t.data.counter=Vt.extractCounter(t.nodes.counter.textContent)),t.data.isNotification=!0),t.data.url=t.nodes.button.getAttribute("href"),t.data.buttonName=t.nodes.buttonName.title||t.nodes.buttonName.textContent.trim()}if(t.data.id=Vt.generateId(t.data.buttonName),Be.namespace===Le)switch(t.data.id){case"messages":Be.counters.messages=t.data.counter}return this.buttonContainers[t.data.id]=t,t}parseDropdownItem(e,t){const s={nodes:{outer:t,icon:null,name:null},data:{id:"",icon:"",name:"",url:""}};return s.nodes.icon=s.nodes.outer.querySelector(".fa"),s.nodes.name=s.nodes.outer.querySelector("span"),s.data.url=s.nodes.outer.getAttribute("href")||"",s.data.icon=s.nodes.icon.className,s.data.name=s.nodes.name.textContent.trim(),s.data.id=Vt.generateId(s.data.name),e[s.data.id]=s,s}async updateCounter(e,t){const s=this.buttonContainers[e];if(!s)throw"Invalid button container id.";s.nodes.counter||Se.insert(s.nodes.buttonName,"beforeend",Se.element("span",{className:"message_count",ref:e=>s.nodes.counter=e})),t?(s.nodes.counter.classList.remove("is_hidden"),s.nodes.counter.textContent=t.toLocaleString("en-US")):(s.nodes.counter.classList.add("is_hidden"),s.nodes.counter.textContent="");const n=s.data.counter;if(n!==t)switch(s.data.counter=t,e){case"messages":Be.counters.messages=t,await Ee.dispatch(Me,n,t)}}async updateReputation(e){const t=this.buttonContainers.myProfile;if(!t)return;const s=t.nodes.reputation;if(!s||s.textContent===e)return;const n=Be.counters.reputation;s.textContent=e,Be.counters.reputation=Vt.extractReputation(e);const a=Be.counters.reputation;await Ee.dispatch($e,n,a)}}function Jt(e=Be.namespace){switch(e){case Pe:return new jt;case Le:return new Ht;default:throw"Invalid namespace."}}const Yt=new class extends gt{constructor(){super(),this.info={description:()=>Se.element("ul",null,Se.element("li",null,"Allows you to add custom links to the header dropdowns/footer of any page."),Se.element("li",null,"Already comes with some predefined links:"),Se.element("ul",null,Se.element("li",null,"Giveaways: Hidden Games, Reduced CV Games, Browse Wishlist, Browse Recommended, Browse Group, Browse New"),Se.element("li",null,"Discussions: Categorize Discussions, Browse Announcements, Browse Bugs / Suggestions, Browse Deals, Browse General, Browse Group Recruitment, Browse Let's Play Together, Browse Off-Topic, Browse Puzzles, Browse Uncategorized"),Se.element("li",null,"Support: Real CV, Not Activated Wins, Multiple Wins"),Se.element("li",null,"Help: Change Log"),Se.element("li",null,"Account: Whitelist, Blacklist, Games, Groups, Wishlist")),Se.element("li",null,'If you press the Ctrl key with a dropdown open, the feature adds two buttons ("',Se.element("i",{className:"fa fa-plus-circle"}),' Add Custom Link" and "',Se.element("i",{className:"fa fa-undo"}),' Reset Links") to the end of the dropdown that allow you to add/reset the custom links. It also adds two other buttons (',Se.element("i",{className:"fa fa-edit"})," to edit and ",Se.element("i",{className:"fa fa-trash"})," to remove) to each custom link in the dropdown that allow you to edit/remove the custom link."),Se.element("li",null,"If you press the Ctrl key with no dropdown open, those same buttons will be added to the footer of the page."),Se.element("li",null,"You can move the custom links by dragging and dropping them.")),inputItems:"chfl_key",id:"chfl",name:"Custom Header/Footer Links",sg:!0,st:!0,type:"general"},this.newIds={giveaways:{new:"createANewGiveaway",wishlist:"communityWishlist",created:"viewCreated",entered:"viewEntered",won:"viewWon"},discussions:{new:"createANewDiscussion",created:"viewCreated",bookmarked:"viewBookmarked"},support:{new:"createANewTicket"},help:{"comment-formatting":"commentFormatting",faq:"faq",guidelines:"guidelines"},account:{profile:"syncWithSteam",stats:"myStats",et:"myEntryHistory",ch:"myCommentHistory","user=[steamId]":"reviews"},footer:{archive:"archive",stats:"stats",roles:"roles",users:"users",steamgifts:"steamGroup",103582791432125620:"chat","privacy-policy":"privacyPolicy","cookie-policy":"cookiePolicy","terms-of-service":"termsOfService",advertising:"advertise",guidelines:"guidelines","comment-formatting":"commentFormatting"},trades:{new:"newTrade","user=[steamId]":"myTrades"},myProfile:{"user=[steamId]":"reviews"}}}init(){this.esgst.sg?this.sources={giveaways:"giveaways",discussions:"discussions",support:"support",help:"help",account:"account",footer:"footer"}:this.sources={trades:"trades",account:"myProfile",footer:"footer"};for(const e of Object.keys(this.sources)){const t=this.sources[e],s="footer"===e?c.footer.linkContainers:c.header.buttonContainers[t].dropdownItems;for(const t of Object.keys(s)){const n=s[t];if(n.nodes.outer.dataset.linkId)continue;if(!n.data.url||n.data.url.match(/^javascript/)||"Steam"===n.data.name&&"footer"===e)continue;const a=Vt.generateId(n.data.name);n.nodes.outer.dataset.linkId=a,n.nodes.outer.dataset.linkKey=e}this.reorder(e,!0)}this.esgst.documentEvents.keydown.add(this.checkKey.bind(this))}reorder(e,t){try{const s=[],n=this.sources[e],a=d.get("chfl_"+e);for(let i=a.length-1;i>-1;i--){const o=a[i];if(o.id){let a="footer"===e?c.footer.linkContainers[o.id]:c.header.buttonContainers[n].dropdownItems[o.id];a&&!t||("footer"===e?(a&&a.nodes.outer.dataset.linkId&&(a.nodes.outer.remove(),delete c.footer.linkContainers[o.id]),a=c.footer.addLinkContainer({icon:"fa "+o.icon,name:o.name,side:"right",url:o.url}),a.nodes.outer.dataset.linkId=o.id,a.nodes.outer.dataset.linkKey=e,a.nodes.outer.title=c.common.getFeatureTooltip("chfl")):(a&&a.nodes.outer.dataset.linkId&&(a.nodes.outer.remove(),delete c.header.buttonContainers[n].dropdownItems[o.id]),a=c.header.addDropdownItem({buttonContainerId:n,description:o.description,icon:`fa fa-fw ${o.icon} ${o.color} icon-${o.color}`,name:o.name,url:o.url}),a.nodes.outer.dataset.linkId=o.id,a.nodes.outer.dataset.linkKey=e,a.nodes.outer.title=c.common.getFeatureTooltip("chfl"),o.description||a.nodes.outer.classList.add("esgst-chfl-small"),o.compact&&a.nodes.outer.classList.add("esgst-chfl-compact"))),a.nodes.outer.parentElement.insertBefore(a.nodes.outer,a.nodes.outer.parentElement.firstElementChild),this.makeDraggable(a.nodes.outer),s.push(o.id)}else{const t="footer"===e?c.footer.linkContainers[o]:c.header.buttonContainers[n].dropdownItems[o];t&&(t.nodes.outer.parentElement.insertBefore(t.nodes.outer,t.nodes.outer.parentElement.firstElementChild),this.makeDraggable(t.nodes.outer)),s.push(o)}}const i="footer"===e?c.footer.linkContainers:c.header.buttonContainers[n].dropdownItems;for(const t of Object.keys(i)){const a=i[t];!a.nodes.outer.dataset.linkId||s.indexOf(a.nodes.outer.dataset.linkId)>-1||(a.nodes.outer.remove(),"footer"===e?delete c.footer.linkContainers[t]:delete c.header.buttonContainers[n].dropdownItems[t])}t||(this.removeButton(e),this.addButton(null,e))}catch(e){dt.error(e.message)}}makeDraggable(e){e.setAttribute("draggable",!0),e.addEventListener("dragstart",this.startDrag.bind(this)),e.addEventListener("dragenter",this.enterDrag.bind(this)),e.addEventListener("dragend",this.saveOrder.bind(this))}startDrag(e){e.dataTransfer.setData("text/plain",""),this.source=e.currentTarget}enterDrag(e){let t=this.source,s=e.currentTarget;if(t.dataset.linkKey===s.dataset.linkKey){do{if(t=t.previousElementSibling,t&&t===s)return void s.parentElement.insertBefore(this.source,s)}while(t);s.parentElement.insertBefore(this.source,s.nextElementSibling)}}saveOrder(){const e=[];for(let t of Object.keys(this.sources)){const s={};for(const e of d.get("chfl_"+t))e.id&&(s[e.id]=e);const n=[],a=this.sources[t],i="footer"===t?c.footer.nodes.rightNav:c.header.buttonContainers[a].nodes.absoluteDropdown;for(const e of i.children){const t=e.dataset.linkId;t&&n.push(s[t]||t)}e.push({id:`chfl_${t}_${this.esgst.name}`,value:n})}c.common.setSetting(e)}removeButton(e){for(const t of Object.keys(this.sources)){const s=this.sources[t],n="footer"===t?c.footer.nodes.outer:c.header.buttonContainers[s].nodes.relativeDropdown;if(t!==e&&(n.classList.contains("is-hidden")||n.classList.contains("is_hidden")))continue;let a=!1;const i=n.querySelectorAll(".esgst-chfl-panel");for(let e=i.length-1;e>-1;e--)i[e].remove(),a=!0;return"footer"===t?c.footer.linkContainers.addCustomLink&&(c.footer.linkContainers.addCustomLink.nodes.outer.remove(),delete c.footer.linkContainers.addCustomLink,c.footer.linkContainers.resetLinks.nodes.outer.remove(),delete c.footer.linkContainers.resetLinks):c.header.buttonContainers[s].dropdownItems.addCustomLink&&(c.header.buttonContainers[s].dropdownItems.addCustomLink.nodes.outer.remove(),delete c.header.buttonContainers[s].dropdownItems.addCustomLink,c.header.buttonContainers[s].dropdownItems.resetLinks.nodes.outer.remove(),delete c.header.buttonContainers[s].dropdownItems.resetLinks),a?t:null}}addButton(e,t){for(const s of Object.keys(this.sources)){if(s===e)return;const n=this.sources[s],a="footer"===s?c.footer.nodes.outer:c.header.buttonContainers[n].nodes.relativeDropdown;if(s!==t&&(a.classList.contains("is-hidden")||a.classList.contains("is_hidden")))continue;const i="footer"===s?c.footer.linkContainers:c.header.buttonContainers[n].dropdownItems;for(const e of Object.keys(i)){const t=i[e];if(!t.nodes.outer.dataset.linkId)continue;let n;Se.insert(t.nodes.outer,"beforeend",Se.element("div",{className:"esgst-chfl-panel",ref:e=>n=e},Se.element("i",{className:"esgst-chfl-edit-button fa fa-edit grey icon-grey"}),Se.element("i",{className:"esgst-chfl-remove-button fa fa-trash grey icon-grey"}))),n.firstElementChild.addEventListener("click",this.openPopup.bind(this,t,s)),n.lastElementChild.addEventListener("click",this.removeLink.bind(this,t,s))}let o,r;return o="footer"===s?c.footer.addLinkContainer({icon:"fa fa-plus",name:"Add Custom Link",position:"beforeend",side:"right",url:"#"}):c.header.addDropdownItem({buttonContainerId:n,description:"Click here to add a custom link.",icon:"fa fa-plus-circle grey icon-grey",name:"Add Custom Link"}),o.nodes.outer.classList.add("esgst-chfl-button"),o.nodes.outer.addEventListener("click",this.openPopup.bind(this,null,s)),r="footer"===s?c.footer.addLinkContainer({icon:"fa fa-undo",name:"Reset Links",position:"beforeend",side:"right",url:"#"}):c.header.addDropdownItem({buttonContainerId:n,description:"Click here to reset the custom links.",icon:"fa fa-undo grey icon-grey",name:"Reset Links"}),r.nodes.outer.classList.add("esgst-chfl-button"),void r.nodes.outer.addEventListener("click",c.common.createConfirmation.bind(c.common,"Are you sure you want to reset the links? Any custom links you added will be deleted.",this.resetLinks.bind(this,s),null))}}openPopup(e,t,s){try{s.preventDefault();let i=new lt({addScrollable:!0,icon:e?"fa-edit":"fa-plus",isTemp:!0,title:(e?"Edit":"Add")+" Custom Link"}),o=c.common.createElements(i.description,"beforeend",[{type:"div",children:[{text:"URL:",type:"span"},{attributes:{class:"fa fa-question-circle",title:'Instead of entering "https://www.steamgifts.com/url", you can simply enter "/url".'},type:"i"},{attributes:{class:"esgst-switch-input esgst-switch-input-large",type:"text"},type:"input"}]},{type:"div",children:[{text:"Color:",type:"span"},{attributes:{class:"esgst-switch-input esgst-switch-input-large"},type:"select",children:[{attributes:{value:"grey"},text:"Grey (Default)",type:"option"},{attributes:{value:"blue"},text:"Blue",type:"option"},{attributes:{value:"green"},text:"Green",type:"option"},{attributes:{value:"red"},text:"Red",type:"option"},{attributes:{value:"yellow"},text:"Yellow",type:"option"}]}]},{type:"div",children:[{text:"Icon:",type:"span"},{attributes:{href:"https://fontawesome.com/v4.7.0/icons/"},type:"a",children:[{attributes:{class:"fa fa-question-circle",title:'You must use an icon from FontAwesome (click on this icon to go to the FontAwesome page). The icon must be in the format "fa-icon", without the quotes.'},type:"i"}]},{attributes:{class:"esgst-switch-input esgst-switch-input-large",type:"text"},type:"input"}]},{type:"div",children:[{text:"Name:",type:"span"},{attributes:{class:"esgst-switch-input esgst-switch-input-large",type:"text"},type:"input"}]},{type:"div",children:[{text:"Description:",type:"span"},{attributes:{class:"esgst-switch-input esgst-switch-input-large",type:"text"},type:"input"}]}]),r=o.previousElementSibling,l=r.previousElementSibling,g=l.previousElementSibling,u=g.previousElementSibling.lastElementChild,m=new vt(i.description,null,null,"Use compact size.",!1,!1,"The bottom/top padding of the link will be reduced to 8px.",!1);if(o=o.lastElementChild,r=r.lastElementChild,l=l.lastElementChild,g=g.lastElementChild,"footer"===t&&(g.parentElement.classList.add("esgst-hidden"),o.parentElement.classList.add("esgst-hidden"),m.container.classList.add("esgst-hidden")),this.esgst.st&&o.parentElement.classList.add("esgst-hidden"),e){const s=e.nodes.outer.dataset.linkId;for(let i=d.get("chfl_"+t).length-1;i>-1;i--){let c=d.get("chfl_"+t)[i];if(c===s||c.id&&c.id===s){var n,a;if(c.id)o.value=c.description||"",r.value=c.name||"",l.value=c.icon||"",g.value=c.color||"",u.value=c.url||"",c.compact&&m.enable();else o.value=e.data.description||"",r.value=e.data.name,l.value=e.data.icon?null===(n=e.data.icon.match(/.+(fa-[a-z-]+)$/))||void 0===n?void 0:n[1]:"",g.value=e.data.icon?null===(a=e.data.icon.match(/icon-(.+?)\s/))||void 0===a?void 0:a[1]:"",u.value=e.data.url;break}}}tt.create([{color:"green",icons:[e?"fa-edit":"fa-plus-circle"],name:e?"Edit":"Add",onClick:this.addLink.bind(this,g,m,o,e,l,t,r,i,u)},{template:"loading",isDisabled:!0,name:e?"Editing...":"Adding..."}]).insert(i.description,"beforeend"),i.open()}catch(e){dt.error(e.message)}}async addLink(e,t,s,n,a,i,o,r,l){try{const g={color:e.value,compact:t.value?1:0,description:s.value,icon:a.value,id:Vt.generateId(o.value),name:o.value,url:l.value},u=d.get("chfl_"+i),m=this.sources[i];if(n){const e=n.data.id,t=n.nodes.outer.dataset.linkId;n.nodes.outer.remove(),"footer"===i?delete c.footer.linkContainers[e]:delete c.header.buttonContainers[m].dropdownItems[e];for(let e=u.length-1;e>-1;e--){const s=u[e];if(s.id){if(s.id!==t)continue;u[e]=g;break}if(s===t){u[e]=g;break}}}else u.push(g);let h;await c.common.setSetting(`chfl_${i}_${this.esgst.name}`,u),"footer"===i?(h=c.footer.addLinkContainer({icon:"fa "+g.icon,name:g.name,side:"right",url:g.url}),h.nodes.outer.dataset.linkId=g.id,h.nodes.outer.dataset.linkKey=i,h.nodes.outer.title=c.common.getFeatureTooltip("chfl")):(h=c.header.addDropdownItem({buttonContainerId:m,description:g.description,icon:`fa fa-fw ${g.icon} ${g.color} icon-${g.color}`,name:g.name,url:g.url}),h.nodes.outer.dataset.linkId=g.id,h.nodes.outer.dataset.linkKey=i,h.nodes.outer.title=c.common.getFeatureTooltip("chfl"),g.description||h.nodes.outer.classList.add("esgst-chfl-small"),g.compact&&h.nodes.outer.classList.add("esgst-chfl-compact")),this.makeDraggable(h.nodes.outer),this.reorder(i),r.close()}catch(e){dt.error(e.message)}}async resetLinks(e,t){try{t.preventDefault(),t.stopPropagation();for(const t of d.get("chfl_"+e)){if(!t.id)continue;const s=this.sources[e],n="footer"===e?c.footer.linkContainers[t.id]:c.header.buttonContainers[s].dropdownItems[t.id];n&&n.nodes.outer.dataset.linkId&&(n.nodes.outer.remove(),"footer"===e?delete c.footer.linkContainers[t.id]:delete c.header.buttonContainers[s].dropdownItems[t.id])}await c.common.setSetting(`chfl_${e}_${this.esgst.name}`,d.defaultValues[`chfl_${e}_${this.esgst.name}`]),this.reorder(e)}catch(e){dt.error(e.message)}}removeLink(e,t,s){try{s.preventDefault(),s.stopPropagation();const n=this.sources[t],a=e.nodes.outer.dataset.linkId,i="footer"===t?c.footer.linkContainers[a]:c.header.buttonContainers[n].dropdownItems[a];i&&i.nodes.outer.dataset.linkId&&(i.nodes.outer.remove(),"footer"===t?delete c.footer.linkContainers[a]:delete c.header.buttonContainers[n].dropdownItems[a]),this.saveOrder()}catch(e){dt.error(e.message)}}checkKey(e){try{let t="";if(e.ctrlKey?t+="ctrlKey + ":e.shiftKey?t+="shiftKey + ":e.altKey&&(t+="altKey + "),t+=e.key.toLowerCase(),t!==d.get("chfl_key"))return;e.stopPropagation();const s=this.removeButton();this.addButton(s)}catch(e){dt.logs(e.message)}}};const Kt=new class{constructor(){this.currentVersion=15,this.defaultValues={decryptedGiveaways:"{}",delistedGames:'{ "banned": [], "removed": [] }',discussions:"{}",emojis:"[]",entries:"[]",games:'{ "apps": {}, "subs": {} }',gdtttCache:'{ "giveaways": [], "discussions": [], "tickets": [], "trades": [] }',giveaways:"{}",groups:"[]",requestLog:"[]",rerolls:"[]",rfiCache:"{}",settings:"{}",stickiedCountries:"[]",templates:"[]",tickets:"{}",trades:"{}",users:'{ "steamIds": {}, "users": {} }',winners:"{}"}}async upgrade(e,t,s){if(!l.isSet(e))return;const a=[],i={},o=await n.runtime.getManifest();if(0===Object.keys(e).length?(c.esgst.isFirstRun=!0,c.esgst.currentVersion=o.version,await c.common.setValue("currentVersion",c.esgst.currentVersion)):(c.esgst.currentVersion=e.currentVersion,c.esgst.currentVersion!==o.version&&(c.esgst.isUpdate=!0,c.esgst.previousVersion=c.esgst.currentVersion,c.esgst.currentVersion=o.version,await c.common.setValue("currentVersion",c.esgst.currentVersion))),c.esgst.versionName=o.version_name||o.version,(t=t||1)<2){if(window.console.log("Upgrading storage to version 2..."),l.isSet(e.delistedGames)||(i.delistedGames=this.defaultValues.delistedGames),l.isSet(e.emojis)){const t=c.common.fixEmojis(e.emojis);e.emojis!==t?i.emojis=t:e.emojis||(i.emojis=this.defaultValues.emojis)}else a.push("Emojis"),i.emojis=l.isSet(e.Emojis)?c.common.fixEmojis(e.Emojis):this.defaultValues.emojis;if(l.isSet(e.games)||(i.games=this.defaultValues.games),l.isSet(e[c.esgst.name+"RfiCache"])||(i[c.esgst.name+"RfiCache"]=r.get("replies",this.defaultValues.rfiCache),r.delete("replies")),l.isSet(e.users)){let t=!1;const s=JSON.parse(e.users);for(const e of Object.keys(s.users)){const n=s.users[e].wbc;n&&n.result&&"whitelisted"!==n.result&&"blacklisted"!==n.result&&(delete s.users[e].wbc,t=!0)}t&&(i.users=JSON.stringify(s))}else i.users=this.defaultValues.users;c.esgst.sg?(l.isSet(e.decryptedGiveaways)?"string"!=typeof e.decryptedGiveaways&&(i.decryptedGiveaways=JSON.stringify(e.decryptedGiveaways)):i.decryptedGiveaways=this.defaultValues.decryptedGiveaways,l.isSet(e.discussions)||(i.discussions=r.get("discussions",this.defaultValues.discussions),r.delete("discussions")),l.isSet(e.entries)||(i.entries=r.get("entries",this.defaultValues.entries),r.delete("entries")),l.isSet(e.giveaways)||(i.giveaways=r.get("giveaways",this.defaultValues.giveaways),r.delete("giveaways")),l.isSet(e.groups)||(i.groups=r.get("groups",this.defaultValues.groups),r.delete("groups")),l.isSet(e.rerolls)||(i.rerolls=r.get("rerolls",this.defaultValues.rerolls),r.delete("rerolls")),l.isSet(e.stickiedCountries)||(i.stickiedCountries=r.get("stickiedCountries",this.defaultValues.stickiedCountries),r.delete("stickiedCountries")),l.isSet(e.templates)||(i.templates=r.get("templates",this.defaultValues.templates),r.delete("templates")),l.isSet(e.tickets)||(i.tickets=r.get("tickets",this.defaultValues.tickets),r.delete("tickets")),l.isSet(e.winners)||(i.winners=r.get("winners",this.defaultValues.winners),r.delete("winners")),r.delete("dFix"),r.delete("gFix"),r.delete("tFix")):(l.isSet(e.trades)||(i.trades=r.get("trades",this.defaultValues.trades),r.delete("trades")),r.delete("tFix")),l.isSet(e.settings)||(i.settings=this.defaultValues.settings,e.settings=i.settings);let t=!1;const s=JSON.parse(e.settings);if(s.hasOwnProperty("avatar_sg")&&(delete s.avatar_sg,t=!0),s.hasOwnProperty("avatar_st")&&(delete s.avatar_st,t=!0),s.hasOwnProperty("username")&&(delete s.username,t=!0),l.isSet(e.filterPresets)){const n=(s.gf_presets||d.defaultValues.gf_presets).concat(c.esgst.modules.giveawaysGiveawayFilters.filters_convert(JSON.parse(e.filterPresets)));s.gf_presets=n,t=!0,a.push("filterPresets"),i.old_gf_presets=e.filterPresets}if(l.isSet(e.dfPresets)){const n=(s.df_presets||d.defaultValues.df_presets).concat(c.esgst.modules.giveawaysGiveawayFilters.filters_convert(JSON.parse(e.dfPresets)));s.df_presets=n,t=!0,a.push("dfPresets"),i.old_df_presets=e.dfPresets}if(l.isSet(s.comments)&&(delete s.comments,t=!0),l.isSet(s.giveaways)&&(delete s.giveaways,t=!0),l.isSet(s.groups)&&(delete s.groups,t=!0),l.isSet(s.users)&&(delete s.users,t=!0),l.isSet(s.gc_categories_ids)&&(s.gc_categories_ids.includes("gc_f")||(s.gc_categories_ids.push("gc_f"),t=!0),s.gc_categories_ids.includes("gc_bvg")||(s.gc_categories_ids.push("gc_bvg"),t=!0),s.gc_categories_ids.includes("gc_bd")||(s.gc_categories_ids.push("gc_bd"),t=!0)),["gc_categories","gc_categories_gv","gc_categories_ids"].forEach(e=>{if(!l.isSet(s[e]))return;const n=s[e].length;s[e]=Array.from(new Set(s[e])),n!==s[e].length&&(t=!0)}),"1"!==s.elementOrdering){if(l.isSet(s.leftButtonIds))for(let e=s.leftButtonIds.length-1;e>-1;e--){const t=s.leftButtonIds[e];s[`hideButtons_${t}_sg`]?l.isSet(s.rightButtonsIds)&&s.rightButtonIds.includes(t)&&s.leftButtonIds.splice(e,1):(l.isSet(s.leftMainPageHeadingIds)&&s.leftMainPageHeadingIds.push(t),s.leftButtonIds.splice(e,1))}if(l.isSet(s.rightButtonIds))for(let e=s.rightButtonIds.length-1;e>-1;e--){const t=s.rightButtonIds[e];s[`hideButtons_${t}_sg`]?l.isSet(s.leftButtonIds)&&s.leftButtonIds.includes(t)&&s.rightButtonIds.splice(e,1):(l.isSet(s.rightMainPageHeadingIds)&&s.rightMainPageHeadingIds.push(t),s.rightButtonIds.splice(e,1))}if(l.isSet(s.leftMainPageHeadingIds))for(let e=s.leftMainPageHeadingIds.length-1;e>-1;e--){const t=s.leftMainPageHeadingIds[e];s[`hideButtons_${t}_sg`]?l.isSet(s.rightMainPageHeadingIds)&&s.rightMainPageHeadingIds.includes(t)&&s.leftMainPageHeadingIds.splice(e,1):(l.isSet(s.leftButtonIds)&&s.leftButtonIds.push(t),s.leftMainPageHeadingIds.splice(e,1))}if(l.isSet(s.rightMainPageHeadingIds))for(let e=s.rightMainPageHeadingIds.length-1;e>-1;e--){const t=s.rightMainPageHeadingIds[e];s[`hideButtons_${t}_sg`]?l.isSet(s.leftMainPageHeadingIds)&&s.leftMainPageHeadingIds.includes(t)&&s.rightMainPageHeadingIds.splice(e,1):(l.isSet(s.rightButtonIds)&&s.rightButtonIds.push(t),s.rightMainPageHeadingIds.splice(e,1))}s.leftButtonIds=Array.from(new Set(s.leftButtonIds)),s.rightButtonIds=Array.from(new Set(s.rightButtonIds)),s.leftMainPageHeadingIds=Array.from(new Set(s.leftMainPageHeadingIds)),s.rightMainPageHeadingIds=Array.from(new Set(s.rightMainPageHeadingIds)),s.elementOrdering="1",t=!0}if(l.isSet(s.leftButtonIds)&&l.isSet(s.rightButtonIds)&&l.isSet(s.leftMainPageHeadingIds)&&l.isSet(s.rightMainPageHeadingIds)&&[{id:"cec",side:"left"},{id:"esContinuous",side:"right"},{id:"esNext",side:"right"},{id:"glwc",side:"left"},{id:"mm",side:"right"},{id:"stbb",side:"right"},{id:"sttb",side:"right"},{id:"usc",side:"left"},{id:"wbm",side:"left"},{id:"df_s_s",side:"left"},{id:"gf_s_s",side:"left"},{id:"tf_s_s",side:"left"},{id:"uf_s_s",side:"left"},{id:"gmf",side:"left"}].forEach(e=>{s.leftButtonIds.includes(e.id)||s.rightButtonIds.includes(e.id)||s.leftMainPageHeadingIds.includes(e.id)||s.rightMainPageHeadingIds.includes(e.id)||(s[e.side+"MainPageHeadingIds"].push(e.id),t=!0)}),l.isSet(s.chfl_discussions_sg)&&(s.chfl_discussions_sg=s.chfl_discussions_sg.filter(e=>"categorize-discussions"!==("string"==typeof e&&e||e.id)),t=!0),l.isSet(s.chfl_footer_sg)){const e=s.chfl_footer_sg.map((e,t)=>"privacy-policy"===("string"==typeof e&&e||e.id)?t:null).filter(e=>l.isSet(e))[0];l.isSet(e)?s.chfl_footer_sg.splice(e+1,0,"cookie-policy"):s.chfl_footer_sg.push("cookie-policy");const n=s.chfl_footer_sg.map((e,t)=>"terms-of-service"===("string"==typeof e&&e||e.id)?t:null).filter(e=>l.isSet(e))[0];l.isSet(n)?s.chfl_footer_sg.splice(n+1,0,"advertising"):s.chfl_footer_sg.push("advertising"),t=!0}t&&(i.settings=JSON.stringify(s),e.settings=i.settings)}if(t<3){window.console.log("Upgrading storage to version 3...");let t=!1;const s=JSON.parse(e.settings);if(l.isSet(s.chfl_discussions_sg)){const e=s.chfl_discussions_sg.indexOf("created");e>-1?s.chfl_discussions_sg.splice(e+1,0,"bookmarked"):s.chfl_discussions_sg.push("bookmarked"),t=!0}t&&(i.settings=JSON.stringify(s),e.settings=i.settings)}if(t<4){window.console.log("Upgrading storage to version 4...");let t=!1;const s=JSON.parse(e.settings),n=["giveaways_sg","discussions_sg","support_sg","help_sg","account_sg","footer_sg","trades_st","account_st","footer_st"];for(const e of n){const n=e.match(/(.+?)_/)[1];l.isSet(s["chfl_"+e])&&(s["chfl_"+e]=s["chfl_"+e].map(e=>(e.id?e.id=Vt.generateId(e.name):e=Yt.newIds[n][e]||e,e)),t=!0)}if(l.isSet(s.chfl_account_st)){const e=s.chfl_account_st.indexOf("reviews");e>-1?s.chfl_account_st.splice(e+1,0,"comments","settings"):s.chfl_account_st.push("comments","settings"),t=!0}if(l.isSet(s.chfl_footer_st)){let e=s.chfl_footer_st.indexOf("privacyPolicy");e>-1?s.chfl_footer_st.splice(e+1,0,"cookiePolicy"):s.chfl_footer_st.push("cookiePolicy"),e=s.chfl_footer_st.indexOf("termsOfService"),e>-1?s.chfl_footer_st.splice(e+1,0,"advertise"):s.chfl_footer_st.push("advertise"),t=!0}t&&(i.settings=JSON.stringify(s),e.settings=i.settings)}if(t<5){window.console.log("Upgrading storage to version 5...");let t=!1;const s=JSON.parse(e.settings);"forw|more|next|onwards|►|>|→"===s.npth_nextRegex&&(s.npth_nextRegex="forw|more|next|onwards?|►|>|→",t=!0),t&&(i.settings=JSON.stringify(s),e.settings=i.settings)}if(t<7&&(window.console.log("Upgrading storage to version 7..."),e.notifiedMessages&&(i.notifiedMessages=JSON.stringify({lastCheck:0,ids:JSON.parse(e.notifiedMessages)}))),t<8){window.console.log("Upgrading storage to version 8...");let t=!1;const s=JSON.parse(e.settings);if(l.isSet(s.chfl_giveaways_sg)){const e=s.chfl_giveaways_sg.map((e,t)=>"browseWishlistGiveaways"===("string"==typeof e&&e||e.id)?t:null).filter(e=>l.isSet(e))[0];l.isSet(e)?s.chfl_giveaways_sg.splice(e+1,0,{id:"browseFollowedGiveaways",name:"Browse Followed Giveaways",url:"/giveaways/search?esgst=fgp"}):s.chfl_giveaways_sg.push({id:"browseFollowedGiveaways",name:"Browse Followed Giveaways",url:"/giveaways/search?esgst=fgp"}),t=!0}t&&(i.settings=JSON.stringify(s),e.settings=i.settings)}if(t<9){window.console.log("Upgrading storage to version 9...");let t=!1;const s=JSON.parse(e.settings);if(l.isSet(s.chfl_discussions_sg)){s.chfl_discussions_sg=s.chfl_discussions_sg.map(e=>"string"==typeof e?e:"browseOff"===e.id?(e.name="Browse Off Topic",e):"browsePuzzles"===e.id?(e.name="Browse Puzzles / Events",e.url="/discussions/puzzles-events",e):e);const e=[{reference:"browseAnnouncements",position:"before",item:{id:"browseAddonsTools",name:"Browse Add-ons / Tools",url:"/discussions/addons-tools"}},{reference:"browseDeals",position:"after",item:{id:"browseGameShowcase",name:"Browse Game Showcase",url:"/discussions/game-showcase"}},{reference:"browseGroupRecruitment",position:"after",items:[{id:"browseHardware",name:"Browse Hardware",url:"/discussions/hardware"},{id:"browseHelp",name:"Browse Help",url:"/discussions/help"}]},{reference:"browseLet",position:"after",item:{id:"browseMoviesTv",name:"Browse Movies / TV",url:"/discussions/movies-tv"}},{reference:"browseUncategorized",position:"after",items:[{id:"browseUserProjects",name:"Browse User Projects",url:"/discussions/user-projects"},{id:"browseWhitelistRecruitment",name:"Browse Whitelist / Recruitment",url:"/discussions/whitelist-recruitment"}]}];for(const t of e){const e=s.chfl_discussions_sg.map((e,s)=>("string"==typeof e&&e||e.id)===t.reference?s:null).filter(e=>l.isSet(e))[0];l.isSet(e)?s.chfl_discussions_sg.splice(e+1,0,...t.item?[t.item]:t.items):s.chfl_discussions_sg.push(...t.item?[t.item]:t.items)}t=!0}t&&(i.settings=JSON.stringify(s),e.settings=i.settings)}if(t<10){window.console.log("Upgrading storage to version 10...");let t=!1;const s=JSON.parse(e.settings);if(l.isSet(s.giveawayHeading)){const e=s.giveawayHeading.indexOf("steam");e>-1?s.giveawayHeading.splice(e+1,0,"screenshots-videos"):s.giveawayHeading.push("screenshots-videos"),t=!0}if(l.isSet(s.giveawayHeading_gv)){const e=s.giveawayHeading_gv.indexOf("steam");e>-1?s.giveawayHeading_gv.splice(e+1,0,"screenshots-videos"):s.giveawayHeading_gv.push("screenshots-videos"),t=!0}t&&(i.settings=JSON.stringify(s),e.settings=i.settings)}if(t<11){window.console.log("Upgrading storage to version 11...");let t=!1;const s=JSON.parse(e.settings);for(const e in s){if(!e.startsWith("gc_")||!e.endsWith("s_sg")&&!e.endsWith("s_i_sg"))continue;const n=e.slice(0,-3);n in s||(s[n]="object"==typeof s[e]&&"enabled"in s[e]?s[e].enabled:s[e]),delete s[e],t=!0}t&&(i.settings=JSON.stringify(s),e.settings=i.settings)}if(t<12){window.console.log("Upgrading storage to version 12...");let t=!1;const s=JSON.parse(e.settings);for(const e in s)/^(sgDarkGrey|sgv2Dark|steamGiftiesBlack|steamTradiesBlackBlue)/.test(e)&&(delete s[e],t=!0);t&&(i.settings=JSON.stringify(s),e.settings=i.settings),a.push("sgDarkGrey","sgv2Dark","steamGiftiesBlack","steamTradiesBlackBlue")}if(t<13&&(window.console.log("Upgrading storage to version 13..."),a.push("settingsAnalytics","notifiedMessages")),t<14){window.console.log("Upgrading storage to version 14...");let t=!1;const s=JSON.parse(e.settings);l.isSet(s.chfl_footer_st)&&(s.chfl_footer_st.push("steamtrades","steamgifts"),t=!0),t&&(i.settings=JSON.stringify(s),e.settings=i.settings)}if(t<15){window.console.log("Upgrading storage to version 15...");let t=!1;const s=JSON.parse(e.settings);l.isSet(s.chfl_discussions_sg)&&(s.chfl_discussions_sg=s.chfl_discussions_sg.map(e=>"string"==typeof e?e:"browseAddonsTools"===e.id?(e.id="browseAdd",e):"browseOff"===e.id?(e.id="browseOffTopic",e):"browseMoviesTv"===e.id?(e.id="browseMovies",e):"browseWhitelistRecruitment"===e.id?(e.id="browseWhitelist",e):(console.log(e),e)),t=!0),t&&(i.settings=JSON.stringify(s),e.settings=i.settings)}for(const t of Object.keys(i))e[t]=i[t];for(const t of Object.keys(this.defaultValues))l.isSet(e[t])||(i[t]=this.defaultValues[t],e[t]=i[t]);try{const t=JSON.parse(e.emojis);"string"==typeof t&&(i.emojis=t,e.emojis=t)}catch(e){}const g=JSON.parse(r.get("gdtttCache",this.defaultValues.gdtttCache));for(const t of Object.keys(g)){if(!e[t])continue;let s=!1;const n=JSON.parse(e[t]);for(const e of g[t])n[e]||(n[e]={readComments:{}}),n[e].visited||(n[e].visited=!0,s=!0);s&&(i[t]=JSON.stringify(n),e[t]=i[t])}r.set("gdtttCache",this.defaultValues.gdtttCache),s||t===this.currentVersion||(Object.keys(a).length>0&&await c.common.delValues(a),Object.keys(i).length>0&&await c.common.setValues(i),await c.common.setValue("v",this.currentVersion))}};class zt{static get REDIRECT_URL(){return"https://www.steamgifts.com/account/settings/profile"}static getToken(e){return new Promise(t=>{zt.checkToken(e,t)})}static async checkToken(e,t,s=Date.now(),n=6e4){const a=await c.common.getValue(e);l.isSet(a)?t(a):s-Date.now()>n?t(null):window.setTimeout(zt.checkToken,1e3,e,t,s,n)}}class Qt extends zt{static get CLIENT_ID(){return"nix7kvchwa8wdvj"}static get AUTH_URL(){return"https://www.dropbox.com/oauth2/authorize"}static get API_BASE_URL(){return"https://api.dropboxapi.com/2"}static get CONTENT_BASE_URL(){return"https://content.dropboxapi.com/2"}static get UPLOAD_URL(){return Qt.CONTENT_BASE_URL+"/files/upload"}static get DOWNLOAD_URL(){return Qt.CONTENT_BASE_URL+"/files/download"}static get DELETE_URL(){return Qt.API_BASE_URL+"/files/delete_v2"}static get DELETE_BATCH_URL(){return Qt.API_BASE_URL+"/files/delete_batch"}static get DELETE_BATCH_CHECK_URL(){return Qt.API_BASE_URL+"/files/delete_batch/check"}static get LIST_URL(){return Qt.API_BASE_URL+"/files/list_folder"}static getDefaultHeaders(e){return{authorization:"Bearer "+e}}static async authenticate(){const e="dropboxToken",t={client_id:Qt.CLIENT_ID,redirect_uri:Qt.REDIRECT_URL,response_type:"token",state:"dropbox"},s=Ne.addQueryParams(Qt.AUTH_URL,t);return await c.common.delValue(e),c.common.openSmallWindow(s),await Qt.getToken(e)}static async upload(e,t,s){e||(e=await Qt.authenticate());const n={data:t,fileName:d.get("backupZip")?s+".json":null,headers:Object.assign(Qt.getDefaultHeaders(e),{"Dropbox-API-Arg":d.get("backupZip")?`{"path": "/${s}.zip"}`:`{"path": "/${s}.json"}`,"Content-Type":"application/octet-stream"})},a=await Ne.post(Qt.UPLOAD_URL,n);if(!a.json||!a.json.id)throw new Error(a.text)}static async download(e,t){e||(e=await Qt.authenticate());const s={blob:t.name.match(/\.zip$/),headers:Object.assign(Qt.getDefaultHeaders(e),{"Dropbox-API-Arg":`{"path": "/${t.name}"}`,"Content-Type":"text/plain"})};return(await Ne.get(Qt.DOWNLOAD_URL,s)).text}static async delete(e,t){e||(e=await Qt.authenticate());const s={data:`{ "path": "/${t.name}" }`,headers:Object.assign(Qt.getDefaultHeaders(e),{"Content-Type":"application/json"})},n=await Ne.post(Qt.DELETE_URL,s);if(!n.json||n.json.error)throw new Error(n.text)}static async deleteBatch(e,t){e||(e=await Qt.authenticate());const s={success:[],error:[]},n={data:`{ "entries": ${JSON.stringify(t.map(e=>({path:"/"+e})))} }`,headers:Object.assign(Qt.getDefaultHeaders(e),{"Content-Type":"application/json"})},a=await Ne.post(Qt.DELETE_BATCH_URL,n);if(!a.json)throw new Error(a.text);"complete"!==a.json[".tag"]&&(a.json=await Qt.waitDeleteBatch(e,a.json.async_job_id));for(const e of a.json.entries)"success"===e[".tag"]?s.success.push(e.metadata.name):s.error.push(e.metadata.name);return s}static waitDeleteBatch(e,t){return new Promise(s=>{Qt.checkDeleteBatch(e,t,s)})}static async checkDeleteBatch(e,t,s){const n={data:`{ "async_job_id": ${JSON.stringify(t)} }`,headers:Object.assign(Qt.getDefaultHeaders(e),{"Content-Type":"application/json"})},a=await Ne.post(Qt.DELETE_BATCH_CHECK_URL,n);a.json&&"complete"===a.json[".tag"]?s(a.json):window.setTimeout(Qt.checkDeleteBatch,1e3,e,t,s)}static async list(e){e||(e=await Qt.authenticate());const t={data:'{ "path": "" }',headers:Object.assign(Qt.getDefaultHeaders(e),{"Content-Type":"application/json"})},s=await Ne.post(Qt.LIST_URL,t);if(!s.json||!s.json.entries)throw new Error(s.text);return s.json.entries.reverse().map(e=>(e.id=e.name)&&(e.date=e.server_modified)&&e)}}class Zt extends zt{static get CLIENT_ID(){return"102804278399-95kit5e09mdskdta7eq97ra7tuj20qps.apps.googleusercontent.com"}static get AUTH_URL(){return"https://accounts.google.com/o/oauth2/v2/auth"}static get BASE_URL(){return"https://www.googleapis.com"}static get API_BASE_URL(){return Zt.BASE_URL+"/drive/v3"}static get UPLOAD_METADATA_URL(){return Zt.API_BASE_URL+"/files"}static get UPLOAD_URL(){return Zt.BASE_URL+"/upload/drive/v3/files/%fileId%"}static get DOWNLOAD_URL(){return Zt.API_BASE_URL+"/files/%fileId%"}static get DELETE_URL(){return Zt.API_BASE_URL+"/files/%fileId%"}static get DELETE_BATCH_URL(){return Zt.BASE_URL+"/batch/drive/v3"}static get LIST_URL(){return Zt.API_BASE_URL+"/files"}static getDefaultHeaders(e){return{authorization:"Bearer "+e}}static async authenticate(){const e="googleDriveToken",t={client_id:Zt.CLIENT_ID,redirect_uri:Zt.REDIRECT_URL,response_type:"token",scope:"https://www.googleapis.com/auth/drive.appdata",state:"google-drive"};d.get("usePreferredGoogle")&&(t.login_hint=d.get("preferredGoogle"));const s=Ne.addQueryParams(Zt.AUTH_URL,t);return await c.common.delValue(e),c.common.openSmallWindow(s),await Zt.getToken(e)}static async upload(e,t,s){e||(e=await Zt.authenticate());const n={data:d.get("backupZip")?`{ "name": "${s}.zip", "parents": ["appDataFolder"]}`:`{"name": "${s}.json", "parents": ["appDataFolder"] }`,headers:Object.assign(Zt.getDefaultHeaders(e),{"Content-Type":"application/json"})},a=await Ne.post(Zt.UPLOAD_METADATA_URL,n);if(!a.json||!a.json.id)throw new Error(a.text);const i={data:t,fileName:d.get("backupZip")?s+".json":null,headers:Object.assign(Zt.getDefaultHeaders(e),{"Content-Type":d.get("backupZip")?"application/zip":"text/plain"}),pathParams:{fileId:a.json.id},queryParams:{uploadType:"media"}},o=await Ne.patch(Zt.UPLOAD_URL,i);if(!o.json||!o.json.id)throw new Error(o.text)}static async download(e,t){e||(e=await Zt.authenticate());const s={blob:t.name.match(/\.zip$/),headers:Object.assign(Zt.getDefaultHeaders(e),{}),pathParams:{fileId:t.id},queryParams:{alt:"media"}};return(await Ne.get(Zt.DOWNLOAD_URL,s)).text}static async delete(e,t){e||(e=await Zt.authenticate());const s={headers:Object.assign(Zt.getDefaultHeaders(e),{}),pathParams:{fileId:t.id}},n=await Ne.delete(Zt.DELETE_URL,s);if(n.text)throw new Error(n.text)}static async deleteBatch(e,t){e||(e=await Zt.authenticate());const s={success:[],error:[]};for(let n=0,a=t.length;n<a;n+=100){const a=t.slice(n,n+100),i=[];for(const e of a)i.push("--ESGST","Content-Type: application/http","","DELETE "+Ne.addPathParams(Zt.DELETE_URL,{fileId:e}),"","");i.push("--ESGST--");const o={data:i.join("\n"),headers:Object.assign(Zt.getDefaultHeaders(e),{"Content-Type":"multipart/mixed; boundary=ESGST"})},r=await Ne.post(Zt.DELETE_BATCH_URL,o);if(!r.text)throw new Error(r.text);const l=r.text.replace(/\r?\n|\r/g,"\n").replace(/\n\n+/g,"\n\n").split(/--batch.*\n/).filter(e=>e).map(e=>e.split(/\n\n/)[2]);for(const[e,t]of l.entries())t?s.error.push(a[e]):s.success.push(a[e])}return s}static async list(e){e||(e=await Zt.authenticate());const t={headers:Object.assign(Zt.getDefaultHeaders(e),{}),queryParams:{fields:"files(kind,id,name,mimeType,size,modifiedTime)",spaces:"appDataFolder"}},s=await Ne.get(Zt.LIST_URL,t);if(!s.json||!s.json.files)throw new Error(s.text);return s.json.files.map(e=>(e.date=e.modifiedTime)&&e)}}class Xt extends zt{static get CLIENT_ID(){return"1781429b-289b-4e6e-877a-e50015c0af21"}static get AUTH_URL(){return"https://login.microsoftonline.com/common/oauth2/v2.0/authorize"}static get API_BASE_URL(){return"https://graph.microsoft.com/v1.0"}static get UPLOAD_URL(){return Xt.API_BASE_URL+"/me/drive/special/approot:/%fileName%:/content"}static get DOWNLOAD_URL(){return Xt.API_BASE_URL+"/me/drive/items/%fileId%/content"}static get DELETE_URL(){return Xt.API_BASE_URL+"/me/drive/items/%fileId%"}static get DELETE_BATCH_URL(){return Xt.API_BASE_URL+"/$batch"}static get LIST_URL(){return Xt.API_BASE_URL+"/me/drive/special/approot/children"}static getDefaultHeaders(e){return{Authorization:"bearer "+e}}static async authenticate(){const e="oneDriveToken",t={client_id:Xt.CLIENT_ID,redirect_uri:Xt.REDIRECT_URL,response_type:"token",scope:"files.readwrite",state:"onedrive"};d.get("usePreferredMicrosoft")&&(t.login_hint=d.get("preferredMicrosoft"));const s=Ne.addQueryParams(Xt.AUTH_URL,t);return await c.common.delValue(e),c.common.openSmallWindow(s),await Xt.getToken(e)}static async upload(e,t,s){e||(e=await Xt.authenticate());const n={anon:!0,data:t,fileName:d.get("backupZip")?s+".json":null,headers:Object.assign(Xt.getDefaultHeaders(e),{"Content-Type":d.get("backupZip")?"application/zip":"text/plain"}),pathParams:{fileName:`${s}.${d.get("backupZip")?"zip":"json"}`}},a=await Ne.put(Xt.UPLOAD_URL,n);if(!a.json||!a.json.id)throw new Error(a.text)}static async download(e,t){e||(e=await Xt.authenticate());const s={anon:!0,blob:t.name.match(/\.zip$/),headers:Object.assign(Xt.getDefaultHeaders(e),{}),pathParams:{fileId:t.id}};return(await Ne.get(Xt.DOWNLOAD_URL,s)).text}static async delete(e,t){e||(e=await Xt.authenticate());const s={anon:!0,headers:Object.assign(Xt.getDefaultHeaders(e),{}),pathParams:{fileId:t.id}},n=await Ne.delete(Xt.DELETE_URL,s);if(n.text)throw new Error(n.text)}static async deleteBatch(e,t){e||(e=await Xt.authenticate());const s={success:[],error:[]},n={anon:!0,data:`{ "requests": ${JSON.stringify(t.map(e=>({id:e,method:"DELETE",url:"/me/drive/items/"+e})))} }`,headers:Object.assign(Xt.getDefaultHeaders(e),{"Content-Type":"application/json"})},a=await Ne.post(Xt.DELETE_BATCH_URL,n);if(!a.json||!a.json.responses)throw new Error(a.text);for(const e of a.json.responses)204===e.status?s.success.push(e.id):s.error.push(e.id);return s}static async list(e){e||(e=await Xt.authenticate());const t={anon:!0,headers:Object.assign(Xt.getDefaultHeaders(e),{})},s=await Ne.get(Xt.LIST_URL,t);if(!s.json||!s.json.value)throw new Error(s.text);return s.json.value.reverse().map(e=>(e.date=e.lastModifiedDateTime)&&e)}}class es{static get DROPBOX(){return 0}static get GOOGLEDRIVE(){return 1}static get ONEDRIVE(){return 2}static async manage(e,t,s,n){"export"===s.type||t&&d.get("exportBackup")?await es.backup(e,t,s,n):await es.restore(e,s,n)}static async backup(e,t,s,n){const a="esgst_data_"+(new Date).toISOString().replace(/:/g,"_"),i=d.get("askFileName")?window.prompt("Enter the name of the file:",a):a;if(null===i)return void(n&&n());let o=null;switch(e){case es.DROPBOX:o=await Qt.authenticate();break;case es.GOOGLEDRIVE:o=await Zt.authenticate();break;case es.ONEDRIVE:o=await Xt.authenticate()}t=JSON.stringify(t);try{switch(e){case es.DROPBOX:await Qt.upload(o,t,i);break;case es.GOOGLEDRIVE:await Zt.upload(o,t,i);break;case es.ONEDRIVE:await Xt.upload(o,t,i)}if(d.get("deleteOldBackups")){let t=null;try{switch(e){case es.DROPBOX:t=await Qt.list(o);break;case es.GOOGLEDRIVE:t=await Zt.list(o);break;case es.ONEDRIVE:t=await Xt.list(o)}const s=Date.now(),a=[];for(const e of t)s-new Date(e.date).getTime()>864e5*d.get("deleteOldBackups_days")&&a.push(e.id);const i=a.length;try{let t=null;switch(e){case es.DROPBOX:t=await Qt.deleteBatch(o,a);break;case es.GOOGLEDRIVE:t=await Zt.deleteBatch(o,a);break;case es.ONEDRIVE:t=await Xt.deleteBatch(o,a)}const s=t.error.length;if(s>0)return window.alert(`An error occurred when deleting ${s} of the ${i} old backup files.`),void(n&&n())}catch(e){return window.alert(`An error occurred when deleting the ${i} old backup files.\n\n${e.message}`),void(n&&n())}}catch(e){return window.alert("An error occurred when listing the old backup files.\n\n"+e.message),void(n&&n())}}s.autoBackup||c.common.createFadeMessage(s.message,`Data ${s.pastTense} with success!`)}catch(e){window.alert("An error occurred when uploading the file.\n\n"+e.message)}n&&n()}static async restore(e,t,s){let n=null,a=null;switch(e){case es.DROPBOX:n="dropbox",a=await Qt.authenticate();break;case es.GOOGLEDRIVE:n="google",a=await Zt.authenticate();break;case es.ONEDRIVE:n="windows",a=await Xt.authenticate()}let i=!0;const o=new lt({addScrollable:!0,icon:"fa-"+n,isTemp:!0,title:"Select a file to restore:"});let r;o.onClose=()=>{i&&s&&s()},o.open(),Se.insert(o.scrollable,"beforeend",Se.element("div",{className:"popup__keys__list",ref:e=>r=e}));let l=null;try{switch(e){case es.DROPBOX:l=await Qt.list(a);break;case es.GOOGLEDRIVE:l=await Zt.list(a);break;case es.ONEDRIVE:l=await Xt.list(a)}}catch(e){return window.alert("An error occurred when listing the files.\n\n"+e.message),void(s&&s())}let d={};for(const n of l){let l;Se.insert(r,"beforeend",Se.element("div",{className:"esgst-clickable esgst-restore-entry",ref:e=>l=e},Se.element("span",null),Se.element("span",null,`${n.name} - ${c.common.convertBytes(n.size)}`),Se.element("i",{className:"fa fa-times-circle",title:"Delete file"})));const g=new St(l.firstElementChild);g.onEnabled=()=>d[n.id]={item:l},g.onDisabled=()=>delete d[n.id],l.firstElementChild.nextElementSibling.addEventListener("click",()=>{c.common.createConfirmation("Are you sure you want to restore the selected data?",async()=>{i=!1,o.close();try{switch(e){case es.DROPBOX:t.data=await Qt.download(a,n);break;case es.GOOGLEDRIVE:t.data=await Zt.download(a,n);break;case es.ONEDRIVE:t.data=await Xt.download(a,n)}t.data=JSON.parse(t.data)}catch(e){return window.alert("An error occurred when downloading the file.\n\n"+e.message),void(s&&s())}c.esgst.modules.manageData(t,!1,!1,!1,!1,s)})}),l.lastElementChild.addEventListener("click",()=>{c.common.createConfirmation("WARNING: Are you sure you want to delete this file?",async()=>{const t=new lt({icon:"fa-circle-o-notch fa-spin",isTemp:!0,title:"Deleting file..."});t.open();try{switch(e){case es.DROPBOX:await Qt.delete(a,n);break;case es.GOOGLEDRIVE:await Zt.delete(a,n);break;case es.ONEDRIVE:await Xt.delete(a,n)}l.remove(),delete d[n.id],t.setIcon("fa-check"),t.setTitle("File deleted with success!")}catch(e){t.setIcon("fa-times"),t.setTitle("An error occurred when deleting the file.\n\n"+e.message)}})})}tt.create([{color:"green",icons:["fa-trash"],name:"Delete selected files",onClick:()=>new Promise(t=>{const s=Object.keys(d),n=s.length;n<1?t():c.common.createConfirmation("WARNING: Are you sure you want to delete the selected files?",async()=>{const i=new lt({icon:"fa-circle-o-notch fa-spin",isTemp:!0,title:`Deleting ${n} files...`});i.open();try{let t=null;switch(e){case es.DROPBOX:t=await Qt.deleteBatch(a,s);break;case es.GOOGLEDRIVE:t=await Zt.deleteBatch(a,s);break;case es.ONEDRIVE:t=await Xt.deleteBatch(a,s)}for(const e of t.success)d.hasOwnProperty(e)&&(d[e].item.remove(),delete d[e]);const o=t.error.length;o>0?(i.setIcon("fa-times"),i.setTitle(`An error occurred when deleting ${o} of the ${n} files.`)):(i.setIcon("fa-check"),i.setTitle(n+" files deleted with success!"))}catch(e){i.setIcon("fa-times"),i.setTitle(`An error occurred when deleting the ${n} files.\n\n${e.message}`)}t()},t)})},{template:"loading",isDisabled:!0,name:"Deleting..."}]).insert(o.actions,"beforebegin")}}const ts=0,ss=1,ns=2,as=3,is=4;function os(e,t,s){let n,a,i,o,r,l;if(i=document.createElement("div"),t[e.key]=l=new vt(i,`${s}_${e.key}`,!1,e.name,!1,!1,null,d.get(`${s}_${e.key}`)),t[e.key].size=c.common.createElements(t[e.key].name,"beforeend",[{attributes:{class:"esgst-bold"},type:"span"}]),"Main"===e.name&&c.common.createElements(t[e.key].name,"beforeend",[{attributes:{class:"fa fa-question-circle",title:"Main data is the data that is needed by other sub-options. Because of that dependency, when deleting main data not all data may be deleted, but if you delete another sub-option first and then delete main data, all data that was required exclusively by that sub-option will be deleted."},type:"i"}]),e.options){r=c.common.createElements(i,"beforeend",[{attributes:{class:"esgst-form-row-indent SMFeatures esgst-hidden"},type:"div"}]);const g={};if(e.options.length>1){const e=c.common.createElements(r,"beforeend",[{attributes:{class:"esgst-button-group"},type:"div",children:[{text:"Select:",type:"span"}]}]);tt.create([{color:"white",icons:["fa-square"],name:"All",onClick:c.common.selectSwitches.bind(c.common,g,"enable",e)},{template:"loading",isDisabled:!0,name:""}]).insert(e,"beforeend"),tt.create([{color:"white",icons:["fa-square-o"],name:"None",onClick:c.common.selectSwitches.bind(c.common,g,"disable",e)},{template:"loading",isDisabled:!0,name:""}]).insert(e,"beforeend"),tt.create([{color:"white",icons:["fa-plus-square-o"],name:"Inverse",onClick:c.common.selectSwitches.bind(c.common,g,"toggle",e)},{template:"loading",isDisabled:!0,name:""}]).insert(e,"beforeend")}for(n=0,o=e.options.length;n<o;++n)a=os(e.options[n],t,s),g[e.options[n].key]=t[e.options[n].key],r.appendChild(a),l.dependencies.push(a);d.get(`${s}_${e.key}`)&&r.classList.remove("esgst-hidden")}return l.onEnabled=()=>{r&&r.classList.remove("esgst-hidden")},l.onDisabled=()=>{r&&r.classList.add("esgst-hidden")},i}function rs(e){let t=new lt({addScrollable:!0,icon:"fa-circle-o-notch fa-spin",title:"Calculating data sizes..."});t.open(us.bind(null,e,ss,t))}async function ls(e,t,s,n){switch(t){case ns:es.manage(es.DROPBOX,null,e,n);break;case as:es.manage(es.GOOGLEDRIVE,null,e,n);break;case is:es.manage(es.ONEDRIVE,null,e,n);break;case ss:{let t,a;const i=new lt({isTemp:!0});i.setScrollable(Se.element("fragment",null,Se.element("input",{type:"file",ref:e=>t=e}),Se.element("div",{className:"esgst-description esgst-warning",ref:e=>a=e}))),i.onCloseByUser=n;const o=()=>{i.close(),n()};t.addEventListener("change",()=>{const n=t.files[0];if(n){e.reader=new FileReader;const t=n.name.match(/\.zip$/);e.reader.onload=async()=>{try{await async function(e,t,s,n,a){e.reader&&(e.data=JSON.parse(n?(await c.common.readZip(e.reader.result))[0].value:e.reader.result));c.common.createConfirmation("Are you sure you want to restore the selected data?",us.bind(null,e,t,s,a),a)}(e,ss,s,t,o)}catch(e){c.common.createFadeMessage(a,"Cannot parse file!")}},t?e.reader.readAsBinaryString(n):e.reader.readAsText(n)}else c.common.createFadeMessage(a,"No file was loaded!")}),i.open();break}case ts:{let a,i;const o=new lt({isTemp:!0});Se.insert(o.description,"beforeend",Se.element("fragment",null,Se.element("textarea",{className:"esgst-textarea-large",style:{width:"900px"},ref:e=>a=e}),Se.element("div",{className:"esgst-description esgst-warning",ref:e=>i=e}))),o.onCloseByUser=n;const r=()=>{o.close(),n()};tt.create({template:"success",name:"Restore",onClick:()=>{const n=a.value;if(n)try{e.data=JSON.parse(n),c.common.createConfirmation("Are you sure you want to restore the selected data?",us.bind(null,e,t,s,r),r)}catch(e){c.common.createFadeMessage(i,"Cannot parse data! Data should be in JSON format.")}else c.common.createFadeMessage(i,"No data was provided!")}}).insert(o.description,"beforeend"),o.open();break}}}function cs(e,t,s,n){c.common.createConfirmation("Are you sure you want to delete the selected data?",us.bind(null,e,t,s,n),n)}function ds(e,t,s){let n,a,i,o,l,g,u,m,h,p,f,b;console.log(e,t,s);let w={autoBackup:s&&c.esgst.parameters.autoBackup,type:e};switch(w[e]=!0,e){case"import":u=ls.bind(null),h="from",f="Restore",b="Restoring",w.pastTense="restored";break;case"export":u=us.bind(null),h="to",f="Backup",b="Backing up",w.pastTense="backed up";break;case"delete":u=cs.bind(null),h="from",f="Delete",b="Deleting",w.pastTense="deleted"}let y=null;if(!w.autoBackup){t?(y=new lt({addScrollable:"left",settings:!0,isTemp:!0}),n=y.description,a=y.scrollable):(a=n=c.esgst.sidebar.nextElementSibling,a.setAttribute("data-esgst-popup","true"),a.innerHTML=""),n.classList.add("esgst-text-left");const e=pt.create("storage",[{name:"ESGST",url:c.esgst.settingsUrl},{name:f,url:c.esgst[f.toLowerCase()+"Url"]}]).insert(n,"afterbegin").nodes.outer;t||(c.esgst.mainPageHeading=e),w.computerSpace=c.common.createElements(n,"beforeend",[{type:"div",children:[{text:"Total: ",type:"node"},{attributes:{class:"esgst-bold"},type:"span"},{attributes:{class:"esgst-clickable fa fa-refresh",title:"Calculate/refresh data sizes"},type:"i"}]}]),w.computerSpaceCount=w.computerSpace.firstElementChild,w.computerSpaceCount.nextElementSibling.addEventListener("click",()=>rs(w)),p=Mt.createMenuSection(a,null,1,f)}if(w.switches={},w.options=[{check:!0,key:"decryptedGiveaways",name:"Decrypted Giveaways"},{check:!0,key:"discussions",name:"Discussions",options:[{key:"discussions_main",name:"Main"},{key:"discussions_ct",name:"Comment Tracker"},{key:"discussions_df",name:"Discussion Filters"},{key:"discussions_dh",name:"Discussion Highlighter"},{key:"discussions_dt",name:"Discussion Tags"},{key:"discussions_gdttt",name:"Giveaway/Discussion/Ticket/Trade Tracker"},{key:"discussions_tds",name:"Thread Subscription"},{key:"discussions_pm",name:"Puzzle Marker"}]},{check:!0,key:"emojis",name:"Emojis"},{check:!0,key:"entries",name:"Entries"},{check:!0,key:"games",name:"Games",options:[{key:"games_main",name:"Main"},{key:"games_egh",name:"Entered Game Highlighter"},{key:"games_gt",name:"Game Tags"},{key:"games_itadi",name:"IsThereAnyDeal Info"}]},{check:!0,key:"giveaways",name:"Giveaways",options:[{key:"giveaways_main",name:"Main"},{key:"giveaways_ct",name:"Comment Tracker"},{key:"giveaways_gb",name:"Giveaway Bookmarks"},{key:"giveaways_gdttt",name:"Giveaway/Discussion/Ticket/Trade Tracker"},{key:"giveaways_gf",name:"Giveaway Filters"},{key:"giveaways_ggl",name:"Giveaway Group Loader"}]},{check:!0,key:"groups",name:"Groups",options:[{key:"groups_main",name:"Main"},{key:"groups_gpt",name:"Group Tags"},{key:"groups_sgg",name:"Stickied Giveaway Groups"}]},{check:!0,key:"rerolls",name:"Rerolls"},{check:!0,key:"savedReplies",name:"Saved Replies"},{check:!0,key:"savedReplies_st",name:"Saved Replies (SteamTrades)"},{check:!0,key:"settings",name:"Settings"},{check:!0,key:"sgCommentHistory",name:"SG Comment History"},{check:!0,key:"stickiedCountries",name:"Stickied Giveaway Countries"},{check:!0,key:"templates",name:"Templates"},{check:w.export||w.delete,key:"customTheme",name:"Custom Theme"},{check:!0,key:"tickets",name:"Tickets",options:[{key:"tickets_main",name:"Main"},{key:"tickets_ct",name:"Comment Tracker"},{key:"tickets_gdttt",name:"Giveaway/Discussion/Ticket/Trade Tracker"}]},{check:!0,key:"trades",name:"Trades",options:[{key:"trades_main",name:"Main"},{key:"trades_ct",name:"Comment Tracker"},{key:"trades_tf",name:"Trade Filters"},{key:"trades_gdttt",name:"Giveaway/Discussion/Ticket/Trade Tracker"},{key:"trades_tds",name:"Thread Subscription"}]},{check:!0,key:"users",name:"Users",options:[{key:"users_main",name:"Main"},{key:"users_cdr",name:"Cake Day Reminder"},{key:"users_namwc",name:"Not Activated/Multiple Win  Checker"},{key:"users_nrf",name:"Not Received Finder"},{key:"users_uf",name:"User Filters"},{key:"users_giveaways",name:"Giveaways Data"},{key:"users_notes",name:"User Notes"},{key:"users_tags",name:"User Tags"},{key:"users_wbc",name:"Whitelist/Blacklist Checker"}]},{check:!0,key:"winners",name:"Winners"}],w.autoBackup){let e;switch(d.get("autoBackup_index")){case 0:e=ss;break;case 1:e=ns;break;case 2:e=as;break;case 3:e=is}us(w,e,!1,async()=>{r.delete("isBackingUp"),await c.common.setSetting("lastBackup",Date.now()),s()})}else{for(l=0,g=w.options.length;l<g;++l)m=w.options[l],m.check&&p.lastElementChild.appendChild(os(m,w.switches,e));o=c.common.createElements(n,"beforeend",[{attributes:{class:"esgst-button-group"},type:"div",children:[{text:`${f} ${h}:`,type:"span"}]}]),tt.create([{color:"green",icons:["fa-align-left"],name:"Text",onClick:()=>new Promise(async e=>{if("export"!==w.type){let t;switch(d.get("exportBackupIndex")){case 0:t=!0;break;case 1:t=await ut.contains([["dropbox"]]);break;case 2:t=await ut.contains([["googleDrive"]]);break;case 3:t=await ut.contains([["oneDrive"]])}if(!t)return void e()}u(w,ts,!1,()=>{us(w,ss,!0),e()})})},{template:"loading",isDisabled:!0,name:b}]).insert(o,"beforeend");const s=tt.create([{color:"green",icons:["fa-desktop"],name:"Computer",onClick:()=>new Promise(async e=>{if("export"!==w.type){let t;switch(d.get("exportBackupIndex")){case 0:t=!0;break;case 1:t=await ut.contains([["dropbox"]]);break;case 2:t=await ut.contains([["googleDrive"]]);break;case 3:t=await ut.contains([["oneDrive"]])}if(!t)return void e()}u(w,ss,!1,()=>{us(w,ss,!0),e()})})},{template:"loading",isDisabled:!0,name:b}]).insert(o,"beforeend");let a,r,v;if("delete"!==e&&(a=tt.create([{color:"green",icons:["fa-dropbox"],name:"Dropbox",onClick:()=>new Promise(async e=>{await ut.contains([["dropbox"]])?u(w,ns,!1,()=>{us(w,ss,!0),e()}):e()})},{template:"loading",isDisabled:!0,name:b}]).insert(o,"beforeend"),r=tt.create([{color:"green",icons:["fa-google"],name:"Google Drive",onClick:()=>new Promise(async e=>{await ut.contains([["googleDrive"]])?u(w,as,!1,()=>{us(w,ss,!0),e()}):e()})},{template:"loading",isDisabled:!0,name:b}]).insert(o,"beforeend"),v=tt.create([{color:"green",icons:["fa-windows"],name:"OneDrive",onClick:()=>new Promise(async e=>{await ut.contains([["oneDrive"]])?u(w,is,!1,()=>{us(w,ss,!0),e()}):e()})},{template:"loading",isDisabled:!0,name:b}]).insert(o,"beforeend")),"import"===e||"delete"===e){"import"===e&&new vt(n,"importAndMerge",!1,"Merge",!1,!1,"Merges the current data with the backup instead of replacing it.",d.get("importAndMerge"));let t=new vt(n,"exportBackup",!1,Se.element("fragment",null,"Backup to"," ",Se.element("select",null,Se.element("option",null,"Computer"),Se.element("option",null,"Dropbox"),Se.element("option",null,"Google Drive"),Se.element("option",null,"OneDrive"))),!1,!1,"Backs up the current data to one of the selected places before restoring another backup.",d.get("exportBackup")).name.firstElementChild;t.selectedIndex=d.get("exportBackupIndex"),t.addEventListener("change",()=>{c.common.setSetting("exportBackupIndex",t.selectedIndex)})}if("export"===e){const e=new vt(n,"deleteOldBackups",!1,Se.element("fragment",null,"Delete backups older than"," ",Se.element("input",{className:"esgst-switch-input",type:"number",value:d.get("deleteOldBackups_days")})," ","days when backing up to the cloud."),!1,!1,"",d.get("deleteOldBackups")).name.firstElementChild;c.common.observeNumChange(e,"deleteOldBackups_days",!0)}if("import"!==e&&"export"!==e||(c.common.observeChange(new vt(n,"usePreferredGoogle",!1,Se.element("fragment",null,"Use preferred Google account:"," ",Se.element("input",{className:"esgst-switch-input esgst-switch-input-large",placeholder:"example@gmail.com",type:"text"}),Se.element("span",{className:"esgst-bold esgst-clickable",onclick:()=>window.alert(d.get("preferredGoogle")||"No email address defined")},"Reveal")),!1,!1,'With this option enabled, you will not be prompted to select an account when restoring/backing up to Google Drive. The account associated with the email address entered here will be automatically selected if you\'re already logged in. For security purposes, the email address will not be visible if you re-open the menu. After that, you have to click on "Reveal" to see it.',d.get("usePreferredGoogle")).name.firstElementChild,"preferredGoogle",!0),c.common.observeChange(new vt(n,"usePreferredMicrosoft",!1,Se.element("fragment",null,"Use preferred Microsoft account:"," ",Se.element("input",{className:"esgst-switch-input esgst-switch-input-large",placeholder:"example@outlook.com",type:"text"}),Se.element("span",{className:"esgst-bold esgst-clickable",onclick:()=>window.alert(d.get("preferredMicrosoft")||"No email address defined")},"Reveal")),!1,!1,'With this option enabled, you will not be prompted to select an account when restoring/backing up to OneDrive. The account associated with the email address entered here will be automatically selected if you\'re already logged in. For security purposes, the email address will not be visible if you re-open the menu. After that, you have to click on "Reveal" to see it.',d.get("usePreferredMicrosoft")).name.firstElementChild,"preferredMicrosoft",!0)),w.message=c.common.createElements(n,"beforeend",[{attributes:{class:"esgst-description"},type:"div"}]),i=c.common.createElements(n,"beforeend",[{attributes:{class:"esgst-button-group"},type:"div",children:[{text:"Select:",type:"span"}]}]),tt.create([{color:"white",icons:["fa-square"],name:"All",onClick:c.common.selectSwitches.bind(c.common,w.switches,"enable",i)},{template:"loading",isDisabled:!0,name:""}]).insert(i,"beforeend"),tt.create([{color:"white",icons:["fa-square-o"],name:"None",onClick:c.common.selectSwitches.bind(c.common,w.switches,"disable",i)},{template:"loading",isDisabled:!0,name:""}]).insert(i,"beforeend"),tt.create([{color:"white",icons:["fa-plus-square-o"],name:"Inverse",onClick:c.common.selectSwitches.bind(c.common,w.switches,"toggle",i)},{template:"loading",isDisabled:!0,name:""}]).insert(i,"beforeend"),t&&y.open(),d.get("calculate"+c.common.capitalizeFirstLetter(e))&&rs(w),"backup"===c.esgst.parameters.esgst&&c.esgst.parameters.autoBackupIndex)switch(parseInt(c.esgst.parameters.autoBackupIndex)){case 0:s.onClick();break;case 1:a.onClick();break;case 2:r.onClick();break;case 3:v.onClick()}}}function gs(e){let t=null,s=null;if(e){const e=new lt({addScrollable:"left",settings:!0,isTemp:!0});t=e.description,s=e.scrollable,e.open()}else t=c.esgst.sidebar.nextElementSibling,t.innerHTML="",s=t,s.setAttribute("data-esgst-popup","true");const n=pt.create("storage",[{name:"ESGST",url:c.esgst.settingsUrl},{name:"Clean",url:c.esgst.cleanUrl}]).insert(t,"afterbegin").nodes.outer;e||(c.esgst.mainPageHeading=n),c.common.createElements(s,"beforeend",[{attributes:{class:"esgst-bold esgst-description esgst-red"},text:"Make sure to backup your data before using the cleaner.",type:"div"}]),c.common.observeNumChange(new vt(s,"cleanDiscussions",!1,Se.element("fragment",null,"Discussions data older than"," ",Se.element("input",{className:"esgst-switch-input",type:"text",value:d.get("cleanDiscussions_days")})," ","days."),!1,!1,"Discussions data only started being date-tracked since v7.11.0, so not all old data may be cleaned.",d.get("cleanDiscussions")).name.firstElementChild,"cleanDiscussions_days",!0),c.common.observeNumChange(new vt(s,"cleanEntries",!1,Se.element("fragment",null,"Entries data older than"," ",Se.element("input",{className:"esgst-switch-input",type:"text",value:d.get("cleanEntries_days")})," ","days."),!1,!1,"",d.get("cleanEntries")).name.firstElementChild,"cleanEntries_days",!0),c.common.observeNumChange(new vt(s,"cleanGiveaways",!1,Se.element("fragment",null,"Giveaways data older than"," ",Se.element("input",{className:"esgst-switch-input",type:"text",value:d.get("cleanGiveaways_days")})," ","days."),!1,!1,"Some giveaways data only started being date-tracked since v7.11.0, so not all old data may be cleaned.",d.get("cleanGiveaways")).name.firstElementChild,"cleanGiveaways_days",!0),c.common.observeNumChange(new vt(s,"cleanSgCommentHistory",!1,Se.element("fragment",null,"SteamGifts comment history data older than"," ",Se.element("input",{className:"esgst-switch-input",type:"text",value:d.get("cleanSgCommentHistory_days")})," ","days."),!1,!1,"",d.get("cleanSgCommentHistory")).name.firstElementChild,"cleanSgCommentHistory_days",!0),c.common.observeNumChange(new vt(s,"cleanTickets",!1,Se.element("fragment",null,"Tickets data older than"," ",Se.element("input",{className:"esgst-switch-input",type:"text",value:d.get("cleanTickets_days")})," ","days."),!1,!1,"Tickets data only started being date-tracked since v7.11.0, so not all old data may be cleaned.",d.get("cleanTickets")).name.firstElementChild,"cleanTickets_days",!0),c.common.observeNumChange(new vt(s,"cleanTrades",!1,Se.element("fragment",null,"Trades data older than"," ",Se.element("input",{className:"esgst-switch-input",type:"text",value:d.get("cleanTrades_days")})," ","days."),!1,!1,"Trades data only started being date-tracked since v7.11.0, so not all old data may be cleaned.",d.get("cleanTrades")).name.firstElementChild,"cleanTrades_days",!0),new vt(s,"cleanDuplicates",!1,"Duplicate data.",!1,!1,"Cleans up any duplicate data it finds.",d.get("cleanDuplicates")),tt.create([{template:"success",name:"Clean",onClick:async()=>{const e={options:[{check:!0,key:"decryptedGiveaways",name:"Decrypted Giveaways"},{check:!0,key:"discussions",name:"Discussions",options:[{key:"discussions_main",name:"Main"},{key:"discussions_ct",name:"Comment Tracker"},{key:"discussions_df",name:"Discussion Filters"},{key:"discussions_dh",name:"Discussion Highlighter"},{key:"discussions_dt",name:"Discussion Tags"},{key:"discussions_gdttt",name:"Giveaway/Discussion/Ticket/Trade Tracker"},{key:"discussions_tds",name:"Thread Subscription"},{key:"discussions_pm",name:"Puzzle Marker"}]},{check:!0,key:"emojis",name:"Emojis"},{check:!0,key:"entries",name:"Entries"},{check:!0,key:"games",name:"Games",options:[{key:"games_main",name:"Main"},{key:"games_egh",name:"Entered Game Highlighter"},{key:"games_gt",name:"Game Tags"},{key:"games_itadi",name:"IsThereAnyDeal Info"}]},{check:!0,key:"giveaways",name:"Giveaways",options:[{key:"giveaways_main",name:"Main"},{key:"giveaways_ct",name:"Comment Tracker"},{key:"giveaways_gb",name:"Giveaway Bookmarks"},{key:"giveaways_gdttt",name:"Giveaway/Discussion/Ticket/Trade Tracker"},{key:"giveaways_gf",name:"Giveaway Filters"},{key:"giveaways_ggl",name:"Giveaway Group Loader"}]},{check:!0,key:"groups",name:"Groups",options:[{key:"groups_main",name:"Main"},{key:"groups_gpt",name:"Group Tags"},{key:"groups_sgg",name:"Stickied Giveaway Groups"}]},{check:!0,key:"rerolls",name:"Rerolls"},{check:!0,key:"savedReplies",name:"Saved Replies"},{check:!0,key:"savedReplies_st",name:"Saved Replies (SteamTrades)"},{check:!0,key:"settings",name:"Settings"},{check:!0,key:"sgCommentHistory",name:"SG Comment History"},{check:!0,key:"stickiedCountries",name:"Stickied Giveaway Countries"},{check:!0,key:"templates",name:"Templates"},{check:!0,key:"tickets",name:"Tickets",options:[{key:"tickets_main",name:"Main"},{key:"tickets_ct",name:"Comment Tracker"},{key:"tickets_gdttt",name:"Giveaway/Discussion/Ticket/Trade Tracker"}]},{check:!0,key:"trades",name:"Trades",options:[{key:"trades_main",name:"Main"},{key:"trades_ct",name:"Comment Tracker"},{key:"trades_tf",name:"Trade Filters"},{key:"trades_gdttt",name:"Giveaway/Discussion/Ticket/Trade Tracker"},{key:"trades_tds",name:"Thread Subscription"}]},{check:!0,key:"users",name:"Users",options:[{key:"users_main",name:"Main"},{key:"users_cdr",name:"Cake Day Reminder"},{key:"users_namwc",name:"Not Activated/Multiple Win  Checker"},{key:"users_nrf",name:"Not Received Finder"},{key:"users_uf",name:"User Filters"},{key:"users_giveaways",name:"Giveaways Data"},{key:"users_notes",name:"User Notes"},{key:"users_tags",name:"User Tags"},{key:"users_wbc",name:"Whitelist/Blacklist Checker"}]},{check:!0,key:"winners",name:"Winners"}]},t=await us(e,ss,!0);let s=Date.now(),n={};if(d.get("cleanDiscussions")){let e=864e5*d.get("cleanDiscussions_days");n.discussions=JSON.parse(c.common.getValue("discussions","{}"));for(let t in n.discussions)if(n.discussions.hasOwnProperty(t)){let a=n.discussions[t];a.author!==d.get("username")&&a.lastUsed&&s-a.lastUsed>e&&delete n.discussions[t]}}if(d.get("cleanEntries")){let e=864e5*d.get("cleanEntries_days"),t=JSON.parse(c.common.getValue("entries","[]"));n.entries=[],t.forEach(t=>{s-t.timestamp<=e&&n.entries.push(t)})}if(d.get("cleanGiveaways")){let e=864e5*d.get("cleanGiveaways_days");n.giveaways=JSON.parse(c.common.getValue("giveaways","{}"));for(let t in n.giveaways)if(n.giveaways.hasOwnProperty(t)){let a=n.giveaways[t];a.creator!==d.get("username")&&(a.endTime&&s-a.endTime>e||a.lastUsed&&s-a.lastUsed>e)&&delete n.giveaways[t]}}if(d.get("cleanSgCommentHistory")){let e=864e5*d.get("cleanSgCommentHistory_days"),t=JSON.parse(c.common.getValue("sgCommentHistory","[]"));n.sgCommentHistory=[],t.forEach(t=>{s-t.timestamp<=e&&n.sgCommentHistory.push(t)})}if(d.get("cleanTickets")){let e=864e5*d.get("cleanTickets_days");n.tickets=JSON.parse(c.common.getValue("tickets","{}"));for(let t in n.tickets)if(n.tickets.hasOwnProperty(t)){let a=n.tickets[t];a.author!==d.get("username")&&a.lastUsed&&s-a.lastUsed>e&&delete n.tickets[t]}}if(d.get("cleanTrades")){let e=864e5*d.get("cleanTrades_days");n.trades=JSON.parse(c.common.getValue("trades","{}"));for(let t in n.trades)if(n.trades.hasOwnProperty(t)){let a=n.trades[t];a.author!==d.get("username")&&a.lastUsed&&s-a.lastUsed>e&&delete n.trades[t]}}if(d.get("cleanDuplicates")){n.users=JSON.parse(c.common.getValue("users",'{"steamIds":{},"users":{}}'));for(let e in n.users.users)if(n.users.users.hasOwnProperty(e)){let t=n.users.users[e].giveaways;t&&["sent","won"].forEach(e=>{["apps","subs"].forEach(s=>{for(let n in t[e][s])t[e][s].hasOwnProperty(n)&&(t[e][s][n]=Array.from(new Set(t[e][s][n])))})})}}for(let e in n)n.hasOwnProperty(e)&&(n[e]=JSON.stringify(n[e]));await c.common.setValues(n);const a=await us(e,ss,!0);new lt({icon:"fa-check",title:Se.element("fragment",null,"Success! The selected data was cleaned.",Se.element("br",null),Se.element("br",null),"Size before cleaning:"," ",Se.element("span",{className:"esgst-bold"},c.common.convertBytes(t)),Se.element("br",null),"Size after cleaning:"," ",Se.element("span",{className:"esgst-bold"},c.common.convertBytes(a)),Se.element("br",null),Se.element("br",null),Math.round(100*(100-a/t*100))/100+"% reduction")}).open()}},{template:"loading",isDisabled:!0,name:"Cleaning..."}]).insert(s,"beforeend")}async function us(e,t,s,n){console.log(e.type,t,s,n);let a,i={},o=0;if(!s)if("import"===e.type){const t=[];for(const s of Object.keys(e.data))(l.is(e.data[s],"object")||Array.isArray(e.data[s]))&&(e.data[s]=JSON.stringify(e.data[s]),t.push(s));await Kt.upgrade(e.data,e.data.v,!0);for(const s of t)e.data[s]=JSON.parse(e.data[s])}else"export"===e.type&&(i.v=c.common.getValue("v"));for(let t=0,n=e.options.length;t<n;t++){let n=e.options[t],r=n.key;if(!n.check||!e.autoBackup&&!s&&!d.get(`${e.type}_${r}`))continue;let g,u,m,h=null;switch(r){case"decryptedGiveaways":case"settings":if(i[r]=JSON.parse(c.common.getValue(r,"{}")),!s)if(e.import){let t=e.data[r];if(t)if(d.get("importAndMerge")){u=i[r];for(let e in t)t.hasOwnProperty(e)&&(u[e]=t[e]);await c.common.setValue(r,JSON.stringify(u))}else await c.common.setValue(r,JSON.stringify(t))}else e.delete&&await c.common.delValue(r);if(!e.autoBackup){let t=`{"${r}":${c.common.getValue(r,"{}")}}`.length;o+=t,e.switches&&(e.switches[r].size.textContent=c.common.convertBytes(t))}break;case"discussions":h||(h={main:["lastUsed"],ct:["count","readComments"],df:["hidden"],dh:["highlighted"],dt:["tags"],gdttt:["visited"],tds:["name","subscribed"],pm:["status"]});case"giveaways":h||(h={main:["code","comments","copies","creator","endTime","entries","gameId","gameName","gameSteamId","gameType","group","inviteOnly","lastUsed","level","numWinners","points","regionRestricted","started","startTime","whitelist","winners","v"],ct:["count","readComments"],gb:["bookmarked"],gdttt:["visited"],gf:["hidden"],ggl:["groups"]});case"tickets":h||(h={main:["lastUsed"],ct:["count","readComments"],gdttt:["visited"]});case"trades":h||(h={main:["lastUsed"],ct:["count","readComments"],tf:["hidden"],gdttt:["visited"],tds:["name","subscribed"]}),i[r]={},u=JSON.parse(c.common.getValue(r,"{}")),m={ct:0,df:0,dh:0,dt:0,gb:0,gdttt:0,tds:0,gf:0,tf:0,ggl:0,main:0,pm:0,total:0},g=!1;for(let t in u)if(u.hasOwnProperty(t)){let n={},a=0,o=0,l=0,c=null,p=!1;for(let i in h)if(h.hasOwnProperty(i)){d.get(`${e.type}_${r}_${i}`)&&(a+=1);for(let a=0,g=h[i].length;a<g;++a){let g=h[i][a],f=u[t][g];if(void 0!==f){"main"!==i&&(o+=1),(e.autoBackup||d.get(`${e.type}_${r}_${i}`)||"main"===i)&&(n[g]=f,"main"!==i&&(p=!0));let a=`"${g}":${JSON.stringify(f)},`.length;m[i]+=a,m.total+=a,c=i,!s&&e.delete&&d.get(`${e.type}_${r}_${i}`)&&"main"!==i&&(l+=1,delete u[t][g])}}}c&&(m[c]-=1,m.total-=1),(e.autoBackup||p||d.get(`${e.type}_${r}_main`))&&(i[r][t]=n,g=!0);let f=`"${t}":{},`.length;m.main+=f,m.total+=f,!s&&e.delete&&(d.get(`${e.type}_${r}_main`)&&o===l||a===Object.keys(h).length)&&delete u[t]}if(!s)if(e.import){let t=e.data[r];if(t){for(let s in t)if(t.hasOwnProperty(s)){u[s]||(u[s]={});for(let n in h)if(h.hasOwnProperty(n)&&d.get(`${e.type}_${r}_${n}`))if(d.get("importAndMerge"))for(let e=0,a=h[n].length;e<a;++e){let a=h[n][e];switch(a){case"tags":if(u[s].tags){let e=t[s].tags;for(let t=0,n=e.length;t<n;++t){let n=e[t];u[s].tags.indexOf(n)<0&&u[s].tags.push(n)}}else u[s].tags=t[s].tags;break;case"readComments":if(u[s].readComments)for(let e in u[s].readComments)u[s].readComments.hasOwnProperty(e)&&t[s].readComments[e]>u[s].readComments[e]&&(u[s].readComments[e]=t[s].readComments[e]);else u[s].readComments=t[s].readComments;break;default:u[s][a]=t[s][a]}}else for(let e=0,a=h[n].length;e<a;++e){let a=h[n][e];u[s][a]=t[s][a]}}await c.common.setValue(r,JSON.stringify(u))}}else e.delete&&await c.common.setValue(r,JSON.stringify(u));if(g&&(m.main-=1,m.total-=1),!e.autoBackup){let t=`{"${r}":{}}`.length;if(m.main+=t,m.total+=t,e.switches){for(let t in h)h.hasOwnProperty(t)&&e.switches[`${r}_${t}`]&&(e.switches[`${r}_${t}`].size.textContent=c.common.convertBytes(m[t]));e.switches[r].size.textContent=c.common.convertBytes(m.total)}o+=m.total}break;case"customTheme":if(i.customTheme=c.common.getValue("customTheme",""),!s&&e.delete&&await c.common.delValue("customTheme"),!e.autoBackup){let t=i.customTheme.length;o+=t,e.switches&&(e.switches[r].size.textContent=c.common.convertBytes(t))}break;case"emojis":if(i.emojis=JSON.parse(c.common.getValue("emojis","[]")),!s)if(e.import){let t=JSON.stringify(e.data.emojis);t&&(d.get("importAndMerge")?await c.common.setValue("emojis",JSON.stringify(Array.from(new Set(i.emojis.concat(JSON.parse(c.common.fixEmojis(t))))))):await c.common.setValue("emojis",c.common.fixEmojis(t)))}else e.delete&&await c.common.delValue("emojis");if(!e.autoBackup){let t=`{"${r}":${c.common.getValue(r,'"[]"')}}`.length;o+=t,e.switches&&(e.switches[r].size.textContent=c.common.convertBytes(t))}break;case"entries":case"templates":case"savedReplies":case"savedReplies_st":if(i[r]=JSON.parse(c.common.getValue(r,"[]")),!s)if(e.import){let t=e.data[r];if(t)if(d.get("importAndMerge")){let e="entries"===r?"timestamp":"name";u=i[r];for(let s=0,n=t.length;s<n;++s){let n,a,i=t[s];for(n=0,a=u.length;n<a&&u[n][e]!==i[e];++n);n<a?u[n]=i:u.push(i)}"entries"===r&&(u=l.sortArray(u,!1,"timestamp")),await c.common.setValue(r,JSON.stringify(u))}else await c.common.setValue(r,JSON.stringify(t))}else e.delete&&await c.common.delValue(r);if(!e.autoBackup){let t=`{"${r}":${c.common.getValue(r,"[]")}}`.length;o+=t,e.switches&&(e.switches[r].size.textContent=c.common.convertBytes(t))}break;case"games":h={main:["apps","packages","reducedCV","noCV","hidden","ignored","owned","wishlisted","followed","sgId"],gt:["tags"],egh:["entered"],itadi:["itadi"]},i.games={apps:{},subs:{}},u=JSON.parse(c.common.getValue("games",'{"apps":{},"subs":{}}')),m={egh:0,gt:0,itadi:0,main:0,total:0},g=!1;for(let t in u.apps)if(u.apps.hasOwnProperty(t)){let n=u.apps[t],a={},o=0,l=0,c=0,p=null,f=!1;for(let t in h)if(h.hasOwnProperty(t)){d.get(`${e.type}_games_${t}`)&&(o+=1);for(let i=0,o=h[t].length;i<o;++i){let o=h[t][i],r=n[o];if(void 0!==r){"main"!==t&&(l+=1),(e.autoBackup||d.get(`${e.type}_games_${t}`)||"main"===t)&&(a[o]=r,"main"!==t&&(f=!0));let i=`"${o}":${JSON.stringify(r)},`.length;m[t]+=i,m.total+=i,p=t,!s&&e.delete&&d.get(`${e.type}_games_${t}`)&&"main"!==t&&(c+=1,delete n[o])}}}p&&(m[p]-=1,m.total-=1),(e.autoBackup||f||d.get(`${e.type}_${r}_main`))&&(i.games.apps[t]=a,g=!0);let b=`"${t}":{},`.length;m.main+=b,m.total+=b,!s&&e.delete&&(d.get(`${e.type}_${r}_main`)&&l===c||o===Object.keys(h).length)&&delete u.apps[t]}g&&(m.main-=1,m.total-=1),g=!1;for(let t in u.subs)if(u.subs.hasOwnProperty(t)){let n=u.subs[t],a={},o=0,l=0,c=0,p=null,f=!1;for(let t in h)if(h.hasOwnProperty(t)){d.get(`${e.type}_games_${t}`)&&(o+=1);for(let i=0,o=h[t].length;i<o;++i){let o=h[t][i],r=n[o];if(void 0!==r){"main"!==t&&(l+=1),(e.autoBackup||d.get(`${e.type}_games_${t}`)||"main"===t)&&(a[o]=r,"main"!==t&&(f=!0));let i=`"${o}":${JSON.stringify(r)},`.length;m[t]+=i,m.total+=i,p=t,!s&&e.delete&&d.get(`${e.type}_games_${t}`)&&"main"!==t&&(c+=1,delete n[o])}}}p&&(m[p]-=1,m.total-=1),(e.autoBackup||f||d.get(`${e.type}_${r}_main`))&&(i.games.subs[t]=a,g=!0);let b=`"${t}":{},`.length;m.main+=b,m.total+=b,!s&&e.delete&&(d.get(`${e.type}_${r}_main`)&&l===c||o===Object.keys(h).length)&&delete u.subs[t]}if(g&&(m.main-=1,m.total-=1),!s)if(e.import){let t=e.data.games;if(t){for(let s in t.apps)if(t.apps.hasOwnProperty(s)){let n=t.apps[s];u.apps[s]||(u.apps[s]={});let a=u.apps[s];for(let t in h)if(d.get(`${e.type}_games_${t}`))for(let e=0,s=h[t].length;e<s;++e){let s=h[t][e];if(void 0!==n[s])if(d.get("importAndMerge"))switch(s){case"entered":a.entered=!0;break;case"itadi":a.itadi?n.itadi.lastCheck>a.itadi.lastCheck&&(a.itadi=n.itadi):a.itadi=n.itadi;break;case"tags":if(a.tags){let e=n.tags;for(let t=0,s=e.length;t<s;++t){let s=e[t];a.tags.indexOf(s)<0&&a.tags.push(s)}}else a.tags=n.tags;break;default:a[s]=n[s]}else a[s]=n[s]}}for(let s in t.subs)if(t.subs.hasOwnProperty(s)){let n=t.subs[s];u.subs[s]||(u.subs[s]={});let a=u.subs[s];for(let t in h)if(d.get(`${e.type}_games_${t}`))for(let e=0,s=h[t].length;e<s;++e){let s=h[t][e];if(void 0!==n[s])if(d.get("importAndMerge"))switch(s){case"entered":a.entered=!0;break;case"itadi":a.itadi?n.itadi.lastCheck>a.itadi.lastCheck&&(a.itadi=n.itadi):a.itadi=n.itadi;break;case"tags":if(a.tags){let e=n.tags;for(let t=0,s=e.length;t<s;++t){let s=e[t];a.tags.indexOf(s)<0&&a.tags.push(s)}}else a.tags=n.tags;break;default:a[s]=n[s]}else a[s]=n[s]}}await c.common.setValue("games",JSON.stringify(u))}}else e.delete&&await c.common.setValue("games",JSON.stringify(u));if(!e.autoBackup){let t=`{"${r}":{"apps":{},"subs":{}}}`.length;if(m.main+=t,m.total+=t,e.switches){for(let t in h)h.hasOwnProperty(t)&&e.switches[`${r}_${t}`]&&(e.switches[`${r}_${t}`].size.textContent=c.common.convertBytes(m[t]));e.switches[r].size.textContent=c.common.convertBytes(m.total)}o+=m.total}break;case"groups":if(h={main:["avatar","code","member","name","steamId"],gpt:["tags"],sgg:["stickied"]},u=JSON.parse(c.common.getValue(r,"[]")),!Array.isArray(u)){let e=[];for(let t in u)u.hasOwnProperty(t)&&e.push(u[t]);u=e}i[r]=[],m={main:0,gpt:0,sgg:0,total:0},g=!1;for(let t=u.length-1;t>-1;--t){let n={},a=0,o=0,l=0,c=null,p=!1;for(let i in h)if(h.hasOwnProperty(i)){d.get(`${e.type}_${r}_${i}`)&&(a+=1);for(let a=0,g=h[i].length;a<g;++a){let g=h[i][a];if(u[t]){let a=u[t][g];if(void 0!==a){"main"!==i&&(o+=1),(e.autoBackup||d.get(`${e.type}_${r}_${i}`)||"main"===i)&&(n[g]=a,"main"!==i&&(p=!0));let h=`"${g}":${JSON.stringify(a)},`.length;m[i]+=h,m.total+=h,c=i,!s&&e.delete&&d.get(`${e.type}_${r}_${i}`)&&"main"!==i&&(l+=1,delete u[t][g])}}}}c&&(m[c]-=1,m.total-=1),(e.autoBackup||p||d.get(`${e.type}_${r}_main`))&&(i[r].push(n),g=!0);let f="{},".length;m.main+=f,m.total+=f,!s&&e.delete&&(d.get(`${e.type}_${r}_main`)&&o===l||a===Object.keys(h).length)&&u.pop()}if(g&&(m.main-=1,m.total-=1),!s)if(e.import){let t=e.data[r];if(!Array.isArray(t)){let e=[];for(let s in t)t.hasOwnProperty(s)&&e.push(t[s]);t=e}if(t){for(let s=t.length-1;s>-1;--s){let n,a,i=t[s].code;for(n=u.length-1;n>-1&&u[n].code!==i;--n);n>-1?a=u[n]:(a={},u.push(a));for(let n in h)if(h.hasOwnProperty(n)&&d.get(`${e.type}_${r}_${n}`))for(let e=0,i=h[n].length;e<i;++e){let i=h[n][e];switch(i){case"tags":if(a.tags){let e=t[s].tags;for(let t=0,s=e.length;t<s;++t){let s=e[t];a.tags.indexOf(s)<0&&a.tags.push(s)}}else a.tags=t[s].tags;break;default:a[i]=t[s][i]}}}await c.common.setValue(r,JSON.stringify(u))}}else e.delete&&await c.common.setValue(r,JSON.stringify(u));if(!e.autoBackup){let t=`{"${r}":[]}`.length;if(m.main+=t,m.total+=t,e.switches){for(let t in h)h.hasOwnProperty(t)&&e.switches[`${r}_${t}`]&&(e.switches[`${r}_${t}`].size.textContent=c.common.convertBytes(m[t]));e.switches[r].size.textContent=c.common.convertBytes(m.total)}o+=m.total}break;case"rerolls":case"stickiedCountries":if(i[r]=JSON.parse(c.common.getValue(r,"[]")),!s)if(e.import){let t=e.data[r];if(t)if(d.get("importAndMerge")){u=i[r];for(let e=0,s=t.length;e<s;++e){let s=t[e];u.indexOf(s)<0&&u.push(s)}await c.common.setValue(r,JSON.stringify(u))}else await c.common.setValue(r,JSON.stringify(t))}else e.delete&&await c.common.delValue(r);if(!e.autoBackup){let t=`{"${r}":${c.common.getValue(r,"[]")}}`.length;o+=t,e.switches&&(e.switches[r].size.textContent=c.common.convertBytes(t))}break;case"sgCommentHistory":if(i[r]=JSON.parse(c.common.getValue(r,"[]")),!s)if(e.import){let t=e.data[r];if(t)if(d.get("importAndMerge")){u=[];let e=i[r],s=0,n=0,a=t.length,o=e.length;for(;s<o&&n<a;){let a=e[s],i=t[n];if(a.timestamp>i.timestamp)u.push(a),s+=1;else{let t;for(t=0;t<o&&e[t].id!==i.id;++t);t>=o&&u.push(i),n+=1}}for(;s<o;)u.push(e[s]),s+=1;for(;n<a;){let s,a=t[n];for(s=0;s<o&&e[s].id!==a.id;++s);s>=o&&u.push(a),n+=1}await c.common.setValue(r,JSON.stringify(u))}else await c.common.setValue(r,JSON.stringify(t))}else e.delete&&await c.common.delValue(r);if(!e.autoBackup){let t=`{"${r}":${c.common.getValue(r,"[]")}}`.length;o+=t,e.switches&&(e.switches[r].size.textContent=c.common.convertBytes(t))}break;case"users":h={main:["whitelisted","whitelistedDate","blacklisted","blacklistedDate","steamFriend"],cdr:["cdr","registrationDate"],giveaways:["giveaways"],namwc:["namwc"],notes:["notes"],nrf:["nrf"],tags:["tags"],uf:["uf"],wbc:["wbc"]},i.users={steamIds:{},users:{}},u=JSON.parse(c.common.getValue("users",'{"steamIds":{},"users":{}}')),m={cdr:0,giveaways:0,namwc:0,notes:0,nrf:0,main:0,tags:0,total:0,uf:0,wbc:0},g=!1,a=!1;for(let t in u.users)if(u.users.hasOwnProperty(t)){let n=u.users[t],o={},l=0,c=0,p=0,f=null,b=!1;for(let t in h)if(h.hasOwnProperty(t)){d.get(`${e.type}_users_${t}`)&&(l+=1);for(let a=0,i=h[t].length;a<i;++a){let i=h[t][a];if(void 0!==n[i]){"main"!==t&&(c+=1),(e.autoBackup||d.get(`${e.type}_users_${t}`)||"main"===t)&&(o[i]=n[i],"main"!==t&&(b=!0));let a=`"${i}":${JSON.stringify(n[i])},`.length;m[t]+=a,m.total+=a,f=t,!s&&e.delete&&d.get(`${e.type}_users_${t}`)&&"main"!==t&&(p+=1,delete n[i])}}}f&&(m[f]-=1,m.total-=1);let w=n.id,y=n.username,v=0;w&&(v+=`"id":"${w}",`.length),y&&(v+=`"username":"${y}","${y}":"${t}",`.length),(e.autoBackup||b||d.get(`${e.type}_${r}_main`))&&(w&&(o.id=w),y&&(o.username=y,i.users.steamIds[y]=t,a=!0),i.users.users[t]=o,g=!0),v+=`"${t}":{},`.length,m.main+=v,m.total+=v,!s&&e.delete&&(d.get(`${e.type}_${r}_main`)&&c===p||l===Object.keys(h).length)&&(delete u.steamIds[n.username],delete u.users[t])}if(g&&(m.main-=1,m.total-=1),a&&(m.main-=1,m.total-=1),!s)if(e.import){let t=e.data.users;if(t){for(let s in t.users)if(t.users.hasOwnProperty(s)){let n=t.users[s];u.users[s]||(u.users[s]={id:n.id,username:n.username},u.steamIds[n.username]=s);let a=u.users[s];for(let t in h)if(h.hasOwnProperty(t)&&d.get(`${e.type}_users_${t}`))for(let e=0,s=h[t].length;e<s;++e){let s=h[t][e];if(n[s])if(d.get("importAndMerge"))switch(s){case"whitelisted":case"whitelistedDate":case"blacklisted":case"blacklistedDate":case"steamFriend":a[s]=n[s];break;case"notes":a.notes=c.common.removeDuplicateNotes(a.notes?`${a.notes}\n\n${n.notes}`:n.notes);break;case"tags":if(a.tags){let e=n.tags;for(let t=0,s=e.length;t<s;++t){let s=e[t];a.tags.indexOf(s)<0&&a.tags.push(s)}}else a.tags=n.tags;break;case"giveaways":a.giveaways?(n.giveaways.wonTimestamp>a.giveaways.wonTimestamp&&(a.giveaways.won=n.giveaways.won,a.giveaways.wonTimestamp=n.giveaways.wonTimestamp),n.giveaways.sentTimestamp>a.giveaways.sentTimestamp&&(a.giveaways.sent=n.giveaways.sent,a.giveaways.sentTimestamp=n.giveaways.sentTimestamp)):a.giveaways=n.giveaways;break;default:a[s]&&a[s].lastCheck?n[s].lastCheck>a[s].lastCheck&&(a[s]=n[s]):a[s]=n[s]}else a[s]=n[s]}}await c.common.setValue("users",JSON.stringify(u))}}else e.delete&&await c.common.setValue("users",JSON.stringify(u));if(!e.autoBackup){let t=`{"${r}":{"steamIds":{},"users":{}}}`.length;if(m.main+=t,m.total+=t,e.switches){for(const t in h)h.hasOwnProperty(t)&&e.switches[`${r}_${t}`]&&(e.switches[`${r}_${t}`].size.textContent=c.common.convertBytes(m[t]));e.switches[r].size.textContent=c.common.convertBytes(m.total)}o+=m.total}break;case"winners":if(i.winners=JSON.parse(c.common.getValue("winners","{}")),!s)if(e.import){let t=e.data.winners;if(t)if(d.get("importAndMerge")){u=i.winners;for(let e in t)if(t.hasOwnProperty(e)){u[e]||(u[e]=[]);for(let s=0,n=t[e].length;s<n;++s){let n=t[e][s];u[e].indexOf(n)<0&&u[e].push(n)}}await c.common.setValue("winners",JSON.stringify(u))}else await c.common.setValue("winners",JSON.stringify(t))}else e.delete&&await c.common.delValue("winners");if(!e.autoBackup){let t=`{"${r}":${c.common.getValue(r,"{}")}}`.length;o+=t,e.switches&&(e.switches[r].size.textContent=c.common.convertBytes(t))}}}if(!e.autoBackup&&e.computerSpaceCount&&(e.computerSpaceCount.textContent=c.common.convertBytes(o)),s)return s.close&&s.close(),o;if("export"===e.type||d.get("exportBackup"))if(t===ns||"export"!==e.type&&1===d.get("exportBackupIndex"))es.manage(es.DROPBOX,i,e,n);else if(t===as||"export"!==e.type&&2===d.get("exportBackupIndex"))es.manage(es.GOOGLEDRIVE,i,e,n);else if(t===is||"export"!==e.type&&3===d.get("exportBackupIndex"))es.manage(es.ONEDRIVE,i,e,n);else if(t===ss||"export"!==e.type&&0===d.get("exportBackupIndex")){const t=""+(d.get("askFileName")?window.prompt("Enter the name of the file:","esgst_data_"+(new Date).toISOString().replace(/:/g,"_")):"esgst_data_"+(new Date).toISOString().replace(/:/g,"_"));if("null"===t)return void n();d.get("backupZip")?await c.common.downloadZip(i,t+".json",t+".zip"):c.common.downloadFile(JSON.stringify(i),t+".json"),e.autoBackup||c.common.createFadeMessage(e.message,`Data ${e.pastTense} with success!`),n()}else{const e=JSON.stringify(i),t=new lt({isTemp:!0});t.setScrollable(Se.element("div",{className:"markdown"},c.common.getCopyIcon(e),Se.element("pre",null,Se.element("code",null,e)))),t.onClose=n,t.open()}else c.common.createFadeMessage(e.message,`Data ${e.pastTense} with success!`),n()}const ms=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];const hs=new class extends gt{constructor(){super(),o()(this,"openRequestLog",async()=>{const e={minute:120,hour:2400,day:14400},t=new lt({icon:"fa-history",title:"SteamGifts Request Log",isTemp:!0}),[s]=Se.insert(t.description,"beforeend",Se.element("div",{className:"esgst-button-group"},"View: "));tt.create({color:"green",name:"Default",onClick:async()=>{await c.common.setSetting("sgRequestLog_view","default"),this.loadRequestLog(e,n)}}).insert(s,"beforeend"),tt.create({color:"green",name:"Minutes",onClick:async()=>{await c.common.setSetting("sgRequestLog_view","minute"),this.loadRequestLog(e,n)}}).insert(s,"beforeend"),tt.create({color:"green",name:"Hours",onClick:async()=>{await c.common.setSetting("sgRequestLog_view","hour"),this.loadRequestLog(e,n)}}).insert(s,"beforeend"),tt.create({color:"green",name:"Days",onClick:async()=>{await c.common.setSetting("sgRequestLog_view","day"),this.loadRequestLog(e,n)}}).insert(s,"beforeend");const n=t.getScrollable(null);n.className="markdown",t.open();do{this.loadRequestLog(e,n),await c.common.timeout(1e4)}while(t.isOpen)}),o()(this,"loadRequestLog",async(e,t)=>{const s=new Date,n=s.getTime(),a=s.getDate(),i=s.getHours(),o=s.getMinutes();s.setDate(a-1);const r=s.getDate();s.setHours(i-1);const g=s.getHours();s.setMinutes(o-1);s.getMinutes();const u={minute:{title:"Minute",items:[]},hour:{title:"Hour",items:[]},day:{title:"Day",items:[]}};c.esgst.requestLog=c.esgst.requestLog.filter(e=>n-e.timestamp<=2592e6);for(const e of c.esgst.requestLog){const t=new Date(e.timestamp),s=t.getDate(),n=t.getHours(),l=t.getMinutes();if(s===a){var m,h;u.day.items[0]||(u.day.items[0]={count:0,urls:{}}),u.day.items[0].urls[e.url]=(null!==(m=u.day.items[0].urls[e.url])&&void 0!==m?m:0)+1,u.day.items[0].count+=1;const t=i-n;u.hour.items[t]||(u.hour.items[t]={count:0,urls:{}}),u.hour.items[t].urls[e.url]=(null!==(h=u.hour.items[t].urls[e.url])&&void 0!==h?h:0)+1,u.hour.items[t].count+=1;const s=n===i?o-l:60-l+o;var p;if(s<60)u.minute.items[s]||(u.minute.items[s]={count:0,urls:{}}),u.minute.items[s].urls[e.url]=(null!==(p=u.minute.items[s].urls[e.url])&&void 0!==p?p:0)+1,u.minute.items[s].count+=1}else{if(s!==r)break;{var f;u.day.items[1]||(u.day.items[1]={count:0,urls:{}}),u.day.items[1].urls[e.url]=(null!==(f=u.day.items[1].urls[e.url])&&void 0!==f?f:0)+1,u.day.items[1].count+=1;const t=24-n+i;var b;if(t<24)u.hour.items[t]||(u.hour.items[t]={count:0,urls:{}}),u.hour.items[t].urls[e.url]=(null!==(b=u.hour.items[t].urls[e.url])&&void 0!==b?b:0)+1,u.hour.items[t].count+=1;if(n===g){const t=60-l+o;var w;if(t<60)u.minute.items[t]||(u.minute.items[t]={count:0,urls:{}}),u.minute.items[t].urls[e.url]=(null!==(w=u.minute.items[t].urls[e.url])&&void 0!==w?w:0)+1,u.minute.items[t].count+=1}}}}await c.common.setValue("requestLog",JSON.stringify(c.esgst.requestLog));for(const e in u)for(let t=0,s=u[e].items.length;t<s;t++)u[e].items[t]&&(u[e].items[t].urls=l.sortArray(Object.entries(u[e].items[t].urls).map(([e,t])=>({url:e,count:t})),!0,"count"));const y=[],v=d.get("sgRequestLog_view");if(v&&"default"!==v){const t=v;for(let s=0,n=u[t].items.length;s<n;s++){var _,k,x,A;let n;const a=null!==(_=null===(k=u[t].items[s])||void 0===k?void 0:k.count)&&void 0!==_?_:0,i=Math.round(a/e[t]*100)/100;if(0===s){const s=e[t]-a,o=Math.round(100*(100-i))/100;n=`This ${u[t].title} - Current: ${a} (${i}%) / Left: ${s} (${o}%) / Max: ${e[t]}`}else n=`${s} ${l.getPlural(s,u[t].title)} Ago - ${a} (${i}%)`;y.push(_t.create(Se.element("h3",null,n),Se.element("ul",null,(null!==(x=null===(A=u[t].items[s])||void 0===A?void 0:A.urls)&&void 0!==x?x:[]).map(({url:e,count:t})=>Se.element("li",null,Se.element("a",{href:e},e)," (",t,")"))),`sgRequestLog_${t}_${s}`))}}else for(const t of[0,1])for(const s in u){var C,S,E,T;let n;const a=null!==(C=null===(S=u[s].items[t])||void 0===S?void 0:S.count)&&void 0!==C?C:0,i=Math.round(a/e[s]*1e4)/100;if(0===t){const t=e[s]-a,o=Math.round(100*(100-i))/100;n=`This ${u[s].title} - Current: ${a} (${i}%) / Left: ${t} (${o}%) / Max: ${e[s]}`}else n=`Last ${u[s].title} - ${a} (${i}%)`;y.push(_t.create(Se.element("h3",null,n),Se.element("ul",null,(null!==(E=null===(T=u[s].items[t])||void 0===T?void 0:T.urls)&&void 0!==E?E:[]).map(({url:e,count:t})=>Se.element("li",null,Se.element("a",{href:e},e)," (",t,")"))),`sgRequestLog_${s}_${t}`))}Se.insert(t,"atinner",Se.element("fragment",null,Se.element("p",null,Se.element("em",null,"Last updated ",s.toLocaleString()),Se.element("br",null),Se.element("em",null,"Remember that this does not include the requests you make while browsing SteamGifts, so you don't want to reach 0 requests left, because that leaves exactly 0 requests for your browsing.")),y))}),o()(this,"moveAdsDown",e=>{if(!c.common.isCurrentPath("Browse Giveaways"))return;let t;e.mainContext=this.esgst.pagination.previousElementSibling;for(const s of e.mainContext.children)s.classList.contains("giveaway__row-outer-wrap")||s.classList.contains("esgst-es-page-divider")||(t||(t=s),s.remove());t&&e.mainContext.appendChild(t)}),this.info={id:"common",name:"Common",type:"general"}}minimizePanel_add(){this.esgst.pageOuterWrap&&(this.esgst.minimizePanel=this.createElements(this.esgst.pageOuterWrap,"beforeend",[{attributes:{class:"esgst-minimize-panel"},type:"div",children:[{attributes:{class:"esgst-minimize-container markdown"},type:"div",children:[{text:"Minimized Popups:",type:"h3"},{type:"hr"},{attributes:{class:"esgst-minimize-list"},type:"ul"}]}]}]),this.esgst.minimizeList=this.esgst.minimizePanel.firstElementChild.lastElementChild)}minimizePanel_addItem(e){this.esgst.minimizeList&&(e.minimizeItem=this.createElements(this.esgst.minimizeList,"beforeend",[{attributes:{class:"esgst-minimize-item"},type:"li",children:[{attributes:{href:"javascript:void(0);"},text:e.title.textContent.replace(/:$/,""),type:"a"}]}]),e.minimizeLink=e.minimizeItem.firstElementChild,e.minimizeItem.addEventListener("click",this.minimizePanel_openItem.bind(this,e)))}minimizePanel_openItem(e){e.open(),e.minimizeItem.remove(),e.minimizeItem=null,this.esgst.minimizePanel.getElementsByClassName("alert").length||this.esgst.minimizePanel.classList.remove("alert")}minimizePanel_alert(e){e.minimizeItem&&e.minimizeItem.classList.add("alert"),d.get("minimizePanel")&&this.esgst.minimizePanel.classList.add("alert")}setSidebarActive(e){const t=this.esgst.sidebar.querySelector(".is-selected");t.querySelector(".fa-caret-right").remove(),t.classList.remove("is-selected");const s=document.querySelector("#"+e);s.classList.add("is-selected"),Se.insert(s.querySelector(".sidebar__navigation__item__link"),"afterbegin",Se.element("i",{className:"fa fa-caret-right"}))}async loadFeatures(e){if(this.isCurrentPath("Account")){var t;if(this.createSidebarNavigation(this.esgst.sidebar,"beforeend",{name:"ESGST",items:[{id:"settings",name:"Settings",url:this.esgst.settingsUrl},{id:"sync",name:"Sync",url:this.esgst.syncUrl},{id:"backup",name:"Backup",url:this.esgst.backupUrl},{id:"restore",name:"Restore",url:this.esgst.restoreUrl},{id:"delete",name:"Delete",url:this.esgst.deleteUrl},{id:"clean",name:"Clean",url:this.esgst.cleanUrl},{id:"data-management",name:"Data Management",url:this.esgst.dataManagementUrl}]}),null!==(t=this.esgst.parameters.esgst)&&void 0!==t&&t.match(/^(settings|sync|backup|restore|delete|clean|data-management)$/)&&Ee.subscribe(Je,e=>e.nodes.outer.classList.add("esgst-fmph")),"debug"===this.esgst.parameters.esgst){let e;return void Se.insert(document.body,"atinner",Se.element("fragment",null,Se.element("textarea",{ref:t=>e=t}),Se.element("button",{onclick:()=>Function('"use strict";'+e.value).call(c)},"Debug")))}"settings"===this.esgst.parameters.esgst?(this.setSidebarActive("settings"),Mt.loadMenu()):"sync"===this.esgst.parameters.esgst?(this.setSidebarActive("sync"),await Lt()):"backup"===this.esgst.parameters.esgst?(this.setSidebarActive("backup"),ds("export")):"restore"===this.esgst.parameters.esgst?(this.setSidebarActive("restore"),ds("import")):"delete"===this.esgst.parameters.esgst?(this.setSidebarActive("delete"),ds("delete")):"clean"===this.esgst.parameters.esgst?(this.setSidebarActive("clean"),gs()):"data-management"===this.esgst.parameters.esgst&&(this.setSidebarActive("data-management"),this.loadDM())}let s,n;d.get("minimizePanel")&&this.minimizePanel_add(),this.esgst.mainPageHeading&&(Se.insert(this.esgst.mainPageHeading,"afterbegin",Se.element("div",{className:"esgst-page-heading esgst-page-heading-buttons",ref:e=>this.esgst.leftMainPageHeadingButtons=e})),Se.insert(this.esgst.mainPageHeading,"beforeend",Se.element("div",{className:"esgst-page-heading esgst-page-heading-buttons",ref:e=>this.esgst.rightMainPageHeadingButtons=e}))),s=document.createElement("div"),s.className="esgst-heading-button",Se.insert(s,"atinner",Se.element("i",{className:"fa fa-ellipsis-v"})),this.esgst.leftButtons=this.createElements(new mt("esgst-hidden-buttons",s,0,!0).popout,"beforeend",[{attributes:{class:"esgst-page-heading"},type:"div"}]),n=document.createElement("div"),n.className="esgst-heading-button",Se.insert(n,"atinner",Se.element("i",{className:"fa fa-ellipsis-v"})),this.esgst.rightButtons=this.createElements(new mt("esgst-hidden-buttons",n,0,!0).popout,"beforeend",[{attributes:{class:"esgst-page-heading"},type:"div"}]),this.isGiveawayHeadingDefault=this.areArraysEqual(d.get("giveawayHeading"),d.defaultValues.giveawayHeading),this.isGiveawayHeadingGvDefault=this.areArraysEqual(d.get("giveawayHeading_gv"),d.defaultValues.giveawayHeading_gv),this.isGiveawayColumnsDefault=this.areArraysEqual(d.get("giveawayColumns"),d.defaultValues.giveawayColumns),this.isGiveawayColumnsGvDefault=this.areArraysEqual(d.get("giveawayColumns_gv"),d.defaultValues.giveawayColumns_gv),this.isGiveawayPanelDefault=this.areArraysEqual(d.get("giveawayPanel"),d.defaultValues.giveawayPanel),this.isGiveawayPanelGvDefault=this.areArraysEqual(d.get("giveawayPanel_gv"),d.defaultValues.giveawayPanel_gv),this.isGiveawayLinksDefault=this.areArraysEqual(d.get("giveawayLinks"),d.defaultValues.giveawayLinks),this.isGiveawayLinksGvDefault=this.areArraysEqual(d.get("giveawayLinks_gv"),d.defaultValues.giveawayLinks_gv),this.isGiveawayExtraPanelDefault=this.areArraysEqual(d.get("giveawayExtraPanel"),d.defaultValues.giveawayExtraPanel),this.isGiveawayExtraPanelGvDefault=this.areArraysEqual(d.get("giveawayExtraPanel_gv"),d.defaultValues.giveawayExtraPanel_gv);for(const t in e){const s=e[t];if(s.info&&(s.info.endless||d.get(s.info.id))){if(s.info.featureMap)for(const e in s.info.featureMap){if(!s.info.featureMap.hasOwnProperty(e))continue;const t=s.info.featureMap[e];if(Array.isArray(t))for(const s of t)this.esgst[e+"Features"].push(s);else this.esgst[e+"Features"].push(t)}try{await s.init()}catch(e){dt.warning(s.info.name+" failed to load:"),dt.error(e.message)}}}const a=this.esgst.parameters.esgst?this.esgst.customPages[this.esgst.parameters.esgst]:null;if(a&&a.check?await a.load():c.esgst.parameters.esgst&&"ge"===c.esgst.parameters.esgst||await this.endless_load(document,!this.esgst.parameters.esgst),this.esgst.wbcButton&&!rt.findData("main","users").length&&this.esgst.wbcButton.classList.add("esgst-hidden"),this.esgst.uscButton&&!rt.findData("main","users").length&&this.esgst.uscButton.classList.add("esgst-hidden"),this.esgst.style.insertAdjacentText("beforeend",`\n\t\t\t.esgst-menu-split-fixed {\n\t\t\t\tmax-height: calc(100vh - ${this.esgst.commentsTop+55+(d.get("ff")?39:0)}px);\n\t\t\t\ttop: ${this.esgst.commentsTop+25}px;\n\t\t\t}\n\t\t`),d.get("lastSyncHiddenGames")>0){const e=document.getElementsByClassName("js__submit-hide-games")[0];e&&e.addEventListener("click",()=>this.updateHiddenGames(this.esgst.hidingGame.id,this.esgst.hidingGame.type,!1))}if(this.esgst.newGiveawayPath){document.getElementsByClassName("form__rows")[0]&&window.setTimeout(()=>this.checkNewGiveawayInput(document.getElementsByClassName("js__autocomplete-data")[0]),1e3)}this.esgst.mainPageHeading&&(this.esgst.leftMainPageHeadingButtons.querySelector(".esgst-heading-button:not(.esgst-hidden)")||this.esgst.leftMainPageHeadingButtons.classList.add("esgst-hidden"),this.esgst.rightMainPageHeadingButtons.querySelector(".esgst-heading-button:not(.esgst-hidden)")||this.esgst.rightMainPageHeadingButtons.classList.add("esgst-hidden"),this.esgst.leftButtons.querySelector(".esgst-heading-button:not(.esgst-hidden)")||s.classList.add("esgst-hidden"),this.esgst.rightButtons.querySelector(".esgst-heading-button:not(.esgst-hidden)")||n.classList.add("esgst-hidden"),this.esgst.mainPageHeading.insertBefore(s,this.esgst.mainPageHeading.firstElementChild),this.esgst.mainPageHeading.appendChild(n)),this.reorderButtons(this.esgst),this.processHash(),window.addEventListener("beforeunload",this.checkBusy.bind(this)),window.addEventListener("hashchange",this.goToComment.bind(this,null,null,!1)),c.esgst.replyBox&&d.get("jumpToReplyBox")&&c.esgst.replyBox.querySelector("textarea").focus();for(const e in this.esgst.documentEvents)this.esgst.documentEvents.hasOwnProperty(e)&&document.addEventListener(e,this.processEvent.bind(this,this.esgst.documentEvents[e]),!0);this.esgst.modules=e}processHash(){if(this.goToComment(this.esgst.originalHash,null,!1),this.esgst.parameters.esgst&&this.esgst.parameters.id){const e=document.querySelector(`[data-id="${this.esgst.parameters.id}"]`);if(e){const t=e.closest(".esgst-form-row-indent.esgst-hidden:not(.SMFeatures)");t&&t.previousElementSibling.firstElementChild.click(),this.goToComment("#"+this.esgst.parameters.id,e)}}}processEvent(e,t){for(const s of e)s(t)}async getElements(){var e;this.esgst.sg?(this.esgst.pageOuterWrapClass="page__outer-wrap",this.esgst.pageHeadingClass="page__heading",this.esgst.pageHeadingBreadcrumbsClass="page__heading__breadcrumbs",this.esgst.replyBox=document.querySelector(".comment--submit"),this.esgst.cancelButtonClass="comment__cancel-button",this.esgst.paginationNavigationClass="pagination__navigation",this.esgst.hiddenClass="is-hidden",this.esgst.selectedClass="is-selected"):(this.esgst.pageOuterWrapClass="page_outer_wrap",this.esgst.pageHeadingClass="page_heading",this.esgst.pageHeadingBreadcrumbsClass="page_heading_breadcrumbs",this.esgst.replyBox=document.querySelector(".reply_form"),null!==(e=this.esgst.replyBox)&&void 0!==e&&e.querySelector(".rating_checkbox")&&(this.esgst.reviewBox=this.esgst.replyBox,this.esgst.replyBox=null),this.esgst.cancelButtonClass="btn_cancel",this.esgst.paginationNavigationClass="pagination_navigation",this.esgst.hiddenClass="is_hidden",this.esgst.selectedClass="is_selected");const t=c.esgst.locationHref.match(/page=(\d+)/);this.esgst.currentPage=t?parseInt(t[1]):1;let s=window.location.href.replace(window.location.search,"").replace(window.location.hash,"").replace("/search","");this.esgst.originalUrl=s,this.esgst.favicon=document.querySelector('[rel="shortcut icon"]'),this.esgst.originalTitle=document.title,this.esgst.mainPath&&(s+=this.esgst.sg?"giveaways":"trades"),s+="/search?";let n=window.location.search.replace(/^\?/,"").split(/&/);for(let e=0,t=n.length;e<t;++e)n[e]&&!n[e].match(/page/)&&(s+=n[e]+"&");if(window.location.search&&(this.esgst.originalUrl=s.replace(/&$/,""),this.esgst.currentPage>1&&(this.esgst.originalUrl+="&page="+this.esgst.currentPage)),s+="page=",this.esgst.searchUrl=s,this.esgst.pagination=document.getElementsByClassName("pagination")[0],this.esgst.featuredContainer=document.getElementsByClassName("featured__container")[0],this.esgst.pageOuterWrap=document.getElementsByClassName(this.esgst.pageOuterWrapClass)[0],this.esgst.paginationNavigation=document.getElementsByClassName(this.esgst.paginationNavigationClass)[0],this.esgst.sidebar=document.getElementsByClassName("sidebar")[0],this.esgst.sidebar){this.esgst.enterGiveawayButton=this.esgst.sidebar.getElementsByClassName("sidebar__entry-insert")[0],this.esgst.leaveGiveawayButton=this.esgst.sidebar.getElementsByClassName("sidebar__entry-delete")[0],this.esgst.giveawayErrorButton=this.esgst.sidebar.getElementsByClassName("sidebar__error")[0];const e=document.querySelectorAll(".sidebar__heading");for(const t of e)this.esgst.sidebarGroups.push({heading:t,navigation:t.nextElementSibling})}const a=document.querySelector('.block_header > [href="/discussions"]');let i;this.esgst.activeDiscussions=a&&a.closest(".widget-container--margin-top"),this.esgst.pinnedGiveaways=document.getElementsByClassName("pinned-giveaways__outer-wrap")[0],i=this.esgst.commentsPath?1:0,this.esgst.pageHeadings=document.querySelectorAll("."+this.esgst.pageHeadingClass),this.esgst.mainPageHeading=document.getElementsByClassName(this.esgst.pageHeadingClass)[i],this.esgst.mainPageHeading||1!==i||(this.esgst.mainPageHeading=document.getElementsByClassName(this.esgst.pageHeadingClass)[0])}async checkNewGiveawayInput(e){"1"===e.style.opacity?e.getAttribute("data-esgst")||(e.setAttribute("data-esgst",!0),await this.loadNewGiveawayFeatures(e)):e.removeAttribute("data-esgst"),window.setTimeout(()=>this.checkNewGiveawayInput(e),1e3)}async loadNewGiveawayFeatures(e){await this.esgst.modules.games.games_load(e,!0)}async endless_load(e,t,s,n,a){this.purgeRemovedElements();for(let i of this.esgst.endlessFeatures)try{await i(e,t,s,n,a)}catch(e){dt.error(i.name,e.message,e.stack)}}purgeRemovedElements(){rt.purge();const e=["attachedImages","tsTables"];for(const t of e)for(let e=this.esgst[t].length-1;e>-1;e--)document.contains(this.esgst[t][e].outerWrap)||this.esgst[t].splice(e,1);for(const e in this.esgst.apPopouts)if(this.esgst.apPopouts.hasOwnProperty(e)){if(document.contains(this.esgst.apPopouts[e].popout))continue;delete this.esgst.apPopouts[e]}for(const e in this.esgst.currentUsers)if(this.esgst.currentUsers.hasOwnProperty(e)){const t=this.esgst.currentUsers[e].elements;for(let e=t.length-1;e>-1;e--)document.contains(t[e])||t.splice(e,1);if(t.length)continue;delete this.esgst.currentUsers[e]}}async saveComment(e,t,s,n,a,i,o){const r=d.get("username"),l={context:e,comment:n};await Ee.dispatch(ze,l),n=l.comment;const c=`xsrf_token=${Be.xsrfToken}&do=${this.esgst.sg?"comment_new":"comment_insert"}&trade_code=${t}&parent_id=${s}&description=${encodeURIComponent(n)}`;let g=null,u=await Ne.post(a,{data:c}),m=null,h=!0;if(this.esgst.sg)if(u.redirected){let e;if(m=u.html,s){var p,f;e=null!==(p=null===(f=m.querySelector(`[data-comment-id="${s}"]`))||void 0===f||null===(f=f.querySelector(".comment__children"))||void 0===f?void 0:f.children)&&void 0!==p?p:[]}else{var b;const t=null!==(b=m.querySelectorAll(".comments"))&&void 0!==b?b:[];e=t[t.length-1].children}e=Array.from(e).reverse();for(const t of e){var w,y;if((null!==(w=null===(y=t.querySelector(".comment__username"))||void 0===y?void 0:y.textContent.trim())&&void 0!==w?w:"")===r){var v,_;g=null!==(v=null===(_=t.querySelector(".comment__summary"))||void 0===_?void 0:_.id)&&void 0!==v?v:"";break}}}else h=!1;else{const e=u.json;var k,x;if(e.success)m=Se.parse(e.html),g=null!==(k=null===(x=m.querySelector(".comment_outer"))||void 0===x?void 0:x.id)&&void 0!==k?k:"";else h=!1}return h?(d.get("ch")&&this.esgst.modules.commentsCommentHistory.ch_saveComment(g,Date.now()),o?(await this.esgst.modules.giveawaysGiveawayEncrypterDecrypter.ged_saveGiveaways(this.esgst.sg?m.getElementById(g).closest(".comment"):m.getElementById(g),g),void(window.location.href="/go/comment/"+g)):{id:g,response:u,status:i}):(i instanceof at?i.setError("Failed!").show():this.createElements(i,"atinner",[{attributes:{class:"fa fa-times-circle"},type:"i"},{text:"Failed!",type:"span"}]),{id:null,response:null,status:i})}getFeatures(){const e={general:{features:{}},giveaways:{features:{}},discussions:{features:{}},trades:{features:{}},comments:{features:{}},users:{features:{}},groups:{features:{}},games:{features:{}},others:{features:{limitSteamStore:{description:()=>Se.element("ul",null,Se.element("li",null,"With this option enabled, requests to the Steam store will be limited to 1 per 200 milliseconds, to prevent the user from running into potential blocks, specially when using features like ",c.common.getFeatureName(null,"gc"),".")),name:"Limit Steam store requests.",sg:!0},useCustomAdaReqLim:{name:"Use custom adaptive request limits for SteamGifts.",sg:!0,inputItems:[{id:"customAdaReqLim_default",prefix:"1 request every ",suffix:" seconds (default)",attributes:{type:"number",min:"0.25",step:"0.01"}},{id:"customAdaReqLim_minute50",prefix:"1 request every ",suffix:" seconds (after using 50% of the minute limit)",attributes:{type:"number",min:"0.5",step:"0.01"}},{id:"customAdaReqLim_minute75",prefix:"1 request every ",suffix:" seconds (after using 75% of the minute limit)",attributes:{type:"number",min:"1",step:"0.01"}},{id:"customAdaReqLim_hourly75",prefix:"1 request every ",suffix:" seconds (after using 75% of the hourly limit)",attributes:{type:"number",min:"1.5",step:"0.01"}},{id:"customAdaReqLim_daily75",prefix:"1 request every ",suffix:" seconds (after using 75% of the daily limit)",attributes:{type:"number",min:"2",step:"0.01"}}]},notifyLogs:{name:"Notify about console logs.",sg:!0,st:!0},jumpToReplyBox:{name:"Jump to the reply box when loading a page that has one.",sg:!0,st:!0},removeSidebarInFeaturePages:{name:"Remove sidebar in feature pages (for example, Giveaway Extractor, Group/Library Wishlist Checker etc).",sg:!0},openSettingsInTab:{name:"Open settings menu in a new tab.",sg:!0,st:!0},activateTab:{description:()=>Se.element("ul",null,Se.element("li",null,"When a browser session is restored, you have to activate a tab so that it can be loaded. With this option enabled, ESGST automatically activates the first SG/ST tab open so that the extension can be injected immediately.")),extensionOnly:!0,name:"Activate the first SG/ST tab if a browser session was restored.",sg:!0,st:!0},manipulateCookies:{description:()=>Se.element("ul",null,Se.element("li",null,"You should enable this option if you use a single Firefox container for the common sites requested by ESGST that require you to be logged in (SteamGifts, SteamTrades, Steam, SGTools, etc...) or if you block third-party cookies. With it enabled, ESGST will read your cookies and modify request headers to make sure that requests are sent using the cookies from the current container you are on."),Se.element("li",null,"For example: you are only logged in on SteamGifts and Steam in the personal container. With this option disabled, when you try to sync your owned games on ESGST it will fail because it will use the default cookies (where you are not logged in). With this option enabled, the sync will succeed because the container cookies will be used instead (where you are logged in)."),Se.element("li",null,'If you are concerned about what exactly is done, you can check out the source code of the eventPage.js file, where the process occurs. Basically what happens is: the ID of your current container is retrieved from the tab that initiated the request and used to retrieve the cookies from that container (using the cookies API), then ESGST sends the request with a custom header "Esgst-Cookie" and the request is intercepted by the webRequest API, where the custom header is renamed to "Cookie" so that the cookies can be sent with the request. This is not a pretty solution, but it does the job until a better and more permanent solution comes along.')),extensionOnly:!0,name:"Allow ESGST to read your cookies and modify request headers when using Firefox containers or when blocking third-party cookies.",sg:!0,st:!0,permissions:["cookies"]},askFileName:{name:"Ask for file name when backing up data.",sg:!0,st:!0},autoBackup:{inputItems:[{id:"autoBackup_days",prefix:"Days: "}],name:"Automatically backup your data every specified number of days.",options:{title:"Backup to:",values:["Computer","Dropbox","Google Drive","OneDrive"]},sg:!0,st:!0},openAutoBackupNewTab:{name:"Open automatic backup in a new tab.",sg:!0,st:!0},autoSync:{name:"Automatically sync games/groups when syncing through SteamGifts.",sg:!0},openAutoSyncPopup:{name:"Open sync popup when automatically syncing by default.",sg:!0},openAutoSyncNewTab:{name:"Open automatic sync in a new tab.",sg:!0},calculateDelete:{name:"Calculate and show data sizes when opening the delete menu.",sg:!0,st:!0},backupZip:{name:"Backup data as a .zip file (smaller, but slower) instead of a .json file (larger, but faster).",sg:!0,st:!0},calculateExport:{name:"Calculate and show data sizes when opening the backup menu.",sg:!0,st:!0},calculateImport:{name:"Calculate and show data sizes when opening the restore menu.",sg:!0,st:!0},notifyNewVersion:{name:"Notify when a new ESGST version is available.",extensionOnly:!0,sg:!0,st:!0},makeSectionsCollapsible:{description:()=>Se.element("ul",null,Se.element("li",null,"The state of the sections is remembered if you save the settings after collapsing/expanding them.")),name:"Make sections in the settings menu collapsible.",sg:!0,st:!0},esgst:{name:"Enable ESGST for SteamTrades.",st:!0},enableByDefault:{name:"Enable new features and functionalities by default.",sg:!0,st:!0},fallbackSteamApi:{description:()=>Se.element("ul",null,Se.element("li",null,"With this option enabled, if you sync your games without being logged in to Steam, the Steam API will be used instead (less complete, so some of your games will be removed until you sync while logged in).")),name:"Fallback to Steam API when syncing without being logged in.",sg:!0,st:!0},static_popups:{name:"Make popups static (they are fixed at the top left corner of the page instead of being automatically centered).",sg:!0,st:!0},minimizePanel:{description:()=>Se.element("ul",null,Se.element("li",null,"When you close a non-temporary popup, it will be minimized to a panel that can be accessed by moving your mouse to the left corner of the window in any page. There you can quickly find and re-open all of the popups that you minimized."),Se.element("li",null,"A non-temporary popup is a popup that does not get destroyed when you close it. For example, the settings popup is a temporary popup - when you close it, the popup is destroyed, and when you click on the button to open the settings again, a new popup is created. The Whitelist/Blacklist Checker popup is an example of a non-temporary popup - if you close it and re-open it, it will be the exact same popup."),Se.element("li",null,"With this option enabled, the sync/backup popups become non-temporary, which allows you to close them and keep navigating through the page while ESGST is performing the sync/backup, without having to wait for it to finish."),Se.element("li",null,"Some popups will notify you when they are done. When this happens, a red bar will flash at the left side of the screen that only disappears when you open the minimize panel and re-open the popup that is requiring your attention.")),name:"Minimize non-temporary popups to a panel when closing them.",sg:!0,st:!0},getSyncGameNames:{description:()=>Se.element("ul",null,Se.element("li",null,"With this disabled, only the app/sub ids of the games will appear."),Se.element("li",null,"This can lead to lots of requests to the Steam store, so only enable it if you truly need to see the names of the games that were added/removed.")),name:"Retrieve game names when syncing.",sg:!0,st:!0},showChangelog:{name:"Show changelog from the new version when updating.",sg:!0,st:!0},showFeatureNumber:{name:"Show the feature number in the tooltips of elements added by ESGST.",sg:!0,st:!0}}}};for(const t in e)if(e.hasOwnProperty(t)){if("others"===t)continue;const s=Object.keys(this.esgst.modules).filter(e=>this.esgst.modules[e].info&&this.esgst.modules[e].info.type===t).sort((e,t)=>this.esgst.modules[e].info.id.localeCompare(this.esgst.modules[t].info.id,{sensitivity:"base"}));for(const n of s){const s=this.esgst.modules[n];e[t].features[s.info.id]=s.info}}return e}getFeaturesById(){const e={},t={};for(const s in c.esgst.features)for(const n in c.esgst.features[s].features){const a=c.esgst.features[s].features[n];this.getFeatureById(a,n,e,t)}for(const[t,s]of Object.entries(e)){if(!s.alias)continue;const n=e[s.alias];for(const e in n)s[e]=n[e];s.id=t}return[e,t]}getFeatureById(e,t,s,n){if(e.id=t,s[t]=e,e.features)for(const a in e.features){const i=e.features[a];n[a]=t,this.getFeatureById(i,a,s,n)}}checkBusy(e){if(document.getElementsByClassName("esgst-busy")[0]||this.esgst.busy)return e.returnValue=!0,!0}setMouseEvent(e,t,s,n){let a=-1,i=[0,0];e.addEventListener("mousedown",e=>{2!==e.button&&(1===e.button&&e.preventDefault(),a=e.button,i=[e.pageX,e.pageY])}),e.addEventListener("mousemove",e=>{-1===a||e.pageX===i[0]&&e.pageY===i[1]||(a=-1)}),e.addEventListener("mouseup",()=>{-1!==a&&(d.get(t)||1===a?yt.open(s):n(),a=-1,i=[0,0])})}createHeadingButton(e){let t=e.context;const s=e.orderId||e.id;if(!t){if("gmf"===s&&c.esgst.discussionPath)return t=document.querySelector(".page__heading__breadcrumbs"),t.parentElement.insertBefore(e.element,t),t.previousElementSibling;t=d.get("leftButtonIds").indexOf(s)>-1?this.esgst.leftButtons:d.get("rightButtonIds").indexOf(s)>-1?this.esgst.rightButtons:d.get("leftMainPageHeadingIds").indexOf(s)>-1?this.esgst.leftMainPageHeadingButtons:this.esgst.rightMainPageHeadingButtons}if(e.element)return t.appendChild(e.element),t.lastElementChild;const n=[];e.isSwitch&&n.push({type:"span"});for(const t of e.icons)n.push({attributes:{class:"fa "+t},type:"i"});const a={class:"esgst-heading-button","data-draggable-id":s,id:"esgst-"+e.id,title:this.getFeatureTooltip(e.featureId||e.id,e.title)};return e.link&&(a.href=e.link,a.target="_blank"),this.createElements(t,"beforeend",[{attributes:a,type:e.link?"a":"div",children:n}])}async checkNewVersion(){if(c.esgst.isFirstRun){this.setSetting("dismissedOptions",this.esgst.toDismiss);const e=new lt({addScrollable:!0,icon:"fa-smile-o",isTemp:!0,title:Se.element("fragment",null,Se.element("i",{className:"fa fa-circle-o-notch fa-spin"})," Hi! ESGST is retrieving your avatar, username and Steam ID. This will not take long...")});e.open(),await this.checkSync(!0),e.close(),wt.run(),c.esgst.isFirstRun=!1}else if(c.esgst.isUpdate&&d.get("showChangelog")){if(!await ut.contains([["github"]]))return new lt({addScrollable:!0,icon:"fa-check",isTemp:!0,title:Se.element("fragment",null,"ESGST has updated from v",c.esgst.previousVersion," to v",c.esgst.currentVersion,"! Please go to"," ",Se.element("a",{href:"https://github.com/SquishedPotatoe/esgst/-/releases"},"https://github.com/SquishedPotatoe/esgst/-/releases")," ",'to view the changelog. If you want the changelog to be automatically retrieved from GitHub and shown in this popup when updating, then go to the settings menu and grant permission to "github.com"')}).open(),void(c.esgst.isUpdate=!1);const e=new lt({addScrollable:!0,icon:"fa-circle-o-notch fa-spin",isTemp:!0,title:`ESGST has updated from v${c.esgst.previousVersion} to v${c.esgst.currentVersion}! Please wait while the changelog is retrieved from GitHub.`});e.open();try{let t="";const s=await Ne.get("https://api.github.com/repos/SquishedPotatoe/esgst/git/matching-refs/tags");if(!s||!s.json)return;const n=s.json;n.reverse();let a=n.findIndex(e=>e.ref==="refs/tags/v"+c.esgst.currentVersion);const i=n.findIndex(e=>e.ref==="refs/tags/v"+c.esgst.previousVersion);if(a>-1&&i>-1)for(;a<i;){const e=n[a].ref.split("/tags/")[1],s=await Ne.get("https://api.github.com/repos/SquishedPotatoe/esgst/releases/tags/"+e);s&&s.json&&(t=`${t}## ${e}\n\n${s.json.body.replace(/#(\d+)/g,"[$1](https://github.com/SquishedPotatoe/esgst/issues/$1)")}\n\n`),a+=1}e.setIcon("fa-star"),e.setTitle(`ESGST has updated from v${c.esgst.previousVersion} to v${c.esgst.currentVersion}! Here's the changelog:`),e.getScrollable(Se.element("div",{className:"markdown"},await this.parseMarkdown(e.scrollable,t)))}catch(t){dt.warning(t.message),e.setIcon("fa-times"),e.setTitle(Se.element("fragment",null,"ESGST has updated from v",c.esgst.previousVersion," to v",c.esgst.currentVersion,"! An error occurred when retrieving the changelog from GitHub, please go to"," ",Se.element("a",{href:"https://github.com/SquishedPotatoe/esgst/releases"},"https://github.com/SquishedPotatoe/esgst/releases")," ","to view it."))}c.esgst.isUpdate=!1}}async parseMarkdown(e,t){const s={context:e,comment:t};return await Ee.dispatch(ze,s),t=s.comment,Array.from(Se.parse(this.esgst.markdownParser.text(t)).body.children)}async addGiveawayToStorage(){let e,t,s,n,a,i,o,r;i=new lt({addScrollable:!0,icon:"fa-circle-o-notch fa-spin",isTemp:!0,title:"Please wait... ESGST is adding this giveaway to the storage..."}),i.open();const l=await this.esgst.modules.giveaways.giveaways_get(document,!0,c.esgst.locationHref);if(l.length){e=l[0],t={},t[e.code]=e,r={steamId:d.get("steamId"),username:d.get("username"),values:{}};const c=await this.getUser(null,r);let g=null;if(c&&(g=c.giveaways),!g&&(g={sent:{apps:{},subs:{}},won:{apps:{},subs:{}},sentTimestamp:0,wonTimestamp:0},c&&(o=c.ugd,o))){if(o.sent){for(n in o.sent.apps)if(o.sent.apps.hasOwnProperty(n))for(g.sent.apps[n]=[],s=0,a=o.sent.apps[n].length;s<a;++s)t[o.sent.apps[n][s].code]=o.sent.apps[n][s],g.sent.apps[n].push(o.sent.apps[n][s].code);for(n in o.sent.subs)if(o.sent.subs.hasOwnProperty(n))for(g.sent.subs[n]=[],s=0,a=o.sent.subs[n].length;s<a;++s)t[o.sent.subs[n][s].code]=o.sent.subs[n][s],g.sent.subs[n].push(o.sent.subs[n][s].code);g.sentTimestamp=o.sentTimestamp}if(o.won){for(n in o.won.apps)if(o.won.apps.hasOwnProperty(n))for(g.won.apps[n]=[],s=0,a=o.won.apps[n].length;s<a;++s)t[o.won.apps[n][s].code]=o.won.apps[n][s],g.won.apps[n].push(o.won.apps[n][s].code);for(n in o.won.subs)if(o.won.subs.hasOwnProperty(n))for(g.won.subs[n]=[],s=0,a=o.won.subs[n].length;s<a;++s)t[o.won.subs[n][s].code]=o.won.subs[n][s],g.won.subs[n].push(o.won.subs[n][s].code);g.wonTimestamp=o.wonTimestamp}}g.sent[e.gameType][e.gameSteamId]||(g.sent[e.gameType][e.gameSteamId]=[]),g.sent[e.gameType][e.gameSteamId].indexOf(e.code)<0&&g.sent[e.gameType][e.gameSteamId].push(e.code),r.values={giveaways:g},await this.lockAndSaveGiveaways(t),await this.saveUser(null,null,r),i.close()}}reorderButtons(e){const t=[{context:e.leftButtons,id:"leftButtonIds"},{context:e.rightButtons,id:"rightButtonIds"},{context:e.leftMainPageHeadingButtons,id:"leftMainPageHeadingIds"},{context:e.rightMainPageHeadingButtons,id:"rightMainPageHeadingIds"}];for(const s of t)if(s.context)for(const t of d.get(s.id)){const n=(e.mainPageHeading||e.outerWrap).querySelectorAll(`[data-draggable-id="${t}"]`);for(const e of n)s.context.appendChild(e)}}async lockAndSaveSettings(e){const t=new Te("settings");await t.lock();const s=JSON.parse(this.getValue("settings","{}"));for(const t in e)null===e[t]?l.isSet(s[t])&&delete s[t]:s[t]=e[t];await this.setValue("settings",JSON.stringify(s)),await t.unlock()}async setSetting(){const e=new Te("settings");await e.lock();const t=JSON.parse(this.getValue("settings","{}")),s=Array.isArray(arguments[0])?arguments[0]:[{id:arguments[0],value:arguments[1],sg:arguments[2],st:arguments[3]}];for(const e of s)e.sg?e.id=e.id+"_sg":e.st&&(e.id=e.id+"_st"),d.set(e.id,e.value),t[e.id]=e.value;await this.setValue("settings",JSON.stringify(t)),await e.unlock()}dismissFeature(e,t){if(this.esgst.toDismiss.push(t),t.match(/^(chfl|sk_)/)&&this.esgst.toDismiss.push(e.inputItems),t.match(/^hr_.+_s$/)&&this.esgst.toDismiss.push(t+"_sound"),Array.isArray(e.inputItems))for(const t of e.inputItems)this.esgst.toDismiss.push(t.id);if(e.features)for(const t in e.features)e.features.hasOwnProperty(t)&&this.dismissFeature(e.features[t],t)}toggleHeaderMenu(e){e.stopPropagation();for(const e in c.header.buttonContainers){const t=c.header.buttonContainers[e];"esgst"===t.data.id?(t.nodes.relativeDropdown.classList.toggle(Ge[Be.namespace].hidden),t.nodes.arrow.classList.toggle(Ge[Be.namespace].selected)):t.data.isDropdown&&(t.nodes.relativeDropdown.classList.add(Ge[Be.namespace].hidden),t.nodes.arrow.classList.remove(Ge[Be.namespace].selected))}}getFeatureTooltip(e,t=""){return d.get("showFeatureNumber")?t?`${t}\n\nThis element was added by ESGST${e?` (${this.getFeatureNumber(e).number})`:""}`:"This element was added by ESGST"+(e?` (${this.getFeatureNumber(e).number})`:""):t}getFeatureName(e,t){let s=this.getFeatureNumber(t);return`${s.number} ${s.name}`}getFeatureNumber(e){let t=n.runtime.getURL?2:1;for(let s in this.esgst.features)if(this.esgst.features.hasOwnProperty(s)){let n=1;for(let a in this.esgst.features[s].features)if(this.esgst.features[s].features.hasOwnProperty(a)){let i=this.esgst.features[s].features[a],o=this.getFeatureNumber_2(i,a,n,t,e);if(o)return o;(i.sg||d.get("esgst_st"))&&(n+=1)}("trades"!==s||d.get("esgst_st"))&&(t+=1)}return{name:"",number:""}}getFeatureNumber_2(e,t,s,n,a){if(t===a)return{name:e.name,number:`${n}.${s}`};if(e.features){let t=1;for(let i in e.features)if(e.features.hasOwnProperty(i)){let o=e.features[i],r=this.getFeatureNumber_2(o,i,t,`${n}.${s}`,a);if(r)return r;(o.sg||d.get("esgst_st"))&&(t+=1)}}return null}async getUser(e,t){let s=null;if(e||(e=JSON.parse(this.getValue("users"))),t.steamId)s=e.users[t.steamId],s&&(t.id||(t.id=s.id),t.username||(t.username=s.username));else if(t.username){let n=e.steamIds[t.username];n&&(t.steamId=n,s=e.users[n])}return s}async saveUser(e,t,s){if(t||(t=JSON.parse(this.getValue("users"))),await this.getUser(t,s))if(e)s.steamId||(s.steamId=t.steamIds[s.username]),e.existing.push(s);else{const e=new Te("user",{threshold:300});await e.lock(),this.checkUsernameChange(t,s);for(let e in s.values)s.values.hasOwnProperty(e)&&"tags"!==e&&(null===s.values[e]?delete t.users[s.steamId][e]:t.users[s.steamId][e]=s.values[e]);await this.setValue("users",JSON.stringify(t)),await e.unlock()}else s.steamId&&s.username?e?e.new.push(s):await this.addUser(s):s.steamId?await this.getUsername(e,!0,s):await this.getSteamId(e,!0,null,s)}checkUsernameChange(e,t){let s,n;if(void 0!==e.users[t.steamId].username&&e.users[t.steamId].username!==t.username){if(delete e.steamIds[e.users[t.steamId].username],e.users[t.steamId].username=t.username,e.steamIds[t.username]=t.steamId,t.values.tags)for(e.users[t.steamId].tags||(e.users[t.steamId].tags=[]),s=0,n=t.values.tags.length;s<n;++s)e.users[t.steamId].tags.indexOf(t.values.tags[s])<0&&e.users[t.steamId].tags.push(t.values.tags[s]);return!0}void 0!==t.values.tags&&(e.users[t.steamId].tags=t.values.tags),e.users[t.steamId].tags||delete e.users[t.steamId].tags}async addUser(e){let t,s;const n=new Te("user",{threshold:300});await n.lock(),s=JSON.parse(this.getValue("users")),t=await this.getUser(s,e),t||(s.users[e.steamId]={}),e.id&&(s.users[e.steamId].id=e.id),this.checkUsernameChange(s,e),e.username&&(s.users[e.steamId].username=e.username,s.steamIds[e.username]=e.steamId);for(let t in e.values)e.values.hasOwnProperty(t)&&"tags"!==t&&(null===e.values[t]?delete s.users[e.steamId][t]:s.users[e.steamId][t]=e.values[t]);await this.setValue("users",JSON.stringify(s)),await n.unlock()}async getUsername(e,t,s){let n;const a=await Ne.get("https://www.steamgifts.com/go/user/"+s.steamId);if(n=a.url.match(/\/user\/(.+)/),n){s.username=n[1];let e=a.html.querySelector('[name="child_user_id"]');e&&(s.id=e.value)}t&&(e?e.new.push(s):await this.addUser(s))}async getSteamId(e,t,s,n){if(!t){s||(s=JSON.parse(this.getValue("users")));let e=s.steamIds[n.username];if(e)return n.steamId=e,void(n.id=s.users[e].id)}const a=await Ne.get(`https://www.steamgifts.com/user/${n.username}?format=json`);a.url.includes("/user/")&&a.json.success&&(n.steamId=a.json.user.steam_id,n.id=a.json.user.id,t&&(e?e.new.push(n):await this.addUser(n)))}async saveUsers(e){let t,s;t={existing:[],new:[]},s=JSON.parse(this.getValue("users"));for(let n=0,a=e.length;n<a;n++)await this.saveUser(t,s,e[n]);const n=new Te("user",{threshold:300});await n.lock(),s=JSON.parse(this.getValue("users"));for(let e=0,n=t.new.length;e<n;++e){let n,a;a=t.new[e],n=await this.getUser(s,a),n||(s.users[a.steamId]={}),a.id&&(s.users[a.steamId].id=a.id),this.checkUsernameChange(s,a),a.username&&(s.users[a.steamId].username=a.username,s.steamIds[a.username]=a.steamId);for(let e in a.values)a.values.hasOwnProperty(e)&&"tags"!==e&&(null===a.values[e]?delete s.users[a.steamId][e]:s.users[a.steamId][e]=a.values[e])}for(let e=0,n=t.existing.length;e<n;++e){let n=t.existing[e];this.checkUsernameChange(s,n);for(let e in n.values)n.values.hasOwnProperty(e)&&"tags"!==e&&(null===n.values[e]?delete s.users[n.steamId][e]:s.users[n.steamId][e]=n.values[e])}await this.setValue("users",JSON.stringify(s)),await n.unlock()}async deleteUserValues(e){const t=new Te("user",{threshold:300});await t.lock();const s=JSON.parse(this.getValue("users"));for(let t in s.users)if(s.users.hasOwnProperty(t))for(let n=0,a=e.length;n<a;++n)delete s.users[t][e[n]];await this.setValue("users",JSON.stringify(s)),await t.unlock()}async getUserId(e){e.username?await this.getSteamId(null,!1,null,e):await this.getUsername(null,!1,e)}async checkSync(e){let t=Date.now(),s=r.get("isSyncing");if(e)await Lt();else if(!s||t-s>18e5){let e="";r.set("isSyncing",t),["Groups","SteamFriends","Games","FollowedGames","WonGames","ReducedCvGames","NoCvGames","HltbTimes","DelistedGames","Giveaways","WonGiveaways"].forEach(s=>{d.get("autoSync"+s)&&t-d.get("lastSync"+s)>864e5*d.get("autoSync"+s)&&(e+=s+"=1&")}),e?d.get("openAutoSyncNewTab")?yt.open(`${c.esgst.syncUrl}&autoSync=true&${e}`):Nt(e):r.delete("isSyncing")}}async runSilentBackup(){const e=c.header.addButtonContainer({buttonIcon:"fa fa-sign-out fa-spin",buttonName:"ESGST Backup",isActive:!0,isNotification:!0,side:"right"});e.nodes.buttonIcon.title="ESGST is backing up your data... Please do not close this window.",this.esgst.parameters=Object.assign(this.esgst.parameters,{autoBackup:!0}),ds("export",!1,()=>{e.nodes.outer.classList.remove("nav__button-container--active"),e.nodes.outer.classList.add("nav__button-container--inactive"),e.nodes.buttonIcon.className="fa fa-check",e.nodes.buttonIcon.title="ESGST has finished backing up."})}async getGameNames(e){const t=e.getElementsByTagName("a");for(let e=t.length-1;e>-1;--e){const s=t[e],n=s.getAttribute("href").match(/\/(app|sub)\/(.+)/);if(!n)continue;const a=n[2];try{const e=await Ne.get(`http://store.steampowered.com/api/${"app"===n[1]?"appdetails?appids":"packagedetails?packageids"}=${a}&filters=basic`);s.textContent=e.json[a].data.name}catch(e){s.classList.add("esgst-red"),s.title="Unable to retrieve name for this game"}}}async lock_and_save_giveaways(e,t){return this.lockAndSaveGiveaways(e,t)}async lockAndSaveGiveaways(e,t){if(!Object.keys(e).length)return;let s,n;t?n=this.esgst.giveaways:(s=new Te("giveaway",{threshold:300}),await s.lock(),n=JSON.parse(this.getValue("giveaways","{}")));for(let t in e)if(e.hasOwnProperty(t))if(n[t])for(let s in e[t])e[t].hasOwnProperty(s)&&(null===s?delete n[t][s]:n[t][s]=e[t][s]);else n[t]=e[t];t||(await this.setValue("giveaways",JSON.stringify(n)),s&&await s.unlock())}async lockAndSaveDiscussions(e){const t=new Te("discussion",{threshold:300});await t.lock();const s=JSON.parse(this.getValue("discussions","{}"));for(let t in e)if(e.hasOwnProperty(t)){if(s[t])for(let n in e[t])e[t].hasOwnProperty(n)&&(null===e[t][n]?delete s[t][n]:s[t][n]=e[t][n]);else s[t]=e[t];s[t].readComments||(s[t].readComments={})}await this.setValue("discussions",JSON.stringify(s)),await t.unlock()}async lockAndSaveTickets(e){const t=new Te("ticket",{threshold:300});await t.lock();const s=JSON.parse(this.getValue("tickets","{}"));for(const t in e)if(e.hasOwnProperty(t)){if(s[t])for(const n in e[t])e[t].hasOwnProperty(n)&&(null===e[t][n]?delete s[t][n]:s[t][n]=e[t][n]);else s[t]=e[t];s[t].readComments||(s[t].readComments={})}await this.setValue("tickets",JSON.stringify(s)),await t.unlock()}async lockAndSaveTrades(e){const t=new Te("trade",{threshold:300});await t.lock();const s=JSON.parse(this.getValue("trades","{}"));for(const t in e)if(e.hasOwnProperty(t)){if(s[t])for(const n in e[t])e[t].hasOwnProperty(n)&&(null===e[t][n]?delete s[t][n]:s[t][n]=e[t][n]);else s[t]=e[t];s[t].readComments||(s[t].readComments={})}await this.setValue("trades",JSON.stringify(s)),await t.unlock()}async lockAndSaveGroups(e,t){const s=new Te("group",{threshold:300});await s.lock();let n=JSON.parse(this.getValue("groups","[]"));if(!Array.isArray(n)){const e=[];for(const t in n)n.hasOwnProperty(t)&&e.push(n[t]);n=e}if(t)for(const e of n)e&&delete e.member;for(const t in e)if(e.hasOwnProperty(t)){const s=e[t];let a=n.filter(e=>e.code===t)[0];if(a)for(const e in s)s.hasOwnProperty(e)&&(a[e]=s[e]);else a=s,n.push(a);if(!a.avatar||!a.steamId){const e=(await Ne.get(`/group/${t}/`)).html;a.avatar=e.getElementsByClassName("global__image-inner-wrap")[0].style.backgroundImage.match(/url\("(.+)"\)/)[1],a.steamId=e.getElementsByClassName("sidebar__shortcut-inner-wrap")[0].firstElementChild.getAttribute("href").match(/\d+/)[0]}}await this.setValue("groups",JSON.stringify(n)),await s.unlock()}lookForPopups(e){const t=e.html.querySelector(".popup--gift-sent, .popup--gift-received");if(!t)return;if(document.body.appendChild(t),new lt({addScrollable:!0,icon:"",isTemp:!0,title:"",popup:t}).open(),!this.esgst.st)return;const s=t.querySelectorAll("a");for(const e of s){const t=e.getAttribute("href");t&&e.setAttribute("href",t.replace(/^\//,"https://www.steamgifts.com/"))}}async getWonGames(e){const t=JSON.parse(this.getValue("games")),s={apps:{},subs:{}};for(const e in t.apps)t.apps.hasOwnProperty(e)&&t.apps[e].won&&(s.apps[e]={won:null});for(const e in t.subs)t.subs.hasOwnProperty(e)&&t.subs[e].won&&(s.subs[e]={won:null});let n=null,a=1,i=null;do{e.progressBar.setMessage(`Syncing your won games (page ${a}${n?" of "+n:""})...`);const t=(await Ne.get("/giveaways/won/search?page="+a)).html,o=t.getElementsByClassName("table__row-outer-wrap");n||(n=this.esgst.modules.generalLastPageLink.lpl_getLastPage(t));for(const e of o){if(e.querySelector(".table__gift-feedback-not-received:not(.is-hidden)"))continue;const t=await this.esgst.modules.games.games_getInfo(e);t&&(s[t.type][t.id]={won:1e3*parseInt(e.querySelector("[data-timestamp]").getAttribute("data-timestamp"))})}a+=1,i=t.getElementsByClassName("pagination__navigation")[0]}while(!e.canceled&&i&&!i.lastElementChild.classList.contains("is-selected"));await this.lockAndSaveGames(s)}saveAndSortContent(e,t,s){this.sortContent(e,s.value),this.setSetting(t,s.value)}observeChange(e,t,s=null,n="value",a="change"){e.addEventListener(a,()=>{let a=e[n];d.set(t,a),s&&("object"==typeof s?s[t]=a:this.setSetting(t,a))})}observeNumChange(e,t,s=null,n="value"){d.set(t,parseFloat(d.get(t))),e.addEventListener("change",()=>{let a=parseFloat(e[n]);d.set(t,a),s&&("object"==typeof s?s[t]=a:this.setSetting(t,a))})}async checkMissingDiscussions(e,t){let s=document.querySelectorAll(".table > .table__rows"),n=0,a=0,i=0,o=0,r=1,l=0,c=7;if(d.get("adtd_sg").enabled&&(c=d.get("activeDiscussions_displayed")),(d.get("oadd")||d.get("rad"))&&(r=0,l=1),e)s[r].innerHTML="",s[l].innerHTML="";else{let e=null;if(d.get("df")&&d.get("df_m")&&d.get("df_enable")){let t=d.get("df_preset");if(t){let s;for(s=d.get("df_presets").length-1;s>-1&&d.get("df_presets")[s].name!==t;s--);s>-1&&(e=d.get("df_presets")[s])}}if(e){const t=this.esgst.modules.discussionsDiscussionFilters.getFilters();(await this.esgst.modules.discussions.discussions_get(s[r],!0)).forEach(s=>{this.esgst.modules.discussionsDiscussionFilters.filters_filterItem(t,s,e.rules)?n+=1:(s.outerWrap.remove(),i+=1)}),(await this.esgst.modules.discussions.discussions_get(s[l],!0)).forEach(s=>{this.esgst.modules.discussionsDiscussionFilters.filters_filterItem(t,s,e.rules)?a+=1:(s.outerWrap.remove(),o+=1)})}else n=(await this.esgst.modules.discussions.discussions_get(s[r],!0)).length,a=(await this.esgst.modules.discussions.discussions_get(s[l],!0)).length}if(n<c||a<c){let[g,u]=await Promise.all([Ne.get("/discussions"),Ne.get("/discussions/deals")]),m=[],h=null;if(d.get("df")&&d.get("df_m")&&d.get("df_enable")){let e=d.get("df_preset");if(e){let t;for(t=d.get("df_presets").length-1;t>-1&&d.get("df_presets")[t].name!==e;t--);t>-1&&(h=d.get("df_presets")[t])}}(await this.esgst.modules.discussions.discussions_get(g.html,!0)).forEach(e=>{"Deals"!==e.category&&m.push(e)});const p=this.esgst.modules.discussionsDiscussionFilters.getFilters();let f=m.length-(n+i+1);for(;n<c&&f>-1;)h&&!this.esgst.modules.discussionsDiscussionFilters.filters_filterItem(p,m[f],h.rules)||(this.setMissingDiscussion(m[f]),s[r].appendChild(m[f].outerWrap),n+=1),f-=1;let b=await this.esgst.modules.discussions.discussions_get(u.html,!0);for(f=b.length-(a+o+1);a<c&&f>-1;)h&&!this.esgst.modules.discussionsDiscussionFilters.filters_filterItem(p,b[f],h.rules)||(this.setMissingDiscussion(b[f]),s[l].appendChild(b[f].outerWrap),a+=1),f-=1;d.get("adots")?this.esgst.modules.discussionsActiveDiscussionsOnTopSidebar.adots_load(e):d.get("radb")&&!e&&this.esgst.modules.discussionsRefreshActiveDiscussionsButton.radb_addButtons(),e&&await this.endless_load(this.esgst.activeDiscussions),t&&t()}else d.get("adots")?this.esgst.modules.discussionsActiveDiscussionsOnTopSidebar.adots_load():d.get("radb")&&!e&&this.esgst.modules.discussionsRefreshActiveDiscussionsButton.radb_addButtons(),t&&t()}loadDM(){const e={items:[{check:!0,name:"View recent username changes",callback:this.setSMRecentUsernameChanges.bind(this)},{check:d.get("uf"),name:"See list of filtered users",callback:this.setSMManageFilteredUsers.bind(this)},{check:this.esgst.sg&&d.get("gf")&&d.get("gf_s"),name:"Manage hidden giveaways",callback:this.setSMManageFilteredGiveaways.bind(this)},{click:!0,check:this.esgst.sg&&d.get("df")&&d.get("df_s"),name:"Manage hidden discussions",callback:this.esgst.modules.discussionsDiscussionFilters.df_menu.bind(this.esgst.modules.discussionsDiscussionFilters,{})},{click:!0,check:this.esgst.st&&d.get("tf")&&d.get("tf_s"),name:"Manage hidden trades",callback:this.esgst.modules.tradesTradeFilters.tf_menu.bind(this.esgst.modules.tradesTradeFilters,{})},{check:this.esgst.sg&&d.get("dt"),name:"Manage discussion tags",callback:this.openManageDiscussionTagsPopup.bind(this)},{check:this.esgst.sg&&d.get("ut"),name:"Manage user tags",callback:this.openManageUserTagsPopup.bind(this)},{check:d.get("gt"),name:"Manage game tags",callback:this.openManageGameTagsPopup.bind(this)},{check:d.get("gpt"),name:"Manage group tags",callback:this.openManageGroupTagsPopup.bind(this)},{click:!0,check:d.get("wbc"),name:"Manage Whitelist / Blacklist Checker caches",callback:this.esgst.modules.usersWhitelistBlacklistChecker.wbc_addButton.bind(this.esgst.modules.usersWhitelistBlacklistChecker,!1)},{click:!0,check:d.get("namwc"),name:"Manage Not Activated / Multiple Wins Checker caches",callback:this.esgst.modules.usersNotActivatedMultipleWinChecker.namwc_setPopup.bind(this.esgst.modules.usersNotActivatedMultipleWinChecker)}]},t=this.esgst.sidebar.nextElementSibling;t.setAttribute("data-esgst-popup",!0),t.innerHTML="",this.esgst.mainPageHeading=pt.create("sm",[{name:"ESGST",url:this.esgst.settingsUrl},{name:"Data Management",url:this.esgst.dataManagementUrl}]).insert(t,"beforeend").nodes.outer;for(const t of e.items){const e=tt.create([{color:"green",icons:[],name:"Open",onClick:t.click?null:()=>t.callback(e)},{template:"loading",isDisabled:!0,name:"Opening..."}]).build().nodes.outer;t.click&&t.callback(e),t.content=[e]}this.createFormRows(t,"beforeend",e)}async setSMManageFilteredGiveaways(){let e,t,s,n,a,i,o;o=new lt({addScrollable:!0,icon:"fa-gift",isTemp:!0,title:"Hidden Giveaways"}),s=[];const r=Date.now();for(a in this.esgst.giveaways)this.esgst.giveaways.hasOwnProperty(a)&&(t=this.esgst.giveaways[a],t.hidden&&t.code&&t.endTime?r>=t.endTime?delete t.hidden:s.push(t):delete t.hidden);if(s=s.sort((e,t)=>e.hidden>t.hidden?-1:e.hidden<t.hidden?1:0),this.setValue("giveaways",JSON.stringify(this.esgst.giveaways)),n=0,i=s.length,e=this.createElements(o.scrollable,"beforeend",[{attributes:{class:"esgst-text-left"},type:"div"}]),i>0){const t=tt.create([{color:"green",icons:["fa-plus"],name:"Load more...",onClick:()=>new Promise(a=>{this.loadGfGiveaways(n,n+5,s,e,o,e=>{n=e,n>i?t.destroy():d.get("es_gf")&&o.scrollable.scrollHeight<=o.scrollable.offsetHeight&&t.onClick(),a()})})},{template:"loading",isDisabled:!0,name:"Loading more..."}]).insert(o.description,"beforeend");o.open(),t.onClick(),d.get("es_gf")&&o.scrollable.addEventListener("scroll",()=>{o.scrollable.scrollTop+o.scrollable.offsetHeight>=o.scrollable.scrollHeight&&!t.isBusy&&t.onClick()})}else e.textContent="No hidden giveaways found.",o.open()}async loadGfGiveaways(e,t,s,n,a,i){let o;if(e<t)if(s[e]){let r=await Ne.get(`https://www.steamgifts.com/giveaway/${s[e].code}/`,{queue:!0});o=await this.buildGiveaway(r.html,r.url),o?(this.createElements(n,"beforeend",o.html),await this.endless_load(n.lastElementChild,!1,"gf"),window.setTimeout(()=>this.loadGfGiveaways(++e,t,s,n,a,i),0)):window.setTimeout(()=>this.loadGfGiveaways(++e,t,s,n,a,i),0)}else i(e+1);else i(e)}async openManageDiscussionTagsPopup(){let e,t,s,n,a,i;s=new lt({addScrollable:!0,isTemp:!0});const o=pt.create("dt",["Manage discussion tags"]).insert(s.description,"afterbegin");t=this.createElements(s.description,"beforeend",[{attributes:{type:"text"},type:"input"}]),this.createElements(s.description,"beforeend",[{attributes:{class:"esgst-description"},text:"Type tags below to filter the discussions by.",type:"div"}]),d.get("mm")&&this.esgst.modules.generalMultiManager.mm(o.nodes.outer),a=JSON.parse(this.getValue("discussions")),i={};for(const t in a)a.hasOwnProperty(t)&&(n=a[t],n.tags&&(n.tags.length>1||n.tags[0]&&n.tags[0].trim())&&(e=this.createElements(s.scrollable,"beforeend",[{type:"div",children:[{attributes:{class:"esgst-dt-menu",href:`https://www.steamgifts.com/discussion/${t}/`},text:n.name||t,type:"a"}]}]),i[t]={context:e}));await this.endless_load(s.scrollable),t.addEventListener("input",this.filterDiscussionTags.bind(this,i)),s.open()}filterDiscussionTags(e,t){let s,n,a,i;if(t.currentTarget.value){for(a in n=t.currentTarget.value.replace(/,\s+/g,"").split(/,\s/),e)if(e.hasOwnProperty(a)){for(i=e[a].context.getElementsByClassName("esgst-tags")[0],s=n.length-1;s>=0&&!i.innerHTML.match(new RegExp(`>${n[s]}<`));--s);s<0?e[a].context.classList.add("esgst-hidden"):e[a].context.classList.remove("esgst-hidden")}}else for(a in e)e.hasOwnProperty(a)&&e[a].context.classList.remove("esgst-hidden")}async openManageUserTagsPopup(){let e,t,s,n,a,i;s=new lt({addScrollable:!0,isTemp:!0});const o=pt.create("ut",["Manage user tags"]).insert(s.description,"afterbegin");t=this.createElements(s.description,"beforeend",[{attributes:{type:"text"},type:"input"}]),this.createElements(s.description,"beforeend",[{attributes:{class:"esgst-description"},text:"Type tags below to filter the users by.",type:"div"}]),d.get("mm")&&this.esgst.modules.generalMultiManager.mm(o.nodes.outer),a=JSON.parse(this.getValue("users")),i={};for(const t in a.users)if(a.users.hasOwnProperty(t)&&(n=a.users[t],n.tags&&(n.tags.length>1||n.tags[0]&&n.tags[0].trim()))){const a={};n.username?(a["data-sg"]=!0,a.href="https://www.steamgifts.com/user/"+n.username):(a["data-st"]=!0,a.href="https://www.steamtrades.com/user/"+t),e=this.createElements(s.scrollable,"beforeend",[{type:"div",children:[{attributes:a,text:n.username||t,type:"a"}]}]),i[n.username||t]={context:e}}await this.endless_load(s.scrollable),t.addEventListener("input",this.filterUserTags.bind(this,i)),s.open()}filterUserTags(e,t){let s,n,a,i;if(t.currentTarget.value){for(a in n=t.currentTarget.value.replace(/,\s+/g,"").split(/,\s/),e)if(e.hasOwnProperty(a)){for(i=e[a].context.getElementsByClassName("esgst-tags")[0],s=n.length-1;s>=0&&!i.innerHTML.match(new RegExp(`>${n[s]}<`));--s);s<0?e[a].context.classList.add("esgst-hidden"):e[a].context.classList.remove("esgst-hidden")}}else for(a in e)e.hasOwnProperty(a)&&e[a].context.classList.remove("esgst-hidden")}async openManageGameTagsPopup(){let e,t,s,n,a,i;n=new lt({addScrollable:!0,isTemp:!0});const o=pt.create("gt",["Manage game tags"]).insert(n.description,"afterbegin");s=this.createElements(n.description,"beforeend",[{attributes:{type:"text"},type:"input"}]),this.createElements(n.description,"beforeend",[{attributes:{class:"esgst-description"},text:"Type tags below to filter the games by.",type:"div"}]),d.get("mm")&&this.esgst.modules.generalMultiManager.mm(o.nodes.outer),i=JSON.parse(this.getValue("games")),t={apps:{},subs:{}};for(const s in i.apps)i.apps.hasOwnProperty(s)&&(a=i.apps[s],a.tags&&(a.tags.length>1||a.tags[0].trim())&&(e=this.createElements(n.scrollable,"beforeend",[{attributes:{class:"table__row-outer-wrap"},type:"div",children:[{attributes:{class:"table__column__heading",href:"http://store.steampowered.com/app/"+s},text:"App - "+s,type:"a"}]}]),t.apps[s]={context:e}));for(const s in i.subs)i.subs.hasOwnProperty(s)&&(a=i.subs[s],a.tags&&(a.tags.length>1||a.tags[0].trim())&&(e=this.createElements(n.scrollable,"beforeend",[{attributes:{class:"table__row-outer-wrap"},type:"div",children:[{attributes:{class:"table__column__heading",href:"http://store.steampowered.com/sub/"+s},text:"Sub - "+s,type:"a"}]}]),t.subs[s]={context:e}));await this.endless_load(n.scrollable),s.addEventListener("input",this.filterGameTags.bind(this,t)),n.open()}filterGameTags(e,t){let s,n,a,i;if(t.currentTarget.value){for(a in i=t.currentTarget.value.replace(/,\s+/g,"").split(/,\s/),e.apps)if(e.apps.hasOwnProperty(a)){for(s=e.apps[a].context.getElementsByClassName("esgst-tags")[0],n=i.length-1;n>=0&&!s.innerHTML.match(new RegExp(`>${i[n]}<`));--n);n<0?e.apps[a].context.classList.add("esgst-hidden"):e.apps[a].context.classList.remove("esgst-hidden")}for(a in e.subs)if(e.subs.hasOwnProperty(a)){for(s=e.subs[a].context.getElementsByClassName("esgst-tags")[0],n=i.length-1;n>=0&&!s.innerHTML.match(new RegExp(`>${i[n]}<`));--n);n<0?e.subs[a].context.classList.add("esgst-hidden"):e.subs[a].context.classList.remove("esgst-hidden")}}else{for(a in e.apps)e.apps.hasOwnProperty(a)&&e.apps[a].context.classList.remove("esgst-hidden");for(a in e.subs)e.subs.hasOwnProperty(a)&&e.subs[a].context.classList.remove("esgst-hidden")}}async openManageGroupTagsPopup(){let e,t,s,n,a;s=new lt({addScrollable:!0,isTemp:!0});const i=pt.create("gpt",["Manage group tags"]).insert(s.description,"afterbegin");t=this.createElements(s.description,"beforeend",[{attributes:{type:"text"},type:"input"}]),this.createElements(s.description,"beforeend",[{attributes:{class:"esgst-description"},text:"Type tags below to filter the groups by.",type:"div"}]),d.get("mm")&&this.esgst.modules.generalMultiManager.mm(i.nodes.outer),n=JSON.parse(this.getValue("groups")),a={};for(const t of n)t&&t.tags&&(!(t.tags.length<2)||t.tags[0]&&t.tags[0].trim())&&(e=this.createElements(s.scrollable,"beforeend",[{type:"div",children:[{attributes:{href:`https://www.steamgifts.com/group/${t.code}/`},text:t.name,type:"a"}]}]),a[t.code]={context:e});await this.endless_load(s.scrollable),t.addEventListener("input",this.filterGroupTags.bind(this,a)),s.open()}filterGroupTags(e,t){let s,n,a,i;if(t.currentTarget.value){for(a in n=t.currentTarget.value.replace(/,\s+/g,"").split(/,\s/),e)if(e.hasOwnProperty(a)){for(i=e[a].context.getElementsByClassName("esgst-tags")[0],s=n.length-1;s>=0&&!i.innerHTML.match(new RegExp(`>${n[s]}<`));--s);s<0?e[a].context.classList.add("esgst-hidden"):e[a].context.classList.remove("esgst-hidden")}}else for(a in e)e.hasOwnProperty(a)&&e[a].context.classList.remove("esgst-hidden")}async setSMRecentUsernameChanges(){const e=new lt({addProgress:!0,addScrollable:!0,icon:"fa-comments",title:"Recent Username Changes"});if(!await ut.contains([["server"]]))return Se.insert(e.description,"beforeend",Se.element("div",null,Se.element("i",{className:"fa fa-times"}),Se.element("span",null,"No permissions granted for https://esgst.rafaelgomes.xyz. Please grant the permissions on the settings menu so that the data can be retrieved from the ESGST API."))),void e.open();e.progressBar.setLoading("Loading recent username changes...").show(),Se.insert(e.scrollable,"beforeend",Se.element("div",{className:"esgst-uh-popup",ref:t=>e.results=t})),e.open();try{const t=await this.getRecentChanges();e.progressBar.reset().hide(),Se.insert(e.results,"atinner",Se.element("fragment",null,t.map(e=>Se.element("div",null,e.usernames[1]+" changed to ",Se.element("a",{href:"/user/"+e.usernames[0],className:"esgst-bold"},e.usernames[0]))))),c.esgst.sg&&this.endless_load(e.results)}catch(t){dt.warning(t),e.progressBar.setError("Failed to load recent changes. Please try again later.")}}async getRecentChanges(){return(await Ne.get("https://esgst.rafaelgomes.xyz/api/users/uh?format_array=true&show_recent=true")).json.result.found}updateWhitelistBlacklist(e,t,s){if("whitelisted"===e&&0===d.get("lastSyncWhitelist")||"blacklisted"===e&&0===d.get("lastSyncBlacklist"))return;let n;n={steamId:t.steamId,id:t.id,username:t.username,values:{}},!s||s.currentTarget.classList.contains("is-selected")?n.values[e]=!1:(n.values[e]=!0,n.values[e+"Date"]=Date.now()),this.saveUser(null,null,n)}async updateHiddenGames(e,t,s){if(0===d.get("lastSyncHiddenGames"))return;const n={apps:{},subs:{}};n[t][e]={hidden:!s||null},await this.lockAndSaveGames(n)}checkBackup(){console.log("Checking backup...");let e=Date.now(),t=parseInt(r.get("isBackingUp"));console.log(e,t),(!t||e-t>18e5)&&e-d.get("lastBackup")>864e5*d.get("autoBackup_days")&&(r.set("isBackingUp",e),d.get("openAutoBackupNewTab")?yt.open(`${c.esgst.backupUrl}&autoBackupIndex=${d.get("autoBackup_index")}`):this.runSilentBackup())}async downloadZip(e,t,s){this.downloadFile(null,s,await this.getZip(JSON.stringify(e),t))}async getZip(e,t,s="blob"){const n=new JSZip;return n.file(t,e),await n.generateAsync({compression:"DEFLATE",compressionOptions:{level:9},type:s})}async readZip(e){const t=new JSZip,s=await t.loadAsync(e),n=Object.keys(s.files),a=[];for(const e of n)a.push({name:e,value:await t.file(e).async("text")});return a}downloadFile(e,t,s){const n=window.URL.createObjectURL(s||new Blob([e])),a=document.createElement("a");a.download=t,a.href=n,document.body.appendChild(a),a.click(),a.remove(),window.URL.revokeObjectURL(n)}async lockAndSaveGames(e){const t=new Te("game",{threshold:300});await t.lock();let s=JSON.parse(this.getValue("games"));if(e.apps)for(let t in e.apps)if(e.apps.hasOwnProperty(t)){if(s.apps[t])for(let n in e.apps[t])e.apps[t].hasOwnProperty(n)&&(null===e.apps[t][n]?delete s.apps[t][n]:s.apps[t][n]=e.apps[t][n]);else s.apps[t]=e.apps[t];s.apps[t].tags||delete s.apps[t].tags}if(e.subs)for(let t in e.subs)if(e.subs.hasOwnProperty(t)){if(s.subs[t])for(let n in e.subs[t])e.subs[t].hasOwnProperty(n)&&(null===e.subs[t][n]?delete s.subs[t][n]:s.subs[t][n]=e.subs[t][n]);else s.subs[t]=e.subs[t];s.subs[t].tags||delete s.subs[t].tags}await this.setValue("games",JSON.stringify(s)),await t.unlock()}async setSMManageFilteredUsers(){let e;if(e)e.open();else{e=new lt({addScrollable:!0,icon:"fa-eye-slash",title:"Filtered Users"});let t=JSON.parse(this.getValue("users")),s=[];for(let e in t.users)if(t.users.hasOwnProperty(e)){const n=c.esgst.modules.usersUserFilters.fixData(t.users[e].uf);n&&(n.giveawayPosts||n.giveaways||n.discussionPosts||n.discussions)&&s.push(t.users[e])}s.sort((e,t)=>e.username>t.username?-1:1);let n=this.createElements(e.scrollable,"beforeend",[{attributes:{class:"table"},type:"div",children:[{attributes:{class:"table__heading"},type:"div",children:[{attributes:{class:"table__column--width-fill"},text:"Username",type:"div"},{attributes:{class:"table__column--width-small"},text:"Discussions Hidden",type:"div"},{attributes:{class:"table__column--width-small"},text:"Discussion Posts Hidden",type:"div"},{attributes:{class:"table__column--width-small"},text:"Giveaways Hidden",type:"div"},{attributes:{class:"table__column--width-small"},text:"Giveaway Posts Hidden",type:"div"}]},{attributes:{class:"table__rows"},type:"div"}]}]);for(let e=0,t=s.length;e<t;++e){const t=s[e].uf.discussions?"fa fa-check":"",a=s[e].uf.discussionPosts?"fa fa-check":"",i=s[e].uf.giveaways?"fa fa-check":"",o=s[e].uf.giveawayPosts?"fa fa-check":"";this.createElements(n.lastElementChild,"beforeend",[{attributes:{class:"table__row-outer-wrap"},type:"div",children:[{attributes:{class:"table__row-inner-wrap"},type:"div",children:[{attributes:{class:"table__column--width-fill"},type:"div",children:[{attributes:{href:"/user/"+s[e].username},text:s[e].username,type:"a"}]},{attributes:{class:"table__column--width-small"},type:"div",children:t?[{attributes:{class:t},type:"i"}]:null},{attributes:{class:"table__column--width-small"},type:"div",children:a?[{attributes:{class:a},type:"i"}]:null},{attributes:{class:"table__column--width-small"},type:"div",children:i?[{attributes:{class:i},type:"i"}]:null},{attributes:{class:"table__column--width-small"},type:"div",children:o?[{attributes:{class:o},type:"i"}]:null}]}]}])}e.open()}}multiChoice(e,t,s,n,a,i,o,r,l){if(d.get("cfh_img_remember"))1===d.get("cfh_img_choice")?r():l();else{let c=new lt({addScrollable:!0,icon:"fa-list",isTemp:!0,title:o});new vt(c.description,"cfh_img_remember",!1,"Never ask again.",!1,!1,"Remembers which option you choose forever.",d.get("cfh_img_remember")),tt.create({color:e,icons:[t],name:s,onClick:()=>new Promise(e=>{d.get("cfh_img_remember")&&this.setSetting("cfh_img_choice",1),e(),c.close(),r()})}).insert(c.description,"beforeend"),tt.create({color:n,icons:[a],name:i,onClick:()=>new Promise(e=>{d.get("cfh_img_remember")&&this.setSetting("cfh_img_choice",2),e(),c.close(),l()})}).insert(c.description,"beforeend"),c.open()}}async exportSettings(){let e={settings:JSON.parse(this.getValue("settings","{}")),v:this.getValue("v")};delete e.settings.avatar,delete e.settings.lastSync,delete e.settings.steamApiKey,delete e.settings.steamId,delete e.settings.syncFrequency,delete e.settings.username_sg,delete e.settings.username_st;const t=(d.get("askFileName")?window.prompt("Enter the name of the file:","esgst_settings_"+(new Date).toISOString().replace(/:/g,"_")):"esgst_settings_"+(new Date).toISOString().replace(/:/g,"_"))+".json";"null.json"!==t&&this.downloadFile(JSON.stringify(e),t)}async selectSwitches(e,t,s){const n=[];for(const a in e)if(e.hasOwnProperty(a)){const i=e[a];Array.isArray(i)?n.push({id:i[0].id,value:await i[0][t](s),sg:i[0].sg,st:i[0].st}):i.checkbox&&!i.checkbox.offsetParent||n.push({id:i.id,value:await i[t](s),sg:i.sg,st:i.st})}if(s){let e;Se.insert(s,"beforeend",Se.element("div",{className:"esgst-description esgst-bold",ref:t=>e=t},Se.element("i",{className:"fa fa-circle-o-notch fa-spin",title:"Saving..."}))),await this.setSetting(n),e.classList.add("esgst-green"),Se.insert(e,"atinner",Se.element("i",{className:"fa fa-check",title:"Saved!"})),window.setTimeout(()=>e.remove(),2500)}}hideGame(e,t,s,n,a){let i,o,r;r=new lt({addScrollable:!0,icon:"fa-eye-slash",title:Se.element("fragment",null,"Would you like to hide all giveaways for ",Se.element("span",{className:"esgst-bold"},s),"?")}),tt.create([{template:"success",name:"Yes",onClick:async()=>{for(await Ne.post("/ajax.php",{data:`xsrf_token=${Be.xsrfToken}&do=hide_giveaways_by_game_id&game_id=${t}`}),await this.updateHiddenGames(n,a),i=document.querySelectorAll(`.giveaway__row-outer-wrap[data-game-id="${t}"]`),o=i.length-1;o>-1;--o)i[o].remove();e.remove(),r.close()}},{color:"white",isDisabled:!0,icons:["fa-refresh fa-spin"],name:"Please wait..."}]).insert(r.description,"beforeend"),this.createElements(r.actions.firstElementChild,"atouter",[{attributes:{href:"/account/settings/giveaways/filters"},text:"View Hidden Games",type:"a"}]),r.open()}unhideGame(e,t,s,n,a){let i;i=new lt({addScrollable:!0,icon:"fa-eye-slash",isTemp:!0,title:Se.element("fragment",null,"Would you like to unhide all giveaways for ",Se.element("span",{className:"esgst-bold"},s),"?")}),tt.create([{template:"success",name:"Yes",onClick:async()=>{await Ne.post("/ajax.php",{data:`xsrf_token=${Be.xsrfToken}&do=remove_filter&game_id=${t}`}),await this.updateHiddenGames(n,a,!0),e.remove(),i.close()}},{color:"white",isDisabled:!0,icons:["fa-refresh fa-spin"],name:"Please wait..."}]).insert(i.description,"beforeend"),this.createElements(i.actions.firstElementChild,"atouter",[{attributes:{href:"/account/settings/giveaways/filters"},text:"View Hidden Games",type:"a"}]),i.open()}draggable_set(e){e.history||(e.history=[]),e.values||(e.values={}),e.context.setAttribute("data-draggable-key",e.id);for(const t of e.context.children)!t.getAttribute("draggable")&&t.getAttribute("data-draggable-id")&&(t.setAttribute("draggable",!0),t.addEventListener("dragstart",this.draggable_start.bind(this,e)),t.addEventListener("dragenter",this.draggable_enter.bind(this,e)),t.addEventListener("dragend",this.draggable_end.bind(this,e)))}async draggable_start(e,t){t.dataTransfer.setData("text/plain",""),this.esgst.draggable.dragged=t.currentTarget,this.esgst.draggable.source=this.esgst.draggable.dragged.parentElement,this.esgst.draggable.destination=null,e.addTrash&&(this.draggable_setTrash(e),this.draggable_setRestoreButton(e))}draggable_enter(e,t){if(!this.esgst.draggable.dragged)return;const s=t.currentTarget;if(s===this.esgst.draggable.dragged||s.getAttribute("data-draggable-id")===this.esgst.draggable.dragged.getAttribute("data-draggable-id"))return;if(s===e.context)return void(e.context.children.length<1&&(e.context.appendChild(this.esgst.draggable.dragged),this.esgst.draggable.destination=e.context));if(s.getAttribute("data-draggable-group")!==this.esgst.draggable.dragged.getAttribute("data-draggable-group"))return void window.alert("Cannot move this element to this group.");let n=this.esgst.draggable.dragged;do{if(n=n.previousElementSibling,n&&n===s)return s.parentElement.insertBefore(this.esgst.draggable.dragged,s),void(this.esgst.draggable.destination=this.esgst.draggable.dragged.parentElement)}while(n);s.parentElement.insertBefore(this.esgst.draggable.dragged,s.nextElementSibling),this.esgst.draggable.destination=this.esgst.draggable.dragged.parentElement}async draggable_end(e){if(this.esgst.draggable.awaitingConfirmation)return;this.esgst.draggable.trash&&(this.esgst.draggable.trash.remove(),this.esgst.draggable.trash=null),this.esgst.draggable.restoreButton&&0===e.history.length&&this.esgst.draggable.restoreButton.hide(),this.esgst.draggable.destination===e.item.columns||this.esgst.draggable.destination===e.item.gvIcons?(this.esgst.draggable.dragged.getAttribute("data-draggable-id").match(/elgb|gp/)&&this.esgst.draggable.dragged.classList.add("esgst-giveaway-column-button"),this.esgst.draggable.dragged.getAttribute("data-color")&&(this.esgst.draggable.dragged.classList.add(this.esgst.giveawayPath?"featured__column":"giveaway__column"),this.esgst.draggable.dragged.firstElementChild.style.color=this.esgst.draggable.dragged.getAttribute("data-bgColor"),this.esgst.draggable.dragged.style.color="",this.esgst.draggable.dragged.style.backgroundColor="")):(this.esgst.draggable.dragged.getAttribute("data-draggable-id").match(/elgb|gp/)&&this.esgst.draggable.dragged.classList.remove("esgst-giveaway-column-button"),this.esgst.draggable.dragged.getAttribute("data-color")&&(this.esgst.draggable.dragged.classList.remove(this.esgst.giveawayPath?"featured__column":"giveaway__column"),this.esgst.draggable.dragged.style.color=this.esgst.draggable.dragged.getAttribute("data-color"),this.esgst.draggable.dragged.style.backgroundColor=this.esgst.draggable.dragged.getAttribute("data-bgColor"))),this.esgst.draggable.destination===e.item.heading?this.esgst.draggable.dragged.getAttribute("data-draggable-id").match(/steam|search|hideGame/)&&this.esgst.draggable.dragged.classList.add("giveaway__icon"):this.esgst.draggable.dragged.getAttribute("data-draggable-id").match(/steam|search|hideGame/)&&this.esgst.draggable.dragged.classList.remove("giveaway__icon"),this.esgst.draggable.deleted?(this.esgst.draggable.dragged.remove(),e.history.push({dragged:this.esgst.draggable.dragged,source:this.esgst.draggable.source,destination:this.esgst.draggable.destination})):this.esgst.draggable.restored&&this.esgst.draggable.destination.appendChild(this.esgst.draggable.dragged);const t=[this.esgst.draggable.source];this.esgst.draggable.source!==this.esgst.draggable.destination&&t.push(this.esgst.draggable.destination);for(const s of t){if(!s)continue;const t=`${s.getAttribute("data-draggable-key")}${e.item.gvIcons?"_gv":""}`;e.values[t]=[];for(const n of s.children){const s=n.getAttribute("data-draggable-id");s&&(n.getAttribute("data-draggable-obj")?e.values[t].push(JSON.parse(n.getAttribute("data-draggable-obj"))):e.values[t].push(s))}"emojis"===t&&await this.setValue(t,JSON.stringify(e.values[t])),t.startsWith("savedReplies")&&await this.setValue(t,JSON.stringify(e.values[t]))}e.onDragEnd&&e.onDragEnd(e.values),this.esgst.draggable.dragged=null,this.esgst.draggable.source=null,this.esgst.draggable.destination=null,this.esgst.draggable.restoreButton&&e.history.length>0&&this.esgst.draggable.restoreButton.show()}draggable_setTrash(e){this.esgst.draggable.trash&&this.esgst.draggable.trash.remove(),Se.insert(e.trashContext||e.context,"afterend",Se.element("div",{className:"esgst-draggable-trash",title:"Delete the element",ondragenter:this.draggable_delete.bind(this,e),ref:e=>this.esgst.draggable.trash=e},Se.element("i",{className:"fa fa-trash"}))),this.esgst.draggable.trash.style.width=(e.trashContext||e.context).offsetWidth+"px"}async draggable_delete(e){if(this.esgst.draggable.awaitingConfirmation=!0,this.esgst.draggable.deleted=!1,!this.esgst.draggable.dragged||!window.confirm("Are you sure you want to delete this item?"))return this.esgst.draggable.awaitingConfirmation=!1,this.esgst.draggable.trash.remove(),void(this.esgst.draggable.trash=null);this.esgst.draggable.awaitingConfirmation=!1,this.esgst.draggable.deleted=!0,await this.draggable_end(e),this.esgst.draggable.deleted=!1}draggable_setRestoreButton(e){this.esgst.draggable.restoreButton&&this.esgst.draggable.restoreButton.destroy(),this.esgst.draggable.restoreButton=tt.create({color:"white",tooltip:"Restore the latest deleted element (restored elements always appear at the end)",icons:["fa-rotate-left"],name:"",onClick:this.draggable_restore.bind(this,e)}).insert(e.trashContext||e.context,"afterend").hide()}async draggable_restore(e){const t=e.history.pop();this.esgst.draggable.dragged=t.dragged,this.esgst.draggable.source=t.source,this.esgst.draggable.destination=t.source,this.esgst.draggable.restored=!0,await this.draggable_end(e),this.esgst.draggable.restored=!1}setCountdown(e,t,s,n=Date.now()){const a=t-Math.floor((Date.now()-n)/1e3),i=Math.floor(a/60),o=a%60;e.textContent=`${("0"+i).slice(-2)}:${("0"+o).slice(-2)}`,a>-1?window.setTimeout(this.setCountdown.bind(this),1e3,e,t,s,n):s&&s()}round(e,t=2){const s=Math.pow(10,t);return Math.round(e*s)/s}getTextNodesIn(e,t){let s=[];if(e)for(let n=e.childNodes,a=0,i=n.length;a<i;a++){let i=n[a],o=i.nodeType;3===o?t&&!t(i,e)||s.push(i):1!==o&&9!==o&&11!==o||(s=s.concat(this.getTextNodesIn(i,t)))}return s}setClearButton(e){const t=e.nextElementSibling;e.addEventListener("input",this.toggleClearButton.bind(this,t,e)),e.addEventListener("change",this.toggleClearButton.bind(this,t,e)),e.nextElementSibling.addEventListener("click",this.clearInput.bind(this,e))}toggleClearButton(e,t){t.value?e.classList.contains("esgst-hidden")&&e.classList.remove("esgst-hidden"):e.classList.contains("esgst-hidden")||e.classList.add("esgst-hidden")}clearInput(e){e.value="",e.dispatchEvent(new Event("change"))}fixEmojis(e){const t=e.split(/<\/span>/);return t.length<2?e:(t.pop(),JSON.stringify(t.map(this.fixEmoji)))}fixEmoji(e){const t=e.match(/title="(.+?)"/);if(e=e.replace(/<span.+?>/,""),t)return this.getEmojiHtml(e);let s="";for(let t=0,n=e.length;t<n;t++)s+=this.getEmojiHtml(e[t]);return s}getEmojiHtml(e){return"&#x"+this.getEmojiUnicode(e).toString("16").toUpperCase()}getEmojiUnicode(e){if(1===e.length)return e.charCodeAt(0);const t=1024*(e.charCodeAt(0)-55296)+(e.charCodeAt(1)-56320)+65536;return t<0?e.charCodeAt(0):t}triggerOnEnter(e,t){"Enter"===t.key&&(t.preventDefault(),e())}getChildByClassName(e,t){let s;if(e){for(s=e.children.length-1;s>-1&&!e.children[s].classList.contains(t);s--);return s>-1?e.children[s]:void 0}}escapeMarkdown(e){return e.replace(/([[\]()*~!.`\->#|])/g,"\\$1")}removeDuplicateNotes(e){let t=[];return e.split(/\n/).forEach(e=>{t.indexOf(e)<0&&t.push(e),t.push("\n")}),t.join("").trim().replace(/\n\n+/g,"\n\n")}capitalizeFirstLetter(e){return`${e[0].toUpperCase()}${e.slice(1)}`}getTimestamp(e,t,s){return xe(e,`MMM d, yyyy, ${t?"H":"h"}:mm${s?":ss":""}${t?"":" a"}`)}getTimeSince(e,t){let s,n;return n=Math.floor((t?e-Date.now():Date.now()-e)/1e3),s=Math.floor(n/31104e3),s>=1?`${s} year${1===s?"":"s"}`:(s=Math.floor(n/2592e3),s>=1?`${s} month${1===s?"":"s"}`:(s=Math.floor(n/86400),s>=1?`${s} day${1===s?"":"s"}`:(s=Math.floor(n/3600),s>=1?`${s} hour${1===s?"":"s"}`:(s=Math.floor(n/60),s>=1?`${s} minute${1===s?"":"s"}`:(s=Math.floor(n),`${s} second${1===s?"":"s"}`)))))}closeHeaderMenu(e,t,s,n){!s.contains(n.target)&&e.classList.contains("selected")&&(e.classList.remove("selected"),t.classList.add("esgst-hidden"))}setSiblingsOpacity(e,t){let s,n,a;for(s=e.parentElement.children,n=0,a=s.length;n<a;++n)s[n]!==e&&(s[n].style.opacity=t)}timeout(e){return new Promise(t=>window.setTimeout(t,e))}createTooltip(e,t,s){let n;return n=new mt("esgst-feature-description "+(s?"":"markdown"),e,100),n.popout.style.maxHeight="300px",n.popout.style.overflow="auto",this.createElements(n.popout,"atinner",[...Array.from(Se.parse(t).body.childNodes).map(e=>({context:e}))]),n}createOptions(e){let t,s,n,a;return t=document.createElement("div"),s={},a={},e.forEach(e=>{e.check&&(n=e.id,s[n]=this.createElements(t,"beforeend",[{type:"div"}]),a[n]=new vt(s[n],n,!1,e.description,!1,!1,e.tooltip,d.get(n)))}),e.forEach(e=>{let t=d.get(e.id);a[e.id]&&(e.dependencies&&e.dependencies.forEach(n=>{s[n]&&(a[e.id].dependencies.push(s[n]),t||s[n].classList.add("esgst-hidden"))}),e.exclusions&&e.exclusions.forEach(n=>{s[n]&&(a[e.id].exclusions.push(s[n]),t&&s[n].classList.add("esgst-hidden"))}))}),t}createResults(e,t,s){for(const n of s){const s=n.Key;t[s]=this.createElements(e,"beforeend",[{attributes:{class:"esgst-hidden"},type:"div",children:[{attributes:{class:n.Icon},type:"i"},{attributes:{class:"esgst-bold"},type:"span",children:[{text:n.Description+" (",type:"node"},{text:"0",type:"span"},{text:"):",type:"node"}]},{attributes:{class:"esgst-popup-actions"},type:"span"}]}]),t[s+"Count"]=t[s].firstElementChild.nextElementSibling.firstElementChild,t[s+"Users"]=t[s].lastElementChild}}goToComment(e,t,s){e||(e=window.location.hash);let n=e.replace(/#/,"");if(!n&&!t||window.location.pathname.match(/^\/account/)&&!this.esgst.parameters.esgst)return;if(n&&!t&&(t=document.getElementById(n)),!t)return;if(window.scrollTo(0,t.offsetTop),window.scrollBy(0,-this.esgst.commentsTop),s)return;let a=document.querySelector(".is_permalink, .author_permalink");a&&a.remove(),(t=t.querySelector(".comment__username, .author_avatar"))&&this.createElements(t,this.esgst.sg?"beforebegin":"afterend",[{attributes:{class:"fa fa-share is_permalink author_permalink"},type:"i"}])}sortContent(e,t){let s,n,a,i,o,r,l,c;c=t.split(/_/),r=c[0],"asc"===c[1]?(n=-1,s=1):(n=1,s=-1),e.sort((e,t)=>{if("string"==typeof e[r]&&"string"==typeof t[r])return e[r].toLowerCase().localeCompare(t[r].toLowerCase())*s;{const a=e[r]||0,i=t[r]||0;return a<i?n:a>i?s:0}});let d=null;if(e[0].outerWrap){const t=e[0].outerWrap.closest(".esgst-popup, [data-esgst-popup]");t&&(d=t.getElementsByClassName("esgst-gv-view")[0]||e[0].outerWrap.parentElement.parentElement)}for(o=0,l=e.length;o<l;++o)e[o].outerWrap.parentElement&&(d?d.appendChild(e[o].outerWrap.parentElement):e[o].outerWrap.parentElement.appendChild(e[o].outerWrap));for(o=e.length-1;o>-1;o--)e[o].isPinned&&e[o].outerWrap.parentElement.insertBefore(e[o].outerWrap,e[o].outerWrap.parentElement.firstElementChild);if("sortIndex"===r)for(i=document.getElementsByClassName("esgst-es-page-divider"),o=i.length-1;o>-1;--o)a=i[o],a.classList.remove("esgst-hidden"),a.parentElement.insertBefore(a,document.getElementsByClassName("esgst-es-page-"+(o+2))[0]);else for(i=document.querySelectorAll(".esgst-es-page-divider:not(.esgst-hidden)"),o=i.length-1;o>-1;--o)i[o].classList.add("esgst-hidden")}rot(e,t){return e.replace(/[a-zA-Z]/g,e=>String.fromCharCode((e<="Z"?90:122)>=(e=e.charCodeAt(0)+t)?e:e-26))}async buildGiveaway(e,t,s,n){let a,i,o,r,l,c,d,g,u,m,h,p,f,b,w,y,v,_,k,x,A,C,S;if(p=e.getElementsByClassName("featured__outer-wrap--giveaway")[0],p){let E=t.match(/giveaway\/(.+?)\//),T=!1;for(E?o=E[1]:(E=t.match(/giveaways\/(.+)/),E&&(o=E[1],T=!0)),y=p.getAttribute("data-game-id"),f=p.getElementsByClassName("featured__heading")[0],v=f.getElementsByTagName("a"),w=0,k=v.length;w<k;++w)v[w].classList.add("giveaway__icon");for(b=f.firstElementChild,this.createElements(b,"atouter",[{attributes:{class:"giveaway__heading__name",href:t},type:"a",children:[...Array.from(b.childNodes).map(e=>({context:e}))]}]),S=f.getElementsByClassName("featured__heading__small"),w=0,k=S.length;w<k;++w)this.createElements(S[0],"atouter",[{attributes:{class:"giveaway__heading__thin"},type:"span",children:[...Array.from(S[0].childNodes).map(e=>({context:e}))]}]);if(l=f.nextElementSibling,u=l.firstElementChild,u.classList.remove("featured__column"),T){let e=await this.esgst.modules.games.games_getInfo(p);e&&this.createElements(f,"beforeend",[{attributes:{class:"giveaway__icon",href:`https://store.steampowered.com/${e.type.slice(0,-1)}/${e.id}/`,rel:"nofollow",target:"_blank"},type:"a",children:[{attributes:{class:"fa fa-steam"},type:"i"}]},{attributes:{class:"giveaway__icon",href:`/giveaways/search?${e.type.slice(0,-1)}=${e.id}`},type:"a",children:[{attributes:{class:"fa fa-search"},type:"i"}]}]);let t=new Date(u.lastElementChild.textContent+"Z").getTime();a=Date.now()>t;const s=[];a&&s.push({text:"Ended",type:"node"}),s.push({attributes:{"data-timestamp":t/1e3},text:a?this.getTimeSince(t):this.getTimeSince(t,!0),type:"span"},{text:a?" ago ":" remaining ",type:"node"}),this.createElements(u.lastElementChild,"atouter",s)}if(g=1e3*parseInt(u.lastElementChild.getAttribute("data-timestamp")),C=u.nextElementSibling,C.classList.remove("featured__column","featured__column--width-fill"),C.classList.add("giveaway__column--width-fill"),T){let e=new Date(C.firstElementChild.textContent+"Z").getTime();const t=[];a&&t.push({text:"Ended ",type:"node"}),t.push({attributes:{"data-timestamp":e/1e3},text:this.getTimeSince(e),type:"span"},{text:" ago ",type:"node"}),this.createElements(C.firstElementChild,"atouter",t)}for(C.lastElementChild.classList.add("giveaway__username"),i=l.lastElementChild,T&&(i.className="giveaway_image_avatar"),i.remove(),C.querySelector("[style]").removeAttribute("style"),r=C.nextElementSibling;r;)r.classList.remove("featured__column"),r.className=r.className.replace(/featured/g,"giveaway"),r=r.nextElementSibling;x=e.getElementsByClassName("sidebar__entry-delete")[0],m=x&&!x.classList.contains("is-hidden")?"is-faded":"",d=e.getElementsByClassName("sidebar__navigation__item__count"),d.length>1?(h=d[1].textContent,c=d[0].textContent,A=!0):d.length>0?(h=0,c=d[0].textContent,A=!1):(h=0,c=0),_=p.getElementsByClassName("global__image-outer-wrap--game-large")[0].firstElementChild.getAttribute("src");const N={class:"giveaway__row-outer-wrap","data-game-id":y};s&&(N["data-error"]=s),n&&(N["data-blacklist"]=!0);const P=e.getElementsByClassName("sidebar__error is-disabled")[0];return P&&"Not Enough Points"!==P.textContent.trim()||(N["data-enterable"]=!0),e.getElementsByClassName("sidebar__entry-insert")[0]&&(N["data-currently-enterable"]=!0),m&&(N["data-entered"]=!0),f.className="giveaway__heading",l.className="giveaway__columns",{code:o,html:[{type:"div",children:[{attributes:N,type:"div",children:[{attributes:{class:"giveaway__row-inner-wrap "+m},type:"div",children:[{attributes:{class:"giveaway__summary"},children:[{context:f},{context:l},{attributes:{class:"giveaway__links"},type:"div",children:[{attributes:{href:t+"/entries"},type:"a",children:[{attributes:{class:"fa fa-tag"},type:"i"},{text:h+" entries",type:"span"}]},{attributes:{href:t+"/comments"},type:"a",children:[{attributes:{class:"fa fa-comment"},type:"i"},{text:c+" comments",type:"span"}]}]}],type:"div"},{context:i},{attributes:{class:"giveaway_image_thumbnail",href:t,style:`background-image: url(${_})`},type:"a"}]}]}]}],points:parseInt(f.textContent.match(/\((\d+)P\)/)[1]),started:A,timestamp:g}}return null}getCopyIcon(e){return Se.element("i",{className:"esgst-clickable fa fa-copy",title:"Copy",onclick:t=>this.copyValue(t.currentTarget,e)})}copyValue(e,t){let s=this.createElements(document.body,"beforeend",[{type:"textarea"}]);s.value=t,s.select(),document.execCommand("copy"),s.remove(),e&&(e.classList.add("esgst-green"),window.setTimeout(()=>e.classList.remove("esgst-green"),2e3))}setMissingDiscussion(e){e&&(this.createElements(e.outerWrap,"atinner",[{attributes:{class:"table__row-outer-wrap",style:"padding: 10px 0;"},type:"div",children:[{attributes:{class:"table__row-inner-wrap"},type:"div",children:[{type:"div",children:[{attributes:{class:"table_image_avatar",href:"/user/"+e.author,style:`background-image:${e.avatar.style.backgroundImage.replace(/"/g,"'")};`},type:"a"}]},{attributes:{class:"table__column--width-fill"},type:"div",children:[{attributes:{style:"margin-bottom: 2px;"},type:"h3",children:[{attributes:{class:"homepage_table_column_heading",href:e.url},text:e.title,type:"a"}]},{type:"p",children:e.lastPostTime?[{attributes:{class:"table__column__secondary-link",href:e.url},text:e.comments+" Comments",type:"a"},{text:" - Last post ",type:"node"},{attributes:{"data-timestamp":e.lastPostTimestamp},text:e.lastPostTime,type:"span"},{text:" ago by ",type:"node"},{attributes:{class:"table__column__secondary-link",href:"/user/"+e.lastPostAuthor},text:e.lastPostAuthor,type:"a"},{attributes:{class:"icon-green table__last-comment-icon",href:"/go/comment/"+e.lastPostCode},type:"a",children:[{attributes:{class:"fa fa-chevron-circle-right"},type:"i"}]}]:[{attributes:{class:"table__column__secondary-link",href:e.url},text:e.comments+" Comments",type:"a"},{text:" - Created ",type:"node"},{attributes:{"data-timestamp":e.createdTimestamp},text:e.createdTime,type:"span"},{text:" ago by ",type:"node"},{attributes:{class:"table__column__secondary-link",href:"/user/"+e.author},text:e.author,type:"a"}]}]}]}]}]),e.outerWrap=e.outerWrap.firstElementChild)}escapeRegExp(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}triggerSetOnEnter(e,t){if("Enter"===t.key)return e.onClick(),!0}formatTags(e,t,s,n){return 0===s||s===n.length-e.length?"":", "}animateScroll(e,t){let s,n;s=0,e>0&&(e-=this.esgst.commentsTop),n=Math.max(.1,Math.min(Math.abs(window.scrollY-e)/2e3,.8)),function a(){let i;s+=1/60,i=s/n,i<1?(window.requestAnimationFrame(a),window.scrollTo(0,window.scrollY+(e-window.scrollY)*((i/=.5)<1?.5*Math.pow(i,5):.5*(Math.pow(i-2,5)+2)))):(window.scrollTo(0,e),t&&t())}()}reverseComments(e){let t,s,n=document.createDocumentFragment();for(t=0,s=e.children.length;t<s;++t)n.appendChild(e.lastElementChild);e.appendChild(n)}createAlert(e){let t;t=new lt({addScrollable:!0,icon:"fa-exclamation",isTemp:!0,title:e}),t.open()}createConfirmation(e,t,s,n){let a,i;a=s,i=new lt({addScrollable:!0,icon:"fa-question",isTemp:!0,title:e}),tt.create({template:"success",name:"Yes",onClick:()=>{a=t,i.close()}}).insert(i.description,"beforeend"),tt.create({template:"error",name:"No",onClick:()=>{a=s,i.close()}}).insert(i.description,"beforeend"),i.onClose=()=>{a&&a(n)},i.open()}createConfirmationAsync(e){return new Promise(t=>this.createConfirmation(e,()=>t(!0),()=>t(!1)))}createFadeMessage(e,t){e.textContent=t,window.setTimeout(()=>{e.textContent=""},1e4)}openSmallWindow(e){yt.open(e)}convertBytes(e){return e<1024?e+" B":(e/=1024)<1024?Math.round(100*e)/100+" KB":Math.round(e/1024*100)/100+" MB"}createFormRows(e,t,s){const n=[];let a,i=1;for(const e of s.items)e.check&&n.push(Se.element("div",{className:"form__row"},Se.element("div",{className:"form__heading"},Se.element("div",{className:"form__heading__number"},i++),Se.element("div",{className:"form__heading__text"},e.name)),Se.element("div",{className:"form__row__indent",id:e.id||""},e.content)));return Se.insert(e,t,Se.element("div",{className:"form__rows",ref:e=>a=e},n)),a}createSidebarNavigation(e,t,s){const n=[];for(const e of s.items){const t=Object.assign({className:"sidebar__navigation__item__link"},e.url?{href:e.url}:null),s=Se.element("fragment",null,Se.element("div",{className:"sidebar__navigation__item__name"},e.name),Se.element("div",{className:"sidebar__navigation__item__underline"}),l.isSet(e.count)?Se.element("div",{className:"sidebar__navigation__item__count"},e.count):null);n.push(Se.element("li",{className:"sidebar__navigation__item",id:e.id||""},e.url?Se.element("a",t,s):Se.element("div",t,s)))}let a;return Se.insert(e,t,Se.element("fragment",null,Se.element("h3",{className:"sidebar__heading"},s.name),Se.element("ul",{className:"sidebar__navigation",ref:e=>a=e},n))),a}createElements(e,t,s){try{if("atinner"===t&&(e.innerHTML=""),!s||!s.length)return;const n=document.createDocumentFragment();let a=null;switch(this.buildElements(n,s),t){case"beforebegin":e.parentElement.insertBefore(n,e),a=e.previousElementSibling;break;case"afterbegin":e.insertBefore(n,e.firstElementChild),a=e.firstElementChild;break;case"beforeend":e.appendChild(n),a=e.lastElementChild;break;case"afterend":e.parentElement.insertBefore(n,e.nextElementSibling),a=e.nextElementSibling;break;case"atinner":e.appendChild(n),a=e.firstElementChild;break;case"atouter":e.parentElement.insertBefore(n,e),a=e.previousElementSibling,e.remove()}return a}catch(e){dt.error(e.message,e.stack)}}buildElements(e,t){for(const s of t){if(!s)continue;if(l.isSet(s.context)){e.appendChild(s.context);continue}if("node"===s.type){const t=document.createTextNode(s.text);e.appendChild(t);continue}const t=document.createElement(s.type);if(l.isSet(s.attributes))for(const e in s.attributes)s.attributes.hasOwnProperty(e)&&t.setAttribute(e,s.attributes[e]);if(l.isSet(s.text)&&(t.textContent=s.text),l.isSet(s.children)&&this.buildElements(t,s.children),l.isSet(s.events))for(const e in s.events)s.events.hasOwnProperty(e)&&t.addEventListener(e,s.events[e]);if("i"===s.type){const t=document.createTextNode(" ");e.appendChild(t)}if(e.appendChild(t),"i"===s.type){const t=document.createTextNode(" ");e.appendChild(t)}}}async getPlayerAchievements(e,t){return(await Ne.get(`http://api.steampowered.com/ISteamUserStats/GetPlayerAchievements/v0001/?appid=${e}&key=${d.get("steamApiKey")}&steamid=${t}`)).json}async submitComment(e){if(e.status.innerHTML="",!e.commentUrl){const t=await this.saveComment(e.context,e.tradeCode,"string"==typeof e.parentId?e.parentId:e.parentId.value,e.description.value,e.url,e.status,!e.callback);return void(e.callback&&e.callback(t.id,t.response,t.status))}const t=await Ne.get(e.commentUrl),s=t.html.getElementById(e.commentUrl.match(/\/comment\/(.+)/)[1]);if(e.parentId=this.esgst.sg?s.closest(".comment").getAttribute("data-comment-id"):s.getAttribute("data-id"),e.tradeCode=this.esgst.sg?"":t.url.match(/\/trade\/(.+?)\//)[1],e.url=this.esgst.sg?t.url.match(/(.+?)(#.+?)?$/)[1]:"/ajax.php",e.checked||!d.get("rfi_c")){const s=await this.saveComment(e.context,e.tradeCode,e.parentId,e.description.value,e.url,e.status,!e.callback);return void(e.callback&&e.callback(s.id,s.response,t.status))}const n=this.esgst.sg?s.closest(".comment").getElementsByClassName("comment__children")[0]:s.getElementsByClassName("comment_children")[0];for(let t=n.children.length-1;t>-1;t--){const s=n.children[t],a=s.querySelector('[href*="/go/comment/"]').getAttribute("href").match(/\/go\/comment\/(.+)/)[1];e.context.querySelector(`[href*="/go/comment/${a}"`)&&s.remove()}if(n.children.length){e.context.appendChild(n),await this.endless_load(n);for(let t=n.children.length-1;t>-1;t--)e.context.appendChild(n.children[t]);n.remove(),e.submitButton.build(3),this.createElements(e.status,"atinner",[{attributes:{class:"esgst-bold esgst-warning"},type:"span",children:[{text:"Somebody beat you to it!",type:"node"},{type:"br"},{text:"There are other replies to this comment.",type:"node"},{type:"br"},{text:"You can review them below before confirming your reply.",type:"node"}]}]),e.checked=!0}else{const t=await this.saveComment(e.context,e.tradeCode,e.parentId,e.description.value,e.url,e.status,!e.callback);e.callback&&e.callback(t.id,t.response,t.status)}}addReplyButton(e,t,s){const n={callback:s,checked:!1,commentUrl:t,context:e.parentElement,description:e.querySelector('[name="description"]'),parentId:e.querySelector('[name="parent_id"]'),tradeCode:(e.querySelector('[name="trade_code"]')||{value:""}).value,url:this.esgst.sg?c.esgst.locationHref.match(/(.+?)(#.+?)?$/)[1]:"/ajax.php"},a=e.getElementsByClassName(this.esgst.sg?"align-button-container":"btn_actions")[0];a.firstElementChild.remove(),n.button=this.createElements(a,"afterbegin",[{attributes:{class:"esgst-ded-button"},type:"div"}]),n.status=this.createElements(a,"beforeend",[{attributes:{class:"comment__actions action_list esgst-ded-status"},type:"div"}]),n.submitButton=tt.create([{color:"white",icons:["fa-send"],name:"Submit",switchTo:{onReturn:1},onClick:this.submitComment.bind(this,n)},{template:"loading",isDisabled:!0,name:"Saving..."},{color:"white",icons:["fa-send"],name:"Confirm",switchTo:{onReturn:3},onClick:this.submitComment.bind(this,n)},{template:"loading",isDisabled:!0,name:"Saving..."}]).insert(n.button,"beforeend")}async hideGames(e,t){const s=await ut.contains([["server"]]);let n=!1,a=JSON.parse(this.getValue("sgdbCache",'{ "lastUpdate": 0 }'));if(!function(e,t,s){k(2,arguments);var n=Ce(e,s),a=Ce(t,s);return n.getTime()===a.getTime()}(Date.now(),a.lastUpdate)){if(s){e.update&&e.update("Updating API cache...");try{const e=await Ne.get("https://esgst.rafaelgomes.xyz/api/games/sgids");a={cache:{appids:e.json.result.found.apps,subids:e.json.result.found.subs},lastUpdate:Date.now()}}catch(e){}}else a={cache:{appids:{},subids:{}},lastUpdate:Date.now()};n=!0}e.update&&e.update("Retrieving ids from cache...");const i={apps:{},subs:{}},o=[],r=[],l=[],c=[],d=[];for(const s of e.appIds){const e=this.esgst.games.apps[s];if(e&&(t&&!e.hidden||!t&&e.hidden))continue;const n=e&&e.sgId||a.cache&&a.cache.appids&&a.cache.appids[s];n?(o.push(n),i.apps[s]={hidden:!t||null,sgId:n}):0===n?l.push(s):r.push(s)}for(const s of e.subIds){const e=this.esgst.games.subs[s];if(e&&(t&&!e.hidden||!t&&e.hidden))continue;const n=e&&e.sgId||a.cache&&a.cache.subids&&a.cache.subids[s];n?(o.push(n),i.subs[s]={hidden:!t||null,sgId:n}):0===n?d.push(s):c.push(s)}for(let s=r.length-1;s>-1&&!e.canceled;s--){e.update&&e.update(`Retrieving app ids from SteamGifts (${s} left)...`);const n=r[s],c=await this.getGameSgId(n,"apps");c?(o.push(c),i.apps[n]={hidden:!t||null,sgId:c}):(a.cache.appids[n]=0,l.push(n))}for(let s=c.length-1;s>-1&&!e.canceled;s--){e.update&&e.update(`Retrieving sub ids from SteamGifts (${s} left)...`);const n=c[s],r=await this.getGameSgId(n,"subs");r?(o.push(r),i.subs[n]={hidden:!t||null,sgId:r}):(a.cache.subids[n]=0,d.push(n))}if(e.canceled)return;n&&await this.setValue("sgdbCache",JSON.stringify(a));const g=t?"Unhiding":"Hiding";e.update&&e.update(g+" games...");const u=o.length;for(const[s,n]of o.entries()){if(e.canceled)return;e.update&&e.update(`${g} games (${s} of ${u})...`),await Ne.post("/ajax.php",{data:`xsrf_token=${Be.xsrfToken}&do=${t?"remove_filter":"hide_giveaways_by_game_id"}&game_id=${n}`})}return e.canceled?void 0:(e.update&&e.update("Saving..."),await this.lockAndSaveGames(i),e.update&&e.update(""),{apps:l,subs:d})}async getGameSgId(e,t){const s=Se.parse((await Ne.post("/ajax.php",{data:"do=autocomplete_giveaway_game&page_number=1&search_query="+encodeURIComponent(e)})).json.html).querySelectorAll(".table__row-outer-wrap");for(const n of s){const s=await this.esgst.modules.games.games_getInfo(n);if(s&&s.type===t&&s.id===e)return n.getAttribute("data-autocomplete-id")}}setDatePickerDate(e,t){const s=document.createElement("script");s.textContent=`\n\t\t\tfunction setDatePickerDate() {\n\t\t\t\tconst input = document.querySelector('input[name="${e}"]');\n\t\t\t\tconst actualInput = input.previousElementSibling;\n\n\t\t\t\tconst datepicker = actualInput && actualInput.classList.contains('hasDatepicker') ? actualInput : input;\n\n\t\t\t\t$(datepicker).datetimepicker("setDate", new Date(${t.getTime()}));\n\t\t\t}\n\n\t\t\tsetDatePickerDate();\n\t\t`,document.body.appendChild(s),s.remove()}testPath(e,t,s){const n=this.esgst.paths[t].filter(t=>t.name===e)[0];return!(!n||!this.getPath(s).match(n.pattern))}getPath(e){return e.replace(/^https?:\/\/.+?\//,"/")}isCurrentPath(e){if(Array.isArray(e)){for(const t of e)if(c.esgst.currentPaths.indexOf(t)>-1)return!0;return!1}return c.esgst.currentPaths.indexOf(e)>-1}getBrowserInfo(){return new Promise(e=>n.runtime.sendMessage({action:"getBrowserInfo"}).then(t=>e(JSON.parse(t))))}getTds(){return new Promise(e=>n.runtime.sendMessage({action:"get-tds"}).then(t=>e(JSON.parse(t))))}notifyTds(e){return new Promise(t=>n.runtime.sendMessage({action:"notify-tds",data:JSON.stringify(e)}).then(()=>t()))}do_lock(e){return new Promise(t=>n.runtime.sendMessage({action:"do_lock",lock:JSON.stringify(e)}).then(e=>t(JSON.parse(e))))}updateLock(e){return new Promise(t=>n.runtime.sendMessage({action:"update_lock",lock:JSON.stringify(e)}).then(()=>t()))}do_unlock(e){return new Promise(t=>n.runtime.sendMessage({action:"do_unlock",lock:JSON.stringify(e)}).then(()=>t()))}setValues(e){return new Promise(t=>n.storage.local.set(e).then(()=>{for(const t in e)if(e.hasOwnProperty(t)){this.esgst.storage[t]=e[t];try{this.esgst[t]=JSON.parse(e[t])}catch(s){this.esgst[t]=e[t]}}t()}))}setValue(e,t){return this.setValues({[e]:t})}getValue(e,t){return l.isSet(this.esgst.storage[e])?this.esgst.storage[e]:t}getValues(e){const t={};for(const s in e)e.hasOwnProperty(s)&&(t[s]=l.isSet(this.esgst.storage[s])?this.esgst.storage[s]:e[s]);return t}delValues(e){return new Promise(t=>n.storage.local.remove(e).then(()=>{e.forEach(e=>delete this.esgst.storage[e]),t()}))}delValue(e){return this.delValues([e])}openDonationsPopup(){const e=new lt({icon:"fa-dollar",title:"Donations",isTemp:!0});e.getScrollable(Se.element("fragment",null,Se.element("br",null),Se.element("div",null,Se.element("a",{class:"table__column__secondary-link",href:"https://www.buymeacoffee.com/rafaelgomesxyz",target:"_blank"},Se.element("strong",null,"Buy Me A Coffee"))),Se.element("div",null,Se.element("a",{class:"table__column__secondary-link",href:"https://www.patreon.com/rafaelgomesxyz",target:"_blank"},Se.element("strong",null,"Patreon"))),Se.element("div",null,Se.element("a",{class:"table__column__secondary-link",href:"https://steamcommunity.com/tradeoffer/new/?partner=214244550&token=LW6Selqp",target:"_blank"},Se.element("strong",null,"Steam Trade"))),Se.element("div",null,Se.element("strong",null,"Paypal:")," rafaelgomesxyz@gmail.com"," ",this.getCopyIcon("rafaelgomesxyz@gmail.com")),Se.element("div",null,Se.element("strong",null,"Bitcoin:")," 32WY96ch5MSZ3FNubL5f7QZ9K3WWNHNpV9"," ",this.getCopyIcon("32WY96ch5MSZ3FNubL5f7QZ9K3WWNHNpV9")),Se.element("div",null,Se.element("strong",null,"Monero:")," ","42Tw49nUAig3kk1tJh1y1ZP8vrkmY4EH3QW3SRijHxGggtBpDUn2TqJAVBJYBCybGXNninC4gGD9nhe3cttBaZ6u5NuhiLM"," ",this.getCopyIcon("42Tw49nUAig3kk1tJh1y1ZP8vrkmY4EH3QW3SRijHxGggtBpDUn2TqJAVBJYBCybGXNninC4gGD9nhe3cttBaZ6u5NuhiLM")),Se.element("div",null,Se.element("strong",null,"Humble Bundle Partner ID:")," gsrafael01 ",this.getCopyIcon("gsrafael01")))),e.open()}async addHeaderMenu(){if(!c.header)return;c.header.addButtonContainer({buttonImage:c.esgst.icon,buttonName:" ESGST",isDropdown:!0,side:"left",url:"https://www.steamgifts.com/account/settings/profile?esgst=settings",dropdownItems:[{description:"Visit the GitHub page.",icon:"fa fa-fw fa-github icon-grey grey",name:"GitHub",openInNewTab:!0,url:"https://github.com/SquishedPotatoe/esgst"},{description:"Report bugs and / or make suggestions.",icon:"fa fa-fw fa-bug icon-red red",name:"Bugs / Suggestions",openInNewTab:!0,url:"https://github.com/SquishedPotatoe/esgst/issues"},{description:"Check out what's coming in the next versions.",icon:"fa fa-fw fa-map-signs icon-blue blue",name:"Milestones",openInNewTab:!0,url:"https://github.com/SquishedPotatoe/esgst/milestones"},{description:"Visit the discussion page.",icon:"fa fa-fw fa-commenting icon-green green",name:"Discussion",url:"https://www.steamgifts.com/discussion/TDyzv/"},{description:"Visit / join the Steam group.",icon:"fa fa-fw fa-steam icon-green green",name:"Steam Group",openInNewTab:!0,url:"http://steamcommunity.com/groups/esgst"},{description:"Check out the changelog.",icon:"fa fa-fw fa-file-text-o icon-yellow yellow",name:"Changelog",openInNewTab:!0,url:"https://github.com/SquishedPotatoe/esgst/releases"},{description:"Help make ESGST better!",icon:"fa fa-fw fa-dollar icon-green green",name:"Donations",onClick:this.openDonationsPopup.bind(this)},{description:"Check out the SteamGifts request log.",icon:"fa fa-fw fa-history icon-grey grey",name:"SteamGifts Request Log",onClick:this.openRequestLog.bind(this)},{icon:"fa fa-fw fa-info-circle icon-grey grey",name:"Current Version: "+c.esgst.versionName}],onClick:e=>{if(!d.get("openSettingsInTab")){e.preventDefault();try{Mt.loadMenu(!0)}catch(e){dt.error(e.message)}}}}),c.header.buttonContainers.esgst.nodes.outer.id="esgst";c.header.buttonContainers.esgst.nodes.arrow.addEventListener("click",this.toggleHeaderMenu.bind(this),!0)}getSelectors(e,t){if(e){const s=[];for(const n of t)s.push(n.replace(/X/,`.esgst-es-page-${e} `),n.replace(/X/,".esgst-es-page-"+e));t=s.join(", ")}else t=t.map(e=>e.replace(/X/,"")).join(", ");return t}getLevelFromCv(e){for(const[t,s]of c.esgst.cvLevels.entries())if(e<s){const n=c.esgst.cvLevels[t-1];return this.round(t-1+(e-n)/(s-n))}}getChanges(e,t){if("local"===t)for(const t in e){if(!e.hasOwnProperty(t))continue;const s=e[t];if(null===s.newValue&&(delete c.esgst.storage[t],delete c.esgst[t]),l.isSet(s.newValue)){c.esgst.storage[t]=s.newValue;try{c.esgst[t]=JSON.parse(c.esgst.storage[t])}catch(e){c.esgst[t]=c.esgst.storage[t]}}}}dateToServer(e){const t=new Date(e);return`${t.getFullYear()}-${("0"+(t.getMonth()+1)).slice(-2)}-${("0"+t.getDate()).slice(-2)}`}dateFromServer(e){const t=e.split("-"),s=parseInt(t[0]),n=parseInt(t[1]),a=parseInt(t[2]);return`${ms[n-1]} ${a}, ${s}`}areArraysEqual(e,t){if(e.length!==t.length)return!1;for(let s=0,n=e.length;s<n;s++)if(e[s]!==t[s])return!1;return!0}findFeature(e){e=e.toLowerCase();let t=null,s=0;for(const n of Object.keys(c.esgst.featuresById)){const a=c.esgst.featuresById[n];let i=0;const o=a.name.toLowerCase();if(o===e)return a;const r=o.match(e);r&&(i+=r[0].length/o.length),i>s&&(t=a,s=i)}return t}};c.add({common:hs});const ps=new class extends gt{constructor(){super(),this.info={description:()=>Se.element("ul",null,Se.element("li",null,"Adds a timestamp indicating when the page was loaded to any page, in the preferred location.")),id:"plt",name:"Page Load Timestamp",inputItems:[{id:"plt_format",prefix:"Timestamp format: ",tooltip:"ESGST uses date-fns v2.0.0-alpha.25, so check the accepted tokens here: https://date-fns.org/v2.0.0-alpha.25/docs/Getting-Started."}],options:{title:"Position:",values:["Sidebar","Footer"]},sg:!0,st:!0,type:"general"}}init(){const e=xe(Date.now(),d.get("plt_format")||"MMM dd, yyyy, HH:mm:ss");switch(d.get("plt_index")){case 0:if(this.esgst.sidebar){Se.insert(this.esgst.sidebar,"afterbegin",Se.element("span",{className:"esgst-plt"},Se.element("h3",{className:"sidebar__heading"},"Page Load Timestamp"),Se.element("div",{className:"sidebar__navigation"},e)));break}case 1:if(!c.footer)return;c.footer.addLinkContainer({name:"Page loaded on "+e,side:"left"}).nodes.outer.classList.add("esgst-plt");break}}};const fs=new class extends gt{constructor(){super(),this.info={description:()=>Se.element("ul",null,Se.element("li",null,'Displays the full level at the header, instead of only showing it when hovering over the level. For example, "Level 5" becomes "Lvl 5.25".')),id:"vfl",name:"Visible Full Level",sg:!0,type:"general"}}init(){Ee.subscribe(Ue,this.update.bind(this)),this.update(null,Be.counters.level)}async update(e,t){c.header.buttonContainers.account.nodes.level.textContent="Lvl "+t.full}},bs=hs.createElements.bind(hs),ws=hs.getElements.bind(hs);const ys=new class extends gt{constructor(){super(),this.info={description:()=>Se.element("ul",null,Se.element("li",null,"If you cannot access a giveaway for blacklist reasons (either because you have blacklisted the creator or the creator has blacklisted you), this feature requests the giveaway in anonymous mode (as if you were not logged in) and loads it to you.")),id:"bgl",name:"Blacklist Giveaway Loader",sg:!0,type:"giveaways"}}async init(){if(!this.esgst.giveawayPath)return;let e=Array.from(this.esgst.pageOuterWrap.children).map(e=>({context:e})),t=document.getElementsByClassName("table--summary")[0];if(t=t&&t.lastElementChild.firstElementChild.lastElementChild,!t)return;let s=t.textContent.match(/you\s(have\s(been\s)?|previously\s)blacklisted/);if(!s)return;bs(this.esgst.pageOuterWrap,"atinner",[{attributes:{class:"fa fa-circle-o-notch fa-spin"},type:"i"},{text:"Loading giveaway...",type:"span"}]);let n=(await Ne.get(window.location.pathname,{anon:!0})).html;n.getElementsByClassName("table--summary")[0]?(bs(this.esgst.pageOuterWrap,"atinner",e),bs(this.esgst.pageOuterWrap.getElementsByClassName("table--summary")[0].lastElementChild.firstElementChild.lastElementChild,"beforeend",[{type:"br"},{type:"br"},{attributes:{class:"esgst-red"},text:"This is a group/whitelist giveaway and therefore cannot be loaded by Blacklist Giveaway Loader.",type:"span"}])):(this.esgst.featuredContainer=bs(this.esgst.pageOuterWrap,"beforebegin",[{attributes:{class:"featured__container"},type:"div"}]),bs(this.esgst.featuredContainer,"atinner",Array.from(n.getElementsByClassName("featured__container")[0].children).map(e=>({context:e}))),bs(this.esgst.pageOuterWrap,"atinner",Array.from(n.getElementsByClassName("page__outer-wrap")[0].children).map(e=>({context:e}))),await ws(),bs(this.esgst.sidebar,"afterbegin",[{attributes:{class:"sidebar__error is-disabled"},type:"div",children:[{attributes:{class:"fa fa-exclamation-circle"},type:"i"},{text:""+(s[1]?"previously "===s[1]?`Off Your Blacklist (${t.firstElementChild.textContent})`:"have been "===s[1]?"You Are Blacklisted":"On Your Blacklist":"On Your Blacklist"),type:"node"}]}]))}};const vs=new class extends gt{constructor(){super(),this.info={description:()=>Se.element("ul",null,Se.element("li",null,"Keeps the sidebar narrowed in all pages.")),id:"ns",name:"Narrow Sidebar",sg:!0,type:"general"}}init(){this.esgst.sidebar&&(this.esgst.sidebar.classList.remove("sidebar--wide"),this.esgst.sidebar.classList.add("esgst-ns"),this.esgst.sidebar.style.minWidth="206px",this.esgst.sidebar.style.width="206px")}};const _s=new class extends gt{constructor(){super(),this.info={description:()=>Se.element("ul",null,Se.element("li",null,"Hides the community poll (if there is one) of the main page.")),features:{hcp_v:{name:"Only hide the poll if you already voted in it.",sg:!0}},id:"hcp",name:"Hidden Community Poll",sg:!0,type:"general"}}init(){if(!this.esgst.giveawaysPath||!this.esgst.activeDiscussions)return;let e=this.esgst.activeDiscussions.nextElementSibling;e&&e.classList.contains("widget-container")&&!e.querySelector('.block_header > [href="/happy-holidays"]')&&(d.get("hcp_v")&&!e.querySelector(".table__row-outer-wrap.is-selected")||e.classList.add("esgst-hidden"))}};const ks=new class extends gt{constructor(){super(),this.info={description:()=>Se.element("ul",null,Se.element("li",null,"Reverses the active discussions so that discussions come before deals (original order).")),id:"rad",name:"Reversed Active Discussions",sg:!0,sgPaths:/^Discussion|Giveaway|Browse\sGiveaways/,type:"discussions"}}async init(){(this.esgst.giveawaysPath||this.esgst.commentsPath||this.esgst.activeDiscussions)&&!d.get("oadd")&&c.esgst.activeDiscussions.insertBefore(c.esgst.activeDiscussions.lastElementChild,c.esgst.activeDiscussions.firstElementChild)}},xs=hs.endless_load.bind(hs);const As=new class extends gt{constructor(){super(),this.info={description:()=>Se.element("ul",null,Se.element("li",null,'Brings back the SteamGifts\' old active discussions design, while keeping the new "Deals" section.'),Se.element("li",null,'Only one section ("Discussions" or "Deals") can be shown at a time. There is a button (',Se.element("i",{className:"fa fa-retweet"}),") in the page heading of the active discussions that allows you to switch sections.")),features:{oadd_d:{description:()=>Se.element("ul",null,Se.element("li",null,'With this option enabled, the deals are included in the "Discussions" section instead of being exclusive to the "Deals" section.')),name:'Show deals in the "Discussions" section.',sg:!0}},id:"oadd",name:"Old Active Discussions Design",sg:!0,type:"discussions"}}async init(){(this.esgst.giveawaysPath||this.esgst.commentsPath||this.esgst.activeDiscussions)&&await this.oadd_load()}async oadd_load(e,t){let s,n,a,i,o,r,l,c,g,u,m,h=7;d.get("adtd_sg").enabled&&(h=d.get("activeDiscussions_displayed")),g=(await Ne.get("/discussions")).html,u=(await Ne.get("/discussions/deals")).html,this.esgst.activeDiscussions.classList.add("esgst-oadd"),Se.insert(this.esgst.activeDiscussions,"atinner",Se.element("fragment",null,Se.element("div",{ref:e=>i=e},Se.element("div",{className:"page__heading"},Se.element("div",{className:"esgst-heading-button",title:"Switch to Deals",ref:e=>r=e},Se.element("i",{className:"fa fa-retweet"})),Se.element("div",{className:"page__heading__breadcrumbs"},Se.element("a",{href:"/discussions"},"Active Discussions")),Se.element("a",{className:"page__heading__button page__heading__button--green",href:"/discussions"},"More ",Se.element("i",{className:"fa fa-angle-right"}))),Se.element("div",{className:"table"},Se.element("div",{className:"table__heading"},Se.element("div",{className:"table__column--width-fill"},"Summary"),Se.element("div",{className:"table__column--width-small text-center"},"Comments"),Se.element("div",{className:"table__column--width-medium text-right"},"Last Post")),Se.element("div",{className:"table__rows",ref:e=>o=e}))),Se.element("div",{className:"esgst-hidden",ref:e=>s=e},Se.element("div",{className:"page__heading"},Se.element("div",{className:"esgst-heading-button",title:"Switch to Discussions",ref:e=>a=e},Se.element("i",{className:"fa fa-retweet"})),Se.element("div",{className:"page__heading__breadcrumbs"},Se.element("a",{href:"/discussions/deals"},"Active Deals")),Se.element("a",{className:"page__heading__button page__heading__button--green",href:"/discussions/deals"},"More ",Se.element("i",{className:"fa fa-angle-right"}))),Se.element("div",{className:"table"},Se.element("div",{className:"table__heading"},Se.element("div",{className:"table__column--width-fill"},"Summary"),Se.element("div",{className:"table__column--width-small text-center"},"Comments"),Se.element("div",{className:"table__column--width-medium text-right"},"Last Post")),Se.element("div",{className:"table__rows",ref:e=>n=e})))));let p=null;if(d.get("df")&&d.get("df_m")&&d.get("df_enable")){let e=d.get("df_preset");if(e){let t;for(t=d.get("df_presets").length-1;t>-1&&d.get("df_presets")[t].name!==e;t--);t>-1&&(p=d.get("df_presets")[t])}}let f=await this.esgst.modules.discussions.discussions_get(g,!0);d.get("oadd_d")||(m=[],f.forEach(e=>{"Deals"!==e.category&&m.push(e)}),f=m);const b=this.esgst.modules.discussionsDiscussionFilters.getFilters();for(l=0,c=f.length-1;l<h&&c>-1;c--)p&&!this.esgst.modules.discussionsDiscussionFilters.filters_filterItem(b,f[c],p.rules)||(o.appendChild(f[c].outerWrap),l+=1);for(f=await this.esgst.modules.discussions.discussions_get(u,!0),l=0,c=f.length-1;l<h&&c>-1;c--)p&&!this.esgst.modules.discussionsDiscussionFilters.filters_filterItem(b,f[c],p.rules)||(n.appendChild(f[c].outerWrap),l+=1);r.addEventListener("click",()=>{i.classList.add("esgst-hidden"),s.classList.remove("esgst-hidden")}),a.addEventListener("click",()=>{i.classList.remove("esgst-hidden"),s.classList.add("esgst-hidden")}),d.get("adots")?this.esgst.modules.discussionsActiveDiscussionsOnTopSidebar.adots_load(e):d.get("radb")&&this.esgst.modules.discussionsRefreshActiveDiscussionsButton.radb_addButtons(),e?(await xs(this.esgst.activeDiscussions),t&&t()):t&&t()}};const Cs=new class extends gt{constructor(){super(),this.info={description:()=>Se.element("ul",null,Se.element("li",null,"Moves the active discussions to the top/sidebar of the page (you can decide where)."),Se.element("li",null,"If you move it to the sidebar, some things will be changed to save some space:"),Se.element("ul",null,Se.element("li",null,"The username and avatar of the user who last posted to the discussion will be removed (the button to go to the last comment will remain)."),Se.element("li",null,"If you have ",Se.element("span",{"data-esgst-feature-id":"ags"})," enabled, it will be hidden and only visible when hovering hover the search field.")),Se.element("li",null,"If you have ",Se.element("span",{"data-esgst-feature-id":"at"})," enabled, it will not run inside of the active discussions."),Se.element("li",null,"If you have ",Se.element("span",{"data-esgst-feature-id":"ut"})," enabled, any user tags will be hidden inside of the active discussions(they will still be visible if you click on the tag button to edit them).")),id:"adots",name:"Active Discussions On Top/Sidebar",options:{title:"Move to:",values:["Top","Sidebar"]},sg:!0,sgPaths:/^Discussion|Giveaway|Browse\sGiveaways/,type:"discussions"}}async init(){(this.esgst.giveawaysPath||this.esgst.commentsPath||this.esgst.activeDiscussions)&&!d.get("oadd")&&await c.common.checkMissingDiscussions()}adots_load(e){let t,s,n,a,i,o,r,l,g,u,m,h,p,f,b;if(this.esgst.activeDiscussions)if(e||(this.esgst.activeDiscussions.style.marginTop="0px",this.esgst.activeDiscussions.classList.add("esgst-adots"),d.get("adtd_sg").enabled&&this.esgst.modules.discussionsActiveDiscussionsToDisplay.adtd_remove()),0===d.get("adots_index"))e?d.get("oadd")&&d.get("radb")&&this.esgst.modules.discussionsRefreshActiveDiscussionsButton.radb_addButtons():(t=this.esgst.activeDiscussions.parentElement,t.insertBefore(this.esgst.activeDiscussions,t.firstElementChild),d.get("radb")&&this.esgst.modules.discussionsRefreshActiveDiscussionsButton.radb_addButtons());else{if(e||(n=d.get("ib")?45:35,this.esgst.style.insertAdjacentText("beforeend",`\n\t\t\t\t\t\t.esgst-adots .table__row-inner-wrap >:first-child {\n\t\t\t\t\t\t\tfloat: left;\n\t\t\t\t\t\t\twidth: ${n}px;\n\t\t\t\t\t\t\theight: ${n}px;\n\t\t\t\t\t\t}\n\t\t\t\t\t\t.esgst-adots .table__row-inner-wrap >:first-child >* {\n\t\t\t\t\t\t\twidth: ${n}px;\n\t\t\t\t\t\t\theight: ${n}px;\n\t\t\t\t\t\t}\n\t\t\t\t\t\t.esgst-adots .table__row-inner-wrap >:last-child {\n\t\t\t\t\t\t\tmargin-left: ${n+5}px;\n\t\t\t\t\t\t\ttext-align: left;\n\t\t\t\t\t\t\twidth: auto;\n\t\t\t\t\t\t}\n\t\t\t\t\t\t.esgst-adots .table__column--width-fill {\n\t\t\t\t\t\t\tmargin-left: 5px;\n\t\t\t\t\t\t\tvertical-align: top;\n\t\t\t\t\t\t\twidth: calc(100% - ${n+15}px);\n\t\t\t\t\t\t}\n\t\t\t\t\t`),Se.insert(this.esgst.sidebar,"beforeend",Se.element("h3",{className:"sidebar__heading esgst-adots-heading",ref:e=>s=e},Se.element("span",{className:"esgst-adots-tab-heading esgst-selected",ref:e=>a=e},"Discussions"),Se.element("span",{className:"esgst-adots-tab-heading",ref:e=>i=e},"Deals"),d.get("radb")&&Se.element("div",{className:"esgst-radb-button",title:c.common.getFeatureTooltip("radb","Refresh active discussions/deals"),onclick:e=>{let t=e.currentTarget.firstElementChild;t.classList.add("fa-spin"),d.get("oadd")?this.esgst.modules.discussionsOldActiveDiscussionsDesign.oadd_load(!0,()=>t.classList.remove("fa-spin")):c.common.checkMissingDiscussions(!0,()=>t.classList.remove("fa-spin"))}},Se.element("i",{className:"fa fa-refresh"})),Se.element("a",{className:"esgst-float-right sidebar__navigation__item__name",href:"/discussions"},"More")))),d.get("oadd")){for(r=this.esgst.activeDiscussions.firstElementChild,l=this.esgst.activeDiscussions.lastElementChild,r.firstElementChild.remove(),r.firstElementChild.firstElementChild.remove(),l.firstElementChild.remove(),l.firstElementChild.firstElementChild.remove(),u=this.esgst.activeDiscussions.getElementsByClassName("table__column--last-comment"),m=0,p=u.length;m<p;++m)h=u[0].getElementsByClassName("table__last-comment-icon")[0],h&&(h.classList.add("esgst-float-right"),u[0].previousElementSibling.appendChild(h)),u[0].remove();e||(r=r.firstElementChild.firstElementChild,l=l.firstElementChild.firstElementChild)}else{let n=1,a=0;if(d.get("rad")&&(n=0,a=1),e)b=document.getElementsByClassName("table"),r=b[n],l=b[a];else if(r=this.esgst.activeDiscussions.lastElementChild.firstElementChild.lastElementChild,l=this.esgst.activeDiscussions.firstElementChild.firstElementChild.lastElementChild,d.get("rad")){const e=r;r=l,l=e}for(u=r.getElementsByClassName("table__row-outer-wrap"),m=0,p=u.length;m<p;++m)g=u[m],f=g.getElementsByClassName("table__column__secondary-link")[0],t=f.parentElement,Se.insert(t,"afterend",Se.element("fragment",null,Se.element("p",{ref:e=>s=e}),Se.element("div",{style:{clear:"both"}}))),s.appendChild(f),t.lastElementChild.classList.contains("table__last-comment-icon")&&(t.lastElementChild.classList.add("esgst-float-right"),s.appendChild(t.lastElementChild)),t.remove();for(u=l.getElementsByClassName("table__row-outer-wrap"),m=0,p=u.length;m<p;++m)g=u[m],f=g.getElementsByClassName("table__column__secondary-link")[0],t=f.parentElement,Se.insert(t,"afterend",Se.element("fragment",null,Se.element("p",{ref:e=>s=e}),Se.element("div",{style:{clear:"both"}}))),s.appendChild(f),t.lastElementChild.classList.contains("table__last-comment-icon")&&(t.lastElementChild.classList.add("esgst-float-right"),s.appendChild(t.lastElementChild)),t.remove()}if(a||(a=r.parentElement.previousElementSibling.firstElementChild,i=a.nextElementSibling),a.classList.contains("esgst-selected")?(l.classList.add("esgst-hidden","esgst-adots"),r.classList.add("esgst-adots"),r.classList.remove("esgst-hidden")):(r.classList.add("esgst-hidden","esgst-adots"),l.classList.add("esgst-adots"),l.classList.remove("esgst-hidden")),!e){Se.insert(this.esgst.sidebar,"beforeend",Se.element("div",{ref:e=>o=e,className:"esgst-adots-container"})),o.appendChild(r),o.appendChild(l),a.addEventListener("click",this.adots_changeTab.bind(this,a,i)),i.addEventListener("click",this.adots_changeTab.bind(this,a,i)),this.esgst.activeDiscussions.remove(),this.esgst.activeDiscussions=o;const e=document.querySelector(".sidebar .fanatical_container");this.esgst.sidebar&&e&&this.esgst.sidebar.appendChild(e.parentElement)}}}adots_changeTab(e,t,s){(e.classList.contains("esgst-selected")&&s.currentTarget===t||t.classList.contains("esgst-selected")&&s.currentTarget===e)&&(e.classList.toggle("esgst-selected"),t.classList.toggle("esgst-selected"),e.parentElement.nextElementSibling.firstElementChild.classList.toggle("esgst-hidden"),e.parentElement.nextElementSibling.lastElementChild.classList.toggle("esgst-hidden"))}};const Ss=new class extends gt{constructor(){super(),this.info={description:()=>Se.element("ul",null,Se.element("li",null,"Allows you to hide elements in any page using CSS selectors."),Se.element("li",null,"If you do not know how to use CSS selectors or you are having trouble hiding an element, leave a comment in the ESGST thread with a description/image of the element that you want to hide and I will give you the selector that you have to use."),Se.element("li",null,"Here are some quick examples:"),Se.element("ul",null,Se.element("li",null,'To hide the "Redeem" button in your'," ",Se.element("a",{href:"https://www.steamgifts.com/giveaways/won"},"won")," page, use:"," ",Se.element("code",null,".table__column__key__redeem")),Se.element("li",null,"To hide the featured giveaway container (the big giveaway) in the main page, use:"," ",Se.element("code",null,"[esgst.giveawaysPath].featured__container")),Se.element("li",null,"To hide the pinned giveaways (the multiple copy giveaways) in the main page, use:"," ",Se.element("code",null,"[esgst.giveawaysPath].pinned-giveaways__outer-wrap")))),inputItems:[{id:"ef_filters",prefix:"Filters: ",tooltip:"Separate each selector by a comma followed by a space, for example: .class_1, .class_2, #id"}],id:"ef",name:"Element Filters",sg:!0,st:!0,type:"general"}}init(){this.ef_hideElements(document),this.esgst.endlessFeatures.push(this.ef_hideElements.bind(this)),!d.get("sal")&&this.esgst.wonPath&&this.esgst.endlessFeatures.push(this.esgst.modules.giveawaysSteamActivationLinks.sal_addObservers.bind(this.esgst.modules.giveawaysSteamActivationLinks))}ef_hideElements(e,t,s,n){e===document&&t||d.get("ef_filters").split(", ").forEach(t=>{if(t)try{const s=t.match(/\[esgst\.(.+)]/);if(s){if(!this.esgst[s[1]])return;t=t.replace(/\[esgst\..+]/,"")}const a=e.querySelectorAll(""+(n?`.esgst-es-page-${n} ${t}, .esgst-es-page-${n}${t}`:""+t));for(let e=a.length-1;e>-1;e--)a[e].classList.add("esgst-hidden")}catch(e){}})}},Es=hs.addGiveawayToStorage.bind(hs);const Ts=new class extends gt{constructor(){super(),this.info={endless:!0,id:"giveaways_addToStorage"}}init(){(d.get("lpv")||d.get("cewgd")||d.get("gc")&&d.get("gc_gi"))&&this.esgst.giveawayPath&&"https://www.steamgifts.com/giveaways/new"===document.referrer&&Es()}},Ns=hs.createElements.bind(hs),Ps=hs.createHeadingButton.bind(hs);const Ls=new class extends gt{constructor(){super(),this.info={description:()=>Se.element("ul",null,Se.element("li",null,"Adds a button (",Se.element("i",{className:"fa fa-image"}),") to the main page heading of any page that allows you to navigate through a carousel containing all of the attached images in the page."),Se.element("li",null,"The carousel can also be opened by clicking on any attached image in the page.")),features:{aic_b:{name:"Only trigger the carousel when clicking on the button in the main page heading.",sg:!0,st:!0}},id:"aic",name:"Attached Image Carousel",sg:!0,st:!0,type:"general"}}init(){this.esgst.endlessFeatures.push(this.aic_getImages.bind(this)),this.esgst.documentEvents.keydown.add(this.aic_move.bind(this)),this.esgst.mainPageHeading&&(this.aicButton=Ps({id:"aic",icons:["fa-image"],title:"View attached images"}),this.aicButton.classList.add("esgst-hidden"),this.aicButton.addEventListener("click",this.aic_openCarousel.bind(this,0,null)))}aic_move(e){"ArrowLeft"===e.key&&this.aicPrevious&&this.aicPrevious.click(),"ArrowRight"===e.key&&this.aicNext&&this.aicNext.click()}aic_getImages(e,t,s,n){let a=e.querySelectorAll(`${n?`.esgst-es-page-${n} .comment__toggle-attached, .esgst-es-page-${n}.comment__toggle-attached`:".comment__toggle-attached"}, ${n?`.esgst-es-page-${n} .view_attached, .esgst-es-page-${n}.view_attached`:".view_attached"}`),i=!1;for(let t=0,s=a.length;t<s;t++){let s=a[t],n=s.nextElementSibling.firstElementChild,o=n.getAttribute("src"),r=this.esgst.attachedImages.length;d.get("aic_b")||n.addEventListener("click",this.aic_openCarousel.bind(this,r));let l=s.closest(".comment");this.esgst.attachedImages.push({button:s,image:n,outerWrap:s,qiv:e.getAttribute&&e.getAttribute("data-esgst-qiv"),source:l&&l.querySelector(".comment__summary").id,url:o}),i=!0}i&&this.aicButton&&this.aicButton.classList.remove("esgst-hidden")}aic_openCarousel(e,t){t&&(t.preventDefault(),t.stopPropagation());let s=Ns(document.body,"beforeend",[{attributes:{class:"esgst-popup-modal esgst-aic-carousel"},type:"div"}]);s.style.zIndex=1e3+document.querySelectorAll(".esgst-popup:not(.esgst-hidden), .esgst-popout:not(.esgst-hidden)").length,s.addEventListener("click",this.aic_removeCarousel.bind(this)),this.aic_showImage(s,e)}aic_removeCarousel(e){e.target.closest(".esgst-aic-panel")||e.target.closest("img")||e.currentTarget.remove()}aic_showImage(e,t){let s,n,a,i,o;i=this.esgst.attachedImages.length,s=this.esgst.attachedImages[t],d.get("ail")&&s.image.setAttribute("src",s.url);const r=[{attributes:{class:"esgst-aic-left-button"},type:"div",children:[{attributes:{class:"fa fa-chevron-left"},type:"i"}]},{attributes:{class:"esgst-aic-right-button"},type:"div",children:[{attributes:{class:"fa fa-chevron-right"},type:"i"}]},{text:`${t+1}/${i}`,type:"div"}];s.source&&r.push({attributes:{class:"esgst-aic-source"},type:"div",children:[{attributes:{href:"#"+s.source},text:"Source",type:"a"}]});const l=s.image.cloneNode(!0);l.classList.remove("is_hidden","is-hidden");l.querySelector(".is_hidden, .is-hidden")&&l.classList.remove("is_hidden","is-hidden"),Ns(e,"atinner",[{attributes:{class:"esgst-aic-panel"},type:"div",children:r},{attributes:{href:s.url,rel:"nofollow noreferrer",target:"_blank"},type:"a",children:[{context:l}]}]),o=e.firstElementChild,a=o.nextElementSibling,n=o.offsetHeight+25,a.style.maxHeight=`calc(90% - ${n}px)`,a.style.marginTop=n+"px",a.firstElementChild.onload=this.aic_resizeImage.bind(this,a),this.aicPrevious=o.firstElementChild,this.aicNext=this.aicPrevious.nextElementSibling,t>0?this.aicPrevious.addEventListener("click",this.aic_showImage.bind(this,e,t-1)):this.aicPrevious.classList.add("esgst-disabled"),t<i-1?this.aicNext.addEventListener("click",this.aic_showImage.bind(this,e,t+1)):this.aicNext.classList.add("esgst-disabled"),s.source&&o.lastElementChild.addEventListener("click",()=>{e.remove(),s.qiv&&this.esgst.qiv.popout&&this.esgst.qiv.popout.open()})}aic_resizeImage(e){e.firstElementChild.style.maxHeight=e.offsetHeight-10+"px",e.firstElementChild.style.maxWidth=e.offsetWidth-10+"px"}};const Is=new class extends gt{constructor(){super(),this.info={description:()=>Se.element("ul",null,Se.element("li",null,"Adds a new giveaway page where you can see open giveaways for all of your followed games."),Se.element("li",null,"To access this page, use the sidebar navigation from the main page.")),id:"fgp",name:"Followed Games Page",sg:!0,type:"giveaways"}}init(){c.esgst.customPages.fgp={check:c.common.isCurrentPath("Browse Giveaways"),load:async()=>await this.load()};const e=document.querySelector('.sidebar__navigation__item__link[href="/giveaways/search?type=wishlist"]');e&&Se.insert(e.parentElement,"afterend",Se.element("li",{className:"sidebar__navigation__item"},Se.element("a",{className:"sidebar__navigation__item__link",href:"/giveaways/search?esgst=fgp"},Se.element("div",{className:"sidebar__navigation__item__name"},"Followed"),Se.element("div",{className:"sidebar__navigation__item__underline"}))))}async load(){const e={container:c.esgst.pagination.previousElementSibling,context:null,count:0,leftovers:[],page:1,perPage:50,reachedEnd:!1,set:null,url:c.esgst.path+"/search?page="};Se.insert(e.container,"atinner",Se.element("div",{ref:t=>e.context=t})),e.button=tt.create([{color:"green",icons:[],name:"Load More",onClick:async()=>await this.loadNextPage(e)},{color:"white",isDisabled:!0,icons:[],name:"Loading..."}]).insert(e.container,"beforeend"),e.button.onClick()}async loadNextPage(e){let t;for(Se.insert(e.context,"beforeend",Se.element("div",{ref:e=>t=e})),e.count=0;e.leftovers.length>0&&e.count<e.perPage;){const s=e.leftovers.splice(0,1)[0];t.appendChild(s),e.count+=1}if(e.count!==e.perPage)if(e.reachedEnd)e.button.destroy();else{do{const s=(await Ne.get(`${e.url}${e.page}`)).html,n=s.querySelectorAll(".giveaway__row-outer-wrap");for(const s of n){const n=await c.esgst.modules.games.games_getInfo(s);n&&c.esgst.games[n.type][n.id]&&c.esgst.games[n.type][n.id].followed&&(e.count<e.perPage?(t.appendChild(s.cloneNode(!0)),e.count+=1):e.leftovers.push(s.cloneNode(!0)))}e.page+=1;const a=s.querySelector(".pagination__navigation");e.reachedEnd=!a||a.lastElementChild.classList.contains(c.esgst.selectedClass)}while(!e.reachedEnd&&e.count<e.perPage);await c.common.endless_load(t,!0)}else await c.common.endless_load(t,!0)}},Bs=hs.endless_load.bind(hs);const Ds=new class extends gt{constructor(){super(),this.info={description:()=>Se.element("ul",null,Se.element("li",null,"Allows you to search the archive by exact title or app id."),Se.element("li",null,'To search by exact title, wrap the title in double quotes, for example: "Dream"'),Se.element("li",null,'To search by app id, use the "id:[id]" format, for example: id:229580')),features:{as_t:{name:"Open results in a new tab.",sg:!0}},id:"as",name:"Archive Searcher",sg:!0,type:"giveaways"}}async init(){if(this.esgst.customPages.as={check:this.esgst.archivePath,load:async()=>await this.as_init({})},!this.esgst.archivePath)return;let e=document.querySelector(".sidebar__search-input");const t=e.parentElement;e.outerHTML=""+e.outerHTML,e=t.firstElementChild,e.addEventListener("keypress",t=>{"Enter"===t.key&&(t.stopImmediatePropagation(),e.value.match(/"|id:/)?this.as_openPage(e):window.location.href=`${this.esgst.path}/search?q=${encodeURIComponent(e.value)}`)},!0)}as_openPage(e){const t=e.value.match(/"(.+?)"|id:(.+)/);let s="",n=!1;t[1]?s=t[1]:(s=t[2],n=!0),d.get("as_t")?window.location.href=`?esgst=as&query=${encodeURIComponent(s)}${n?"&isAppId=true":""}`:this.as_init({query:s,isAppId:n,isPopup:!0})}async as_init(e){if(e.isPopup||(e.query=decodeURIComponent(this.esgst.parameters.query),e.isAppId=!!this.esgst.parameters.isAppId),!e.query)return;if(!await ut.contains([["steamCommunity"]]))return;let t=null,s=null;if(e.isPopup){const e=new lt({addScrollable:"left",isTemp:!0});t=e.description,s=e.scrollable,e.open()}else t=s=this.esgst.sidebar.nextElementSibling,s.setAttribute("data-esgst-popup","true"),s.innerHTML="";pt.create("as",[{name:"ESGST",url:this.esgst.settingsUrl},{name:"Archive Searcher",url:"?esgst=as"}]).insert(t,"afterbegin"),e.context=s;const n=at.create().insert(t,"beforeend").setLoading("Retrieving game title...");if(e.isAppId){let t=(await Ne.get("https://steamcommunity.com/app/"+e.query)).html.getElementsByClassName("apphub_AppName")[0];if(!t)return void n.setError("Game title not found. Make sure you are entering a valid AppID. For example, 229580 is the AppID for Dream (http://steamcommunity.com/app/229580).");e.query=t.textContent}n.reset().hide(),e.query=(e.query.length>=50?e.query.slice(0,50):e.query).toLowerCase(),e.page=1,e.url=`${this.esgst.path}/search?q=${encodeURIComponent(e.query)}&page=`,e.leftovers=[],Se.insert(e.context,"beforeend",Se.element("div",{ref:t=>e.container=t}));tt.create([{color:"green",icons:[],name:"Load More",onClick:async()=>await this.as_request(e)},{color:"white",isDisabled:!0,icons:[],name:"Loading..."}]).insert(e.context,"beforeend").onClick()}async as_request(e){let t;for(e.count=0,Se.insert(e.container,"beforeend",Se.element("div",{ref:e=>t=e}));e.leftovers.length&&e.count<25;){const s=e.leftovers.splice(0,1)[0];t.appendChild(s),e.count+=1}let s=null;do{const n=(await Ne.get(`${e.url}${e.page}`)).html,a=n.querySelectorAll(".table__row-outer-wrap");for(const s of a)s.querySelector(".table__column__heading").textContent.match(/(.+?)( \(.+ Copies\))?$/)[1].toLowerCase()===e.query&&(e.count<25?(t.appendChild(s.cloneNode(!0)),e.count+=1):e.leftovers.push(s.cloneNode(!0)));e.page+=1,s=n.querySelector(".pagination__navigation")}while(e.count<25&&s&&!s.lastElementChild.classList.contains(this.esgst.selectedClass));await Bs(t)}};var Gs=s(67),qs=s.n(Gs);class Rs{constructor(e){if(this.table=document.createElement("div"),this.table.className="table esgst-ugd-table",Se.insert(this.table,"atinner",Se.element("fragment",null,Se.element("div",{className:"table__heading",ref:e=>this.heading=e}),Se.element("div",{className:"table__rows",ref:e=>this.rows=e}))),this.rowGroups={},this.hiddenColumns=[],this.numRows=0,this.numColumns=0,!e)return this;for(const t of e[0])t&&this.addColumn(t);const t=e.length;for(let s=1;s<t;s++)this.addRow(e[s])}clear(){this.rows.innerHTML="",this.numRows=0}addCell(e,t,s){if(!this.rows.children[e]){const e=[];for(let t=0;t<this.numColumns;t++)e[t]={size:"fill",value:"-"};this.addRow(e)}const n="string"==typeof s?s:s.value,a=[].concat(s.additionalClasses||[]),i=s.alignment||"center",o={className:`table__column--width-${s.size||"small"} text-${i} ${a.join(" ")}`};if(s.attributes)for(const e of s.attributes){const t=e.match(/(.+?)="(.+?)"/);o[t[1]]=o[t[2]]}let r;return"Total"===n&&(o.className+=" esgst-bold"),Se.insert(this.rows.children[e].firstElementChild.children[t],"atouter",Se.element("div",qs()({},o,{ref:e=>r=e}),n)),r}addRow(e,t,s,n,a,i){let o;Se.insert(this.rows,"beforeend",Se.element("div",{className:"table__row-outer-wrap "+(t&&n?"esgst-hidden":"")},Se.element("div",{className:"table__row-inner-wrap",ref:e=>o=e},t&&n?Se.element("i",{className:"fa fa-chevron-right"}):null)));let r=null;if(t)if(s){let e,s;r=this.rowGroups[t]={collapsibles:[],columns:[],isCollapsible:!0,row:o},Se.insert(o,"afterbegin",Se.element("fragment",null,Se.element("i",{className:"fa fa-plus-square esgst-clickable",title:i,ref:t=>e=t}),Se.element("i",{className:"fa fa-minus-square esgst-clickable esgst-hidden",title:a,ref:e=>s=e}))),s.addEventListener("click",this.collapseRows.bind(this,s,e,t)),e.addEventListener("click",this.expandRows.bind(this,s,e,t))}else n&&this.rowGroups[t].collapsibles.push(o);let l=!1;for(let t=0;t<this.numColumns;t++){let s=e?e[t]:"",n=[],a=null,i="center",c="small";!s||"object"!=typeof s||s instanceof Node||(n=n.concat(s.additionalClasses),a=s.additionalAttributes,i=s.alignment||i,c=s.size||c,s=s.value),this.hiddenColumns.indexOf(t)>-1&&n.push("esgst-hidden"),0===t&&s&&"Total"===s&&(l=!0),s&&"0 (0%)"!==s||n.push("is-faded"),l&&n.push("esgst-bold");const d={className:`table__column--width-${c} text-${i} ${n.join(" ")}`};if(a)for(const e of a){const t=e.match(/(.+?)="(.+?)"/);d[t[1]]=d[t[2]]}let g;Se.insert(o,"beforeend",Se.element("div",qs()({},d,{ref:e=>g=e}),s)),r&&r.columns.push(g)}this.numRows+=1}addColumn(e){const t="string"==typeof e?e:e.value,s=[].concat(e.additionalClasses),n=e.alignment||"center",a={className:`table__column--width-${e.size||"small"} text-${n} ${s.join(" ")}`};if(e.attributes)for(const t of e.attributes){const e=t.match(/(.+?)="(.+?)"/);a[e[1]]=a[e[2]]}Se.insert(this.heading,"beforeend",Se.element("div",a,t)),"Total"===t&&(a.className+=" esgst-bold");for(let e=0;e<this.numRows;e++){const t=this.rows.children[e];Se.insert(t,"beforeend",Se.element("div",a))}this.numColumns+=1}hideColumns(){for(const e of arguments){this.hiddenColumns.push(e-1),this.heading.children[e-1].classList.add("esgst-hidden");for(let t=this.numRows-1;t>-1;t--)this.rows.children[t].firstElementChild.children[e-1].classList.add("esgst-hidden")}}getRowGroup(e){return this.rowGroups[e]}collapseRows(e,t,s){e.classList.add("esgst-hidden"),t.classList.remove("esgst-hidden");for(const e of this.rowGroups[s].collapsibles)e.parentElement.classList.add("esgst-hidden")}expandRows(e,t,s){t.classList.add("esgst-hidden"),e.classList.remove("esgst-hidden");for(const e of this.rowGroups[s].collapsibles)e.parentElement.classList.remove("esgst-hidden")}}const Ms=new class extends gt{constructor(){super(),this.info={description:()=>Se.element("ul",null,Se.element("li",null,"Shows a popup reminding you of your cake day on SteamGifts."),Se.element("li",null,"You can set it to remind you a specified number of days before your cake day.")),features:{cdr_b:{inputItems:[{id:"cdr_days",prefix:"Days: "}],name:"Remind you a specified number of days before your cake day.",sg:!0},cdr_d:{name:"Remind you on your cake day.",sg:!0},cdr_a:{inputItems:[{id:"cdr_aDays",prefix:"Days: "}],name:"Remind you a specified number of days after your cake day.",sg:!0}},id:"cdr",name:"Cake Day Reminder",sg:!0,type:"general"}}async init(){c.esgst.profileFeatures.push(this.addButton.bind(this));const e={cache:JSON.parse(r.get("cdrCache","{}")),currentDate:new Date,elements:[[{size:"fill",value:"User"},{size:"fill",value:"When"}]]};e.currentYear=e.currentDate.getFullYear(),e.currentTime=e.currentDate.getTime(),this.checkUser(e,d.get("steamId"),{cdr:{a:d.get("cdr_a"),aDays:parseFloat(d.get("cdr_aDays")),b:d.get("cdr_b"),bDays:parseFloat(d.get("cdr_days")),d:d.get("cdr_d")},registrationDate:parseInt(d.get("registrationDate"))});for(const t in c.esgst.users.users){const s=c.esgst.users.users[t];t!==d.get("steamId")&&(s.cdr||s.registrationDate)&&this.checkUser(e,t,s)}if(e.elements.length>1){r.set("cdrCache",JSON.stringify(e.cache));const t=new lt({addScrollable:!0,icon:"fa-birthday-cake",isTemp:!0,title:"ESGST reminder about cake days:"});t.scrollable.appendChild(new Rs(e.elements).table),t.open(),await c.common.endless_load(t.scrollable)}}checkUser(e,t,s){if(!s.cdr||!s.registrationDate)return;const n=t===d.get("steamId")?"esgst-cdr-highlight":"",a=new Date(1e3*s.registrationDate);a.setFullYear(e.currentYear);const i=a.getTime(),o=parseInt(e.cache[t]&&e.cache[t].bYear||0),r=parseInt(e.cache[t]&&e.cache[t].dYear||0),l=parseInt(e.cache[t]&&e.cache[t].aYear||0);s.cdr.b&&o!==e.currentYear&&e.currentTime<i&&i-e.currentTime<=864e5*s.cdr.bDays?(e.cache[t]||(e.cache[t]={}),e.cache[t].bYear=e.currentYear,e.elements.push([{size:"fill",value:n?Se.element("span",{className:n},"YOU"):Se.element("a",{className:"table__column__secondary-link",href:"/user/"+s.username},s.username)},{size:"fill",value:Se.element("span",{className:n},`In ${Math.floor((i-e.currentTime)/864e5)} days`)}])):s.cdr.d&&r!==e.currentYear&&e.currentTime>=i&&e.currentTime<i+864e5?(e.cache[t]||(e.cache[t]={}),e.cache[t].dYear=e.currentYear,e.elements.push([{size:"fill",value:n?Se.element("span",{className:n},"YOU"):Se.element("a",{className:"table__column__secondary-link",href:"/user/"+s.username},s.username)},{size:"fill",value:Se.element("span",{className:n},"Today! Happy cake day!")}])):s.cdr.a&&l!==e.currentYear&&e.currentTime>=i+864e5&&e.currentTime-i<=864e5*s.cdr.aDays&&(e.cache[t]||(e.cache[t]={}),e.cache[t].aYear=e.currentYear,e.elements.push([{size:"fill",value:n?Se.element("span",{className:n},"YOU"):Se.element("a",{className:"table__column__secondary-link",href:"/user/"+s.username},s.username)},{size:"fill",value:Se.element("span",{className:n},Math.floor((e.currentTime-i)/864e5)+" days ago")}]))}addButton(e){if(e.steamId===d.get("steamId"))return;let t;Se.insert(e.heading,"beforeend",Se.element("a",{title:c.common.getFeatureTooltip("cdr",`Get notified about ${e.username}'s cake day`),ref:e=>t=e},Se.element("i",{className:"fa fa-gift"}))),t.addEventListener("click",async()=>{const t=new lt({addScrollable:!0,icon:"fa-gift",isTemp:!0,title:`Get notified about ${e.username}'s cake day:`}),s={id:e.id,steamId:e.steamId,username:e.username,values:{}},n=await c.common.getUser(c.esgst.users,s);n&&n.cdr?s.values.cdr=n.cdr:s.values.cdr={a:!1,aDays:0,b:!1,bDays:0,d:!0};const a=new vt(null,null,!1,Se.element("fragment",null,"Notify"," ",Se.element("input",{className:"esgst-switch-input",onchange:e=>s.values.cdr.bDays=parseFloat(e.currentTarget.value),type:"number",value:s.values.cdr.bDays})," ","days before their cake day."),!1,!1,null,s.values.cdr.b),i=new vt(null,null,!1,"Notify on their cake day.",!1,!1,null,s.values.cdr_d),o=new vt(null,null,!1,Se.element("fragment",null,"Notify"," ",Se.element("input",{className:"esgst-switch-input",onchange:e=>s.values.cdr.aDays=parseFloat(e.currentTarget.value),type:"number",value:s.values.cdr.aDays})," ","days after their cake day."),!1,!1,null,s.values.cdr.b);a.onChange=e=>s.values.cdr.b=e,i.onChange=e=>s.values.cdr.d=e,o.onChange=e=>s.values.cdr.a=e,t.scrollable.appendChild(a.container),t.scrollable.appendChild(i.container),t.scrollable.appendChild(o.container),tt.create([{template:"success",name:"Save",onClick:async()=>{s.values.cdr.b||s.values.cdr.d||s.values.cdr.a?s.values.registrationDate=e.registrationDate:s.values.cdr=null,await c.common.saveUser(null,null,s),t.close()}},{template:"loading",isDisabled:!0,name:"Saving..."}]).insert(t.description,"beforeend"),t.open()})}};const Os=new class extends gt{constructor(){super(),this.info={description:()=>Se.element("ul",null,Se.element("li",null,"Adds a button (",Se.element("i",{className:"fa fa-comments"})," ",Se.element("i",{className:"fa fa-ticket"})," ",Se.element("i",{className:"fa fa-question-circle"})," ) to the main page heading of any"," ",Se.element("a",{href:"https://www.steamgifts.com/giveaway/aeqw7/"},"giveaway")," page that allows you to view the list (including the number and percentage) of users that commented without entering, users that entered without commenting and users that commented & entered."),Se.element("li",null,"If the giveaway has a link to a discussion, the feature will also check for comments in the discussion.")),features:{cec_t:{name:"Open results in a new tab.",sg:!0}},id:"cec",name:"Comment/Entry Checker",sg:!0,sgPaths:/^Giveaway($|\s-\s.+?)$/,type:"giveaways"}}init(){this.esgst.customPages.cec={check:this.esgst.giveawayPath,load:async()=>await this.cec_openPopup({})},this.esgst.giveawayPath&&!document.getElementsByClassName("table--summary")[0]&&this.esgst.mainPageHeading&&Se.insert(this.esgst.sidebarGroups[0].navigation,"beforeend",Se.element("li",{className:"sidebar__navigation__item",id:"cec"},Se.element("a",{className:"sidebar__navigation__item__link",href:this.esgst.path.replace(/\/entries/,"")+"/entries?esgst=cec",onclick:e=>!d.get("cec_t")&&!e.preventDefault()&&this.cec_openPopup(!0)},Se.element("div",{className:"sidebar__navigation__item__name"},"Comments vs Entries"),Se.element("div",{className:"sidebar__navigation__item__underline"}))))}async cec_openPopup(e){let t=null,s=null;if(e){const e=new lt({addScrollable:"left",isTemp:!0});t=e.description,s=e.scrollable,e.open()}else t=s=this.esgst.sidebar.nextElementSibling,s.setAttribute("data-esgst-popup","true"),s.innerHTML="";e||hs.setSidebarActive("cec");const n=pt.create("cec",[{name:"ESGST",url:this.esgst.settingsUrl},{name:"Comment / Entry Checker",url:"?esgst=cec"}]).insert(t,"afterbegin").nodes.outer;e||(this.esgst.mainPageHeading=n);const a={context:s};a.progressBar=at.create().insert(s,"beforeend").hide(),this.cec_start(a)}async cec_start(e){e.isCanceled=!1,e.progressBar.setLoading(null).show();let t=[],s=[window.location.pathname.match(/\/giveaway\/.+?\//)[0]];for(let n=0;!e.isCanceled&&n<s.length;n++){let a=1,i=null,o=s[n];do{e.progressBar.setMessage(`Retrieving ${n>0?"bumps ":"comments "} (page ${a})...`);let r=await Ne.get(`${o}${a}`,{queue:!0}),l=r.html,c=l.querySelectorAll(".comment:not(.comment--submit) .comment__username:not(.comment__username--op):not(.comment__username--deleted)");for(let e=c.length-1;e>-1;e--)t.push(c[e].textContent.trim());if(1===a&&(o=s[n]=r.url+"/search?page="),a+=1,i=l.getElementsByClassName("pagination__navigation")[0],0===n){let e=l.querySelectorAll('.page__description [href*="/discussion/"]');for(let t=e.length-1;t>-1;t--)s.push(e[t].getAttribute("href").match(/\/discussion\/.+?\//)[0])}}while(!e.isCanceled&&i&&!i.lastElementChild.classList.contains("is-selected"))}if(e.isCanceled)return;let n=[],a=1,i=null,o=s[0].replace(/search\?page=/,"entries/search?page=");do{e.progressBar.setMessage(`Retrieving entries (page ${a})...`);let t=(await Ne.get(`${o}${a}`,{queue:!0})).html,s=t.getElementsByClassName("table__column__heading");for(let e=s.length-1;e>-1;e--)n.push(s[e].textContent.trim());a+=1,i=t.getElementsByClassName("pagination__navigation")[0]}while(!e.isCanceled&&i&&!i.lastElementChild.classList.contains("is-selected"));if(e.isCanceled)return;e.progressBar.reset().hide(),t=l.sortArray(Array.from(new Set(t))),n=l.sortArray(Array.from(new Set(n)));let r=0,c=0,d=0;const g=[];for(const e of t)n.indexOf(e)>-1?(g.push([{alignment:"left",size:"fill",value:Se.element("a",{className:"table__column__heading",href:"/user/"+e},e)},"Yes","-","-"]),r+=1):(g.push([{alignment:"left",size:"fill",value:Se.element("a",{className:"table__column__heading",href:"/user/"+e},e)},"-","Yes","-"]),c+=1);let u=t.length;for(const e of n)t.indexOf(e)<0&&(g.push([{alignment:"left",size:"fill",value:Se.element("a",{className:"table__column__heading",href:"/user/"+e},e)},"-","-","Yes"]),d+=1,u+=1);const m=new Rs([[{alignment:"left",size:"fill",value:"User"},`Commented and Entered (${r} - ${Math.round(r/u*1e4)/100}%)`,`Commented but did not Enter (${c} - ${Math.round(c/u*1e4)/100}%)`,`Entered but did not Comment (${d} - ${Math.round(d/u*1e4)/100}%)`],...g]);e.context.appendChild(m.table),await hs.endless_load(e.context)}cec_stop(e){e.progressBar.reset.hide(),e.isCanceled=!0}};class Us{constructor(e,t,s){return this.callbacks=s.callbacks,this.states=this.callbacks.length,this.icons=s.icons,this.id=s.id,this.index=s.index,this.titles=s.titles,Se.insert(e,t,Se.element("div",{className:s.className,ref:e=>this.button=e})),this.change(),this}async change(e,t=this.index,s){t>=this.states&&(t=0),this.index=t+1,this.button.title=c.common.getFeatureTooltip(this.id,this.titles[t]),Se.insert(this.button,"atinner",Se.element("i",{className:"fa "+this.icons[t]})),e?await e(s)?this.change():Se.insert(this.button,"atinner",Se.element("i",{className:"fa fa-times esgst-red",title:"Unable to perform action"})):this.callbacks[t]&&this.button.firstElementChild.addEventListener("click",this.change.bind(this,this.callbacks[t],void 0))}async triggerCallback(){await this.change(this.callbacks[this.index-1])}}const Fs=new class extends gt{constructor(){super(),this.info={description:()=>Se.element("ul",null,Se.element("li",null,"Adds a button (",Se.element("i",{className:"fa fa-lock"})," if the discussion is open and"," ",Se.element("i",{className:"fa fa-lock esgst-red"})," if it is closed) next to the title of a discussion created by yourself (in any"," ",Se.element("a",{href:"https://www.steamgifts.com/discussions"},"discussions")," page) that allows you to close/open the discussion without having to access it.")),id:"codb",name:"Close/Open Discussion Button",sg:!0,type:"discussions",featureMap:{discussion:this.codb_addButtons.bind(this)}}}codb_addButtons(e){for(const t of e)t.author!==d.get("username")||t.heading.parentElement.getElementsByClassName("esgst-codb-button")[0]||(t.closed&&(t.closed.remove(),t.closed=!0),new Us(t.headingContainer.firstElementChild,"beforebegin",{callbacks:[this.codb_close.bind(this,t),null,this.codb_open.bind(this,t),null],className:"esgst-codb-button",icons:["fa-lock esgst-clickable","fa-circle-o-notch fa-spin","fa-lock esgst-clickable esgst-red","fa-circle-o-notch fa-spin"],id:"codb",index:t.closed?2:0,titles:["Close discussion","Closing discussion...","Open discussion","Opening discussion..."]}))}async codb_close(e){return!!(await Ne.post(e.url,{data:`xsrf_token=${Be.xsrfToken}&do=close_discussion`})).html.getElementsByClassName("page__heading__button--red")[0]&&(e.closed=!0,e.innerWrap.classList.add("is-faded"),!0)}async codb_open(e){return!(await Ne.post(e.url,{data:`xsrf_token=${Be.xsrfToken}&do=reopen_discussion`})).html.getElementsByClassName("page__heading__button--red")[0]&&(e.closed=!1,e.innerWrap.classList.remove("is-faded"),!0)}};const $s=new class extends gt{constructor(){super(),this.info={description:()=>Se.element("ul",null,Se.element("li",null,"Reverses the comments of any"," ",Se.element("a",{href:"https://www.steamgifts.com/discussion/e9zDo/"},"discussion")," page so that they are ordered from newest to oldest.")),id:"cr",name:"Comment Reverser",sg:!0,st:!0,type:"comments"}}init(){if(!c.esgst.discussionPath||!c.esgst.pagination)return;const e=c.esgst.pagination.previousElementSibling;e.classList.contains("comments")&&c.common.reverseComments(e)}};class Ws{constructor(e){this.mainContext=null,this.mainPopup=e.mainPopup,this.popupDetails=e.popup,this.context=e.context,this.init=e.init,this.requests=e.requests,this.requestsBackup=this.requests,this.urls=e.urls,this.id=e.id,this.permissions=e.permissions,e.mainPopup||(e.button?this.button=e.button:this.button=c.common.createHeadingButton(e.headingButton),this.button.addEventListener("click",async()=>{if(this.permissions){const e=[];for(const t in this.permissions)this.permissions[t]()&&e.push(t);if(e.length&&!await ut.contains([e]))return}this.openPopup()}))}async openPopup(){this.popup?this.popup.open():(this.popupDetails.buttons=[[{color:"green",icons:["fa-arrow-circle-right"],name:"Start",onClick:this.start.bind(this)},{template:"error",name:"Stop",switchTo:{onReturn:0},onClick:this.stop.bind(this)}]],this.popup=new lt(this.popupDetails),this.urls&&this.urls.id&&!this.urls.lockPerLoad&&Se.insert(this.popup.description,"afterbegin",Se.element("fragment",null,"Items per load:"," ",Se.element("input",{className:"esgst-switch-input",type:"number",value:d.get(this.urls.id+"_perLoad"),ref:e=>c.common.observeNumChange(e,this.urls.id+"_perLoad",!0)}))),this.popup.open(),this.urls&&(this.index=0,this.items=[],await this.urls.init(this,...this.urls.arguments||[]),this.total=this.items.length,this.urls.doNotTrigger||this.popup.buttons[0].onClick(),d.get("es_"+this.urls.id)&&this.popup.scrollable.addEventListener("scroll",()=>{this.popup.scrollable.scrollTop+this.popup.scrollable.offsetHeight>=this.popup.scrollable.scrollHeight&&!this.popup.buttons[0].isBusy&&this.popup.buttons[0].onClick()})))}async start(){if(this.button&&this.button.classList.add("esgst-busy"),this.isCanceled=!1,!this.popup||this.urls&&!this.urls.doNotTrigger||this.popup.clear(),this.init&&await this.init(this))this.button&&this.button.classList.remove("esgst-busy");else{if(this.urls)await this.requestNextUrl(this.urls.request);else for(let e=0;!this.isCanceled&&e<this.requests.length;e++){const t=this.requests[e];"object"==typeof t?(await this.request(t),t.onDone&&await t.onDone(this,t)):await t(this)}this.button&&this.button.classList.remove("esgst-busy"),this.popup&&this.popup.progressBar.reset().hide()}}stop(){this.isCanceled=!0}async requestNextUrl(e){if(!this.urls.doNotTrigger&&this.index>=this.total)return void this.popup.buttons[0].destroy();this.popup.progressBar.setLoading("Loading more...").show(),this.popup.overallProgressBar.setMessage(`${this.index} of ${this.total} loaded.`).show(),this.mainContext?Se.insert(this.mainContext,"beforeend",this.context):this.context=this.popup.getScrollable(this.context);let t=0;for(;!this.isCanceled&&(t<(this.urls.lockPerLoad?this.urls.perLoad:d.get(this.urls.id+"_perLoad"))||d.get("es_"+this.urls.id)&&this.popup.scrollable.scrollHeight<=this.popup.scrollable.offsetHeight);){let s=this.items[this.index];if(!s)break;s=s.url||s;try{const n=await Ne.get(s,{queue:e.queue});await e.request(this,e,n,n.html),t+=1}catch(e){dt.error(e.message,e.stack)}this.index+=1,this.popup.overallProgressBar.setMessage(`${this.index} of ${this.total} loaded.`).show()}!this.urls.doNotTrigger&&this.index>=this.total&&this.popup.buttons[0].destroy(),this.urls.restart&&(this.index=0),await c.common.endless_load(this.context)}async request(e){e.nextPage||(e.nextPage=1);let t=e.nextPage;e.lastPage="";let s=null,n=!1;do{let a=await Ne.get(`${e.url}${e.nextPage}`,{queue:e.queue});e.nextPage===t&&(e.lastPage=c.esgst.modules.generalLastPageLink.lpl_getLastPage(a.html,!1,e.discussion,e.user,e.userWon,e.group,e.groupUsers,e.groupWishlist),e.lastPage=999999999===e.lastPage?"":" of "+e.lastPage),n=await e.request(this,e,a,a.html),e.nextPage+=1,s=a.html.getElementsByClassName("pagination__navigation")[0]}while(!n&&!this.isCanceled&&(!e.maxPage||e.nextPage<=e.maxPage)&&s&&!s.lastElementChild.classList.contains(c.esgst.selectedClass));e.nextPage=t}}const Vs=new class extends gt{constructor(){super(),this.info={description:()=>Se.element("ul",null,Se.element("li",null,"Adds a button (",Se.element("i",{className:"fa fa-comments"})," ",Se.element("i",{className:"fa fa-search"}),") to the main page heading of any page that allows you to search for comments made by specific users in the page.")),id:"cs",name:"Comment Searcher",sg:!0,st:!0,type:"comments"}}init(){!c.esgst.commentsPath||c.esgst.giveawayPath&&document.getElementsByClassName("table--summary")[0]||new Ws({headingButton:{id:"cs",icons:["fa-comments","fa-search"],title:"Search comments from specific users"},popup:{icon:"fa-comments",title:"Search comments from specific users:",textInputs:[{placeholder:"username1, username2, ..."}],options:[{check:!0,description:Se.element("fragment",null,"Limit search by pages, from"," ",Se.element("input",{className:"esgst-switch-input",min:"1",name:"cs_minPage",type:"number",value:d.get("cs_minPage")})," to ",Se.element("input",{className:"esgst-switch-input",min:"1",name:"cs_maxPage",type:"number",value:d.get("cs_maxPage")}),"."),id:"cs_limitPages",tooltip:"If unchecked, all pages will be searched."}],addProgress:!0,addScrollable:"left"},init:this.cs_init.bind(this),requests:[{source:c.esgst.discussionPath,url:c.esgst.searchUrl,request:this.cs_request.bind(this)}]})}cs_init(e){e.usernames=e.popup.getTextInputValue(0).toLowerCase().replace(/(,\s*)+/g,this.cs_format.bind(this)).split(", ");let t=window.location.pathname.match(/^\/(giveaway|discussion|support\/ticket|trade)\/(.+?)\//);e.code=t[2],e.type=t[1],e.title=c.esgst.originalTitle.replace(/\s-\sPage\s\d+/,""),e.results=0,d.get("cs_limitPages")&&(e.requests[0].nextPage=d.get("cs_minPage"),e.requests[0].maxPage=d.get("cs_maxPage"))}cs_format(e,t,s,n){return 0===s||s===n.length-e.length?"":", "}async cs_request(e,t,s,n){e.popup.progressBar.setLoading(`Searching comments (page ${t.nextPage}${t.maxPage?" of "+t.maxPage:t.lastPage})..`).show(),e.popup.overallProgressBar.setMessage(e.results+" results found.").show();let a=n.getElementsByClassName("comments"),i=(a[1]||a[0]).querySelectorAll(".comment:not(.comment--submit), .comment_outer"),o=e.popup.getScrollable();for(let s=0,n=i.length;s<n;s++){let n=i[s];c.esgst.sg&&(n.firstElementChild.classList.remove("comment__parent"),n.firstElementChild.classList.add("comment__child"));let a=n.parentElement.closest(".comment, .comment_outer");n=n.cloneNode(!0),n.lastElementChild.innerHTML="";const r=[];a?(a=a.cloneNode(!0),a.lastElementChild.remove(),Se.insert(a,"beforeend",Se.element("div",{className:"comment__children comment_children"},n)),r.push(a)):(c.esgst.st&&Se.insert(n.getElementsByClassName("action_list")[0].firstElementChild,"afterend",Se.element("a",{href:`/${e.type}/${e.code}/`},`${e.title} - Page ${t.nextPage}`)),c.esgst.sg&&r.push(Se.element("div",{className:"comments__entity"},Se.element("p",{className:"comments__entity__name"},Se.element("a",{href:`/${e.type}/${e.code}/`},`${e.title} - Page ${t.nextPage}`)))),r.push(Se.element("div",{className:"comment__children comment_children"},n))),e.usernames.indexOf(n.querySelector(".comment__username, .author_name").textContent.trim().toLowerCase())>-1&&(Se.insert(o,"beforeend",Se.element("div",{className:"comment comments comment_outer"},r)),e.results+=1)}e.popup.overallProgressBar.setMessage(e.results+" results found.").show(),await c.common.endless_load(o)}};const js=new class extends gt{constructor(){super(),this.info={description:()=>Se.element("ul",null,Se.element("li",null,"Keeps track of any comments (in any page) and fades out comments that you have marked as read so that you can easily see which comments you have read/unread in the page."),Se.element("li",null,"Comments made by yourself are automatically marked as read."),Se.element("li",null,"The comments are tracked by saving the date when they were made. If a comment is edited then the date when it was last edited is saved instead, so if you had previously marked a comment as read and that comment was edited, it will now appear as unread."),Se.element("li",null,'Adds a panel to the "Comments" column of any'," ",Se.element("a",{href:"https://www.steamgifts.com/discussions"},"discussions"),"/",Se.element("a",{href:"https://www.steamgifts.com/support/tickets"},"tickets"),"/",Se.element("a",{href:"https://www.steamtrades.com/trades"},"trades")," pages and to the main page heading of any page containing:"),Se.element("ul",null,Se.element("li",null,"A red number in parenthesis indicating how many unread comments there are in the thread."),Se.element("li",null,"A button (",Se.element("i",{className:"fa fa-comments"}),") that allows you to go to the first unread comment of the thread/page."),Se.element("li",null,"A button (",Se.element("i",{className:"fa fa-eye"}),") that allows you to mark every comment in the thread/page as read."),Se.element("li",null,"A button (",Se.element("i",{className:"fa fa-eye-slash"}),") that allows you to mark every comment in the thread/page as unread.")),Se.element("li",null,'Adds a panel next a comment\'s "Permalink" (in any page) containing:'),Se.element("ul",null,Se.element("li",null,"A button (",Se.element("i",{className:"fa fa-eye"}),") that allows you to mark the comment as read."),Se.element("li",null,"A button (",Se.element("i",{className:"fa fa-eye-slash"}),") that allows you to mark the comment as unread."),Se.element("li",null,"A button (",Se.element("i",{className:"fa fa-eye"})," ",Se.element("i",{className:"fa fa-angle-double-right"}),") that allows you to mark the comment as read and go to the next unread comment."),Se.element("li",null,"A button (",Se.element("i",{className:"fa fa-eye"})," ",Se.element("i",{className:"fa fa-angle-up"}),") that allows you to mark every comment from the comment upward as read."),Se.element("li",null,"A button (",Se.element("i",{className:"fa fa-eye-slash"})," ",Se.element("i",{className:"fa fa-angle-up"}),") that allows you to mark every comment from the comment upward as unread."))),features:{ct_a:{name:'Automatically mark comments as read in the inbox page when clicking on the "Mark as Read" button.',sg:!0,st:!0},ct_o:{name:"Automatically mark your own comments as read.",sg:!0,st:!0},ct_c:{name:"Enable tracking controls for your own comments.",sg:!0,st:!0},ct_s:{description:()=>Se.element("ul",null,Se.element("li",null,"The simplified version of the tracker does not have the concept of read/unread comments, but simply shows the red number of comments that were made since you last visited a thread, so the comments are not tracked by date (they are tracked by quantity) and there are no buttons to go to the first unread comment of a thread/page or mark comments as read/unread."),Se.element("li",null,"If you mark a thread as visited with ",Se.element("span",{"data-esgst-feature-id":"gdttt"}),', all of the comments in the thread will be considered as "read", and if you mark it as unvisited, they will be considered as "unread".')),features:{ct_s_h:{description:()=>Se.element("ul",null,Se.element("li",null,"Only shows the red number for a thread after you have visited it.")),name:"Hide the counter if you have not visited the thread yet.",sg:!0,st:!0}},name:"Enable the simplified version.",sg:!0,st:!0},ct_fop:{name:"Fade out read OPs.",sg:!0,st:!0},ct_f:{name:"Fade out read comments.",sg:!0,st:!0},ct_r:{description:()=>Se.element("ul",null,Se.element("li",null,"Searches pages for an unread comment from the bottom to the top if"," ",Se.element("span",{"data-esgst-feature-id":"cr"})," is disabled or from the top to the bottom if it is enabled.")),name:"Search for the first unread comment in reverse order.",sg:!0,st:!0}},id:"ct",name:"Comment Tracker",sg:!0,st:!0,type:"comments"}}async init(){if((this.esgst.commentsPath&&(!this.esgst.giveawayPath||!document.getElementsByClassName("table--summary")[0])||c.common.isCurrentPath("Messages"))&&!d.get("ct_s")){if(!d.get("ct_s")){let e=c.common.createHeadingButton({featureId:"ct",id:"ctUnread",icons:["fa-eye-slash"],title:"Mark all comments in this page as unread"}),t=c.common.createHeadingButton({featureId:"ct",id:"ctRead",icons:["fa-eye"],title:"Mark all comments in this page as read"}),s=c.common.createHeadingButton({featureId:"ct",id:"ctGo",icons:["fa-comments-o"],title:"Go to the first unread comment of this page"});this.ct_addCommentPanel(s,t,e)}let e=window.location.pathname.match(/\/(giveaway|discussion|ticket|trade)\/(.+?)\//);if(e){let t,s,n,a,i,o;if(i=this.esgst.mainPageHeading.querySelector(".page__heading__breadcrumbs, .page_heading_breadcrumbs").firstElementChild,o=e[1]+"s",t=e[2],a=JSON.parse(c.common.getValue(o)),s=parseInt(i.textContent.replace(/,/g,"").match(/\d+/)[0]),a[t]){let e,i;if(d.get("ct_s"))i=a[t].count||(d.get("ct_s_h")?s:0);else for(e in i=0,a[t].readComments)a[t].readComments.hasOwnProperty(e)&&!e.match(/^(Count|undefined|)$/)&&a[t].readComments[e]&&++i;n=s===i?0:s-i}else n=d.get("ct_s")&&d.get("ct_s_h")?0:s;Se.insert(i,"beforeend",Se.element("span",{className:"esgst-ct-count",title:c.common.getFeatureTooltip("ct","Unread comments")},` (+${n})`))}}}async ct_addDiscussionPanels(e,t,s,n){let a,i,o,r,l,g,u,m,h,p,f,b,w,y,v,_;if(f=e.querySelectorAll(`${n?`.esgst-es-page-${n} .table__row-outer-wrap, .esgst-es-page-${n}.table__row-outer-wrap`:".table__row-outer-wrap"}, ${n?`.esgst-es-page-${n} .row_outer_wrap, .esgst-es-page-${n}.row_outer_wrap`:".row_outer_wrap"}`),f.length){for(_=this.esgst.discussionsPath?"discussions":this.esgst.ticketsPath?"tickets":this.esgst.tradesPath?"trades":"discussions",i=JSON.parse(c.common.getValue(_,"{}")),u=0,b=f.length;u<b;++u)if(p=f[u],r=p.querySelector('.table__column__secondary-link[href*="/discussion/"], .table__column--width-small.text-center, .row_trade_comments'),r){if(o=parseInt(r.textContent.replace(/,/g,"")),g=p.querySelector(".homepage_table_column_heading, .table__column__heading, .row_trade_name h2 a"),!g)continue;if(w=g.textContent.trim(),v=g.getAttribute("href"),v&&(a=v.match(new RegExp(`/${_.slice(0,-1)}/(.+?)(/.*)?$`)),a&&(a=a[1],d.get("gdttt")||d.get("ct")))){if(i[a]){if(d.get("ct_s"))y=i[a].count||(d.get("ct_s_h")?o:0);else for(m in y=0,i[a].readComments)i[a].readComments.hasOwnProperty(m)&&!m.match(/^(Count|undefined|)$/)&&i[a].readComments[m]&&++y;l=o===y?0:o-y}else l=d.get("ct_s")&&d.get("ct_s_h")?0:o;let e=null;const t=rt.findData("main","discussions");for(h=t.length-1;h>-1&&t[h].code!==a;--h);h>-1&&(e=t[h]),"discussions"===_&&l>0&&e&&(e.unread=!0),this.ct_addDiscussionPanel(a,i,p,r,o,l,v,_,e,w)}}t&&c.esgst.df&&this.esgst.df.filteredCount&&d.get("df_enable"+this.esgst.df.type)&&this.esgst.modules.discussionsDiscussionFilters.filters_filter(this.esgst.df,!1,n)}}async ct_getComments(e,t,s,n,a,i,o){let r=!1;if(n)r=await this.ct_checkComments(e,t,s,!0,!1,!1,o);else{let n;o||(n=new Te("comment",{threshold:300}),await n.lock()),r=await this.ct_checkComments(e,t,s,!1,a,i,o),n&&await n.unlock()}return r}async ct_checkComments(e,t,s,n,a,i,o){let l,g,u,m,h,p,f,b,w,y;if(this.ctGoToUnread=!1,o?p=this.esgst.sg?{giveaways:this.esgst.giveaways,discussions:this.esgst.discussions,tickets:this.esgst.tickets}:{trades:this.esgst.trades}:(y=c.common.getValues({giveaways:"{}",discussions:"{}",tickets:"{}",trades:"{}"}),p=this.esgst.sg?{giveaways:JSON.parse(y.giveaways),discussions:JSON.parse(y.discussions),tickets:JSON.parse(y.tickets)}:{trades:JSON.parse(y.trades)}),h=t.length,u=!1,h>0){for(m=s||0;m<h;++m)if(g=t[m],g.id||g.id.match(/^$/)){if(p[g.type][g.code]?p[g.type][g.code].readComments||(p[g.type][g.code].readComments={}):p[g.type][g.code]={readComments:{}},e>0&&(p[g.type][g.code].count=e),d.get("gdttt")&&d.get("gdttt_v"+{giveaways:"g",discussions:"d",tickets:"t",trades:"ts"}[g.type])){p[g.type][g.code].visited=!0;let e=JSON.parse(r.get("gdtttCache",'{"giveaways":[],"discussions":[],"tickets":[],"trades":[]}'));e[g.type].indexOf(g.code)<0&&(e[g.type].push(g.code),r.set("gdtttCache",JSON.stringify(e)))}if(p[g.type][g.code].lastUsed=Date.now(),!d.get("ct_s")){let e=g.comment.getElementsByClassName("esgst-ct-comment-button");if(g.author===d.get("username"))d.get("ct_c")&&(p[g.type][g.code].readComments[g.id]&&g.timestamp===p[g.type][g.code].readComments[g.id]?i?(this.ct_markCommentUnread(g,p),this.ct_addReadCommentButton(e[0],g)):(this.ct_markCommentRead(g,p),this.ct_addUnreadCommentButton(e[0],g)):a?(this.ct_markCommentRead(g,p),this.ct_addUnreadCommentButton(e[0],g)):(this.ct_markCommentUnread(g,p),this.ct_addReadCommentButton(e[0],g)),this.ct_addReadUntilHereButton(e[1],g),this.ct_addUnreadUntilHereButton(e[2],g)),d.get("ct_o")&&(this.ct_markCommentRead(g,p),d.get("ct_c")&&this.ct_addUnreadCommentButton(e[0],g));else if(p[g.type][g.code].readComments[g.id]&&g.timestamp===p[g.type][g.code].readComments[g.id])i?(this.ct_markCommentUnread(g,p),this.ct_addReadCommentButton(e[0],g)):(this.ct_markCommentRead(g,p),this.ct_addUnreadCommentButton(e[0],g)),this.ct_addReadUntilHereButton(e[1],g),this.ct_addUnreadUntilHereButton(e[2],g);else if(n&&(!this.ctGoToUnread||(d.get("ct_r")&&!d.get("cr")||!d.get("ct_r")&&d.get("cr"))&&g.comment.offsetTop<window.scrollY+this.esgst.commentsTop||(!d.get("ct_r")&&!d.get("cr")||d.get("ct_r")&&d.get("cr"))&&g.comment.offsetTop>window.scrollY+this.esgst.commentsTop)){if(this.ctGoToUnread=!0,!(this.esgst.discussionPath&&(!d.get("ct_r")&&!d.get("cr")||d.get("ct_r")&&d.get("cr"))||!this.esgst.discussionPath&&!d.get("ct_r"))){this.esgst.discussionPath?c.common.goToComment(g.id,g.comment):(this.ctUnreadFound=!0,!this.ctNewTab&&d.get("sto")?g.id?window.location.href="/go/comment/"+g.id:window.location.href=`/discussion/${g.code}/`:g.id?yt.open("https://www.steamtrades.com/go/comment/"+g.id):yt.open(`https://www.steamgifts.com/discussion/${g.code}/`)),u=!0;break}w=g,u=!0}else a?(this.ct_markCommentRead(g,p),this.ct_addUnreadCommentButton(e[0],g)):(this.ct_markCommentUnread(g,p),this.ct_addReadCommentButton(e[0],g)),this.ct_addReadUntilHereButton(e[1],g),this.ct_addUnreadUntilHereButton(e[2],g)}}!d.get("ct_s")&&n?w&&(this.esgst.discussionPath?c.common.goToComment(w.id,w.comment):(this.ctUnreadFound=!0,!this.ctNewTab&&d.get("sto")?w.id?window.location.href="/go/comment/"+w.id:window.location.href=`/discussion/${w.code}/`:w.id?yt.open("https://www.steamtrades.com/go/comment/"+w.id):yt.open(`https://www.steamgifts.com/discussion/${w.code}/`))):this.esgst.sg?await Promise.all([c.common.lock_and_save_giveaways(p.giveaways),c.common.lockAndSaveDiscussions(p.discussions),c.common.lockAndSaveTickets(p.tickets)]):await c.common.lockAndSaveTrades(p.trades)}else f=window.location.pathname.match(/(giveaway|discussion|trade|ticket)\/(.+?)(\/.*)?$/),f&&(b=f[1]+"s",l=f[2],p[b][l]||(p[b][l]={readComments:{},visited:!0}),e>0&&(p[b][l].count=e),p[b][l].lastUsed=Date.now(),await c.common["lock_and_save_"+b]({[l]:p[b][l]}));return u}async ct_markCommentRead(e,t,s){let n;if(s){const s=new Te("comment",{threshold:300});await s.lock(),t=JSON.parse(c.common.getValue(e.type)),e.id&&!t[e.code].readComments[e.id]&&this.esgst.commentsPath&&(n=document.getElementsByClassName("esgst-ct-count")[0],n.textContent=` (+${parseInt(n.textContent.match(/\d+/)[0])-1})`),t[e.code].readComments[e.id]=e.timestamp,await c.common.setValue(e.type,JSON.stringify(t)),await s.unlock(),(e.isOp&&d.get("ct_fop")||!e.isOp&&d.get("ct_f"))&&e.comment.classList.add("esgst-ct-comment-read")}else t&&(e.id&&!t[e.type][e.code].readComments[e.id]&&this.esgst.commentsPath&&(n=document.getElementsByClassName("esgst-ct-count")[0],n.textContent=` (+${parseInt(n.textContent.match(/\d+/)[0])-1})`),t[e.type][e.code].readComments[e.id]=e.timestamp),(e.isOp&&d.get("ct_fop")||!e.isOp&&d.get("ct_f"))&&e.comment.classList.add("esgst-ct-comment-read")}async ct_markCommentUnread(e,t,s){let n;if(s){const s=new Te("comment",{threshold:300});await s.lock(),(t=JSON.parse(c.common.getValue(e.type)))[e.code].readComments[e.id]&&(delete t[e.code].readComments[e.id],e.id&&this.esgst.commentsPath&&(n=document.getElementsByClassName("esgst-ct-count")[0],n.textContent=` (+${parseInt(n.textContent.match(/\d+/)[0])+1})`)),await c.common.setValue(e.type,JSON.stringify(t)),await s.unlock(),(e.isOp&&d.get("ct_fop")||!e.isOp&&d.get("ct_f"))&&e.comment.classList.remove("esgst-ct-comment-read")}else t&&t[e.type][e.code].readComments[e.id]&&(e.id&&this.esgst.commentsPath&&(n=document.getElementsByClassName("esgst-ct-count")[0],n.textContent=` (+${parseInt(n.textContent.match(/\d+/)[0])+1})`),delete t[e.type][e.code].readComments[e.id]),(e.isOp&&d.get("ct_fop")||!e.isOp&&d.get("ct_f"))&&e.comment.classList.remove("esgst-ct-comment-read")}ct_addReadUntilHereButton(e,t){e||Se.insert(t.actions,"beforeend",Se.element("div",{className:"esgst-ct-comment-button",title:c.common.getFeatureTooltip("ct","Mark all comments from this comment upwards as read"),ref:t=>e=t})),Se.insert(e,"atinner",Se.element("span",null,Se.element("i",{className:"fa fa-eye"}),Se.element("i",{className:"fa fa-angle-up"}))),e.firstElementChild.addEventListener("click",this.ct_readUntilHere.bind(this,e,t))}async ct_readUntilHere(e,t){Se.insert(e,"atinner",Se.element("i",{className:"fa fa-circle-o-notch fa-spin"})),await this.ct_getComments(0,rt.findData("main","comments"),t.index,!1,!0,!1),this.ct_addReadUntilHereButton(e,t)}ct_addUnreadUntilHereButton(e,t){e||Se.insert(t.actions,"beforeend",Se.element("div",{className:"esgst-ct-comment-button",title:c.common.getFeatureTooltip("ct","Mark all comments from this comment upwards as unread"),ref:t=>e=t})),Se.insert(e,"atinner",Se.element("span",null,Se.element("i",{className:"fa fa-eye-slash"}),Se.element("i",{className:"fa fa-angle-up"}))),e.firstElementChild.addEventListener("click",this.ct_unreadUntilHere.bind(this,e,t))}async ct_unreadUntilHere(e,t){Se.insert(e,"atinner",Se.element("i",{className:"fa fa-circle-o-notch fa-spin"})),await this.ct_getComments(0,rt.findData("main","comments"),t.index,!1,!1,!0),this.ct_addUnreadUntilHereButton(e,t)}ct_addReadCommentButton(e,t){e||Se.insert(t.actions,"beforeend",Se.element("div",{className:"esgst-ct-comment-button",ref:t=>e=t})),Se.insert(e,"atinner",Se.element("fragment",null,Se.element("i",{className:"fa fa-eye",title:c.common.getFeatureTooltip("ct","Mark this comment as read")}),Se.element("span",{title:c.common.getFeatureTooltip("ct","Mark this comment as read and go to the next unread comment")},Se.element("i",{className:"fa fa-eye"}),Se.element("i",{className:"fa fa-angle-double-right"})))),e.firstElementChild.addEventListener("click",this.ct_readComment.bind(this,e,t)),e.lastElementChild.addEventListener("click",this.ct_readCommentAndGo.bind(this,e,t))}async ct_readComment(e,t){Se.insert(e,"atinner",Se.element("i",{className:"fa fa-circle-o-notch fa-spin"})),await this.ct_markCommentRead(t,null,!0),e.innerHTML="",this.ct_addUnreadCommentButton(e,t)}async ct_readCommentAndGo(e,t){Se.insert(e,"atinner",Se.element("i",{className:"fa fa-circle-o-notch fa-spin"})),await this.ct_markCommentRead(t,null,!0),e.innerHTML="",this.ct_addUnreadCommentButton(e,t),this.ct_getComments(0,rt.findData("main","comments"),null,!0)}ct_addUnreadCommentButton(e,t){e||Se.insert(t.actions,"beforeend",Se.element("div",{className:"esgst-ct-comment-button",ref:t=>e=t})),Se.insert(e,"atinner",Se.element("i",{className:"fa fa-eye-slash",title:c.common.getFeatureTooltip("ct","Mark comment as unread")})),e.firstElementChild.addEventListener("click",this.ct_unreadComment.bind(this,e,t))}async ct_unreadComment(e,t){Se.insert(e,"atinner",Se.element("i",{className:"fa fa-circle-o-notch fa-spin"})),await this.ct_markCommentUnread(t,null,!0),e.innerHTML="",this.ct_addReadCommentButton(e,t)}ct_addCommentPanel(e,t,s){let n,a,i,o;e.addEventListener("click",this.ct_goToUnread.bind(this,e)),t.addEventListener("click",this.ct_markCommentsRead.bind(this,t)),s.addEventListener("click",this.ct_markCommentsUnread.bind(this,s)),d.get("ct_a")&&c.common.isCurrentPath("Messages")&&(n=document.querySelector(".js__submit-form, .js_mark_as_read"),n&&(this.esgst.sg?(Se.insert(n,"afterend",Se.element("div",{className:"sidebar__action-button",ref:e=>i=e},Se.element("i",{className:"fa fa-check-circle"})," Mark as Read")),a="read_messages",o="/messages"):(Se.insert(n,"afterend",Se.element("a",{className:"page_heading_btn green",ref:e=>i=e},Se.element("i",{className:"fa fa-check-square-o"})," Mark as Read")),a="mark_as_read",o="/ajax.php"),n.remove(),i.addEventListener("click",this.ct_markMessagesRead.bind(this,a,t,o))))}async ct_markMessagesRead(e,t,s,n){await Ne.post(s,{data:`xsrf_token=${Be.xsrfToken}&do=${e}`}),await this.ct_markCommentsRead(t),this.ct_completeInboxRead(n.currentTarget)}ct_completeInboxRead(e){let t,s,n;for(t=document.querySelectorAll(".comment__envelope, .comment_unread"),s=0,n=t.length;s<n;++s)t[s].remove();e.remove()}async ct_goToUnread(e){Se.insert(e,"atinner",Se.element("i",{className:"fa fa-circle-o-notch fa-spin"}));const t=await this.ct_getComments(0,rt.findData("main","comments"),null,!0,!1,!1);Se.insert(e,"atinner",Se.element("i",{className:"fa fa-comments-o"})),t||c.common.createAlert("No unread comments were found.")}async ct_markCommentsRead(e){Se.insert(e,"atinner",Se.element("i",{className:"fa fa-circle-o-notch fa-spin"})),await this.ct_getComments(0,rt.findData("main","comments"),null,!1,!0,!1),Se.insert(e,"atinner",Se.element("i",{className:"fa fa-eye"}))}async ct_markCommentsUnread(e){Se.insert(e,"atinner",Se.element("i",{className:"fa fa-circle-o-notch fa-spin"})),await this.ct_getComments(0,rt.findData("main","comments"),null,!1,!1,!0),Se.insert(e,"atinner",Se.element("i",{className:"fa fa-eye-slash"}))}ct_addDiscussionPanel(e,t,s,n,a,i,o,r,l,g){if(n.querySelector(".esgst-ct-count"))return;let u;Se.insert(n,!this.esgst.giveawaysPath&&!this.esgst.commentsPath||d.get("oadd")?"beforeend":"afterend",Se.element("span",{ref:e=>u=e},Se.element("span",{className:"esgst-ct-count esgst-hidden",title:c.common.getFeatureTooltip("ct")},`(+${i})`),Se.element("div",{className:"esgst-heading-button esgst-hidden",title:c.common.getFeatureTooltip("ct","Go to first unread comment of this discussion")},Se.element("i",{className:"fa fa-comments-o"})),Se.element("div",{className:"esgst-heading-button esgst-hidden",title:c.common.getFeatureTooltip("ct","Mark all comments in this discussion as read")},Se.element("i",{className:"fa fa-eye"})),Se.element("div",{className:"esgst-heading-button esgst-hidden",title:c.common.getFeatureTooltip("ct","Mark all comments in this discussion as unread")},Se.element("i",{className:"fa fa-eye-slash"})),Se.element("div",{className:"esgst-heading-button esgst-hidden",title:c.common.getFeatureTooltip("ct","Clean discussion (remove deleted comments from the database)")},Se.element("i",{className:"fa fa-paint-brush"})),Se.element("i",{className:"fa fa-circle-o-notch fa-spin esgst-hidden"})));const m={code:e,count:a,diff:i,panel:u,url:o};if(m.diffContainer=m.panel.firstElementChild,m.goToUnread=m.diffContainer.nextElementSibling,m.markRead=m.goToUnread.nextElementSibling,m.markUnread=m.markRead.nextElementSibling,m.clean=m.markUnread.nextElementSibling,m.loadingIcon=m.clean.nextElementSibling,d.get("gdttt")){const n=new Us(m.panel,"beforeend",{callbacks:[this.esgst.modules.generalGiveawayDiscussionTicketTradeTracker.gdttt_markVisited.bind(this.esgst.modules.generalGiveawayDiscussionTicketTradeTracker,e,s,a,m.diffContainer,r),null,this.esgst.modules.generalGiveawayDiscussionTicketTradeTracker.gdttt_markUnvisited.bind(this.esgst.modules.generalGiveawayDiscussionTicketTradeTracker,e,s,a,m.diffContainer,r),null],className:"esgst-gdttt-button",icons:["fa-check esgst-clickable","fa-circle-o-notch fa-spin","fa-times esgst-clickable","fa-circle-o-notch fa-spin"],id:"gdttt",index:t[e]&&t[e].visited?2:0,titles:["Mark discussion as visited","Marking...","Mark discussion as unvisited","Marking..."]});l&&(l.gdtttButton=n,l.count=a)}d.get("tds")&&new Us(m.panel,"beforeend",{callbacks:[c.esgst.modules.generalThreadSubscription.subscribe.bind(c.esgst.modules.generalThreadSubscription,e,a,g,r),null,c.esgst.modules.generalThreadSubscription.unsubscribe.bind(c.esgst.modules.generalThreadSubscription,e,r),null],className:"esgst-tds-button",icons:["fa-bell-o esgst-clickable","fa-circle-o-notch fa-spin","fa-bell esgst-clickable","fa-circle-o-notch fa-spin"],id:"tds",index:t[e]&&void 0!==t[e].subscribed?2:0,titles:["Subscribe","Subscribing...","Unsubscribe","Unsubscribing..."]}),d.get("ct")&&(this.esgst.giveawaysPath||this.esgst.discussionsPath||this.esgst.commentsPath||this.esgst.tradesPath)&&(d.get("ct_s")?i>0&&m.diffContainer.classList.remove("esgst-hidden"):(i>0?(m.diffContainer.classList.remove("esgst-hidden"),m.goToUnread.classList.remove("esgst-hidden"),m.markRead.classList.remove("esgst-hidden"),i!==a&&m.markUnread.classList.remove("esgst-hidden")):m.markUnread.classList.remove("esgst-hidden"),m.clean.classList.remove("esgst-hidden"))),m.goToUnread.addEventListener("mousedown",this.ct_goToUnreadPanel.bind(this,m)),m.markRead.addEventListener("click",this.ct_markReadPanel.bind(this,m)),m.markUnread.addEventListener("click",this.ct_markUnreadPanel.bind(this,m)),m.clean.addEventListener("click",this.ct_clean.bind(this,m))}async ct_clean(e){e.clean.classList.add("esgst-hidden"),e.goToUnread.classList.add("esgst-hidden"),e.markRead.classList.add("esgst-hidden"),e.markUnread.classList.add("esgst-hidden"),e.loadingIcon.classList.remove("esgst-hidden"),await this.ct_markCommentsReadUnread(!1,!1,!1,e.code,e.url+"/search?page="),e.loadingIcon.classList.add("esgst-hidden"),e.goToUnread.classList.remove("esgst-hidden"),e.markRead.classList.remove("esgst-hidden"),e.clean.classList.remove("esgst-hidden"),e.diff!==e.count&&e.markUnread.classList.remove("esgst-hidden")}async ct_goToUnreadPanel(e,t){if(this.ctNewTab=!1,1===t.button)t.preventDefault(),this.ctNewTab=!0;else if(2===t.button)return;e.clean.classList.add("esgst-hidden"),e.goToUnread.classList.add("esgst-hidden"),e.markRead.classList.add("esgst-hidden"),e.markUnread.classList.add("esgst-hidden"),e.loadingIcon.classList.remove("esgst-hidden"),this.ctUnreadFound=!1,await this.ct_markCommentsReadUnread(!0,!1,!1,null,e.url+"/search?page="),e.loadingIcon.classList.add("esgst-hidden"),e.goToUnread.classList.remove("esgst-hidden"),e.markRead.classList.remove("esgst-hidden"),e.clean.classList.remove("esgst-hidden"),e.diff!==e.count&&e.markUnread.classList.remove("esgst-hidden")}async ct_markReadPanel(e){e.clean.classList.add("esgst-hidden"),e.goToUnread.classList.add("esgst-hidden"),e.markRead.classList.add("esgst-hidden"),e.markUnread.classList.add("esgst-hidden"),e.loadingIcon.classList.remove("esgst-hidden"),await this.ct_markCommentsReadUnread(!1,!0,!1,null,e.url+"/search?page="),e.loadingIcon.classList.add("esgst-hidden"),e.diffContainer.classList.add("esgst-hidden"),e.markUnread.classList.remove("esgst-hidden"),e.clean.classList.remove("esgst-hidden")}async ct_markUnreadPanel(e){e.clean.classList.add("esgst-hidden"),e.goToUnread.classList.add("esgst-hidden"),e.markRead.classList.add("esgst-hidden"),e.markUnread.classList.add("esgst-hidden"),e.loadingIcon.classList.remove("esgst-hidden");const t=new Te("comment",{threshold:300});await t.lock();const s=JSON.parse(c.common.getValue("discussions"));for(const t in s[e.code].readComments)s[e.code].readComments.hasOwnProperty(t)&&delete s[e.code].readComments[t];s[e.code].lastUsed=Date.now(),await c.common.setValue("discussions",JSON.stringify(s)),await t.unlock(),e.loadingIcon.classList.add("esgst-hidden"),e.diffContainer.classList.remove("esgst-hidden"),e.diffContainer.textContent=`(+${e.count})`,e.goToUnread.classList.remove("esgst-hidden"),e.markRead.classList.remove("esgst-hidden"),e.clean.classList.remove("esgst-hidden")}async ct_markCommentsReadUnread(e,t,s,n,a){let i=!0,o=!1,r=1,l=[],g=null;if(!n||(g=JSON.parse(c.common.getValue("discussions"))[n],g&&g.readComments)){for(;;){const c=(await Ne.get(`${a}${r}`,{queue:!0})).html;if(n){const e=c.querySelectorAll('[href*="/go/comment/"]');for(const t of e)l.push(t.getAttribute("href").match(/\/go\/comment\/(.+)/)[1])}else await this.ct_getComments(0,await this.esgst.modules.comments.comments_get(c,c,!0),null,e,t,s);if(e&&this.ctUnreadFound)break;r+=1;const g=c.getElementsByClassName("pagination__navigation")[0];if(!g||(!e||(!d.get("ct_r")||r<=1)&&(d.get("ct_r")||g.lastElementChild.classList.contains("is-selected")))&&(e||g.lastElementChild.classList.contains("is-selected")))break;if(e&&d.get("ct_r")){if(i){i=!i;const e=g.lastElementChild;e.textContent.match(/Last/)?r=parseInt(e.getAttribute("data-page-number")):(r=999999999,o=!0)}else o?r=parseInt(g.lastElementChild.getAttribute("data-page-number"))-1:r-=2;if(r<=1)break}}if(n){for(const e in g.readComments)g.readComments.hasOwnProperty(e)&&e&&l.indexOf(e)<0&&delete g.readComments[e];await c.common.lockAndSaveDiscussions({[n]:g})}}}},Hs=hs.createElements.bind(hs);const Js=new class extends gt{constructor(){super(),this.info={description:()=>Se.element("ul",null,Se.element("li",null,'Turns the numbers in the "Giveaways" column of any'," ",Se.element("a",{href:"https://www.steamgifts.com/giveaways/wishlist"},"community wishlist")," page into links that allow you to search for all of the active giveaways for the game (that are visible to you).")),id:"cwsl",name:"Community Wishlist Search Link",sg:!0,type:"giveaways"}}init(){this.esgst.wishlistPath&&this.esgst.gameFeatures.push(this.cwsl_getGames.bind(this))}cwsl_getGames(e,t){if(t)for(const t of e.all){let e=t.heading.parentElement.nextElementSibling.nextElementSibling;Hs(e,"atinner",[{attributes:{class:"table__column__secondary-link",href:`/giveaways/search?${t.type.slice(0,-1)}=${t.id}`},type:"a",children:[...Array.from(e.childNodes).map(e=>({context:e}))]}])}}};const Ys=new class extends gt{constructor(){super(),this.info={description:()=>Se.element("ul",null,Se.element("li",null,"Replaces the native ",Se.element("i",{className:"fa fa-bookmark"})," button if the discussion is bookmarked and adds a ",Se.element("i",{className:"fa fa-bookmark-o"})," button if it is not, next to a discussion's title (in any page) that allows you to add / remove the discussion to / from SteamGifts' native bookmark list."),Se.element("li",null,"Bookmarked discussions have a green background.")),features:{idb_t:{name:"Pin any bookmarked discussions in the page.",sg:!0}},id:"idb",name:"Improved Discussion Bookmarks",sg:!0,type:"discussions"}}init(){const e={};for(const t in c.esgst.discussions){c.esgst.discussions[t].highlighted&&(e[t]={highlighted:null})}const t=Object.keys(e).length;if(t>0){const s=new lt({addProgress:!0,icon:"fa-exchange",isTemp:!0,title:"Discussion Highlighter has been renamed to Improved Discussion Bookmarks because the ability to bookmark discussions has been added to SteamGifts, so ESGST no longer handles the data. Do you want to transfer the discussions you had previously highlighted to the SteamGifts bookmark list or do you want to delete them from your data?",buttons:[[{template:"success",name:"Transfer",onClick:async()=>{let n=1;for(const a in e)await this.bookmarkDiscussion(a),s.progressBar.setLoading(`${n++} of ${t} discussions transferred...`).show();await c.common.lockAndSaveDiscussions(e),s.close()}},{template:"loading",isDisabled:!0,name:"Transfering..."}],[{template:"error",name:"Delete",onClick:async()=>{await c.common.lockAndSaveDiscussions(e),s.close()}},{template:"loading",isDisabled:!0,name:"Deleting..."}]]});s.open()}c.esgst.discussionFeatures.push(this.addButtons.bind(this))}async addButtons(e,t){for(const s of e){if(s.idbButton)continue;const e=s.outerWrap;let n=0;s.bookmarked&&(await this.bookmarkDiscussion(null,e),d.get("idb_t")&&t&&c.esgst.discussionsPath&&(s.outerWrap.parentElement.insertBefore(s.outerWrap,s.outerWrap.parentElement.firstElementChild),s.isPinned=!0),n=2);let a=!1;s.bookmarkNode&&(a=s.bookmarkNode.classList.contains("icon-navy"),s.bookmarkNode.remove()),s.idbButton=new Us(s.heading.parentElement,"afterbegin",{callbacks:[this.bookmarkDiscussion.bind(this,s.code,e),null,this.unbookmarkDiscussion.bind(this,s.code,e),null],className:"esgst-idb-button",icons:["fa-bookmark-o esgst-clickable","fa-circle-o-notch fa-spin","fa-bookmark esgst-clickable "+(a?"icon-navy":""),"fa-circle-o-notch fa-spin"],id:"idb",index:n,titles:["Click to bookmark this discussion","Bookmarking discussion...","Click to unbookmark this discussion","Unbookmarking discussion..."]})}}async bookmarkDiscussion(e,t){return e&&await Ne.post(`/discussion/${e}/`,{data:`xsrf_token=${Be.xsrfToken}&do=bookmark_insert`}),t&&t.classList.add("esgst-idb-highlight"),!0}async unbookmarkDiscussion(e,t){return e&&await Ne.post(`/discussion/${e}/`,{data:`xsrf_token=${Be.xsrfToken}&do=bookmark_delete`}),t&&t.classList.remove("esgst-idb-highlight"),!0}},Ks=hs.createHeadingButton.bind(hs),zs=hs.saveAndSortContent.bind(hs);const Qs=new class extends gt{constructor(){super(),this.info={description:()=>Se.element("ul",null,Se.element("li",null,"Adds a button (",Se.element("i",{className:"fa fa-sort"})," ) to the main page heading of any"," ",Se.element("a",{href:"https://www.steamgifts.com/discussions"},"discussions")," page that allows you to sort the discussions in the page by title, category, created time, author and number of comments."),Se.element("li",null,"There is also an option to automatically sort the discussions so that every time you open the page the discussions are already sorted by whatever option you prefer.")),id:"ds",name:"Discussions Sorter",sg:!0,type:"discussions"}}init(){if(!this.esgst.discussionsPath)return;let e={button:Ks({id:"ds",icons:["fa-sort"],title:"Sort discussions"})};e.button.addEventListener("click",this.ds_openPopout.bind(this,e))}ds_openPopout(e){if(e.popout)return;let t;e.popout=new mt("esgst-ds-popout",e.button,0,!0),new vt(e.popout.popout,"ds_auto",!1,"Auto Sort",!1,!1,"Automatically sorts the discussions by the selected option when loading the page.",d.get("ds_auto")),Se.insert(e.popout.popout,"beforeend",Se.element("select",{ref:e=>t=e},Se.element("option",{value:"sortIndex_asc"},"Default"),Se.element("option",{value:"title_asc"},"Title - Ascending"),Se.element("option",{value:"title_desc"},"Title - Descending"),Se.element("option",{value:"category_asc"},"Category - Ascending"),Se.element("option",{value:"category_desc"},"Category - Descending"),Se.element("option",{value:"createdTimestamp_asc"},"Created Time - Ascending"),Se.element("option",{value:"createdTimestamp_desc"},"Created Time - Descending"),Se.element("option",{value:"author_asc"},"Author - Ascending"),Se.element("option",{value:"author_desc"},"Author - Descending"),Se.element("option",{value:"comments_asc"},"Comments - Ascending"),Se.element("option",{value:"comments_desc"},"Comments - Descending"))),t.value=d.get("ds_option");let s=zs.bind(hs,rt.findData("main","discussions"),"ds_option",t);t.addEventListener("change",s),tt.create({color:"green",icons:["fa-arrow-circle-right"],name:"Sort",onClick:s}).insert(e.popout.popout,"beforeend"),e.popout.open()}};const Zs=new class extends gt{constructor(){super(),this.info={description:()=>Se.element("ul",null,Se.element("li",null,"Adds an icon (",Se.element("i",{className:"fa fa-star"}),") next to a game's name (in any page) to indicate that you have entered giveaways for the game in the past. Clicking on the icon unhighlights the game."),Se.element("li",null,"A game is only highlighted if you entered a giveaway for it after this feature was enabled.")),id:"egh",name:"Entered Game Highlighter",sg:!0,type:"games",featureMap:{game:this.egh_getGames.bind(this)},features:{egh_c:{name:"Show a counter with the number of giveaways that have been entered for the game.",sg:!0}}}}egh_getGames(e){for(const t of e.all){if(c.esgst.giveawayPath){const e=document.querySelector(".sidebar__entry-insert");e&&e.addEventListener("click",this.egh_saveGame.bind(this,t.id,t.type))}const e=c.esgst.games[t.type][t.id];if(e&&e.entered&&!t.container.querySelector(".esgst-egh-button")){const s=Number(e.entered);Se.insert(t.container.closest(".poll")&&t.container.querySelector(".table__column__heading")||t.headingName,"beforebegin",Se.element("a",{"data-draggable-id":"egh",className:"esgst-egh-button esgst-clickable",title:c.common.getFeatureTooltip("egh",`You have entered ${s} giveaways for this game before. Click to unhighlight it (will restart the counter to 0).`),onclick:this.egh_unhighlightGame.bind(this,t.id,t.type)},Se.element("i",{className:"fa fa-star esgst-egh-icon"}),d.get("egh_c")?" "+s:null))}}}async egh_saveGame(e,t){if(!e||!t)return;let s=c.esgst.games[t][e];s||(s={}),s.entered||(s.entered=0),s.entered+=1,await c.common.lockAndSaveGames({[t]:{[e]:s}})}async egh_unhighlightGame(e,t,s){const n=s.currentTarget;if(n.classList.contains("fa-spin"))return;Se.insert(n,"atinner",Se.element("i",{className:"fa fa-circle-o-notch fa-spin"}));let a=c.esgst.games[t][e];a&&a.entered&&(a.entered=null,await c.common.lockAndSaveGames({[t]:{[e]:a}})),n.remove()}};function Xs(e){k(1,arguments);var t=A(e);return t.setHours(0,0,0,0),t}function en(e,t){k(2,arguments);var s=Xs(e),n=Xs(t);return s.getTime()===n.getTime()}const tn=hs.createElements.bind(hs),sn=hs.getFeatureTooltip.bind(hs),nn=hs.getValue.bind(hs),an=hs.setValue.bind(hs);const on=new class extends gt{constructor(){super(),this.info={description:()=>Se.element("ul",null,Se.element("li",null,"Adds a button (",Se.element("i",{className:"fa fa-ticket esgst-red"})," My Entry History) to the dropdown menu accessible by clicking on the arrow next to your avatar at the header of any page that allows you to view your giveaway entry history (the detailed log, including the name, link and date of every giveaway you have entered/left) and some other details (the average number of giveaways that you enter per day, the date when you entered the least number of giveaways, the date when you entered the most number of giveaways and a table containing how many giveaways you have entered/left per day)."),Se.element("li",null,"An entry only appears in the history if you entered/left the giveaway after this feature was enabled.")),id:"et",name:"Entry Tracker",sg:!0,type:"giveaways"}}init(){if(this.esgst.enteredPath&&this.esgst.endlessFeatures.push(this.et_getEntries.bind(this)),!this.esgst.sg)return;const e=c.header.addDropdownItem({buttonContainerId:"account",description:"View your entry history.",icon:"fa fa-fw fa-ticket icon-red red",name:"My Entry History",onClick:this.et_menu.bind(this)});if(e.nodes.outer.dataset.linkId="myEntryHistory",e.nodes.outer.dataset.linkKey="account",e.nodes.outer.title=sn("et"),this.esgst.giveawayPath&&!document.getElementsByClassName("table--summary")[0]&&this.esgst.enterGiveawayButton){let e,t;e=window.location.pathname.match(/^\/giveaway\/(.+?)\//)[1],t=document.getElementsByClassName("featured__heading__medium")[0].textContent,this.esgst.enterGiveawayButton.addEventListener("click",this.et_setEntry.bind(this,e,!0,t)),this.esgst.leaveGiveawayButton.addEventListener("click",this.et_setEntry.bind(this,e,!1,t))}}async et_menu(){let e={},t=JSON.parse(nn("entries","[]"));const s=[];for(let n=t.length-1;n>-1;n--){let a=t[n];s.push({type:"li",children:[{text:(a.entry?"Entered":"Left")+" ",type:"node"},{attributes:{href:`/giveaway/${a.code}/`},text:a.name,type:"a"},{text:"on "+this.esgst.modules.generalAccurateTimestamp.at_formatTimestamp(a.timestamp),type:"node"}]});let i=xe(a.timestamp,"MMM d, yyyy"),o=new Date(i).getTime();e[o]||(e[o]={date:i,entered:0,left:0}),a.entry?e[o].entered+=1:e[o].left+=1}const n=Object.keys(e).map(e=>parseInt(e)),a=n[0];let i=n[n.length-1];for(;i<a;){const t=new Date(i);t.setDate(t.getDate()+1),i=t.getTime(),e[i]||(e[i]={date:xe(i,"MMM d, yyyy"),entered:0,left:0})}let o=new lt({addScrollable:!0,icon:"fa-history",isTemp:!0,title:"Entry Tracker"});o.scrollable.style.display="flex";let r=tn(o.scrollable,"beforeend",[{attributes:{class:"esgst-text-left table",style:"padding-left: 5px;"},type:"div",children:[{attributes:{class:"table__heading"},type:"div",children:[{attributes:{class:"table__column--width-small"},text:"Delete",type:"div"},{attributes:{class:"table__column--width-small"},text:"Date",type:"div"},{attributes:{class:"table__column--width-small"},text:"Entered",type:"div"},{attributes:{class:"table__column--width-small"},text:"Left",type:"div"}]},{attributes:{class:"table__rows"},type:"div"}]}]).lastElementChild,l=Object.keys(e);l.sort();let c={count:999999999,date:null},d={count:0,date:null},g=0;for(let t=l.length-1;t>-1;t--){let s=l[t],n=tn(r,"beforeend",[{attributes:{class:"table__row-outer-wrap"},type:"div",children:[{attributes:{class:"table__row-inner-wrap"},type:"div",children:[{attributes:{class:"table__column--width-small esgst-text-center"},type:"div",children:[{attributes:{class:"fa fa-times esgst-clickable",title:"Delete"},type:"i"}]},{attributes:{class:"table__column--width-small"},text:e[s].date,type:"div"},{attributes:{class:"table__column--width-small"},text:e[s].entered,type:"div"},{attributes:{class:"table__column--width-small"},text:e[s].left,type:"div"}]}]}]).firstElementChild.firstElementChild;n.firstElementChild.addEventListener("click",this.et_deleteEntry.bind(this,n,e[s].date,o)),e[s].entered<c.count&&(c.count=e[s].entered,c.date=e[s].date),e[s].entered>d.count&&(d.count=e[s].entered,d.date=e[s].date),g+=e[s].entered}let u=Math.round(g/l.length*100)/100;tn(o.description,"afterbegin",[{type:"div",children:[{text:"You enter on average ",type:"node"},{attributes:{class:"esgst-bold"},text:u,type:"span"},{text:" giveaways per day.",type:"node"}]},{type:"div",children:[{text:"Your highest entry count was on ",type:"node"},{attributes:{class:"esgst-italic"},text:d.date,type:"span"},{text:" with ",type:"node"},{attributes:{class:"esgst-bold"},text:d.count,type:"span"},{text:" entries.",type:"node"}]},{type:"div",children:[{text:"Your lowest entry count was on ",type:"node"},{attributes:{class:"esgst-italic"},text:c.date,type:"span"},{text:" with ",type:"node"},{attributes:{class:"esgst-bold"},text:c.count,type:"span"},{text:" entries.",type:"node"}]}]),tn(o.scrollable,"afterbegin",[{attributes:{class:"esgst-text-left markdown",style:"border-right: 1px solid #ccc; padding-right: 5px;"},type:"div",children:[{type:"ul",children:s}]}]),o.open()}async et_deleteEntry(e,t,s){if(!window.confirm(`Are you sure you want to delete entries for ${t}? Your entire history for that day will be deleted.`))return;tn(e,"atinner",[{attributes:{class:"fa fa-circle-o-notch fa-spin"},type:"i"}]);let n=JSON.parse(nn("entries","[]"));for(let e=n.length-1;e>-1;e--){en(t,n[e].timestamp)&&n.splice(e,1)}await an("entries",JSON.stringify(n)),s.close(),this.et_menu()}et_getEntries(e,t,s,n){const a=e.querySelectorAll(""+(n?`.esgst-es-page-${n} .table__remove-default:not(.is-hidden), .esgst-es-page-${n}.table__remove-default:not(.is-hidden)`:".table__remove-default:not(.is-hidden)"));for(let e=0,t=a.length;e<t;++e)this.et_setObserver(a[e])}et_setObserver(e){let t,s,n,a;s=e.closest(".table__row-inner-wrap"),n=s.getElementsByClassName("table__column__heading")[0],t=n.getAttribute("href").match(/\/giveaway\/(.+?)\//)[1],a=n.firstChild.textContent.trim().match(/(.+?)(\s\(.+\sCopies\))?$/)[1],e.addEventListener("click",this.et_setEntry.bind(this,t,!1,a))}async et_setEntry(e,t,s){let n=JSON.parse(nn("entries","[]"));n.push({code:e,entry:t,name:s,timestamp:Date.now()}),an("entries",JSON.stringify(n))}};const rn=new class extends gt{constructor(){super(),this.info={description:()=>Se.element("ul",null,Se.element("li",null,"Replaces SteamGifts' native comment button with a new one, so that ESGST can track your comments."),Se.element("li",null,"Adds a button (",Se.element("i",{className:"fa fa-comments esgst-yellow"})," My Comment History) to the dropdown menu accessible by clicking on the arrow next to your avatar at the header of any page that allows you to view your comment history.")),id:"ch",name:"Comment History",sg:!0,type:"comments"}}init(){if(!c.esgst.sg)return;c.esgst.replyBox&&c.common.addReplyButton(c.esgst.replyBox);const e=c.header.addDropdownItem({buttonContainerId:"account",description:"View your comment history.",icon:"fa fa-fw fa-comments icon-yellow yellow",name:"My Comment History"});e.nodes.outer.dataset.linkId="myCommentHistory",e.nodes.outer.dataset.linkKey="account",e.nodes.outer.title=c.common.getFeatureTooltip("ch"),new Ws({button:e.nodes.outer,popup:{icon:"fa-comments",title:"Comment History",addProgress:!0,addScrollable:"left"},urls:{id:"ch",init:this.ch_initUrls.bind(this),request:{request:this.ch_requestUrl.bind(this)}}})}async ch_initUrls(e){e.ids=[];let t=JSON.parse(c.common.getValue(c.esgst.name+"CommentHistory","[]"));for(let s=0,n=t.length;s<n;s++)e.ids.push(t[s].id),e.items.push(`https://${window.location.hostname}/go/comment/${t[s].id}`)}async ch_requestUrl(e,t,s,n){const a=e.ids[e.index];let i=n.getElementById(a);if(c.esgst.sg){var o,r;i=i.closest(".comment");const e=d.get("username");let t=null!==(o=null===(r=i.querySelector(".comment__author"))||void 0===r?void 0:r.textContent.trim())&&void 0!==o?o:"";if(t!==e){for(var l,g;t!==e&&i;){var u,m;i=i.previousElementSibling,t=null!==(u=null===(m=i)||void 0===m||null===(m=m.querySelector(".comment__author"))||void 0===m?void 0:m.textContent.trim())&&void 0!==u?u:""}if(!i)return;const s=null!==(l=null===(g=i.querySelector(".comment__summary"))||void 0===g?void 0:g.id)&&void 0!==l?l:"",n=c.esgst.name+"CommentHistory",o=new Te(n,{threshold:300});await o.lock();let r=JSON.parse(c.common.getValue(n,"[]"));r=r.map(e=>e.id===a?{...e,id:s}:e),await c.common.setValue(n,JSON.stringify(r)),await o.unlock()}i.firstElementChild.classList.remove("comment__parent"),i.firstElementChild.classList.add("comment__child")}i.lastElementChild.remove();let h=i.parentElement.closest(".comment, .comment_outer");const p=[];h?(h.lastElementChild.remove(),Se.insert(h,"beforeend",Se.element("div",{className:"comment__children comment_children"},i)),p.push(h)):(c.esgst.st&&Se.insert(i.getElementsByClassName("action_list")[0].firstElementChild,"afterend",Se.element("a",{href:s.url},n.title)),c.esgst.sg&&p.push(Se.element("div",{className:"comments__entity"},Se.element("p",{className:"comments__entity__name"},Se.element("a",{href:s.url},n.title)))),p.push(Se.element("div",{className:"comment__children comment_children"},i))),Se.insert(e.context,"beforeend",Se.element("div",{className:"comment comments comment_outer"},p))}async ch_saveComment(e,t){const s=new Te(c.esgst.name+"CommentHistory",{threshold:300});await s.lock();let n=c.esgst.name+"CommentHistory",a=JSON.parse(c.common.getValue(n,"[]"));a.unshift({id:e,timestamp:t}),await c.common.setValue(n,JSON.stringify(a)),await s.unlock()}};const ln=new class extends gt{constructor(){super(),this.info={description:()=>Se.element("ul",null,Se.element("li",null,"Keeps the footer of any page at the bottom of the window while you scroll down the page.")),features:{ff_t:{description:()=>Se.element("fragment",null,Se.element("ul",null,Se.element("li",null,"Removes upper portion to reduce the height of the footer."),Se.element("li",null,"Add your own links with"," ",c.common.getFeatureName(null,"chfl")," , to enable now click"," ",Se.element("a",{className:"table__column__secondary-link",href:c.esgst.settingsUrl+"&id=chfl",target:"_blank"},"here"),"."))),name:"Thin Footer.",sg:!0,st:!0}},id:"ff",name:"Fixed Footer",sg:!0,st:!0,type:"general"}}init(){c.footer&&(c.footer.nodes.outer.classList.add("esgst-ff"),d.get("ff_t")&&c.footer.nodes.outer.classList.add("esgst-thin"))}};const cn=new class extends gt{constructor(){super(),this.info={description:()=>Se.element("ul",null,Se.element("li",null,"Keeps the header of any page at the top of the window while you scroll down the page.")),id:"fh",name:"Fixed Header",sg:!0,st:!0,type:"general"}}init(){var e;null!==(e=c.header)&&void 0!==e&&e.nodes.outer&&c.header.nodes.outer.classList.add("esgst-fh")}};const dn=new class extends gt{constructor(){super(),this.info={description:()=>Se.element("ul",null,Se.element("li",null,'Keeps the main page heading (usually the first heading of the page, for example, the heading that says "Giveaways" in the main page) of any page at the top of the window while you scroll down the page.')),id:"fmph",name:"Fixed Main Page Heading",sg:!0,st:!0,type:"general"}}init(){if(Ee.subscribe(Je,e=>e.nodes.outer.classList.add("esgst-fmph")),this.esgst.pageHeadings.length){this.esgst.style.insertAdjacentText("beforeend",`\n\t\t\t.esgst-fmph {\n\t\t\t\ttop: ${this.esgst.pageTop}px;\n\t\t\t}\n\t\t`);for(const e of this.esgst.pageHeadings)e.classList.add("esgst-fmph")}}};const gn=new class extends gt{constructor(){super(),this.info={description:()=>Se.element("ul",null,Se.element("li",null,"Adds a button (",Se.element("i",{className:"fa fa-plus-square"})," if all of the replies in the page are collapsed and ",Se.element("i",{className:"fa fa-minus-square"})," if they are expanded) above the comments (in any page) that allows you to collapse/expand all of the replies (comments nested 2 or more levels deep) in the page."),Se.element("li",null,"Also adds the same button in front of each comment nested 1 level deep in the page, which allows you to collapse/expand the replies of the comment individually.")),features:{cerb_a:{name:"Automatically collapse all replies when visiting a page.",sg:!0,st:!0}},id:"cerb",name:"Collapse/Expand Reply Button",sg:!0,sgPaths:/^(Giveaway\s-\sComments|Discussion|Ticket|Trade)$/,st:!0,type:"comments"}}init(){if(!c.esgst.commentsPath)return;let e,t,s,n;s=document.getElementsByClassName("comments")[0],s&&s.children.length&&(this.buttons=[],Se.insert(c.esgst.mainPageHeading,"afterend",Se.element("div",{className:"esgst-cerb-button esgst-clickable",ref:t=>e=t},Se.element("span",null,Se.element("i",{className:"fa fa-minus-square"})," Collapse all replies"),Se.element("span",{className:"esgst-hidden"},Se.element("i",{className:"fa fa-plus-square"})," Expand all replies"))),t=e.firstElementChild,n=t.nextElementSibling,t.addEventListener("click",this.cerb_collapseAllReplies.bind(this,t,n)),n.addEventListener("click",this.cerb_expandAllReplies.bind(this,t,n)),c.esgst.endlessFeatures.push(this.cerb_getReplies.bind(this,t,n)))}cerb_getReplies(e,t,s,n,a,i){let o=s===document&&n?window.location.hash.replace(/#/,""):null,r=o?document.getElementById(o):null,l=s.querySelectorAll(c.common.getSelectors(i,[":not(.esgst-popup) .comments > X.comment",":not(.esgst-popup) .comments > X.comment_outer"]));if(l.length){for(let e of l){let t=e.querySelector(".comment__children, .comment_children");if(t&&t.children.length){let s;Se.insert(e.firstElementChild,"afterbegin",Se.element("div",{className:"esgst-cerb-reply-button esgst-clickable",ref:e=>s=e},Se.element("span",{title:c.common.getFeatureTooltip("cerb","Collapse all replies")},Se.element("i",{className:"fa fa-minus-square"})),Se.element("span",{className:"esgst-hidden",title:c.common.getFeatureTooltip("cerb","Expand all replies")},Se.element("i",{className:"fa fa-plus-square"})))),this.cerb_setButton(s,r&&e.contains(r),e,t.children)}}d.get("cerb_a")&&this.cerb_collapseAllReplies(e,t)}}cerb_setButton(e,t,s,n){let a,i;a=e.firstElementChild,i=a.nextElementSibling,this.buttons.push({collapse:this.cerb_collapseReplies.bind(this,a,i,n),expand:this.cerb_expandReplies.bind(this,a,i,n),permalink:t}),a.addEventListener("click",this.cerb_collapseReplies.bind(this,a,i,n)),i.addEventListener("click",this.cerb_expandReplies.bind(this,a,i,n)),d.get("cerb_a")&&!t&&(a.classList.toggle("esgst-hidden"),i.classList.toggle("esgst-hidden"))}cerb_collapseReplies(e,t,s){let n,a;for(n=0,a=s.length;n<a;++n)s[n].classList.add("esgst-hidden");e.classList.add("esgst-hidden"),t.classList.remove("esgst-hidden")}cerb_expandReplies(e,t,s){let n,a;for(n=0,a=s.length;n<a;++n)s[n].classList.remove("esgst-hidden");e.classList.remove("esgst-hidden"),t.classList.add("esgst-hidden")}cerb_collapseAllReplies(e,t){for(const e of this.buttons)e.permalink||e.collapse();e.classList.add("esgst-hidden"),t.classList.remove("esgst-hidden")}cerb_expandAllReplies(e,t){for(const e of this.buttons)e.expand();e.classList.remove("esgst-hidden"),t.classList.add("esgst-hidden")}};const un=new class extends gt{constructor(){super(),this.info={description:()=>Se.element("ul",null,Se.element("li",null,"Moves the reply box over the comments (in any page) so that you do not need to scroll down to the bottom of the page to add a comment.")),id:"rbot",name:"Reply Box On Top",sg:!0,st:!0,type:"comments"}}init(){let e=c.esgst.mainPageHeading;const t=c.esgst.replyBox||c.esgst.reviewBox;if(!t)return;let s;Se.insert(e,"afterend",Se.element("div",{className:"esgst-rbot",ref:e=>s=e})),s.appendChild(t);let n=s.getElementsByClassName(c.esgst.cancelButtonClass)[0];n&&n.addEventListener("click",()=>window.setTimeout(()=>s.appendChild(t),0))}};const mn=new class extends gt{constructor(){super(),this.info={description:()=>Se.element("ul",null,Se.element("li",null,"Keeps the sidebar of any page at the left side of the window while you scroll down the page.")),id:"fs",name:"Fixed Sidebar",sg:!0,type:"general"}}init(){if(!this.esgst.sidebar)return;const e=this.esgst.pageTop+25;this.esgst.style.insertAdjacentText("beforeend",`\n\t\t\t.esgst-fs {\n\t\t\t\tmax-height: calc(100vh - ${e+30+(d.get("ff")?39:0)}px);\n\t\t\t\ttop: ${e}px;\n\t\t\t}\n\t\t`),this.esgst.sidebar.classList.add("esgst-fs")}},hn=hs.capitalizeFirstLetter.bind(hs),pn=hs.createElements.bind(hs),fn=hs.createHeadingButton.bind(hs),bn=hs.saveAndSortContent.bind(hs);const wn=new class extends gt{constructor(){super(),this.info={description:()=>Se.element("ul",null,Se.element("li",null,"Adds a button (",Se.element("i",{className:"fa fa-sort"}),") to the main page heading of any"," ",Se.element("a",{href:"https://www.steamgifts.com/giveaways"},"giveaways"),"/",Se.element("a",{href:"https://www.steamgifts.com/entered"},"entered"),"/",Se.element("a",{href:"https://www.steamgifts.com/group/SJ7Bu/"},"group"),"/",Se.element("a",{href:"https://www.steamgifts.com/user/cg"},"user")," page that allows you to sort the giveaways in the page by game name, points, rating (if"," ",Se.element("span",{"data-esgst-feature-id":"gc_r"})," is enabled), end time, start time, creator, comments, entries, chance/chance per point (if ",Se.element("span",{"data-esgst-feature-id":"gwc"})," ","is enabled), ratio (if ",Se.element("span",{"data-esgst-feature-id":"gwr"})," is enabled) and points to win (if ",Se.element("span",{"data-esgst-feature-id":"gptw"})," is enabled)."),Se.element("li",null,"There is also an option to automatically sort the giveaways so that every time you open the page the giveaways are already sorted by whatever option you prefer.")),id:"gas",name:"Giveaways Sorter",sg:!0,type:"giveaways"}}init(e){if(!(e||this.esgst.giveawaysPath||this.esgst.enteredPath||this.esgst.gamePath||this.esgst.groupPath||this.esgst.userPath))return;const t=window.location.search.match(/type=(wishlist|recommended|group|new)/);let s="";s=t?hn(t[1]):this.esgst.enteredPath?"Entered":this.esgst.userPath?"User":this.esgst.gamePath?"Games":this.esgst.groupPath?"Groups":e?"Popup":"",this.esgst.gas={autoKey:"gas_auto"+s,optionKey:"gas_option"+s};let n={button:fn({context:e,id:"gas",icons:["fa-sort"],title:"Sort giveaways"})};n.button.addEventListener("click",this.gas_openPopout.bind(this,n))}gas_openPopout(e){if(e.popout)return;e.popout=new mt("esgst-gas-popout",e.button,0,!0),new vt(e.popout.popout,this.esgst.gas.autoKey,!1,"Auto Sort",!1,!1,"Automatically sorts the giveaways by the selected option when loading the page.",d.get(this.esgst.gas.autoKey));const t=[{attributes:{value:"sortIndex_asc"},text:"Default",type:"option"},{attributes:{value:"name_asc"},text:"Game Name - Ascending",type:"option"},{attributes:{value:"name_desc"},text:"Game Name - Descending",type:"option"}];t.push({attributes:{value:"level_asc"},text:"Level - Ascending",type:"option"},{attributes:{value:"level_desc"},text:"Level - Descending",type:"option"}),this.esgst.enteredPath||t.push({attributes:{value:"points_asc"},text:"Points - Ascending",type:"option"},{attributes:{value:"points_desc"},text:"Points - Descending",type:"option"}),d.get("gc")&&d.get("gc_r")&&!this.esgst.enteredPath&&t.push({attributes:{value:"rating_asc"},text:"Rating - Ascending",type:"option"},{attributes:{value:"rating_desc"},text:"Rating - Descending",type:"option"},{attributes:{value:"ratingQuantity_asc"},text:"Rating Quantity - Ascending",type:"option"},{attributes:{value:"ratingQuantity_desc"},text:"Rating Quantity - Descending",type:"option"}),t.push({attributes:{value:"endTime_asc"},text:"End Time - Ascending",type:"option"},{attributes:{value:"endTime_desc"},text:"End Time - Descending",type:"option"}),this.esgst.enteredPath||t.push({attributes:{value:"startTime_asc"},text:"Start Time - Ascending",type:"option"},{attributes:{value:"startTime_desc"},text:"Start Time - Descending",type:"option"},{attributes:{value:"creator_asc"},text:"Creator - Ascending",type:"option"},{attributes:{value:"creator_desc"},text:"Creator - Descending",type:"option"},{attributes:{value:"comments_asc"},text:"Comments - Ascending",type:"option"},{attributes:{value:"comments_desc"},text:"Comments - Descending",type:"option"}),t.push({attributes:{value:"entries_asc"},text:"Entries - Ascending",type:"option"},{attributes:{value:"entries_desc"},text:"Entries - Descending",type:"option"}),d.get("gwc")&&(t.push({attributes:{value:"chance_asc"},text:"Chance - Ascending",type:"option"},{attributes:{value:"chance_desc"},text:"Chance - Descending",type:"option"},{attributes:{value:"chancePerPoint_asc"},text:"Chance Per Point - Ascending",type:"option"},{attributes:{value:"chancePerPoint_desc"},text:"Chance Per Point - Descending",type:"option"}),d.get("gwc_a")&&t.push({attributes:{value:"projectedChance_asc"},text:"Projected Chance - Ascending",type:"option"},{attributes:{value:"projectedChance_desc"},text:"Projected Chance - Descending",type:"option"},{attributes:{value:"projectedChancePerPoint_asc"},text:"Projected Chance Per Point - Ascending",type:"option"},{attributes:{value:"projectedChancePerPoint_desc"},text:"Projected Chance Per Point - Descending",type:"option"})),d.get("gwr")&&(t.push({attributes:{value:"ratio_asc"},text:"Ratio - Ascending",type:"option"},{attributes:{value:"ratio_desc"},text:"Ratio - Descending",type:"option"}),d.get("gwr_a")&&t.push({attributes:{value:"projectedRatio_asc"},text:"Projected Ratio - Ascending",type:"option"},{attributes:{value:"projectedRatio_desc"},text:"Projected Ratio - Descending",type:"option"})),d.get("gptw")&&t.push({attributes:{value:"pointsToWin_asc"},text:"Points To Win - Ascending",type:"option"},{attributes:{value:"pointsToWin_desc"},text:"Points To Win - Descending",type:"option"});let s=pn(e.popout.popout,"beforeend",[{type:"select",children:t}]);s.value=d.get(this.esgst.gas.optionKey);let n=()=>bn(rt.findData("current","giveaways"),this.esgst.gas.optionKey,s);s.addEventListener("change",n),tt.create({color:"green",icons:["fa-arrow-circle-right"],name:"Sort",onClick:n}).insert(e.popout.popout,"beforeend"),e.popout.open()}},yn=hs.createElements.bind(hs),vn=hs.endless_load.bind(hs),_n=hs.getFeatureTooltip.bind(hs),kn=hs.getValue.bind(hs),xn=hs.lockAndSaveGiveaways.bind(hs),An=hs.setValue.bind(hs);const Cn=new class extends gt{constructor(){super(),this.info={description:()=>Se.element("ul",null,Se.element("li",null,"Adds a button (",Se.element("i",{className:"fa fa-bookmark"})," if the giveaway is bookmarked and"," ",Se.element("i",{className:"fa fa-bookmark-o"})," if it is not) next to a giveaway's game name (in any page) that allows you to bookmark the giveaway so that you can enter it later."),Se.element("li",null,"Adds a button (",Se.element("i",{className:"fa fa-bookmark"}),") next to the ESGST button at the header of any page that allows you to view all of the giveaways that have been bookmarked.")),features:{gb_u:{name:"Automatically unbookmark ended giveaways.",sg:!0},gb_ue:{name:"Automatically unbookmark entered giveaways.",sg:!0},gb_ui:{name:"Automatically unbookmark inaccessible giveaways.",sg:!0},gb_h:{description:()=>Se.element("ul",null,Se.element("li",null,"When giveaways that hadn't started start, the button will turn green, indicating that you must open the list of bookmarked giveaways so that the started giveaways can be updated with their end times."),Se.element("li",null,"When giveaways are about to end (based on the number of hours specified below), the button will turn red."),Se.element("li",null,"If there are both started and ending giveaways, the button will be colored with a brown-ish color, as a mixture of the green and red colors."),Se.element("li",null,"If you hover over the button, it shows more details about how many giveaways have started and/or are ending.")),inputItems:[{id:"gb_hours",prefix:"Time range to trigger highlight: ",suffix:" hours"}],name:"Highlight the header button when giveaways have started and/or are about to end.",sg:!0},gb_t:{name:"Open the list of bookmarked giveaways in a new tab.",sg:!0},gb_se:{name:"Show the button for entered giveaways.",sg:!0}},id:"gb",name:"Giveaway Bookmarks",sg:!0,type:"giveaways",featureMap:{giveaway:this.gb_getGiveaways.bind(this)}}}init(){let e=c.header.addButtonContainer({buttonIcon:"fa fa-bookmark",buttonName:"ESGST Bookmarked Giveaways",isNotification:!0,side:"left",url:d.get("gb_t")?"https://www.steamgifts.com/account/settings/profile?esgst=gb":"",openInNewTab:!0});e.nodes.outer.classList.add("esgst-hidden"),e.nodes.buttonIcon.title=_n("gb","View your bookmarked giveaways"),this.gb_addButton(e),d.get("gb_ue")&&this.esgst.enterGiveawayButton&&(this.esgst.enterGiveawayButton.onclick=()=>{let e=rt.findData("main","giveaways")[0];e&&e.gbButton&&(3===e.gbButton.index&&e.gbButton.change(e.gbButton.callbacks[2]),d.get("gb_se")||e.gbButton.button.classList.add("esgst-hidden"))}),this.esgst.leaveGiveawayButton&&(this.esgst.leaveGiveawayButton.onclick=()=>{let e=rt.findData("main","giveaways")[0];e&&e.gbButton&&e.gbButton.button.classList.remove("esgst-hidden")})}gb_addButton(e){let t,s,n=[],a=1,i=0,o=0;d.get("gb_h")&&e&&e.nodes.outer.classList.add("esgst-gb-highlighted");const r={};for(let t in this.esgst.giveaways)if(!(t.length>5)&&this.esgst.giveaways.hasOwnProperty(t)){const s=this.esgst.giveaways[t];s.bookmarked&&(void 0===s.started&&(s.started=!0,r[t]={started:!0}),Date.now()>=s.endTime||!s.endTime?s.started?d.get("gb_u")?(delete s.bookmarked,r[t]={bookmarked:null}):n.push(s):(n.push(s),++i,d.get("gb_h")&&e&&e.nodes.outer.classList.add("started")):(n.push(s),s.started&&(a=s.endTime-Date.now()-36e5*d.get("gb_hours"),a<=0&&++o)))}let l;if(hs.lock_and_save_giveaways(r),l=i||o?i?o?`(${i} started - click to update them, ${o} ending)`:`(${i} started - click to update them)`:`(${o} ending)`:"",e&&(e.nodes.buttonIcon.title=_n("gb","View your bookmarked giveaways "+l)),n.length){for(n.sort((e,t)=>e.endTime>t.endTime?1:e.endTime<t.endTime?-1:0),t=0,s=n.length;t<s;++t)Date.now()>n[t].endTime&&(n.push(n.splice(t,1)[0]),t-=1,s-=1);e&&(e.nodes.outer.classList.remove("esgst-hidden"),d.get("gb_h")&&o>0&&e.nodes.outer.classList.add("ending"))}if(c.common.isCurrentPath("Account")&&"gb"===this.esgst.parameters.esgst){const e=this.esgst.sidebar.nextElementSibling;d.get("removeSidebarInFeaturePages")&&this.esgst.sidebar.remove(),e.innerHTML="",e.setAttribute("data-esgst-popup","true"),this.heading=pt.create("gb",[{name:"ESGST",url:this.esgst.settingsUrl},{name:"Bookmarked Giveaways",url:"https://www.steamgifts.com/account/settings/profile?esgst=gb"}]).insert(e,"beforeend"),this.gb_loadGibs(n,e,yn(e,"beforeend",[{type:"div"}]))}e&&!d.get("gb_t")&&e.nodes.outer.addEventListener("click",()=>{const e=new lt({addScrollable:"left",isTemp:!0});this.heading=pt.create("gb",[{name:"ESGST",url:this.esgst.settingsUrl},{name:"Bookmarked Giveaways",url:"https://www.steamgifts.com/account/settings/profile?esgst=gb"}]).insert(e.description,"afterbegin"),this.gb_loadGibs(n,e.description,e.scrollable,e)})}gb_loadGibs(e,t,s,n){let a,i=0,o=e.length,r=yn(s,"beforeend",[{attributes:{class:"esgst-text-left"},type:"div"}]);(d.get("gas")||d.get("gf")&&d.get("gf_m")||d.get("mm"))&&(d.get("gas")&&this.esgst.modules.giveawaysGiveawaysSorter.init(this.heading.nodes.outer),d.get("gf")&&d.get("gf_m")&&this.heading.nodes.outer.appendChild(this.esgst.modules.giveawaysGiveawayFilters.filters_addContainer(this.heading.nodes.outer,"Gb")),d.get("mm")&&this.esgst.modules.generalMultiManager.mm(this.heading.nodes.outer)),tt.create({color:"white",icons:["fa-list"],name:"View Raw List",onClick:this.gb_openList.bind(this,{bookmarked:e})}).insert(this.heading.nodes.outer,"beforeend");const l=tt.create([{color:"green",icons:["fa-plus"],name:"Load more...",onClick:()=>new Promise(t=>{this.gb_loadGiveaways(i,i+5,e,r,a,n,e=>{i=e,i>o?l.destroy():d.get("es_gb")&&s.scrollHeight<=s.offsetHeight&&l.onClick(!0),t()})})},{template:"loading",isDisabled:!0,name:"Loading more..."}]).insert(this.heading.nodes.outer,"beforeend");n&&n.open(),a=yn(s,"beforebegin",[{type:"div",children:[{text:"0",type:"span"},{text:"P required to enter all ",type:"node"},{text:"0",type:"span"},{text:" giveaways.",type:"node"}]}]),l.onClick(),d.get("es_gb")&&s.addEventListener("scroll",()=>{s.scrollTop+s.offsetHeight>=s.scrollHeight&&!l.isBusy&&l.onClick()})}gb_openList(e){if(e.popup)e.popup.open();else{e.popup=new lt({addScrollable:!0,icon:"fa-list",title:"Bookmarked Giveaways (Raw List)"});for(const t of e.bookmarked){const s={class:"table__column__secondary-link",href:`/giveaway/${t.code}/`};t.name&&(s["data-esgst"]=!0),yn(e.popup.scrollable,"beforeend",[{type:"div",children:[{attributes:s,text:t.name||t.code,type:"a"}]}])}e.popup.open(),this.gb_loadNames(e)}}async gb_loadNames(e){let t={};for(let s=0,n=e.popup.scrollable.children.length;s<n;s++){let n=e.popup.scrollable.children[s].firstElementChild;if(!n.getAttribute("data-esgst")){let e=n.textContent;n.textContent=(await Ne.get(n.getAttribute("href"),{queue:!0})).html.getElementsByClassName("featured__heading__medium")[0].textContent,t[e]={name:n.textContent}}}xn(t)}async gb_loadGiveaways(e,t,s,n,a,i,o){if(e<t)if(s[e]){let r,l=await Ne.get(`/giveaway/${s[e].code}/`,{queue:!0}),g=l.html,u=l.url;const m=await c.common.buildGiveaway(g,u);if(m)if(r=0,!s[e].started&&m.started&&(r=m.timestamp),a.firstElementChild.textContent=parseInt(a.firstElementChild.textContent)+m.points,a.lastElementChild.textContent=parseInt(a.lastElementChild.textContent)+1,Date.now()>s[e].endTime&&!n.getElementsByClassName("row-spacer")[0]&&Se.insert(n,"beforeend",Se.element("div",{className:"row-spacer"})),yn(n,"beforeend",m.html),await vn(n.lastElementChild,!1,"gb"),r>0){const l=new Te("giveaway",{threshold:300});await l.lock();let c=JSON.parse(kn("giveaways"));c[s[e].code].started=!0,c[s[e].code].endTime=r,await An("giveaways",JSON.stringify(c)),await l.unlock(),window.setTimeout(()=>this.gb_loadGiveaways(++e,t,s,n,a,i,o),0)}else window.setTimeout(()=>this.gb_loadGiveaways(++e,t,s,n,a,i,o),0);else{if(d.get("gb_ui")){const t=new Te("giveaway",{threshold:300});await t.lock();let n=JSON.parse(kn("giveaways"));n[s[e].code]&&delete n[s[e].code].bookmarked,await An("giveaways",JSON.stringify(n)),await t.unlock()}window.setTimeout(()=>this.gb_loadGiveaways(++e,t,s,n,a,i,o),0)}}else o(e+1);else o(e)}gb_getGiveaways(e,t){e.forEach(e=>{t&&this.esgst.wonPath||t&&this.esgst.archivePath||e.creator===d.get("username")||!e.code||5!==e.code.length||!e.url||e.gbButton||(e.bookmarked=this.esgst.giveaways[e.code]&&this.esgst.giveaways[e.code].bookmarked,e.gbButton=new Us(e.headingName,"beforebegin",{callbacks:[this.gb_bookmarkGiveaway.bind(this,e,t),null,this.gb_unbookmarkGiveaway.bind(this,e,t),null],className:"esgst-gb-button",icons:["fa-bookmark-o esgst-clickable","fa-circle-o-notch fa-spin","fa-bookmark","fa-circle-o-notch fa-spin"],id:"gb",index:e.bookmarked?2:0,titles:["Bookmark giveaway","Bookmarking giveaway...","Unbookmark giveaway","Unbookmarking giveaway..."]}),e.gbButton.button.setAttribute("data-draggable-id","gb"),(e.entered||this.esgst.enteredPath&&t)&&!d.get("gb_se")&&e.gbButton.button.classList.add("esgst-hidden"))})}async gb_bookmarkGiveaway(e){const t=new Te("giveaway",{threshold:300});await t.lock();let s=JSON.parse(kn("giveaways","{}"));return s[e.code]||(s[e.code]={}),s[e.code].code=e.code,s[e.code].endTime=e.endTime,s[e.code].name=e.name,s[e.code].started=e.started,s[e.code].bookmarked=!0,e.bookmarked=!0,await An("giveaways",JSON.stringify(s)),await t.unlock(),!0}async gb_unbookmarkGiveaway(e){const t=new Te("giveaway",{threshold:300});await t.lock();let s=JSON.parse(kn("giveaways","{}"));return s[e.code]&&delete s[e.code].bookmarked,delete e.bookmarked,await An("giveaways",JSON.stringify(s)),await t.unlock(),!0}},Sn=hs.createElements.bind(hs),En=hs.getFeatureTooltip.bind(hs),Tn=hs.lockAndSaveGames.bind(hs);const Nn=new class extends gt{constructor(){super(),o()(this,"replacePlaceholders",(e,t)=>e.replace(/%steam-id%/g,t.steamId).replace(/%username%/g,t.username).replace(/%game-type%/g,t.gameType).replace(/%game-id%/g,t.gameId).replace(/%game-name%/g,t.gameName).replace(/%game-search-name%/g,t.gameSearchName).replace(/%hltb-id%/g,t.hltbId)),o()(this,"fetchFromServer",async(e,t,s)=>{const n={apps:[],subs:[],bundles:[]};for(const e of s)e.fetched||("string"==typeof e.id&&e.id.match(/^SteamBundle/)?(e.realId=e.id.replace(/^SteamBundle/,""),e.realType="bundles"):(e.realId=e.id,e.realType=e.type),n[e.realType].push(e.realId));if(n.apps.length>0||n.subs.length>0||n.bundles.length>0)try{const a=(await Ne.get(`https://esgst.rafaelgomes.xyz/api/games?app_ids=${n.apps.join(",")}&sub_ids=${n.subs.join(",")}&bundle_ids=${n.bundles.join(",")}`)).json;for(const e of s)e.fetched=!0;for(const n of s){if(!n.fetched)continue;const i=a.result.found[n.realType][n.realId];if(!i||i.queued_for_update)continue;const o=new Date(i.last_update).getTime();n.found=!0,n.isComplete=!0,n.dependencies=[],e.cache[n.type][n.id]=await this.fakeApi(e,s,i,n.id,n.type,o,n),"apps"===n.type&&this.fetchedApps.push(n.id),this.checkCategories(e,t,s,n)}}catch(e){dt.warning(e.message,e.stack)}}),o()(this,"fetchFromSteam",async(e,t,s,n)=>{const a=new Te("gc");await a.lock();for(const i of s)i.found||(i.fetched=!0,i.found=!0,i.isComplete=!0,i.dependencies=[],e.cache[i.type][i.id]=await this.gc_getCategories(e,n,t,i.id,i.type,s,i),"apps"===i.type&&this.fetchedApps.push(i.id),this.checkCategories(e,t,s,i),await a.update());await a.unlock()}),o()(this,"checkCategories",(e,t,s,n)=>{if(n.hasIndex)n.isComplete?(this.addCategories(e,t,n),this.updateIndexes()):this.updateIndexes(n.type,n.id);else for(const n of s)n.dependencies&&n.dependencies.length>0&&(n.dependencies=n.dependencies.filter(e=>!this.fetchedApps.includes(e)),0===n.dependencies.length&&(this.addCategories(e,t,n),this.updateIndexes()))}),o()(this,"addCategories",(e,t,s)=>{const n=e.cache[s.type][s.id];d.get("gc_dlc_b")&&n.dlc&&n.base&&e.cache.apps[n.base]&&(n.freeBase=e.cache.apps[n.base].free),this.gc_addCategory(e,e.cache[s.type][s.id],t[s.type][s.id],s.id,c.esgst.games[s.type][s.id],s.type,"apps"===s.type?e.cache.hltb:null)}),this.PRIORITIES={MISSING:0,FAILED:1,OUTDATED:2,ALMOST_OUTDATED:3},this.queueIndexes={apps:{},subs:{},total:0},this.fetchableCategories=["gc_gi","gc_lg","gc_r","gc_a","gc_sp","gc_mp","gc_sc","gc_tc","gc_l","gc_m","gc_dlc","gc_ea","gc_rm","gc_rd","gc_g","gc_p"],this.info={description:()=>Se.element("ul",null,Se.element("li",null,'Adds tags (which are called "categories" not to be confused with'," ",Se.element("span",{"data-esgst-feature-id":"gt"}),") below a game's name (in any page) that can display a lot of useful information about the game (depending on which categories you have enabled)."),Se.element("li",null,"The categories can be reordered by dragging and dropping them. You can also drag and drop them between a giveaway's columns (where the end/start times and the creator's username are)."),Se.element("li",null,"While the information is being loaded, an hourglass icon is displayed. This icon can be in different colors depending on the cache status:"),Se.element("ul",null,Se.element("li",null,Se.element("i",{className:"fa fa-hourglass fa-spin esgst-red"})," - The information is missing and will be retrieved from the server with highest priority."),Se.element("li",null,Se.element("i",{className:"fa fa-hourglass fa-spin esgst-orange"})," - The information was not successfully retrieved and it has been 24 hours since the last attempt, so another attempt will be made with high priority."),Se.element("li",null,Se.element("i",{className:"fa fa-hourglass fa-spin esgst-yellow"})," - The information is outdated (hasn't been updated in 7 days) and will be updated with low priority."),Se.element("li",null,Se.element("i",{className:"fa fa-hourglass fa-spin esgst-green"})," - The information is about to become outdated (hasn't been updated in 6 days) and will be updated with lowest priority."))),features:{gc_e:{colors:{color:"Text",bColor:"Border",bgColor:"Background"},description:()=>Se.element("ul",null,Se.element("li",null,"The enter button of giveaways will be colored with the desired color if the game cannot be checked for ownership and has one of the following categories: Banned, DLC, Learning, Package")),name:"Color enter button of giveaways if game ownership cannot be checked.",sg:!0},gc_lp_gv:{description:()=>Se.element("ul",null,Se.element("li",null,"Leaving this disabled can help prevent misclicks when using"," ",c.common.getFeatureName(null,"gv"),".")),name:"Enable category links when using [id=gv].",sg:!0},gc_b:{name:"Show the category colors as a bottom border to the giveaways in Grid View.",sg:!0},gc_il:{name:"Show the panel inline (next to the game's name instead of below it).",sg:!0},gc_a:{colors:!0,description:()=>Se.element("ul",null,Se.element("li",null,"Shows if the game has achievements."),Se.element("li",null,"If you hover over the category, it shows how many achievements the game has.")),isCategory:!0,allowCustomDisplay:!0,name:"Achievements",sg:!0},gc_bd:{colors:!0,description:()=>Se.element("ul",null,Se.element("li",null,"Shows if the game is banned on Steam.")),isCategory:!0,allowCustomDisplay:!0,name:"Banned",sg:!0,sync:"Delisted Games",syncKeys:["DelistedGames"]},gc_bvg:{colors:!0,description:()=>Se.element("ul",null,Se.element("li",null,"Links to the Barter.vg page of the game.")),isCategory:!0,allowCustomDisplay:!0,name:"Barter.vg",sg:!0},gc_dlc:{colors:!0,description:()=>Se.element("ul",null,Se.element("li",null,"Shows if the game is a DLC.")),isCategory:!0,allowCustomDisplay:!0,features:{gc_dlc_b:{description:()=>Se.element("ul",null,Se.element("li",null,"The icon ",Se.element("i",{className:"fa fa-certificate"})," will be added if the base is free, the icon ",Se.element("i",{className:"fa fa-dollar"})," will be added if it is not, and no icon will be added if the information is unavailable.")),name:"Indicate if the base game of the DLC is free.",sg:!0},gc_dlc_o:{description:()=>Se.element("ul",null,Se.element("li",null,"The same icon you use for the Owned category will be added if the base is owned.")),name:"Indicate if the base game of the DLC is owned.",sg:!0}},name:"DLC",sg:!0},gc_ea:{colors:!0,description:()=>Se.element("ul",null,Se.element("li",null,"Shows if the game is in early access.")),isCategory:!0,allowCustomDisplay:!0,name:"Early Access",sg:!0},gc_f:{colors:!0,description:()=>Se.element("ul",null,Se.element("li",null,"Shows if you have followed the game on Steam.")),isCategory:!0,allowCustomDisplay:!0,name:"Followed",sg:!0,syncKeys:["FollowedGames"]},gc_fcv:{colors:!0,description:()=>Se.element("ul",null,Se.element("li",null,"Shows if the game gives full CV when given away.")),isCategory:!0,allowCustomDisplay:!0,name:"Full CV",sg:!0},gc_g:{colors:!0,description:()=>Se.element("ul",null,Se.element("li",null,"Shows the official genres of the game."),Se.element("li",null,'The genres/user-defined tags are listed in the same category, separated by a comma. If they exceed a certain width, a "..." is added and the rest is hidden (they can be seen by hovering over the category).')),isCategory:!0,features:{gc_g_s:{description:()=>Se.element("ul",null,Se.element("li",null,"With this option enabled, each genre/user-defined tag will have its own category instead of all of them being listed in the same one."),Se.element("li",null,"This option allows each separate category to be colored individually.")),name:"Show each genre/user-defined tag as a separate category.",sg:!0},gc_g_udt:{description:()=>Se.element("ul",null,Se.element("li",null,"Shows the user-defined tags that the game has in addition to the official genres.")),name:"User-Defined Tags",sg:!0}},name:"Genres",sg:!0},gc_gi:{colors:!0,description:()=>Se.element("ul",null,Se.element("li",null,"Shows how many giveaways you have already made for the game and how much real CV you should get for a new giveaway.")),isCategory:!0,name:"Giveaway Info",sg:!0},gc_h:{colors:!0,description:()=>Se.element("ul",null,Se.element("li",null,"Shows if you have hidden the game on SteamGifts.")),isCategory:!0,allowCustomDisplay:!0,name:"Hidden",sg:!0},gc_hltb:{colors:!0,description:()=>Se.element("ul",null,Se.element("li",null,"Shows how long it takes on average to beat the game based on HowLongToBeat.")),isCategory:!0,allowCustomDisplay:!0,options:[{title:"For singleplayer games, show:",values:["Main Story","Main + Extra","Completionist"]},{title:"For multiplayer games, show:",values:["Co-Op","Vs."]},{title:"For singleplayer/multiplayer games, show:",values:["Solo","Co-Op","Vs."]}],name:"HLTB",sg:!0,sync:"HLTB Times",syncKeys:["HltbTimes"]},gc_i:{colors:!0,description:()=>Se.element("ul",null,Se.element("li",null,"Shows if you have ignored the game on Steam.")),isCategory:!0,allowCustomDisplay:!0,features:{gc_i_t:{background:!0,name:"Color the table row in tables.",sg:!0}},name:"Ignored",sg:!0},gc_lg:{colors:!0,description:()=>Se.element("ul",null,Se.element("li",null,"Shows if Steam is learning about the game.")),isCategory:!0,allowCustomDisplay:!0,name:"Learning",sg:!0},gc_l:{colors:!0,description:()=>Se.element("ul",null,Se.element("li",null,"Shows if the game is compatible with Linux.")),isCategory:!0,allowCustomDisplay:!0,name:"Linux",sg:!0},gc_m:{colors:!0,description:()=>Se.element("ul",null,Se.element("li",null,"Shows if the game is compatible with Mac.")),isCategory:!0,allowCustomDisplay:!0,name:"Mac",sg:!0},gc_mp:{colors:!0,description:()=>Se.element("ul",null,Se.element("li",null,"Shows if the game is multiplayer.")),isCategory:!0,allowCustomDisplay:!0,name:"Multiplayer",sg:!0},gc_ncv:{colors:!0,description:()=>Se.element("ul",null,Se.element("li",null,"Shows if the game gives no CV when given away."),Se.element("li",null,"If you hover over the category, it shows the date since it gives no CV.")),isCategory:!0,allowCustomDisplay:!0,features:{gc_ncv_o:{name:'Only display "No CV" if the game also has "Reduced CV".',sg:!0}},name:"No CV",sg:!0},gc_o:{colors:!0,description:()=>Se.element("ul",null,Se.element("li",null,"Shows if you own the game.")),isCategory:!0,allowCustomDisplay:!0,features:{gc_o_a:{isCategory:!0,features:{gc_o_a_t:{background:!0,name:"Color the table row in tables.",sg:!0}},name:"Show if you own the game in any of your alt accounts.",sg:!0},gc_o_t:{background:!0,name:"Color the table row in tables.",sg:!0},gc_o_pw:{name:"Do not show if the game already has the Previously Won category.",sg:!0}},name:"Owned",sg:!0},gc_ocv:{colors:{fcv_color:"Text (if the game was full CV)",rcv_color:"Text (if the game was reduced CV)",fcv_bgColor:"Background (if the game was full CV)",rcv_bgColor:"Background (if the game was reduced RCV)"},description:()=>Se.element("ul",null,Se.element("li",null,"Shows the original CV state of a game when it was given away."),Se.element("li",null,"This category borrows labels / icons from the Full CV, Reduced CV and No CV categories, and adds its own label / icon before the borrowed ones to differentiate them.")),isCategory:!0,allowCustomDisplay:!0,name:"Original CV",sg:!0},gc_p:{colors:!0,description:()=>Se.element("ul",null,Se.element("li",null,"Shows if the game is a package."),Se.element("li",null,"If you hover over the category, it shows how many items are contained in the package.")),isCategory:!0,allowCustomDisplay:!0,features:{gc_p_t:{background:!0,name:"Color the table row in tables if you own some of the games in the package.",sg:!0}},name:"Package",sg:!0},gc_pw:{colors:!0,description:()=>Se.element("ul",null,Se.element("li",null,"Shows if you have previously won the game.")),isCategory:!0,allowCustomDisplay:!0,features:{gc_pw_o:{name:"Do not show if the game already has the Owned category.",sg:!0}},name:"Previously Won",sg:!0},gc_r:{description:()=>Se.element("ul",null,Se.element("li",null,"Shows the overall rating that the game has on Steam.")),isCategory:!0,features:{gc_r_s:{name:"Show the percentage and number of reviews next to the icon.",sg:!0}},name:"Rating",sg:!0},gc_rcv:{colors:!0,description:()=>Se.element("ul",null,Se.element("li",null,"Shows if the game gives reduced CV when given away."),Se.element("li",null,"If you hover over the category, it shows the date since it gives reduced CV.")),isCategory:!0,allowCustomDisplay:!0,name:"Reduced CV",sg:{include:[{enabled:1,pattern:".*"}],exclude:[{enabled:1,pattern:"^/bundle-games"}]}},gc_rd:{description:()=>Se.element("ul",null,Se.element("li",null,"Shows the release date of the game."),Se.element("li",null,'If the game has no release date, a "?" will be shown instead.')),isCategory:!0,colors:!0,name:"Release Date",sg:!0},gc_rm:{colors:!0,description:()=>Se.element("ul",null,Se.element("li",null,"Shows if the game has been removed from the Steam store.")),isCategory:!0,allowCustomDisplay:!0,name:"Removed",sg:!0},gc_sp:{colors:!0,description:()=>Se.element("ul",null,Se.element("li",null,"Shows if the game is singleplayer.")),isCategory:!0,allowCustomDisplay:!0,name:"Singleplayer",sg:!0},gc_sc:{colors:!0,description:()=>Se.element("ul",null,Se.element("li",null,"Shows if the game has Steam Cloud.")),isCategory:!0,allowCustomDisplay:!0,name:"Steam Cloud",sg:!0},gc_tc:{colors:!0,description:()=>Se.element("ul",null,Se.element("li",null,"Shows if the game has trading cards.")),isCategory:!0,allowCustomDisplay:!0,name:"Trading Cards",sg:!0},gc_w:{colors:!0,description:()=>Se.element("ul",null,Se.element("li",null,"Shows if you have wishlisted the game on Steam."),Se.element("li",null,"If you hover over the category, it shows the date when you added the game to your wishlist.")),isCategory:!0,allowCustomDisplay:!0,features:{gc_w_t:{background:!0,name:"Color the table row in tables.",sg:!0}},name:"Wishlisted",sg:!0}},id:"gc",name:"Game Categories",sg:!0,sync:"Owned/Wishlisted/Ignored Games, Giveaways, Hidden Games, No CV Games, Reduced CV Games",syncKeys:["Games","Giveaways","HiddenGames","NoCvGames","ReducedCvGames"],type:"games"}}isFetchableEnabled(){for(const e of this.fetchableCategories)if(d.get(e))return!0;return!1}async init(){this.isFetchableEnabled()&&!await ut.contains([["server"],["steamStore"]])||(c.esgst.gameFeatures.push(this.gc_games.bind(this)),c.esgst.gcToFetch={apps:{},subs:{}})}gc_games(e,t,s,n){this.gc_getGames(e,t,s,n)}async gc_getGames(e,t,s,n,a){let i={apps:Object.keys(e.apps).filter(e=>!e.startsWith("Humble")),cache:{apps:{},subs:{}},subs:Object.keys(e.subs).filter(e=>!e.startsWith("Humble"))};for(const t of i.apps)if(e.apps.hasOwnProperty(t)){let s=e.apps[t];for(let e=0,t=s.length;e<t;++e){let t=s[e];t.container.classList.contains("esgst-hidden")||t.container.getElementsByClassName("esgst-gc-panel")[0]||(t.container.closest(".poll")?Se.insert(t.container.getElementsByClassName("table__column__heading")[0],"afterend",Se.element("div",{className:"esgst-gc-panel"},Se.element("span",{className:"esgst-gc-loading",title:"This game is queued for fetching"},Se.element("i",{className:"fa fa-hourglass fa-spin"}),Se.element("span",null)))):Se.insert(t.heading,"afterend",Se.element("div",{className:"esgst-gc-panel"},Se.element("span",{className:"esgst-gc-loading",title:"This game is queued for fetching"},Se.element("i",{className:"fa fa-hourglass fa-spin"}),Se.element("span",null)))))}}for(const t of i.subs)if(e.subs.hasOwnProperty(t)){let s=e.subs[t];for(let e=0,t=s.length;e<t;++e){let t=s[e];t.container.classList.contains("esgst-hidden")||t.container.getElementsByClassName("esgst-gc-panel")[0]||(t.container.closest(".poll")?Se.insert(t.container.getElementsByClassName("table__column__heading")[0],"afterend",Se.element("div",{className:"esgst-gc-panel"},Se.element("span",{className:"esgst-gc-loading",title:"This game is queued for fetching"},Se.element("i",{className:"fa fa-hourglass fa-spin"}),Se.element("span",null)))):Se.insert(t.heading,"afterend",Se.element("div",{className:"esgst-gc-panel"},Se.element("span",{className:"esgst-gc-loading",title:"This game is queued for fetching"},Se.element("i",{className:"fa fa-hourglass fa-spin"}),Se.element("span",null)))))}}for(const t of i.apps)this.gc_addCategory(i,null,e.apps[t],t,c.esgst.games.apps[t],"apps",i.cache.hltb,this.isFetchableEnabled());for(const t of i.subs)this.gc_addCategory(i,null,e.subs[t],t,c.esgst.games.subs[t],"subs",null,this.isFetchableEnabled());const o=rt.findData(null,"giveaways");for(const e of o)this.gc_addBorders(e);let g=[];if(this.isFetchableEnabled()){i.cache=JSON.parse(r.get("gcCache",'{ "apps": {}, "subs": {}, "hltb": {}, "timestamp": 0, "version": 7 }')),7!==i.cache.version&&(i.cache={apps:{},subs:{},hltb:i.cache.hltb,timestamp:0,version:7}),i.cache.hltb||(i.cache.hltb={});const t=Date.now();for(const s in i.cache.apps){if(!i.cache.apps.hasOwnProperty(s))continue;let n;if(i.cache.apps[s].lastCheck){if(i.apps.indexOf(s)>-1)if(t-i.cache.apps[s].lastCheck>6048e5)n=this.PRIORITIES.OUTDATED;else if(t-i.cache.apps[s].lastCheck>5184e5)n=this.PRIORITIES.ALMOST_OUTDATED;else{if(l.isSet(i.cache.apps[s].learning)||i.cache.apps[s].removed&&-1!==i.cache.apps[s].removed||!(t-i.cache.apps[s].lastCheck>864e5)){this.gc_addCategory(i,i.cache.apps[s],e.apps[s],s,c.esgst.games.apps[s],"apps",i.cache.hltb);continue}n=this.PRIORITIES.FAILED}else if(t-i.cache.apps[s].lastCheck>2592e6){delete i.cache.apps[s];continue}}else i.cache.apps[s].lastCheck=t,n=this.PRIORITIES.FAILED;e.apps[s]&&e.apps[s].filter(e=>!e.container.classList.contains("esgst-hidden"))[0]&&(n>=this.PRIORITIES.OUTDATED&&this.gc_addCategory(i,i.cache.apps[s],e.apps[s],s,c.esgst.games.apps[s],"apps",i.cache.hltb,!1,!0),g.push({id:s,lastCheck:i.cache.apps[s].lastCheck,priority:n,type:"apps",hasIndex:!0}))}for(const s in i.cache.subs){if(!i.cache.subs.hasOwnProperty(s))continue;let n;if(i.cache.subs[s].lastCheck){if(i.subs.indexOf(s)>-1)if(t-i.cache.subs[s].lastCheck>6048e5)n=this.PRIORITIES.OUTDATED;else{if(!(t-i.cache.subs[s].lastCheck>5184e5)){this.gc_addCategory(i,i.cache.subs[s],e.subs[s],s,c.esgst.games.subs[s],"subs",i.cache.hltb);continue}n=this.PRIORITIES.ALMOST_OUTDATED}else if(t-i.cache.subs[s].lastCheck>2592e6){delete i.cache.subs[s];continue}}else i.cache.subs[s].lastCheck=t,n=this.PRIORITIES.FAILED;e.subs[s]&&e.subs[s].filter(e=>!e.container.classList.contains("esgst-hidden"))[0]&&(n>=this.PRIORITIES.OUTDATED&&this.gc_addCategory(i,i.cache.subs[s],e.subs[s],s,c.esgst.games.subs[s],"subs",i.cache.hltb,!1,!0),g.push({id:s,lastCheck:i.cache.subs[s].lastCheck,priority:n,type:"subs",hasIndex:!0}))}r.set("gcCache",JSON.stringify(i.cache));for(const e of i.apps)i.cache.apps[e]||g.push({id:e,lastCheck:0,priority:this.PRIORITIES.MISSING,type:"apps",hasIndex:!0});for(const e of i.subs)i.cache.subs[e]||g.push({id:e,lastCheck:0,priority:this.PRIORITIES.MISSING,type:"subs",hasIndex:!0});g=g.sort((e,t)=>e.priority<t.priority?-1:e.priority>t.priority?1:e.lastCheck<t.lastCheck?-1:e.lastCheck>t.lastCheck?1:0);for(const t of g){if(!e[t.type][t.id])continue;this.queueIndexes[t.type][t.id]=this.queueIndexes.total;let s=!1;for(const n of e[t.type][t.id]){const e=n.container.getElementsByClassName("esgst-gc-panel")[0];if(e&&!e.getAttribute("data-gcReady")){const n=e.getElementsByClassName("esgst-gc-loading")[0];if(n){let e;switch(n.setAttribute("data-esgst-to-fetch",!0),n.title="This game is queued for fetching (the number indicates its queue position)",t.priority){case this.PRIORITIES.MISSING:e="red";break;case this.PRIORITIES.FAILED:e="orange";break;case this.PRIORITIES.OUTDATED:e="yellow";break;case this.PRIORITIES.ALMOST_OUTDATED:e="green"}n.firstElementChild.classList.add("esgst-"+e),n.lastElementChild.textContent=" "+this.queueIndexes[t.type][t.id],s=!0}}}s&&(this.queueIndexes.total+=1)}g.length>0&&(this.fetchedApps=[],await this.fetchFromServer(i,e,g),await this.fetchFromServer(i,e,g),await this.fetchFromSteam(i,e,g,t),await this.fetchFromServer(i,e,g),await this.fetchFromSteam(i,e,g,t),await Tn(c.esgst.games),r.set("gcCache",JSON.stringify(i.cache)))}let u=["achievements","dlc","dlcOwned","dlcFree","dlcNonFree","genres","hltb","linux","mac","singleplayer","multiplayer","package","rating","reviews","learning","removed","banned","steamCloud","tradingCards","earlyAccess","releaseDate"];const m=rt.findData(null,["giveaways","games"]),h=m.giveaways.concat(m.games.map(e=>e.game));for(const e of h){const t=e.outerWrap.querySelector(".esgst-gc-loading:not([data-esgst-to-fetch])");if(t&&t.remove(),!e.gcReady&&e.outerWrap.querySelector("[data-gcReady]")&&!e.outerWrap.classList.contains("esgst-hidden")){for(let t=0,s=u.length;t<s;++t){let s=u[t],n=e.outerWrap.getElementsByClassName("esgst-gc-"+("reviews"===s?"rating":s))[0];n?"releaseDate"===s?(e.releaseDate=n.getAttribute("data-timestamp"),"?"===e.releaseDate?e.releaseDate=-1:e.releaseDate=1e3*parseInt(e.releaseDate)):"genres"===s?n.children.length?e.genres=Array.from(n.children).map(e=>e.title.trim().toLowerCase()):e.genres=n.textContent.toLowerCase().trim().replace(/\s{2,}/g,", ").split(/,\s*/):"rating"===s?(e.rating=parseInt(n.title.match(/(\d+)%/)[1]),e.ratingQuantity=parseInt((n.title.match(/\((.+?)\)/)[1]||"0").replace(",",""))):"reviews"===s?e.reviews=parseInt(n.title.match(/\((.+?)\)/)[1].replace(/[^\d]/g,"")):e[s]=!0:"rating"===s?(e.rating=-1,e.ratingQuantity=0):"releaseDate"===s?e.releaseDate=-1:"reviews"===s&&(e.reviews=-1)}e.isGame||this.gc_addBorders(e),e.gcReady=!0}}a||(t&&c.esgst.gf&&c.esgst.gf.filteredCount&&d.get("gf_enable"+c.esgst.gf.type)&&c.esgst.modules.giveawaysGiveawayFilters.filters_filter(c.esgst.gf,!1,n),!t&&c.esgst.gfPopup&&c.esgst.gfPopup.filteredCount&&d.get("gf_enable"+c.esgst.gfPopup.type)&&c.esgst.modules.giveawaysGiveawayFilters.filters_filter(c.esgst.gfPopup),t&&c.esgst.gmf&&c.esgst.gmf.filteredCount&&d.get("gmf_enable"+c.esgst.gmf.type)&&c.esgst.modules.gamesGameFilters.filters_filter(c.esgst.gmf,!1,n))}gc_addBorders(e){if(e.outerWrap.classList.contains("esgst-hidden")||!e.grid||!d.get("gc_b"))return;let t=e.outerWrap.getElementsByClassName("esgst-gc-border")[0];t?t.innerHTML="":t=Sn(e.outerWrap,"beforeend",[{attributes:{class:"esgst-gc-border"},type:"div"}]);const s={gc_ocv:"originalCV",gc_fcv:"fullCV",gc_rcv:"reducedCV",gc_ncv:"noCV",gc_h:"hidden",gc_i:"ignored",gc_o:"owned",gc_w:"wishlisted",gc_f:"followed",gc_pw:"won",gc_a:"achievements",gc_bd:"banned",gc_sp:"singleplayer",gc_mp:"multiplayer",gc_sc:"steamCloud",gc_tc:"tradingCards",gc_l:"linux",gc_m:"mac",gc_ea:"earlyAccess",gc_lg:"learning",gc_rm:"removed",gc_dlc:"dlc",gc_p:"package"};for(const n of d.get("gc_categories_gv")){const a=s[n];a&&e.innerWrap.getElementsByClassName("esgst-gc-"+a)[0]&&Sn(t,"beforeend",[{attributes:{class:"esgst-gc-"+a},type:"div"}])}}async gc_fakeBundle(e){const t=e.replace(/^SteamBundle/,""),s=await Ne.get(`https://store.steampowered.com/bundle/${t}?cc=us&l=english`,{headers:{"Esgst-Cookie":"birthtime=0; mature_content=1; "}});return{[e]:{success:!0,data:{apps:Array.from(s.html.querySelectorAll("[data-ds-appid]")).map(e=>({id:parseInt(e.getAttribute("data-ds-appid"))})),name:s.html.querySelector(".pageheader").textContent,platforms:{}}}}}async fakeApi(e,t,s,n,a,i,o){const r={achievements:s.achievements||0,base:s.base,dlc:s.base?1:0,dlcs:s.dlcs,earlyAccess:s.genres&&s.genres.indexOf("Early Access")>=0?1:0,free:0===s.price,genres:"",lastCheck:i,learning:l.isSet(s.learning)?s.learning?1:0:null,linux:s.linux?1:0,mac:s.mac?1:0,multiplayer:s.multiplayer?1:0,name:s.name,price:Math.ceil(s.price/100),rating:s.rating?`${s.rating.percentage}% (${s.rating.count})`:"",ratingType:"",releaseDate:s.release_date?new Date(s.release_date).getTime():"?",removed:s.removed?1:0,singleplayer:s.singleplayer?1:0,steamCloud:s.steam_cloud?1:0,tags:"",tradingCards:s.trading_cards?1:0};if(s.alias&&(c.esgst.games[a][n]||(c.esgst.games[a][n]={}),c.esgst.games[a][n].alias=s.alias),"apps"===a&&s.subs&&(c.esgst.games.apps[n]||(c.esgst.games.apps[n]={}),c.esgst.games.apps[n].subs=null,c.esgst.games.apps[n].packages=s.subs),"subs"===a&&s.apps){c.esgst.games.subs[n]||(c.esgst.games.subs[n]={}),c.esgst.games.subs[n].apps=s.apps;for(const s of c.esgst.games.subs[n].apps)!o.hasIndex||e.cache.apps[s]||t.filter(e=>"apps"===e.type&&e.id==s)[0]||(o.isComplete=!1,o.dependencies.push(s),t.push({id:s,lastCheck:0,priority:this.PRIORITIES.MISSING,type:"apps"}))}return s.genres&&(s.genres.sort((e,t)=>e.localeCompare(t,{sensitivity:"base"})),r.genres=s.genres.join(", ")),s.tags&&(s.tags.sort((e,t)=>e.localeCompare(t,{sensitivity:"base"})),r.tags=s.tags.join(", ")),s.rating?s.rating.percentage<40?r.ratingType="Negative":s.rating.percentage<70?r.ratingType="Mixed":r.ratingType="Positive":r.ratingType="?","apps"===a&&!r.removed&&c.esgst.delistedGames.removed.indexOf(parseInt(n))>=0&&(r.removed=1),d.get("gc_dlc_b")&&r.dlc&&r.base&&(e.cache.apps[r.base]&&(r.freeBase=e.cache.apps[r.base].free),o.hasIndex&&void 0===r.freeBase&&!t.filter(e=>"apps"===e.type&&e.id==r.base)[0]&&(o.isComplete=!1,o.dependencies.push(r.base),t.push({id:r.base,lastCheck:0,priority:this.PRIORITIES.MISSING,type:"apps"}))),r}async gc_getCategories(e,t,s,n,a,i,o){if(o.hasIndex&&s[a][n])for(const e of s[a][n]){const t=e.container.getElementsByClassName("esgst-gc-panel")[0];if(t&&!t.getAttribute("data-gcReady")){const e=t.getElementsByClassName("esgst-gc-loading")[0];e&&(e.title="Fetching game categories...",e.firstElementChild.classList.remove("fa-hourglass"),e.firstElementChild.classList.add("fa-circle-o-notch"),e.lastElementChild.textContent="")}}let r={achievements:0,dlc:0,earlyAccess:0,genres:"",lastCheck:t,learning:null,linux:0,mac:0,multiplayer:0,name:"",price:-1,rating:"",ratingType:"",releaseDate:"?",removed:-1,singleplayer:0,steamCloud:0,tags:"",tradingCards:0};try{let t,s="string"==typeof n&&n.match(/^SteamBundle/)?await this.gc_fakeBundle(n):(await Ne.get(`https://store.steampowered.com/api/${"apps"===a?"appdetails?appids=":"packagedetails?packageids="}${n}&filters=achievements,apps,basic,categories,genres,name,packages,platforms,price,price_overview,release_date&cc=us&l=english`,{anon:!0})).json;if(s&&s[n]&&(t=s[n].data,t)){if(t.steam_appid&&n!=t.steam_appid&&(c.esgst.games[a][n]||(c.esgst.games[a][n]={}),c.esgst.games[a][n].alias=t.steam_appid),"apps"===a&&t.packages&&(c.esgst.games.apps[n]||(c.esgst.games.apps[n]={}),c.esgst.games.apps[n].subs=null,c.esgst.games.apps[n].packages=t.packages.map(e=>parseInt(e))),"subs"===a&&t.apps){c.esgst.games.subs[n]||(c.esgst.games.subs[n]={}),c.esgst.games.subs[n].apps=t.apps.map(e=>parseInt(e.id));for(const t of c.esgst.games.subs[n].apps)!o.hasIndex||e.cache.apps[t]||i.filter(e=>"apps"===e.type&&e.id==t)[0]||(o.isComplete=!1,o.dependencies.push(t),i.push({id:t,lastCheck:0,priority:this.PRIORITIES.MISSING,type:"apps"}))}if(t.categories)for(let e=0,s=t.categories.length;e<s;++e)switch(t.categories[e].description.toLowerCase()){case"steam achievements":r.achievements=1;break;case"single-player":r.singleplayer=1;break;case"multi-player":case"online multi-player":case"co-op":case"local co-op":case"online co-op":case"shared/split screen":r.multiplayer=1;break;case"steam cloud":r.steamCloud=1;break;case"steam trading cards":r.tradingCards=1}r.achievements&&t.achievements&&t.achievements.total&&(r.achievements=t.achievements.total),r.free=!!t.is_free,r.dlc="dlc"===t.type?1:0,r.dlc&&t.fullgame&&t.fullgame.appid?r.base=parseInt(t.fullgame.appid):t.dlc&&(r.dlcs=t.dlc);let s=[];if(t.genres)for(let e=0,n=t.genres.length;e<n;++e)s.push(t.genres[e].description.trim());s.sort((e,t)=>e.localeCompare(t,{sensitivity:"base"})),r.earlyAccess=s.indexOf("Early Access")>=0?1:0,r.genres=s.join(", ");let l=t.platforms;r.linux=l.linux?1:0,r.mac=l.mac?1:0,r.name=t.name;let d=t.price||t.price_overview;r.price=d?"USD"===d.currency?Math.ceil(d.initial/100):-1:0,t.release_date&&t.release_date.date&&(r.releaseDate=new Date(t.release_date.date).getTime())}if(("string"!=typeof n||!n.match(/^SteamBundle/))&&(d.get("gc_lg")||d.get("gc_r")||d.get("gc_rm")||d.get("gc_g_udt")))if(d.get("gc_rm")&&!d.get("gc_lg")&&!d.get("gc_r")&&!d.get("gc_g_udt")&&"apps"===a&&c.esgst.delistedGames.removed.indexOf(parseInt(n))>-1)r.removed=1;else{let e=await Ne.get(`https://store.steampowered.com/${a.slice(0,-1)}/${n}?cc=us&l=english`,{headers:{"Esgst-Cookie":"birthtime=0; mature_content=1; "}}),t=e.html;if(e.url.match(n)){const e=t.querySelector("#userReviews .user_reviews_summary_row:last-child");if(e){let t=e.getAttribute("data-tooltip-html").replace(/[,.]/g,""),s=t.match(/(\d+)%.+?(\d+)/),n=1,a=2;s||(s=t.match(/(\d+).+?(\d+)%/),n=2,a=1),s&&(r.rating=`${s[n]}% (${s[a]})`,t=parseInt(s[n]),r.ratingType=t>=0?t<40?"Negative":t<70?"Mixed":"Positive":"?")}r.removed=0;let s=[];const n=t.querySelectorAll("a.app_tag");for(let e=0,t=n.length;e<t;++e)s.push(n[e].textContent.trim());s.sort((e,t)=>e.localeCompare(t,{sensitivity:"base"})),r.tags=s.join(", "),t.querySelector(".learning_about")?r.learning=1:r.learning=0}else r.removed=1}d.get("gc_dlc_b")&&r.dlc&&r.base&&(e.cache.apps[r.base]&&(r.freeBase=e.cache.apps[r.base].free),o.hasIndex&&void 0===r.freeBase&&!i.filter(e=>"apps"===e.type&&e.id==r.base)[0]&&(o.isComplete=!1,o.dependencies.push(appId),i.push({id:r.base,lastCheck:0,priority:this.PRIORITIES.MISSING,type:"apps"})))}catch(e){if(dt.warning(e.message,e.stack),o.hasIndex&&s[a][n])for(const e of s[a][n]){const t=e.container.getElementsByClassName("esgst-gc-panel")[0];if(t&&!t.getAttribute("data-gcReady")){d.get("gc_il")&&!c.esgst.giveawayPath&&(t.previousElementSibling.style.display="inline-block",t.classList.add("esgst-gc-panel-inline"));const e=t.getElementsByClassName("esgst-gc-loading")[0];e&&e.remove(),Sn(t,"beforeend",[{attributes:{class:"esgst-bold esgst-red"},type:"span",children:[{attributes:{class:"fa fa-exclamation",title:"An error happened while loading game categories."},type:"i"}]}])}}}return r}updateIndexes(e,t){if(this.queueIndexes.total>0){const s=t?this.queueIndexes[e][t]:-1;for(const e in this.queueIndexes.apps)this.queueIndexes.apps[e]>0?(!t||this.queueIndexes.apps[e]>s)&&(this.queueIndexes.apps[e]-=1):delete this.queueIndexes.apps[e];for(const e in this.queueIndexes.subs)this.queueIndexes.subs[e]>0?(!t||this.queueIndexes.subs[e]>s)&&(this.queueIndexes.subs[e]-=1):delete this.queueIndexes.subs[e];t?this.queueIndexes[e][t]=this.queueIndexes.total-1:this.queueIndexes.total-=1}const s=rt.findData("current","games");for(const e of s){const t=e.game.container.getElementsByClassName("esgst-gc-panel")[0];if(t&&!t.getAttribute("data-gcReady")){const s=t.getElementsByClassName("esgst-gc-loading")[0];s&&s.lastElementChild&&(s.lastElementChild.textContent=" "+(this.queueIndexes[e.type][e.code]||""))}}}gc_checkPackage(e){const t={num:0,total:e.apps.length};for(const s of e.apps){const n=c.esgst.games.apps[s];n&&((n.owned||n.alias&&l.getProperty(c.esgst.games.apps,[n.alias,"owned"]))&&(t.num+=1),e.wishlisted||(e.wishlisted=n.wishlisted||n.alias&&l.getProperty(c.esgst.games.apps,[n.alias,"wishlisted"])))}return t.num===t.total&&(e.owned=!0),t}gc_addCategory(e,t,s,n,a,i,o,r,g){if(!s)return;let u,m,h,p,f,b,w,y,v,_,k,x,A,C,S,E,T,N,P,L,I,B,D=null;a&&(a=Object.assign({},a),"apps"===i?(!a.owned&&a.alias&&l.getProperty(c.esgst.games.apps,[a.alias,"owned"])&&(a.owned=!0),!a.wishlisted&&a.alias&&l.getProperty(c.esgst.games.apps,[a.alias,"wishlisted"])&&(a.wishlisted=!0)):"subs"===i&&a.apps&&(D=this.gc_checkPackage(a))),L=i.slice(0,-1);const G="string"==typeof n?n.replace(/^SteamBundle/,""):n;"string"==typeof n&&n.match(/^SteamBundle/)&&(L="bundle"),N=t?t.name:s[0].name,b=encodeURIComponent(N.replace(/\.\.\.$/,""));const q={steamId:d.get("steamId"),username:d.get("username"),gameType:L,gameId:G,gameName:N,gameSearchName:b,hltbId:o&&o[n]&&o[n].id};f=[];let R=c.esgst.gc_categories_ids;for(A=0,E=R.length;A<E;++A)if(m=R[A],d.get(m))switch(m){case"gc_fcv":(!a||a.reducedCV||a.noCV)&&a||f.push({attributes:{class:"esgst-gc esgst-gc-fullCV","data-draggable-id":"gc_fcv",href:this.replacePlaceholders(d.get("gc_fcvUrl"),q),title:En("gc_fcv","Full CV")},text:d.get("gc_fcv_s")?d.get("gc_fcv_s_i")?"":"FCV":d.get("gc_fcvLabel"),type:"a",children:d.get("gc_fcv_s")&&d.get("gc_fcv_s_i")?[{attributes:{class:"fa fa-"+d.get("gc_fcvIcon")},type:"i"}]:null});break;case"gc_rcv":!a||!a.reducedCV||d.get("gc_ncv_o")&&a.noCV||f.push({attributes:{class:"esgst-gc esgst-gc-reducedCV","data-draggable-id":"gc_rcv",href:this.replacePlaceholders(d.get("gc_rcvUrl"),q),title:En("gc_rcv","Reduced CV since "+a.reducedCV)},text:d.get("gc_rcv_s")?d.get("gc_rcv_s_i")?"":"RCV":d.get("gc_rcvLabel"),type:"a",children:d.get("gc_rcv_s")&&d.get("gc_rcv_s_i")?[{attributes:{class:"fa fa-"+d.get("gc_rcvIcon")},type:"i"}]:null});break;case"gc_ncv":a&&a.noCV&&f.push({attributes:{class:"esgst-gc esgst-gc-noCV","data-draggable-id":"gc_ncv",href:this.replacePlaceholders(d.get("gc_ncvUrl"),q),title:En("gc_ncv","No CV since "+a.noCV)},text:d.get("gc_ncv_s")?d.get("gc_ncv_s_i")?"":"NCV":d.get("gc_ncvLabel"),type:"a",children:d.get("gc_ncv_s")&&d.get("gc_ncv_s_i")?[{attributes:{class:"fa fa-"+d.get("gc_ncvIcon")},type:"i"}]:null});break;case"gc_hltb":if(x={mainStory:0,mainExtra:0,completionist:0,solo:0,coOp:0,vs:0},a&&a.apps&&e.cache.hltb){for(const t of a.apps)e.cache.hltb[t]&&(x.mainStory+=parseFloat(e.cache.hltb[t].mainStory||0),x.mainExtra+=parseFloat(e.cache.hltb[t].mainExtra||0),x.completionist+=parseFloat(e.cache.hltb[t].completionist||0),x.solo+=parseFloat(e.cache.hltb[t].solo||0),x.coOp+=parseFloat(e.cache.hltb[t].coOp||0),x.vs+=parseFloat(e.cache.hltb[t].vs||0));x.mainStory=isNaN(x.mainStory)?"- ":x.mainStory+"h",x.mainExtra=isNaN(x.mainExtra)?"- ":x.mainExtra+"h",x.completionist=isNaN(x.completionist)?"- ":x.completionist+"h",x.solo=isNaN(x.solo)?"- ":x.solo+"h",x.coOp=isNaN(x.coOp)?"- ":x.coOp+"h",x.vs=isNaN(x.vs)?"- ":x.vs+"h"}else x=o&&o[n];if(x){let e="";if(x.mainStory&&x.mainExtra&&x.completionist)switch(d.get("gc_hltb_index_0")){case 0:e=x.mainStory;break;case 1:e=x.mainExtra;break;case 2:e=x.completionist}else if(x.solo&&x.coOp&&x.vs)switch(d.get("gc_hltb_index_2")){case 0:e=x.solo;break;case 1:e=x.coOp;break;case 2:e=x.vs}else if(x.coOp&&x.vs)switch(d.get("gc_hltb_index_1")){case 0:e=x.coOp;break;case 1:e=x.vs}else e=x.mainStory||x.mainExtra||x.completionist||x.solo||x.coOp||x.vs;if(e){let t="Average time to beat based on HowLongToBeat: \n\n";x.mainStory&&(t+=`Main Story: ${x.mainStory}\n`),x.mainExtra&&(t+=`Main + Extra: ${x.mainExtra}\n`),x.completionist&&(t+=`Completionist: ${x.completionist}\n`),x.solo&&(t+=`Solo: ${x.solo}\n`),x.coOp&&(t+=`Co-Op: ${x.coOp}\n`),x.vs&&(t+=`Vs.: ${x.vs}\n`),f.push({attributes:{class:"esgst-gc esgst-gc-hltb","data-draggable-id":"gc_hltb",href:this.replacePlaceholders(d.get("gc_hltbUrl"),q),title:En("gc_hltb",t)},type:"a",children:[d.get("gc_hltb_s")&&d.get("gc_hltb_s_i")?{attributes:{class:"fa fa-"+d.get("gc_hltbIcon")},type:"i"}:null,{text:`${d.get("gc_hltb_s")?d.get("gc_hltb_s_i")?"":"HLTB:":d.get("gc_hltbLabel")} ${e}`,type:"node"}]})}}break;case"gc_h":a&&a.hidden&&f.push({attributes:{class:"esgst-gc esgst-gc-hidden","data-draggable-id":"gc_h",href:this.replacePlaceholders(d.get("gc_hUrl"),q),title:En("gc_h","Hidden")},text:d.get("gc_h_s")?d.get("gc_h_s_i")?"":"H":d.get("gc_hLabel"),type:"a",children:d.get("gc_h_s")&&d.get("gc_h_s_i")?[{attributes:{class:"fa fa-"+d.get("gc_hIcon")},type:"i"}]:null});break;case"gc_i":if(h=0,a&&a.apps)for(const e of a.apps)c.esgst.games.apps[e]&&c.esgst.games.apps[e].ignored&&(h+=1);if(h=h?` (${h})`:"",(a&&a.ignored||h)&&(f.push({attributes:{class:"esgst-gc esgst-gc-ignored","data-draggable-id":"gc_i",href:this.replacePlaceholders(d.get("gc_iUrl"),q),title:En("gc_i","Ignored"+h)},text:d.get("gc_i_s")?d.get("gc_i_s_i")?"":"I"+h:`${d.get("gc_iLabel")}${h}`,type:"a",children:d.get("gc_i_s")&&d.get("gc_i_s_i")?[{attributes:{class:`fa fa-${d.get("gc_iIcon")} `},type:"i"},h?{text:h,type:"node"}:null]:null}),d.get("gc_i_t")))for(const e of s){const t=e.container.closest("tr");t&&(t.style.backgroundColor=d.get("gc_i_t_bgColor"))}break;case"gc_o":if(d.get("gc_o_a"))for(const e of d.get("gc_o_altAccounts")){let t=e.games[i][n];if(t&&t.owned&&(f.push({attributes:{class:"esgst-gc esgst-gc-owned","data-bgColor":e.bgColor,"data-color":e.color,"data-draggable-id":"gc_o",href:this.replacePlaceholders(d.get("gc_o_aUrl"),{...q,steamId:e.steamId}),style:`background-color: ${e.bgColor}; color: ${e.color};`,title:En("gc_o","Owned by "+e.name)},text:d.get("gc_o_s")?d.get("gc_o_s_i")?"":"O":e.label,type:"a",children:d.get("gc_o_s")&&d.get("gc_o_s_i")?[{attributes:{class:"fa fa-"+e.icon},type:"i"}]:null}),d.get("gc_o_a_t")))for(const e of s){const t=e.container.closest("tr");t&&(t.style.backgroundColor=d.get("gc_o_a_t_bgColor"))}}if(a&&a.owned&&(!d.get("gc_o_pw")||!d.get("gc_pw")||!a.won)&&(f.push({attributes:{class:"esgst-gc esgst-gc-owned","data-draggable-id":"gc_o",href:this.replacePlaceholders(d.get("gc_oUrl"),q),title:En("gc_o","Owned")},text:d.get("gc_o_s")?d.get("gc_o_s_i")?"":"O":d.get("gc_oLabel"),type:"a",children:d.get("gc_o_s")&&d.get("gc_o_s_i")?[{attributes:{class:"fa fa-"+d.get("gc_oIcon")},type:"i"}]:null}),d.get("gc_o_t")))for(const e of s){const t=e.container.closest("tr");t&&(t.style.backgroundColor=d.get("gc_o_t_bgColor"))}break;case"gc_w":if(a&&a.wishlisted&&(f.push({attributes:{class:"esgst-gc esgst-gc-wishlisted","data-draggable-id":"gc_w",href:this.replacePlaceholders(d.get("gc_wUrl"),q),title:En("gc_w","Wishlisted"+("number"==typeof a.wishlisted?" since "+this.gc_formatDate(1e3*a.wishlisted):""))},text:d.get("gc_w_s")?d.get("gc_w_s_i")?"":"W":d.get("gc_wLabel"),type:"a",children:d.get("gc_w_s")&&d.get("gc_w_s_i")?[{attributes:{class:"fa fa-"+d.get("gc_wIcon")},type:"i"}]:null}),d.get("gc_w_t")))for(const e of s){const t=e.container.closest("tr");t&&(t.style.backgroundColor=d.get("gc_w_t_bgColor"))}break;case"gc_f":a&&a.followed&&f.push({attributes:{class:"esgst-gc esgst-gc-followed","data-draggable-id":"gc_f",href:this.replacePlaceholders(d.get("gc_fUrl"),q),title:En("gc_f","Followed")},text:d.get("gc_f_s")?d.get("gc_f_s_i")?"":"F":d.get("gc_fLabel"),type:"a",children:d.get("gc_f_s")&&d.get("gc_f_s_i")?[{attributes:{class:"fa fa-"+d.get("gc_fIcon")},type:"i"}]:null});break;case"gc_pw":!a||!a.won||d.get("gc_pw_o")&&d.get("gc_o")&&a.owned||f.push({attributes:{class:"esgst-gc esgst-gc-won","data-draggable-id":"gc_pw",href:this.replacePlaceholders(d.get("gc_pwUrl"),q),title:En("gc_pw",a.won>1?"You previously won this game on "+c.common.getTimestamp(a.won):"Previously Won")},text:d.get("gc_pw_s")?d.get("gc_pw_s_i")?"":"PW":d.get("gc_pwLabel"),type:"a",children:d.get("gc_pw_s")&&d.get("gc_pw_s_i")?[{attributes:{class:"fa fa-"+d.get("gc_pwIcon")},type:"i"}]:null});break;case"gc_gi":if(t&&l.isSet(t.price)){let e=t.price;const o=s[0].heading;if(o){const t=o.innerHTML.match(/<span\sclass="giveaway__heading__thin">\((\d+?)P\)<\/span>/);t&&(e=parseInt(t[1]))}if(I=c.esgst.users.users[d.get("steamId")],I&&(k=I.giveaways,k)){if(k=k.sent[i][n],u=0,h=0,P=0,k){let t,s=Date.now();for(C=0,t=k.length;C<t;++C)_=c.esgst.giveaways[k[C]],_&&(Array.isArray(_.winners)?_.winners.length>0?_.winners.forEach(e=>{h+=1,(_.entries>=5||!_.inviteOnly&&!_.group&&!_.whitelist)&&"Received"===e.status&&(P+=1)}):s<_.endTime&&(u+=_.copies):_.winners>0?(h+=Math.min(_.entries,_.winners),(_.entries>=5||!_.inviteOnly&&!_.group&&!_.whitelist)&&(P+=Math.min(_.entries,_.winners))):s<_.endTime&&(u+=_.copies));if(B=e,a&&(a.noCV?B=0:a.reducedCV&&(B*=.15)),P>5)for(C=0,t=P-5;C<t;++C)B*=.9;p=P+1>5?.9*B:B,p=Math.round(100*p)/100}else B=e,a&&(a.noCV?B=0:a.reducedCV&&(B*=.15)),p=Math.round(100*B)/100;f.push({attributes:{class:"esgst-gc esgst-gc-giveawayInfo","data-draggable-id":"gc_gi",href:this.replacePlaceholders(d.get("gc_giUrl"),q),title:En("gc_gi",`You have sent ${h} copies of this game (${P} of which added to your CV)${u?`\nYou currently have ${u} open giveaways for this game`:""}\n\n${-1!==e?`You should get $${p} real CV for sending a new copy of this game\nA giveaway for this game is worth ${Math.min(Math.ceil(e),50)}P`:"ESGST was unable to retrieve the price of this game (most likely because the game was removed from the Steam store)"}`)},type:"a",children:[{attributes:{class:"fa fa-info"},type:"i"},{text:` ${h} `,type:"node"},{attributes:{class:"fa fa-dollar"},type:"i"},{text:" "+(-1!==e?p:"?"),type:"node"}]})}}break;case"gc_r":if(t&&t.rating){let e=null,s=parseInt(t.rating.match(/(\d+)%/)[1]);for(let t=0,n=d.get("gc_r_colors").length;t<n&&(e=d.get("gc_r_colors")[t],!(s>=e.lower&&s<=e.upper));t++);e||(e={bgColor:"#7f8c8d",color:"#ffffff",icon:"fa-question-circle"});let n=t.rating.match(/\((\d+)\)/);n&&(t.rating=t.rating.replace(/\(\d+\)/,`(${parseInt(n[1]).toLocaleString()})`)),f.push({attributes:{class:"esgst-gc esgst-gc-rating","data-bgColor":e.bgColor,"data-color":e.color,"data-draggable-id":"gc_r",href:this.replacePlaceholders(d.get("gc_rUrl"),q),style:`background-color: ${e.bgColor}; color: ${e.color};`,title:En("gc_r",t.rating)},type:"a",children:[e.icon.match(/\w/)?{attributes:{class:"fa fa-"+e.icon},type:"i"}:{attributes:{style:"font-size: 14px;"},text:e.icon,type:"span"},{text:d.get("gc_r_s")?" "+t.rating:"",type:"node"}]})}break;case"gc_a":if(h=0,a&&a.apps)for(const t of a.apps)e.cache.apps[t]&&e.cache.apps[t].achievements&&(h+=1);h=h?` (${h})`:"",(t&&t.achievements||h)&&f.push({attributes:{class:"esgst-gc esgst-gc-achievements","data-draggable-id":"gc_a",href:this.replacePlaceholders(d.get("gc_aUrl"),q),title:En("gc_a","Achievements"+(h||` (${t.achievements})`))},text:d.get("gc_a_s")?d.get("gc_a_s_i")?"":"A"+h:`${d.get("gc_aLabel")}${h}`,type:"a",children:d.get("gc_a_s")&&d.get("gc_a_s_i")?[{attributes:{class:"fa fa-"+d.get("gc_aIcon")},type:"i"},h?{text:h,type:"node"}:null]:null});break;case"gc_bd":"apps"===i&&c.esgst.delistedGames.banned.indexOf(parseInt(n))>-1&&f.push({attributes:{class:"esgst-gc esgst-gc-banned","data-draggable-id":"gc_bd",href:this.replacePlaceholders(d.get("gc_bdUrl"),q),title:En("gc_bd","Banned")},text:d.get("gc_bd_s")?d.get("gc_bd_s_i")?"":"BD":d.get("gc_bdLabel"),type:"a",children:d.get("gc_bd_s")&&d.get("gc_bd_s_i")?[{attributes:{class:"fa fa-"+d.get("gc_bdIcon")},type:"i"}]:null});break;case"gc_bvg":f.push({attributes:{class:"esgst-gc esgst-gc-bartervg","data-draggable-id":"gc_bvg",href:this.replacePlaceholders(d.get("gc_bvgUrl"),q),target:"_blank",title:En("gc_bvg","Barter.vg")},text:d.get("gc_bvg_s")?d.get("gc_bvg_s_i")?"":"BVG":d.get("gc_bvgLabel"),type:"a",children:d.get("gc_bvg_s")&&d.get("gc_bvg_s_i")?[{attributes:{class:"fa fa-"+d.get("gc_bvgIcon")},type:"i"}]:null});break;case"gc_mp":if(h=0,a&&a.apps)for(const t of a.apps)e.cache.apps[t]&&e.cache.apps[t].multiplayer&&(h+=1);h=h?` (${h})`:"",(t&&t.multiplayer||h)&&f.push({attributes:{class:"esgst-gc esgst-gc-multiplayer","data-draggable-id":"gc_mp",href:this.replacePlaceholders(d.get("gc_mpUrl"),q),title:En("gc_mp","Multiplayer"+h)},text:d.get("gc_mp_s")?d.get("gc_mp_s_i")?"":"MP"+h:`${d.get("gc_mpLabel")}${h}`,type:"a",children:d.get("gc_mp_s")&&d.get("gc_mp_s_i")?[{attributes:{class:`fa fa-${d.get("gc_mpIcon")} `},type:"i"},h?{text:h,type:"node"}:null]:null});break;case"gc_sp":if(h=0,a&&a.apps)for(const t of a.apps)e.cache.apps[t]&&e.cache.apps[t].singleplayer&&(h+=1);h=h?` (${h})`:"",(t&&t.singleplayer||h)&&f.push({attributes:{class:"esgst-gc esgst-gc-singleplayer","data-draggable-id":"gc_sp",href:this.replacePlaceholders(d.get("gc_spUrl"),q),title:En("gc_sp","Singleplayer"+h)},text:d.get("gc_sp_s")?d.get("gc_sp_s_i")?"":"SP"+h:`${d.get("gc_spLabel")}${h}`,type:"a",children:d.get("gc_sp_s")&&d.get("gc_sp_s_i")?[{attributes:{class:`fa fa-${d.get("gc_spIcon")} `},type:"i"},h?{text:h,type:"node"}:null]:null});break;case"gc_sc":if(h=0,a&&a.apps)for(const t of a.apps)e.cache.apps[t]&&e.cache.apps[t].steamCloud&&(h+=1);h=h?` (${h})`:"",(t&&t.steamCloud||h)&&f.push({attributes:{class:"esgst-gc esgst-gc-steamCloud","data-draggable-id":"gc_sc",href:this.replacePlaceholders(d.get("gc_scUrl"),q),title:En("gc_sc","Steam Cloud"+h)},text:d.get("gc_sc_s")?d.get("gc_sc_s_i")?"":"SC"+h:`${d.get("gc_scLabel")}${h}`,type:"a",children:d.get("gc_sc_s")&&d.get("gc_sc_s_i")?[{attributes:{class:`fa fa-${d.get("gc_scIcon")} `},type:"i"},h?{text:h,type:"node"}:null]:null});break;case"gc_tc":if(h=0,a&&a.apps)for(const t of a.apps)e.cache.apps[t]&&e.cache.apps[t].tradingCards&&(h+=1);h=h?` (${h})`:"",(t&&t.tradingCards||h)&&f.push({attributes:{class:"esgst-gc esgst-gc-tradingCards","data-draggable-id":"gc_tc",href:this.replacePlaceholders(d.get("gc_tcUrl"),q),title:En("gc_tc","Trading Cards"+h)},text:d.get("gc_tc_s")?d.get("gc_tc_s_i")?"":"TC"+h:`${d.get("gc_tcLabel")}${h}`,type:"a",children:d.get("gc_tc_s")&&d.get("gc_tc_s_i")?[{attributes:{class:`fa fa-${d.get("gc_tcIcon")} `},type:"i"},h?{text:h,type:"node"}:null]:null});break;case"gc_l":if(h=0,a&&a.apps)for(const t of a.apps)e.cache.apps[t]&&e.cache.apps[t].linux&&(h+=1);h=h?` (${h})`:"",(t&&t.linux||h)&&f.push({attributes:{class:"esgst-gc esgst-gc-linux","data-draggable-id":"gc_l",href:this.replacePlaceholders(d.get("gc_lUrl"),q),title:En("gc_l","Linux"+h)},text:d.get("gc_l_s")?d.get("gc_l_s_i")?"":"L"+h:`${d.get("gc_lLabel")}${h}`,type:"a",children:d.get("gc_l_s")&&d.get("gc_l_s_i")?[{attributes:{class:`fa fa-${d.get("gc_lIcon")} `},type:"i"},h?{text:h,type:"node"}:null]:null});break;case"gc_m":if(h=0,a&&a.apps)for(const t of a.apps)e.cache.apps[t]&&e.cache.apps[t].mac&&(h+=1);h=h?` (${h})`:"",(t&&t.mac||h)&&f.push({attributes:{class:"esgst-gc esgst-gc-mac","data-draggable-id":"gc_m",href:this.replacePlaceholders(d.get("gc_mUrl"),q),title:En("gc_m","Mac"+h)},text:d.get("gc_m_s")?d.get("gc_m_s_i")?"":"M"+h:`${d.get("gc_mLabel")}${h}`,type:"a",children:d.get("gc_m_s")&&d.get("gc_m_s_i")?[{attributes:{class:`fa fa-${d.get("gc_mIcon")} `},type:"i"},h?{text:h,type:"node"}:null]:null});break;case"gc_dlc":if(t&&t.dlc){let e;d.get("gc_dlc_o")&&t.base&&c.esgst.games.apps[t.base]&&(e=c.esgst.games.apps[t.base].owned);const s=[];d.get("gc_dlc_s")?d.get("gc_dlc_s_i")?(s.push({attributes:{class:`fa fa-${d.get("gc_dlcIcon")} `},type:"i"}),d.get("gc_dlc_o")&&e&&s.push({attributes:{class:`fa fa-${d.get("gc_oIcon")} esgst-gc-dlcOwned`},type:"i"}),d.get("gc_dlc_b")&&void 0!==t.freeBase&&(t.freeBase?s.push({attributes:{class:"fa fa-certificate esgst-gc-dlcFree"},type:"i"}):s.push({attributes:{class:"fa fa-money esgst-gc-dlcNonFree"},type:"i"}))):(s.push({text:"DLC",type:"node"}),d.get("gc_dlc_o")&&e&&s.push({attributes:{class:"esgst-gc-dlcOwned"},text:"(O)",type:"span"}),d.get("gc_dlc_b")&&void 0!==t.freeBase&&(t.freeBase?s.push({attributes:{class:"esgst-gc-dlcFree"},text:"(F)",type:"span"}):s.push({attributes:{class:"esgst-gc-dlcNonFree"},text:"(NF)",type:"span"}))):(s.push({text:d.get("gc_dlcLabel"),type:"node"}),d.get("gc_dlc_o")&&e&&s.push({attributes:{class:"esgst-gc-dlcOwned"},text:"(Owned)",type:"span"}),d.get("gc_dlc_b")&&void 0!==t.freeBase&&(t.freeBase?s.push({attributes:{class:"esgst-gc-dlcFree"},text:"(Free)",type:"span"}):s.push({attributes:{class:"esgst-gc-dlcNonFree"},text:"(Not Free)",type:"span"}))),f.push({attributes:{class:"esgst-gc esgst-gc-dlc","data-draggable-id":"gc_dlc",href:this.replacePlaceholders(d.get("gc_dlcUrl"),q),title:En("gc_dlc","DLC"+(d.get("gc_dlc_b")&&void 0!==t.freeBase?t.freeBase?" (the base game of this DLC is free)":" (the base game of this DLC is not free)":""))},type:"a",children:s})}break;case"gc_p":if("subs"===i){const e=[];if(d.get("gc_p_s")?d.get("gc_p_s_i")?e.push({attributes:{class:"fa fa-"+d.get("gc_pIcon")},type:"i"}):e.push({text:"P",type:"node"}):e.push({text:d.get("gc_pLabel"),type:"node"}),D&&e.push({text:` (${D.num}/${D.total})`,type:"node"}),f.push({attributes:{class:"esgst-gc esgst-gc-package","data-draggable-id":"gc_p",href:this.replacePlaceholders(d.get("gc_pUrl"),q),title:En("gc_p",`Package${a&&a.apps?` (${a.apps.length})`:""} ${D?` (${D.num} owned)`:""} `)},type:"a",children:e}),D&&D.num)if(d.get("gc_p_t")&&D.num<D.total)for(const e of s){const t=e.container.closest("tr");t&&(t.style.backgroundColor=d.get("gc_p_t_bgColor"))}else if(d.get("gc_o_t")&&D.num===D.total)for(const e of s){const t=e.container.closest("tr");t&&(t.style.backgroundColor=d.get("gc_o_t_bgColor"))}}break;case"gc_ea":if(h=0,a&&a.apps)for(const t of a.apps)e.cache.apps[t]&&e.cache.apps[t].earlyAccess&&(h+=1);h=h?` (${h})`:"",(t&&t.earlyAccess||h)&&f.push({attributes:{class:"esgst-gc esgst-gc-earlyAccess","data-draggable-id":"gc_ea",href:this.replacePlaceholders(d.get("gc_eaUrl"),q),title:En("gc_ea","Early Access"+h)},text:d.get("gc_ea_s")?d.get("gc_ea_s_i")?"":"EA"+h:`${d.get("gc_eaLabel")}${h}`,type:"a",children:d.get("gc_ea_s")&&d.get("gc_ea_s_i")?[{attributes:{class:`fa fa-${d.get("gc_eaIcon")} `},type:"i"},h?{text:h,type:"node"}:null]:null});break;case"gc_lg":if(h=0,a&&a.apps)for(const t of a.apps)e.cache.apps[t]&&1===e.cache.apps[t].learning&&(h+=1);h=h?` (${h})`:"",(t&&1===t.learning||h)&&f.push({attributes:{class:"esgst-gc esgst-gc-learning","data-draggable-id":"gc_lg",href:this.replacePlaceholders(d.get("gc_lgUrl"),q),title:En("gc_lg","Learning"+h)},text:d.get("gc_lg_s")?d.get("gc_lg_s_i")?"":"LG"+h:`${d.get("gc_lgLabel")}${h}`,type:"a",children:d.get("gc_lg_s")&&d.get("gc_lg_s_i")?[{attributes:{class:`fa fa-${d.get("gc_lgIcon")} `},type:"i"},h?{text:h,type:"node"}:null]:null});break;case"gc_rm":if(h=0,a&&a.apps)for(const t of a.apps)e.cache.apps[t]&&1===e.cache.apps[t].removed&&(h+=1);h=h?` (${h})`:"",(t&&1===t.removed||h)&&f.push({attributes:{class:"esgst-gc esgst-gc-removed","data-draggable-id":"gc_rm",href:this.replacePlaceholders(d.get("gc_rmUrl"),q),title:En("gc_rm","Removed"+h)},text:d.get("gc_rm_s")?d.get("gc_rm_s_i")?"":"RM"+h:`${d.get("gc_rmLabel")}${h}`,type:"a",children:d.get("gc_rm_s")&&d.get("gc_rm_s_i")?[{attributes:{class:`fa fa-${d.get("gc_rmIcon")} `},type:"i"},h?{text:h,type:"node"}:null]:null});break;case"gc_rd":t&&t.releaseDate&&f.push({attributes:{class:"esgst-gc esgst-gc-releaseDate","data-draggable-id":"gc_rd","data-timestamp":" ? "===t.releaseDate?t.releaseDate:t.releaseDate/1e3,href:this.replacePlaceholders(d.get("gc_rdUrl"),q),title:En("gc_rd","Release Date")},type:"a",children:[{attributes:{class:"fa fa-"+d.get("gc_rdIcon")},type:"i"},{text:" "+this.gc_formatDate(t.releaseDate),type:"node"}]});break;case"gc_g":if(v="",a&&a.apps){for(const t of a.apps)e.cache.apps[t]&&e.cache.apps[t].genres&&(v+=(d.get("gc_g_udt")&&e.cache.apps[t].tags?`${e.cache.apps[t].genres}, ${e.cache.apps[t].tags}`:e.cache.apps[t].genres)+", ");v=v.slice(0,-2)}else t&&t.genres&&(v=d.get("gc_g_udt")&&t.tags?`${t.genres}, ${t.tags}`:t.genres);if(v){let e;for(y=l.sortArray(Array.from(new Set(v.split(/,\s/)))),v=y.join(", "),d.get("gc_g_filters").trim()&&(e=d.get("gc_g_filters").trim().toLowerCase().split(/\s*,\s*/)),C=y.length-1;C>=0;--C)if(w=y[C].toLowerCase(),!e||e.indexOf(w)>-1){for(S=d.get("gc_g_colors").length-1;S>=0&&d.get("gc_g_colors")[S].genre.toLowerCase()!==w;--S);S>=0?d.get("gc_g_s")?y[C]={attributes:{class:"esgst-gc esgst-gc-genres",href:this.replacePlaceholders(d.get("gc_gUrl"),q),style:`background-color: ${d.get("gc_g_colors")[S].bgColor}; color: ${d.get("gc_g_colors")[S].color};`,title:En("gc_g_s",y[C])},text:y[C],type:"a"}:(y[C]={attributes:{style:"color: "+d.get("gc_g_colors")[S].color},text:y[C],type:"span"},C<y.length-1&&y.splice(C+1,0,{text:", ",type:"node"})):d.get("gc_g_s")?y[C]={attributes:{class:"esgst-gc esgst-gc-genres",href:this.replacePlaceholders(d.get("gc_gUrl"),q),title:En("gc_g_s",y[C])},text:y[C],type:"a"}:(y[C]={text:y[C],type:"node"},C<y.length-1&&y.splice(C+1,0,{text:", ",type:"node"}))}else y.splice(C,1);d.get("gc_g_s")?f.push({attributes:{class:"esgst-gc esgst-gc-genres","data-draggable-id":"gc_g"},type:"span",children:y}):y.length>0&&f.push({attributes:{class:"esgst-gc esgst-gc-genres","data-draggable-id":"gc_g",href:this.replacePlaceholders(d.get("gc_gUrl"),q),title:En("gc_g",v)},type:"a",children:y})}}(r||g)&&f.push({attributes:{class:"esgst-gc-loading",title:"This game is queued for fetching"},type:"span",children:[{attributes:{class:"fa fa-hourglass fa-spin"},type:"i"},{type:"span"}]});let M=!1;for(a&&a.owned||!(t&&(t.dlc||1===t.learning)||"apps"===i&&c.esgst.delistedGames.banned.indexOf(parseInt(n))>-1||"subs"===i&&!D)||(M=!0),A=0,E=s.length;A<E;++A){let e=[...f];const t=s[A].elgbButton&&s[A].elgbButton.firstElementChild||c.esgst.enterGiveawayButton;if(t&&M&&d.get("gc_e")&&(t.title="ESGST cannot check ownership of this game",t.style.color=d.get("gc_e_color"),t.style.borderColor=d.get("gc_e_bColor"),t.style.backgroundColor=d.get("gc_e_bgColor"),t.style.backgroundImage="none"),s[A].container.classList.contains("esgst-hidden")){c.esgst.gcToFetch[i][n]||(c.esgst.gcToFetch[i][n]=[]),c.esgst.gcToFetch[i][n].indexOf(s[A])<0&&c.esgst.gcToFetch[i][n].push(s[A]);continue}c.esgst.gcToFetch[i][n]&&(c.esgst.gcToFetch[i][n]=c.esgst.gcToFetch[i][n].filter(e=>e!==s[A]),c.esgst.gcToFetch[i][n].length||delete c.esgst.gcToFetch[i][n]);const o=s[A].container.querySelectorAll(".esgst-gc");for(const e of o)e.remove();if(T=s[A].container.getElementsByClassName("esgst-gc-panel")[0],T&&!T.getAttribute("data-gcReady")){if(d.get("gc_il")&&!c.esgst.giveawayPath&&(T.previousElementSibling.style.display="inline-block",T.classList.add("esgst-gc-panel-inline")),d.get("gc_ocv")&&s[A].startTime){const t=a&&a.reducedCV&&new Date(a.reducedCV).getTime()||0,n=a&&a.noCV&&new Date(a.noCV).getTime()||0;if(t||n){let a="";t&&n?s[A].startTime<t&&s[A].startTime<n?a="fcv":s[A].startTime<n&&(a="rcv"):(s[A].startTime<t||s[A].startTime<n)&&(a="fcv"),a&&e.push({attributes:{class:"esgst-gc esgst-gc-originalCV esgst-gc-originalCV-"+a,"data-draggable-id":"gc_ocv",href:this.replacePlaceholders(d.get("gc_ocvUrl"),q),title:En("gc_ocv",`Was ${d.get(`gc_${a}Label`)} when it was given away`)},text:d.get("gc_ocv_s")?d.get("gc_ocv_s_i")?"":"W"+a.toUpperCase():`${d.get("gc_ocvLabel")}${d.get(`gc_${a}Label`)}`,type:"a",children:d.get("gc_ocv_s")&&d.get("gc_ocv_s_i")?[{attributes:{class:"fa fa-"+d.get("gc_ocvIcon")},type:"i"},{attributes:{class:"fa fa-"+d.get(`gc_${a}Icon`)},type:"i"}]:null})}}if(Sn(T,"atinner",e),s[A].grid&&!d.get("gc_lp_gv"))for(C=T.children.length-1;C>-1;--C)T.children[C].removeAttribute("href");r||g||T.setAttribute("data-gcReady",1),s[A].gcPanel=T,c.esgst.modules.giveaways.giveaways_reorder(s[A])}}}gc_formatDate(e){if("?"===e)return e;let t=new Date(e);return d.get("gc_rdLabel").replace(/DD/,t.getDate()).replace(/MM/,""+(t.getMonth()+1)).replace(/Month/,["January","February","March","April","May","June","July","August","September","October","November","December"][t.getMonth()]).replace(/Mon/,["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][t.getMonth()]).replace(/YYYY/,""+t.getFullYear())}};const Pn=new class extends gt{constructor(){super(),this.info={description:()=>Se.element("ul",null,Se.element("li",null,"Highlights the number of copies next a giveaway's game name (in any page) by coloring it as red and changing the font to bold.")),featureMap:{giveaway:this.highlight.bind(this)},id:"gch",name:"Giveaway Copy Highlighter",sg:!0,type:"giveaways"}}highlight(e){for(const t of e){if(!t.copiesContainer)continue;const{color:e,bgColor:s}=d.get("gch_colors").filter(e=>t.copies>=parseInt(e.lower)&&t.copies<=parseInt(e.upper))[0]||{color:void 0,bgColor:void 0};t.copiesContainer.classList.add("esgst-bold"),e?(t.copiesContainer.style.color=e,s&&(t.copiesContainer.classList.add("esgst-gch-highlight"),t.copiesContainer.style.backgroundColor=s)):t.copiesContainer.classList.add("esgst-red")}}};const Ln=new class extends gt{constructor(){super(),this.info={description:()=>Se.element("ul",null,Se.element("li",null,"Highlights the level of a giveaway (in any page) by coloring it with the specified colors.")),featureMap:{giveaway:this.highlight.bind(this)},id:"glh",name:"Giveaway Level Highlighter",sg:!0,type:"giveaways"}}highlight(e){for(const t of e){if(!t.levelColumn)continue;const{color:e,bgColor:s}=d.get("glh_colors").filter(e=>t.level>=parseInt(e.lower)&&t.level<=parseInt(e.upper))[0]||{color:void 0,bgColor:void 0};e&&s&&(t.levelColumn.setAttribute("style",`${e?`color: ${e} !important;`:""}${s?`background-color: ${s};`:""}`),t.levelColumn.classList.add("esgst-glh-highlight"))}}};const In=new class extends gt{constructor(){super(),this.info={description:()=>Se.element("ul",null,Se.element("li",null,"Allows you to color the background of giveaways based on their type (public, invite only, region restricted, group or whitelist) and level.")),features:{cgb_b:{background:!0,name:"Color giveaways that cannot be entered because of blacklist reasons.",sg:!0},cgb_p:{background:!0,name:"Color public giveaways.",sg:!0},cgb_io:{background:!0,name:"Color invite only giveaways.",sg:!0},cgb_rr:{background:!0,name:"Color region restricted giveaways.",sg:!0},cgb_g:{background:!0,name:"Color group giveaways.",sg:!0},cgb_w:{background:!0,name:"Color whitelist giveaways.",sg:!0},cgb_sgt:{background:!0,name:"Color SGTools giveaways.",sg:!0}},featureMap:{giveaway:this.color.bind(this)},id:"cgb",name:"Custom Giveaway Background",sg:!0,type:"giveaways"}}color(e){for(const t of e){d.get("cgb_b")&&t.outerWrap.getAttribute("data-blacklist")?t.outerWrap.setAttribute("style",`background-color: ${d.get("cgb_b_bgColor")} !important`):d.get("cgb_sgt")&&t.sgTools&&t.outerWrap.setAttribute("style",`background-color: ${d.get("cgb_sgt_bgColor")} !important`);const{color:e}=d.get("cgb_levelColors").filter(e=>t.level>=parseInt(e.lower)&&t.level<=parseInt(e.upper))[0]||{color:void 0};e?t.outerWrap.setAttribute("style",`background-color: ${e} !important`):d.get("cgb_w")&&t.whitelist?t.outerWrap.setAttribute("style",`background-color: ${d.get("cgb_w_bgColor")} !important`):d.get("cgb_g")&&t.group?t.outerWrap.setAttribute("style",`background-color: ${d.get("cgb_g_bgColor")} !important`):d.get("cgb_rr")&&t.regionRestricted?t.outerWrap.setAttribute("style",`background-color: ${d.get("cgb_rr_bgColor")} !important`):d.get("cgb_io")&&t.inviteOnly?t.outerWrap.setAttribute("style",`background-color: ${d.get("cgb_io_bgColor")} !important`):d.get("cgb_p")&&t.public?t.outerWrap.setAttribute("style",`background-color: ${d.get("cgb_p_bgColor")} !important`):t.outerWrap.style.backgroundColor="",t.outerWrap.style.backgroundColor&&(t.outerWrap.style.backgroundImage="none")}}};const Bn=new class extends gt{constructor(){super(),this.info={description:()=>Se.element("ul",null,Se.element("li",null,"Allows you to customize the calendar for selecting the start/end times of giveaways in the ",Se.element("a",{href:"https://www.steamgifts.com/giveaways/new"},"new giveaway")," page."),Se.element("li",null,"Make sure to test if SteamGifts accepts the format you entered by reviewing a test giveaway.")),inputItems:[{id:"cgc_dateFormat",prefix:"Date format: ",suffix:" (check accepted formats here: http://api.jqueryui.com/datepicker/#utility-formatDate)"},{id:"cgc_timeFormat",prefix:"Time format: ",suffix:" (check accepted formats here: https://trentrichardson.com/examples/timepicker/#tp-formatting)"}],options:[{title:"First day of the week: ",values:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]}],id:"cgc",name:"Custom Giveaway Calendar",sg:!0,type:"giveaways"}}init(){if(!this.esgst.newGiveawayPath||!document.getElementsByClassName("form__rows")[0])return;const e=document.createElement("script");e.textContent=`\n\t\t\tfunction esgst_cgc() {\n\t\t\t\tconst actualStartInput = document.querySelector('input[name=start_time]');\n\t\t\t\tactualStartInput.setAttribute('type', 'hidden');\n\t\t\t\tconst startInput = document.createElement('input');\n\t\t\t\tstartInput.className = 'form__input-small';\n\t\t\t\tstartInput.setAttribute('type', 'text');\n\t\t\t\tactualStartInput.parentElement.insertBefore(startInput, actualStartInput);\n\t\t\t\t$(actualStartInput).datetimepicker("destroy");\n\t\t\t\t$(startInput).datetimepicker({\n\t\t\t\t\taltField: "input[name=start_time]",\n\t\t\t\t\taltFieldTimeOnly: false,\n\t\t\t\t\taltFormat: "M d, yy",\n\t\t\t\t\taltTimeFormat: "h:mm tt",\n\t\t\t\t\tbeforeShowDay: t,\n\t\t\t\t\tdateFormat: "${d.get("cgc_dateFormat")}",\n\t\t\t\t\tfirstDay: "${d.get("cgc_index_0")}",\n\t\t\t\t\tmaxDate: new Date((new Date).getTime() + 2592e6 - 36e5),\n\t\t\t\t\tmaxDateTime: new Date((new Date).getTime() + 2592e6 - 36e5),\n\t\t\t\t\tminDate: new Date,\n\t\t\t\t\tminDateTime: new Date,\n\t\t\t\t\tnumberOfMonths: 1,\n\t\t\t\t\tselectOtherMonths: !0,\n\t\t\t\t\tshowOtherMonths: !0,\n\t\t\t\t\ttimeFormat: "${d.get("cgc_timeFormat")}",\n\t\t\t\t\tonSelect: function() {\n\t\t\t\t\t\ts()\n\t\t\t\t\t},\n\t\t\t\t\tonClose: function() {\n\t\t\t\t\t\ts()\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\tif (actualStartInput.value) {\n\t\t\t\t\t$(startInput).datepicker("setDate", actualStartInput.value);\n\t\t\t\t}\n\n\t\t\t\tconst actualEndInput = document.querySelector('input[name=end_time]');\n\t\t\t\tactualEndInput.setAttribute('type', 'hidden');\n\t\t\t\tconst endInput = document.createElement('input');\n\t\t\t\tendInput.className = 'form__input-small';\n\t\t\t\tendInput.setAttribute('type', 'text');\n\t\t\t\tactualEndInput.parentElement.insertBefore(endInput, actualEndInput);\n\t\t\t\t$(actualEndInput).datetimepicker("destroy");\n\t\t\t\t$(endInput).datetimepicker({\n\t\t\t\t\taltField: "input[name=end_time]",\n\t\t\t\t\taltFieldTimeOnly: false,\n\t\t\t\t\taltFormat: "M d, yy",\n\t\t\t\t\taltTimeFormat: "h:mm tt",\n\t\t\t\t\tbeforeShowDay: t,\n\t\t\t\t\tdateFormat: "${d.get("cgc_dateFormat")}",\n\t\t\t\t\tfirstDay: "${d.get("cgc_index_0")}",\n\t\t\t\t\tmaxDate: new Date((new Date).getTime() + 2592e6),\n\t\t\t\t\tmaxDateTime: new Date((new Date).getTime() + 2592e6),\n\t\t\t\t\tminDate: new Date((new Date).getTime() + 36e5),\n\t\t\t\t\tminDateTime: new Date((new Date).getTime() + 36e5),\n\t\t\t\t\tnumberOfMonths: 1,\n\t\t\t\t\tselectOtherMonths: !0,\n\t\t\t\t\tshowOtherMonths: !0,\n\t\t\t\t\ttimeFormat: "${d.get("cgc_timeFormat")}",\n\t\t\t\t\tonSelect: function() {\n\t\t\t\t\t\ti()\n\t\t\t\t\t},\n\t\t\t\t\tonClose: function() {\n\t\t\t\t\t\ti()\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\tif (actualEndInput.value) {\n\t\t\t\t\t$(endInput).datepicker("setDate", actualEndInput.value);\n\t\t\t\t}\n\n\t\t\t\tfunction t(e) {\n\t\t\t\t\treturn (start_time = $("input[name=start_time]").datetimepicker("getDate")) && (end_time = $("input[name=end_time]").datetimepicker("getDate")) ? (start_time.setHours(0, 0, 0, 0), end_time.setHours(0, 0, 0, 0), [!0, e.getTime() >= start_time.getTime() && e.getTime() <= end_time.getTime() ? "datepicker-highlight-range" : ""]) : [!0, ""]\n\t\t\t\t}\n\n\t\t\t\tfunction s() {\n\t\t\t\t\t(start_time = $("input[name=start_time]").datetimepicker("getDate")) && (end_time = $("input[name=end_time]").datetimepicker("getDate")) && (start_time = new Date(start_time.getTime() + 36e5), start_time > end_time && $("input[name=end_time]").datetimepicker("setDate", start_time))\n\t\t\t\t}\n\n\t\t\t\tfunction i() {\n\t\t\t\t\t(start_time = $("input[name=start_time]").datetimepicker("getDate")) && (end_time = $("input[name=end_time]").datetimepicker("getDate")) && (end_time = new Date(end_time.getTime() - 36e5), end_time < start_time && $("input[name=start_time]").datetimepicker("setDate", end_time))\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (document.readyState === "complete") {\n\t\t\t\tesgst_cgc();\n\t\t\t} else {\n\t\t\t\t$(window).on("load", function () {\n\t\t\t\t\tesgst_cgc();\n\t\t\t\t});\n\t\t\t}\n\t\t`,document.body.appendChild(e),e.remove()}};const Dn=new class extends gt{constructor(){super(),this.info={description:()=>Se.element("ul",null,Se.element("li",null,"Allows you to see stats for your entered giveaways in the sidebar of the entered page.")),features:{egs_e:{name:"Include ended giveaways in the stats.",sgPaths:"My Giveaways - Entered",sg:!0}},id:"egs",name:"Entered Giveaways Stats",sg:!0,sgPaths:"My Giveaways - Entered",type:"giveaways"}}init(){if(!this.esgst.enteredPath)return;hs.createSidebarNavigation(this.esgst.sidebar,"beforeend",{name:"Entered Giveaways Stats",items:[{id:"egs_chance",name:"Average Chance",count:0},{id:"egs_level",name:"Average Level",count:0},{id:"egs_entries",name:"Average Entries",count:0},{id:"egs_points",name:"Average Points Spent",count:0},{id:"egs_simple_points",name:"Total Points Spent",count:0}]});const e={counters:{chance:0,level:0,entries:0,points:0},simpleCounters:{points:0},elements:{},total:0};for(const t in e.counters)e.elements[t]=document.querySelector("#egs_"+t).querySelector(".sidebar__navigation__item__count");for(const t in e.simpleCounters)e.elements["simple_"+t]=document.querySelector("#egs_simple_"+t).querySelector(".sidebar__navigation__item__count");this.esgst.giveawayFeatures.push((t,s)=>this.addStats(e,t,s))}addStats(e,t,s){if(s){for(const s of t)if(!s.ended||d.get("egs_e")){for(const t in e.counters)e.counters[t]+=s[t];for(const t in e.simpleCounters)e.simpleCounters[t]+=s[t];e.total+=1}for(const t in e.counters)e.elements[t].textContent=hs.round(e.counters[t]/e.total);for(const t in e.simpleCounters)e.elements["simple_"+t].textContent=e.simpleCounters[t]}}},Gn=hs.createElements.bind(hs),qn=hs.getFeatureTooltip.bind(hs),Rn=hs.getValue.bind(hs),Mn=hs.getValues.bind(hs),On=hs.setValue.bind(hs);const Un=new class extends gt{constructor(){super(),this.info={description:()=>Se.element("ul",null,Se.element("li",null,"Adds a button (",Se.element("i",{className:"fa fa-check"})," if the thread is not marked as visited and ",Se.element("i",{className:"fa fa-times"}),' if it is) to the "Comments" column of any'," ",Se.element("a",{href:"https://www.steamgifts.com/discussions"},"discussions"),"/",Se.element("a",{href:"https://www.steamgifts.com/support/tickets"},"tickets"),"/",Se.element("a",{href:"https://www.steamtrades.com/trades"},"trades")," pages and to the main page heading of any discussion/ticket/trade page that allows you to mark the thread as visited."),Se.element("li",null,"Giveaways/threads marked as visited are faded out in the page.")),features:{gdttt_g:{name:"Fade visited giveaways.",sg:!0},gdttt_vd:{name:"Mark discussions as visited when visiting them.",sg:!0},gdttt_vg:{name:"Mark giveaways as visited when visiting them.",sg:!0},gdttt_vt:{name:"Mark tickets as visited when visiting them.",sg:!0},gdttt_vts:{name:"Mark trades as visited when visiting them.",st:!0}},id:"gdttt",name:"Giveaway/Discussion/Ticket/Trade Tracker",sg:!0,st:!0,type:"general",featureMap:{endless:this.gdttt_checkVisited.bind(this)}}}async init(){if(!this.esgst.commentsPath)return;let e=window.location.pathname.match(/(giveaway|discussion|ticket|trade)\/(.+?)\//),t=e[1]+"s",s=e[2],n=JSON.parse(c.common.getValue(t,"{}"));if(d.get("gdttt_v"+{giveaways:"g",discussions:"d",tickets:"t",trades:"ts"}[t])){if(!d.get("ct")){let e=JSON.parse(r.get("gdtttCache",'{"giveaways":[],"discussions":[],"tickets":[],"trades":[]}'));e[t].indexOf(s)<0&&(e[t].push(s),r.set("gdtttCache",JSON.stringify(e)));const a=new Te("comment",{threshold:300});await a.lock(),n[s]||(n[s]={readComments:{}}),n[s].visited=!0,n[s].lastUsed=Date.now(),await On(t,JSON.stringify(n)),await a.unlock()}}else(this.esgst.discussionPath||this.esgst.tradePath)&&(n[s]&&n[s].visited?this.gdttt_addMarkUnvisitedButton(null,s,document.querySelector(".page__heading, .page_heading"),null,t):this.gdttt_addMarkVisitedButton(null,s,document.querySelector(".page__heading, .page_heading"),null,t))}async gdttt_markVisited(e,t,s,n,a,i){if(i){const t=new Te("comment",{threshold:300});await t.lock();const i=JSON.parse(Rn(a));i[e]||(i[e]={readComments:{}}),d.get("ct_s")&&(i[e].count=s,n.textContent=""),i[e].visited=!0,i[e].lastUsed=Date.now(),await On(a,JSON.stringify(i)),await t.unlock()}return t.classList.add("esgst-ct-visited"),!0}async gdttt_markUnvisited(e,t,s,n,a,i){if(i){const t=new Te("comment",{threshold:300});await t.lock();const i=JSON.parse(Rn(a));d.get("ct_s")&&(delete i[e].count,n.textContent=`(+${s})`),delete i[e].visited,i[e].lastUsed=Date.now(),await On(a,JSON.stringify(i)),await t.unlock()}return t.classList.remove("esgst-ct-visited"),!0}async gdttt_checkVisited(e,t,s,n){let a=e.querySelectorAll(`${n?`.esgst-es-page-${n} .homepage_table_column_heading, .esgst-es-page-${n}.homepage_table_column_heading`:".homepage_table_column_heading"}, ${n?`.esgst-es-page-${n} .table__column__heading, .esgst-es-page-${n}.table__column__heading`:".table__column__heading"}, ${n?`.esgst-es-page-${n} .giveaway__heading__name, .esgst-es-page-${n}.giveaway__heading__name`:".giveaway__heading__name"}, ${n?`.esgst-es-page-${n} .row_trade_name h2 a, .esgst-es-page-${n}.row_trade_name h2 a`:".row_trade_name h2 a"}`);if(!a.length)return;let i=Mn({giveaways:"{}",discussions:"{}",tickets:"{}",trades:"{}"});for(let e in i)i.hasOwnProperty(e)&&(i[e]=JSON.parse(i[e]));for(let e=0,t=a.length;e<t;++e){let t=a[e],s=t.getAttribute("href");if(s){let e=s.match(/(giveaway|discussion|ticket|trade)\/(.+?)(\/.*)?$/);if(e){let s=e[1]+"s",n=e[2],a=t.closest(".table__row-outer-wrap, .giveaway__row-outer-wrap, .row_outer_wrap"),o=i[s][n];o&&o.visited&&a&&("giveaways"===s&&d.get("gdttt_g")||"giveaways"!==s)&&a.classList.add("esgst-ct-visited")}}}}gdttt_addMarkVisitedButton(e,t,s,n,a){let i,o=!1;e||(e=Gn(s,"afterbegin",[{attributes:{class:"esgst-gdttt-button page_heading_btn"},type:"div"}])),Gn(e,"atinner",[{attributes:{class:"fa fa-check",title:""+qn("gdttt","Mark as visited")},type:"i"}]),e.addEventListener("click",async()=>{if(!o){o=!0,Gn(e,"atinner",[{attributes:{class:"fa fa-circle-o-notch fa-spin"},type:"i"}]);const r=new Te("comment",{threshold:300});await r.lock(),i=JSON.parse(Rn(a)),i[t]||(i[t]={readComments:{}}),d.get("ct_s")&&(i[t].count=n),i[t].visited=!0,i[t].lastUsed=Date.now(),await On(a,JSON.stringify(i)),await r.unlock(),this.gdttt_addMarkUnvisitedButton(e,t,s,n,a)}})}gdttt_addMarkUnvisitedButton(e,t,s,n,a){let i,o=!1;e||(e=Gn(s,"afterbegin",[{attributes:{class:"esgst-gdttt-button page_heading_btn"},type:"div"}])),Gn(e,"atinner",[{attributes:{class:"fa fa-times",title:""+qn("gdttt","Mark as unvisited")},type:"i"}]),e.addEventListener("click",async()=>{if(!o){o=!0,Gn(e,"atinner",[{attributes:{class:"fa fa-circle-o-notch fa-spin"},type:"i"}]);const r=new Te("comment",{threshold:300});await r.lock(),i=JSON.parse(Rn(a)),d.get("ct_s")&&delete i[t].count,delete i[t].visited,i[t].lastUsed=Date.now(),await On(a,JSON.stringify(i)),await r.unlock(),this.gdttt_addMarkVisitedButton(e,t,s,n,a)}})}};const Fn=new class extends gt{constructor(){super(),this.info={description:()=>Se.element("ul",null,Se.element("li",null,"Allows you to subscribe to threads so that you're notified when a new comment is posted."),Se.element("li",null,"Adds a ",Se.element("i",{className:"fa fa-bell-o"})," button to the header that allows you to view your subscriptions.")),id:"tds",name:"Thread Subscription",sg:!0,st:!0,type:"general",features:{tds_n:{name:"Show browser notifications when there are new comments in the subscriptions.",sg:!0,st:!0}},inputItems:[{attributes:{min:0,type:"number"},id:"tds_minutes",prefix:"Check every ",suffix:" minutes"}]},this.button=null,this.lock=null,this.minutes=null,this.popout=null,this.subscribedItems=[],this.forumCategories={"":"All","addons-tools":"Add-ons / Tools",announcements:"Announcements","bugs-suggestions":"Bugs / Suggestions",deals:"Deals","game-showcase":"Game Showcase",general:"General","group-recruitment":"Group Recruitment",hardware:"Hardware",help:"Help","lets-play-together":"Let's Play Together","movies-tv":"Movies / TV","off-topic":"Off Topic","puzzles-events":"Puzzles / Events",uncategorized:"Uncategorized","user-projects":"User Projects","whitelist-recruitment":"Whitelist Recruitment"}}async init(){if(this.button=c.header.addButtonContainer({buttonIcon:"fa fa-circle-o-notch fa-spin",buttonName:"ESGST Thread Subscriptions",isNotification:!0,side:"right"}),this.button.nodes.buttonIcon.title="Loading your subscriptions",this.popout=new mt("esgst-tds-popout",this.button.nodes.outer,0,!0),this.minutes=6e4*parseInt(d.get("tds_minutes")),this.startDaemon(),c.esgst.discussionsPath||c.esgst.discussionPath){const e=Object.keys(this.forumCategories);for(const t of e){const e=document.querySelector(`.sidebar__navigation__item__link[href="/discussions${t?"/"+t:""}"]`);e&&(e.parentElement.classList.add("esgst-tds-sidebar-item"),d.get("tds_forums")[t]?this.addUnsubscribeButton(null,t,e,null,this.forumCategories[t],"forum"):this.addSubscribeButton(null,t,e,null,this.forumCategories[t],"forum"))}}if(!c.esgst.commentsPath)return;const e=window.location.pathname.match(/(discussion|ticket|trade)\/(.+?)\//);if(!e)return;const t=e[1]+"s",s=e[2],n=document.querySelector(".page__heading, .page_heading"),a=n.querySelector("h1")?n.querySelector("h1").textContent.trim():null,i=c.esgst.mainPageHeading.querySelector(".page__heading__breadcrumbs, .page_heading_breadcrumbs").firstElementChild,o=parseInt(i.textContent.replace(/,/g,"").match(/\d+/)[0]);if(c.esgst.discussionPath||c.esgst.tradePath){const e=c.esgst[t][s];e&&void 0!==e.subscribed?this.addUnsubscribeButton(null,s,n,o,a,t):this.addSubscribeButton(null,s,n,o,a,t)}}async dismissItem(e,t){t.diff=0,"forum"===t.type?await this.subscribe(t.code,t.codes,t.name,t.type):(t.subscribed=t.count,await this.subscribe(t.code,t.count,t.name,t.type)),e.target.remove(),await c.common.notifyTds(this.subscribedItems)}async unsubscribeItem(e,t){"forum"!==t.type&&delete t.subscribed,await this.unsubscribe(t.code,t.type),e.remove(),await c.common.notifyTds(this.subscribedItems),this.popout.isOpen&&this.popout.reposition()}async updatePopout(){this.popout.popout.innerHTML="",this.subscribedItems=this.subscribedItems.filter(e=>void 0!==e.subscribed||d.get("tds_forums")[e.code]),this.subscribedItems.sort((e,t)=>e.diff>t.diff?-1:1);for(const e of this.subscribedItems){let t;Se.insert(this.popout.popout,"beforeend",Se.element("div",{className:"esgst-tds-item "+(e.diff?"esgst-tds-item-active":""),ref:e=>t=e},Se.element("div",{className:"esgst-tds-item-description"},Se.element("a",{className:"esgst-tds-item-name",href:"forum"===e.type?"https://www.steamgifts.com/discussions"+(e.code?"/"+e.code:""):"discussions"===e.type?`https://www.steamgifts.com/discussion/${e.code}/search?page=last`:`https://www.steamtrades.com/trade/${e.code}/search?page=last`},"forum"===e.type?this.forumCategories[e.code]:e.name),Se.element("div",{className:"esgst-tds-item-count"},e.diff?`${e.diff} new ${"forum"===e.type?"threads":"comments"}`:"No new "+("forum"===e.type?"threads":"comments"))),Se.element("div",{className:"esgst-tds-item-actions"},e.diff?Se.element("i",{className:"fa fa-eye",title:"Dismiss",onclick:t=>this.dismissItem(t,e)}):null,Se.element("i",{className:"fa fa-bell",title:"Unsubscribe",onclick:()=>this.unsubscribeItem(t,e)}))))}this.popout.isOpen&&this.popout.reposition()}updateButton(){this.subscribedItems.filter(e=>e.diff).length?(this.button.nodes.outer.classList.remove("nav__button-container--inactive"),this.button.nodes.outer.classList.add("nav__button-container--active"),this.button.nodes.buttonIcon.className="fa fa-bell",this.button.nodes.buttonIcon.title="New comments in your subscriptions, click to see"):(this.button.nodes.outer.classList.remove("nav__button-container--active"),this.button.nodes.outer.classList.add("nav__button-container--inactive"),this.button.nodes.buttonIcon.className="fa fa-bell-o",this.button.nodes.buttonIcon.title="No new comments in your subscriptions"),this.updatePopout()}updateItems(e){this.subscribedItems=e,this.updateButton()}async showNotification(){"granted"===await window.Notification.requestPermission()&&new Notification("ESGST Notification",{body:"There are new comments in your subscriptions.",icon:"https://dl.dropboxusercontent.com/s/lr3t3bxrxfxylqe/esgstIcon.ico?raw=1",tag:"TDS"})}async runDaemon(e){var t;await(null===(t=this.lock)||void 0===t?void 0:t.update());const s=this.subscribedItems.filter(e=>e.diff).reduce((e,t)=>e+t.diff,0);this.subscribedItems=[];for(const e in c.esgst.discussions){const t=c.esgst.discussions[e];void 0!==t.subscribed&&this.subscribedItems.push({code:e,count:t.subscribed,diff:0,name:t.name,subscribed:t.subscribed,type:"discussions"})}for(const e in c.esgst.trades){const t=c.esgst.trades[e];void 0!==t.subscribed&&this.subscribedItems.push({code:e,count:t.subscribed,diff:0,name:t.name,subscribed:t.subscribed,type:"trades"})}for(const e of this.subscribedItems){const t=(await Ne.get("discussions"===e.type?`https://www.steamgifts.com/discussion/${e.code}/`:`https://www.steamtrades.com/trade/${e.code}/`)).html.querySelectorAll(".page__heading, .page_heading")[1].querySelector(".page__heading__breadcrumbs, .page_heading_breadcrumbs").firstElementChild,s=parseInt(t.textContent.replace(/,/g,"").match(/\d+/)[0]);s!==e.count&&(e.diff=s-e.count,e.count=s)}for(const e in d.get("tds_forums")){const t=[],s=(await Ne.get(`https://www.steamgifts.com/discussions${e?"/"+e:""}/search?sort=new`)).html.querySelectorAll(".table__column__heading");for(const e of s)t.push(e.getAttribute("href").match(/\/discussion\/(.+?)\//)[1]);const n=t.filter(t=>!d.get("tds_forums")[e].includes(t)).length;this.subscribedItems.push({code:e,codes:t,diff:n,type:"forum"})}const n=this.subscribedItems.filter(e=>e.diff).reduce((e,t)=>e+t.diff,0);d.get("tds_n")&&!e&&s!==n&&this.showNotification(),c.common.notifyTds(this.subscribedItems),this.updateButton(),window.setTimeout(this.runDaemon.bind(this,!1),this.minutes)}async startDaemon(){this.lock=new Te("tds",{threshold:300,timeout:this.minutes+15e3,tryOnce:!0}),await this.lock.lock(),this.lock.isLocked?await this.runDaemon(!0):this.updateItems(await c.common.getTds())}async subscribe(e,t,s,n){if("forum"===n){if(null!==t){const s=d.get("tds_forums");s[e]=t,d.set("tds_forums",s)}else{const t=[],s=(await Ne.get(`/discussions${e?"/"+e:""}/search?sort=new`)).html.querySelectorAll(".table__column__heading");for(const e of s)t.push(e.getAttribute("href").match(/\/discussion\/(.+?)\//)[1]);if(!d.get("tds_forums")[e]){const t=d.get("tds_forums");t[e]=[],d.set("tds_forums",t)}const n=d.get("tds_forums");n[e]=Array.from(new Set(d.get("tds_forums")[e].concat(t))),d.set("tds_forums",n)}await c.common.setSetting("tds_forums",d.get("tds_forums"))}else{const a=c.esgst[n][e]||{};switch(a.readComments||(a.readComments={}),a.name=s,a.subscribed=t,a.lastUsed=Date.now(),n){case"discussions":await c.common.lockAndSaveDiscussions({[e]:a});break;case"trades":await c.common.lockAndSaveTrades({[e]:a})}}return!0}async unsubscribe(e,t){if("forum"===t)delete d.get("tds_forums")[e],await c.common.setSetting("tds_forums",d.get("tds_forums"));else{const s=c.esgst[t][e]||{};switch(s.subscribed=null,s.lastUsed=Date.now(),t){case"discussions":await c.common.lockAndSaveDiscussions({[e]:s});break;case"trades":await c.common.lockAndSaveTrades({[e]:s})}}return!0}addSubscribeButton(e,t,s,n,a,i){e||Se.insert(s,"forum"===i?"afterend":"afterbegin",Se.element("div",{className:"esgst-tds-button page_heading_btn",ref:t=>e=t})),Se.insert(e,"atinner",Se.element("i",{className:"fa fa-bell-o",title:c.common.getFeatureTooltip("tds","Subscribe")}));let o=!1;e.addEventListener("click",async()=>{o||(o=!0,Se.insert(e,"atinner",Se.element("i",{className:"fa fa-circle-o-notch fa-spin"})),await this.subscribe(t,n,a,i),this.addUnsubscribeButton(e,t,s,n,a,i))})}addUnsubscribeButton(e,t,s,n,a,i){e||Se.insert(s,"forum"===i?"afterend":"afterbegin",Se.element("div",{className:"esgst-tds-button page_heading_btn",ref:t=>e=t})),Se.insert(e,"atinner",Se.element("i",{className:"fa fa-bell",title:c.common.getFeatureTooltip("tds","Unsubscribe")}));let o=!1;e.addEventListener("click",async()=>{o||(o=!0,Se.insert(e,"atinner",Se.element("i",{className:"fa fa-circle-o-notch fa-spin"})),await this.unsubscribe(t,i),this.addSubscribeButton(e,t,s,n,a,i))})}};function $n(e,t){k(2,arguments);var s=Xs(e),n=Xs(t),a=s.getTime()-te(s),i=n.getTime()-te(n);return Math.round((a-i)/864e5)}function Wn(e,t){var s=e.getFullYear()-t.getFullYear()||e.getMonth()-t.getMonth()||e.getDate()-t.getDate()||e.getHours()-t.getHours()||e.getMinutes()-t.getMinutes()||e.getSeconds()-t.getSeconds()||e.getMilliseconds()-t.getMilliseconds();return s<0?-1:s>0?1:s}function Vn(e,t){k(2,arguments);var s=A(e),n=A(t),a=Wn(s,n),i=Math.abs($n(s,n));s.setDate(s.getDate()-a*i);var o=Number(Wn(s,n)===-a),r=a*(i-o);return 0===r?0:r}const jn=hs.buildGiveaway.bind(hs),Hn=hs.createElements.bind(hs),Jn=hs.createHeadingButton.bind(hs),Yn=hs.endless_load.bind(hs);const Kn=new class extends gt{constructor(){super(),o()(this,"updateCache",async e=>{if(this.ge.cache=JSON.parse(hs.getValue("geCache","{}")),e.code in this.ge.cache[this.ge.cacheId].giveaways){const t=this.ge.cache[this.ge.cacheId].giveaways[e.code];e.entered?t.html=t.html.replace(/"giveaway__row-outer-wrap"/,'"giveaway__row-outer-wrap" data-entered="true"').replace(/"giveaway__row-inner-wrap\s?"/,'"giveaway__row-inner-wrap is-faded"'):t.html=t.html.replace(/\sdata-entered="true"/,"").replace(/"giveaway__row-inner-wrap\sis-faded"/,'"giveaway__row-inner-wrap"'),await hs.setValue("geCache",JSON.stringify(this.ge.cache))}}),this.info={description:()=>Se.element("ul",null,Se.element("li",null,"Adds a button (",Se.element("i",{className:"fa fa-gift"})," ",Se.element("i",{className:"fa fa-search"}),") to the main page heading of any giveaway/discussion page that allows you to extract all of the giveaways that are linked in the page."),Se.element("li",null,"The giveaways are extracted recursively. For example, if giveaway A has links to giveaways B and C, the feature will extract giveaway B and all of the giveaways linked in it before moving on to giveaway C, and so on."),Se.element("li",null,"The feature keeps extracting giveaways until it no longer finds a giveaway link in the page. To prevent a loop (and consequently duplicate results), it keeps track of which giveaways it has already extracted so that they are not extracted again."),Se.element("li",null,'If you use the feature in a giveaway page, it will add a "Bump" link to the results (when available).'),Se.element("li",null,"This feature is useful for extracting trains (multiple giveaways linked to each other).")),features:{ge_j:{name:'Convert all Jigidi links to the "jigidi.com/jigsaw-puzzle" format.',sg:!0},ge_sgt:{conflicts:["ge_sgtga"],features:{ge_sgt_l:{inputItems:[{id:"ge_sgt_limit",prefix:"Limit: "}],name:"Limit how many links are opened.",sg:!0}},name:"Automatically open any SGTools links found in new tabs.",sg:!0},ge_sgtga:{conflicts:["ge_sgt"],features:{ge_sgtga_u:{name:"Automatically unlock SGTools giveaways that have not yet been unlocked.",sg:!0}},name:"Automatically retrieve the giveaway link from SGTools giveaways that have already been unlocked.",sg:!0},ge_t:{name:"Open the extractor in a new tab.",sg:!0},ge_a:{description:()=>Se.element("ul",null,Se.element("li",null,"Disabling this allows you to configure the options for the extractor before starting it.")),name:"Automatically start extracting when the popup opens.",sg:!0}},inputItems:[{id:"npth_nextRegex",prefix:"Enter the regex you want to use to detect next links when extracting onwards: "}],id:"ge",name:"Giveaway Extractor",sg:!0,type:"giveaways"}}async init(){if(Ee.subscribe(Ye,this.updateCache),Ee.subscribe(Ke,this.updateCache),(this.esgst.giveawayCommentsPath&&!document.getElementsByClassName("table--summary")[0]||this.esgst.discussionPath)&&this.checkGiveaways())this.nextRegex=new RegExp(d.get("npth_nextRegex")),this.ge_addButton();else if(c.common.isCurrentPath("Account")&&"ge"===this.esgst.parameters.esgst){this.nextRegex=new RegExp(d.get("npth_nextRegex"));const e=l.getQueryParams();if(!e.url.match(/(^\/|www\.steamgifts\.com)/)&&!await ut.contains([["allUrls"]]))return void window.alert("Giveaway Extractor: Not enough permissions to proceed.");this.ge={context:(await Ne.get(`${e.url}${e.page?"/search?page="+e.page:""}`)).html},c.esgst.customPages.ge={check:!0,load:this.ge_openPopup.bind(this,this.ge)}}}ge_addButton(){this.ge={button:Jn({id:"ge",icons:["fa-gift","fa-search"],title:"Extract all giveaways",link:d.get("ge_t")?`https://www.steamgifts.com/account/settings/profile?esgst=ge&url=${window.location.pathname.replace(/\/search.*/,"")}${this.esgst.parameters.page?"&page="+this.esgst.parameters.page:""}`:""})},d.get("ge_t")||this.ge.button.addEventListener("click",()=>this.ge_openPopup(this.ge))}async ge_openPopup(e){if(e.popup)return void e.popup.open();const t=Date.now();let s=!1;e.cache=JSON.parse(hs.getValue("geCache","{}"));for(const n in e.cache)Vn(t,e.cache[n].timestamp)>7&&(s=!0,delete e.cache[n]);s&&await hs.setValue("geCache",JSON.stringify(e.cache));const n=this.esgst.parameters.url&&this.esgst.parameters.url.match(/^\/(giveaway|discussion)\/.+?\//),a=window.location.pathname.match(/^\/(giveaway|discussion)\/.+?\//);if(e.cacheId=this.esgst.parameters.url&&(n&&n[0]||this.esgst.parameters.url)||a&&a[0],e.count=0,e.endless=0,e.total=0,e.extracted=[],e.bumpLink="",e.points=0,e.sgToolsCount=0,e.isDivided=!d.get("es")||!d.get("es_ge")||d.get("gc_gi")||d.get("gc_r")||d.get("gc_rm")||d.get("gc_ea")||d.get("gc_tc")||d.get("gc_a")||d.get("gc_mp")||d.get("gc_sc")||d.get("gc_l")||d.get("gc_m")||d.get("gc_dlc")||d.get("gc_rd")||d.get("gc_g"),c.common.isCurrentPath("Account")&&"ge"===this.esgst.parameters.esgst){const t=this.esgst.sidebar.nextElementSibling;d.get("removeSidebarInFeaturePages")&&this.esgst.sidebar.remove(),t.setAttribute("data-esgst-popup","true"),t.innerHTML="",e.heading=pt.create("ge",[{name:"ESGST",url:this.esgst.settingsUrl},{name:"Giveaway Extractor",url:"https://www.steamgifts.com/account/settings/profile?esgst=ge"}]).insert(t,"beforeend");const s=Hn(t,"beforeend",[{type:"div"}]),n=Hn(t,"beforeend",[{type:"div"}]);e.popup={description:s,scrollable:n,open:()=>{},reposition:()=>{}}}else e.popup=new lt({addScrollable:!0}),e.heading=pt.create("ge",["Extract giveaways"]).insert(e.popup.description,"afterbegin");e.results=Hn(e.popup.scrollable,"beforeend",[{attributes:{class:"esgst-text-left"},type:"div"}]),(d.get("gas")||d.get("gf")&&d.get("gf_m")||d.get("mm"))&&(d.get("gas")&&this.esgst.modules.giveawaysGiveawaysSorter.init(e.heading.nodes.outer),d.get("gf")&&d.get("gf_m")&&e.heading.nodes.outer.appendChild(this.esgst.modules.giveawaysGiveawayFilters.filters_addContainer(e.heading.nodes.outer,"Ge")),d.get("mm")&&this.esgst.modules.generalMultiManager.mm(e.heading.nodes.outer));const i=tt.create({color:"alternate-white",tooltip:"Options",icons:["fa-gear"]}).insert(e.heading.nodes.outer,"beforeend"),o=new mt("",i.nodes.outer,0,!0);new vt(o.popout,"ge_extractOnward",null,"Only extract from the current giveaway onward.",!1,!1,'With this option enabled, if you are in the 6th giveaway of a train that has links to the previous giveaways, the extractor will not go back and extract giveaways 1-5. This method is not 100% accurate, because the feature looks for a link with any variation of "next" in the description of the giveaway to make sure that it is going forward, so if it does not find such a link, the extraction will stop.',d.get("ge_extractOnward")),hs.observeNumChange(new vt(o.popout,"ge_flushCache",null,Se.element("fragment",null,"Flush the cache if it is older than"," ",Se.element("input",{className:"esgst-switch-input",step:"0.1",type:"number",value:d.get("ge_flushCacheHours")})," ","hours."),!1,!1,null,d.get("ge_flushCache")).name.firstElementChild,"ge_flushCacheHours",!0),new vt(o.popout,"ge_ignoreDiscussionComments",null,"Ignore discussion comments when extracting giveaways.",!1,!1,null,d.get("ge_ignoreDiscussionComments")),new vt(o.popout,"ge_ignoreGiveawayComments",null,"Ignore giveaway comments when extracting giveaways.",!1,!1,null,d.get("ge_ignoreGiveawayComments")),e.extractOnward=d.get("ge_extractOnward"),e.flushCache=d.get("ge_flushCache"),e.flushCacheHours=d.get("ge_flushCacheHours"),e.ignoreDiscussionComments=d.get("ge_ignoreDiscussionComments"),e.ignoreGiveawayComments=d.get("ge_ignoreGiveawayComments"),e.cacheWarning=null;const r=()=>new Promise(s=>{if(e.hasScrolled&&e.isComplete)s();else if(e.hasScrolled=!1,e.isComplete=!1,(e.cacheWarning||e.reExtract)&&(e.reExtract&&(e.extractOnward=d.get("ge_extractOnward"),e.ignoreDiscussionComments=d.get("ge_ignoreDiscussionComments"),e.ignoreGiveawayComments=d.get("ge_ignoreGiveawayComments"),e.count=0,e.endless=0,e.total=0,e.extracted=[],e.bumpLink="",e.points=0,e.sgToolsCount=0),e.flushCache=!0,e.flushCacheHours=0,e.reExtract=!1,e.cacheWarning&&e.cacheWarning.remove(),e.cacheWarning=null,e.results.innerHTML="",e.cache[e.cacheId]={codes:[],giveaways:{},bumpLink:"",ithLinks:new Set,jigidiLinks:new Set,timestamp:t}),e.mainCallback=s,e.callback)e.progressBar.setLoading(),e.callback();else{e.isCanceled=!1,e.button&&e.button.classList.add("esgst-busy"),e.progressBar.setLoading(Se.element("fragment",null,Se.element("span",{ref:t=>e.progressBarCounter=t},e.total)," giveaways extracted.")).show();let t=this.ge_getGiveaways(e,c.common.isCurrentPath("Account")&&"ge"===this.esgst.parameters.esgst?e.context:this.esgst.pageOuterWrap);this.ge_extractGiveaways(e,t,0,t.length,this.ge_completeExtraction.bind(this,e))}}),l=()=>{e.mainCallback=null,e.isCanceled=!0,this.ge_completeExtraction(e)};if(e.extractButton=tt.create([{color:"green",icons:["fa-search"],name:"Extract",switchTo:{onReturn:1},onClick:r},{template:"error",name:"Cancel",switchTo:{onReturn:0},onClick:l},{color:"green",icons:["fa-search"],name:"Extract More",switchTo:{onReturn:3},onClick:r},{template:"error",name:"Cancel",switchTo:{onReturn:0},onClick:l},{color:"green",icons:["fa-search"],name:"Re-Extract",switchTo:{onReturn:5},onClick:r},{template:"error",name:"Cancel",switchTo:{onReturn:0},onClick:l}]).insert(e.heading.nodes.outer,"beforeend"),e.progressBar=at.create().insert(e.popup.description,"beforeend").hide(),e.popup.open(),e.flushCache&&e.cache[e.cacheId]&&t-e.cache[e.cacheId].timestamp>36e5*parseInt(e.flushCacheHours)&&delete e.cache[e.cacheId],!e.extractOnward&&e.cache[e.cacheId]){e.cache[e.cacheId].ithLinks=new Set(e.cache[e.cacheId].ithLinks),e.cache[e.cacheId].jigidiLinks=new Set(e.cache[e.cacheId].jigidiLinks),Se.insert(e.popup.description,"beforeend",Se.element("div",{ref:t=>e.cacheWarning=t},`These results were retrieved from the cache from ${hs.getTimeSince(e.cache[e.cacheId].timestamp)} ago (${this.esgst.modules.generalAccurateTimestamp.at_formatTimestamp(e.cache[e.cacheId].timestamp)}). If you want to update the cache, you will have to extract again.`));let t="",s=0,n=0;for(const a of e.cache[e.cacheId].codes){n%50==0&&(t="");const i=e.cache[e.cacheId].giveaways[a];i?(t+=i.html,s+=i.points,n+=1):d.get("ge_sgt")&&(!d.get("ge_sgt_l")||e.sgToolsCount<d.get("ge_sgt_limit"))&&(yt.open("https://www.sgtools.info/giveaways/"+a),e.sgToolsCount+=1),n%50==0&&(e.results.insertAdjacentHTML("beforeend",t),e.results.lastElementChild.classList.add("esgst-es-page-"+e.endless),await c.common.timeout(100))}n%50!=0&&(e.results.insertAdjacentHTML("beforeend",t),e.results.lastElementChild.classList.add("esgst-es-page-"+e.endless)),e.progressBar.setInfo(Se.element("fragment",null,Se.element("span",{ref:t=>e.progressBarCounter=t},e.total)," giveaways extracted.")).show(),e.progressBarCounter.textContent=n,await Yn(e.results,!1,"ge",e.endless);const a=[{attributes:{class:"markdown esgst-text-center"},type:"div",children:[]}];e.cache[e.cacheId].bumpLink&&!this.esgst.discussionPath&&a[0].children.push({type:"h2",children:[{attributes:{href:e.cache[e.cacheId].bumpLink},text:"Bump",type:"a"}]}),a[0].children.push({text:s+"P required to enter all giveaways.",type:"node"});for(let t of[...e.cache[e.cacheId].ithLinks,...e.cache[e.cacheId].jigidiLinks]){if(d.get("ge_j")){const e=this.extractJigidiId(t);e&&(t="https://www.jigidi.com/jigsaw-puzzle/"+e)}a[0].children.push({type:"br"},{attributes:{href:t},text:t,type:"a"})}Hn(e.results,"afterbegin",a),Hn(e.results,"beforeend",a)}else e.cache[e.cacheId]={codes:[],giveaways:{},bumpLink:"",ithLinks:new Set,jigidiLinks:new Set,timestamp:t},d.get("ge_a")&&e.extractButton.onClick();d.get("es")&&d.get("es_ge")&&e.popup.scrollable.addEventListener("scroll",this.checkScroll.bind(this,e))}checkScroll(e,t){e.cacheWarning||e.isCanceled||!e.extractButton||e.extractButton.isBusy||!(e.popup.scrollable.scrollTop+e.popup.scrollable.offsetHeight>=e.popup.scrollable.scrollHeight||t)||(e.hasScrolled=!0,e.extractButton.onClick())}ge_extractGiveaways(e,t,s,n,a){e.isCanceled||(s<n?this.ge_extractGiveaway(e,t[s],()=>window.setTimeout(this.ge_extractGiveaways.bind(this),0,e,t,++s,n,a)):a())}async ge_extractGiveaway(e,t,s){if(!e.isCanceled)if(e.isDivided&&50===e.count){let n,a,i;for(e.mainCallback(),e.mainCallback=null,e.count=0,await Yn(e.results,!1,"ge",e.endless),e.extractButton.build(3),e.progressBar.setInfo(),e.callback=this.ge_extractGiveaway.bind(this,e,t,s),a=!1,n=e.results.querySelectorAll(":scope > .esgst-es-page-"+e.endless),i=n.length-1;i>-1&&!a;--i)n[i].firstElementChild.classList.contains("esgst-hidden")&&(a=!0);e.endless++,d.get("es")&&d.get("es_ge")&&this.checkScroll(e,a)}else if(e.extracted.indexOf(t)<0){let n=t.length>5;if(n){if(d.get("ge_sgt")&&(!d.get("ge_sgt_l")||e.sgToolsCount<d.get("ge_sgt_limit")))return yt.open("https://www.sgtools.info/giveaways/"+t),e.cache[e.cacheId].codes.push(t),e.extracted.push(t),e.sgToolsCount+=1,void s();if(d.get("ge_sgtga"))try{d.get("ge_sgtga_u")&&await Ne.get(`https://www.sgtools.info/giveaways/${t}/check`,{queue:!0});const s=await Ne.get(`https://www.sgtools.info/giveaways/${t}/getLink`,{queue:!0});s.json&&s.json.url&&(e.extracted.push(t),t=s.json.url.match(/\/giveaway\/(.{5})/)[1],n=!1)}catch(e){dt.warning(e.message,e.stack)}}if(e.extracted.indexOf(t)<0){let a,i,o,r,l,c;try{let e=await Ne.get(n?"https://www.sgtools.info/giveaways/"+t:`/giveaway/${t}/`);c=e.html,i=c.getElementsByClassName("sidebar__error")[0],o=await jn(c,e.url,i&&i.textContent)}catch(e){}if(e.isCanceled)return;if(o)Hn(e.results,"beforeend",o.html),e.results.lastElementChild.classList.add("esgst-es-page-"+e.endless),o.html=e.results.lastElementChild.outerHTML,e.cache[e.cacheId].codes.push(t),e.cache[e.cacheId].giveaways[t]=o,e.points+=o.points,e.count+=1,e.total+=1,e.progressBarCounter.textContent=e.total,e.extracted.push(t),n?s():(e.bumpLink||(a=c.querySelector('[href*="/discussion/"]'),a&&(e.bumpLink=a.getAttribute("href"),e.cache[e.cacheId].bumpLink=e.bumpLink)),r=this.ge_getGiveaways(e,c),l=r.length,l>0?window.setTimeout(()=>this.ge_extractGiveaways(e,r,0,l,s),0):s());else if(n)s();else{let n,a,i,o,r;try{let e=await Ne.get(`/giveaway/${t}/`,{anon:!0});r=e.html,a=await jn(r,e.url,null,!0)}catch(e){}a?(Hn(e.results,"beforeend",a.html),e.results.lastElementChild.classList.add("esgst-es-page-"+e.endless),a.html=e.results.lastElementChild.outerHTML,e.cache[e.cacheId].codes.push(t),e.cache[e.cacheId].giveaways[t]=a,e.points+=a.points,e.count+=1,e.total+=1,e.progressBarCounter.textContent=e.total,e.extracted.push(t),e.bumpLink||(n=r.querySelector('[href*="/discussion/"]'),n&&(e.bumpLink=n.getAttribute("href"),e.cache[e.cacheId].bumpLink=e.bumpLink)),i=this.ge_getGiveaways(e,r),o=i.length,o>0?window.setTimeout(()=>this.ge_extractGiveaways(e,i,0,o,s),0):s()):s()}}else s()}else s()}ge_getGiveaways(e,t){const s=["img[title]",'[href*="/giveaway/"]','[href*="sgtools.info/giveaways"]'];let n=[];if(t===e.context){let e=l.getQueryParams().url.match(/\/giveaway\/(.+?)\//);e&&n.push(e[1])}else if(t===this.esgst.pageOuterWrap&&this.esgst.giveawayPath){let e=c.esgst.locationHref.match(/\/giveaway\/(.+?)\//);e&&n.push(e[1])}const a={code:null,count:0},i=t.querySelector(".page__description"),o=t.querySelector(".markdown"),r=t.querySelectorAll(".comments");let g;if(i){g=i.querySelectorAll(s.join(", "));for(const t of g)this.ge_getGiveaway(t,e,n,a);if(!e.ignoreGiveawayComments&&r.length>0){g=r[r.length-1].querySelectorAll(s.map(e=>".markdown "+e).join(", "));for(const t of g)this.ge_getGiveaway(t,e,n)}}else if(o){g=o.querySelectorAll(s.join(", "));for(const t of g)this.ge_getGiveaway(t,e,n,a);if(!e.ignoreDiscussionComments&&r.length>0){g=r[r.length-1].querySelectorAll(s.map(e=>".markdown "+e).join(", "));for(const t of g)this.ge_getGiveaway(t,e,n)}}else{g=t.querySelectorAll(s.join(", "));for(const t of g)this.ge_getGiveaway(t,e,n,a)}a.count>0&&n.push(a.code);const u=['[href*="itstoohard.com/puzzle/"]'];let m;m=e.ignoreDiscussionComments&&!i&&o?o.querySelectorAll(u.join(", ")):e.ignoreGiveawayComments&&i?i.querySelectorAll(u.join(", ")):t.querySelectorAll(u.map(e=>".markdown "+e).join(", "));for(const t of m){const s=t.getAttribute("href");e.cache[e.cacheId].ithLinks.add(s)}const h=['[href*="jigidi.com/jigsaw-puzzle"]','[href*="jigidi.com/solve"]','[href*="jigidi.com/created"]'];let p;p=e.ignoreDiscussionComments&&!i&&o?o.querySelectorAll(h.join(", ")):e.ignoreGiveawayComments&&i?i.querySelectorAll(h.join(", ")):t.querySelectorAll(h.map(e=>".markdown "+e).join(", "));for(const t of p){let s=t.getAttribute("href");if(d.get("ge_j")){const e=this.extractJigidiId(s);e&&(s="https://www.jigidi.com/jigsaw-puzzle/"+e)}e.cache[e.cacheId].jigidiLinks.add(s)}return n}ge_getGiveaway(e,t,s,n){if(e.matches("img")){const n=e.getAttribute("title");return void(5===n.length&&t.extracted.indexOf(n)<0&&s.indexOf(n)<0&&s.push(n))}const a=e.getAttribute("href");let i=a.match(/\/(\w{5})\b/);if(!i&&(i=a.match(/(\w{8}-\w{4}-\w{4}-\w{4}-\w{12})/),!i))return;const o=i[1];if(!n||!t.extractOnward||this.esgst.discussionPath||e.textContent.toLowerCase().match(this.nextRegex))t.extracted.indexOf(o)<0&&s.indexOf(o)<0&&s.push(o);else if(i=e.textContent.match(/\d+/),i){const e=parseInt(i[0]);e>n.count&&t.extracted.indexOf(o)<0&&s.indexOf(o)<0&&(n.code=o,n.count=e)}}checkGiveaways(){let e=!1;const t=document.querySelectorAll('.markdown img[title], .markdown [href*="/giveaway/"], .markdown [href*="sgtools.info/giveaways"]');for(const s of t){if(!s.matches("img"))return!0;5===s.getAttribute("title").length&&(e=!0)}return e}async ge_completeExtraction(e){e.button&&e.button.classList.remove("esgst-busy"),e.progressBar.setSuccess(),e.mainCallback&&(e.mainCallback(),e.mainCallback=null),await Yn(e.results,!1,"ge",e.endless);const t=[{attributes:{class:"markdown esgst-text-center"},type:"div",children:[]}];e.bumpLink&&!this.esgst.discussionPath&&t[0].children.push({type:"h2",children:[{attributes:{href:e.bumpLink},text:"Bump",type:"a"}]}),t[0].children.push({text:e.points+"P required to enter all giveaways.",type:"node"});for(const s of[...e.cache[e.cacheId].ithLinks,...e.cache[e.cacheId].jigidiLinks])t[0].children.push({type:"br"},{attributes:{href:s},text:s,type:"a"});Hn(e.results,"afterbegin",t),Hn(e.results,"beforeend",t),e.extractButton.build(5),e.reExtract=!0,e.isComplete=!0,e.isCanceled||e.extractOnward||(e.cache[e.cacheId].ithLinks=Array.from(e.cache[e.cacheId].ithLinks),e.cache[e.cacheId].jigidiLinks=Array.from(e.cache[e.cacheId].jigidiLinks),await hs.setValue("geCache",JSON.stringify(e.cache))),$(".esgst-gv-icons [data-draggable-id]").removeClass("featured__column")}extractJigidiId(e){const t=e.match(/(jigsaw-puzzle|solve)\/([A-Za-z0-9]+)|id=([A-Za-z0-9]+)/);return t[2]||t[3]}},zn=hs.buildGiveaway.bind(hs),Qn=hs.createElements.bind(hs),Zn=hs.endless_load.bind(hs),Xn=hs.getFeatureTooltip.bind(hs),ea=hs.getValue.bind(hs),ta=hs.lockAndSaveGiveaways.bind(hs),sa=hs.rot.bind(hs),na=hs.setValue.bind(hs);const aa=new class extends gt{constructor(){super(),this.info={description:()=>Se.element("ul",null,Se.element("li",null,"Adds an icon (",Se.element("i",{className:"fa fa-star"})," if the giveaway is open,"," ",Se.element("i",{className:"fa fa-star esgst-green"})," if it is open and new,"," ",Se.element("i",{className:"fa fa-star esgst-yellow"})," if it is not open yet and"," ",Se.element("i",{className:"fa fa-star esgst-red"}),' if it has already ended) next to a comment\'s "Permalink" (in any page) for each encrypted giveaway that the comment has (if it has any). The icon links to the giveaway.'),Se.element("li",null,"Encrypted giveaways are basically invite only giveaway codes that ESGST encrypts using various encryption methods and hides in your comments so that they can only be visible through the source code of the page. Other ESGST users are able to easily see these giveaways if they have this feature enabled, but since the codes are visible through the source code of the page, anyone who finds them and manages to decrypt them can access the giveaways. So it is more like a puzzle that ESGST users can solve instantly and non-ESGST users can solve if they give it some effort, though it is doubtful that someone will check the source code of every page they open on SteamGifts looking for the codes."),Se.element("li",null,"To add encrypted giveaways to your comments, check"," ",Se.element("span",{"data-esgst-feature-id":"cfh_g"}),"."),Se.element("li",null,"Adds a button (",Se.element("i",{className:"fa fa-star"}),") next to the ESGST button at the header of any page that allows you to view all of the currently open decrypted giveaways that you have unlocked (they are unlocked whenever you visit a page that contains them).")),features:{ged_b:{description:()=>Se.element("ul",null,Se.element("li",null,"With this option enabled, the header button will always appear if there are decrypted giveaways in the page, even if they have already ended (but they will not be listed in the popup).")),name:"Always show the header button if there are decrypted giveaways in the page.",sg:!0},ged_t:{name:"Open the list of decrypted giveaways in a new tab.",sg:!0}},id:"ged",name:"Giveaway Encrypter/Decrypter",sg:!0,type:"giveaways"}}init(){if(!this.esgst.sg)return;let e={newGiveaways:[]};c.common.isCurrentPath("Account")&&"ged"===this.esgst.parameters.esgst?this.ged_openPopup(e):(e.button=c.header.addButtonContainer({buttonIcon:"fa fa-star",buttonName:"ESGST Decrypted Giveaways",isActive:!0,isNotification:!0,side:"left",url:d.get("ged_t")?"https://www.steamgifts.com/account/settings/profile?esgst=ged":"",openInNewTab:!0}),e.button.nodes.outer.classList.add("esgst-hidden"),e.button.nodes.buttonIcon.title=Xn("ged","View your decrypted giveaways"),d.get("ged_t")||e.button.nodes.outer.addEventListener("click",()=>{e.isPopup=!0,this.ged_openPopup(e)}),this.ged_getGiveaways(e,!0)),this.esgst.ged_addIcons=this.ged_addIcons.bind(this,e)}async ged_openPopup(e){e.isPopup?(e.popup=new lt({addScrollable:!0,isTemp:!0}),e.container=e.popup.description,e.context=e.popup.scrollable):(e.popup=this.esgst.sidebar.nextElementSibling,d.get("removeSidebarInFeaturePages")&&this.esgst.sidebar.remove(),e.popup.innerHTML="",e.container=e.context=Qn(e.popup,"beforeend",[{type:"div"}]),e.context.setAttribute("data-esgst-popup",!0));const t=pt.create("ged",[{name:"ESGST",url:this.esgst.settingsUrl},{name:"Decrypted Giveaways",url:"https://www.steamgifts.com/account/settings/profile?esgst=ged"}]).insert(e.popup.description||e.popup,"afterbegin");Qn(e.context,"atinner",[{attributes:{class:"fa fa-circle-o-notch fa-spin"},type:"i"},{text:"Loading...",type:"node"}]),await this.ged_getGiveaways(e),e.context.innerHTML="",(d.get("gas")||d.get("gf")&&d.get("gf_m")||d.get("mm"))&&(d.get("gas")&&this.esgst.modules.giveawaysGiveawaysSorter.init(t.nodes.outer),d.get("gf")&&d.get("gf_m")&&t.nodes.outer.appendChild(this.esgst.modules.giveawaysGiveawayFilters.filters_addContainer(t.nodes.outer,"Ged")),d.get("mm")&&this.esgst.modules.generalMultiManager.mm(t.nodes.outer)),e.results=Qn(e.context,"beforeend",[{attributes:{class:"esgst-text-left"},type:"div"}]),e.loadMoreButton=tt.create([{color:"green",icons:["fa-plus"],name:"Load More",onClick:this.ged_loadGiveaways.bind(this,e)},{template:"loading",isDisabled:!0,name:"Loading more..."}]).insert(t.nodes.outer,"beforeend"),e.isPopup&&e.popup.open(),e.loadMoreButton.onClick(),d.get("es_ged")&&e.context.addEventListener("scroll",this.ged_checkEndless.bind(this,e))}async ged_getGiveaways(e,t){e.giveaways=[],e.i=0;let s={},n=Date.now();const a=new Te("ged",{threshold:300});await a.lock(),this.esgst.decryptedGiveaways=JSON.parse(ea("decryptedGiveaways"));for(let t in this.esgst.decryptedGiveaways)if(this.esgst.decryptedGiveaways.hasOwnProperty(t)){this.esgst.decryptedGiveaways[t].html&&delete this.esgst.decryptedGiveaways[t].html;let a=this.esgst.decryptedGiveaways[t].timestamp<=n,i=!0,o=this.esgst.giveaways[t];if(o){const e=d.get("gf_presetGed");if(e){let t;for(t=d.get("gf_presets").length-1;t>-1&&d.get("gf_presets")[t].name!==e;t--);if(t>-1){const e=d.get("gf_presets")[t];i=this.esgst.modules.giveawaysGiveawayFilters.filters_filterItem(this.esgst.modules.giveawaysGiveawayFilters.getFilters(!0),o,e.rules,!0)}}i&&a&&!o.started&&(await this.ged_getGiveaway(t,s,!0),a=this.esgst.decryptedGiveaways[t].timestamp<=n)}i&&!a&&e.giveaways.push({code:t,source:this.esgst.decryptedGiveaways[t].source,timestamp:this.esgst.decryptedGiveaways[t].timestamp})}await ta(s,t),await na("decryptedGiveaways",JSON.stringify(this.esgst.decryptedGiveaways)),await a.unlock(),e.n=e.giveaways.length,e.n>0&&(e.button&&e.button.nodes.outer.classList.remove("esgst-hidden"),e.giveaways=l.sortArray(e.giveaways,!1,"timestamp"))}async ged_getGiveaway(e,t,s,n){let a=await Ne.get(`/giveaway/${e}/`),i=(await this.esgst.modules.giveaways.giveaways_get(a.html,!1,a.url,!1,null,!0))[0];return i&&(t[e]=i,i.started&&s&&(this.esgst.decryptedGiveaways[e].timestamp=i.endTime)),n&&(this.esgst.decryptedGiveaways[e]={source:n,timestamp:i&&i.endTime||0}),i}async ged_loadGiveaways(e){let t=0;for(;(t<5||d.get("es_ged")&&e.context.scrollHeight<=e.context.offsetHeight||(e.results.children.length-(this.esgst.gfPopup&&parseInt(this.esgst.gfPopup.filteredCount.textContent)||0))%5!=0)&&e.i<e.n;){t+=1;let s=e.giveaways[e.i];e.i+=1;let n=await Ne.get(`/giveaway/${s.code}/`),a=await zn(n.html,n.url);if(!a||!a.started)continue;let i=Qn(e.results,"beforeend",a.html);s.source&&Qn(i.getElementsByClassName("giveaway__columns")[0],"afterbegin",[{attributes:{class:"esgst-ged-source",href:""+(s.source.match(/\/discussion\//)?s.source:"/go/comment/"+s.source)},text:"Source",type:"a"}]),await Zn(i,!1,"ged"),e.newGiveaways.indexOf(s.code)>-1&&i.getElementsByClassName("giveaway__heading__name")[0].insertAdjacentText("afterbegin","[NEW] ")}e.i>=e.n&&e.loadMoreButton.destroy()}ged_checkEndless(e){e.context.scrollTop+e.context.offsetHeight>=e.context.scrollHeight&&!e.loadMoreButton.isBusy&&e.loadMoreButton.onClick()}async ged_addIcons(e,t){let s={},n=Date.now(),a=null,i=!1,o=!1;for(let r=t.length-1;r>-1;r--){let l=t[r],c=l.actions.getElementsByClassName("esgst-ged-icon");for(let e=c.length-1;e>-1;e--)c[0].remove();if(!l.displayState)continue;let g=l.displayState.querySelectorAll('[href^="ESGST-"]');for(let t=g.length-1;t>-1;t--){let r=g[t].getAttribute("href").match(/ESGST-(.+)/)[1];a||(a=new Te("ged",{threshold:300}),await a.lock(),this.esgst.decryptedGiveaways=JSON.parse(ea("decryptedGiveaways"))),r=this.ged_decryptCode(r);let c=this.esgst.decryptedGiveaways[r]&&n>this.esgst.decryptedGiveaways[r].timestamp,u=!1,m=this.esgst.giveaways[r]&&this.esgst.giveaways[r].started;if(!this.esgst.decryptedGiveaways[r]||c&&!m){let t=await this.ged_getGiveaway(r,s,!1,l.id||window.location.href);e.newGiveaways.push(r),t&&(c=t.ended,m=t.started)}c?d.get("ged_b")&&(i=!0):o=u=!0,Qn(l.actions,"beforeend",[{attributes:{class:"esgst-ged-icon"+(c?" esgst-red":m?u?" esgst-green":"":" esgst-yellow"),href:`/giveaway/${r}/`,title:Xn("ged","ESGST Decrypted Giveaway")},type:"a",children:[{attributes:{class:"fa fa-star"},type:"i"}]}])}}a&&(await ta(s),await na("decryptedGiveaways",JSON.stringify(this.esgst.decryptedGiveaways)),await a.unlock()),e.button&&(i||o)&&(e.button.nodes.outer.classList.remove("esgst-hidden"),o&&e.button.nodes.buttonIcon.classList.add("esgst-positive"))}ged_encryptCode(e){let t,s,n,a,i,o;switch(t="NOPQRSTUVWXYZABCDEFGHIJKLM",Math.floor(4*Math.random())){case 0:for(i=sa(e,13),s="",n=0,a=i.length;n<a;++n)s+=i.charCodeAt(n).toString(16);return s;case 1:for(i=sa(e,13),s="",n=0,a=i.length;n<a;++n)s+=i.charCodeAt(n).toString(16);return s=s.replace(/\d/g,e=>t[parseInt(e)]),s;case 2:for(o=Math.ceil(25*Math.random()),i=sa(e,o),s="",n=0,a=i.length;n<a;++n)s+=i.charCodeAt(n).toString(16);return s+=o.toString(16),s;case 3:for(o=Math.ceil(25*Math.random()),i=sa(e,o),s="",n=0,a=i.length;n<a;++n)s+=i.charCodeAt(n).toString(16);return s+=o.toString(16),s=s.replace(/\d/g,e=>t[parseInt(e)]),s}}ged_decryptCode(e){let t,s,n;return t="NOPQRSTUVWXYZABCDEFGHIJKLM",n=(e=e.replace(/-/g,"").replace(/[A-Z]/g,e=>""+"NOPQRSTUVWXYZABCDEFGHIJKLM".indexOf(e))).slice(10),n=n?parseInt(n,16):13,s="",e.slice(0,10).match(/../g).forEach(e=>{s+=String.fromCharCode(parseInt(e,16))}),sa(s,26-n)}async ged_saveGiveaways(e,t){let s=[],n=e.querySelectorAll('[href^="ESGST-"]');for(let e=0,t=n.length;e<t;e++){let t=n[e].getAttribute("href").match(/ESGST-(.+)/)[1];s.push(this.ged_decryptCode(t))}if(!s.length)return;let a={};this.esgst.decryptedGiveaways=JSON.parse(ea("decryptedGiveaways"));let i=[];s.forEach(e=>{if(this.esgst.decryptedGiveaways[e])return;let s=this.esgst.giveaways[e];s&&s.endTime?this.esgst.decryptedGiveaways[e]={source:t,timestamp:s.endTime}:i.push(this.ged_getGiveaway(e,a,!1,t))}),await Promise.all(i),await na("decryptedGiveaways",JSON.stringify(this.esgst.decryptedGiveaways)),await ta(a)}},ia=hs.getFeatureTooltip.bind(hs);const oa=new class extends gt{constructor(){super(),o()(this,"init",()=>{const e=document.getElementsByClassName("table--summary")[0];if(!this.esgst.giveawayPath||!e)return;const t=encodeURIComponent(e.getElementsByClassName("table__column__secondary-link")[0].textContent);Se.insert(e.getElementsByClassName("table__row-outer-wrap")[0],"afterend",Se.element("div",{className:"table__row-outer-wrap",title:ia("gesl")},Se.element("div",{className:"table__row-inner-wrap"},Se.element("div",{className:"table__column--width-small"},Se.element("span",{className:"esgst-bold"},"Search Links")),Se.element("div",{className:"table__column--width-fill esgst-gesl"},Se.element("a",{href:"https://www.steamgifts.com/giveaways/search?q="+t,target:"_blank",rel:"noreferrer",title:"Search for active giveaways"},Se.element("i",{className:"fa"},Se.element("img",{src:this.esgst.sgIcon}))),Se.element("a",{href:"http://store.steampowered.com/search/?term="+t,target:"_blank",rel:"noreferrer",title:"Search on Steam"},Se.element("i",{className:"fa fa-steam"})),Se.element("a",{href:"https://steamdb.info/search/?a=app&q="+t,target:"_blank",rel:"noreferrer",title:"Search on SteamDB"},Se.element("i",{className:"fa"},Se.element("img",{src:"https://steamdb.info/static/logos/16px.png"}))),Se.element("a",{href:"https://barter.vg/search?q="+t,target:"_blank",rel:"noreferrer",title:"Search on Barter.vg"},Se.element("i",{className:"fa"},Se.element("img",{src:"https://bartervg.com/imgs/ico/barter/favicon-16x16.png"})))))))}),this.info={description:()=>Se.element("ul",null,Se.element("li",null,'If you cannot access a giveaway because of many different reasons, a "Search Links" row is added to the table of the'," ",Se.element("a",{href:"https://www.steamgifts.com/giveaway/FN2PK/"},"error")," page containing 4 links that allow you to search for the game elsewhere:"),Se.element("ul",null,Se.element("li",null,"A SteamGifts icon that allows you to search for open giveaways of the game on SteamGifts."),Se.element("li",null,Se.element("i",{className:"fa fa-steam"})," allows you to search for the game on Steam."),Se.element("li",null,Se.element("i",{className:"fa"},Se.element("img",{src:"https://steamdb.info/static/logos/16px.png"}))," ","allows you to search for the game on SteamDB."),Se.element("li",null,Se.element("i",{className:"fa"},Se.element("img",{src:"https://bartervg.com/imgs/ico/barter/favicon-16x16.png"}))," ","allows you to search for the game on Barter.vg."))),id:"gesl",name:"Giveaway Error Search Links",sg:!0,type:"giveaways"}}},ra=hs.createElements.bind(hs),la=hs.createElements.bind(hs),ca=hs.getFeatureTooltip.bind(hs),da=hs.setSetting.bind(hs);class ga extends gt{constructor(e){super(),this.id=e,this.isProgrammaticChange=!1}getFilters(e){}addSingleButton(e){this.singleButton=c.common.createHeadingButton({id:this.id+"_s_s",icons:[e],title:"Hide / unhide items filtered by single filters temporarily"}),this.singleButton.classList.add("esgst-hidden"),Se.insert(this.singleButton,"afterbegin",Se.element("span",null)),this.singleSwitch=new vt(this.singleButton.firstElementChild,null,!0,"",!1,!1,null,!0),this.singleSwitch.onChange=()=>this.toggleFilteredItems(),Se.insert(this.singleButton,"beforeend",Se.element("span",{ref:e=>this.singleCounter=e},"0"))}toggleFilteredItems(){const e=document.querySelectorAll(`[data-esgst-not-filterable="${this.id}"]`);if(this.singleSwitch.value)for(const t of e)t.classList.add("esgst-hidden");else for(const t of e)t.classList.remove("esgst-hidden")}updateSingleCounter(e=1){if(!this.singleCounter)return;const t=parseInt(this.singleCounter.textContent)+e;this.singleCounter.textContent=t,t>0&&this.singleButton.classList.remove("esgst-hidden")}filters_addContainer(e,t){const s={basicFilters:{},id:this.id,key:this.id+"_presets",popup:t,rules:null,type:t||(this.esgst.gamePath?"Games":this.esgst.groupPath?"Groups":window.location.search.match(/type/)?{wishlist:"Wishlist",recommended:"Recommended",group:"Group",new:"New"}[window.location.search.match(/type=(wishlist|recommended|group|new)/)[1]]:this.esgst.createdPath?"Created":this.esgst.enteredPath?"Entered":this.esgst.wonPath?"Won":this.esgst.userPath?"User":"")};s.filters=this.getFilters(t),t?this.esgst[this.id+"Popup"]=s:this.esgst[this.id]=s;const n=document.createElement("div");n.className="esgst-heading-button esgst-gf-heading-button",n.id="esgst-"+s.id,n.setAttribute("data-draggable-id",s.id),ra(n,"atinner",[{attributes:{class:"esgst-gf-toggle-switch"},type:"span"},{attributes:{class:"fa fa-sliders",title:ca(s.id,"Manage presets")},type:"i"}]);const a=new vt(n.firstElementChild,`${s.id}_enable${s.type}`,!0,"",!1,!1,null,d.get(`${s.id}_enable${s.type}`)),i=n.lastElementChild;a.onEnabled=this.filters_filter.bind(this,s),a.onDisabled=this.filters_filter.bind(this,s,!0),s.container=ra(e,"afterend",[{attributes:{class:"esgst-gf-container"},type:"div",children:[{attributes:{class:"esgst-gf-box"},type:"div",children:[{attributes:{class:"esgst-gf-filters esgst-hidden"},type:"div",children:[{attributes:{class:"esgst-gf-left-panel"},type:"div",children:[{attributes:{class:"esgst-gf-box warning esgst-hidden"},type:"div"},{attributes:{class:"esgst-gf-basic-filters"},type:"div",children:[{attributes:{class:"esgst-gf-number-filters"},type:"div"},{attributes:{class:"esgst-gf-boolean-filters"},type:"div"},{attributes:{class:"esgst-gf-string-filters"},type:"div"}]},{type:"div",children:[{text:"Advanced ",type:"node"},{attributes:{class:"fa fa-question-circle",title:"Advanced filters offer more options and flexibility, but may be more complex to understand and use. When you change settings in the basic filters, they will also be changed in the advanced ones, and vice-versa. But the two types are not compatible backwards: basic -> advanced conversion works fine, but advanced -> basic conversion does not, and will result in the loss of any settings that are exclusive to the advanced filter. Bear this in mind when saving a preset, since the last applied preset will be saved."},type:"i"}]},{attributes:{class:"esgst-clickable"},type:"div",children:[{text:"Manual ",type:"node"},{attributes:{class:"fa fa-book"},type:"i"}]},{attributes:{class:"esgst-gf-advanced-filters"},type:"div"}]},{attributes:{class:"esgst-gf-right-panel"},type:"div",children:[{attributes:{class:"esgst-gf-steamgifts-filters"},type:"div",children:[{type:"div",children:[{attributes:{class:"esgst-bold"},text:"SteamGifts Filters:",type:"span"}]}]},{type:"br"},{attributes:{class:"esgst-gf-preset-panel"},type:"div",children:[{type:"div",children:[{attributes:{class:"esgst-bold"},text:"Preset:",type:"span"},{attributes:{class:"fa fa-question-circle",title:"If you have both the basic and the advanced filters enabled, the last applied preset will be saved. For example, if the last setting you altered was in the basic filters, it will save the basic preset, and if the last setting you altered was in the advanced filters, it will save the advanced preset. The two presets are not compatible, so they will overwrite each other. Be careful with this, as you might lose some settings."},type:"i"}]},{attributes:{class:"form__input-small",type:"text"},type:"input"},{attributes:{class:"esgst-description esgst-bold"},type:"div"},{attributes:{class:"form__row__error esgst-hidden"},type:"div",children:[{attributes:{class:"fa fa-exclamation-circle"},type:"i"},{text:" Please enter a name for the preset.",type:"node"}]},{attributes:{class:"esgst-description"},text:"The name of the preset.",type:"div"}]}]}]}]},{attributes:{class:"esgst-gf-button"},type:"div",children:[{text:"Expand",type:"span"},{attributes:{class:"esgst-hidden"},text:"Collapse",type:"span"},{text:" filters (",type:"node"},{text:"0",type:"span"},{text:" filtered ",type:"node"},..."gf"===s.id?[{text:"- ",type:"node"},{text:"0",type:"span"},{text:"P required to enter all unfiltered ",type:"node"}]:[],{text:"- ",type:"node"},{type:"span"},{text:")",type:"node"}]}]}]),s.popup||c.esgst.hasAddedFilterContainer||(c.esgst.hasAddedFilterContainer=!0,this.esgst.commentsTop+=24);const o=s.container.firstElementChild;s.filtersPanel=o.firstElementChild;const r=s.filtersPanel.firstElementChild;s.warningsPanel=r.firstElementChild;const l=s.warningsPanel.nextElementSibling,g=l.firstElementChild,u=g.nextElementSibling,m=u.nextElementSibling,h=r.lastElementChild,p=r.nextElementSibling,f=p.firstElementChild,b=p.lastElementChild;s.presetInput=b.firstElementChild.nextElementSibling,s.presetMessage=s.presetInput.nextElementSibling,s.presetWarning=s.presetMessage.nextElementSibling,s.button=o.nextElementSibling,s.expandButton=s.button.firstElementChild,s.collapseButton=s.expandButton.nextElementSibling,s.filteredCount=s.collapseButton.nextElementSibling,"gf"===s.id?(s.pointsCount=s.filteredCount.nextElementSibling,s.presetDisplay=s.pointsCount.nextElementSibling):s.presetDisplay=s.filteredCount.nextElementSibling,h.previousElementSibling.addEventListener("click",this.filter_manual.bind(this,{})),tt.create([{template:"success",name:"Save",onClick:this.filters_savePreset.bind(this,s)},{template:"loading",isDisabled:!0,name:"Saving..."}]).insert(b,"beforeend");let w=d.get(`${s.id}_preset${s.type}`);if(w){let e;const t=d.get(s.key);for(e=t.length-1;e>-1&&t[e].name!==w;e--);e>-1&&(s.rules=t[e].rules)}if(!s.rules){w="Default"+s.type;const e={name:w,rules:{}},t=d.get(s.key);t.push(e),da([{id:`${s.id}_preset${s.type}`,value:w},{id:s.key,value:t}]),s.rules={}}s.rules_save=s.rules,s.presetDisplay.textContent=s.presetInput.value=w,i.addEventListener("click",this.filters_openPresetPopup.bind(this,s)),s.button.addEventListener("click",this.filters_toggleFilters.bind(this,s));const y=[];for(const e in s.filters)if(s.filters.hasOwnProperty(e)){const t=s.filters[e],n={id:e,label:t.name};let a,i,o,r,l;switch(t.type){case"boolean":if(n.input="radio",n.operators=["equal"],n.type="boolean",n.values=["true","false"],!d.get(s.id+"_m_b")){const o={};d.get(`${s.id}_${e}`)&&t.check||(o.class="esgst-hidden"),a=ra(u,"beforeend",[{attributes:o,type:"div",children:[{type:"span"},{attributes:{class:"esgst-gf-filter-count",title:"Number of items this rule is hiding"},type:"span"},{text:t.name,type:"node"}]}]),i=new St(a.firstElementChild,"enabled",!0),s.basicFilters[n.id]={data:{basicCount:a.firstElementChild.nextElementSibling},input:n.input,operator:"equal",type:n.type,filterType:"boolean",checkbox:i},i.onChange=this.filters_basicToAdv.bind(this,s)}break;case"integer":case"double":if(n.operators=["equal","not_equal","less","less_or_equal","greater","greater_or_equal","is_null","is_not_null"],t.date){if(n.input=(e,t)=>`\n\t\t\t\t\t\t\t\t\t<input class="form-control" name="${t}" type="date">\n\t\t\t\t\t\t\t\t`,n.type="date",!d.get(s.id+"_m_b")){const n={};d.get(`${s.id}_${e}`)&&t.check||(n.class="esgst-hidden"),a=ra(g,"beforeend",[{attributes:n,type:"div",children:[{attributes:{class:"esgst-gf-filter-count",title:"Number of items this rule is hiding"},type:"span"},{text:t.name,type:"node"},{type:"span",children:[{attributes:{type:"date"},type:"input"},{text:"-",type:"node"},{attributes:{type:"date"},type:"input"}]}]}])}}else{const i="integer"===t.type?"1":"0.01";if(n.input=(e,s)=>`\n\t\t\t\t\t\t\t\t\t<input type="number" class="form-control" max="${t.maxValue}" min="${t.minValue}" name="${s}" step="${i}" novalidate>\n\t\t\t\t\t\t\t\t`,n.type=t.type,n.validation={max:t.maxValue,min:t.minValue,step:"integer"===t.type?"1":"any"},!d.get(s.id+"_m_b")){const n={};d.get(`${s.id}_${e}`)&&t.check||(n.class="esgst-hidden"),a=ra(g,"beforeend",[{attributes:n,type:"div",children:[{attributes:{class:"esgst-gf-filter-count",title:"Number of items this rule is hiding"},type:"span"},{text:t.name,type:"node"},{type:"span",children:[{attributes:{class:"form-control",type:"number",max:t.maxValue,min:t.minValue,step:i,novalidate:""},type:"input"},{text:"-",type:"node"},{attributes:{class:"form-control",type:"number",max:t.maxValue,min:t.minValue,step:i,novalidate:""},type:"input"}]}]}])}}d.get(s.id+"_m_b")||(l=a.lastElementChild.firstElementChild,r=l.nextElementSibling,s.basicFilters[n.id]={data:{basicCount:a.firstElementChild},input:n.input,type:n.type,filterType:"number",maxInput:r,minInput:l,maxValue:t.maxValue,minValue:t.minValue},r.addEventListener("change",this.filters_basicToAdv.bind(this,s)),l.addEventListener("change",this.filters_basicToAdv.bind(this,s)));break;case"string":if(n.input="text",n.operators=["contains","not_contains"],n.placeholder="Item1, Item2, ...",n.type="string",!d.get(s.id+"_m_b")){const r={};d.get(`${s.id}_${e}`)&&t.check||(r.class="esgst-hidden"),a=ra(m,"beforeend",[{attributes:r,type:"div",children:[{type:"span",children:[{type:"span"},{text:" "+t.name,type:"node"}]},{attributes:{class:"esgst-gf-filter-count",title:"Number of items this rule is hiding"},type:"span"},{attributes:{placeholder:"Item1, Item2, ...",type:"text"},type:"input"}]}]),i=new St(a.firstElementChild.firstElementChild,"enabled",!0),o=a.lastElementChild,s.basicFilters[n.id]={data:{basicCount:a.firstElementChild.nextElementSibling},id:n.id,input:n.input,type:n.type,filterType:"string",checkbox:i,textInput:o},i.onChange=this.filters_basicToAdv.bind(this,s),o.addEventListener("change",this.filters_basicToAdv.bind(this,s))}}n.data||(n.data={}),n.data.check=d.get(`${s.id}_${n.id}`)&&t.check,y.push(n)}if(d.get(s.id+"_m_b")||(ra(m,"beforeend",[{attributes:{class:"esgst-gf-legend-panel"},type:"div",children:[{attributes:{class:"esgst-bold"},text:"Legend:",type:"div"},{type:"div",children:[{attributes:{class:"fa fa-check-square"},type:"i"},{text:" - Show All",type:"node"}]},{type:"div",children:[{attributes:{class:"fa fa-square-o"},type:"i"},{text:" - Hide All",type:"node"}]},{type:"div",children:[{attributes:{class:"fa fa-square"},type:"i"},{text:" - Show Only",type:"node"}]}]}]),s.rules.rules&&s.rules.rules.length&&this.filters_applyBasic(s,s.rules)),!d.get(s.id+"_m_a")){const e={group:({group_id:e,level:t,conditions:s,icons:n,settings:a,translate:i})=>`\n\t\t\t\t\t<div id="${e}" class="rules-group-container">\n\t\t\t\t\t\t<div class="rules-group-header">\n\t\t\t\t\t\t\t<span class="esgst-gf-filter-count" title="Number of items this group is hiding">0</span>\n\n\t\t\t\t\t\t\t<div class="btn-group pull-right group-actions">\n\t\t\t\t\t\t\t\t<button type="button" class="btn btn-xs btn-success" data-add="rule">\n\t\t\t\t\t\t\t\t\t<i class="${n.add_rule}"></i> ${i("add_rule")}\n\t\t\t\t\t\t\t\t</button>\n\n\t\t\t\t\t\t\t\t${-1===a.allow_groups||a.allow_groups>=t?`\n\t\t\t\t\t\t\t\t\t<button type="button" class="btn btn-xs btn-success" data-add="group">\n\t\t\t\t\t\t\t\t\t\t<i class="${n.add_group}"></i> ${i("add_group")}\n\t\t\t\t\t\t\t\t\t</button>`:""}\n\n\t\t\t\t\t\t\t\t${t>1?`\n\t\t\t\t\t\t\t\t\t<button type="button" class="btn btn-xs btn-primary" data-pause="group">\n\t\t\t\t\t\t\t\t\t\t<i class="${n.pause_group}"></i> ${i("pause_group")}\n\t\t\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t\t\t<button type="button" class="btn btn-xs btn-primary" data-resume="group">\n\t\t\t\t\t\t\t\t\t\t<i class="${n.resume_group}"></i> ${i("resume_group")}\n\t\t\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t\t\t<button type="button" class="btn btn-xs btn-danger" data-delete="group">\n\t\t\t\t\t\t\t\t\t\t<i class="${n.remove_group}"></i> ${i("delete_group")}\n\t\t\t\t\t\t\t\t\t</button>`:""}\n\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t<div class="btn-group group-conditions">\n\t\t\t\t\t\t\t\t${s.map(t=>`\n\t\t\t\t\t\t\t\t\t<label class="btn btn-xs btn-default">\n\t\t\t\t\t\t\t\t\t\t<input type="radio" name="${e}_cond" value="${t}">\n\t\t\t\t\t\t\t\t\t\t${i("conditions",t)}\n\t\t\t\t\t\t\t\t\t</label>\n\t\t\t\t\t\t\t\t`).join("")}\n\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t${a.display_errors?`\n\t\t\t\t\t\t\t\t<div class="error-container">\n\t\t\t\t\t\t\t\t\t<i class="${n.error}"></i>\n\t\t\t\t\t\t\t\t</div>`:""}\n\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t<div class="rules-group-body">\n\t\t\t\t\t\t\t<div class="rules-list"></div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t`,rule:({rule_id:e,icons:t,settings:s,translate:n})=>`\n\t\t\t\t\t<div id="${e}" class="rule-container">\n\t\t\t\t\t\t<div class="rule-header">\n\t\t\t\t\t\t\t<div class="btn-group pull-right rule-actions">\n\t\t\t\t\t\t\t\t<button type="button" class="btn btn-xs btn-primary" data-pause="rule">\n\t\t\t\t\t\t\t\t\t<i class="${t.pause_rule}"></i> ${n("pause_rule")}\n\t\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t\t<button type="button" class="btn btn-xs btn-primary" data-resume="rule">\n\t\t\t\t\t\t\t\t\t<i class="${t.resume_rule}"></i> ${n("resume_rule")}\n\t\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t\t<button type="button" class="btn btn-xs btn-danger" data-delete="rule">\n\t\t\t\t\t\t\t\t\t<i class="${t.remove_rule}"></i> ${n("delete_rule")}\n\t\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t${s.display_errors?`\n\t\t\t\t\t\t\t<div class="error-container">\n\t\t\t\t\t\t\t\t<i class="${t.error}"></i>\n\t\t\t\t\t\t\t</div>`:""}\n\n\t\t\t\t\t\t<span class="esgst-gf-filter-count" title="Number of items this rule is hiding">0</span>\n\t\t\t\t\t\t<div class="rule-filter-container"></div>\n\t\t\t\t\t\t<div class="rule-operator-container"></div>\n\t\t\t\t\t\t<div class="rule-value-container"></div>\n\t\t\t\t\t</div>\n\t\t\t\t`,filterSelect:({rule:e,filters:t,icons:s,settings:n,translate:a})=>{let i=null;return`\n\t\t\t\t\t\t<select class="form-control" name="${e.id}_filter">\n\t\t\t\t\t\t\t${n.display_empty_filter?`\n\t\t\t\t\t\t\t\t<option value="-1">${n.select_placeholder}</option>`:""}\n\n\t\t\t\t\t\t\t${t.map(e=>{var t;const s=null!==(t=e.data)&&void 0!==t&&t.check?"":'class="esgst-hidden"';let o="";return i!==e.optgroup&&(null!==i&&(o+="</optgroup>"),i=e.optgroup,null!==i&&(o+=`<optgroup label="${a(n.optgroups[i])}">`)),o+=`<option ${s} value="${e.id}" ${e.icon?`data-icon="${e.icon}"`:""}>\n\t\t\t\t\t\t\t\t\t${a(e.label)}\n\t\t\t\t\t\t\t\t</option>`,o}).join("")}\n\n\t\t\t\t\t\t\t${null!==i?"</optgroup>":""}\n\t\t\t\t\t\t</select>\n\t\t\t\t\t`}},t={filters:y,icons:{add_group:"fa fa-plus",add_rule:"fa fa-plus",pause_group:"fa fa-pause",pause_rule:"fa fa-pause",remove_group:"fa fa-times",remove_rule:"fa fa-times",resume_group:"fa fa-play",resume_rule:"fa fa-play",error:"fa fa-exclamation"},plugins:{"bt-checkbox":{font:"fontawesome"},"not-group":{icon_checked:"fa fa-check-square-o",icon_unchecked:"fa fa-square-o"},sortable:{icon:"fa fa-arrows"}},sort_filters:!0,lang:{pause_group:"Pause",pause_rule:"Pause",resume_group:"Resume",resume_rule:"Resume"},templates:e};s.rules.rules&&s.rules.rules.length&&(t.rules=s.rules),window.$(h).queryBuilder(t),s.builder=window.$(h)[0].queryBuilder,[s.rules,s.rules_save]=this.filters_changeRules(s),s.builder.$el.on("click.queryBuilder","[data-pause=group]",e=>{e.currentTarget.closest(".rules-group-container").setAttribute("data-esgst-paused",!0),this.onRulesChanged(s,{})}),s.builder.$el.on("click.queryBuilder","[data-resume=group]",e=>{e.currentTarget.closest(".rules-group-container").removeAttribute("data-esgst-paused"),this.onRulesChanged(s,{})}),s.builder.$el.on("click.queryBuilder","[data-pause=rule]",e=>{e.currentTarget.closest(".rule-container").setAttribute("data-esgst-paused",!0),this.onRulesChanged(s,{})}),s.builder.$el.on("click.queryBuilder","[data-resume=rule]",e=>{e.currentTarget.closest(".rule-container").removeAttribute("data-esgst-paused"),this.onRulesChanged(s,{})}),s.builder.on("rulesChanged.queryBuilder",()=>{this.isProgrammaticChange||this.onRulesChanged(s,{})}),s.builder.on("getRules.queryBuilder.filter",this.filters_changeRules.bind(this,s))}d.get(s.id+"_m_b")&&(l.classList.add("esgst-hidden"),l.nextElementSibling.classList.add("esgst-hidden")),d.get(s.id+"_m_a")&&(h.classList.add("esgst-hidden"),l.nextElementSibling.classList.add("esgst-hidden")),"gf"===s.id&&[{id:"filter_os",key:"os",name:"OS"},{id:"filter_giveaways_exist_in_account",key:"alreadyOwned",name:"Already Owned"},{id:"filter_giveaways_missing_base_game",key:"dlcMissingBase",name:"DLC Missing Base"},{id:"filter_giveaways_level",key:"aboveLevel",name:"Above Level"},{id:"filter_giveaways_additional_games",key:"manuallyFiltered",name:"Manually Filtered"}].forEach(e=>{if(!d.get(`${s.id}_${e.key}`))return;const t=[{text:e.name,type:"node"}];"os"===e.key&&t.push({type:"select",children:[{attributes:{value:"0"},text:"All",type:"option"},{attributes:{value:"1"},text:"Windows",type:"option"},{attributes:{value:"2"},text:"Linux",type:"option"},{attributes:{value:"3"},text:"Mac",type:"option"}]});const n=ra(f,"beforeend",[{attributes:{class:"esgst-gf-category-filter"},type:"div",children:[{type:"span",children:t},{attributes:{class:"fa fa-circle-o-notch fa-spin esgst-hidden"},type:"i"},{attributes:{class:"fa fa-check esgst-green esgst-hidden"},type:"i"}]}]),a=n.lastElementChild,i=a.previousElementSibling;if("os"===e.key){const t=n.firstElementChild.firstElementChild;t.value=d.get(e.id),t.addEventListener("change",async()=>{a.classList.add("esgst-hidden"),i.classList.remove("esgst-hidden"),await da(e.id,t.value),await Ne.post("/account/settings/giveaways",{data:`filter_os=${d.get("filter_os")}&filter_giveaways_exist_in_account=${d.get("filter_giveaways_exist_in_account")}&filter_giveaways_missing_base_game=${d.get("filter_giveaways_missing_base_game")}&filter_giveaways_level=${d.get("filter_giveaways_level")}&filter_giveaways_additional_games=${d.get("filter_giveaways_additional_games")}&xsrf_token=${Be.xsrfToken}`}),i.classList.add("esgst-hidden"),a.classList.remove("esgst-hidden")})}else{const t=new St(n,!!d.get(e.id));t.onChange=async()=>{a.classList.add("esgst-hidden"),i.classList.remove("esgst-hidden"),await da(e.id,t.value?1:0),await Ne.post("/account/settings/giveaways",{data:`filter_os=${d.get("filter_os")}&filter_giveaways_exist_in_account=${d.get("filter_giveaways_exist_in_account")}&filter_giveaways_missing_base_game=${d.get("filter_giveaways_missing_base_game")}&filter_giveaways_level=${d.get("filter_giveaways_level")}&filter_giveaways_additional_games=${d.get("filter_giveaways_additional_games")}&xsrf_token=${Be.xsrfToken}`}),i.classList.add("esgst-hidden"),a.classList.remove("esgst-hidden")}}}),1===f.children.length&&f.classList.add("esgst-hidden");let v=[];const _=Date.now(),k=this.getUsedFilters(s.rules);for(const e of k){const t=s.filters[e];if(!t.category||d.get("gc")&&d.get(t.category)){if(t.sync)for(const e of t.sync)_-d.get("lastSync"+e)>2592e6&&v.push(`"${t.name}" requires "${Tt["sync"+e].name}" to be synced in the sync menu, but that item has either never been synced or it was last synced more than 30 days ago.`)}else v.push(`"${t.name}" requires "${c.common.getFeatureName(null,t.category)}" to be enabled in the settings menu.`)}return v.length>0&&(Se.insert(s.warningsPanel,"beforeend",Se.element("fragment",null,"You are using some filters that may require your attention:",Se.element("div",{className:"markdown"},Se.element("ul",null,v.map(e=>Se.element("li",null,e)))))),s.button.classList.add("warning")),n}getUsedFilters(e,t=new Set){if(e.condition)for(const s of e.rules)t=this.getUsedFilters(s,t);else l.isSet(e.id)&&t.add(e.id);return t}onRulesChanged(e,t){try{[e.rules,e.rules_save]=this.filters_changeRules(e,t),e.basicApplied||d.get(e.id+"_m_b")||(this.filters_resetBasic(e),this.filters_applyBasic(e,e.rules)),this.filters_filter(e)}catch(e){dt.error(e.message,e.stack)}e.basicApplied=!1}filter_manual(e){e.manualPopup||(e.manualPopup=new lt({icon:"fa-book",title:"Advanced Filters Manual",addScrollable:"left"}),e.manualPopup.getScrollable(Se.element("fragment",null,Se.element("div",{className:"esgst-bold"},"Interface"),Se.element("br",null),Se.element("div",{className:"markdown"},Se.element("ul",null,Se.element("li",null,Se.element("span",{className:"esgst-bold"},Se.element("i",{className:"fa fa-square-o"})," NOT")," ","- If checked, only items that do not apply to the group will be shown."),Se.element("li",null,Se.element("span",{className:"esgst-bold"},"AND")," - Turns the group into an AND group, which means that only items that apply to every single rule of the group will be shown."),Se.element("li",null,Se.element("span",{className:"esgst-bold"},"OR")," - Turns the group into an OR group, which means that only items that apply to at least one rule of the group will be shown."),Se.element("li",null,Se.element("span",{className:"esgst-bold"},Se.element("i",{className:"fa fa-arrows"}))," ","- Allows you reorder/move rules/groups. The order of the rules does not alter the result."),Se.element("li",null,Se.element("span",{className:"esgst-bold"},Se.element("i",{className:"fa fa-pause"})," Pause")," ","- Allows you to pause the rule/group, so that it does not filter anything until you resume it or refresh the page."),Se.element("li",null,"The other buttons in the interface should be self-explanatory."))),Se.element("br",null),Se.element("div",{className:"esgst-bold"},"Types of Filters"),Se.element("br",null),Se.element("div",{className:"markdown"},Se.element("ul",null,Se.element("li",null,Se.element("span",{className:"esgst-bold"},"Boolean"),' - Presents a choice between true and false. Set to true if you only want to see items that apply to the filter, and to false otherwise. For example, if you only want to see giveaways that are on your wishlist, set wishlisted to "true"; if you only want to see giveaways that you have not entered, set entered to "false".'),Se.element("li",null,Se.element("span",{className:"esgst-bold"},"Number"),' - Presents a text field and a choice between equal, not equal, less, less or equal, greater, greater or equal, is null and is not null. Enter the value that you want in the text field and choose the option that you want. For example, if you only want to see giveaways above level 5, you can either set level to "greater than 4" or to "greater or equal to 5". The is null and is not null options regard the presence of the filter. For example, some giveaways do not have a rating. If you still want to see those giveaways when filtering by rating, add an additional rule and set rating to "is null".'),Se.element("li",null,Se.element("span",{className:"esgst-bold"},"Text"),' - Presents a text field and a choice between contains and doesn\'t contain. Enter the values that you want in the text field, separated by a comma followed by a space, and choose the option that you want. For example, if you only want to see giveaways that have the adventure or the action genres, set genres to "contains Adventure, Action". But if you only want to see giveaways that have both the adventure and the action genres, add 2 rules, set one to "contains Adventure" and the other to "contains Action", and turn the group into an AND group.'))),Se.element("br",null),Se.element("div",{className:"esgst-bold"},"Building the Filters"),Se.element("br",null),Se.element("div",{className:"markdown"},Se.element("div",null,"The process of building the filters might seem intimidating at first, but it is actually quite simple. Just think of it like this:"),Se.element("ul",null,Se.element("li",null,'Show me a="true" AND b="false".'),Se.element("li",null,'Show me a="false" OR b="true".'),Se.element("li",null,'Do NOT show me a="true".')),Se.element("div",null,"The building process for the filters above becomes, respectively:"),Se.element("ul",null,Se.element("li",null,'Turn group into AND, add rule a="true", add rule b="false".'),Se.element("li",null,'Turn group into OR, add rule a="false", add rule b="true".'),Se.element("li",null,'Check NOT option, add rule a="true".')),Se.element("div",null,"For more advanced filters, think in parenthesis:"),Se.element("ul",null,Se.element("li",null,'Show me (a="true" AND b="false") OR c="greater or equal to 5".'),Se.element("li",null,'Show me (a="false" AND b="true" AND c="false") OR (d="true" AND e="false") OR f="equal to 2".'),Se.element("li",null,'Show me (a="true" AND b="false" AND c="true" AND d="false") AND do NOT show me e="contains Adventure, Action".')),Se.element("div",null,"Each parenthesis represents a new group. NOT filters also represent a new group, since there isn't a NOT option for rules. So the building process for the filters above becomes, respectively:"),Se.element("ul",null,Se.element("li",null,'Turn group into OR, add group (turn group into AND, add rule a="true", add rule b="false"), add rule c="greater or equal to 5".'),Se.element("li",null,'Turn group into OR, add group (turn group into AND, add rule a="false", add rule b="true", add rule c="false"), add group (turn group into AND, add rule d="true", add rule e="false"), add rule f="equal to 2".'),Se.element("li",null,'Turn group into AND, add group (turn group into AND, add rule a="true", add rule b="false", add rule c="true", add rule d="false"), add group (check NOT option, add rule e="contains Adventure, Action").')),Se.element("div",null,"Real example: suppose you only want to see giveaways that are for level 5 or more and that have achievements or trading cards. The sentence for that system is:"),Se.element("ul",null,Se.element("li",null,'Show me level="greater or equal to 5" AND (achievements="true" OR tradingCards="true").')),Se.element("div",null,"And the building process is:"),Se.element("ul",null,Se.element("li",null,'Turn group into AND, add rule level="greater or equal to 5", add group (turn group into OR, add rule achievements="true", add rule tradingCards="true").')),Se.element("div",null,"The final result is illustrated in the picture below:")),Se.element("img",{src:"https://i.imgur.com/F1UXcKs.png"})))),e.manualPopup.open()}filters_convert(e){const t={level:0,entries:0,copies:1,points:0,comments:0,minutesToEnd:0,minutesFromStart:0,chance:0,chancePerPoint:0,ratio:0,rating:0,reviews:0,releaseDate:0},s={level:10,points:100,minutesToEnd:43800,minutesFromStart:43800,chance:100,chancePerPoint:100,rating:100,releaseDate:3187209600},n=[];for(const a of e){let e={condition:"AND",not:!1,rules:[]};for(let n in a)if(a.hasOwnProperty(n)){if(n.match(/^(authors|creators|exceptions|genres|groups|words|name|overrides)$/))continue;const i=n.match(/^max/),o=n.match(/^min/),r=a[n];if(n=n.replace(/(^(max|min))|List$/,""),n=`${n[0].toLowerCase()}${n.slice(1)}`,i)r===s[n]||r.toString().match(/^9+$/)||e.rules.push({field:n,id:n,input:"releaseDate"===n?"date":"text",operator:"less_or_equal",type:"releaseDate"===n?"text":n.match(/^(chance|chancePerPoint)$/)?"double":"integer",value:r});else if(o)r!==t[n]&&e.rules.push({field:n,id:n,input:"releaseDate"===n?"date":"text",operator:"greater_or_equal",type:"releaseDate"===n?"text":n.match(/^(chance|chancePerPoint)$/)?"double":"integer",value:r});else if(r&&"string"==typeof r&&!r.match(/^(enabled|undefined)$/))if("disabled"===r)e.rules.push({field:n,id:n,input:"radio",operator:"equal",type:"boolean",value:!1});else if("none"===r)e.rules.push({field:n,id:n,input:"radio",operator:"equal",type:"boolean",value:!0});else{const t={field:n,id:n,input:"text",operator:"disabled"===a[n]?"not_contains":"contains",type:"string",value:r};"enabled"===a[n]&&(t.data={paused:!0}),e.rules.push(t)}}let i=null;if(a.exceptions){i={condition:"OR",not:!1,rules:[]},e.rules.length&&i.rules.push(e);for(const e of a.exceptions){const n={condition:"AND",not:!1,rules:[]};for(let i in e)if(e.hasOwnProperty(i)){if(i.match(/^(authors|creators|exceptions|genres|groups|words|name|overrides)$/))continue;const o=i.match(/^max/),r=i.match(/^min/),l=a[i];i=i.replace(/(^(max|min))|List$/,""),i=`${i[0].toLowerCase()}${i.slice(1)}`,o?l===s[i]||l.toString().match(/^9+$/)||n.rules.push({field:i,id:i,input:"releaseDate"===i?"date":"text",operator:"less_or_equal",type:"releaseDate"===i?"text":i.match(/^(chance|chancePerPoint)$/)?"double":"integer",value:l}):r?l!==t[i]&&n.rules.push({field:i,id:i,input:"releaseDate"===i?"date":"text",operator:"greater_or_equal",type:"releaseDate"===i?"text":i.match(/^(chance|chancePerPoint)$/)?"double":"integer",value:l}):l&&"undefined"!==l&&(i.match(/^(authors|creators|genres|groups|words)$/)?e[i]&&n.rules.push({field:i,id:i,input:"text",operator:"contains",type:"string",value:l}):n.rules.push({field:i,id:i,input:"radio",operator:"equal",type:"boolean",value:!0}))}n.rules.length&&i.rules.push(n)}if(a.overrides)for(let t=e.rules.length-1;t>-1;t--){const s=e.rules[t];if(a.overrides[s.id])for(const t of i.rules)t!==e&&t.rules.push(s)}i.rules.length&&(e=i)}e.rules.length&&(e.valid=!0,n.push({name:"__old-preset__"+a.name,rules:e}))}return n}filters_changeRules(e,t){let s=[{condition:"AND",not:!1,rules:[],valid:!0},{condition:"AND",not:!1,rules:[],valid:!0}],n=!1;try{n=e.builder.validate()}catch(e){return s}return n?(s=function s(n){const a={condition:n.condition,data:{count:n.$el[0].getElementsByClassName("esgst-gf-filter-count")[0]},rules:[]},i={condition:n.condition,rules:[]};return n.each((function(s){t||(s.data&&s.data.paused?s.$el[0].setAttribute("data-esgst-paused",!0):s.$el[0].removeAttribute("data-esgst-paused"));let n=null;s.operator&&0===s.operator.nb_inputs||(n=s.value);const o={data:s.data,id:s.filter?s.filter.id:null,field:s.filter?s.filter.field:null,type:s.filter?s.filter.type:null,input:s.filter?s.filter.input:null,operator:s.operator?s.operator.type:null,value:n};"AND"===a.condition?(o.data||(o.data={}),o.data.count=s.$el[0].getElementsByClassName("esgst-gf-filter-count")[0],o.data.count.classList.remove("esgst-hidden")):s.$el[0].getElementsByClassName("esgst-gf-filter-count")[0].classList.add("esgst-hidden");const r={id:s.filter?s.filter.id:null,field:s.filter?s.filter.field:null,type:s.filter?s.filter.type:null,input:s.filter?s.filter.input:null,operator:s.operator?s.operator.type:null,value:n};s.$el[0].getAttribute("data-esgst-paused")?(o.data||(o.data={}),o.data.paused=!0,r.data={paused:!0}):o.data&&o.data.paused&&delete o.data.paused,a.rules.push(e.builder.change("ruleToJson",o,s)),i.rules.push(e.builder.change("ruleToJson",r,s))}),(function(e){t||(e.data&&e.data.paused?e.$el[0].setAttribute("data-esgst-paused",!0):e.$el[0].removeAttribute("data-esgst-paused"));const[n,o]=s(e);0!==n.rules.length&&(e.$el[0].getAttribute("data-esgst-paused")?o.data={paused:!0}:a.rules.push(n),i.rules.push(o))}),e.builder),[e.builder.change("groupToJson",a,n),e.builder.change("groupToJson",i,n)]}(e.builder.model.root),s[0].valid=n,s[1].valid=n,t&&(t.value=s),s):(t&&(t.value=s),s)}filters_basicToAdv(e){const t={condition:"AND",not:!1,rules:[],valid:!0};for(const s in e.basicFilters)if(e.basicFilters.hasOwnProperty(s)){const n=e.basicFilters[s];switch(n.filterType){case"boolean":if("enabled"===n.checkbox.value)break;t.rules.push({data:n.data,field:s,id:s,input:n.input,operator:n.operator,type:n.type,value:"none"===n.checkbox.value});break;case"number":if(n.maxInput.value){let e=!1;const a=n.maxInput.value;if("date"===n.type)e=!0;else{const t=parseFloat(a);Number.isNaN(t)?n.maxInput.setCustomValidity("Not a number"):"integer"!==n.type||Number.isInteger(t)?t>n.maxValue?n.maxInput.setCustomValidity("Must be lower than "+n.maxValue):t<n.minValue?n.maxInput.setCustomValidity("Must be greater than "+n.minValue):(n.maxInput.setCustomValidity(""),e=!0):n.maxInput.setCustomValidity("Not an integer")}e?(n.maxInput.classList.remove("has-error"),t.rules.push({data:n.data,field:s,id:s,input:n.input,operator:"less_or_equal",type:n.type,value:a})):n.maxInput.classList.add("has-error")}if(n.minInput.value){let e=!1;const a=n.minInput.value;if("date"===n.type)e=!0;else{const t=parseFloat(a);Number.isNaN(t)?n.minInput.setCustomValidity("Not a number"):"integer"!==n.type||Number.isInteger(t)?t>n.maxValue?n.minInput.setCustomValidity("Must be lower than "+n.maxValue):t<n.minValue?n.minInput.setCustomValidity("Must be greater than "+n.minValue):(n.minInput.setCustomValidity(""),e=!0):n.minInput.setCustomValidity("Not an integer")}e?(n.minInput.classList.remove("has-error"),t.rules.push({data:n.data,field:s,id:s,input:n.input,operator:"greater_or_equal",type:n.type,value:a})):n.minInput.classList.add("has-error")}break;case"string":if(!n.textInput.value)break;"enabled"===n.checkbox.value?(n.data||(n.data={}),n.data.paused=!0):n.data&&n.data.paused&&delete n.data.paused,t.rules.push({data:n.data,field:s,id:s,input:n.input,operator:"disabled"===n.checkbox.value?"not_contains":"contains",type:n.type,value:n.textInput.value})}}e.rules=t,e.rules.rules&&(d.get(e.id+"_m_a")?(e.rules_save=e.rules,this.filters_filter(e)):(e.rules.rules.length||(e.rules={condition:"AND",rules:[{empty:!0}],valid:!0}),e.basicApplied=!0,this.isProgrammaticChange=!0,e.builder.setRules(e.rules),this.onRulesChanged(e),this.isProgrammaticChange=!1))}filters_applyBasic(e,t){if("AND"===t.condition)for(const s of t.rules){if(s.condition)continue;const t=e.basicFilters[s.id];switch(s.type){case"boolean":t.checkbox.change(!1,s.value?"none":"disabled");break;case"date":case"double":case"integer":if("less_or_equal"===s.operator){const e=s.value;if("date"!==s.type){let n=!1;const a=parseFloat(e);Number.isNaN(a)?t.maxInput.setCustomValidity("Not a number"):"integer"!==s.type||Number.isInteger(a)?a>t.maxValue?t.maxInput.setCustomValidity("Must be lower than "+t.maxValue):a<t.minValue?t.maxInput.setCustomValidity("Must be greater than "+t.minValue):(t.maxInput.setCustomValidity(""),n=!0):t.maxInput.setCustomValidity("Not an integer"),n?t.maxInput.classList.remove("has-error"):t.maxInput.classList.add("has-error")}t.maxInput.value=e}else if("greater_or_equal"===s.operator){const e=s.value;if("date"!==s.type){let n=!1;const a=parseFloat(e);Number.isNaN(a)?t.minInput.setCustomValidity("Not a number"):"integer"!==s.type||Number.isInteger(a)?a>t.maxValue?t.minInput.setCustomValidity("Must be lower than "+t.maxValue):a<t.minValue?t.minInput.setCustomValidity("Must be greater than "+t.minValue):(t.minInput.setCustomValidity(""),n=!0):t.minInput.setCustomValidity("Not an integer"),n?t.minInput.classList.remove("has-error"):t.minInput.classList.add("has-error")}t.minInput.value=e}break;case"string":t.checkbox.change(!1,"contains"===s.operator?s.data&&s.data.paused?"enabled":"none":"disabled"),t.textInput.value=s.value}}}filters_resetBasic(e){for(const t in e.basicFilters)if(e.basicFilters.hasOwnProperty(t)){const s=e.basicFilters[t];switch(s.filterType){case"boolean":s.checkbox.change(!1,"enabled");break;case"number":s.maxInput.value="",s.minInput.value="";break;case"string":s.checkbox.change(!1,"enabled"),s.textInput.value=""}}}async filters_savePreset(e){const t=e.presetInput.value;if(!t)return void e.presetWarning.classList.remove("esgst-hidden");e.presetWarning.classList.add("esgst-hidden");const s={name:t,rules:e.rules_save};let n;const a=d.get(e.key);for(n=a.length-1;n>-1&&a[n].name!==t;n--);n>-1?a[n]=s:a.push(s),await da([{id:`${e.id}_preset${e.type}`,value:t},{id:e.key,value:a}]),la(e.presetMessage,"Saved!")}async filters_openPresetPopup(e){const t=new lt({addScrollable:!0,icon:"fa-sliders",isTemp:!0,title:"Manage presets:"});ra(t.description,"afterbegin",[{attributes:{class:"esgst-description"},text:'To edit a preset, apply it and save it with the same name. To rename a preset, click the edit icon, enter the new name and hit "Enter". Drag and drop presets to move them.',type:"div"}]);let s=[];const n=ra(t.description,"beforeend",[{attributes:{class:"esgst-clickable esgst-hidden"},type:"div",children:[{attributes:{class:"fa fa-rotate-left"},type:"i"},{text:"Undo Delete",type:"span"}]}]);n.addEventListener("click",this.filters_undoDeletePreset.bind(this,e,s,n));const a=ra(t.scrollable,"beforeend",[{attributes:{class:"esgst-text-left popup__keys__list"},type:"div"}]);for(const i of d.get(e.key)){const o={draggable:!0};e.presetInput.value===i.name&&(o.class="esgst-green-highlight");const r=ra(a,"beforeend",[{attributes:o,type:"div",children:[{attributes:{class:"esgst-float-left"},type:"div",children:[{attributes:{class:"esgst-hidden",type:"text",value:i.name},type:"input"},{attributes:{class:"esgst-clickable"},text:i.name,type:"strong"}]},{attributes:{class:"esgst-clickable esgst-float-right"},type:"div",children:[{attributes:{class:"fa fa-edit",title:"Rename preset"},type:"i"},{attributes:{title:"Delete preset"},type:"span",children:[{attributes:{class:"fa fa-trash"},type:"i"}]}]},{attributes:{class:"esgst-clear"},type:"div"}]}]),l=r.firstElementChild.firstElementChild,c=l.nextElementSibling,d=r.firstElementChild.nextElementSibling.firstElementChild;r.addEventListener("dragstart",this.filters_setSource.bind(this,e,i,r)),r.addEventListener("dragenter",this.filters_getSource.bind(this,e,r,a)),r.addEventListener("dragend",this.filters_saveSource.bind(this,e)),l.addEventListener("keypress",this.filters_renamePreset.bind(this,e,c,i)),c.addEventListener("click",this.filters_applyPreset.bind(this,e,t,i)),d.addEventListener("click",this.filters_showRenameInput.bind(this,c,l)),d.nextElementSibling.addEventListener("click",this.filters_deletePreset.bind(this,e,s,i,r,n))}t.open()}async filters_setSource(e,t,s,n){let a;n.dataTransfer.setData("text/plain",""),e.source=s;const i=d.get(e.key);for(a=i.length-1;a>-1&&i[a].name!==t.name;a--);e.sourceIndex=a}filters_getSource(e,t,s){let n=e.source,a=0;do{if(n=n.previousElementSibling,n&&n===t)return e.sourceNewIndex=a,void s.insertBefore(e.source,t);++a}while(n);e.sourceNewIndex=a-1,s.insertBefore(e.source,t.nextElementSibling)}async filters_saveSource(e){const t=d.get(e.key);t.splice(e.sourceNewIndex,0,t.splice(e.sourceIndex,1)[0]),await da(e.key,t)}async filters_applyPreset(e,t,s){s.rules&&s.rules.rules&&s.rules.rules.length||(s.rules={condition:"AND",rules:[{empty:!0}],valid:!0}),d.get(e.id+"_m_b")||(this.filters_resetBasic(e),this.filters_applyBasic(e,s.rules)),d.get(e.id+"_m_a")||(this.isProgrammaticChange=!0,e.builder.setRules(s.rules),this.onRulesChanged(e),this.isProgrammaticChange=!1,[e.rules,e.rules_save]=this.filters_changeRules(e)),t.close(),e.presetDisplay.textContent=e.presetInput.value=s.name,this.filters_filter(e),da(`${e.id}_preset${e.type}`,s.name)}filters_showRenameInput(e,t){e.classList.add("esgst-hidden"),t.classList.remove("esgst-hidden");const s=t.value;t.value="",t.focus(),t.value=s}async filters_renamePreset(e,t,s,n){if("Enter"!==n.key)return;const a=s.name,i=n.currentTarget.value;let o;const r=d.get(e.key);for(o=r.length-1;o>-1&&r[o].name!==a;o--);s.name=r[o].name=i;const l=[{id:e.key,value:r}];t.textContent=i,e.presetInput.value===a&&(e.presetDisplay.textContent=e.presetInput.value=i);const c=["","Wishlist","Recommended","Group","New","Created","Entered","Won","Games","Groups","User","Gb","Ge","Ged"];for(const t of c)d.get(`${e.id}_preset${t}`)===a&&l.push({id:`${e.id}_preset${t}`,value:i});n.currentTarget.classList.add("esgst-hidden"),t.classList.remove("esgst-hidden"),await da(l)}async filters_deletePreset(e,t,s,n,a,i){const o=i.currentTarget;let r;ra(o,"atinner",[{attributes:{class:"fa fa-circle-o-notch fa-spin"},type:"i"}]);const l=d.get(e.key);for(r=l.length-1;r>-1&&l[r].name!==s.name;r--);l.splice(r,1),await da(e.key,l),ra(o,"atinner",[{attributes:{class:"fa fa-trash"},type:"i"}]),n.classList.add("esgst-hidden"),t.push({details:s,row:n}),a.classList.remove("esgst-hidden")}async filters_undoDeletePreset(e,t,s){const n=t.pop();n.row.classList.remove("esgst-hidden"),n.row.parentElement.appendChild(n.row);const a=d.get(e.key);a.push(n.details),await da(e.key,a),0===t.length&&s.classList.add("esgst-hidden")}filters_toggleFilters(e){e.collapseButton.classList.toggle("esgst-hidden"),e.expandButton.classList.toggle("esgst-hidden"),e.warningsPanel.firstElementChild&&e.warningsPanel.classList.toggle("esgst-hidden"),e.filtersPanel.classList.toggle("esgst-hidden")}filters_filter(e,t,s){if(!t&&!d.get(`${e.id}_enable${e.type}`))return;let n;c.common.purgeRemovedElements(),n="gf"===e.id?rt.findData("current","giveaways"):"df"===e.id?rt.findData("current","discussions"):"tf"===e.id?rt.findData("current","trades"):"gmf"===e.id?rt.findData("current","games").map(e=>e.game):"gpf"===e.id?rt.findData("current","groups"):rt.findData("current","comments");const a=document.getElementsByClassName("esgst-gf-filter-count");for(const e of a)e.textContent="0";let i=0,o=0;for(const s of n){let n;s.isGame&&s.table&&(n=s.container.closest("tr"));const a=n&&n.querySelectorAll(".esgst-gc-panel").length<2?n:s.outerWrap;a.getAttribute("data-esgst-not-filterable")||a.classList.remove("esgst-hidden"),"cf"===e.id&&a.parentElement&&!a.parentElement.getAttribute("data-esgst-not-filterable")&&a.parentElement.classList.remove("esgst-hidden"),t||this.filters_filterItem(e.filters,s,e.rules)?!s.points||s.entered||a.classList.contains("esgst-hidden")||a.parentElement.classList.contains("esgst-hidden")||(o+=s.points):(a.classList.contains("esgst-hidden")||a.getAttribute("data-esgst-not-filterable")||a.classList.add("esgst-hidden"),"cf"!==e.id||a.parentElement.classList.contains("esgst-hidden")||a.parentElement.getAttribute("data-esgst-not-filterable")||a.parentElement.classList.add("esgst-hidden"),i+=1)}if(e.filteredCount&&(e.filteredCount.textContent=i),"gf"===e.id&&e.pointsCount&&(e.pointsCount.textContent=o),("gf"===e.id||"gmf"===e.id)&&this.esgst.gcToFetch){const e={apps:{},subs:{}};for(const t in this.esgst.gcToFetch.apps)this.esgst.gcToFetch.apps.hasOwnProperty(t)&&(e.apps[t]=[...this.esgst.gcToFetch.apps[t]]);for(const t in this.esgst.gcToFetch.subs)this.esgst.gcToFetch.subs.hasOwnProperty(t)&&(e.subs[t]=[...this.esgst.gcToFetch.subs[t]]);this.esgst.modules.gamesGameCategories.gc_getGames(e,!0,null,!1,!0)}}filters_filterItem(e,t,s,n){if(!s||!s.id&&(!s.condition||l.isSet(s.valid)&&!s.valid)||s.id&&!d.get(`${this.id}_${s.id}`))return!0;let a;if(s.condition){if("AND"===s.condition){a=!0;for(const i of s.rules)if(!(i.data&&i.data.paused||(a=a&&this.filters_filterItem(e,t,i,n),a)))break}else if(a=!1,s.rules.length){for(const i of s.rules)if((!i.data||!i.data.paused)&&(a=a||this.filters_filterItem(e,t,i,n),a))break}else a=!0;return a=s.not?!a:a,!a&&s.data&&s.data.count&&(s.data.count.textContent=parseInt(s.data.count.textContent)+1),a}a=!0;let i=s.id;const o=e[i];if(!o.check||o.category&&(!d.get("gc")||!d.get(o.category)||!t.gcReady)||t.sgTools&&i.match(/^(chance|chancePerPoint|comments|entries|ratio)$/))return a;switch(s.type){case"date":case"integer":case"double":{const e="date"===s.type?new Date(s.value).getTime():s.value,n="minutesToEnd"===i?(t.endTime-Date.now())/6e4:"minutesFromStart"===i?(Date.now()-t.startTime)/6e4:t[i];switch(s.operator){case"equal":a=e===n;break;case"not_equal":a=e!==n;break;case"less":a=n<e;break;case"less_or_equal":a=n<=e;break;case"greater":a=n>e;break;case"greater_or_equal":a=n>=e;break;case"is_null":a=!l.isSet(n)||n<0;break;case"is_not_null":a=l.isSet(n)&&n>-1}break}case"boolean":if("regionRestricted"===i&&this.esgst.parameters.region_restricted)break;if(("fullCV"!==i||(s.value||t.reducedCV||t.noCV)&&(!s.value||!t.reducedCV&&!t.noCV))&&("fullCV"===i||(!s.value||t[i])&&(s.value||!t[i])))break;a=!1,n||t.deleted||"ended"!==i||s.value||!(this.esgst.createdPath||this.esgst.enteredPath||this.esgst.wonPath||this.esgst.userPath||this.esgst.gamePath||this.esgst.groupPath)||(this.esgst.stopEs=!0);break;case"string":{const e=s.value.toLowerCase().split(/,\s/);if("winners"===i&&(i="winnerNames"),"contains"===s.operator){if(!t[i]||!Array.isArray(t[i])){a=!1;break}let s;for(s=e.length-1;s>-1&&t[i].indexOf(e[s])<0;s--);a=s>-1}else{if(!t[i]||!Array.isArray(t[i]))break;let s;for(s=e.length-1;s>-1&&t[i].indexOf(e[s])<0;s--);a=s<0}break}}return!a&&s.data&&(s.data.count&&(s.data.count.textContent=parseInt(s.data.count.textContent)+1),s.data.basicCount&&(s.data.basicCount.textContent=parseInt(s.data.basicCount.textContent)+1)),a}}const ua=new class extends ga{constructor(){super("cf"),this.info={description:()=>Se.element("ul",null,Se.element("li",null,"Allows you to filter comments.")),features:{cf_m:{description:()=>Se.element("ul",null,Se.element("li",null,"Allows you to hide multiple comments in a page using many different filters."),Se.element("li",null,"Adds a toggle switch with a button (",Se.element("i",{className:"fa fa-sliders"}),") to the main page heading of any comment page. The switch allows you to turn the filters on/off and the button allows you to manage your presets."),Se.element("li",null,"Adds a collapsible panel below the same main page heading that allows you to change/save the rules of a preset. The filters are separated in 2 categories:"),Se.element("ul",null,Se.element("li",null,"Basic filters are related to a numeric value (such as the length of a comment) and have a slider that you can use to set the range of the filter (any comments that do not apply to the range will be hidden)."),Se.element("li",null,"Type filters are related to a boolean value (such as whether or not a comment is a bump comment) and have a checkbox that changes states when you click on it. The checkbox has 3 states:"),Se.element("ul",null,Se.element("li",null,'"Show all" (',Se.element("i",{className:"fa fa-check-square"}),") does not hide any comments that apply to the filter (this is the default state)."),Se.element("li",null,'"Show only" (',Se.element("i",{className:"fa fa-square"}),") hides any comments that do not apply to the filter."),Se.element("li",null,'"Hide all" (',Se.element("i",{className:"fa fa-square-o"}),") hides any comments that apply to the filter."))),Se.element("li",null,"A preset contains all of your rules and can be saved to be reused later. You can save as many presets as you want."),Se.element("li",null,"Adds a text in parenthesis to the pagination of the page showing how many comments in the page are being filtered by the filters.")),features:{cf_m_f:{name:"Fix filter bar at the top of the page.",sg:!0},cf_m_b:{name:"Hide basic filters.",sg:!0,st:!0},cf_m_a:{name:"Hide advanced filters.",sg:!0,st:!0},cf_bump:{description:()=>Se.element("ul",null,Se.element("li",null,"Allows you to filter bump comments.")),name:"Bump",sg:!0,st:!0},cf_length:{description:()=>Se.element("ul",null,Se.element("li",null,"Allows you to filter comments by their length.")),name:"Length",sg:!0,st:!0},cf_words:{description:()=>Se.element("ul",null,Se.element("li",null,"Allows you to filter comments containing certain words.")),name:"Words",sg:!0,st:!0}},name:"Multiple Filters",sg:!0,st:!0}},id:"cf",name:"Comment Filters",sg:!0,st:!0,type:"comments"}}async init(){d.get("cf_m")&&(c.esgst.commentsPath||c.common.isCurrentPath("Messages"))&&(c.esgst.hasAddedFilterContainer||c.esgst.style.insertAdjacentText("beforeend",`\n\t\t\t\t\t.esgst-gf-container {\n\t\t\t\t\t\tposition: ${d.get("cf_m_f")?"sticky":"static"};\n\t\t\t\t\t\ttop: ${c.esgst.commentsTop}px;\n\t\t\t\t\t}\n\t\t\t\t`),c.common.createHeadingButton({element:this.filters_addContainer(c.esgst.mainPageHeading),id:"cf"}))}getFilters(){return{bump:{check:!0,name:"Bump",type:"boolean"},length:{check:!0,minValue:0,name:"Length",type:"integer"},words:{check:!0,list:!0,name:"Words",type:"string"}}}},ma=hs.checkMissingDiscussions.bind(hs),ha=hs.createHeadingButton.bind(hs),pa=hs.endless_load.bind(hs),fa=hs.getValue.bind(hs),ba=hs.setValue.bind(hs);const wa=new class extends ga{constructor(){super("df"),this.info={description:()=>Se.element("ul",null,Se.element("li",null,"Allows you to filter discussions.")),features:{df_s:{description:()=>Se.element("ul",null,Se.element("li",null,"Adds a button (",Se.element("i",{className:"fa fa-eye"})," if the discussion is hidden and"," ",Se.element("i",{className:"fa fa-eye-slash"})," if it is not) next to a discussion's title (in any page) that allows you to hide the discussion."),Se.element("li",null,"Adds a button (",Se.element("i",{className:"fa fa-comments"})," ",Se.element("i",{className:"fa fa-eye-slash"}),") to the page heading of this menu that allows you to view all of the discussions that have been hidden.")),name:"Single Filters",sg:!0,features:{df_s_s:{name:"Show switch to temporarily hide / unhide discussions filtered by the filters in the main page heading, along with a counter.",sg:!0}}},df_m:{description:()=>Se.element("ul",null,Se.element("li",null,"Allows you to hide multiple discussions in a page using many different filters."),Se.element("li",null,"Adds a toggle switch with a button (",Se.element("i",{className:"fa fa-sliders"}),") to the main page heading of any ",Se.element("a",{href:"https://www.steamgifts.com/discussions"},"discussions")," ","page. The switch allows you to turn the filters on/off and the button allows you to manage your presets."),Se.element("li",null,"Adds a collapsible panel below the same main page heading that allows you to change/save the rules of a preset. The filters are separated in 2 categories:"),Se.element("ul",null,Se.element("li",null,"Basic filters are related to a numeric value (such as the number of comments of a discussion) and have a slider that you can use to set the range of the filter (any discussions that do not apply to the range will be hidden)."),Se.element("li",null,"Type filters are related to a boolean value (such as whether or not a discussion was created by yourself) and have a checkbox that changes states when you click on it. The checkbox has 3 states:"),Se.element("ul",null,Se.element("li",null,'"Show all" (',Se.element("i",{className:"fa fa-check-square"}),") does not hide any discussions that apply to the filter (this is the default state)."),Se.element("li",null,'"Show only" (',Se.element("i",{className:"fa fa-square"}),") hides any discussions that do not apply to the filter."),Se.element("li",null,'"Hide all" (',Se.element("i",{className:"fa fa-square-o"}),") hides any discussions that apply to the filter."))),Se.element("li",null,"A preset contains all of your rules and can be saved to be reused later. You can save as many presets as you want. Each preset contains 3 types of rules:"),Se.element("ul",null,Se.element("li",null,"Basic rules are the ones that you can change directly in the filter panel, using the sliders/checkboxes as explained in the previous item."),Se.element("li",null,"Exception rules are the ones that you can change by clicking on the icon "),Se.element("i",{className:"fa fa-gear"}),' in the filter panel. They are exceptions to the basic rules. For example, if you set the basic rule of the "Created" filter to "hide all" and you add an exception rule for the "Comments" filter to the 0-50 range, none of your created discussions that have 0-50 comments will be hidden, because they apply to the exception.'),Se.element("li",null,"Override rules are the ones that you can change by clicking on the icon (",Se.element("i",{className:"fa fa-exclamation esgst-faded"})," if set to overridable and"," ",Se.element("i",{className:"fa fa-exclamation"}),' if set to non-overridable) next to each filter. They are enforcements of the basic rules. Continuing the previous example, if you set the override rule of the "Created" filter to "non-overridable", then all of your created discussions will be hidden, because even if they apply to the exception, the basic rule is being enforced by the override rule, so the exception cannot override it.')),features:{df_m_f:{name:"Fix filter bar at the top of the page.",sg:!0},df_m_b:{name:"Hide basic filters.",sg:!0},df_m_a:{name:"Hide advanced filters.",sg:!0},df_comments:{description:()=>Se.element("ul",null,Se.element("li",null,"Allows you to filter discussions by number of comments.")),name:"Comments",sg:!0},df_addonsTools:{description:()=>Se.element("ul",null,Se.element("li",null,'Allows you to filter discussions categorized as "Add-ons / Tools".')),name:"Add-ons / Tools",sg:!0},df_announcements:{description:()=>Se.element("ul",null,Se.element("li",null,'Allows you to filter discussions categorized as "Announcements".')),name:"Announcements",sg:!0},df_bugsSuggestions:{description:()=>Se.element("ul",null,Se.element("li",null,'Allows you to filter discussions categorized as "Bugs / Suggestions".')),name:"Bugs / Suggestions",sg:!0},df_deals:{description:()=>Se.element("ul",null,Se.element("li",null,'Allows you to filter discussions categorized as "Deals".')),name:"Deals",sg:!0},df_gameShowcase:{description:()=>Se.element("ul",null,Se.element("li",null,'Allows you to filter discussions categorized as "Game Showcase".')),name:"Game Showcase",sg:!0},df_general:{description:()=>Se.element("ul",null,Se.element("li",null,'Allows you to filter discussions categorized as "General".')),name:"General",sg:!0},df_groupRecruitment:{description:()=>Se.element("ul",null,Se.element("li",null,'Allows you to filter discussions categorized as "Group Recruitment".')),name:"Group Recruitment",sg:!0},df_hardware:{description:()=>Se.element("ul",null,Se.element("li",null,'Allows you to filter discussions categorized as "Hardware".')),name:"Hardware",sg:!0},df_help:{description:()=>Se.element("ul",null,Se.element("li",null,'Allows you to filter discussions categorized as "Help".')),name:"Help",sg:!0},df_letsPlayTogether:{description:()=>Se.element("ul",null,Se.element("li",null,'Allows you to filter discussions categorized as "Let\'s Play Together".')),name:"Let's Play Together",sg:!0},df_moviesTV:{description:()=>Se.element("ul",null,Se.element("li",null,'Allows you to filter discussions categorized as "Movies / TV".')),name:"Movies / TV",sg:!0},df_offTopic:{description:()=>Se.element("ul",null,Se.element("li",null,'Allows you to filter discussions categorized as "Off Topic".')),name:"Off Topic",sg:!0},df_puzzlesEvents:{description:()=>Se.element("ul",null,Se.element("li",null,'Allows you to filter discussions categorized as "Puzzles / Events".')),name:"Puzzles / Events",sg:!0},df_uncategorized:{description:()=>Se.element("ul",null,Se.element("li",null,'Allows you to filter discussions categorized as "Uncategorized".')),name:"Uncategorized",sg:!0},df_userProjects:{description:()=>Se.element("ul",null,Se.element("li",null,'Allows you to filter discussions categorized as "User Projects".')),name:"User Projects",sg:!0},df_whitelistRecruitment:{description:()=>Se.element("ul",null,Se.element("li",null,'Allows you to filter discussions categorized as "Whitelist Recruitment".')),name:"Whitelist Recruitment",sg:!0},df_created:{description:()=>Se.element("ul",null,Se.element("li",null,"Allows you to filter discussions created by yourself.")),name:"Created",sg:!0},df_poll:{description:()=>Se.element("ul",null,Se.element("li",null,"Allows you to filter discussions that contain polls.")),name:"Poll",sg:!0},df_bookmarked:{description:()=>Se.element("ul",null,Se.element("li",null,"Allows you to filter discussions that you have bookmarked.")),name:"Bookmarked",sg:!0},df_visited:{dependencies:["gdttt"],description:()=>Se.element("ul",null,Se.element("li",null,"Allows you to filter discussions that you have visited.")),name:"Visited",sg:!0},df_subscribed:{dependencies:["tds"],description:()=>Se.element("ul",null,Se.element("li",null,"Allows you to filter discussions that you have subcribed.")),name:"Subscribed",sg:!0},df_unread:{dependencies:["ct"],description:()=>Se.element("ul",null,Se.element("li",null,"Allows you to filter discussions that you have read.")),name:"Unread",sg:!0},df_authors:{description:()=>Se.element("ul",null,Se.element("li",null,"Allows you to filter discussions by author.")),name:"Authors",sg:!0}},name:"Multiple Filters",sg:!0}},id:"df",name:"Discussion Filters",sg:!0,type:"discussions"}}async init(){d.get("df_s")&&(d.get("df_s_s")&&this.addSingleButton("fa-comments"),this.esgst.discussionFeatures.push(this.df_addButtons.bind(this))),d.get("df_m")&&this.esgst.discussionsPath&&!this.esgst.editDiscussionPath&&(c.esgst.hasAddedFilterContainer||c.esgst.style.insertAdjacentText("beforeend",`\n\t\t\t\t\t.esgst-gf-container {\n\t\t\t\t\t\tposition: ${d.get("df_m_f")?"sticky":"static"};\n\t\t\t\t\t\ttop: ${c.esgst.commentsTop}px;\n\t\t\t\t\t}\n\t\t\t\t`),ha({element:this.filters_addContainer(this.esgst.mainPageHeading),id:"df"})),this.esgst.giveawaysPath&&this.esgst.activeDiscussions&&!d.get("adots")&&!d.get("oadd")&&await ma()}df_menu(e,t){e.process=new Ws({button:t,popup:{icon:"fa-comments",title:"Hidden Discussions",addProgress:!0,addScrollable:"left"},urls:{id:"df",init:this.df_initUrls.bind(this),request:{request:this.df_requestUrl.bind(this)}}})}async df_initUrls(e){e.popup.getScrollable(Se.element("div",{className:"table esgst-text-left"},Se.element("div",{className:"table__heading"},Se.element("div",{className:"table__column--width-fill"},"Summary"),Se.element("div",{className:"table__column--width-small text-center"},"Comments")),Se.element("div",{className:"table__rows",ref:t=>e.discussions=t})));const t=JSON.parse(fa("discussions"));let s=[];for(const e in t)if(t.hasOwnProperty(e)&&t[e].hidden){const n={code:e,hidden:parseInt(t[e].hidden)};s.push(n)}s=l.sortArray(s,!0,"hidden"),e.ids=[];for(const t of s)e.ids.push(t.code),e.items.push(`/discussion/${t.code}/`)}async df_requestUrl(e,t,s,n){const a=n.getElementsByClassName("page__heading__breadcrumbs"),i=a[0].firstElementChild.nextElementSibling.nextElementSibling,o=n.getElementsByClassName("comment__username")[0].firstElementChild;Se.insert(e.discussions,"beforeend",Se.element("div",null,Se.element("div",{className:"table__row-outer-wrap"},Se.element("div",{className:"table__row-inner-wrap"},Se.element("div",null,n.getElementsByClassName("global__image-outer-wrap")[0]),Se.element("div",{className:"table__column--width-fill"},Se.element("h3",null,Se.element("a",{className:"table__column__heading",href:`/discussion/${e.ids[e.index]}/`},i.nextElementSibling.nextElementSibling.firstElementChild.textContent)),Se.element("p",null,Se.element("a",{className:"table__column__secondary-link",href:i.getAttribute("href")},i.textContent)," - ",n.querySelector(".comment [data-timestamp]")," by ",Se.element("a",{className:"table__column__secondary-link",href:o.getAttribute("href")},o.textContent))),Se.element("div",{className:"table__column--width-small text-center"},Se.element("a",{className:"table__column__secondary-link",href:`/discussion/${e.ids[e.index]}/`},a[1].textContent.match(/(.+) Comments?/)[1])))))),await pa(e.discussions),this.esgst.giveawaysPath||this.esgst.discussionsPath||this.esgst.commentsPath||(d.get("gdttt")?(await this.esgst.modules.commentsCommentTracker.ct_addDiscussionPanels(e.discussions,!0),await this.esgst.modules.generalGiveawayDiscussionTicketTradeTracker.gdttt_checkVisited(e.discussions)):d.get("ct")&&await this.esgst.modules.commentsCommentTracker.ct_addDiscussionPanels(e.discussions,!0),await this.esgst.modules.discussions.discussions_load(e.discussions))}df_addButtons(e,t){for(const s of e)s.heading.parentElement.getElementsByClassName("esgst-df-button")[0]||new Us(s.headingContainer.firstElementChild,"beforebegin",{callbacks:[this.df_hideDiscussion.bind(this,s,t),null,this.df_unhideDiscussion.bind(this,s,t),null],className:"esgst-df-button",icons:["fa-eye-slash esgst-clickable","fa-circle-o-notch fa-spin","fa-eye esgst-clickable","fa-circle-o-notch fa-spin"],id:"df_s",index:s.saved&&s.saved.hidden?2:0,titles:["Hide discussion","Hiding discussion...","Unhide discussion","Unhiding discussion..."]})}async df_hideDiscussion(e,t){const s=new Te("discussion",{threshold:300});await s.lock();let n=JSON.parse(fa("discussions","{}"));return n[e.code]||(n[e.code]={}),n[e.code].hidden=n[e.code].lastUsed=Date.now(),await ba("discussions",JSON.stringify(n)),await s.unlock(),t&&this.esgst.discussionPath||e.outerWrap.remove(),!0}async df_unhideDiscussion(e,t){const s=new Te("discussion",{threshold:300});await s.lock();let n=JSON.parse(fa("discussions","{}"));return n[e.code]&&(delete n[e.code].hidden,n[e.code].lastUsed=Date.now()),await ba("discussions",JSON.stringify(n)),await s.unlock(),t&&this.esgst.discussionPath||e.outerWrap.remove(),!0}getFilters(){return{comments:{check:!0,minValue:0,name:"Comments",type:"integer"},addonsTools:{check:!0,name:"Add-ons / Tools",type:"boolean"},announcements:{check:!0,name:"Announcements",type:"boolean"},bugsSuggestion:{check:!0,name:"Bugs / Suggestion",type:"boolean"},deals:{check:!0,name:"Deals",type:"boolean"},gameShowcase:{check:!0,name:"Game / Showcase",type:"boolean"},general:{check:!0,name:"General",type:"boolean"},groupRecruitment:{check:!0,name:"Group Recruitment",type:"boolean"},hardware:{check:!0,name:"Hardware",type:"boolean"},help:{check:!0,name:"Help",type:"boolean"},letsPlayTogether:{check:!0,name:"Let's Play Together",type:"boolean"},moviesTV:{check:!0,name:"Movies / TV",type:"boolean"},offTopic:{check:!0,name:"Off Topic",type:"boolean"},puzzlesEvents:{check:!0,name:"Puzzles / Events",type:"boolean"},uncategorized:{check:!0,name:"Uncategorized",type:"boolean"},userProjects:{check:!0,name:"User Projects",type:"boolean"},whitelistRecruitment:{check:!0,name:"Whitelist Recruitment",type:"boolean"},created:{check:!0,name:"Created",type:"boolean"},poll:{check:!0,name:"Poll",type:"boolean"},bookmarked:{check:!0,name:"Bookmarked",type:"boolean"},visited:{check:d.get("gdttt"),name:"Visited",type:"boolean"},subscribed:{check:d.get("tds"),name:"Subscribed",type:"boolean"},unread:{check:d.get("ct"),name:"Unread",type:"boolean"},authors:{check:!0,list:!0,name:"Authors",type:"string"}}}},ya=hs.createElements.bind(hs),va=hs.createHeadingButton.bind(hs),_a=hs.endless_load.bind(hs),ka=hs.getValue.bind(hs),xa=hs.setValue.bind(hs);const Aa=new class extends ga{constructor(){super("tf"),this.info={description:()=>Se.element("ul",null,Se.element("li",null,"Allows you to filter trades.")),features:{tf_s:{description:()=>Se.element("ul",null,Se.element("li",null,"Adds a button (",Se.element("i",{className:"fa fa-eye"})," if the trade is hidden and"," ",Se.element("i",{className:"fa fa-eye-slash"})," if it is not) next to a trade's title (in any page) that allows you to hide the trade."),Se.element("li",null,"Adds a button (",Se.element("i",{className:"fa fa-comments"})," ",Se.element("i",{className:"fa fa-eye-slash"}),") to the page heading of this menu that allows you to view all of the trades that have been hidden.")),name:"Single Filters",st:!0,features:{tf_s_s:{name:"Show switch to temporarily hide / unhide trades filtered by the filters in the main page heading, along with a counter.",st:!0}}},tf_m:{description:()=>Se.element("ul",null,Se.element("li",null,"Allows you to hide multiple trades in a page using many different filters."),Se.element("li",null,"Adds a toggle switch with a button (",Se.element("i",{className:"fa fa-sliders"}),") to the main page heading of any ",Se.element("a",{href:"https://www.steamtrades.com/trades"},"trades")," page. The switch allows you to turn the filters on/off and the button allows you to manage your presets."),Se.element("li",null,"Adds a collapsible panel below the same main page heading that allows you to change/save the rules of a preset. The filters are separated in 2 categories:"),Se.element("ul",null,Se.element("li",null,"Basic filters are related to a numeric value (such as the number of comments of a trade) and have a slider that you can use to set the range of the filter (any trades that do not apply to the range will be hidden)."),Se.element("li",null,"Type filters are related to a boolean value (such as whether or not a trade was created by yourself) and have a checkbox that changes states when you click on it. The checkbox has 3 states:"),Se.element("ul",null,Se.element("li",null,'"Show all" (',Se.element("i",{className:"fa fa-check-square"}),") does not hide any trades that apply to the filter (this is the default state)."),Se.element("li",null,'"Show only" (',Se.element("i",{className:"fa fa-square"}),") hides any trades that do not apply to the filter."),Se.element("li",null,'"Hide all" (',Se.element("i",{className:"fa fa-square-o"}),") hides any trades that apply to the filter."))),Se.element("li",null,"A preset contains all of your rules and can be saved to be reused later. You can save as many presets as you want. Each preset contains 3 types of rules:"),Se.element("ul",null,Se.element("li",null,"Basic rules are the ones that you can change directly in the filter panel, using the sliders/checkboxes as explained in the previous item."),Se.element("li",null,"Exception rules are the ones that you can change by clicking on the icon "),Se.element("i",{className:"fa fa-gear"}),' in the filter panel. They are exceptions to the basic rules. For example, if you set the basic rule of the "Created" filter to "hide all" and you add an exception rule for the "Comments" filter to the 0-50 range, none of your created trades that have 0-50 comments will be hidden, because they apply to the exception.'),Se.element("li",null,"Override rules are the ones that you can change by clicking on the icon (",Se.element("i",{className:"fa fa-exclamation esgst-faded"})," if set to overridable and"," ",Se.element("i",{className:"fa fa-exclamation"}),' if set to non-overridable) next to each filter. They are enforcements of the basic rules. Continuing the previous example, if you set the override rule of the "Created" filter to "non-overridable", then all of your created trades will be hidden, because even if they apply to the exception, the basic rule is being enforced by the override rule, so the exception cannot override it.')),features:{tf_m_f:{name:"Fix filter bar at the top of the page.",st:!0},tf_m_b:{name:"Hide basic filters.",st:!0},tf_m_a:{name:"Hide advanced filters.",st:!0},tf_comments:{description:()=>Se.element("ul",null,Se.element("li",null,"Allows you to filter trades by number of comments.")),name:"Comments",st:!0},tf_created:{description:()=>Se.element("ul",null,Se.element("li",null,"Allows you to filter trades created by yourself.")),name:"Created",st:!0},tf_visited:{dependencies:["gdttt"],description:()=>Se.element("ul",null,Se.element("li",null,"Allows you to filter trades that you have visited.")),name:"Visited",st:!0},tf_subscribed:{dependencies:["tds"],description:()=>Se.element("ul",null,Se.element("li",null,"Allows you to filter trades that you have subscribed.")),name:"Subscribed",st:!0},tf_unread:{dependencies:["ct"],description:()=>Se.element("ul",null,Se.element("li",null,"Allows you to filter trades that you have read.")),name:"Unread",st:!0},tf_authors:{description:()=>Se.element("ul",null,Se.element("li",null,"Allows you to filter trades by author.")),name:"Authors",st:!0},tf_positiveReputation:{description:()=>Se.element("ul",null,Se.element("li",null,"Allows you to filter trades by the positive reputation of the author.")),name:"Positive Reputation",st:!0},tf_negativeReputation:{description:()=>Se.element("ul",null,Se.element("li",null,"Allows you to filter trades by the negative reputation of the author.")),name:"Negative Reputation",st:!0}},name:"Multiple Filters",st:!0}},id:"tf",name:"Trade Filters",st:!0,type:"trades"}}async init(){d.get("tf_s")&&(d.get("tf_s_s")&&this.addSingleButton("fa-comments"),this.esgst.tradeFeatures.push(this.tf_addButtons.bind(this))),d.get("tf_m")&&c.esgst.tradesPath&&!c.esgst.editTradePath&&(c.esgst.hasAddedFilterContainer||c.esgst.style.insertAdjacentText("beforeend",`\n\t\t\t\t\t.esgst-gf-container {\n\t\t\t\t\t\tposition: ${d.get("tf_m_f")?"sticky":"static"};\n\t\t\t\t\t\ttop: ${c.esgst.commentsTop}px;\n\t\t\t\t\t}\n\t\t\t\t`),va({element:this.filters_addContainer(c.esgst.mainPageHeading),id:"tf"}))}tf_menu(e,t){e.process=new Ws({button:t,popup:{icon:"fa-comments",title:"Hidden Trades",addProgress:!0,addScrollable:"left"},urls:{id:"tf",init:this.tf_initUrls.bind(this),request:{request:this.tf_requestUrl.bind(this)}}})}async tf_initUrls(e){e.popup.getScrollable(Se.element("div",{className:"table is_trades esgst-text-left"},Se.element("div",{className:"header"},Se.element("div",{className:"header_summary"},"Summary"),Se.element("div",{className:"header_comments"},"Comments")),Se.element("div",{className:"table__rows",ref:t=>e.trades=t})));const t=JSON.parse(ka("trades"));let s=[];for(const e in t)if(t.hasOwnProperty(e)&&t[e].hidden){const n={code:e,hidden:parseInt(t[e].hidden)};s.push(n)}s=l.sortArray(s,!0,"hidden"),e.ids=[];for(const t of s)e.ids.push(t.code),e.items.push(`/trade/${t.code}/`)}async tf_requestUrl(e,t,s,n){const a=n.getElementsByClassName("page_heading_breadcrumbs"),i=n.getElementsByClassName("author_name")[0],o=n.getElementsByClassName("author_avatar")[0];o.classList.remove("author_avatar"),o.classList.add("avatar");const r=n.getElementsByClassName("author_small")[0];r.classList.remove("author_small"),r.classList.add("reputation"),ya(e.trades,"beforeend",[{type:"div",children:[{attributes:{class:"row_outer_wrap"},type:"div",children:[{attributes:{class:"row_inner_wrap"},type:"div",children:[{type:"div",children:[{context:o}]},{attributes:{class:"row_trade_name"},type:"div",children:[{type:"h2",children:[{attributes:{href:`/trade/${e.ids[e.index]}/`},text:a[0].firstElementChild.nextElementSibling.nextElementSibling.firstElementChild.textContent,type:"a"}]}]},{attributes:{class:"row_trade_creator_user"},type:"div",children:[{type:"p",children:[{attributes:{class:"row_expanded"},text:" ",type:"span"},{context:n.querySelector(".comment_outer [data-timestamp]")},{text:" by ",type:"node"},{attributes:{class:"underline",href:i.getAttribute("href")},text:i.textContent,type:"a"},{text:" ",type:"node"},{context:r}]}]},{attributes:{class:"row_trade_comments"},type:"div",children:[{attributes:{class:"underline",href:`/trade/${e.ids[e.index]}/`},text:""+a[1].textContent.match(/(.+) Comments?/)[1],type:"a"}]}]}]}]}]),await _a(e.trades),c.esgst.tradesPath||(d.get("gdttt")?(await c.esgst.modules.commentsCommentTracker.ct_addDiscussionPanels(e.trades,!0),await c.esgst.modules.generalGiveawayDiscussionTicketTradeTracker.gdttt_checkVisited(e.trades)):d.get("ct")&&await c.esgst.modules.commentsCommentTracker.ct_addDiscussionPanels(e.trades,!0),await c.esgst.modules.discussions.discussions_load(e.trades))}tf_addButtons(e,t){for(const s of e)s.heading.parentElement.getElementsByClassName("esgst-df-button")[0]||new Us(s.headingContainer.firstElementChild,"beforebegin",{callbacks:[this.tf_hideTrade.bind(this,s,t),null,this.tf_unhideTrade.bind(this,s,t),null],className:"esgst-df-button",icons:["fa-eye-slash esgst-clickable","fa-circle-o-notch fa-spin","fa-eye esgst-clickable","fa-circle-o-notch fa-spin"],id:"tf_s",index:s.saved&&s.saved.hidden?2:0,titles:["Hide trade","Hiding trade...","Unhide trade","Unhiding trade..."]})}async tf_hideTrade(e,t){const s=new Te("trade",{threshold:300});await s.lock();let n=JSON.parse(ka("trades","{}"));return n[e.code]||(n[e.code]={}),n[e.code].hidden=n[e.code].lastUsed=Date.now(),await xa("trades",JSON.stringify(n)),await s.unlock(),t&&c.esgst.tradePath||e.outerWrap.remove(),!0}async tf_unhideTrade(e,t){const s=new Te("trade",{threshold:300});await s.lock();let n=JSON.parse(ka("trades","{}"));return n[e.code]&&(delete n[e.code].hidden,n[e.code].lastUsed=Date.now()),await xa("trades",JSON.stringify(n)),await s.unlock(),t&&c.esgst.tradePath||e.outerWrap.remove(),!0}getFilters(){return{comments:{check:!0,minValue:0,name:"Comments",type:"integer"},created:{check:!0,name:"Created",type:"boolean"},visited:{check:d.get("gdttt"),name:"Visited",type:"boolean"},subscribed:{check:d.get("tds"),name:"Subscribed",type:"boolean"},unread:{check:d.get("ct"),name:"Unread",type:"boolean"},authors:{check:!0,list:!0,name:"Authors",type:"string"},positiveReputation:{check:!0,minValue:0,name:"Positive Reputation",type:"integer"},negativeReputation:{check:!0,minValue:0,name:"Negative Reputation",type:"integer"}}}};const Ca=new class extends ga{constructor(){super("gpf"),this.info={description:()=>Se.element("ul",null,Se.element("li",null,"Allows you to filter groups."),Se.element("li",null,"Adds a toggle switch with a button (",Se.element("i",{className:"fa fa-sliders"}),") to the main page heading of the ",Se.element("a",{href:"https://www.steamgifts.com/account/steam/groups"},"groups")," ","page. The switch allows you to turn the filters on/off and the button allows you to manage your presets."),Se.element("li",null,"Adds a collapsible panel below the same main page heading that allows you to change/save the rules of a preset. The filters are separated in 2 categories:"),Se.element("ul",null,Se.element("li",null,"Basic filters are related to a numeric value (such as the number of comments of a group) and have a slider that you can use to set the range of the filter (any groups that do not apply to the range will be hidden)."),Se.element("li",null,"Type filters are related to a boolean value (such as whether or not a group was created by yourself) and have a checkbox that changes states when you click on it. The checkbox has 3 states:"),Se.element("ul",null,Se.element("li",null,'"Show all" (',Se.element("i",{className:"fa fa-check-square"}),") does not hide any groups that apply to the filter (this is the default state)."),Se.element("li",null,'"Show only" (',Se.element("i",{className:"fa fa-square"}),") hides any groups that do not apply to the filter."),Se.element("li",null,'"Hide all" (',Se.element("i",{className:"fa fa-square-o"}),") hides any groups that apply to the filter."))),Se.element("li",null,"A preset contains all of your rules and can be saved to be reused later. You can save as many presets as you want. Each preset contains 3 types of rules:"),Se.element("ul",null,Se.element("li",null,"Basic rules are the ones that you can change directly in the filter panel, using the sliders/checkboxes as explained in the previous item."),Se.element("li",null,"Exception rules are the ones that you can change by clicking on the icon "),Se.element("i",{className:"fa fa-gear"}),' in the filter panel. They are exceptions to the basic rules. For example, if you set the basic rule of the "Created" filter to "hide all" and you add an exception rule for the "Comments" filter to the 0-50 range, none of your created groups that have 0-50 comments will be hidden, because they apply to the exception.'),Se.element("li",null,"Override rules are the ones that you can change by clicking on the icon (",Se.element("i",{className:"fa fa-exclamation esgst-faded"})," if set to overridable and"," ",Se.element("i",{className:"fa fa-exclamation"}),' if set to non-overridable) next to each filter. They are enforcements of the basic rules. Continuing the previous example, if you set the override rule of the "Created" filter to "non-overridable", then all of your created groups will be hidden, because even if they apply to the exception, the basic rule is being enforced by the override rule, so the exception cannot override it.'),Se.element("li",null,"Adds a text in parenthesis to the pagination of the page showing how many groups in the page are being filtered by the filters.")),features:{gpf_m_f:{name:"Fix filter bar at the top of the page.",sg:!0},gpf_m_b:{name:"Hide basic filters.",sg:!0},gpf_m_a:{name:"Hide advanced filters.",sg:!0},gpf_firstGiveaway:{dependencies:["gs","gs_firstGiveaway"],description:()=>Se.element("ul",null,Se.element("li",null,"Allows you to filter groups by the date of the first giveaway made.")),name:"First Giveaway",sg:!0},gpf_lastGiveaway:{dependencies:["gs","gs_lastGiveaway"],description:()=>Se.element("ul",null,Se.element("li",null,"Allows you to filter groups by the date of the last giveaway made.")),name:"Last Giveaway",sg:!0},gpf_averageEntries:{dependencies:["gs","gs_averageEntries"],description:()=>Se.element("ul",null,Se.element("li",null,"Allows you to filter groups by the number of average entries per giveaway.")),name:"Average Entries",sg:!0},gpf_contributors:{dependencies:["gs","gs_contributors"],description:()=>Se.element("ul",null,Se.element("li",null,"Allows you to filter groups by the number of members that have contributed.")),name:"Contributors",sg:!0},gpf_winners:{dependencies:["gs","gs_winners"],description:()=>Se.element("ul",null,Se.element("li",null,"Allows you to filter groups by the number of members that have won.")),name:"Winners",sg:!0},gpf_giftsSent:{dependencies:["gs","gs_giftsSent"],description:()=>Se.element("ul",null,Se.element("li",null,"Allows you to filter groups by the number of gifts that have been sent.")),name:"Gifts Sent",sg:!0},gpf_giftsSentValue:{dependencies:["gs","gs_giftsSent"],description:()=>Se.element("ul",null,Se.element("li",null,"Allows you to filter groups by the dollar value of gifts that have been sent.")),name:"Gifts Sent Value",sg:!0},gpf_sent:{dependencies:["gs","gs_sent"],description:()=>Se.element("ul",null,Se.element("li",null,"Allows you to filter groups by the number of gifts that you have sent.")),name:"Sent",sg:!0},gpf_sentValue:{dependencies:["gs","gs_sent"],description:()=>Se.element("ul",null,Se.element("li",null,"Allows you to filter groups by the dollar value of gifts that you have sent.")),name:"Sent Value",sg:!0},gpf_received:{dependencies:["gs","gs_received"],description:()=>Se.element("ul",null,Se.element("li",null,"Allows you to filter groups by the number of gifts that you have received.")),name:"Received",sg:!0},gpf_receivedValue:{dependencies:["gs","gs_received"],description:()=>Se.element("ul",null,Se.element("li",null,"Allows you to filter groups by the dollar value of gifts that you have received.")),name:"Received Value",sg:!0},gpf_giftDifference:{dependencies:["gs","gs_giftDifference"],description:()=>Se.element("ul",null,Se.element("li",null,"Allows you to filter groups on the difference between gifts you have sent and gifts you have receieved.")),name:"Gift Difference",sg:!0},gpf_valueDifference:{dependencies:["gs","gs_valueDifference"],description:()=>Se.element("ul",null,Se.element("li",null,"Allows you to filter groups based on the dollar difference between the value of gifts you have sent and the value of gifts you have received.")),name:"Value Difference",sg:!0},gpf_giveaways:{dependencies:["gs","gs_giveaways"],description:()=>Se.element("ul",null,Se.element("li",null,"Allows you to filter groups by the number of giveaways that have been made.")),name:"Giveaways",sg:!0},gpf_users:{dependencies:["gs","gs_users"],description:()=>Se.element("ul",null,Se.element("li",null,"Allows you to filter groups by the number of users that are members.")),name:"Users",sg:!0},gpf_creationDate:{dependencies:["gs","gs_creationDate"],description:()=>Se.element("ul",null,Se.element("li",null,"Allows you to filter groups by their creation date.")),name:"Creation Date",sg:!0},gpf_officialGameGroup:{dependencies:["gs","gs_type"],description:()=>Se.element("ul",null,Se.element("li",null,"Allows you to filter groups that are official game groups.")),name:"Official Game Group",sg:!0},gpf_open:{dependencies:["gs","gs_type"],description:()=>Se.element("ul",null,Se.element("li",null,"Allows you to filter groups that are open to join.")),name:"Open",sg:!0},gpf_restricted:{dependencies:["gs","gs_type"],description:()=>Se.element("ul",null,Se.element("li",null,"Allows you to filter groups that are restricted to join.")),name:"Restricted",sg:!0},gpf_closed:{dependencies:["gs","gs_type"],description:()=>Se.element("ul",null,Se.element("li",null,"Allows you to filter groups that are closed to join.")),name:"Closed",sg:!0}},id:"gpf",name:"Group Filters",sg:!0,type:"groups"}}async init(){c.common.isCurrentPath("Steam - Groups")&&(c.esgst.hasAddedFilterContainer||c.esgst.style.insertAdjacentText("beforeend",`\n\t\t\t\t.esgst-gf-container {\n\t\t\t\t\tposition: ${d.get("gpf_m_f")?"sticky":"static"};\n\t\t\t\t\ttop: ${c.esgst.commentsTop}px;\n\t\t\t\t}\n\t\t\t`),hs.createHeadingButton({element:this.filters_addContainer(c.esgst.mainPageHeading),id:"gpf"}))}getFilters(){return{giveaways:{check:d.get("gs")&&d.get("gs_giveaways"),name:"Giveaways",type:"integer"},users:{check:d.get("gs")&&d.get("gs_users"),name:"Users",type:"integer"},firstGiveaway:{check:d.get("gs")&&d.get("gs_firstGiveaway"),date:!0,name:"First Giveaway",type:"integer"},lastGiveaway:{check:d.get("gs")&&d.get("gs_lastGiveaway"),date:!0,name:"Last Giveaway",type:"integer"},averageEntries:{check:d.get("gs")&&d.get("gs_averageEntries"),name:"Average Entries",type:"integer"},contributors:{check:d.get("gs")&&d.get("gs_contributors"),name:"Contributors",type:"integer"},winners:{check:d.get("gs")&&d.get("gs_winners"),name:"Winners",type:"integer"},giftsSent:{check:d.get("gs")&&d.get("gs_giftsSent"),name:"Gifts Sent",type:"integer"},giftsSentValue:{check:d.get("gs")&&d.get("gs_giftsSent"),name:"Gifts Sent Value",type:"double"},sent:{check:d.get("gs")&&d.get("gs_sent"),name:"Sent",type:"double"},sentValue:{check:d.get("gs")&&d.get("gs_sent"),name:"Sent Value",type:"double"},received:{check:d.get("gs")&&d.get("gs_received"),name:"Received",type:"double"},receivedValue:{check:d.get("gs")&&d.get("gs_received"),name:"Received Value",type:"double"},giftDifference:{check:d.get("gs")&&d.get("gs_giftDifference"),name:"Gift Difference",type:"double"},valueDifference:{check:d.get("gs")&&d.get("gs_valueDifference"),name:"Value Difference",type:"double"},creationDate:{check:d.get("gs")&&d.get("gs_creationDate"),date:!0,name:"Creation Date",type:"integer"},officialGameGroup:{check:d.get("gs")&&d.get("gs_type"),name:"Official Game Group",type:"boolean"},open:{check:d.get("gs")&&d.get("gs_type"),name:"Open",type:"boolean"},restricted:{check:d.get("gs")&&d.get("gs_type"),name:"Restricted",type:"boolean"},closed:{check:d.get("gs")&&d.get("gs_type"),name:"Closed",type:"boolean"}}}},Sa=hs.createHeadingButton.bind(hs),Ea=hs.getValue.bind(hs),Ta=hs.setValue.bind(hs);const Na=new class extends ga{constructor(){super("gf"),this.info={description:()=>Se.element("fragment",null,"Filter giveaways."),features:{gf_s:{description:()=>Se.element("ul",null,Se.element("li",null,"Adds a button (",Se.element("i",{className:"fa fa-eye-slash"}),") next to a giveaway's title in any page that allows you to hide that individual giveaway."),Se.element("li",null,"Adds a button (",Se.element("i",{className:"fa fa-gift"})," ",Se.element("i",{className:"fa fa-eye-slash"}),") to the page heading of the settings menu that allows you to manage your hidden giveaways.")),name:"Single Filters",sg:!0,features:{gf_s_s:{name:"Show switch to temporarily hide / unhide giveaways filtered by the filters in the main page heading, along with a counter.",sg:!0}}},gf_m:{description:()=>Se.element("ul",null,Se.element("li",null,"Allows you to hide multiple giveaways in a page using many different filters."),Se.element("li",null,"Adds a toggle switch with a button (",Se.element("i",{className:"fa fa-sliders"}),") to the main page heading of any ",Se.element("a",{href:"https://www.steamgifts.com/giveaways"},"giveaways"),"/",Se.element("a",{href:"https://www.steamgifts.com/giveaways/created"},"created"),"/",Se.element("a",{href:"https://www.steamgifts.com/giveaways/entered"},"entered"),"/",Se.element("a",{href:"https://www.steamgifts.com/giveaways/won"},"won"),"/",Se.element("a",{href:"https://www.steamgifts.com/user/cg"},"user"),"/",Se.element("a",{href:"https://www.steamgifts.com/group/SJ7Bu/"},"group")," page and some popups (",Se.element("span",{"data-esgst-feature-id":"gb"}),", ",Se.element("span",{"data-esgst-feature-id":"ged"}),","," ",Se.element("span",{"data-esgst-feature-id":"ge"}),", etc...). The switch allows you to turn the filters on/off and the button allows you to manage your presets."),Se.element("li",null,"Adds a collapsible panel below the same main page heading that allows you to change/save the rules of a preset. The filters are separated in 3 categories:"),Se.element("ul",null,Se.element("li",null,"Basic filters are related to a numeric value (such as the level of a giveaway) and have a slider that you can use to set the range of the filter (any giveaways that do not apply to the range will be hidden)."),Se.element("li",null,"Type filters are related to a boolean value (such as whether or not a giveaway was created by yourself) and have a checkbox that changes states when you click on it. The checkbox has 3 states:"),Se.element("ul",null,Se.element("li",null,'"Show all" (',Se.element("i",{className:"fa fa-check-square"}),") does not hide any giveaways that apply to the filter (this is the default state)."),Se.element("li",null,'"Show only" (',Se.element("i",{className:"fa fa-square"}),") hides any giveaways that do not apply to the filter."),Se.element("li",null,'"Hide all" (',Se.element("i",{className:"fa fa-square-o"}),") hides any giveaways that apply to the filter.")),Se.element("li",null,"Category filters are essentially the same thing as type filters, but for game categories (",Se.element("span",{"data-esgst-feature-id":"gc"}),").")),Se.element("li",null,"A preset contains all of your rules and can be saved to be reused later. You can save as many presets as you want. Each preset contains 3 types of rules:"),Se.element("ul",null,Se.element("li",null,"Basic rules are the ones that you can change directly in the filter panel, using the sliders/checkboxes as explained in the previous item."),Se.element("li",null,"Exception rules are the ones that you can change by clicking on the icon"," ",Se.element("i",{className:"fa fa-gear"}),' in the filter panel. They are exceptions to the basic rules. For example, if you set the basic rule of the "Created" filter to "hide all" and you add an exception rule for the "Level" filter to the 0-5 range, none of your created giveaways that are for the levels 0-5 will be hidden, because they apply to the exception.'),Se.element("li",null,"Override rules are the ones that you can change by clicking on the icon (",Se.element("i",{className:"fa fa-exclamation esgst-faded"})," if set to overridable and"," ",Se.element("i",{className:"fa fa-exclamation"}),' if set to non-overridable) next to each filter. They are enforcements of the basic rules. Continuing the previous example, if you set the override rule of the "Created" filter to "non-overridable", then all of your created giveaways will be hidden, because even if they apply to the exception, the basic rule is being enforced by the override rule, so the exception cannot override it.'))),features:{gf_m_f:{name:"Fix filter bar at the top of the page.",sg:!0},gf_m_b:{name:"Hide basic filters.",sg:!0},gf_m_a:{name:"Hide advanced filters.",sg:!0},gf_level:{description:()=>Se.element("ul",null,Se.element("li",null,"Allows you to filter giveaways by level.")),name:"Level",sg:!0},gf_entries:{description:()=>Se.element("ul",null,Se.element("li",null,"Allows you to filter giveaways by number of entries.")),name:"Entries",sg:!0},gf_copies:{description:()=>Se.element("ul",null,Se.element("li",null,"Allows you to filter giveaways by number of copies.")),name:"Copies",sg:!0},gf_points:{description:()=>Se.element("ul",null,Se.element("li",null,"Allows you to filter giveaways by how many points they cost.")),name:"Points",sg:!0},gf_comments:{description:()=>Se.element("ul",null,Se.element("li",null,"Allows you to filter giveaways by number of comments.")),name:"Comments",sg:!0},gf_minutesToEnd:{description:()=>Se.element("ul",null,Se.element("li",null,"Allows you to filter giveaways by how much time they have left.")),name:"Minutes To End",sg:!0},gf_minutesFromStart:{description:()=>Se.element("ul",null,Se.element("li",null,"Allows you to filter giveaways by how long ago they started.")),name:"Minutes From Start",sg:!0},gf_chance:{dependencies:["gwc"],description:()=>Se.element("ul",null,Se.element("li",null,"Allows you to filter giveaways by chance (basic).")),name:"Chance",sg:!0},gf_projectedChance:{dependencies:["gwc","gwc_a"],description:()=>Se.element("ul",null,Se.element("li",null,"Allows you to filter giveaways by projected chance (advanced).")),name:"Projected Chance",sg:!0},gf_chancePerPoint:{dependencies:["gwc"],description:()=>Se.element("ul",null,Se.element("li",null,"Allows you to filter giveaways by chance per point using the basic chance.")),name:"Chance Per Point",sg:!0},gf_projectedChancePerPoint:{dependencies:["gwc","gwc_a"],description:()=>Se.element("ul",null,Se.element("li",null,"Allows you to filter giveaways by chance per point using the advanced chance.")),name:"Projected Chance Per Point",sg:!0},gf_ratio:{dependencies:["gwr"],description:()=>Se.element("ul",null,Se.element("li",null,"Allows you to filter giveaways by ratio (basic).")),name:"Ratio",sg:!0},gf_projectedRatio:{dependencies:["gwr","gwr_a"],description:()=>Se.element("ul",null,Se.element("li",null,"Allows you to filter giveaways by projected ratio (advanced).")),name:"Projected Ratio",sg:!0},gf_pointsToWin:{dependencies:["gptw"],description:()=>Se.element("ul",null,Se.element("li",null,"Allows you to filter giveaways by points to win.")),name:"Points To Win",sg:!0},gf_rating:{dependencies:["gc","gc_r"],description:()=>Se.element("ul",null,Se.element("li",null,"Allows you to filter giveaways by rating percentage of the game.")),name:"Rating",sg:!0},gf_reviews:{dependencies:["gc","gc_r"],description:()=>Se.element("ul",null,Se.element("li",null,"Allows you to filter giveaways by the number of reviews that the game has.")),name:"Reviews",sg:!0},gf_releaseDate:{dependencies:["gc","gc_rd"],description:()=>Se.element("ul",null,Se.element("li",null,"Allows you to filter giveaways by release date of the game.")),name:"Release Date",sg:!0},gf_pinned:{description:()=>Se.element("ul",null,Se.element("li",null,"Allows you to filter giveaways that are pinned.")),name:"Pinned",sg:!0},gf_public:{description:()=>Se.element("ul",null,Se.element("li",null,"Allows you to filter giveaways that are public.")),name:"Public",sg:!0},gf_inviteOnly:{description:()=>Se.element("ul",null,Se.element("li",null,"Allows you to filter giveaways that are invite only.")),name:"Invite Only",sg:!0},gf_group:{description:()=>Se.element("ul",null,Se.element("li",null,"Allows you to filter giveaways that are for groups.")),name:"Group",sg:!0},gf_whitelist:{description:()=>Se.element("ul",null,Se.element("li",null,"Allows you to filter giveaways that are for whitelist.")),name:"Whitelist",sg:!0},gf_nonMemberGroup:{dependencies:["cl","ggl"],description:()=>Se.element("ul",null,Se.element("li",null,"Allows you to filter giveaways that are for groups/whitelist, where you're not a member of any of the groups.")),name:"Non-Member Group",sg:!0},gf_regionRestricted:{description:()=>Se.element("ul",null,Se.element("li",null,"Allows you to filter giveaways that are region restricted.")),name:"Region Restricted",sg:!0},gf_enterable:{description:()=>Se.element("ul",null,Se.element("li",null,"Allows you filter giveaways that are enterable in"," ",Se.element("span",{"data-esgst-feature-id":"ge"}),"."),Se.element("li",null,"The difference between this filter and"," ",Se.element("span",{"data-esgst-feature-id":"gf_currentlyEnterable"})," is that this filter checks if you are allowed to enter the giveaway, not if you can enter the giveaway at the moment (for example, if the giveaway has not started yet or you do not have enough points to enter the giveaway, the giveaway is considered as enterable, just not currently enterable).")),name:"Enterable",sg:!0},gf_currentlyEnterable:{description:()=>Se.element("ul",null,Se.element("li",null,"Allows you filter giveaways that are currently enterable in"," ",Se.element("span",{"data-esgst-feature-id":"ge"}),"."),Se.element("li",null,"The difference between this filter and"," ",Se.element("span",{"data-esgst-feature-id":"gf_enterable"})," is that this filter checks if you can enter the giveaway at the moment, not if you are allowed to enter the giveaway (for example, if the giveaway has not started yet or you do not have enough points to enter the giveaway, the giveaway is not considered as currently enterable, but just enterable).")),name:"Currently Enterable",sg:!0},gf_created:{description:()=>Se.element("ul",null,Se.element("li",null,"Allows you to filter giveaways created by yourself.")),name:"Created",sg:!0},gf_received:{description:()=>Se.element("ul",null,Se.element("li",null,"Allows you to filter giveaways that have been marked as received.")),name:"Received",sg:!0},gf_notReceived:{description:()=>Se.element("ul",null,Se.element("li",null,"Allows you to filter giveaways that have been marked as not received.")),name:"Not Received",sg:!0},gf_awaitingFeedback:{description:()=>Se.element("ul",null,Se.element("li",null,"Allows you to filter giveaways that are awaiting feedback.")),name:"Awaiting Feedback",sg:!0},gf_entered:{description:()=>Se.element("ul",null,Se.element("li",null,"Allows you to filter giveaways that you have entered.")),name:"Entered",sg:!0},gf_started:{description:()=>Se.element("ul",null,Se.element("li",null,"Allows you to filter giveaways that have started.")),name:"Started",sg:!0},gf_ended:{description:()=>Se.element("ul",null,Se.element("li",null,"Allows you to filter giveaways that have ended.")),name:"Ended",sg:!0},gf_deleted:{description:()=>Se.element("ul",null,Se.element("li",null,"Allows you to filter giveaways that have been deleted.")),name:"Deleted",sg:!0},gf_owned:{description:()=>Se.element("ul",null,Se.element("li",null,"Allows you to filter giveaways for games that you own on Steam.")),name:"Owned",sg:!0},gf_wishlisted:{description:()=>Se.element("ul",null,Se.element("li",null,"Allows you to filter giveaways for games that you have wishlisted on Steam.")),name:"Wishlisted",sg:!0},gf_previouslyWishlisted:{description:()=>Se.element("ul",null,Se.element("li",null,"Allows you to filter giveaways for games that you previously had on your wishlist.")),name:"Previously Wishlisted",sg:!0},gf_followed:{description:()=>Se.element("ul",null,Se.element("li",null,"Allows you to filter giveaways for games that you have followed on Steam.")),name:"Followed",sg:!0,syncKeys:["FollowedGames"]},gf_hidden:{description:()=>Se.element("ul",null,Se.element("li",null,"Allows you to filter giveaways for games that you have hidden on SteamGifts.")),name:"Hidden",sg:!0},gf_ignored:{description:()=>Se.element("ul",null,Se.element("li",null,"Allows you to filter giveaways for games that you have ignored on Steam.")),name:"Ignored",sg:!0},gf_previouslyEntered:{dependencies:["egh"],description:()=>Se.element("ul",null,Se.element("li",null,"Allows you to filter giveaways for games that you have previously entered giveaways for.")),name:"Previously Entered",sg:!0},gf_previouslyWon:{description:()=>Se.element("ul",null,Se.element("li",null,"Allows you to filter giveaways for games that you have previously won.")),name:"Previously Won",sg:!0},gf_bookmarked:{dependencies:["gb"],description:()=>Se.element("ul",null,Se.element("li",null,"Allows you to filter giveaways that you have bookmarked.")),name:"Bookmarked",sg:!0},gf_fullCV:{description:()=>Se.element("ul",null,Se.element("li",null,"Allows you to filter giveaways for games that give full CV.")),name:"Full CV",sg:!0},gf_reducedCV:{description:()=>Se.element("ul",null,Se.element("li",null,"Allows you to filter giveaways for games that give reduced CV.")),name:"Reduced CV",sg:!0},gf_noCV:{description:()=>Se.element("ul",null,Se.element("li",null,"Allows you to filter giveaways for games that give no CV.")),name:"No CV",sg:!0},gf_sgTools:{dependencies:["ge"],description:()=>Se.element("ul",null,Se.element("li",null,"Allows you to filter SGTools giveaways.")),name:"SGTools",sg:!0},gf_groups:{dependencies:["cl","ggl"],description:()=>Se.element("ul",null,Se.element("li",null,"Allows you to filter giveaways by group.")),name:"Groups",sg:!0},gf_creators:{description:()=>Se.element("ul",null,Se.element("li",null,"Allows you to filter giveaways by creator.")),name:"Creators",sg:!0},gf_winners:{description:()=>Se.element("ul",null,Se.element("li",null,"Allows you to filter giveaways by winner.")),name:"Winners",sg:!0},gf_learning:{dependencies:["gc","gc_lg"],description:()=>Se.element("ul",null,Se.element("li",null,"Allows you to filter giveaways for games that Steam is learning about.")),name:"Learning",sg:!0},gf_removed:{dependencies:["gc","gc_rm"],description:()=>Se.element("ul",null,Se.element("li",null,"Allows you to filter giveaways for games that have been removed from the Steam store.")),name:"Removed",sg:!0},gf_banned:{dependencies:["gc","gc_bd"],description:()=>Se.element("ul",null,Se.element("li",null,"Allows you to filter giveaways for games that are banned on Steam.")),name:"Banned",sg:!0},gf_tradingCards:{dependencies:["gc","gc_tc"],description:()=>Se.element("ul",null,Se.element("li",null,"Allows you to filter giveaways for games that have trading cards.")),name:"Trading Cards",sg:!0},gf_achievements:{dependencies:["gc","gc_a"],description:()=>Se.element("ul",null,Se.element("li",null,"Allows you to filter giveaways for games that have achievements.")),name:"Achievements",sg:!0},gf_singleplayer:{dependencies:["gc","gc_sp"],description:()=>Se.element("ul",null,Se.element("li",null,"Allows you to filter giveaways for games that are singleplayer.")),name:"Singleplayer",sg:!0},gf_multiplayer:{dependencies:["gc","gc_mp"],description:()=>Se.element("ul",null,Se.element("li",null,"Allows you to filter giveaways for games that are multiplayer.")),name:"Multiplayer",sg:!0},gf_steamCloud:{dependencies:["gc","gc_sc"],description:()=>Se.element("ul",null,Se.element("li",null,"Allows you to filter giveaways for games that have Steam Cloud.")),name:"Steam Cloud",sg:!0},gf_linux:{dependencies:["gc","gc_l"],description:()=>Se.element("ul",null,Se.element("li",null,"Allows you to filter giveaways for games that have are compatible with Linux.")),name:"Linux",sg:!0},gf_mac:{dependencies:["gc","gc_m"],description:()=>Se.element("ul",null,Se.element("li",null,"Allows you to filter giveaways for games that are compatible with Mac.")),name:"Mac",sg:!0},gf_dlc:{dependencies:["gc","gc_dlc"],description:()=>Se.element("ul",null,Se.element("li",null,"Allows you to filter giveaways for games that are DLCs.")),name:"DLC",sg:!0},gf_dlcOwned:{dependencies:["gc","gc_dlc","gc_dlc_o"],description:()=>Se.element("ul",null,Se.element("li",null,"Allows you to filter giveaways for games that are DLCs and have a base game that you own.")),name:"DLC (Owned Base)",sg:!0},gf_dlcFree:{dependencies:["gc","gc_dlc","gc_dlc_b"],description:()=>Se.element("ul",null,Se.element("li",null,"Allows you to filter giveaways for games that are DLCs and have a free base game.")),name:"DLC (Free Base)",sg:!0},gf_dlcNonFree:{dependencies:["gc","gc_dlc","gc_dlc_b"],description:()=>Se.element("ul",null,Se.element("li",null,"Allows you to filter giveaways for games that are DLCs and have a non-free base game.")),name:"DLC (Non-Free Base)",sg:!0},gf_package:{dependencies:["gc","gc_p"],description:()=>Se.element("ul",null,Se.element("li",null,"Allows you to filter giveaways for games that are packages.")),name:"Package",sg:!0},gf_earlyAccess:{dependencies:["gc","gc_ea"],description:()=>Se.element("ul",null,Se.element("li",null,"Allows you to filter giveaways for games that are in early access.")),name:"Early Access",sg:!0},gf_genres:{dependencies:["gc","gc_g"],description:()=>Se.element("ul",null,Se.element("li",null,"Allows you to filter giveaways by game genre.")),name:"Genres",sg:!0},gf_tags:{dependencies:["gt"],description:()=>Se.element("ul",null,Se.element("li",null,"Allows you to filter giveaways by game tags.")),name:"Game Tags",sg:!0},gf_os:{description:()=>Se.element("ul",null,Se.element("li",null,'Allows you to quickly enable/disable SteamGifts\' "Filter by OS" filter.')),name:"OS (SteamGifts)",sg:!0},gf_alreadyOwned:{description:()=>Se.element("ul",null,Se.element("li",null,'Allows you to quickly enable/disable SteamGifts\' "Hide games you already own" filter.')),name:"Already Owned (SteamGifts)",sg:!0},gf_dlcMissingBase:{description:()=>Se.element("ul",null,Se.element("li",null,"Allows you to quickly enable/disable SteamGifts' \"Hide DLC if you're missing the base game\" filter.")),name:"DLC Missing Base (SteamGifts)",sg:!0},gf_aboveLevel:{description:()=>Se.element("ul",null,Se.element("li",null,'Allows you to quickly enable/disable SteamGifts\' "Hide giveaways above your level" filter.')),name:"Above Level (SteamGifts)",sg:!0},gf_manuallyFiltered:{description:()=>Se.element("ul",null,Se.element("li",null,'Allows you to quickly enable/disable SteamGifts\' "Hide games you manually filtered" filter.')),name:"Manually Filtered (SteamGifts)",sg:!0}},name:"Multiple Filters",sg:!0}},id:"gf",name:"Giveaway Filters",sg:!0,sync:"Owned/Wishlisted/Ignored Games, Giveaways, Hidden Games, No CV Games, Reduced CV Games, Won Games",syncKeys:["Games","Giveaways","HiddenGames","NoCvGames","ReducedCvGames","WonGames"],type:"giveaways"}}init(){if(d.get("gf_s")&&(d.get("gf_s_s")&&this.addSingleButton("fa-gift"),this.esgst.giveawayFeatures.push(this.gf_getGiveaways.bind(this))),d.get("gf_m")&&(this.esgst.giveawaysPath||this.esgst.createdPath||this.esgst.enteredPath||this.esgst.wonPath||this.esgst.gamePath||this.esgst.groupPath||this.esgst.userPath)&&(c.esgst.hasAddedFilterContainer||c.esgst.style.insertAdjacentText("beforeend",`\n\t\t\t\t\t.esgst-gf-container {\n\t\t\t\t\t\tposition: ${d.get("gf_m_f")?"sticky":"static"};\n\t\t\t\t\t\ttop: ${c.esgst.commentsTop}px;\n\t\t\t\t\t}\n\t\t\t\t`),Sa({element:this.filters_addContainer(this.esgst.mainPageHeading),id:"gf"})),window.location.pathname.match(/^\/account\/settings\/giveaways$/)&&(d.get("gf_os")||d.get("gf_alreadyOwned")||d.get("gf_dlcMissingBase")||d.get("gf_aboveLevel")||d.get("gf_manuallyFiltered"))){let e,t={filter_os:null,filter_giveaways_exist_in_account:null,filter_giveaways_missing_base_game:null,filter_giveaways_level:null,filter_giveaways_additional_games:null};for(e in t)t[e]=document.querySelector(`[name="${e}"]`);document.getElementsByClassName("form__submit-button js__submit-form")[0].addEventListener("click",()=>{const s=[];for(e in t)s.push({id:e,value:parseInt(t[e].value)});c.common.setSetting(s)})}}gf_getGiveaways(e,t,s){e.forEach(e=>{e.creator===d.get("username")||e.ended||e.entered||!e.url||(("gf"===s||this.esgst.giveawayPath)&&!e.innerWrap.getElementsByClassName("esgst-gf-unhide-button")[0]&&this.esgst.giveaways[e.code]&&this.esgst.giveaways[e.code].hidden&&new Us(e.headingName,"beforebegin",{callbacks:[this.gf_hideGiveaway.bind(this,e,t),null,this.gf_unhideGiveaway.bind(this,e,t),null],className:"esgst-gf-unhide-button",icons:["fa-eye-slash esgst-clickable","fa-circle-o-notch fa-spin","fa-eye esgst-clickable","fa-circle-o-notch fa-spin"],id:"gf_s",index:2,titles:["Hide giveaway","Hiding giveaway...","Unhide giveaway","Unhiding giveaway..."]}).button.setAttribute("data-draggable-id","gf"),("gc"!==s&&(this.esgst.giveawaysPath||this.esgst.gamePath||this.esgst.groupPath)||this.esgst.giveawayPath)&&(e.innerWrap.getElementsByClassName("esgst-gf-hide-button")[0]||this.esgst.giveaways[e.code]&&this.esgst.giveaways[e.code].hidden&&this.esgst.giveaways[e.code].code||new Us(e.headingName,"beforebegin",{callbacks:[this.gf_hideGiveaway.bind(this,e,t),null,this.gf_unhideGiveaway.bind(this,e,t),null],className:"esgst-gf-hide-button",icons:["fa-eye-slash esgst-clickable","fa-circle-o-notch fa-spin","fa-eye esgst-clickable","fa-circle-o-notch fa-spin"],id:"gf_s",index:0,titles:["Hide giveaway","Hiding giveaway...","Unhide giveaway","Unhiding giveaway..."]}).button.setAttribute("data-draggable-id","gf")))})}async gf_hideGiveaway(e,t){const s=new Te("giveaway",{threshold:300});await s.lock();let n=JSON.parse(Ea("giveaways","{}"));return n[e.code]||(n[e.code]={}),n[e.code].code=e.code,n[e.code].endTime=e.endTime,n[e.code].hidden=Date.now(),await Ta("giveaways",JSON.stringify(n)),await s.unlock(),t&&this.esgst.giveawayPath||e.outerWrap.remove(),!0}async gf_unhideGiveaway(e,t){const s=new Te("giveaway",{threshold:300});await s.lock();let n=JSON.parse(Ea("giveaways","{}"));return n[e.code]&&delete n[e.code].hidden,await Ta("giveaways",JSON.stringify(n)),await s.unlock(),t&&this.esgst.giveawayPath||e.outerWrap.remove(),!0}getFilters(e){return{level:{check:!this.esgst.parameters.level_min&&!this.esgst.parameters.level_max&&((!this.esgst.createdPath||d.get("cewgd"))&&(!this.esgst.enteredPath||d.get("cewgd"))&&(!this.esgst.wonPath||d.get("cewgd"))||e),maxValue:10,minValue:0,name:"Level",type:"integer"},entries:{check:!this.esgst.parameters.entry_min&&!this.esgst.parameters.entry_max&&(!this.esgst.wonPath||e),minValue:0,name:"Entries",type:"integer"},copies:{check:!this.esgst.parameters.copy_min&&!this.esgst.parameters.copy_max&&(!this.esgst.wonPath||e),minValue:1,name:"Copies",type:"integer"},points:{check:!this.esgst.parameters.point_min&&!this.esgst.parameters.point_max&&((!this.esgst.createdPath||d.get("cewgd"))&&(!this.esgst.enteredPath||d.get("cewgd"))&&(!this.esgst.wonPath||d.get("cewgd"))||e),maxValue:100,minValue:0,name:"Points",type:"integer"},comments:{check:e||!this.esgst.createdPath&&!this.esgst.enteredPath&&!this.esgst.wonPath,minValue:0,name:"Comments",type:"integer"},minutesToEnd:{check:!this.esgst.wonPath||e,minValue:0,name:"Minutes To End",type:"integer"},minutesFromStart:{check:!this.esgst.wonPath||e,minValue:0,name:"Minutes From Start",type:"integer"},chance:{check:d.get("gwc")&&((!this.esgst.enteredPath||d.get("cewgd"))&&!this.esgst.createdPath&&!this.esgst.wonPath||e),maxValue:100,minValue:0,name:"Chance",type:"double"},projectedChance:{check:d.get("gwc")&&d.get("gwc_a")&&((!this.esgst.enteredPath||d.get("cewgd"))&&!this.esgst.createdPath&&!this.esgst.wonPath||e),maxValue:100,minValue:0,name:"Projected Chance",type:"double"},chancePerPoint:{check:d.get("gwc")&&((!this.esgst.enteredPath||d.get("cewgd"))&&!this.esgst.createdPath&&!this.esgst.wonPath||e),maxValue:100,minValue:0,name:"Chance Per Point",type:"double"},projectedChancePerPoint:{check:d.get("gwc")&&d.get("gwc_a")&&((!this.esgst.enteredPath||d.get("cewgd"))&&!this.esgst.createdPath&&!this.esgst.wonPath||e),maxValue:100,minValue:0,name:"Projected Chance Per Point",type:"double"},ratio:{check:d.get("gwr")&&((!this.esgst.enteredPath||d.get("cewgd"))&&!this.esgst.createdPath&&!this.esgst.wonPath||e),minValue:0,name:"Ratio",type:"integer"},projectedRatio:{check:d.get("gwr")&&d.get("gwr_a")&&((!this.esgst.enteredPath||d.get("cewgd"))&&!this.esgst.createdPath&&!this.esgst.wonPath||e),minValue:0,name:"Projected Ratio",type:"integer"},pointsToWin:{check:d.get("gptw")&&((!this.esgst.enteredPath||d.get("cewgd"))&&!this.esgst.createdPath&&!this.esgst.wonPath||e),minValue:0,name:"Points To Win",type:"integer"},pinned:{check:this.esgst.giveawaysPath,name:"Pinned",type:"boolean"},public:{check:!this.esgst.giveawaysPath,name:"Public",type:"boolean"},inviteOnly:{check:(!this.esgst.createdPath||d.get("cewgd"))&&(!this.esgst.enteredPath||d.get("cewgd"))&&(!this.esgst.wonPath||d.get("cewgd"))||e,name:"Invite Only",type:"boolean"},group:{check:(!this.esgst.createdPath||d.get("cewgd"))&&(!this.esgst.enteredPath||d.get("cewgd"))&&(!this.esgst.wonPath||d.get("cewgd"))||e,name:"Group",type:"boolean"},whitelist:{check:(!this.esgst.createdPath||d.get("cewgd"))&&(!this.esgst.enteredPath||d.get("cewgd"))&&(!this.esgst.wonPath||d.get("cewgd"))||e,name:"Whitelist",type:"boolean"},nonMemberGroup:{check:d.get("cl")&&d.get("ggl")&&0===d.get("ggl_index")&&((!this.esgst.createdPath||d.get("cewgd"))&&(!this.esgst.enteredPath||d.get("cewgd"))&&(!this.esgst.wonPath||d.get("cewgd"))||e),name:"Non-Member Group",type:"boolean"},regionRestricted:{check:(!this.esgst.createdPath||d.get("cewgd"))&&(!this.esgst.enteredPath||d.get("cewgd"))&&(!this.esgst.wonPath||d.get("cewgd"))||e,name:"Region Restricted",type:"boolean"},enterable:{check:"Ge"===e,name:"Enterable",type:"boolean"},currentlyEnterable:{check:"Ge"===e,name:"Currently Enterable",type:"boolean"},created:{check:!this.esgst.createdPath&&!this.esgst.enteredPath&&!this.esgst.wonPath||e,name:"Created",type:"boolean"},received:{check:this.esgst.createdPath||this.esgst.wonPath,name:"Received",type:"boolean"},notReceived:{check:this.esgst.createdPath||this.esgst.wonPath,name:"Not Received",type:"boolean"},awaitingFeedback:{check:this.esgst.createdPath||this.esgst.wonPath,name:"Awaiting Feedback",type:"boolean"},entered:{check:!this.esgst.createdPath&&!this.esgst.enteredPath&&!this.esgst.wonPath||e,name:"Entered",type:"boolean"},started:{check:!this.esgst.enteredPath&&!this.esgst.wonPath||e,name:"Started",type:"boolean"},ended:{check:!this.esgst.wonPath||e,name:"Ended",type:"boolean"},deleted:{check:this.esgst.createdPath||this.esgst.enteredPath,name:"Deleted",type:"boolean"},sgTools:{check:d.get("ge"),name:"SGTools",type:"boolean"},bookmarked:{check:d.get("gb"),name:"Bookmarked",type:"boolean"},groups:{check:d.get("cl")&&d.get("ggl")&&0===d.get("ggl_index"),list:!0,name:"Groups",type:"string"},creators:{check:!0,list:!0,name:"Creators",type:"string"},winners:{check:!0,list:!0,name:"Winners",type:"string"},...c.esgst.modules.gamesGameFilters.getFilters()}}};const Pa=new class extends ga{constructor(){super("gmf"),this.info={description:()=>Se.element("fragment",null,"Filter games."),features:{gmf_m:{description:()=>Se.element("ul",null,Se.element("li",null,"Allows you to hide multiple games in a page using many different filters."),Se.element("li",null,"Adds a toggle switch with a button (",Se.element("i",{className:"fa fa-sliders"}),") to the main page heading of any page that has games and does not have giveaways. If a page has giveaways, you can filter games through the giveaway filters (the filter settings of this feature are shared with Giveaway Filters). The switch allows you to turn the filters on/off and the button allows you to manage your presets."),Se.element("li",null,"To prevent confusion, in discussion pages the filter bar for this feature will be at the top, while the filter bar for Comment Filters (if enabled) will be at the main page heading."),Se.element("li",null,"Adds a collapsible panel below the same main page heading that allows you to change/save the rules of a preset. The filters are separated in 3 categories:"),Se.element("ul",null,Se.element("li",null,"Basic filters are related to a numeric value and have a slider that you can use to set the range of the filter (any games that do not apply to the range will be hidden)."),Se.element("li",null,"Type filters are related to a boolean value and have a checkbox that changes states when you click on it. The checkbox has 3 states:"),Se.element("ul",null,Se.element("li",null,'"Show all" (',Se.element("i",{className:"fa fa-check-square"}),") does not hide any games that apply to the filter (this is the default state)."),Se.element("li",null,'"Show only" (',Se.element("i",{className:"fa fa-square"}),") hides any games that do not apply to the filter."),Se.element("li",null,'"Hide all" (',Se.element("i",{className:"fa fa-square-o"}),") hides any games that apply to the filter.")),Se.element("li",null,"Category filters are essentially the same thing as type filters, but for game categories (",Se.element("span",{"data-esgst-feature-id":"gc"}),").")),Se.element("li",null,"A preset contains all of your rules and can be saved to be reused later. You can save as many presets as you want. Each preset contains 3 types of rules:"),Se.element("ul",null,Se.element("li",null,"Basic rules are the ones that you can change directly in the filter panel, using the sliders/checkboxes as explained in the previous item."),Se.element("li",null,"Exception rules are the ones that you can change by clicking on the icon"," ",Se.element("i",{className:"fa fa-gear"})," in the filter panel. They are exceptions to the basic rules."),Se.element("li",null,"Override rules are the ones that you can change by clicking on the icon (",Se.element("i",{className:"fa fa-exclamation esgst-faded"})," if set to overridable and"," ",Se.element("i",{className:"fa fa-exclamation"})," if set to non-overridable) next to each filter. They are enforcements of the basic rules."))),features:{gmf_m_f:{name:"Fix filter bar at the top of the page.",sg:!0},gmf_m_b:{name:"Hide basic filters.",sg:!0},gmf_m_a:{name:"Hide advanced filters.",sg:!0},gmf_rating:{alias:"gf_rating"},gmf_reviews:{alias:"gf_reviews"},gmf_releaseDate:{alias:"gf_releaseDate"},gmf_owned:{alias:"gf_owned"},gmf_wishlisted:{alias:"gf_wishlisted"},gmf_previouslyWishlisted:{alias:"gf_previouslyWishlisted"},gmf_followed:{alias:"gf_followed"},gmf_hidden:{alias:"gf_hidden"},gmf_ignored:{alias:"gf_ignored"},gmf_previouslyEntered:{alias:"gf_previouslyEntered"},gmf_previouslyWon:{alias:"gf_previouslyWon"},gmf_fullCV:{alias:"gf_fullCV"},gmf_reducedCV:{alias:"gf_reducedCV"},gmf_noCV:{alias:"gf_noCV"},gmf_learning:{alias:"gf_learning"},gmf_removed:{alias:"gf_removed"},gmf_banned:{alias:"gf_banned"},gmf_tradingCards:{alias:"gf_tradingCards"},gmf_achievements:{alias:"gf_achievements"},gmf_singleplayer:{alias:"gf_singleplayer"},gmf_multiplayer:{alias:"gf_multiplayer"},gmf_steamCloud:{alias:"gf_steamCloud"},gmf_linux:{alias:"gf_linux"},gmf_mac:{alias:"gf_mac"},gmf_dlc:{alias:"gf_dlc"},gmf_dlcOwned:{alias:"gf_dlcOwned"},gmf_dlcFree:{alias:"gf_dlcFree"},gmf_dlcNonFree:{alias:"gf_dlcNonFree"},gmf_package:{alias:"gf_package"},gmf_earlyAccess:{alias:"gf_earlyAccess"},gmf_genres:{alias:"gf_genres"},gmf_tags:{alias:"gf_tags"}},name:"Multiple Filters",sg:!0}},id:"gmf",name:"Game Filters",sg:!0,sync:"Owned/Wishlisted/Ignored Games, Giveaways, Hidden Games, No CV Games, Reduced CV Games, Won Games",syncKeys:["Games","Giveaways","HiddenGames","NoCvGames","ReducedCvGames","WonGames"],type:"games"}}init(){d.get("gmf")&&c.common.isCurrentPath(["Community Wishlist","Bundle Games","Discussion","Settings - Giveaways - Filters","Steam - Games"])&&(c.esgst.hasAddedFilterContainer||c.esgst.style.insertAdjacentText("beforeend",`\n\t\t\t\t.esgst-gf-container {\n\t\t\t\t\tposition: ${d.get("gmf_m_f")?"sticky":"static"};\n\t\t\t\t\ttop: ${c.esgst.commentsTop}px;\n\t\t\t\t}\n\t\t\t`),c.common.createHeadingButton({element:this.filters_addContainer(c.esgst.discussionPath?document.querySelector(".page__heading"):c.esgst.mainPageHeading),id:"gmf"}))}getFilters(){return{rating:{category:"gc_r",check:!0,maxValue:100,minValue:0,name:"Rating",type:"integer"},reviews:{category:"gc_r",check:!0,minValue:0,name:"Reviews",type:"integer"},releaseDate:{category:"gc_rd",check:!c.esgst.parameters.release_date_min&&!c.esgst.parameters.release_date_max,date:!0,name:"Release Date",type:"integer"},owned:{check:!0,name:"Owned",sync:["Games"],type:"boolean"},wishlisted:{check:!0,name:"Wishlisted",sync:["Games"],type:"boolean"},previouslyWishlisted:{check:!0,name:"Previously Wishlisted",sync:["Games"],type:"boolean"},followed:{check:!0,name:"Followed",sync:["FollowedGames"],type:"boolean"},hidden:{check:!0,name:"Hidden",sync:["HiddenGames"],type:"boolean"},ignored:{check:!0,name:"Ignored",sync:["Games"],type:"boolean"},previouslyEntered:{check:!0,name:"Previously Entered",type:"boolean"},previouslyWon:{check:!0,name:"Previously Won",sync:["WonGames"],type:"boolean"},fullCV:{check:!0,name:"Full CV",sync:["ReducedCvGames","NoCvGames"],type:"boolean"},reducedCV:{check:!0,name:"Reduced CV",sync:["ReducedCvGames"],type:"boolean"},noCV:{check:!0,name:"No CV",sync:["NoCvGames"],type:"boolean"},learning:{category:"gc_lg",check:!0,name:"Learning",type:"boolean"},removed:{check:!0,name:"Removed",sync:["DelistedGames"],type:"boolean"},banned:{check:!0,name:"Banned",sync:["DelistedGames"],type:"boolean"},tradingCards:{category:"gc_tc",check:!0,name:"Trading Cards",type:"boolean"},achievements:{category:"gc_a",check:!0,name:"Achievements",type:"boolean"},singleplayer:{category:"gc_sp",check:!0,name:"Singleplayer",type:"boolean"},multiplayer:{category:"gc_mp",check:!0,name:"Multiplayer",type:"boolean"},steamCloud:{category:"gc_sc",check:!0,name:"Steam Cloud",type:"boolean"},linux:{category:"gc_l",check:!0,name:"Linux",type:"boolean"},mac:{category:"gc_m",check:!0,name:"Mac",type:"boolean"},dlc:{category:"gc_dlc",check:!0,name:"DLC",type:"boolean"},dlcOwned:{category:"gc_dlc_o",check:!0,name:"DLC (Owned Base)",type:"boolean"},dlcFree:{category:"gc_dlc_b",check:!0,name:"DLC (Free Base)",type:"boolean"},dlcNonFree:{category:"gc_dlc_b",check:!0,name:"DLC (Non-Free Base)",type:"boolean"},package:{category:"gc_p",check:!0,name:"Package",type:"boolean"},earlyAccess:{category:"gc_ea",check:!0,name:"Early Access",type:"boolean"},genres:{category:"gc_g",check:!0,list:!0,name:"Genres",type:"string"},tags:{check:!0,list:!0,name:"Game Tags",type:"string"}}}};s(169),s(170);const La=hs.createElements.bind(hs),Ia=hs.createHeadingButton.bind(hs),Ba=hs.createTooltip.bind(hs);const Da=new class extends gt{constructor(){super(),this.info={description:()=>Se.element("ul",null,Se.element("li",null,"Adds a button (",Se.element("i",{className:"fa fa-folder"})," ",Se.element("i",{className:"fa fa-star"})," ) to your"," ",Se.element("a",{href:"https://www.steamgifts.com/account/manage/whitelist"},"whitelist"),"/",Se.element("a",{href:"https://www.steamgifts.com/account/manage/blacklist"},"blacklist")," pages and any ",Se.element("a",{href:"https://www.steamgifts.com/group/SJ7Bu/"},"group")," page that allows you to check how many of the whitelist/blacklist/group members have a certain game in their libraries/wishlists."),Se.element("li",null,'The results are separated in 2 sections ("Libraries" and "Wishlists"). The games in each section are ranked based on the number of members that have them in their libraries/wishlists (each game also has a percentage that represents that number).'),Se.element("li",null,'Only the first 100 results are shown for each section, but you can use the search fields to find games that are outside of the top 100. If you are searching in the "Libraries" section, it is more accurate to search for games using their app id instead of their name, because the games in that section only have a name if they can also be found in the "Wishlists" section, as game names are not available in the libraries data and retrieving them would generate more requests to Steam, which is not good.'),Se.element("li",null,"If you hover over the number of libraries/wishlists for a game it shows the usernames of all of the members that have the game in their libraries/wishlists."),Se.element("li",null,"A Steam API key is required to retrieve libraries data. If a key is not set in the last section of this menu, the feature will only retrieve wishlists data.")),id:"glwc",name:"Group Library/Wishlist Checker",sg:!0,type:"groups",features:{glwc_gn:{description:()=>Se.element("ul",null,Se.element("li",null,"The new Steam wishlist page does not offer the game names in its source code, so ESGST cannot know the names of the games. However, by enabling this option, ESGST will fetch the list of all games on Steam, so that it can show you the names of the games properly. The only problem is that this list is huge, so it can slow down the feature execution a bit. This list is shared with Have / Want List Checker, if you also use that feature.")),name:"Display game names.",sg:!0},glwc_mm:{dependencies:["mm"],description:()=>Se.element("ul",null,Se.element("li",null,"Allows checking a custom list of users provided by"," ",Se.element("span",{"data-esgst-feature-id":"mm"}),".")),name:"Integrate with [id=mm].",sg:!0}}}}async init(){if(c.esgst.whitelistPath||c.esgst.blacklistPath||c.esgst.groupPath){let e;e=c.esgst.whitelistPath?"url=account/manage/whitelist":c.esgst.blacklistPath?"url=account/manage/blacklist":`url=${window.location.pathname.match(/\/(group\/(.+?)\/(.+?))(\/.*)?$/)[1]}/users&id=${document.querySelector('[href*="/gid/"]').getAttribute("href").match(/\d+/)[0]}`,Ia({id:"glwc",icons:["fa-folder","fa-star"],title:"Check libraries/wishlists",link:"https://www.steamgifts.com/account/settings/profile?esgst=glwc&"+e})}else if(c.common.isCurrentPath("Account")&&"glwc"===c.esgst.parameters.esgst){if(!await ut.contains([["steamApi","steamCommunity","steamStore"]]))return;let e,t={progressBar:at.create().build().setLoading(),overallProgressBar:at.create()};t.container=c.esgst.sidebar.nextElementSibling,d.get("removeSidebarInFeaturePages")&&c.esgst.sidebar.remove(),t.container.innerHTML="",t.container.setAttribute("data-esgst-popup",!0);const s=pt.create("glwc",[{name:"ESGST",url:c.esgst.settingsUrl},{name:"Group Library/Wishlist Checker",url:"https://www.steamgifts.com/account/settings/profile?esgst=glwc"}]).insert(t.container,"beforeend"),n=tt.create({color:"alternate-white",tooltip:"Options",icons:["fa-gear"]}).insert(s.nodes.outer,"beforeend"),a=new mt("",n.nodes.outer,0,!0);if(new vt(a.popout,"glwc_checkMaxWishlists",!1,Se.element("fragment",null,"Only check users with a maximum of"," ",Se.element("input",{className:"esgst-switch-input",type:"number",min:"0",value:d.get("glwc_maxWishlists"),onchange:e=>{d.set("glwc_maxWishlists",parseInt(e.target.value)),c.common.setSetting("glwc_maxWishlists",d.get("glwc_maxWishlists"))}})," ","games in their wishlist."),!1,!1,"Enter the maximum number of games that a user must have in their wishlist in order to be checked.",d.get("glwc_checkMaxWishlists")),t.progressBar.insert(t.container,"beforeend"),t.overallProgressBar.insert(t.container,"beforeend"),t.context=La(t.container,"beforeend",[{type:"div"}]),e=l.getQueryParams(),t.id=e.id,t.url=e.url,t.users=e.users?e.users.split(",").map(e=>({username:e})):[],t.games={},t.id){t.overallProgressBar.setMessage("Preparing..."),t.members=[];(await Ne.get(`http://steamcommunity.com/gid/${t.id}/memberslistxml?xml=1`)).text.match(/<steamID64>.+?<\/steamID64>/g).forEach(e=>{t.members.push(e.match(/<steamID64>(.+?)<\/steamID64>/)[1])})}t.users.length>0?(t.overallProgressBar.setMessage("Step 2 of 3"),this.glwc_getSteamIds(t,0,t.users.length)):(t.overallProgressBar.setMessage("Step 1 of 3"),this.glwc_getUsers(t,1))}}async glwc_getUsers(e,t){if(e.isCanceled)return;let s,n,a,i,o;for(e.progressBar.setMessage(`Retrieving users (page ${t})...`),o=(await Ne.get(`/${e.url}/search?page=${t}`)).html,s=o.querySelectorAll(".table__row-inner-wrap:not(.is-faded)"),n=0,a=s.length;n<a;++n)e.users.push({username:s[n].getElementsByClassName("table__column__heading")[0].textContent});i=o.getElementsByClassName("pagination__navigation")[0],i&&!i.lastElementChild.classList.contains("is-selected")?window.setTimeout(()=>this.glwc_getUsers(e,++t),0):(e.overallProgressBar.setMessage("Step 2 of 3"),this.glwc_getSteamIds(e,0,e.users.length))}async glwc_getSteamIds(e,t,s){if(!e.isCanceled)if(t<s){e.progressBar.setMessage(`Retrieving Steam ids (${t+1} of ${s})...`);let a=c.esgst.users.steamIds[e.users[t].username];if(a)e.users[t].steamId=a,window.setTimeout(()=>this.glwc_getSteamIds(e,++t,s),0);else{var n;const a=await Ne.get(`/user/${e.users[t].username}?format=json`);null!==(n=a.json)&&void 0!==n&&n.success&&(e.users[t].steamId=a.json.user.steam_id),window.setTimeout(()=>this.glwc_getSteamIds(e,++t,s),0)}}else e.overallProgressBar.setMessage("Step 3 of 3 (this might take a while)"),e.memberCount=0,d.get("glwc_gn")&&await c.esgst.modules.tradesHaveWantListChecker.hwlc_getGames(!0),this.glwc_getGames(e,0,e.users.length)}async glwc_getGames(e,t,s){if(!e.isCanceled)if(t<s)try{if(e.progressBar.setMessage(`Retrieving libraries/wishlists (${t+1} of ${s})...`),!e.id||e.members.indexOf(e.users[t].steamId)>=0){try{e.users[t].failed=[],e.users[t].library=[];const s=(await Ne.get(`http://api.steampowered.com/IPlayerService/GetOwnedGames/v0001/?key=${d.get("steamApiKey")}&steamid=${e.users[t].steamId}&format=json`)).json.response.games;s&&s.forEach(s=>{let n={id:s.appid,logo:`https://steamcdn-a.akamaihd.net/steam/apps/${s.appid}/header.jpg`,name:""+s.appid};if(c.esgst.appList){const e=c.esgst.appList[s.appid];e&&(n.name=e)}e.games[n.id]||(n.libraries=[],n.wishlists=[],e.games[n.id]=n),e.games[n.id].libraries.push(t),e.users[t].library.push(n.id)})}catch(e){}e.users[t].wishlist=[];const n=(await Ne.get(`https://api.steampowered.com/IWishlistService/GetWishlist/v1/?steamid=${e.users[t].steamId}&format=json`)).json.response.items;if(n){const s=d.get("glwc_checkMaxWishlists")?parseInt(d.get("glwc_maxWishlists")):1/0;n.length<=s&&n.forEach(s=>{let n=s.appid,a={id:n};if(a.logo=`https://steamcdn-a.akamaihd.net/steam/apps/${n}/header.jpg`,c.esgst.appList){const e=c.esgst.appList[s.appid];e&&(a.name=e)}a.name||(a.name=""+n),e.games[n]?a.logo&&a.name&&(e.games[n].logo=a.logo,e.games[n].name=a.name):(a.libraries=[],a.wishlists=[],e.games[n]=a),e.games[n].wishlists.push(t),e.users[t].wishlist.push(parseInt(n))})}else e.users[t].failed.push(`<a class="table__column__secondary-link" href="https://steamcommunity.com/profiles/${e.users[t].steamId}">${e.users[t].username}</a>`);e.memberCount+=1,window.setTimeout(()=>this.glwc_getGames(e,++t,s),0)}else window.setTimeout(()=>this.glwc_getGames(e,++t,s),0)}catch(n){e.users[t].failed.push(`<a class="table__column__secondary-link" href="https://steamcommunity.com/profiles/${e.users[t].steamId}">${e.users[t].username}</a>`),window.setTimeout(()=>this.glwc_getGames(e,++t,s),0)}else this.glwc_showResults(e)}glwc_showResults(e){const t=[...new Set(e.users.flatMap(e=>e.failed.length>0?e.failed:[]))];if(t.length>0){e.progressBar.setWarning(t.length+" users were not retrieved. Possibly games, wishlists or profile are private. (Hover to view details)");const s=Ba(e.container.querySelector(".notification--warning"),t.join(", "),!0);s.onFirstOpen=()=>c.common.endless_load(s.popout)}else e.progressBar.destroy();let s,n,a,i,o,r,l,d,g,u,m,h,p,f,b;for(a in e.overallProgressBar.destroy(),e.context.classList.add("esgst-glwc-results"),La(e.context,"atinner",[{type:"div",children:[{attributes:{class:"esgst-glwc-heading"},text:"Libraries",type:"div"},{attribute:{placeholder:"Search by game name or app id...",type:"text"},type:"input"},{attributes:{class:"table"},type:"div",children:[{attributes:{class:"table__heading"},type:"div",children:[{attributes:{class:"table__column--width-small text-center"},text:"Rank",type:"div"},{attributes:{class:"table__column--width-fill"},text:"Game",type:"div"},{attributes:{class:"table__column--width-small text-center"},text:"Libraries",type:"div"}]},{attributes:{class:"table__rows"},type:"div"},{attributes:{class:"table__rows"},type:"div"}]}]},{type:"div",children:[{attributes:{class:"esgst-glwc-heading"},text:"Wishlists",type:"div"},{attribute:{placeholder:"Search by game name or app id...",type:"text"},type:"input"},{attributes:{class:"table"},type:"div",children:[{attributes:{class:"table__heading"},type:"div",children:[{attributes:{class:"table__column--width-small text-center"},text:"Rank",type:"div"},{attributes:{class:"table__column--width-fill"},text:"Game",type:"div"},{attributes:{class:"table__column--width-small text-center"},text:"Wishlists",type:"div"}]},{attributes:{class:"table__rows"},type:"div"},{attributes:{class:"table__rows"},type:"div"}]}]}]),r=e.context.firstElementChild.firstElementChild.nextElementSibling,l=r.nextElementSibling.lastElementChild,d=l.previousElementSibling,p=e.context.lastElementChild.firstElementChild.nextElementSibling,f=p.nextElementSibling.lastElementChild,b=f.previousElementSibling,o=[],h=[],e.games)e.games.hasOwnProperty(a)&&(e.games[a].libraries.length&&o.push(e.games[a]),e.games[a].wishlists.length&&h.push(e.games[a]));if(o.length>0)for(o=o.sort((e,t)=>e.libraries.length>t.libraries.length?-1:e.libraries.length<t.libraries.length?1:0),n=0,g=o.length;n<100&&n<g;++n){s=o[n],(n<=0||s.libraries.length!==o[n-1].libraries.length)&&(i=n+1),m=[],s.libraries.forEach(t=>{u=e.users[t],m.push(`<a class="table__column__secondary-link" href="http://steamcommunity.com/profiles/${u.steamId}/games?tab=all">${u.username}</a>`)});const t=Ba(La(l,"beforeend",[{attributes:{class:"table__row-outer-wrap"},type:"div",children:[{attributes:{class:"table__row-inner-wrap"},type:"div",children:[{attributes:{class:"table__column--width-small text-center"},type:"div",children:[{attributes:{class:"table__column__rank"},text:i+".",type:"span"}]},{type:"div",children:[{attributes:{class:"table_image_thumbnail",style:`background-image:url(${s.logo});`},type:"div"}]},{attributes:{class:"table__column--width-fill"},type:"div",children:[{attributes:{class:"table__column__heading"},text:s.name,type:"p"},{type:"p",children:[{attributes:{class:"table__column__secondary-link",href:"http://store.steampowered.com/app/"+s.id,rel:"nofollow",target:"_blank"},text:"http://store.steampowered.com/app/"+s.id,type:"a"}]}]},{attributes:{class:"table__column--width--small text-center"},type:"div",children:[{attributes:{class:"table__column__secondary-link esgst-clickable"},text:`${s.libraries.length} (${Math.round(s.libraries.length/e.memberCount*1e4)/100}%)`,type:"span"}]}]}]}]).firstElementChild.lastElementChild.firstElementChild,m.join(", "),!0);t.onFirstOpen=()=>c.common.endless_load(t.popout)}else La(l,"atinner",[{text:"To get libraries data you must have a Steam API key set in the settings menu.",type:"node"}]);for(h=h.sort((e,t)=>e.wishlists.length>t.wishlists.length?-1:e.wishlists.length<t.wishlists.length?1:0),n=0,g=h.length;n<100&&n<g;++n){s=h[n],(n<=0||s.wishlists.length!==h[n-1].wishlists.length)&&(i=n+1),m=[],s.wishlists.forEach(t=>{u=e.users[t],m.push(`<a class="table__column__secondary-link" href="http://store.steampowered.com/wishlist/profiles/${u.steamId}">${u.username}</a>`)});const t=Ba(La(f,"beforeend",[{attributes:{class:"table__row-outer-wrap"},type:"div",children:[{attributes:{class:"table__row-inner-wrap"},type:"div",children:[{attributes:{class:"table__column--width-small text-center"},type:"div",children:[{attributes:{class:"table__column__rank"},text:i+".",type:"span"}]},{type:"div",children:[{attributes:{class:"table_image_thumbnail",style:`background-image:url(${s.logo});`},type:"div"}]},{attributes:{class:"table__column--width-fill"},type:"div",children:[{attributes:{class:"table__column__heading"},text:s.name,type:"p"},{type:"p",children:[{attributes:{class:"table__column__secondary-link",href:"http://store.steampowered.com/app/"+s.id,rel:"nofollow",target:"_blank"},text:"http://store.steampowered.com/app/"+s.id,type:"a"}]}]},{attributes:{class:"table__column--width--small text-center"},type:"div",children:[{attributes:{class:"table__column__secondary-link esgst-clickable"},text:`${s.wishlists.length} (${Math.round(s.wishlists.length/e.memberCount*1e4)/100}%)`,type:"span"}]}]}]}]).firstElementChild.lastElementChild.firstElementChild,m.join(", "),!0);t.onFirstOpen=()=>c.common.endless_load(t.popout)}r.addEventListener("input",()=>{const t=r.value.toLowerCase();if(t){if(s=e.games[t],s)if(s.libraries.length){m=[],s.libraries.forEach(t=>{u=e.users[t],m.push(`<a class="table__column__secondary-link" href="http://steamcommunity.com/profiles/${u.steamId}/games?tab=all">${u.username}</a>`)}),La(d,"atinner",[{attributes:{class:"table__row-outer-wrap"},type:"div",children:[{attributes:{class:"table__row-inner-wrap"},type:"div",children:[{attributes:{class:"table__column--width-small text-center"},type:"div",children:[{attributes:{class:"table__column__rank"},text:"-",type:"span"}]},{type:"div",children:[{attributes:{class:"table_image_thumbnail",style:`background-image:url(${s.logo});`},type:"div"}]},{attributes:{class:"table__column--width-fill"},type:"div",children:[{attributes:{class:"table__column__heading"},text:s.name,type:"p"},{type:"p",children:[{attributes:{class:"table__column__secondary-link",href:"http://store.steampowered.com/app/"+s.id,rel:"nofollow",target:"_blank"},text:"http://store.steampowered.com/app/"+s.id,type:"a"}]}]},{attributes:{class:"table__column--width-small text-center"},type:"div",children:[{attributes:{class:"table__column__secondary-link esgst-clickable"},text:`${s.libraries.length} (${Math.round(s.libraries.length/e.memberCount*1e4)/100}%)`,type:"span"}]}]}]}]);const t=Ba(d.firstElementChild.firstElementChild.lastElementChild.firstElementChild,m.join(", "),!0);t.onFirstOpen=()=>c.common.endless_load(t.popout)}else La(d,"atinner",[{text:"Nothing found...",type:"node"}]);else{for(d.innerHTML="",n=0,i=0,g=o.length;i<100&&n<g;++n)if(s=o[n],s.name.toLowerCase().match(t)){m=[],s.libraries.forEach(t=>{u=e.users[t],m.push(`<a class="table__column__secondary-link" href="http://steamcommunity.com/profiles/${u.steamId}/games?tab=all">${u.username}</a>`)});const t=Ba(La(d,"beforeend",[{attributes:{class:"table__row-outer-wrap"},type:"div",children:[{attributes:{class:"table__row-inner-wrap"},type:"div",children:[{attributes:{class:"table__column--width-small text-center"},type:"div",children:[{attributes:{class:"table__column__rank"},text:"-",type:"span"}]},{type:"div",children:[{attributes:{class:"table_image_thumbnail",style:`background-image:url(${s.logo});`},type:"div"}]},{attributes:{class:"table__column--width-fill"},type:"div",children:[{attributes:{class:"table__column__heading"},text:s.name,type:"p"},{type:"p",children:[{attributes:{class:"table__column__secondary-link",href:"http://store.steampowered.com/app/"+s.id,rel:"nofollow",target:"_blank"},text:"http://store.steampowered.com/app/"+s.id,type:"a"}]}]},{attributes:{class:"table__column--width--small text-center"},type:"div",children:[{attributes:{class:"table__column__secondary-link esgst-clickable"},text:`${s.libraries.length} (${Math.round(s.libraries.length/e.memberCount*1e4)/100}%)`,type:"span"}]}]}]}]).firstElementChild.lastElementChild.firstElementChild,m.join(", "),!0);t.onFirstOpen=()=>c.common.endless_load(t.popout),i+=1}d.innerHTML||La(d,"atinner",[{text:"Nothing found...",type:"node"}])}d.classList.remove("esgst-hidden"),l.classList.add("esgst-hidden")}else l.classList.remove("esgst-hidden"),d.classList.add("esgst-hidden")}),p.addEventListener("input",()=>{const t=p.value;if(t){if(s=e.games[t],s)if(s.wishlists.length){m=[],s.wishlists.forEach(t=>{u=e.users[t],m.push(`<a class="table__column__secondary-link" href="http://store.steampowered.com/wishlist/profiles/${u.steamId}">${u.username}</a>`)}),La(b,"atinner",[{attributes:{class:"table__row-outer-wrap"},type:"div",children:[{attributes:{class:"table__row-inner-wrap"},type:"div",children:[{attributes:{class:"table__column--width-small text-center"},type:"div",children:[{attributes:{class:"table__column__rank"},text:"-",type:"span"}]},{type:"div",children:[{attributes:{class:"table_image_thumbnail",style:`background-image:url(${s.logo});`},type:"div"}]},{attributes:{class:"table__column--width-fill"},type:"div",children:[{attributes:{class:"table__column__heading"},text:s.name,type:"p"},{type:"p",children:[{attributes:{class:"table__column__secondary-link",href:"http://store.steampowered.com/app/"+s.id,rel:"nofollow",target:"_blank"},text:"http://store.steampowered.com/app/"+s.id,type:"a"}]}]},{attributes:{class:"table__column--width-small text-center"},type:"div",children:[{attributes:{class:"table__column__secondary-link esgst-clickable"},text:`${s.wishlists.length} (${Math.round(s.wishlists.length/e.memberCount*1e4)/100}%)`,type:"span"}]}]}]}]);const t=Ba(b.firstElementChild.firstElementChild.lastElementChild.firstElementChild,m.join(", "),!0);t.onFirstOpen=()=>c.common.endless_load(t.popout)}else La(b,"atinner",[{text:"Nothing found...",type:"node"}]);else{for(b.innerHTML="",n=0,i=0,g=h.length;i<100&&n<g;++n)if(s=h[n],s.name.toLowerCase().match(t)){m=[],s.wishlists.forEach(t=>{u=e.users[t],m.push(`<a class="table__column__secondary-link" href="http://steamcommunity.com/profiles/${u.steamId}/wishlists">${u.username}</a>`)});const t=Ba(La(b,"beforeend",[{attributes:{class:"table__row-outer-wrap"},type:"div",children:[{attributes:{class:"table__row-inner-wrap"},type:"div",children:[{attributes:{class:"table__column--width-small text-center"},type:"div",children:[{attributes:{class:"table__column__rank"},text:"-",type:"span"}]},{type:"div",children:[{attributes:{class:"table_image_thumbnail",style:`background-image:url(${s.logo});`},type:"div"}]},{attributes:{class:"table__column--width-fill"},type:"div",children:[{attributes:{class:"table__column__heading"},text:s.name,type:"p"},{type:"p",children:[{attributes:{class:"table__column__secondary-link",href:"http://store.steampowered.com/app/"+s.id,rel:"nofollow",target:"_blank"},text:"http://store.steampowered.com/app/"+s.id,type:"a"}]}]},{attributes:{class:"table__column--width--small text-center"},type:"div",children:[{attributes:{class:"table__column__secondary-link esgst-clickable"},text:`${s.wishlists.length} (${Math.round(s.wishlists.length/e.memberCount*1e4)/100}%)`,type:"span"}]}]}]}]).firstElementChild.lastElementChild.firstElementChild,m.join(", "),!0);t.onFirstOpen=()=>c.common.endless_load(t.popout),i+=1}b.innerHTML||La(b,"atinner",[{text:"Nothing found...",type:"node"}])}b.classList.remove("esgst-hidden"),f.classList.add("esgst-hidden")}else f.classList.remove("esgst-hidden"),b.classList.add("esgst-hidden")})}},Ga=hs.createElements.bind(hs),qa=hs.delValue.bind(hs),Ra=hs.getValue.bind(hs),Ma=hs.setValue.bind(hs);const Oa=new class extends gt{constructor(){super(),this.info={description:()=>Se.element("ul",null,Se.element("li",null,"Adds an icon (",Se.element("i",{className:"fa fa-rotate-left"}),") next to the game name of a giveaway created by yourself that ended with 0 entries (in any page) that opens the"," ",Se.element("a",{href:"https://www.steamgifts.com/giveaways/new"},"new giveaway")," page with all of the details of the giveaway prefilled so that you can quickly recreate the giveaway.")),features:{gr_a:{name:"Show the icon for all created giveaways.",sg:!0},gr_r:{name:"Remove the button for giveaways that have been recreated.",sg:!0}},id:"gr",name:"Giveaway Recreator",sg:!0,type:"giveaways"}}async init(){if(!this.esgst.newGiveawayPath)return;let e=Ra("grTemplate");e&&(await qa("grTemplate"),e=JSON.parse(e),this.esgst.modules.giveawaysGiveawayTemplates.gts_applyTemplate(e))}async gr_recreateGiveaway(e,t,s){if(s.preventDefault(),s.stopPropagation(),Ga(e,"atinner",[{attributes:{class:"fa fa-circle-o-notch fa-spin"},type:"i"}]),this.esgst.createdPath){let s=await Ne.get(t.url);this.gr_saveTemplate(e,(await this.esgst.modules.giveaways.giveaways_get(s.html,!0,s.url,!1,"giveaway"))[0]||t)}else this.gr_saveTemplate(e,t)}async gr_saveTemplate(e,t){let s,n,a,i,o,r,l={delay:0,description:"",duration:t.endTime-t.startTime,gameName:t.name,groups:"",level:t.level,region:"0"};for(t.group||t.whitelist?(l.whoCanEnter="groups",t.whitelist&&(l.whitelist="1")):t.inviteOnly?l.whoCanEnter="invite_only":l.whoCanEnter="everyone",n=Se.parse((await Ne.post("/ajax.php",{data:"do=autocomplete_giveaway_game&page_number=1&search_query="+encodeURIComponent(t.name)})).json.html).getElementsByClassName("table__row-outer-wrap"),i=0,r=n.length;i<r&&n[i].getAttribute("data-autocomplete-name")!==t.name;++i);if(i<r&&(l.gameId=n[i].getAttribute("data-autocomplete-id")),o=[],(0===t.entries||t.entries<t.copies)&&(s=Se.parse((await Ne.post("/ajax.php",{data:`xsrf_token=${Be.xsrfToken}&do=popup_keys&code=${t.code}`})).json.html).getElementsByClassName("popup__keys__heading"),s))for(s=s[s.length-1],n=s.nextElementSibling.nextElementSibling.children,i=0,r=n.length;i<r;++i)o.push(n[i].textContent);o.length>0?(l.gameType="key",l.keys=o.join("\n")):(l.gameType="gift",l.copies=t.copies),await Ma("grTemplate",JSON.stringify(l)),a=JSON.parse(Ra("giveaways")),a[t.code]||(a[t.code]={}),a[t.code].recreated=!0,await Ma("giveaways",JSON.stringify(a)),e.remove(),yt.open("https://www.steamgifts.com/giveaways/new")}};const Ua=new class extends gt{constructor(){super(),this.info={description:()=>Se.element("ul",null,Se.element("li",null,"Adds some columns to your"," ",Se.element("a",{href:"https://www.steamgifts.com/account/steam/groups"},"groups")," page that show some stats about each group.")),features:{gs_sent:{name:"Sent",sg:!0},gs_received:{name:"Received",sg:!0},gs_giftDifference:{name:"Gift Difference",sg:!0},gs_valueDifference:{name:"Value Difference",sg:!0},gs_firstGiveaway:{name:"First Giveaway",sg:!0},gs_lastGiveaway:{name:"Last Giveaway",sg:!0},gs_averageEntries:{name:"Average Entries",sg:!0},gs_contributors:{name:"Contributors",sg:!0},gs_winners:{name:"Winners",sg:!0},gs_giftsSent:{name:"Gifts Sent",sg:!0},gs_giveaways:{name:"Giveaways",sg:!0},gs_users:{name:"Users",sg:!0},gs_creationDate:{name:"Creation Date (takes a bit longer to retrieve the date from Steam)",sg:!0},gs_type:{name:"Type (takes a bit longer to check if the group is open, restricted, closed or an official game group on Steam)",sg:!0}},id:"gs",name:"Group Stats",sg:!0,type:"groups"}}async init(){c.common.isCurrentPath("Steam - Groups")&&(!d.get("gs_creationDate")&&!d.get("gs_type")||await ut.contains([["steamCommunity"]]))&&(Se.insert(document.getElementsByClassName("table__heading")[0],"beforeend",Se.element("fragment",null,d.get("gs_sent")?Se.element("div",{className:"table__column--width-small text-center"},"Sent"):null,d.get("gs_received")?Se.element("div",{className:"table__column--width-small text-center"},"Received"):null,d.get("gs_giftDifference")?Se.element("div",{className:"table__column--width-small text-center"},"Gift Difference"):null,d.get("gs_valueDifference")?Se.element("div",{className:"table__column--width-small text-center"},"Value Difference"):null,d.get("gs_firstGiveaway")?Se.element("div",{className:"table__column--width-small text-center"},"First Giveaway"):null,d.get("gs_lastGiveaway")?Se.element("div",{className:"table__column--width-small text-center"},"Last Giveaway"):null,d.get("gs_averageEntries")?Se.element("div",{className:"table__column--width-small text-center"},"Average Entries"):null,d.get("gs_contributors")?Se.element("div",{className:"table__column--width-small text-center"},"Contributors"):null,d.get("gs_winners")?Se.element("div",{className:"table__column--width-small text-center"},"Winners"):null,d.get("gs_giftsSent")?Se.element("div",{className:"table__column--width-small text-center"},"Gifts Sent"):null,d.get("gs_giveaways")?Se.element("div",{className:"table__column--width-small text-center"},"Giveaways"):null,d.get("gs_users")?Se.element("div",{className:"table__column--width-small text-center"},"Users"):null,d.get("gs_creationDate")?Se.element("div",{className:"table__column--width-small text-center"},"Creation Date"):null,d.get("gs_type")?Se.element("div",{className:"table__column--width-small text-center"},"Type"):null)),this.notification=at.create().insert(c.esgst.pagination.previousElementSibling,"beforebegin"),this.numGroups=0,c.esgst.groupFeatures.push(this.gs_getGroups.bind(this)))}gs_getGroups(e,t){this.notification.setLoading("Loading stats for groups..."),this.numGroups+=e.length;const s=[];for(const n of e){const e=this.gs_addStatus(n,t);e.then(()=>this.notification.setMessage(`Loading stats for groups (${--this.numGroups} left)...`)),s.push(e)}Promise.all(s).then(()=>{0===this.numGroups&&this.notification.setSuccess("Stats for groups loaded.")})}async gs_addStatus(e,t){const s=await Ne.get(`${e.url}/users/search?q=${d.get("username")}`),n=s.html.querySelector(".table__row-inner-wrap");if(!n||n.querySelector(".table__column__heading").textContent!==d.get("username"))return;const a=[];Object.assign(e,{firstGiveaway:0,lastGiveaway:0,averageEntries:0,contributors:0,winners:0,giveaways:0,users:0,giftsSent:0,giftsSentValue:0,sent:0,sentValue:0,received:0,receivedValue:0,giftDifference:0,valueDifference:0});const i=/^([+-]?\$?\d+(?:\.\d+)?)(?:.*?\(\$?([+-]?\d+(?:\.\d+)?)\))?$/,o=new Map;function r(e){const t=(e||"").trim().replace(/,/g,"");if(o.has(t))return o.get(t);const s=i.exec(t),n=s?{main:parseFloat(s[1].replace("$","")),value:void 0!==s[2]?parseFloat(s[2]):null}:{main:null,value:null};return o.set(t,n),n}const l={0:{setting:"gs_sent",assign:(t,s)=>{e.sent=t,e.sentValue=null!=s?s:0}},1:{setting:"gs_received",assign:(t,s)=>{e.received=t,e.receivedValue=null!=s?s:0}},2:{setting:"gs_giftDifference",assign:t=>{e.giftDifference=t}},3:{setting:"gs_valueDifference",assign:t=>{e.valueDifference=t}}},g=n.querySelectorAll(".table__column--width-small");for(const[e,t]of g.entries()){const s=l[e];if(s&&d.get(s.setting)){const{main:e,value:n}=r(t.textContent);null!==e&&(s.assign(e,n),a.push(t))}}function u(e){const t=e.querySelector("[data-timestamp]");return t?1e3*parseInt(t.getAttribute("data-timestamp")):0}const m={"First Giveaway":{setting:"gs_firstGiveaway",assign:t=>{e.firstGiveaway=u(t)}},"Last Giveaway":{setting:"gs_lastGiveaway",assign:t=>{e.lastGiveaway=u(t)}},"Average Entries":{setting:"gs_averageEntries",assign:t=>{e.averageEntries=parseInt(t.textContent.replace(/,/g,""))||0}},Contributors:{setting:"gs_contributors",assign:t=>{e.contributors=parseInt(t.textContent.replace(/,/g,""))||0}},Winners:{setting:"gs_winners",assign:t=>{e.winners=parseInt(t.textContent.replace(/,/g,""))||0}},"Gifts Sent":{setting:"gs_giftsSent",assign:t=>{const s=t.textContent.replace(/,/g,"").match(/^(\d+).*?\(\$?([+-]?\d+(?:\.\d+)?)\)/);e.giftsSent=s?parseInt(s[1]):0,e.giftsSentValue=s?parseFloat(s[2]):0}}},h=s.html.querySelectorAll(".featured__table__row__left");for(const e of h){const t=m[e.textContent.trim()];if(t&&d.get(t.setting)){const s=e.nextElementSibling;t.assign(s),s.classList.remove("featured__table__row__right"),s.classList.add("table__column--width-small","text-center"),a.push(s)}}const p=s.html.querySelectorAll(".sidebar__navigation__item__name");for(const t of p){const s=t.textContent.trim(),n=t.nextElementSibling.nextElementSibling;let i=!1;"Giveaways"===s&&d.get("gs_giveaways")?(e.giveaways=parseInt(n.textContent.replace(/,/g,""))||0,i=!0):"Users"===s&&d.get("gs_users")&&(e.users=parseInt(n.textContent.replace(/,/g,""))||0,i=!0),i&&(n.classList.remove("sidebar__navigation__item__count"),n.classList.add("table__column--width-small","text-center"),a.push(n))}const f=s.html.querySelector('a[href*="/gid/"]');if(e.steamId=f.getAttribute("href").match(/\/gid\/(\d+)/)[1],e.creationDate=0,e.type="-",d.get("gs_creationDate")||d.get("gs_type")){const t=await Ne.get(`https://steamcommunity.com/gid/${e.steamId}?cc=us&l=english`,{anon:!0});if(d.get("gs_creationDate")){const s=t.html.querySelectorAll(".groupstat > .label");let n="-";for(const t of s)if(/founded/i.test(t.textContent)){n=t.nextElementSibling.textContent.trim(),e.creationDate=new Date(n);break}a.push(Se.element("div",{className:"table__column--width-small text-center"},Se.element("span",{"data-timestamp":e.creationDate/1e3},n)))}if(d.get("gs_type")){if(t.url.match(/steamcommunity\.com\/games\//))e.type="Official Game Group",e.officialGameGroup=!0;else{const s=t.html.querySelector(".grouppage_join_area"),n=s?s.textContent.trim():"";/join group/i.test(n)?(e.type="Open",e.open=!0):/request to join/i.test(n)?(e.type="Restricted",e.restricted=!0):/membership by invitation only/i.test(n)&&(e.type="Closed",e.closed=!0)}a.push(Se.element("div",{className:"table__column--width-small text-center"},e.type))}}Se.insert(e.container,"afterend",Se.element("fragment",null,a)),t&&c.esgst.gpf&&c.esgst.gpf.filteredCount&&d.get("gpf_enable"+c.esgst.gpf.type)&&c.esgst.modules.groupsGroupFilters.filters_filter(c.esgst.gpf)}},Fa=hs.createElements.bind(hs),$a=hs.formatTags.bind(hs),Wa=hs.lockAndSaveDiscussions.bind(hs),Va=hs.lockAndSaveGames.bind(hs),ja=hs.lockAndSaveGroups.bind(hs),Ha=hs.getFeatureTooltip.bind(hs),Ja=hs.getUser.bind(hs),Ya=hs.getValue.bind(hs),Ka=hs.saveUser.bind(hs),za=hs.saveUsers.bind(hs),Qa=hs.setSetting.bind(hs),Za=hs.triggerSetOnEnter.bind(hs);class Xa extends gt{constructor(e){super(),this.id=e}async tags_getTags(){const e=[];switch(this.id){case"dt":{const t=JSON.parse(Ya("discussions"));for(const s in t)if(t.hasOwnProperty(s)){const n=t[s].tags;n&&Array.isArray(n)&&e.push(...n)}break}case"gpt":{const t=JSON.parse(Ya("groups"));for(const s of t){const t=s.tags;t&&Array.isArray(t)&&e.push(...t)}break}case"gt":{const t=JSON.parse(Ya("games"));for(const s in t.apps)if(t.apps.hasOwnProperty(s)){const n=t.apps[s].tags;n&&Array.isArray(n)&&e.push(...n)}for(const s in t.subs)if(t.subs.hasOwnProperty(s)){const n=t.subs[s].tags;n&&Array.isArray(n)&&e.push(...n)}break}case"ut":{const t=JSON.parse(Ya("users"));for(const s in t.users)if(t.users.hasOwnProperty(s)){const n=t.users[s].tags;n&&Array.isArray(n)&&e.push(...n)}break}}const t={};for(const s of e)t[s]||(t[s]=0),t[s]+=1;this.esgst[this.id+"Tags"]=[];for(const e in t)t.hasOwnProperty(e)&&this.esgst[this.id+"Tags"].push({count:t[e],tag:e});this.esgst[this.id+"Tags"]=l.sortArray(this.esgst[this.id+"Tags"],!0,"count").map(e=>e.tag),d.get(this.id+"_s")&&(this.esgst.documentEvents.keydown.add(this.tags_navigateSuggestions.bind(this)),this.esgst.documentEvents.click.add(this.tags_closeSuggestions.bind(this)))}tags_navigateSuggestions(e){if(!e.key.match(/^(ArrowDown|ArrowUp|Enter)$/)||e.repeat)return;const t=document.querySelector(".esgst-tag-suggestion.esgst-selected");let s=null;if(t){if("ArrowDown"===e.key)for(s=t.nextElementSibling;s&&s.classList.contains("esgst-hidden");)s=s.nextElementSibling;else if("ArrowUp"===e.key)for(s=t.previousElementSibling;s&&s.classList.contains("esgst-hidden");)s=s.previousElementSibling;else"Enter"===e.key&&(e.stopPropagation(),t.click());t.classList.remove("esgst-selected"),s&&s.classList.add("esgst-selected")}else"Enter"!==e.key&&(s=document.querySelector(".esgst-tag-suggestion:not(.esgst-hidden)"),s&&s.classList.add("esgst-selected"))}tags_closeSuggestions(e){const t=document.querySelector(".esgst-tag-suggestions:not(.esgst-hidden)");t&&!t.contains(e.target)&&"INPUT"!==e.target.tagName&&this.tags_hideSuggestions(t)}tags_hideSuggestions(e){e.classList.add("esgst-hidden");for(const t of e.children)t.classList.remove("esgst-selected")}async tags_addButtons(e){e=e.all||e;for(const t of e){const e={item:t,key:this.id,colorSetting:d.get(this.id+"_colors")};t.container.getElementsByClassName("esgst-tag-button")[0]||Fa(t.tagContext,t.tagPosition,[{attributes:{class:"esgst-tag-button esgst-faded","data-draggable-id":this.id,title:Ha(this.id,"Edit tags")},type:"a",children:[{attributes:{class:"fa fa-tag"},type:"i"},{attributes:{class:"esgst-tags"},type:"span"}]}]).addEventListener("click",this.tags_openPopup.bind(this,e),!0),t.saved&&t.saved.tags&&(t.tags=t.saved.tags.map(e=>e.toLowerCase()),await this.tags_addTags(t,e,t.saved.tags))}}async tags_openMmPopup(e,t){const s={Discussions:"dt",Games:"gt",Groups:"gpt",Users:"ut"}[this.id],n={items:[],key:this.id,colorSetting:d.get(this.id+"_colors")};n.items=l.sortArray(t.filter(e=>e.mm&&(e.outerWrap.offsetParent||e.outerWrap.closest(".esgst-gv-container:not(.is-hidden):not(.esgst-hidden)"))),!1,"code");const a=JSON.parse(Ya("discussions")),i=JSON.parse(Ya("games")),o=JSON.parse(Ya("groups")),r=JSON.parse(Ya("users"));for(const e of n.items)switch(e.tags=[],e.uniqueTags=[],s){case"dt":{const t=a[e.code];t&&t.tags&&Array.isArray(t.tags)&&(e.tags=t.tags);break}case"gpt":{const t=o.filter(t=>t.code===e.code)[0];t&&t.tags&&Array.isArray(t.tags)&&(e.tags=t.tags);break}case"gt":{const t=i[e.type][e.code];t&&t.tags&&Array.isArray(t.tags)&&(e.tags=t.tags);break}case"ut":{const t=await Ja(r,{username:e.code});t&&t.tags&&Array.isArray(t.tags)&&(e.tags=t.tags);break}}n.hasUnique=!1,n.sharedTags=new Set;for(const e of n.items)for(const t of e.tags)n.items.length===n.items.filter(e=>e.tags.indexOf(t)>-1).length?n.sharedTags.add(t):(n.hasUnique=!0,e.uniqueTags.push(t));n.hasUnique&&n.sharedTags.add("[*]"),n.sharedTags=Array.from(n.sharedTags),this.tags_openPopup(n)}async tags_openPopup(e,t){t&&(t.preventDefault(),t.stopPropagation()),e.popup=new lt({addScrollable:!0,buttons:[[{template:"success",name:"Save",onClick:this.tags_saveTags.bind(this,e)},{template:"loading",isDisabled:!0,name:"Saving..."}]],icon:"fa-tag",isTemp:!0,title:Se.element("fragment",null,"Edit tags for"," ",Se.element("span",null,e.items&&e.items.length+" items"||e.item.name||e.item.id),":")}),Fa(e.popup.description,"beforeend",[{attributes:{class:"esgst-description"},type:"div",children:[{text:"Drag the tags to move them.",type:"p"},{type:"br"},{text:"When editing a tag color, it will also alter the color for all items with that tag (you have to refresh the page for it to take effect).",type:"p"},...e.hasUnique?[{type:"br"},{text:"[*] means that there are tags that are not shared between all items. If you delete the [*] tag, those unique tags will be deleted.",type:"p"}]:[]]}]),e.tags=Fa(e.popup.description,"beforeend",[{attributes:{class:"esgst-tags"},type:"div"}]),e.input=Fa(e.popup.description,"beforeend",[{attributes:{type:"text"},events:{focus:this.tags_createTags.bind(this,e),input:this.tags_createTags.bind(this,e),keydown:Za.bind(this,e.popup.buttons[0])},type:"input"}]),Fa(e.popup.description,"beforeend",[{attributes:{class:"esgst-tag-list-button esgst-clickable fa fa-list",title:"Select from existing tags"},type:"i"}]).addEventListener("click",this.tags_showTagList.bind(this,e));const s=[];if(d.get(e.key+"_s")){e.suggestions=Fa(e.popup.description,"beforeend",[{attributes:{class:"esgst-tag-suggestions esgst-hidden"},type:"div"}]);for(const t of this.esgst[e.key+"Tags"])s.push({attributes:{class:"esgst-tag-suggestion esgst-hidden"},events:{click:this.tags_addSuggestion.bind(this,e),mouseenter:this.tags_selectSuggestion,mouseleave:this.tags_unselectSuggestion},text:t,type:"div"});Fa(e.suggestions,"atinner",s)}Fa(e.popup.description,"beforeend",[{attributes:{class:"esgst-description"},text:"Use commas to separate tags, for example: Tag1, Tag2, ...",type:"div"}]),e.popup.open(this.tags_loadTags.bind(this,e))}async tags_saveTags(e){let t=e.input.value.replace(/(,\s*)+/g,$a).split(", ");switch(1!==t.length||t[0].trim()||(t=""),e.key){case"dt":{const s={};if(e.items)for(const n of e.items){if(n.multiTags=t,t){const e=t.indexOf("[*]");e>-1&&(n.multiTags=[...t],n.multiTags.splice(e,1,...n.uniqueTags))}s[n.code]={name:n.name,tags:n.multiTags}}else s[e.item.id]={name:e.item.name,tags:t};await Wa(s);break}case"gpt":{const s={};if(e.items)for(const n of e.items){if(n.multiTags=t,t){const e=t.indexOf("[*]");e>-1&&(n.multiTags=[...t],n.multiTags.splice(e,1,...n.uniqueTags))}s[n.code]={code:n.code,name:n.name,tags:n.multiTags}}else s[e.item.id]={code:e.item.id,name:e.item.name,tags:t};await ja(s);break}case"gt":{const s={apps:{},subs:{}};if(e.items)for(const n of e.items){if(n.multiTags=t,t){const e=t.indexOf("[*]");e>-1&&(n.multiTags=[...t],n.multiTags.splice(e,1,...n.uniqueTags))}s[n.type][n.code]={tags:n.multiTags}}else s[e.item.type][e.item.id]={tags:t};await Va(s);break}case"ut":if(e.items){const s=[];for(const n of e.items){if(n.multiTags=t,t){const e=t.indexOf("[*]");e>-1&&(n.multiTags=[...t],n.multiTags.splice(e,1,...n.uniqueTags))}s.push({steamId:n.sg?null:n.code,username:n.sg?n.code:null,values:{tags:n.multiTags}})}await za(s)}else{const s={steamId:e.item.steamId,username:e.item.username,values:{tags:t}};await Ka(null,null,s)}}if(await Qa(e.key+"_colors",e.colorSetting),e.items)for(const t of e.items)await this.tags_addTags(t,e,t.multiTags);else await this.tags_addTags(e.item,e,t);e.popup.close()}async tags_addTags(e,t,s){let n=null;switch(t.key){case"dt":{n=[];const t=rt.findData(null,"discussions");n=n.concat(t.filter(t=>t.code===e.code||t.code===e.id));break}case"gpt":n=this.esgst.currentGroups[e.code||e.id].elements;break;case"gt":n=(await this.esgst.modules.games.games_get(document,!0,this.esgst.games))[e.type][e.id||e.code];break;case"ut":n=this.esgst.currentUsers[e.code||e.id].elements}if(!n)return;const a=s.length&&s[0]?s.map(e=>this.tags_template(e)):[{text:"",type:"node"}];for(const e of n){let s=null;switch(t.key){case"dt":s=e.container;break;case"gpt":s=e.parentElement;break;case"gt":s=e.container;break;case"ut":{const t=e.parentElement;if(!t)break;s=t.classList.contains("comment__username")?t:e,s=s.parentElement;break}}if(!s)continue;const n=s.getElementsByClassName("esgst-tag-button")[0];if(!n)continue;n.classList[a?"remove":"add"]("esgst-faded");const i=n.lastElementChild;Fa(i,"atinner",a);for(const e of i.children){const s=t.colorSetting[e.textContent];s&&(e.style.color=s.color,e.style.backgroundColor=s.bgColor)}}}tags_template(e){return{attributes:{class:"esgst-tag global__image-outer-wrap author_avatar is_icon"},text:e,type:"span"}}tags_createTags(e){e.tags.innerHTML="";const t=e.input.value.replace(/(,\s*)+/g,$a).split(", ").filter(e=>e);if(t.length){if(d.get(e.key+"_s"))if(e.input.value.slice(-1).match(/\s|,/))this.tags_hideSuggestions(e.suggestions);else{const s=t[t.length-1].toLowerCase();let n=document.querySelector(".esgst-tag-suggestion.esgst-selected");n&&n.classList.remove("esgst-selected"),n=null;for(const t of e.suggestions.children){const e=t.textContent.toLowerCase();e!==s&&e.match(new RegExp("^"+s))?(t.classList.remove("esgst-hidden"),n||(n=t)):t.classList.add("esgst-hidden")}n?e.suggestions.classList.remove("esgst-hidden"):this.tags_hideSuggestions(e.suggestions)}for(const s of t)this.tags_createTag(e,s)}else d.get(e.key+"_s")&&this.tags_hideSuggestions(e.suggestions)}tags_createTag(e,t){const s=Fa(e.tags,"beforeend",[{attributes:{class:"esgst-tag-preview",draggable:!0},type:"div",children:[{attributes:{class:"esgst-tags"},type:"div",children:[{attributes:{class:"esgst-tag global__image-outer-wrap author_avatar is_icon"},text:t,type:"span"}]},{attributes:{class:"esgst-hidden",type:"text"},type:"input"},{attributes:{title:"Set text color for this tag",type:"color"},type:"input"},{attributes:{title:"Set background color for this tag",type:"color"},type:"input"},{attributes:{class:"esgst-clickable fa fa-edit",title:"Edit tag"},type:"i"},{attributes:{class:"esgst-clickable fa fa-trash",title:"Delete tag"},type:"i"},{attributes:{class:"esgst-clickable fa fa-rotate-left",title:"Reset tag color"},type:"i"}]}]),n=s.firstElementChild,a=n.firstElementChild,i=n.nextElementSibling,o=i.nextElementSibling,r=o.nextElementSibling,l=r.nextElementSibling,c=l.nextElementSibling,d=c.nextElementSibling,g=e.colorSetting[t];g&&(o.value=a.style.color=g.color,r.value=a.style.backgroundColor=g.bgColor),s.addEventListener("dragstart",this.tags_startDrag.bind(this,s,e)),s.addEventListener("dragenter",this.tags_continueDrag.bind(this,s,e)),s.addEventListener("dragend",this.tags_endDrag.bind(this,e)),i.addEventListener("keydown",this.tags_editTag.bind(this,r,o,i,e,a,n)),o.addEventListener("change",this.tags_saveColor.bind(this,o,"color",e,"color",a)),r.addEventListener("change",this.tags_saveColor.bind(this,r,"backgroundColor",e,"bgColor",a)),l.addEventListener("click",this.tags_showEdit.bind(this,i,a,n)),c.addEventListener("click",this.tags_deleteTag.bind(this,s,e)),d.addEventListener("click",this.tags_resetColor.bind(this,r,o,e,a))}tags_startDrag(e,t,s){s.dataTransfer.setData("text/plain",""),t.dragged=e}tags_continueDrag(e,t){let s;s=t.dragged;do{if(s=s.previousElementSibling,s&&s===e)return void t.tags.insertBefore(t.dragged,e)}while(s);t.tags.insertBefore(t.dragged,e.nextElementSibling)}tags_endDrag(e){const t=[];for(const s of e.tags.children)t.push(s.firstElementChild.firstElementChild.textContent);e.input.value=t.join(", ")}tags_editTag(e,t,s,n,a,i,o){if("Enter"!==o.key)return;i.classList.remove("esgst-hidden"),s.classList.add("esgst-hidden");const r=s.value;a.textContent=r;const l=n.colorSetting[r];l&&(t.value=a.style.color=l.color,e.value=a.style.backgroundColor=l.bgColor),this.tags_endDrag(n)}tags_saveColor(e,t,s,n,a){const i=a.textContent;s.colorSetting[i]||(s.colorSetting[i]={bgColor:"",color:""}),s.colorSetting[i][n]=a.style[t]=e.value}tags_showEdit(e,t,s){s.classList.add("esgst-hidden"),e.classList.remove("esgst-hidden"),e.value=t.textContent,e.focus()}tags_deleteTag(e,t){e.remove(),this.tags_endDrag(t)}tags_resetColor(e,t,s,n){e.value="",t.value="",n.style.backgroundColor="",n.style.color="",delete s.colorSetting[n.textContent]}async tags_showTagList(e){e.listPopup=new lt({addScrollable:!0,buttons:[{template:"success",name:"Add Tags",onClick:this.tags_addTagsFromList.bind(this,e)}],icon:"fa-list",isTemp:!0,title:"Select from existing tags:"});const t=Fa(e.listPopup.scrollable,"beforeend",[{attributes:{class:"esgst-tag-list popup__keys__list"},type:"div"}]);e.selectedTags=[];for(const s of this.esgst[e.key+"Tags"]){const n=Fa(t,"beforeend",[{type:"div",children:[{type:"span"},{text:" "+s,type:"node"}]}]);e.colorSetting[s]&&(n.style.color=e.colorSetting[s].color,n.style.backgroundColor=e.colorSetting[s].bgColor);const a=new St(n);a.onEnabled=this.tags_selectTag.bind(this,e,s),a.onDisabled=this.tag_unselectTag.bind(this,e,s)}e.listPopup.open()}tags_addTagsFromList(e){for(const t of e.selectedTags)this.tags_createTag(e,t);e.input.value&&e.selectedTags.unshift(e.input.value),e.input.value=e.selectedTags.join(", "),e.listPopup.close()}tags_selectTag(e,t){e.selectedTags.push(t)}tag_unselectTag(e,t){e.selectedTags.splice(e.selectedTags.indexOf(t),1)}tags_addSuggestion(e,t){e.tags.innerHTML="";const s=e.input.value.replace(/(,\s*)+/g,$a).split(", "),n=t.currentTarget.textContent;s.pop(),s.push(n),e.input.value=s.join(", "),this.tags_hideSuggestions(e.suggestions);for(const t of s)this.tags_createTag(e,t);e.input.focus()}tags_selectSuggestion(e){for(const t of e.currentTarget.parentElement.children)t.classList.remove("esgst-selected");e.currentTarget.classList.add("esgst-selected")}tags_unselectSuggestion(e){const t=e.currentTarget.parentElement;e.relatedTarget!==t&&t.contains(e.relatedTarget)&&e.currentTarget.classList.remove("esgst-selected")}async tags_loadTags(e){let t=null;if(e.items)t={tags:e.sharedTags};else switch(e.key){case"dt":t=JSON.parse(Ya("discussions"))[e.item.id];break;case"gpt":t=JSON.parse(Ya("groups")).filter(t=>t.code===e.item.id)[0];break;case"gt":t=JSON.parse(Ya("games"))[e.item.type][e.item.id];break;case"ut":t=await Ja(null,{steamId:e.item.steamId,username:e.item.username})}if(e.input.focus(),t&&t.tags){e.tags.innerHTML="";for(const s of t.tags)this.tags_createTag(e,s);e.input.value=t.tags.join(", ")}}}const ei=new class extends Xa{constructor(){super("dt"),this.info={description:()=>Se.element("ul",null,Se.element("li",null,"Adds a button (",Se.element("i",{className:"fa fa-tag"})," ) next a discussion's title (in any page) that allows you to save tags for the discussion (only visible to you)."),Se.element("li",null,"You can press Enter to save the tags."),Se.element("li",null,"Each tag can be colored individually."),Se.element("li",null,"There is a button (",Se.element("i",{className:"fa fa-list"})," ) in the tags popup that allows you to view a list with all of the tags that you have used ordered from most used to least used."),Se.element("li",null,"Adds a button (",Se.element("i",{className:"fa fa-comments"})," ",Se.element("i",{className:"fa fa-tags"}),") to the page heading of this menu that allows you to manage all of the tags that have been saved.")),features:{dt_s:{name:"Show tag suggestions while typing.",sg:!0}},id:"dt",name:"Discussion Tags",sg:!0,type:"discussions"}}init(){this.esgst.discussionFeatures.push(this.tags_addButtons.bind(this)),this.tags_getTags()}};const ti=new class extends Xa{constructor(){super("gt"),this.info={description:()=>Se.element("ul",null,Se.element("li",null,"Adds a button (",Se.element("i",{className:"fa fa-tag"}),") next to a game's name (in any page) that allows you to save tags for the game (only visible to you)."),Se.element("li",null,"You can press Enter to save the tags."),Se.element("li",null,"Each tag can be colored individually."),Se.element("li",null,"There is a button (",Se.element("i",{className:"fa fa-list"}),") in the tags popup that allows you to view a list with all of the tags that you have used ordered from most used to least used."),Se.element("li",null,"Adds a button (",Se.element("i",{className:"fa fa-gamepad"})," ",Se.element("i",{className:"fa fa-tags"}),") to the page heading of this menu that allows you to manage all of the tags that have been saved.")),features:{gt_s:{name:"Show tag suggestions while typing.",sg:!0,st:!0}},id:"gt",name:"Game Tags",sg:!0,type:"games"}}init(){c.esgst.gameFeatures.push(this.tags_addButtons.bind(this)),this.tags_getTags()}};const si=new class extends Xa{constructor(){super("gpt"),this.info={description:()=>Se.element("ul",null,Se.element("li",null,"Adds a button (",Se.element("i",{className:"fa fa-tag"}),") next to a group's name (in any page) that allows you to save tags for the group (only visible to you)."),Se.element("li",null,"You can press Enter to save the tags."),Se.element("li",null,"Each tag can be colored individually."),Se.element("li",null,"There is a button (",Se.element("i",{className:"fa fa-list"}),") in the tags popup that allows you to view a list with all of the tags that you have used ordered from most used to least used."),Se.element("li",null,"Adds a button (",Se.element("i",{className:"fa fa-gamepad"})," ",Se.element("i",{className:"fa fa-tags"}),") to the page heading of this menu that allows you to manage all of the tags that have been saved.")),features:{gpt_s:{name:"Show tag suggestions while typing.",sg:!0,st:!0}},id:"gpt",name:"Group Tags",sg:!0,type:"groups"}}init(){c.esgst.groupFeatures.push(this.tags_addButtons.bind(this)),this.tags_getTags()}};const ni=new class extends gt{constructor(){super(),this.info={description:()=>Se.element("ul",null,Se.element("li",null,'When you click on "Review Giveaway" in the new giveaway page (also extends to the "Create Giveaway" button from ',Se.element("span",{"data-esgst-feature-id":"gts"}),' and the "Add" button from ',Se.element("span",{"data-esgst-feature-id":"mgc"}),"), this feature checks if there are possible Steam keys / Humble Bundle gift links in the description and warns you about it, in case you pasted them there by mistake."),Se.element("li",null,'This feature replaces the native "Review Giveaway" button, so that ESGST can intercept the click.')),id:"ngdc",name:"New Giveaway Description Checker",sg:!0,type:"giveaways"}}init(){if(!c.esgst.newGiveawayPath)return;const e=document.querySelector(".js__submit-form"),t=document.querySelector("[name=description]");if(!e||!t)return;e.classList.remove("js__submit-form");const s=e.cloneNode(!0);e.parentElement.insertBefore(s,e),e.remove(),s.setAttribute("data-esgst","reviewButton"),s.addEventListener("click",async()=>{if(await this.check(t.value))return;const e=s.closest("form");s.classList.contains("js__edit-giveaway")&&(e.querySelector("[name=next_step]").value=1),e.submit()})}check(e){return new Promise(async t=>{let s;e.match(/[\d\w]{5}(-[\d\w]{5}){2,}/)?s="There appears to be a Steam key in the description of the giveaway.":e.match(/https?:\/\/(www\.)?humblebundle\.com\/gift/)&&(s="There appears to be a Humble Bundle gift link in the description of the giveaway."),s?(s+=" Are you sure you want to continue?",await c.common.createConfirmation(s,()=>t(!1),()=>t(!0))):t(!1)})}},ai=hs.createElements.bind(hs),ii=hs.createHeadingButton.bind(hs),oi=hs.getValue.bind(hs),ri=hs.setSetting.bind(hs),li=hs.setValue.bind(hs);const ci=new class extends gt{constructor(){super(),this.info={description:()=>Se.element("ul",null,Se.element("li",null,"Adds a section 9 to the"," ",Se.element("a",{href:"https://www.steamgifts.com/giveaways/new"},"new giveaway")," page that allows you to save the details that you have filled (except for the name of the game and the number of copies/keys) as a template so that you can reuse it later. For example, if you often make public level 5 giveaways that last 2 days, you can save a template with those details so that when you create a new giveaway all of the fields in the page are automatically filled and all you have to do is select the game and set the number of copies/keys."),Se.element("li",null,"Also adds a button (",Se.element("i",{className:"fa fa-file"}),") to the main page heading of the same page that allows you manage all of the templates that have been saved and select the template that you want to use.")),id:"gts",name:"Giveaway Templates",sg:!0,type:"giveaways"}}init(){if(!this.esgst.newGiveawayPath)return;let e=document.getElementsByClassName("form__rows")[0];e&&this.gts_addButtonSection(ii({id:"gts",icons:["fa-file"],title:"View/apply templates"}),e)}gts_addButtonSection(e,t){let s,n,a,i,o,r,l,g,u,m,h,p,f,b,w,y;if(!t)return;let v,_,k={};k.deletedTemplates=[],f=t.lastElementChild,s=tt.create([{color:"green",icons:["fa-plus-circle"],name:"Create Giveaway",onClick:async()=>{const e=document.querySelector('[name="description"]');if(!d.get("ngdc")||!await c.esgst.modules.giveawaysNewGiveawayDescriptionChecker.check(e.value))return new Promise(async t=>{let s=`xsrf_token=${Be.xsrfToken}&next_step=3&`;s+=`game_id=${document.querySelector('[name="game_id"]').value}&`,s+=`type=${document.querySelector('[name="type"]').value}&`,s+=`copies=${document.querySelector('[name="copies"]').value}&`,s+=`key_string=${encodeURIComponent(document.querySelector('[name="key_string"]').value)}&`,s+=`timezone=${(new Date).getTimezoneOffset()}&`,s+=`start_time=${encodeURIComponent(document.querySelector('[name="start_time"]').value)}&`,s+=`end_time=${encodeURIComponent(document.querySelector('[name="end_time"]').value)}&`,s+=`region_restricted=${document.querySelector('[name="region_restricted"]').value}&`,s+=`country_item_string=${encodeURIComponent(document.querySelector('[name="country_item_string"]').value.trim())}&`,s+=`group_item_string=${encodeURIComponent(document.querySelector('[name="group_item_string"]').value.trim())}&`,s+=`who_can_enter=${document.querySelector('[name="who_can_enter"]').value}&`,s+=`whitelist=${document.querySelector('.form__row--who-can-enter [name="whitelist"]').value}&`,s+=`contributor_level=${document.querySelector('[name="contributor_level"]').value}&`,s+="description="+encodeURIComponent(e.value);const n=await Ne.post("/giveaways/new",{data:s.replace(/start_time=(.+?)&/,this.esgst.modules.giveawaysMultipleGiveawayCreator.mgc_correctTime.bind(this.esgst.modules.giveawaysMultipleGiveawayCreator))});if(n.url.match(/\/giveaways\/new/)){t();const e=n.html.getElementsByClassName("form__row__error");let s="Unable to create giveaway because of the following errors:\n\n";for(const t of e)s+="* "+t.textContent.trim();window.alert(s)}else window.location.href=n.url})}},{template:"loading",isDisabled:!0,name:"Creating..."}]).insert(t,"beforeend"),e.addEventListener("click",this.gts_openPopup.bind(this,k)),b=ai(f,"beforebegin",[{attributes:{class:"esgst-form-row"},type:"div",children:[{attributes:{class:"esgst-form-heading"},type:"div",children:[{attributes:{class:"esgst-form-heading-number"},text:"9.",type:"div"},{attributes:{class:"esgst-form-heading-text"},text:"Template",type:"div"}]},{attributes:{class:"esgst-gts-section esgst-form-row-indent"},type:"div",children:[{type:"div",children:[{text:"Use precise start time.",type:"span"},{attributes:{class:"fa fa-question-circle",title:"For example, if you picked 12:00 pm for the start date in section 4, when you apply the template the start date will be set to the next 12:00 pm hour, so if you apply the template on January 1 11:00 pm, the start date will be set to January 1 12:00 pm, and if you apply the template on January 1 13:00 pm, the start date will be set to January 2 12:00 pm. The end date will then be set based on the time range that you picked."},type:"i"}]},{type:"div",children:[{text:"Use precise end time.",type:"span"},{attributes:{class:"fa fa-question-circle",title:"For example, if you picked 12:00 pm for the end date and a time range of 2 days in section 4, when you apply the template the end date will be set to the next 12:00 pm hour after 2 days, so if you apply the template on January 1 11:00 pm, the end date will be set to January 3 12:00 pm, and if you apply the template on January 1 13:00 pm, the end date will be set to January 4 12:00 pm. The start date will then be set based on the time range that you picked."},type:"i"}]},{type:"div",children:[{text:"Use precise start date.",type:"span"},{attributes:{class:"fa fa-question-circle",title:"With this option enabled, the template will use the exact start date that you picked in section 4. This is only useful if you are creating multiple giveaways and want all of them to begin at a specific later date, because the template is not reusable after the date has passed."},type:"i"}]},{type:"div",children:[{text:"Use precise end date.",type:"span"},{attributes:{class:"fa fa-question-circle",title:"With this option enabled, the template will use the exact end date that you picked in section 4. This is only useful if you are creating multiple giveaways and want all of them to end at a specific later date, because the template is not reusable after the date has passed."},type:"i"}]},{attributes:{class:"esgst-description"},text:"By not selecting one of the options above, the template will use the time range that you picked in section 4. For example, if the time range that you picked was 2 days, when you apply the template the start date will be set to your current date and the end date will be set to 2 days later.",type:"div"},{attributes:{class:"form__input-small",type:"text"},type:"input"},{attributes:{class:"esgst-description esgst-hidden"},text:"Saved!",type:"span"},{attributes:{class:"esgst-hidden form__row__error"},type:"div",children:[{attributes:{class:"fa fa-exclamation-circle"},type:"i"},{text:" Please enter a name for the template.",type:"node"}]},{attributes:{class:"esgst-description"},text:"The name of the template.",type:"div"}]}]}]).lastElementChild,h=b.firstElementChild,l=h.nextElementSibling,p=l.nextElementSibling,g=p.nextElementSibling,k.input=g.nextElementSibling.nextElementSibling,i=k.input.nextElementSibling,y=i.nextElementSibling,u=new St(h,d.get("gts_preciseStart")),o=new St(l,d.get("gts_preciseEnd")),m=new St(p,d.get("gts_preciseStartDate")),r=new St(g,d.get("gts_preciseEndDate")),h.addEventListener("click",()=>{ri("gts_preciseStart",u.input.checked)}),l.addEventListener("click",()=>{ri("gts_preciseEnd",o.input.checked)}),p.addEventListener("click",()=>{ri("gts_preciseStartDate",m.input.checked)}),g.addEventListener("click",()=>{ri("gts_preciseEndDate",r.input.checked)}),tt.create([{template:"success",name:"Save Template",onClick:async()=>{let e,t,s,l,c,g;if(k.input.value){y.classList.add("esgst-hidden"),c=new Date(document.querySelector('[name="start_time"]').value),w=c.getTime(),g=new Date(document.querySelector('[name="end_time"]').value),a=g.getTime(),n=w-Date.now(),n<0&&(n=0),s={countries:document.querySelector('[name="country_item_string"]').value.trim(),delay:n,description:document.querySelector('[name="description"]').value,duration:a-w,gameType:document.querySelector('[name="type"]').value,groups:document.querySelector('[name="group_item_string"]').value.trim(),level:document.querySelector('[name="contributor_level"]').value,name:k.input.value,region:document.querySelector('[name="region_restricted"]').value,whoCanEnter:document.querySelector('[name="who_can_enter"]').value,whitelist:document.querySelector('.form__row--who-can-enter [name="whitelist"]').value,createTrain:d.get("mgc_createTrain"),removeLinks:d.get("mgc_removeLinks"),startTime:void 0,endTime:void 0,startDate:void 0,endDate:void 0},u.input.checked&&(s.startTime=w),o.input.checked&&(s.endTime=a),m.input.checked&&(s.startDate={day:c.getDate(),month:c.getMonth(),year:c.getFullYear()}),r.input.checked&&(s.endDate={day:g.getDate(),month:g.getMonth(),year:g.getFullYear()});const h=new Te("template",{threshold:300});for(await h.lock(),l=JSON.parse(oi("templates","[]")),e=0,t=l.length;e<t&&l[e].name!==s.name;++e);e<t?(k.edit||window.confirm("There already exists a template with this name. Do you want to overwrite it?"))&&(l[e]=s,i.classList.remove("esgst-hidden"),window.setTimeout(()=>{i.classList.add("esgst-hidden")},2e3)):(l.push(s),i.classList.remove("esgst-hidden"),window.setTimeout(()=>{i.classList.add("esgst-hidden")},2e3)),await li("templates",JSON.stringify(l)),await h.unlock()}else y.classList.remove("esgst-hidden")}},{template:"loading",isDisabled:!0,name:"Saving..."}]).insert(b,"beforeend"),t.insertBefore(s.nodes.outer,t.firstElementChild),t.insertBefore(f,t.firstElementChild),s.nodes.outer.style.display="inline-block",s.nodes.outer.style.margin="20px 5px",f.style.margin="20px 0",v=!0,_=!1,window.addEventListener("scroll",()=>{window.scrollY<138?v||(t.insertBefore(s.nodes.outer,t.firstElementChild),t.insertBefore(f,t.firstElementChild),s.nodes.outer.style.margin="20px 5px",f.style.margin="20px 0",v=!0,_=!1):_||(t.appendChild(f),t.appendChild(s.nodes.outer),f.style.margin="",s.nodes.outer.style.margin="0 5px",_=!0,v=!1)})}async gts_openPopup(e){let t=new lt({addScrollable:!0,icon:"fa-file",isTemp:!0,title:"View/apply templates:"});ai(t.description,"afterbegin",[{attributes:{class:"esgst-description"},text:"Drag and drop templates to move them.",type:"div"}]),e.undo=ai(t.description,"beforeend",[{attributes:{class:"esgst-clickable esgst-hidden"},type:"div",children:[{attributes:{class:"fa fa-rotate-left"},type:"i"},{text:"Undo Delete",type:"span"}]}]),e.undo.addEventListener("click",this.gts_undoDelete.bind(this,e));let s=ai(t.scrollable,"beforeend",[{attributes:{class:"esgst-text-left popup__keys__list"},type:"div"}]),n=JSON.parse(oi("templates","[]"));for(let a=0,i=n.length;a<i;++a){let i=n[a];i.gameType||(i.gameType="gift"),i.whoCanEnter||(i.whoCanEnter=i.type);let o=i.gameType+", ";if(i.startTime||i.endTime){if(i.startTime){let e=new Date(i.startTime);i.startDate&&(o+=`${i.startDate.year}-${i.startDate.month+1}-${i.startDate.day} `),o+=`${("0"+e.getHours()).slice(-2)}:${("0"+e.getMinutes()).slice(-2)} to`}else o+="? to";if(i.endTime){let e=new Date(i.endTime);i.endDate&&(o+=` ${i.endDate.year}-${i.endDate.month+1}-${i.endDate.day}`),o+=` ${("0"+e.getHours()).slice(-2)}:${("0"+e.getMinutes()).slice(-2)}`}else o+=" ?";o+=", "}else(i.startDate||i.endDate)&&(i.startDate?o+=`${i.startDate.year}-${i.startDate.month+1}-${i.startDate.day} to`:o+="? to",i.endDate?o+=` ${i.endDate.year}-${i.endDate.month+1}-${i.endDate.day}`:o=" ?",o+=", ");let r=Math.floor(i.duration/36e5);if(r>23){let e=Math.floor(r/24);if(e>6){let t=Math.floor(e/7);o+=1===t?"1 week":t+" weeks"}else o+=1===e?"1 day":e+" days"}else o+=1===r?"1 hour":r+" hours";"0"!==i.region&&(o+=", region restricted"),"everyone"===i.whoCanEnter?o+=", public":"invite_only"===i.whoCanEnter?o+=", invite only":("1"===i.whitelist&&(o+=", whitelist"),i.groups.trim()&&(o+=", groups")),o+=", level "+i.level;let l=ai(s,"beforeend",[{attributes:{draggable:!0},type:"div",children:[{attributes:{class:"esgst-clickable",style:"float: left;"},type:"div",children:[{attributes:{class:"esgst-bold"},text:i.name,type:"span"}]},{attributes:{class:"esgst-clickable",style:"float: right;"},type:"div",children:[{attributes:{class:"fa fa-trash",title:"Delete template"},type:"i"}]},{attributes:{style:"clear: both;"},type:"div"},{attributes:{class:"esgst-description"},text:o,type:"div"}]}]);l.addEventListener("dragstart",this.gts_setSource.bind(this,e,i.name,l)),l.addEventListener("dragenter",this.gts_getSource.bind(this,e,l,s)),l.addEventListener("dragend",this.gts_saveSource.bind(this,e)),this.gts_setTemplate(e,t,l,i)}t.open()}gts_setTemplate(e,t,s,n){let a=s.firstElementChild,o=a.nextElementSibling;a.addEventListener("click",()=>{this.gts_applyTemplate(n),e.input.value=n.name,e.edit=!0,t.close()}),o.addEventListener("click",async()=>{ai(o,"atinner",[{attributes:{class:"fa fa-circle-o-notch fa-spin"},type:"i"}]);const t=new Te("template",{threshold:300});await t.lock(),savedTemplates=JSON.parse(oi("templates","[]")),i=0;for(const e=savedTemplates.length;i<e&&savedTemplates[i].name!==n.name;++i);savedTemplates.splice(i,1),await li("templates",JSON.stringify(savedTemplates)),await t.unlock(),ai(o,"atinner",[{attributes:{class:"fa fa-trash"},type:"i"}]),s.classList.add("esgst-hidden"),e.deletedTemplates.push({template:s,savedTemplate:n}),e.undo.classList.remove("esgst-hidden"),e.edit=!1})}async gts_undoDelete(e){let t=e.deletedTemplates.pop();t.template.classList.remove("esgst-hidden"),t.template.parentElement.appendChild(t.template);let s=JSON.parse(oi("templates","[]"));s.push(t.savedTemplate),await li("templates",JSON.stringify(s)),0===e.deletedTemplates.length&&e.undo.classList.add("esgst-hidden")}gts_applyTemplate(e){let t,s,n,a,i,o,r,l,c,d,g,u,m,h;if(e.gameType||(e.gameType="gift"),e.whoCanEnter||(e.whoCanEnter=e.type),n=new Date,this.clickCheckbox(e.gameType),e.edit?(hs.setDatePickerDate("start_time",new Date(e.startTime)),hs.setDatePickerDate("end_time",new Date(e.endTime))):(e.startTime&&e.endTime?(m=new Date(e.startTime),u=new Date(n.getTime()),u.setHours(m.getHours(),m.getMinutes(),m.getSeconds(),m.getMilliseconds()),u.getTime()<n.getTime()&&u.setDate(u.getDate()+1),i=new Date(e.endTime),g=new Date(u.getTime()),a=i.getMonth()!==m.getMonth()?new Date(m.getFullYear(),m.getMonth()+1,0).getDate()-u.getDate()+i.getDate():i.getDate()-m.getDate(),g.setDate(u.getDate()+a),g.setHours(i.getHours(),i.getMinutes(),i.getSeconds(),i.getMilliseconds()),hs.setDatePickerDate("start_time",u),hs.setDatePickerDate("end_time",g)):e.startTime?(m=new Date(e.startTime),u=new Date(n.getTime()),u.setHours(m.getHours(),m.getMinutes(),m.getSeconds(),m.getMilliseconds()),u.getTime()<n.getTime()&&u.setDate(u.getDate()+1),g=new Date(u.getTime()+e.duration),hs.setDatePickerDate("start_time",u),hs.setDatePickerDate("end_time",g)):e.endTime?(i=new Date(e.endTime),u=new Date(n.getTime()+e.delay),g=new Date(u.getTime()+e.duration),g.setHours(i.getHours(),i.getMinutes(),i.getSeconds(),i.getMilliseconds()),g.getTime()<u.getTime()&&g.setDate(g.getDate()+1),hs.setDatePickerDate("start_time",u),hs.setDatePickerDate("end_time",g)):(u=new Date(n.getTime()+e.delay),g=new Date(n.getTime()+e.delay+e.duration),hs.setDatePickerDate("start_time",u),hs.setDatePickerDate("end_time",g)),e.startDate&&(u.setFullYear(e.startDate.year),u.setMonth(e.startDate.month),u.setDate(e.startDate.day),hs.setDatePickerDate("start_time",u)),e.endDate&&(g.setFullYear(e.endDate.year),g.setMonth(e.endDate.month),g.setDate(e.endDate.day),hs.setDatePickerDate("end_time",g))),e.region.match(/^[10]$/)||(e.region="0"),this.clickCheckbox(e.region),e.countries)for(d=document.querySelector('.form_list[data-input="country_item_string"]').children,s=e.countries.trim().split(/\s/),r=d.length-1;r>0;--r)t=d[r],l=t.getAttribute("data-item-id"),h=t.classList.contains("is-selected"),c=s.indexOf(l),(h&&c<0||!h&&c>=0)&&t.click();if(this.clickCheckbox(e.whoCanEnter),e.gameName&&(document.getElementsByClassName("js__autocomplete-name")[0].value=e.gameName),e.gameId&&(document.querySelector('[name="game_id"]').value=e.gameId),e.keys?document.querySelector('[name="key_string"]').value=e.keys:e.copies&&(document.querySelector('[name="copies"]').value=e.copies),"groups"===e.whoCanEnter)if(d=document.querySelector('.form_list[data-input="group_item_string"]').children,t=d[0],("1"===e.whitelist&&!t.classList.contains("is-selected")||"1"!==e.whitelist&&t.classList.contains("is-selected"))&&t.click(),e.groups)for(o=e.groups.trim().split(/\s/),r=d.length-1;r>0;--r)t=d[r],l=t.getAttribute("data-item-id"),h=t.classList.contains("is-selected"),c=o.indexOf(l),(h&&c<0||!h&&c>=0)&&t.click();else for(r=d.length-1;r>0;--r)t=d[r],t.classList.contains("is-selected")&&t.click();e.level>0?(document.getElementsByClassName("ui-slider-range")[0].style.width=10*e.level+"%",document.getElementsByClassName("form__level")[0].textContent="level "+e.level,document.getElementsByClassName("form__input-description--no-level")[0].classList.add("is-hidden"),document.getElementsByClassName("form__input-description--level")[0].classList.remove("is-hidden")):(document.getElementsByClassName("ui-slider-range")[0].style.width="0%",document.getElementsByClassName("form__input-description--level")[0].classList.add("is-hidden"),document.getElementsByClassName("form__input-description--no-level")[0].classList.remove("is-hidden")),document.getElementsByClassName("ui-slider-handle")[0].style.left=10*e.level+"%",document.querySelector('[name="contributor_level"]').value=e.level,document.querySelector('[name="description"]').value=e.description,this.esgst.mgc_createTrainSwitch&&(e.createTrain?this.esgst.mgc_createTrainSwitch.enable():this.esgst.mgc_createTrainSwitch.disable()),this.esgst.mgc_removeLinksSwitch&&(e.removeLinks?this.esgst.mgc_removeLinksSwitch.enable():this.esgst.mgc_removeLinksSwitch.disable())}async gts_setSource(e,t,s,n){let a,i,o;for(n.dataTransfer.setData("text/plain",""),e.source=s,o=JSON.parse(oi("templates","[]")),a=0,i=o.length;a<i&&o[a].name!==t;++a);a<i&&(e.sourceIndex=a)}gts_getSource(e,t,s){let n,a;n=e.source,a=0;do{if(n=n.previousElementSibling,n&&n===t)return e.sourceNewIndex=a,void s.insertBefore(e.source,t);++a}while(n);e.sourceNewIndex=a-1,s.insertBefore(e.source,t.nextElementSibling)}async gts_saveSource(e){let t=JSON.parse(oi("templates","[]"));t.splice(e.sourceNewIndex,0,t.splice(e.sourceIndex,1)[0]),li("templates",JSON.stringify(t))}clickCheckbox(e){if(null===e)return;let t=document.querySelector(`[data-checkbox-value="${e}"]`);t&&t.click()}},di=hs.createElements.bind(hs),gi=hs.createHeadingButton.bind(hs),ui=hs.setSetting.bind(hs);const mi=new class extends gt{constructor(){super(),this.info={description:()=>Se.element("ul",null,Se.element("li",null,"Turns each giveaway in the main page, groups, game pages, profile pages and some popups(",Se.element("span",{"data-esgst-feature-id":"gb"}),", ",Se.element("span",{"data-esgst-feature-id":"ged"})," and"," ",Se.element("span",{"data-esgst-feature-id":"ge"}),") into a small box where only the game's image is shown. Overlaying the image you will find the start/end times, type and level of the giveaway. To get the other details of the giveaway (such as the game name, the number of points it costs to enter, the number of entries/comments and the creator's username), you can hover over the box and a popout will appear containing them.This allows multiple giveaways to be shown per line, which reduces the size of the page and allows you to view all of the giveaways in the page at a single glance."),Se.element("li",null,"Also adds a button (",Se.element("i",{className:"fa fa-th-large"}),") to the main page heading of the same page that allows you to set the size of the space between each box.")),features:{gv_gb:{name:"Extend to Giveaway Bookmarks.",sg:!0},gv_ged:{name:"Extend to Giveaway Encrypter / Decrypter.",sg:!0},gv_ge:{name:"Extend to Giveaway Extractor.",sg:!0},gv_gp:{description:()=>Se.element("fragment",null,Se.element("ul",null,Se.element("li",null,"Extends to Game Pages.")),Se.element("ul",null,Se.element("strong",null,"example: "),Se.element("a",{href:"https://www.steamgifts.com/game/Q6JGq/garrys-mod"},"https://www.steamgifts.com/game/Q6JGq/garrys-mod"))),name:"Extend to Game Pages.",sg:!0},gv_pro:{description:()=>Se.element("fragment",null,Se.element("ul",null,Se.element("li",null,'Extends to "Gifts Won" and "Gifts Sent" in a user\'s profile page.')),Se.element("ul",null,Se.element("strong",null,"example: "),Se.element("a",{href:"https://www.steamgifts.com/user/cg"},"https://www.steamgifts.com/user/cg"))),name:"Extend to Profile.",sg:!0},gv_grp:{name:"Extend to Groups.",sg:!0}},id:"gv",name:"Grid View",sg:!0,type:"giveaways"}}init(){if((this.esgst.giveawaysPath||d.get("gv_gb")||d.get("gv_ged")||d.get("gv_ge")||d.get("gv_gp")||d.get("gv_pro")||d.get("gv_grp"))&&(this.esgst.giveawayFeatures.push(this.gv_setContainer.bind(this)),this.esgst.style.insertAdjacentText("beforeend",`\n\t\t\t\t.esgst-gv-creator {\n\t\t\t\t\tmargin: ${d.get("ib")?10:5}px 5px 5px;\n\t\t\t\t}\n\n\t\t\t\t.esgst-gv-popout .giveaway__links {\n\t\t\t\t\tdisplay: block;\n\t\t\t\t\theight: auto;\n\t\t\t\t\tmargin: 5px 5px ${d.get("ib")?10:5}px;\n\t\t\t\t\ttext-align: center;\n\t\t\t\t}\n\t\t\t`),this.esgst.groupPath&&d.get("gv_grp")||this.esgst.gamePath&&d.get("gv_gp")||this.esgst.giveawaysPath||this.esgst.userPath&&d.get("gv_pro"))){let e,t,s,n,a,i,o,r,l;e=gi({id:"gv",icons:["fa-th-large"],title:"Set Grid View spacing"}),o=new mt("esgst-gv-spacing",e,0,!0),r=d.get("gv_spacing"),s=di(o.popout,"beforeend",[{type:"div",children:[{type:"div"},{text:r+"px",type:"div"}]}]),l=s.firstElementChild,t=l.nextElementSibling,window.$(l).slider({slide:(e,s)=>{for(r=s.value,n=document.getElementsByClassName("esgst-gv-container"),a=0,i=n.length;a<i;++a)n[a].style.margin=r+"px";o.reposition(),t.textContent=r+"px",ui("gv_spacing",r)},max:10,value:r})}}gv_setContainer(e,t,s){if((!t||!(this.esgst.groupPath&&d.get("gv_grp")||this.esgst.gamePath&&d.get("gv_gp")||this.esgst.giveawaysPath||this.esgst.userPath&&d.get("gv_pro")))&&(t||("gb"!==s||!d.get("gv_gb"))&&("ged"!==s||!d.get("gv_ged"))&&("ge"!==s||!d.get("gv_ge"))))return;let n,a;this.esgst.userPath&&!this.esgst.userWonPath&&(a=document.getElementsByClassName("global__image-inner-wrap")[0].style.backgroundImage.match(/\("(.+)"\)/)[1],n=document.getElementsByClassName("featured__heading__medium")[0].textContent),e.forEach(e=>{e.grid=!0,e.outerWrap.closest(".esgst-popup-scrollable")||c.common.isCurrentPath("Account")&&this.esgst.parameters.esgst?(e.outerWrap.parentElement.parentElement.classList.add("esgst-gv-view"),e.outerWrap.parentElement.style.display="inline-block",e.outerWrap.classList.add("esgst-gv-container"),e.outerWrap.style.margin=d.get("gv_spacing")+"px"):(e.outerWrap.parentElement.classList.add("esgst-gv-view"),e.outerWrap.classList.add("esgst-gv-container"),e.outerWrap.style.margin=d.get("gv_spacing")+"px"),e.innerWrap.classList.add("esgst-gv-box");const t=Date.now();let i;e.gvIcons=di(e.innerWrap,"afterbegin",[{attributes:{class:"esgst-gv-icons giveaway__columns"},type:"div",children:[{attributes:{class:"esgst-gv-time","data-draggable-id":"time",draggable:!0},type:"div",children:[{attributes:{title:`${e.started?"Ends":"Starts"} ${e.endTimeColumn.lastElementChild.textContent}`},text:Ct(e.endTime,t,{locale:this.esgst.formatDistanceLocale}),type:"span"},{attributes:{class:"fa fa-clock-o"},type:"i"},{attributes:{title:"Created "+e.startTimeColumn.firstElementChild.textContent},text:Ct(e.startTime,t,{locale:this.esgst.formatDistanceLocale}),type:"span"}]}]}]),e.endTimeColumn_gv=e.gvIcons.firstElementChild.firstElementChild,e.inviteOnly&&e.gvIcons.appendChild(e.inviteOnly),e.regionRestricted&&e.gvIcons.appendChild(e.regionRestricted),e.group&&e.gvIcons.appendChild(e.group),e.whitelist&&e.gvIcons.appendChild(e.whitelist),e.levelColumn&&(e.levelColumn.textContent=e.levelColumn.textContent.replace(/Level\s/,""),e.gvIcons.appendChild(e.levelColumn)),e.innerWrap.insertBefore(e.image,e.gvIcons),e.summary.classList.add("esgst-gv-popout","global__image-outer-wrap"),Se.insert(e.links,"beforebegin",Se.element("div",{style:{alignItems:"center",display:"flex",justifyContent:"space-between"},ref:e=>i=e},Se.element("div",{style:{display:"flex",flex:"1",flexDirection:"column"}},Se.element("div",{className:"esgst-gv-creator"},"by ")))),this.esgst.userPath&&!this.esgst.userWonPath&&"gb"!==s&&(e.creatorContainer=Se.element("a",{className:"giveaway__username",href:"/user/"+n}," ",n),e.avatar=Se.element("a",{href:"/user/"+n,className:"giveaway_image_avatar",style:`background-image:url(${a});`})),i.firstElementChild.firstElementChild.appendChild(e.creatorContainer),i.firstElementChild.appendChild(e.links),i.appendChild(e.avatar),i.after(e.endTimeColumn.nextElementSibling),e.endTimeColumn.classList.add("esgst-hidden"),e.startTimeColumn.classList.add("esgst-hidden"),e.entriesLink.lastElementChild.textContent=e.entriesLink.textContent.replace(/[^\d,]+/g,""),e.commentsLink.lastElementChild.textContent=e.commentsLink.textContent.replace(/[^\d,]+/g,""),new mt("",e.outerWrap,100,!1,e.summary)})}};const hi=new class extends gt{constructor(){super(),this.info={description:()=>Se.element("ul",null,Se.element("li",null,"Hides the blacklist stats of your"," ",Se.element("a",{href:"https://www.steamgifts.com/stats/personal/community"},"stats")," page.")),id:"hbs",name:"Hidden Blacklist Stats",sg:!0,type:"general"}}init(){if(!window.location.pathname.match(/^\/stats\/personal\/community/))return;let e=document.getElementsByClassName("chart")[4],t=e.firstElementChild;t.lastElementChild.remove(),t.lastElementChild.remove();let s=t.nextElementSibling;s.textContent=s.textContent.replace(/and\sblacklists\s/,"");let n=document.createElement("script");n.textContent=e.previousElementSibling.textContent.replace(/,{name:\s"Blacklists".+?}/,""),document.body.appendChild(n),n.remove()}},pi=hs.createElements.bind(hs);const fi=new class extends gt{constructor(){super(),this.info={description:()=>Se.element("ul",null,Se.element("li",null,"Disables the enter button of any giveaway if you have hidden the game on SteamGifts so that you do not accidentally enter it.")),id:"hgebd",name:"Hidden Game's Enter Button Disabler",sg:!0,sync:"Hidden Games",syncKeys:["HiddenGames"],type:"giveaways"}}init(){if(!this.esgst.giveawayPath||document.getElementsByClassName("table--summary")[0])return;const e=document.getElementsByClassName("featured__giveaway__hide")[0];if((this.esgst.enterGiveawayButton||this.esgst.giveawayErrorButton&&!this.esgst.giveawayErrorButton.textContent.match(/Exists\sin\sAccount/))&&!e){const e=(this.esgst.enterGiveawayButton||this.esgst.giveawayErrorButton).parentElement;this.esgst.enterGiveawayButton&&this.esgst.enterGiveawayButton.remove(),this.esgst.giveawayErrorButton&&this.esgst.giveawayErrorButton.remove(),pi(e,"afterbegin",[{attributes:{class:"sidebar__error is-disabled"},type:"div",children:[{attributes:{class:"fa fa-exclamation-circle"},type:"i"},{text:" Hidden Game",type:"node"}]}])}}},bi=hs.createElements.bind(hs),wi=hs.createHeadingButton.bind(hs);const yi=new class extends gt{constructor(){super(),this.info={description:()=>Se.element("ul",null,Se.element("li",null,"Adds a button (",Se.element("i",{className:"fa fa-eye-slash"})," ",Se.element("i",{className:"fa fa-plus-circle"})," ",Se.element("i",{className:"fa fa-times-circle"}),") to your"," ",Se.element("a",{href:"https://www.steamgifts.com/account/settings/giveaways/filters"},"giveaway filters")," ","page that allows you to add / remove games to / from your hidden list."),Se.element("li",null,"You can add all your owned / ignored games with a single click."),Se.element("li",null,"You can remove all your owned / wishlisted games with a single click.")),id:"hgm",name:"Hidden Games Manager",sg:!0,type:"giveaways",features:{hgm_s:{name:"Automatically add / remove games from the list when syncing, based on the settings you have defined.",sg:!0}}}}init(){if(!window.location.pathname.match(/^\/account\/settings\/giveaways\/filters/))return;let e=wi({id:"hgm",icons:["fa-eye-slash","fa-plus-circle","fa-times-circle"],title:"Add / remove games to / from the list"});e.addEventListener("click",this.openPopup.bind(this,{button:e}))}openPopup(e){e.popup||(e.popup=new lt({addScrollable:!0,icon:"fa-plus fa-times",title:"Add / remove hidden games:"}),e.result=bi(e.popup.scrollable,"beforeend",[{attributes:{class:"markdown"},type:"div"}]),Se.insert(e.popup.description,"afterbegin",Se.element("textarea",{className:"esgst-textarea-small",placeholder:"https://store.steampowered.com/app/400\\nhttps://store.steampowered.com/sub/1280",ref:t=>e.textArea=t})),new vt(e.popup.scrollable,"hgm_addOwned",!1,"Add all owned games.",!1,!1,null,d.get("hgm_addOwned")),new vt(e.popup.scrollable,"hgm_addIgnored",!1,"Add all ignored games.",!1,!1,null,d.get("hgm_addIgnored")),new vt(e.popup.scrollable,"hgm_addBanned",!1,"Add all banned games (requires syncing delisted games in the settings menu).",!1,!1,null,d.get("hgm_addBanned")),new vt(e.popup.scrollable,"hgm_removeTextArea",!1,"Only remove games from text area.",!1,!1,null,d.get("hgm_removeTextArea")),new vt(e.popup.scrollable,"hgm_removeOwned",!1,"Only remove owned games.",!1,!1,null,d.get("hgm_removeOwned")),new vt(e.popup.scrollable,"hgm_removeWishlisted",!1,"Only remove wishlisted games.",!1,!1,null,d.get("hgm_removeWishlisted")),new vt(e.popup.scrollable,"hgm_removeFollowed",!1,"Only remove followed games.",!1,!1,null,d.get("hgm_removeFollowed")),new vt(e.popup.scrollable,"hgm_removeTagged",!1,Se.element("fragment",null,"Only remove games tagged with:"," ",Se.element("input",{className:"esgst-switch-input esgst-switch-input-large",placeholder:"tag1, tag2, tag3, ...",type:"text",value:d.get("hgm_tags").join(", "),onchange:e=>{d.set("hgm_tags",Array.from(new Set(e.target.value.toLowerCase().split(/,\s*/)))),c.common.setSetting("hgm_tags",d.get("hgm_tags"))}})),!1,!1,"Enter the tags for the games that you want to remove, separated by a comma.",d.get("hgm_removeTagged")),new vt(e.popup.scrollable,"hgm_removeBanned",!1,"Only remove banned games (requires syncing delisted games in the settings menu).",!1,!1,null,d.get("hgm_removeBanned")),tt.create([{color:"green",icons:["fa-arrow-circle-right"],name:"Add",onClick:this.startAdding.bind(this,e)},{template:"error",name:"Cancel",switchTo:{onReturn:0},onClick:this.stop.bind(this,e)}]).insert(e.popup.description,"beforeend"),tt.create([{color:"green",icons:["fa-arrow-circle-right"],name:"Remove",onClick:this.startRemoving.bind(this,e,!1)},{template:"error",name:"Cancel",switchTo:{onReturn:0},onClick:this.stop.bind(this,e)}]).insert(e.popup.description,"beforeend"),tt.create([{color:"green",icons:["fa-arrow-circle-down"],name:"Export",onClick:this.startExporting.bind(this,e)},{template:"error",name:"Cancel",switchTo:{onReturn:0},onClick:this.stop.bind(this,e)}]).insert(e.popup.description,"beforeend"),e.progressBar=at.create().insert(e.popup.description,"beforeend").hide()),e.popup.open()}async startAdding(e){if(e.running)return;e.running=!0,e.canceled=!1,e.button.classList.add("esgst-busy"),e.progressBar.setLoading("Adding games...").show(),e.result.innerHTML="";const t=[],s=[];e.textArea.value.split(/\n/).map(e=>{const n=e.match(/(app|sub)\/(\d+)/);if(n){const e=n[2],a=n[1]+"s",i=this.esgst.games[a][e];i&&i.hidden||("apps"===a?t:s).push(e)}}),d.get("hgm_addOwned")&&t.push(...Object.keys(this.esgst.games.apps).filter(e=>this.esgst.games.apps[e].owned&&!this.esgst.games.apps[e].hidden)),d.get("hgm_addIgnored")&&t.push(...Object.keys(this.esgst.games.apps).filter(e=>this.esgst.games.apps[e].ignored&&!this.esgst.games.apps[e].hidden)),d.get("hgm_addBanned")&&t.push(...c.esgst.delistedGames.banned),e.hideObj={appIds:t,subIds:s,update:t=>e.progressBar.setMessage(t)};const n=await hs.hideGames(e.hideObj);let a="";n.apps.length&&(a+=`The following apps were not found and therefore not hidden (they are most likely internal apps, such as demos, game editors etc): ${n.apps.join(", ")}\n`),n.subs.length&&(a+=`The following subs were not found and therefore not hidden: ${n.subs.join(", ")}\n`),a&&window.alert(a),e.button.classList.remove("esgst-busy"),e.progressBar.reset().hide(),e.running=!1}startExporting(e){return this.startRemoving(e,!0)}async startRemoving(e,t){if(e.running)return;e.running=!0,e.canceled=!1,e.lastPage="",e.button.classList.add("esgst-busy"),e.progressBar.setLoading((t?"Exporting":"Removing")+" games...").show(),t||bi(e.result,"atinner",[{attributes:{class:"esgst-bold"},text:"Removed Games:",type:"span"}]);const s=[],n=[];t||e.textArea.value.split(/\n/).map(e=>{const t=e.match(/(app|sub)\/(\d+)/);t&&("app"===t[1]?s:n).push(t[2])});const a={apps:{},subs:{}};let i=1,o=null;do{let r=null;if(i===this.esgst.currentPage)r=document;else{if(document.getElementsByClassName("esgst-es-page-"+i)[0]){i+=1;continue}r=(await Ne.get("/account/settings/giveaways/filters/search?page="+i)).html}e.lastPage||(e.lastPage=this.esgst.modules.generalLastPageLink.lpl_getLastPage(r,r===document),e.lastPage=999999999===e.lastPage?"":" of "+e.lastPage),e.progressBar.setMessage(`${t?"Exporting":"Removing"} games (page ${i}${e.lastPage})...`);let l=r.getElementsByClassName("table__row-outer-wrap");for(let i=0,o=l.length;i<o;i++){let o=l[i],g=await this.esgst.modules.games.games_getInfo(o);if(!g)continue;if(t){("apps"===g.type?s:n).push(g.id);continue}let u=this.esgst.games[g.type][g.id];if((!d.get("hgm_removeOwned")||!u||!u.owned)&&(!d.get("hgm_removeWishlisted")||!u||!u.wishlisted)&&(!d.get("hgm_removeFollowed")||!u||!u.followed)&&(!d.get("hgm_removeTagged")||!u||!u.tags||!u.tags.filter(e=>d.get("hgm_tags").includes(e.toLowerCase())).length)&&(!d.get("hgm_removeBanned")||c.esgst.delistedGames.banned.indexOf(parseInt(g.id)<0))&&(!d.get("hgm_removeTextArea")||("apps"===g.type?s:n).indexOf(g.id)<0)&&(d.get("hgm_removeOwned")||d.get("hgm_removeWishlisted")||d.get("hgm_removeFollowed")||d.get("hgm_removeTagged")||d.get("hgm_removeBanned")||d.get("hgm_removeTextArea")))continue;a[g.type][g.id]={hidden:null};let m=o.getElementsByClassName("table__remove-default")[0];r===document?m.dispatchEvent(new Event("click")):await Ne.post("/ajax.php",{data:`xsrf_token=${Be.xsrfToken}&do=remove_filter&game_id=${m.parentElement.querySelector('[name="game_id"]').value}`}),bi(e.result,"beforeend",[{attributes:{href:`http://store.steampowered.com/${g.type.slice(0,-1)}/${g.id}`},text:o.getElementsByClassName("table__column__heading")[0].textContent,type:"a"}])}i+=1,o=r.getElementsByClassName("pagination__navigation")[0]}while(!e.canceled&&o&&!o.lastElementChild.classList.contains("is-selected"));if(t){const e=[].concat(...s.map(e=>"https://store.steampowered.com/app/"+e),...n.map(e=>"https://store.steampowered.com/sub/"+e)).join("\n");hs.downloadFile(e,"steamgifts-hidden-games.txt")}else await hs.lockAndSaveGames(a),1===e.result.children.length&&bi(e.result,"atinner",[{attributes:{class:"esgst-bold"},text:"0 games removed.",type:"span"}]);e.button.classList.remove("esgst-busy"),e.progressBar.reset().hide(),e.running=!1}stop(e){e.canceled=!0,e.hideObj&&(e.hideObj.canceled=!0),e.button.classList.remove("esgst-busy"),e.progressBar.reset().hide()}};const vi=new class extends gt{constructor(){super(),this.info={description:()=>Se.element("ul",null,Se.element("li",null,"Refreshes the header icons (created/won/inbox for SteamGIFTS and inbox for SteamTrades) and the points on SteamGifts (in any page) every specified number of minutes."),Se.element("li",null,"There are also options to notify you when there are new wishlist giveaways open, when the key for a game you won is delivered, when you reach 400P and when you receive a new message."),Se.element("li",null,"You can upload a custom sound for the browser notifications."),Se.element("li",null,"If you enable the options to show browser notifications, you will be asked to give the permission to ESGST by your browser.")),features:{hr_w:{features:{hr_w_n:{features:{hr_w_n_s:{name:"Play a sound with this notification.",inputItems:!0,sg:!0}},name:"Also show as a browser notification.",sg:!0},hr_w_h:{name:"Only indicate for giveaways ending in a specified number of hours.",inputItems:[{id:"hr_w_hours",prefix:"Hours: "}],sg:!0}},inputItems:[{id:"hr_w_format",prefix:"Format: ",tooltip:"Use # to represent a number. For example, '(#❤)' would show '(8❤)' if there are 8 unentered wishlist giveaways open."}],name:"Indicate if there are unentered wishlist giveaways open in the tab's title.",sg:!0},hr_g:{features:{hr_g_n:{features:{hr_g_n_s:{name:"Play a sound with this notification.",inputItems:!0,sg:!0}},name:"Also show as a browser notification.",sg:!0}},inputItems:[{id:"hr_g_format",prefix:"Format: "}],name:"Indicate if there are unviewed keys for won gifts in the tab's title.",sg:!0},hr_b:{name:"Keep refreshing in the background when you go to another tab or minimize the browser.",sg:!0,st:!0},hr_c:{description:()=>Se.element("ul",null,Se.element("li",null,"With this option disabled, notifications will automatically close after a few seconds.")),name:"Only close notifications manually.",sg:!0,st:!0},hr_fp:{features:{hr_fp_p:{name:"Minimum number of points required to show a browser notification.",inputItems:[{id:"hr_fp_points",prefix:"Notify when points reach ",attributes:{type:"number",min:"1",max:"400",step:"1"}}],sg:!0},hr_fp_s:{name:"Play a sound with this notification.",inputItems:!0,sg:!0}},name:"Show a browser notification when points reach a specified threshold.",sg:!0},hr_p:{inputItems:[{id:"hr_p_format",prefix:"Format: ",tooltip:"Use # to represent a number. For example, '(#P)' would show '(100P)' if you have 100 points."}],name:"Show the number of points in the tab's title.",sg:!0},hr_m:{features:{hr_m_n:{features:{hr_m_n_s:{name:"Play a sound with this notification.",inputItems:!0,sg:!0,st:!0}},name:"Also show as a browser notification.",sg:!0,st:!0}},name:"Show the number of unread messages in the tab's icon.",sg:!0,st:!0},hr_a:{description:()=>Se.element("ul",null,Se.element("li",null,"With this option disabled, clicking on a notification will always open a new tab.")),features:{hr_a_r:{name:"Refresh the page after setting it as active.",sg:!0,st:!0},hr_a_a:{name:"If the page is not open, set any SteamGifts/SteamTrades tab as active.",sg:!0,st:!0}},extensionOnly:!0,name:"When clicking on a browser notification, check if the related page is open and set it as active.",sg:!0,st:!0}},inputItems:[{id:"hr_minutes",prefix:"Refresh every ",suffix:" minutes"}],id:"hr",name:"Header Refresher",sg:!0,st:!0,type:"general"}}init(){Ee.subscribe(Re,this.notifyWon.bind(this,!1)),Ee.subscribe(Me,this.notifyMessages.bind(this,!1)),Ee.subscribe(Oe,this.notifyPoints.bind(this,!1)),Ee.subscribe(Fe,this.notifyWishlist.bind(this,!1)),this.notifyWon(!0,Be.counters.won,Be.counters.won),this.notifyMessages(!0,Be.counters.messages,Be.counters.messages),this.notifyPoints(!0,Be.counters.points,Be.counters.points),this.startRefresher(),d.get("hr_b")||(window.addEventListener("focus",this.startRefresher.bind(this)),window.addEventListener("blur",()=>window.clearTimeout(this.refresher)))}async startRefresher(){const e=await Ne.get(c.esgst.sg?"/giveaways/search?type=wishlist":"/");await this.refreshHeader(e.html),this.refresher=window.setTimeout(()=>this.continueRefresher(),6e4*d.get("hr_minutes"))}async continueRefresher(){const e=JSON.parse(r.get("hrCache")),t=Date.now();if(e.username!==d.get("username")||t-e.timestamp>6e4*d.get("hr_minutes")){e.timestamp=t,r.set("hrCache",JSON.stringify(e));const s=await Ne.get(c.esgst.sg?"/giveaways/search?type=wishlist":"/");await this.refreshHeader(s.html),this.refresher=window.setTimeout(()=>this.continueRefresher(),6e4*d.get("hr_minutes"))}else await this.refreshHeader(null,e),this.wishlist=e.wishlist,this.newWishlist=e.newWishlist,this.refresher=window.setTimeout(()=>this.continueRefresher(),6e4*d.get("hr_minutes"))}async refreshHeader(e,t){if(e){const t=new Jt;switch(t.parse(e),Be.namespace){case Pe:{const s=t.buttonContainers.giveawaysCreated;s&&await c.header.updateCounter("giveawaysCreated",s.data.counter);const n=t.buttonContainers.giveawaysWon;n&&await c.header.updateCounter("giveawaysWon",n.data.counter,n.data.isFlashing);const a=t.buttonContainers.messages;a&&await c.header.updateCounter("messages",a.data.counter);const i=t.buttonContainers.account;if(i&&(await c.header.updatePoints(i.data.points),await c.header.updateLevel(i.data.level)),d.get("hr_w")){this.wishlist=0,this.newWishlist=0;const t=JSON.parse(r.get("hrWishlistCache","[]")),s=[],n=Date.now(),a=await c.esgst.modules.giveaways.giveaways_get(e,!1,null,!0);for(const e of a)s.push(e.code),!(e&&e.level<=Be.counters.level.base)||e.pinned||e.entered||c.esgst.giveaways[e.code]&&(c.esgst.giveaways[e.code].visited||c.esgst.giveaways[e.code].hidden)||d.get("hr_w_h")&&!(e.endTime-n<36e5*d.get("hr_w_hours"))||(this.wishlist+=1,t.indexOf(e.code)<0&&(this.newWishlist+=1,t.push(e.code)));for(let e=t.length-1;e>-1;e--)s.indexOf(t[e])<0&&t.splice(e,1);r.set("hrWishlistCache",JSON.stringify(t)),await Ee.dispatch(Fe,0,this.newWishlist,this.wishlist)}break}case Le:{const e=t.buttonContainers.messages;e&&await c.header.updateCounter("messages",e.data.counter);break}default:throw"Invalid namespace."}}else if(t)switch(Be.namespace){case Pe:await c.header.updateCounter("giveawaysCreated",t.created),await c.header.updateCounter("giveawaysWon",t.won,t.wonDelivered),await c.header.updateCounter("messages",t.messages),await c.header.updatePoints(t.points),await c.header.updateLevel(t.level),await Ee.dispatch(Fe,this.newWishlist,t.newWishlist,t.wishlist);break;case Le:await c.header.updateCounter("messages",t.messages);break;default:throw"Invalid namespace."}await Ee.dispatch(Ve)}notifyWon(e,t,s,n){n&&d.get("hr_g")?(d.get("hr_g_n")&&!e&&this.showNotification({msg:"You have new gifts delivered.",won:!0}),this.deliveredTitle=d.get("hr_g_format")):this.deliveredTitle=null,this.notifyTitleChange()}notifyMessages(e,t,s){const n=s-t;if(s>0&&d.get("hr_m")){const t=document.createElement("canvas"),a=new Image;t.width=16,t.height=16;const i=t.getContext("2d");a.crossOrigin="esgst",a.onload=()=>{i.drawImage(a,0,0),i.fillStyle="#e9202a",i.fillRect(8,6,8,10),i.fillStyle="#fff",i.font="bold 10px Arial",i.textAlign="left",i.fillText(s>9?"+":s,9,14),c.esgst.favicon.href=t.toDataURL("image/png")},a.src=c.esgst[c.esgst.name+"Icon"],n>0&&d.get("hr_m_n")&&!e&&this.showNotification({inbox:!0,msg:`You have ${n} new messages.`})}else c.esgst.favicon.href=c.esgst[c.esgst.name+"Icon"];this.notifyTitleChange()}notifyPoints(e,t,s){t<400&&s>=d.get("hr_fp_points")&&d.get("hr_fp")&&!e&&this.showNotification({msg:`You have ${s}P.`,points:!0}),this.pointsTitle=d.get("hr_p")?""+d.get("hr_p_format").replace(/#/,s):null,this.notifyTitleChange()}notifyWishlist(e,t,s,n){s&&d.get("hr_w")&&d.get("hr_w_n")&&!e&&this.showNotification({msg:d.get("hr_w_h")?`You have ${s} new wishlist giveaways ending in ${d.get("hr_w_hours")} hours.`:`You have ${s} new wishlist giveaways.`,wishlist:!0}),this.wishlistTitle=n&&d.get("hr_w")?""+d.get("hr_w_format").replace(/#/,n):null,this.notifyTitleChange()}notifyTitleChange(){const e=[];this.pointsTitle&&e.push(this.pointsTitle),this.deliveredTitle&&e.push(this.deliveredTitle),this.wishlistTitle&&e.push(this.wishlistTitle),e.push(c.esgst.originalTitle);const t=e.join(" ");document.title!==t&&(document.title=t),this.updateCache()}updateCache(){r.set("hrCache",JSON.stringify({created:Be.counters.created,level:Be.counters.level,messages:Be.counters.messages,newWishlist:this.newWishlist,points:Be.counters.points,timestamp:Date.now(),username:Be.user.username,wishlist:this.wishlist,won:Be.counters.won,wonDelivered:Be.counters.wonDelivered}))}async showNotification(e){if("granted"!==await window.Notification.requestPermission())return;if(e.won&&d.get("hr_g_n_s")||e.inbox&&d.get("hr_m_n_s")||e.points&&d.get("hr_fp_s")||e.wishlist&&d.get("hr_w_n_s"))try{this.audioContext||(this.audioContext=new AudioContext,this.wonPlayer=await this.createPlayer(d.get("hr_g_n_s_sound")||this.getDefaultSound()),this.messagesPlayer=await this.createPlayer(d.get("hr_m_n_s_sound")||this.getDefaultSound()),this.pointsPlayer=await this.createPlayer(d.get("hr_fp_s_sound")||this.getDefaultSound()),this.wishlistPlayer=await this.createPlayer(d.get("hr_w_n_s_sound")||this.getDefaultSound())),e.won&&this.wonPlayer&&this.wonPlayer.play(),e.inbox&&this.messagesPlayer&&this.messagesPlayer.play(),e.points&&this.pointsPlayer&&this.pointsPlayer.play(),e.wishlist&&this.wishlistPlayer&&this.wishlistPlayer.play()}catch(e){dt.warning(e.message)}const t=new Notification("ESGST Notification",{body:e.msg,icon:"https://dl.dropboxusercontent.com/s/lr3t3bxrxfxylqe/esgstIcon.ico?raw=1",requireInteraction:!!d.get("hr_c"),tag:e.msg});t.onclick=()=>{d.get("hr_a")?n.runtime.sendMessage({action:"tabs",any:!!d.get("hr_a_a"),inbox_sg:c.esgst.sg&&!!e.inbox,inbox_st:c.esgst.st&&!!e.inbox,refresh:!!d.get("hr_a_r"),wishlist:!!e.wishlist,won:!!e.won}):(e.won&&yt.open("https://www.steamgifts.com/giveaways/won"),e.inbox&&yt.open("https://www.steamgifts.com/messages"),e.wishlist&&yt.open("https://www.steamgifts.com/giveaways/search?type=wishlist")),t.close()}}async createPlayer(e){const t=window.atob(e),s=new ArrayBuffer(t.length),n=new Uint8Array(s);for(let e=s.byteLength-1;e>-1;e--)n[e]=255&t.charCodeAt(e);if(!this.audioContext)try{this.audioContext=new AudioContext}catch(e){return null}return{play:this.playSound.bind(this,await this.audioContext.decodeAudioData(s))}}playSound(e){const t=this.audioContext.createBufferSource();t.buffer=e,t.loop=!1,t.connect(this.audioContext.destination),t.start(0)}getDefaultSound(){return"//uQxAAB1MYI8KMM3gqqwV+AYZpBBAAEOmeT08nttJ5Mnd3zCCGXpiDk7P2IMUQz9yZNO4w8Bhe/wnsRER/dnpuDrjIhyeuTu0IOwADMISf8AKTAAAQ96xhBNnTh073uDhadkydJxNt/EMQgxAsBrjXJpnk0+yZSD2eDgMnl3zCDpmBZMmmZlmINabZd7BO2MIEMJpuTJkwcL0hjk02jxlx2j3ZNdmIPrdoJp60fwh7KACGHp2g+mIOnTCjTMCA6NJRgGfmJu1kjWIp8LtgtBXijXwh0UIgq0RLWS7rTWdNTsQakRJOgS8LwiZpaF2QlEGLRS1G+TdiB5GzlGsilxSjieMHGVCzy0aKLbhymNZPGs+ie3ZF0gsQNhpoRp1LNI6bBAgNVpCjzTtMKIaHcxZbyzFwYxyxRiZWGkDAgYYrmAzIOQZKem+Taz5PPc4yoU4Xt3i0mJ12dpJWGwAh3IEaSlDDnWTzcUitNywAMPdaY/p31QkaFPzXMsFAKB8YWSXgSC2zL0UkUM6RFHqUPOAyTihaT3o58O1NwAniZFPCR//uSxB2D1Y4K/AMU0ALqwd9AYyW4z0cMVKTUSP1NjzxKyJqAvDnKt6kmkBqoEQkZdnkrPdKVFIMbunlQN4OfHLBrgwzbejae3RwNJmFxZyjEJhsV2GgYxYHaT3y6UWBaw2kcfDFzT7ASDkpctKaFSjGtkdjThZph7J9P4g5JyiaCSJtAFDVEDzBie7mA4YhHlHEVE4JJCz9QYpZpSiZyIOyrAnxKTkJIEnYogLQhyY9A5R5wgvKYim22OubNSVbPeepwkk1GKO2Seyea7dTWlYncadKqi5NUhRsEse8zTGyQMYlUBEZdSBnrFlZ4jWi2rBSBhEQF5RUPkHYlJJ8kGtIGmstIQFBQjvLyRuJlGMPZnKXVbqShxh8H457nyVZVe1uLMakQtC4nksyURMlcI2Uk11LbYVXUKrJISKjRhy76Ec2OCQBwRB8udiILEpmT7rlLKJAhRr9lW/K5sSmJUcrmzhmDWk2Za+u8FFGrlWCiOXHEBQtsy6JplDBaT3sWWKxXS3CSSmN5Oatsqws7PKdCtkjkzF+S59ZbU62WNv1JNf/7ksQwgBcCCvwUxIAMSDqi5z9AAA+jaWfBWJyOvYjqBIyioohVnBR3WtCitx5Di69uMNNJeKRAQSuSUKcxTbcYLoUZyX1dt0Wob3sL2lOZ/UL0ZOypCRnSmQJFXTtdJElGEIoJJdNlZSajpAAAIIMIAAAAADAxAe4wjQDeMl1LjjO7gC4yAV8NMSEEDzBGQOEwJwBkMOPBVzBLwV8wW4JIMgrBHQMAcmAMgAZgHYJ6YHCAZmACBNJg6oDKAEAC2AG7JAKWRJRgGYnMh4Ay8DJgAUKjVIgM4LjE7izxOYLEwLAgtJDaxek2RQolw1L6RIBywbCJzFxAVAmJTHWTILFU003dYbWKWGiN8ZIZEPuxQOrLDs16ZJjiIKSZBidJcurc6aqMU6dalVk0TpWIsTpbIcSx8zVRuZFUz3Zab6pNE6WzYOLEPLxqfLyJ846IhKDgaPX3/XSz5ki6Rq6SLpIuky1qtdrNTZ3tX3auqtv/n0jIMm3Ay8Yaf7Xe1ZEEDBsA1cxQpRtMhhLVDFXQnowXkEcMA1AkyICJMB6AYzBaRjT/+5LEEgMZZY0WPfoAEwkxYwX9UboxqAPbMX3BaRoGGMB3ADTA6gLMwjgSSMB+AZDAbQDoKgAwjUDEAw0AFghiaOXy8TRiLUNckimgbmqi4gXygkaFwplBzGMkyZuT5XPnSsEIIBheZMbJDHma2SY6nUzJE2LepE0Kh7WgXziS2TWgcLjGCz9VqBdKz2aarl5zE8y5gmtGm291LKoCEwuArKWjbT7srv2rq+mtXUvqdtXoFxBGru/9/Ir9NAQGCPguRhaxlSajUKfGEGAgJgX4CcBgNAwHkBNMDMA1DCpyUswnROmMUsB/TCRwJswDYAKMA3AMDBKRXU7ogJsBUCzdlrljxuTzvLNDR27kDwY/d2cpt/blfMs8+fu5FIdxuxujq4WZTJw41R52e1JPSFAn01oFAnFnSNEvGMJgnTBNNk3dJCtFNOyUsO27JmBNmnpIIu56Z6RqgvME2e70jEDApSCpVum9aVlrqZA8/XQr71KZb2//qUTrlZD9af1dKgBFAKkIlYOJjzEjH3QKKYrAERgxgCmAgAEYAQHJgthRGYUk//uSxBGCFpmNIO89scM3sWWp1474obXuMpmnA2mOSCUYIwEpgGgdmDacAPAVoc3Plya0nRg2r3Uj+PGTyeetV0RiR0yNb2Cu64jw4926Np1eXE24KSiWxldU8N/h/e0d/XLojpoJpqxsjNSlhVcITNd3SDEokVMzrW61GLoJqoqRekuaqQVXo6vWmAiB1am7bNU6Dr09Ppsmv2ZtfX/1zI3UroX//6iAAARESCglmJXkHrzRmGwcGB4Jy4AA8QDWbTggfcH2bPnIDgzMFwAMIAAMcFpZYCQWHgFBQALCphr+TEf1TeAncrWK0PS9/IowOHlLyeI1R6wrG9bT9nmr39O8gq9sZFyqy6HSOgb58IEWMvitVcl7TP2yJDVkrhDtEh7pnefjXzuBml/6Q51ZBcH8Cu9f/FFexODnG04T0v3NsbXJkZGNqexwlSwr7XxTL+EyG+tE7NgxSFm4qWfdN01fcCr/AuI7JTL+OaUxcK/B/8cUTQAAAHnNtbJLKR1gHfz9egiaZBNKYtRmmp5wZKUPgAw3ET4YchRE49DitrlPpv/7ksQWgBuRZ1ms4e3jEyyqqa3TkuG5+xUlLbv4z1VzjKkbjG0w14RlhaANSKD7XgIBOkyhTaWFLjtxcduD8IC3adRTeOonlnKZbZGD3LmuHUBOKVpeLtemmiSpJNJ8OMBPEEAQA/CGEHOoJAPch5BFCZC5PM5G1jTEE9SlQ9NtEJwT7c4PNQWlkeu2S/gKxtNNLxID+Hm0u/WHPamssDyGx2PUF0CVVz+tIH3umrx3kRniP4ysiP/AcoMAwGxVWRIEzn6gQAJCbciknVjE7t72W51VWmZcgFyYKGUN5FiIAZgBxzkqQMxC5PZa7GaGKvrP7na1rvMt/NP85V/kqkVEzqBoyz5FZw0eUJkbpqtmak8OySjflHUmURyXzkuoZbWpcKbv/rLLWdWSQsGAR5wKGBq0nlZVC3Jepgz4whrUQa9N2Iap6WempRLqWW403bNBYyfe40kUVGTrb/7JjtLqBNECLZBR0g0QiGk8tE1quoyNjE1JonikViZLRNHzEzMiUsWW7FyP+xUAMAB2OAYYYsOcZlIYNgWyxCsQAGYUg2b/+5LEDAIXGbk2zuaPgy03ZUHtyji6MoAqZMJhuKOPGhVJgSMIwwMPUePZ0ZARNEKILHAVT5M6tS6/HGms5fmJS5G2WzNPGu1q/M6vunXqX5xr0ani5tn7+rfMdWrdACjZrOrpb76JsiZGIFTgHheiARMm5dHp2au2gpE6w1EHsik6iitFAvHzEwDrhyBqWjZik7IsjUuY65HkRdGZkykbBQCJOeTbeqz/6Vf26r/tt//+RxJ/qMCcFwwTkFzJ4G2MDgEUiA3RoEYHIsBUaPII5lro3GMoxQZP4WRgZAKmBGAeYcAOZhlmbmuWa8YZIPJgggniQtJgyAFBwDbNIHnI01Sihq1UjSh1NOTtFLZJ/LVSWsMiM5HqaJS6JCEQk9ec7Z/PdamWUNIUH2dYzWOP61f73mt1t0kFqKBUvOdri0bSJA66rZzL/4plOkYrWYiRDJqqdaKSkTyF3cugtpsyk1I/oLa1h9oWRY4kRwCcINev2tXZa/v/7ft///ykMJPpADAAUmBSBEYVQzJrFBFGDkASGAPFQAcwHAODB5BFMwAx//uSxBCDF9m7LM9qr4K4p6XN7tD4swVjazBNVQMcYKYwFQFR4BgwtQqjDEH/NtYgYwugAQQ4OwCN4ZR+YjMXo1qtVps6zN5BG4hVzxsdtZdc/dmplHa1p44phl9zuee7MlUAs6Qd3ro6SKNTGxqXgEAMDZArDSB7MyUK69DutGy1G5El7m6WpmqQTEQD9ZWc2Y8hu6zqTKprHSb00FJIkyF6xvO+h2pUavV//////+mW36UQSC5DABAPMHQeg0Mg2TBOAOCAG1QhcDYlBsNSfANWjMN5UQJ35FiPMIgOMUiRMbpcP1q7MfBcMKAuByJAYj0RG/g6/Yp7+HbFVYtPO08aW13TKo5p5A4WCwboE666jM0zZSxHJ5Fk7WezsnppLSKINQAHfDixGqi6XklvV1X41yu2unZUyXTYZ4HBjyS2MW/SU/UYm60LnVF4NtIOgdcuKiQCvDDSVelOsKi+z9oBzA0CbMB1oowOS1zAHB6HQMQMAQYFoNhhEARmL28+ZLaIhg/utmkkHiYG4FgQAUYYIMhirnAHjyVaEFNGf8n7Fv/7ksQgg5ptuSIvao9TOSfjhe5R8HvgGEDpfMha9DsGvJ2YiFReWV14bFe5Zq361t4qfO5FpZZtvtavucMXdbpGYYKPsgeWdRMkEHoH6jJZoZkYDUKB9LQ1y5PiyUDI+pA8taSlrZxIS4pFCSheMkl1XMVDPhq48gbJkyzoMtnJlys1TyepugkbpBbodyRtSVWyk0qaCrVb2VdmZ2s/poPqU1etX6s6wjCcC3McVlI9JyiTE/ByMHIDMwMQEAIByDgRDWmcYMB6C0yJLxzElGHMEYH4wKQlTGqCOMUdo04q33DEPErNLpU9wSTeQcMVgEmBiz5NDcFXn7qUEuSfltNlZpZDaklW9AUN6pqZfd21GYLl1+3KJJPSfW6unUs0hxlmvNrObMkVTQnjAcsEAADe/QywQ8xLQnJNjA+ZKW1RguiOkZFLmRoZFtqSkcsiBU1JLdn0nWZJFNWgpKrSUWSHmRsbrA4xReImzA3bbxKp+yjCtytFAELjAsAIMQMj84VRFDC1AVHgUC4wNBVMFwHUziwLTFaHUMOAtszSwQwEDAj/+5LEFgIUYU8kT2qOQqonJJnuzDjyYcoNhh7EInFgHcAiBDMWAh4bZKW6WjEozpE2MZxY1Fkc6M6jaWjVjFIlSSNS+gizIJoKVWmV6T2roVZ9a3RZZoXwDFBfSOSqg6WrVovMCp5meU63ZbozAnadBJ2+dYy1n1OyvOjwZsbslet1HAmyWo9slKsxiQyKF5gHg3GBuoyd5x0YRiyDAYLVmAgVmDY2na2Lmi85GtGwHgozGGgShUJjI4kTGS9jrLgzEgcjCwJjLkEAwwx4BBUiRK5qOszk4kiH7pqY2SRRUpaSSalEMMUD7sgzrRRWfsXmrrU620ndKp3dSAJ1JBNM0K1B2ahrvkcar51l1ruylmRbQdSkzta01Ocu1TVsfWxk7DqUBn3ME6VCwqOpbGH7VhqNUoX+hRkMHMKYxLmSzjUKYMNIHMwOwIgEAyCABzBRCiMj1gwxI0FQI0oYi4bxgIAcmBGBAUCRGJCNELnlmJiBGYFYNqCMwJwLBAAKuaAYlQmCaJ2pAou5c8sfe1zB4TjVG4qXTQRp+4ej0xiEG9yk//uSxDWCE/E3Hi8uc0JzoSQZ7sk49z7fX73TrQ1EPAf4i55JZozpH31qbXJR1KW5ir6qaS0M4p7exiijU9f+R7Db/2P/4V9ivuDAASmCeAMYqAWx02BBiQ7gYEEYCAAIXBSMBcD0w/UgTH8GuNy+AOXhIDheCgOmTQxGHuKmm+6GDIzmE4KmWQEjxkFADNWgain5iUXaKtRPHenct6qasdtVahmgyZcKR4mKklJOqyJkRJN1+tq9DZtyYAysiCZ1JNaCZsgkyP1HD9Wgv021uYqd0ZiYNRA5rMaMOp9pbrq5rUB2s/0KABCSQFzCZ5jggzzAwCGLgYCACApgGGhnAYxhGShiCSIc2qol6kQtGFwYnIQTg4aAsAjLlyy67xTpJGl4LekkYf62cjChaLaU44p98rKv6v4ysYTrRCydbaq1IsK+MyZvW9nkrmwRX8sd5WP9e9Y8DV3wdTfPDjKyCzsFX8ee6K+7CA7AFeCwivBAdhAh2Pp8+TFVDCFcoJwwTInBwAggAALz99pdbVSeST0IQAXhxZAhLV6zl6Wvz0seh//7ksRdgBONATBOvHHU8y/r/czrX6/pL9/hiMLmJSGDiuYKERpnJmyomPI412OzKK5MPlUyOEAwdGLiSYJCxjoAiocaMBAapWLB8mAQsIUKwgKhUZhCOMHCQxUGTEhYMTjMzSqxwUGQAeBQCg4gTXyBlmcgoBSwwZzrjCJzLPM/013DOyPwg9JBFCZbBlmiSgWEUdMkcve3J93Qjcll8kgSCZVJoCydV4GvvTLk81zLTSPQBs8SeBgaHwhFAgIFKHARogs8wNEVQcabGCLQGMoMA0EoqDjozaOQDCw9sACHuqyqMSxaiOiFZbdTdW9TMHB0v4g/0awnY5KJxgD5KZmGOGoNIoqTfRlDTKSH30vTtSLtzZ3CnQizSHNf9nbD5E4EmqXpuL425XT36mTK5DRWlsfVAAAADzcsEvimphcWBLnMMgIgAKiCmIKKpkDLDJgNT49gYUXBrkMP2jka3BREE1pvzGHWL8izmIxMvyDGmngZ5lz0F6550jiQt6+ipi70WikFNs6Kxm5sxZywtpymIElAr9rNC4QYWAOc11hqyGL/+5LENwIfZWc9rmNvQoAsJgHcwfijriBQxOVS1IlDEwFRAwC0CKT8y/NLdhl9XFx/K1a+3rmW8ccdVu2ZVRwSpioK4s6/JABsGfqHpU/1qtKV2Z2pdDTvS7NMoeH6kPfyghp/oahqGb1bK1jVlMZh7sZdmGbMaUOgZBoz+xM2EQMEoKurRQ0/0tubqY7hlyX5777EI0n1TxmyQDoaKgq///SKAMYbrqc7kwBg3EgERpMDwBMKh9N5bJMPyYM0PvNxQ1MTqQMxwMAwWFQjzFYmEOLhkTqEMna9e1adqHt4wHOLY5XQUpcfyx1D0SuUsZlsod6jf0LC61f3jzmuMlES4aZGYzhBpnSOvnvdnWW/56qqmMkW27p+taKli0k49qM4N4xRRRZFimIBM1Tf//qOkNUbgTRRzR//92ELDsNf/+/2KiAAAwJCowUn80IQQwICkQgIyAYEswZHE+CYYx2Tk1mHcnxYwu2IzUFYwXBUwWA42oE8DB4XsQudOAkS67Cx71WJxT3UAD2zK2AzSx1CrDxzrN/WEDiS9zxgXlLQKxkL//uSxC+DE4FjLE6+kRKjK+UJ7dG4JAzgkkDE+OYBpQInw+bnDJ9tVnUgRFFv5t6tBJh29lrLA00X+NUT5NaP/f/5xIsALjhxI//+sSseX///6DgQAwIwIDCUGzNNAJgwZAERoC4AACCoL4JABNE0wgxMxcDEuYmMzcNQwbzDjKuBiGACwrgHl4YBBGSDRkNA1JHp+mqR3LdmxcnKOnLIvLIY7Jr8sfC1Ju195416V14pQZaq49+glzMh4qi3mAvwM0hDfycNC+Z/sb0zhSHG6LOzIqNSpatVqhTB4fW9Mc5u7LNA31L/+pvW+pJExDoxspf/9BYroe///6YwEAMAkA8wlB+jUsDlMGYAQMASJQATAiA+MIUIszFl3zCeDuMKeAoxrg7DNkJD5oDjDUDzBkNTdceAcIaIYcAqgDVae32mq2rufaqysMiEBKWGpRPWZbbZ9aQnKaoyqa6zjuZGqI+wxQi5iPgE0AXKPHCii11VueWtSyaQQSoVsgY6ttQkRN9aDojZoqrrJQg9//X6rd5jMxCr9/1/qKBb/////6SBDv/7ksRTgBSZYyZPdouCSywl2ded+AAQEB0cgAxwNMkBZrrVhEFhg2QRgZqwUIM0rfQDqIYssCbsBCBgiCwwmOwiJ0sI8TFljPly5v1w93CepPEVa3GrM+cXm5n7KtyuC29aluTxLfX9Iidvr8czJe+sXzi/wZZLMrLdUedRdbqPEksjIi1er4a22fbbbfffMCzt/09z4jExZoAsU0WWwZaPNkvf/ooAABxgwcC0xziA/jNMxJA4MBV8QaIRg0BZwL1ZgCcxorp56kUpjjf5tYM4wAwGGE0SDVHAVwXI92hsUjEftVLGcp14+Nu2WGrYs2a/PpCn3Jmjm45/3a2MWXlFqtXpVn1ndrWtj/8/6V3NTLZas08edB5eFw/ic1iquclVtqDU6Io+Og2dCR5ySzTtNqqbPH8+oXHbdduc2mtRBRX8EBmQwFQw7xhzetDEMKkBMaBgBwBaBABAoGncUIYVBDZgTvSmMEJuYTyZpgvBTkwG4ACcCwNICASWWRABEQAz0tjfavLGrOFKotHQ6Et0kCl5fSdumKyH18ZXUoOlcrf/+5LEfgMToU8obr1vyn8sJAnmNpiCaftykY/ZRmCel1kXX6GkrWS9FSnopKNWrQWYLsGkljVO1lGtSlPrGTq//Uja7PVnB6qb1Muowd2XztqdqrreagSa2yQSIBhjtJ0qvBg2GIwBjADAkRxImT2N0jKcADVjazj0czJSszVUFTC4DDB8EDPcBA4I1jxF2nlMw5VFtcKZiYKTtGjcOy7t2+lh+uomoFJ25mQ//6l+cY6YK+/bnJiS2nCWBC/h956e9Mois9N+lJ7Oa5yWc0DIm51lOHW51TiPtv2qyWr79CJu23kACYAwUwhDDSU7NlIiwwlgWzAtAaEAB5gGAmmCWHKZ9SpZgwBOGModgaKIIRiIFamYKBgYEADxgDhBmC+EYCgJ0jxIAVWnFNxscoiaxFqOo2Z0yoPy4Zhg0sXDza2q4d388stluPujtW1ukTDh7FaEDAXO3n9bZ2/nG9AJTEPpSpREVSJSG4kih0MmO6Hp9Tvava/t29ort0ylbDC+u99Oj/+2nvRVEC8jAxAKMOIEE3PACSITQaA3AgA4iAgE//uSxKYDEdE5JG69UcKSpuOJ5iqgCScp+QZiC+bF3cc/iGYyDkcGhEYtAuYKjGYmBmXWTzVUUQf5ozYKeYfaIyyW5iqNXGgYKSmBfE0fEpehzjqKY6msm1xBDEzOAmnbfo6aAROePrMdc03a+oqCac3zq62PZm6LZKHI//8sHf8s9d4p0PRKxstCwBDtMZKoQ9QkxTEcDKMGMFswBAFDAXAFMBsS8zxFuzD+CaMNocszJw1DCdHZMiUO4wDQXDBeDBM6QRQMBVIHGgxUOvqH2dskkSXaOq1LMAQmQX2kCSm2lL7ubG5198K9qkg2ZkVmq50I19Nhjnl2am0sq9crNgFsZLpsrs7ImqkFGoDJIc6bmc+6l1K/Mm36HWtSehT3vs2rUvVUztUTh9JRNBkFxqBEMa4OIeIVuFUlIsSSd86lvU4b9COpAO/zBqDNMM9941xTXTCLCYMCwEMwEwJBgEchBaMEU9YwpQhTGXMPDj40UrTpYdEAhMZw41c9zBAELeBxeEge4Lqy57HCSQZa3tmfRExqqOk+Tbfa7jrVIegsiP/7ksTSg5GFNyBPdUXC9qbiCew18HoQKzn0eXu6oRShXXJIkIc5bULbd7eH+4h3xcbYq/r57vh823qXx8c8xX8/93W/99Nmm//aok1O8/ziDYqPpqnf5Pz13/0rQRB8wVwEbMQ3H2jfJQtEww8CUMEGARTAmwBIwGgBHMCzAVTDCSO0wEUEWMCzHYjBKANowIwAbMP1APjASgCowFEEyMWVBgTAuwAgwBMA5MArAITAHQAooACEqkn2gsRMAVAHGoySnSJF8AITIIyAPmgwU+ch0N7KeyWSq038vDFIA5I2aFWE/aqRpihJa/VzzRGlMt4raeFLvV76nzSoYDMu61tiuPy0hQlWOQSu/mtZiaRRy8ipzOVUFW3plRC1HG3eGl54Y4CajhmqhMrCJBjdadWfuv55hjj07KoeNO1Ozb/J31Nux3N271VMQU0JTAWgNQwncpNNOxEzDBxwO0wJQBaMBPAOzAKAFIwD8BUMMaFCjA0gTcwX0TsMOKAEDFJ0jb8SDIcXzE1SzfGGjCcQzAMARovRIRFRroSye5wWWNedF+L/+5LE9AMUcTcWT3FpS6c0IQX3jqkejzsQWiAzl1aGfc2dk8WkeT/0sLmLz/R9ikQvOXTFE1QNGFiJ0mTDZAZRQmRcZGtNSTKrYaAmqafdBFSupTtrQtQ7qWtWhTskpTo1GGm/n+uPcRsbL8lV/ecKzevPWbqf2EDHHkVf+bX/Z39FZV6/a+tdr/cjTQITcbZgkhcGCU7+Y3BnxgYBImASB4FAEwSBUYBgEhj5iLmBsKEYW5EpkCAbmA+HIYQIHAYDAFQPwMfAPAWhQAKMLFdgkrR1KYKFQwiZLqd1CIC1dir4ttutNqGdYM3K5Zn1lVustRM94OvuzmRdM29n5uA9JT+ipR2pnrXWnZSLoXf7JKWtVHqVdnrRrWpm11rmB2TQ0ith5wuQUFl2vKNF5ymlTEFNRTMuOTkuNVVVVVUCDBSQWQw5otbNpMEjDCmgPUwPEAyMCMAQzAXQBIwBwAMMSwB2zARwkUwKki5MJUAVTMiCDMEfzRE6TDU+jMSQzGsKg4CDF8AiYVlFGhGCgBo/M1C4EoJiICZNRrtHNo4hByTj//uSxPIDGcUTDC/1q8qOpuLN5jYwbcT9nfp1tbjQgPXrA/IS1vXcWkO0Oj+qkMdYfZbhyYv66x75v7ffo2kQ9ntqm8wcZ1qtqWtubNL5h5pfMy0QAWtq5MHaeJ+hySV22F6vwKzVdxMehIjHEXYqd9cm5VjUl2P/Pfth2gHOnBtnpnxhy39BTjkcMDsCUxUDbDqoGjMOwDgwOwFQMBoYCoHJgSARGJiG8YYQWZg3GEmLiDGYJwLRg1gMGCcCMLADmKyBoPA/oI1LIg3VeUyZgSnIgqz5ozZUoQzqlOm6yallAaotbXRntmoO3egtNi1LUa0BZrBTWsyte//np8V2rkz8E/aoVkS+fDqMTU5mViGZrWk8mt/O8h3P1/znfzyTfiO6Hg+1FdpLQj82pVVVlSHrowRA+TBSoMNIhHEwPAyhGC6IQIBwGcwMgYzCeAPMOsUIxag8DLvD0EQM5gAgMAIHIwQguTFGDAMAEAu2UAYpAt0bqnO6srQkMkjOD+COSztAqWtTiU8Tzuq+Dz6OI/UGs3ZR+1iFWqQWQSeNAYOFjf/7ksT4gxqo6wgv9esKpC1izeYOOVm6ZXq/ad/GzqO2z/fPae0bVszqEtak/TIhTO24axpCAeehiv8uZwzSRf/2ikxHmtQsz3hc38TPhKThA5cfVVbb/4lbocIDLGCTAw5hb5qcalOLFmELghRgXQCiYDuAmGAnAFpgJoC6YIOB2mADAMhgLI6kYJ2ApGCDAYhgQwCUYFUA/GBDAnhhnAImYAKAbJcGAQgBReNcw6ABpeJXumJMRknCVJywuStbRhJRFrZoSohMZP/LVCN9HRm8Y51wo0smqSTc9Ca5keRy91mxT1pjON+mJJWwpZ6x8VvNi1tYNVnbT4ebJqBDv2rDHxsrqhm3stqqv4f7mfJN15ysy81++0vyc/SIE+ZSVsjN21doZG+Ya5xz5mv7SLFqPwThyF1hCPX/OhhpzNPWdOH+LSVVUwKgABMKdCrzUCwZIwd0AvNDBIBKMxEIggDmHjqYJBp8M5HshcYxhwchTKqpMBxg36yQhtI2hBHEhUsUlJECYJULQV6HvEUcypYmERxxXKvT7yKXGGt0utP0Ner/+5LE/4MW7YMQTzB1Q6W0IQn3mnEUKiSDm+tO74wulh9p9glrnSt9X3nN8apq2bEOnv8/cD6tj61j6xbOsf41je/81t/nXhV5C6W+IUON5Y5p3+ZaLVDnckwTLhs+pnfqPJ7u6P/G9v5od97V8/33o//vskCZMB0TIxV8uzvtW4MPkQ8wQgeguByMgMGAWAKYB4nxhQA5GBKfuYIQPpgjgtkQhJgaATGBuG6Zi4Uhg7gLjoAI0A4hgw1xGvw+/ip1zqbw09brzM2opNzeDK3Zpaa69DOXFwlD91uzqzocnGPq4t7ygcLW9YB0tPMVP7/aGDCF2lZ+N3HmnojkozkIHhOWyWU7XPvHBlZAmcLQpwGnRnKg8ZKBIkJ3+ehFto5n7vDO7BjWkN3BdCruNH9TFDvqw/YF+OuwpsP0MFJCCDCtkk00tAfSMHwBgTAsQKgwGgBPMBRAZTABgAUyKuk1hRw880U9lI00KYs2xN8wDGkwpcU7eb4wfBNGYeLUHCSLAWKACpELABCxUEFMIHfqG7615CvAwIAR/CceF4fjx0g6//uSxPWDF5EDDE/x44shtKFJ5Y9JVJpOHc0d4IaQ7ST2oaHVSVY9Gp3TYAqvd2bwyaPSg1tXAGTzDzauImmNYstKrN2+n3tdfzdLst8xEq9RUsn5j5uN8RzbXxPERtrhnbqUl8e7bFMe5yvKrqvj7Q6ufmLp1Mp0d0i+66j2st0L03i96pxqiY9CvmI0nMDRAeDCygsM1R4CeMICAITApwAQIAsTAcKTEYJjEk0jNJDzRbMDlsajBY8za0mgEFpkgZhz0XZhUDhagaEIs2wR+QgBV8vwhznHNgdtgJj49mw2j6VIEwnqnTNNMqqxyQ4hDsSm4NbbxZ4G3mm0RD3UxH/F3xOF2x3HMNvir+v2fU7+Ou++F7MTcY53+++71sq/NNdx3O8wYW/WN9PgufNY0ExDVMX6f//H1rj8r1jMWsIdnDG6MAvBKzCYDTQ02oYNMGuBADAlwHEwEgAkBQAOYCGA9mEChHpgVgXgYFsLSGAdATBgJQG6YMKAZmAeAZpmGkH7XyYVDIGAIGLQYLkHAKA1AaOSkoDa6p7B3XCkcPUDO//7ksT5g9vZ6wQP9WfK1x/hQf6suZY1+C5i1jJ4nSS2kjsol8MRh56a9WqdqU/d5yVi09iHMg2EUYlsbNPCp1DoBCf0l2q/u9+04pKhoSnn+VXuZRPtZe/qKnHxNLt3FJH/bP1N1cVd3CTGOiHu+71ujJ6ifiOY5u34uH794HxELFr+OnS/dEb+eSOzJ+oGML4XcxM97DffYJMNERYwVAdwSBYAgKTBvAMMjQTYw+yqzCjNCMnQG4wOg1DHdAYBALBg+hAmMCFsJABLvFgKURF3t4m28jGi6jEZa9cBMyiV/BrTULr1sHqTxKVFMKp46fDxeW51XPtv9QtOaujHnp+v3/v6emZhqEkH3XapffnuecZiiw7md1bUqm5dSv8KkrkrxcVFq5bU585FU4c45Nl8P0LfZWlidvFJ+6GlU3z4eh8ucgUl9MltlMhU4moAJlKsYSwRJjwo9Hx+NWYrIKBloNmIwQHBSQnJVUbaUxmkhnzhoYX1BvsDBURhdNmdB+t1ubC2mxV9myxe+82Mw9JlC7zgeR9EclDcTBoIEeh4Oor/+5LE9YPbAgEGD/ENyvk7YQHmDtmmrVTQllzl0bTY9N4jm7zi1kpSulZZW/d7/But7PY/7qrm7q5c3i4nuJ+qbxHP88OqL9lXs289Ro3Nfx/t54ipt9uiZnexrLUZJIND4lBMR5OlCxXZ9FtajENCKDJgPAFsYVqTCmqriPxg9YGCYFcAeGAhgEpgBwBcYBuAimCHCKZg44S8YA8FVmCgAARiBwBhwUAwCJgABJk+D4cR6QCz04IcXkp+BqheR8GYW5DDLq3aZfUjgmcitqBJVELcDV5HQSHHJolXRbZAprHaoKRyo1FAUTijqi2tupc66ySPmvM79rZqpbKFRTaOTTavbNn2rHEXxa7K7qHnY4qH1pvYa2mdh0nl1VvOw47MLOOSfg6cqWVyflrV2KKV0elLXanmn8hoEBOxP/bkWq4wALJJorTKSyaNJ9VADCXGCMEDtcxA2hjAME1MBsIgCAfoCQKDyYBRyRiDEtmJbUmJASmPfYHJALGDYRGCxNmaoamDoFJFlx1PMTlqf7VokjZII3Puk8baWYyzGHpM+0nj//uQxPCCFc17Ds9xY8N2MWDJ/q15EWeyPWxNL0JRELgFrHwb11QHjltDAKJqU24f7n1YFtVffwnxMynonXVw8TMek+Xcvolz3UN18TTzzFNKPapafD89/0kL2u8RExdXUXQ26Ti+bXmluYR+UqlMRxuMl01DhzUGJGd3OTiUJgf4JUYVoT5mnnCBRg+wGeYFGAoGAsAEIKFoFIoY/MuYksQZrCqNCwZ9w0Tz6CQEC5wmBYxBwRvRE4YdBVIqgC/TpLWYc2svlY9E1o8AsICRoBJetI6yk68fEzEdhgTT5x6hmqjsYajRbZsFz55J9bbRYjU/UEMasfvdLHS63zxp8Me26mnqS1s7T1d+6/Ujri+n7tk9XbKtk3C192x251s7uZq9v99Rur99pVmZkcr6CvaWV38dJKGt31jZd5B6zuiHSDA3QFMw6odANwiDqzCpAJAwOkAxMCIADDAOwA0EACRCDbGAqgzZgtYbaYJmAtmB+hJoKHhTAXwJIwG4BtMGCAwAgAFdMwAgACRpfeGWNxpQ5WV04cpZCyBUklhuHZCT//uSxPCDV7m7Bi91CdsQsSDF/qy5yCFjqaFoxL6JN0JwtILS3m96JuGMaB9YSbEcR1Y+l8yY82b230TlH3q2z2oQyBzGSHJsWQKQkPnmCRMnoqwwi7HUPpjFirToVaChEU0BI0UYUxm6UqOW7bg72lE5UJHQkBPXREFVlBtqCQGhOsOTRSUb0hZHnbkZ44im5hzAluREoswCAYTA2SSMt4f8wIASgqGwoAiEAgAGhYumFBiYAoYKpY63TQwPGACYGDRmoDhAMWI0OF3R1COxw1rILID0O81LATCxM5ZMKbO2bIjuOpmpmUFiJ8+aWi2pIALnTaVzpMiXtq5ufj4kvp39W2+rj4ZVqTcccvpkNhkGi6rvfNTPr1y5txcezdW5nLjs3V8vhzrUtkIcGyOB6GyCYsRVZFQofJIQDBVAeMwyNCMNZBG/TCQQVowMQCrMA3ATjAQAHkwBsBtMAFC9jBDweQwnwI3CCCowC4PXMCUAKTAKgAwwDwBkMNzBey/BgEIAaDgEsSABnsgEcAA3LtkAAE60h9eINk6V2hJmGUiXFP/7ksT2AhuKDQIPsHcCnizi6e4sdTnBaZEazn91M5P5HjBBrH0u30R1iw2DKuZFYQ+nT2DC1f4Zp9Y+M+CZFp739IFr4xSBjfznhKpk4wmcY9TvKOTy5tNmpmX3IeRf7yYe9Ses9XznTmyjtdS0/Woa2RPQQDEI3I6Kf2kpmj275Up1Ktky0dIXSeQ80SvxDWi6tkmVCsOtuXlHVp2uSRLmfZhEAQmQmF2f+4WgGL3Hg3RoGYwFABQKCOYFwyphThNGDEUEYqYDhgdDemCCBUYCoBhgZgLmEaIgIgEVMyIEQeAIqCQbjwenaGeUKkTy+qJpbVvcaYybrmOZOY4/tDNJ3fLi/e7Bpbzd/8rltsV1QK/dzaX2Q7N3T/1q5uyr5uyInrSyEdUqVGdD5XuedrWTLfOtRmMoExF7eKuuHoQLnCdZaBwLP2mlNRUAKUiEP4xba+zxLT2MQMN0wSgTjAfAtMCIBAwZwNDCKEcMKMH8xITKjDoBSMIgScwTwJTBSApMEgA8yygIQgKQYAIRuW2rpRFyTZsgbG4fiMgJ9x2hRVP/+5LE+oNepgcAL7zVWqEw4UHmCjAzg4N07lZ8i4sF5uIztR0Zdxo1K4xjc5H2tDqXSNGzrObzVtgubqCb2Zp2Ih5wbMURoCDhOMivSTIkcjuTnZuLtqsiMxtSuTlCjJpOlCPMTkpCHBMZukgxJvVzJhKG1B1jIljHMmj0WtBnGoWsjuMnOiWKYeCY7eyYFAwsxODFouBOdxOww/A7zBVBmMBgCcwBQRjAiB5MbMRcwMAoDDLDSMUQAsAhtGHuA0YFIKpim4GKH2YCDAIAA8UyITNcZ601xHpcpzYEkFPEZqvGHBpKJ3M8pJW7JKXGvMbhukcOv8qtRXLLOrYjr7a7gxadanarMSwgeIJaxF3MRpo+MfSLQRATMTvU5opmpsGwqGKqEp3al1lE0i+Z6f1YqbcJJuhc9YCRm/KSM6wjLLnRDTSGX5ZxuyXhObs123Jz8SpKCZIKMDBAiDCfA8s0s4E4MHMAJzJcGDD4DTBcFh0DTo4WjDQKDIAbDYgXzARdDB0IjGwLxCHJ2KAZgqA4XAduaty0Y4u1scAgRAAAXIjB//uSxPICGdndBq88cYsmwGDJ7g25gFYoBgCTkMO4t1GCtMcKDwWUtZvpRMhrYiCaibpl5Ud1tTNMLXzA77obLUroVfVQ2yVxpPM7vMQU6QkxSytW3XC1NNX3FPVzxQxuVvmV7r4+J9amVue8bLjC7Cpiy0VBME0Dqc30u+HrqY8zsRgmURMC8LExxofD6GPpMT4KgwZQMTA0AkCAVwuB8YwpLxh6grmAGJIYygGoiEsMJIB4BBHmBWF+FxDh0A9B8aBVFgHW/ksNtngiBGTTc/YFEfHxi0OZoUUx6Xj1GytW3cM1gXuOwHyukD/QLzvp7kK6+bTdvpcw0cWYJXK/A+4kLIX3hVqdIiKUOZRVBBjcgYcQasIMhWgk9JexIkcZ1I/GvxCnG5AuYLfVoymWLJRZkfaEEvKEnfqvlctxB5LwOMJKeHJOGuv7ic8wtBgTDr54NY1k8wmRMDAmBlMBMDwDAKAQHw1I50wsJUxfNszeE8ylNI0CBUSHwwIQg9qAMxWAIGAoxIVAFRqDVK5iUwFTQ5Jaz0P1bjMazoIQ9LHqP//7ksTsAxchlwYP9QPLI7QgyeYOoSzw7gXLsOjxsoxljKGoAQuFHDxzq6cRcsMka7jQ+s0jihjLnfDefaOX5qcQ1NNo4+B2TFTNJUVB0XB5Raq1Wu/2a7VY+h6zENbksMa7Gs6yP66o9hqRNPJvuOESO5YwbSVDInEw7Wt1rNLdcIlyeK3CySfVjHlakfI6BgXAF2YRSMSGgRhMZgxoDUYDkAZgYBiDgxMIQ6Ms0MMTjaMBZHMWAlMUSzBzmmLYPmGqcGK6PmAYCFxBoYysG1cydyZHim/DUOUU4IwQhsBgKhYk8XP7KGrQrlknA0KjRSzX4cIeqLEzddSjvffEwoiUt7ukE2ft9Xxfc9Q/99R7TdPp3RVcVtvbStX6crPLRNVVj7n+utZta5ZaSm9ujo66vndo17enZOy6TedqnGWZpSeKZbH2i/ZJfnVADAbAGwwj0aXNGfDJjBkwHEwH4AmDAGswKBkEiYaCFgaTluI4bNPSrMBHBMgA/MTgkMQw4PbwcDCSMAQTEAAoEIjGm4wNFY44UpfjMVBdINgUmxYihcP/+5LE8YNZ+gcCD3UHyu85oMX+oLmBwgB5yJ3gUckciwNoTSg9jdroYzlzd1Uwq+8B0IcLcJLysxbNpP5Q7WptHRosZa3rerdxff3E2KI7RXEXU1EJOuvNmIfDTS3HKQfKRNTumTojOlW0kPY9ndJqaG9xHZaybV2N5nHL2fcpbzKXEW0znLo/ZDBxFSMCnUM0HV2jAnELMBRiHQ9IApEAeGYIQgYPTKQujkcXzA6FxY/jCUAjDBtTG9mjA4Mw4ByIkCYRE+m0aVOSIFAoWIoLjiTwUgGExoscHklsNMDkYEIoMEEOD3ciXy2RrHUJpnYpamoVLWiIeBbdLhaUdVUltwdVmCssUQ0urmVy8L59rA52ux1RMWKwhPjWmVo5F4P5v7HPcktVLc3vakoat9WzzE+lXCzXL3SaHa7Hy00xSNBAzSZkWh1ud6k5DORlW1psNZswN8EcMJMJwzQ0hAQwaQDNMB5ANDAMABcwFCQIJgw+aswTX4yPoI2HA4wwc8zXAow8AYxuEMD8YBjgAgOIvIIXaglnLWouxao/3xEGjsDg//uSxPIDWU4DBC/1BcsqwSBF7qB5OiWhFOQRkcLC9JJxZ4gmQ4pUxPz1AyJmkqxuOeafmUPT6elhYuaobqMkZN2OdJH1ixCULisOWt1fI4zW+ZhSbqht3Q7mkWequr6SE6iuqhxkDy7S5huXPqnWbbX+5jipx5LQv73Y3WaGoQOgcOrRbmdO7V4VVWZfodRIDAiZhIAaIaL4DemDRAFxgSIAGAgGAwBkAOMA1ATjIttjOsxwRPAgDAw2LE0xAswHCcwTUIxkXUwSBwtILDkTBVCJO+sVkLkzUiuxp9JTqGne6gCjhzA1ycQgUEbPtRBRI5QoEGyl1iGwmARZkRrndSyNSnpkmOHEuCYM5QHzSm+SIoxism7PL3NbCNqf/CiPTzYuugm9rQtVlklBasZm9aQlhmZ4Q67O9IvIiJadcyC4HAkWSKRh0Ze62MJEKiAMCgRUw/rgjlMUlMLAOwwMQazAEAeEIGimBk/UJpsHJnGagdgBgwLhq+B5gYBpiiFx6GJAGHMAg6pqmlAPW3i91n0gzp39giGInm6l0VHknGSWPP/7ksTuA9k6CQIP9QXK9cEggf6M+aUFggOHAqKYgwcI1m1yo6LocHS3Uab225V2O5qbuWXYmxAqrReiFXZom0ualZRYLU/8meDVeJkaNmyXe8eixdra3Ka2rMyXSTRI0wlJe8q5tSlHSx9Q72oydzjZQ+0sYhEu1jN25GQ6NlSOiVGkDNSi6Q+p04UyqMML4SUxtakDw7R3MTUN4xYG0wlCQCAQHBcaISwZFhcYZ0ubMCWI2sFqXMExKMCV1MOUKCoPoXjQwlAWS9+H/ylQNAKHnJAjmmHB7IiuNERxo8Vig6HiYRDWD6ZGGNTQNWWtQlWku3nSL0FJhhhMmo9XnS/rSQeTPVn2lSt8wOgmJmLl46Xqod1nq61n5c6Id1yGR5pK0Vy+VbLFkmqPhtrhPXbR7hWLdTx8wyo1vMKqMMmrQ2800yF3t745FCXQVr5EU1UwKwBRMJ1BTDSsQAQwcEAKIgS0eAfzBgAwgZjaVlTGQ4TGR2zIAKzD90DEMIDAwIyJIRtUTD4Ai5DpJUvdI5XY90XWiWcTYRkcRTBBEEffQxH/+5LE8INZkfUCL3UHywq+YEHuoHlOEccgnGB+bcysQKJQghqiFhrneDGlJeNG55ITOXHPEFHohyJBXQ65ZoJxrmVCM7DYWjotutFX1OJpLjepmRlHt1krbTbzU7vav/HcJXb3UTo4we42FRR9pfw3Pbq73d8PNXY+2kyVikqRtDBl08WiWNgUGAMHkY1tV58HptGJuGaYLwLBgSgVg4DQwOAETIuEoMPIQwLQkwCcjBbiEiyYxHhBVDQkFMKBIsoGE4oFzFKZj1umS8hqrcg65PWo9DNgkYjT24Ox0Yzhxhz3xiYZoo6TH5TzT2fOt/25fMpjWhn3I+9WM2TDtZaWZa8qWjLOGbjXWfbi5PI9olk2aNuJ7zZdd7zUdnas9+nLY1NlfTdQaikcK05LLlJWzcnWZk7blLqlbGOznZhniqV7Y9U36lE7shGPJTHH7aGmlXIwlRGjEOqfN1BJIwwA3THJIMPCUwaFCYuHP58VtkxgaAcawEegclDEh3MSpg/GHQcPxUBlq0foJCcGx7g4WCsg8wRLGMScKNQ+JTp4MOGC//uSxO8D2IYDAg/1BcsqQSAB7hkw70PgajDCVHAygzS2GOdmTdKqXI9xR9FGGwt414Z3q+XSl3mVGL6DtnTUbmTyZUE9VBAxyIeTPRKtJFpr7XgcsERvQ1Fteb+kPIYtkHpD8UtcElEGqrVuhBfCDJ4WmZomHUqJeitUNkfApVMwCMcHmBXgSBhGgjmaE8DMGDJAHZgPoBAUAOph8OA4Jmf26agCpllZnNwaYNZZooOmJRMYCWZx9kGIwSXLFhCRACF3IndrtClUbq0qA0MEgWPIhxNNls1PDjXIZphpv2Gh9Z6KSqvNIlM5tRa8heShsyNldTdnKtzNZlFncwxSqunxxlQ0K11NEQ4osVdVD2k3RaURdD2moXihhekbprm3MdW0j3GmIXcFVw0p15bCajxiaypCMUXNXeRV0OpFdDBlsNG+PTlD5qI9ljBJCdMfh/Q/4jtTFqCgMG0EUwIAEjAYDMlm0z0FxEBzOS4OqioxM5TOpPMRA8wMfz2xuL8I8BwEQGy5/aeRSxvIKzu5sJkGAWuWF/mp06GXe0pWJmWeKP/7ksTuA9fF8QIPcQOLGr9gQf4gubY3LeTDzkmop2pT5zLnkCwjTWMztamZPs3bTtt+mXMbKd3uwyX1HNrDk/V4htV58fqekW687oGIdakGuJyUbh5aXQ8pTRu52k58Wl5h92SMT29HJcpsCfB+F2W573OZGkaQxZNcLkty7vWfuVR+4pswehKTBrt6MfVQMwQw9DB4ZTA0MBAE5gGDxncvQgF0xYkgyLEYWOU0hBgMA4wsKY0yIkDBoXACASRrdyNu3F7QCQBTRGHQPHWIJggjBWlQILvPctDhBcWrHFHk2xF2w2iYNqxlDeKvkvmAhRNJLUZcIPVkNoqEHQnFOepkjCEayni9HsbT5O8UVVuLFUJpdkEa80tstEKlLlR1jJZmYumIyDGhGe7qyGJkcS5aNKSVBnC000LtFqNfIVFhkV3RJcelnHj4gfElVQyrS6Q6ajC+DVMiNyI/5S2TGJCIMIICUwSwCjAeAODAKj6qzCq0Nv+44YZjCM4A1GMOCEwqxDg5TBoAdMOAaI0y+nK0cgmllNvOvneisipynE2cKKP/+5LE8gPY4gcAD3DFyzVBYAHuoHism65KLBHX6mLTdzH5ZbvHxUKMLbl+yVbB6NI6tpeIyLbtH/d5IXEIiyVUVNe7282jKK1JbPVOR9ItdmO7AWFz5QvXY+TjnO7mpwfUQbUCWhN2q2x/WUaxrkob4QhmZaT9qkxe5Dp6YgcyyJmxUOUaY2xNlYdqNVTkdO7IQYLgGhjpoynzWREYpoJJmIVGKwiYWFxgUXnRC6Y1aZgN8nkAUYFogckhYYmKzKc7Iic6c6zWcU5ISFAenF0jK0CkBzLLWzb4pPS5SmqV9ureoXl3zt9GdsmsW900NWKa4jXr9fr3M23vMytatc/X3f7Kzf8TQS3zvjLrKKpm7Zp5v1HzTmZfr4nj4+5S2h0D79zrzh5e3Rm9vL85218ik3WgWu3h7/lkVeI1CrQZ/z11fRuNzD+RgsUQDBDD+MGulE1LUkDBNDLBAKxVAhBIFRgYAbGQbEGQwfGXNFmdwamAbeGQwrGD4DChUmSwxAYAWdFAEFAC7mqeTcciHZrtyPTX4z1laFVmnwYtRuyfXJ0S//uSxO4D2XYNAA9wx8LgQCBB7hhxUTQVY0ECDUxVhd2v0zszmtSFQXMEEej93Tm8dNaDy9uQPMPzO23r6z7eav6blxl7twdXfWW9kNaFU87S4Q0x6IU8YhyyC+ppLNpGGa1JMQL6yp7tMYjAN99Eo6G2y8WTZy4MuiKfncs0KQinl2+cy4K8tDJJAYR4Yxi7OfnWsX8YhgQ5gmgbGAwAGBgHgIBKY7xaYhoMZGSaZ2gqF0EM2gTTYGgwNKgVBwcJyNaeuYkMQhdq7P7v08/K90USqfblHLJnpWN7CURRDoL90XCqIs8O/iUsfWnUP05qSk0Xfo5uZNRno4uiDL3u6W89M+Xmm18x65ZaR5xaT/VVLZubM3Wey8yXMNThE8+vvvcF+XtWNLE8iWbchpfEq9PSFflM3Qghu47WhBvwzTHZH1pT6j2hsdu9rzLxVej9GAADCDAGMg4cY/9hGTF6AgARzgYVDA8H1FTRqjjIlNRpeDcsDzCcEAVNhEQZhGWAhHdTCGCIClXSaSS6tKhcFRrQOiyG3FRMQMnOMDwOQkEER//7ksTyg1mN9QAvdMfLGsGgSe6Y+BQNMH3byPi2Y9SBmGO7isfm9xaFHMHTwNo9XZXdqSi0+BHd2abLqaKd5mJepJWB8nNezowxhAQxLdBU6BjNpaTU2cPZ0MYWQ0qZge8a3xOMkRqQ8eZkvdZjj0pjLnVlaTVuTlWSbQbN2y0PR8UGw8dHoVElIrOxgCBkmHlGEcUB9phUBZGA2CCBAGhUAswFgPTIRETC4hRivyHbwUAH2GX0FEgwCDRMrBgjLrwS+0zOwxG8JPJLPZ2nmcoGeek5Av/T9NHl4lrHKk4pkAJRwUHQxmkeqNxJqPQ3mPPviP8jDTkkdULxmlRpayveT9bXIY+poOrZfZvXc/WS/udzvZBdGc2EC4my7vddaaXnLgq90xVJYibu1WIGrcvbJxqrto+XmhlwUR153NTSahpaGdi7bKUQYmnOFeeVT9UZBqZRbyL4DCKDpMS+K44hTrzDXCkMDoD8wJQGCyJg+gOmRwM6EAMGA+WcIQQCDhDxUKFxjNaY7GIT2nhwgiRJ7k7n2G4Yu2dTFepOwmlNKAj/+5LE74NZAfEAT3UDyy7BIAXuGTHyiqNMQLfMJhsJkTKTo61H5YGDHhKLkDm3BT/HrsuivdI3U4yfdE9jUdu3s/W2tmogs3724RcF65TW97NlHQlGV8VMWaye4cnyrQ2vrSo6KiT8vc6BK5nlfz9hnVNujuUxxHCbQhqSbP2q8qNSXTVa/uWS3M3UTT2Nhrfc0CC6NEMHQEUxqx6DzhB7MS0AYmZAcSjAABMLkg7L1jBAzNH4YPAoVQ4jEoMAJlIanUA8PDheDSHBlQEQSxE42ZJJdVzEmRG4ZRemyQOAf6SO7iEHPqsx91Npeqz4ZscvamtqrxfqLX1FzM69Y/f0t11iVsS/17jPn2a2N82fm+pT12i9+POXnw3N9P7XdyVSLtVtbpot5qb2SFs1nRkSnm/05l67RWsVc54RrHfHnZ/9vBB38VeFIFkqKkAMBII4xQ27TqjMoMOcH8wNAMDAJARMAYDAwEASyr/zH6gMNLQ50CjBACAzDCgqAh6NNHcFBRYg0CkY5ZSXc60ns2eTc5T2exDwIgPIlkEAiBbxNGof//uSxOwDWV4DAC9sy0rZwCBF7hhx7qMaBURJ7N6eW5BdQz5rZ73zZUzl1+gkamz2TcD4O6sWx64dt6WJtOMUddwHra2fT5Eruv9VkmM2HvV7hVS+bL+YPsuDO960JElF9mmeYRrM6+zhj6ZAr7SEI3ux4MRLStzGN3HnHzJZ+x1kU+zbDQcsJlGgwZw2jCkiHNGQ6wwbgqTCo+AghEI6MCjc4QpDHRXM/vMPXBg8NGMQEYLIJgU6HESCJAZqqV6vqJihGSiRYVLCay4s48WdxFkxTAgkaJzBMHrCAwmFxHE83AmACCKQ5G7ZTuK11cOxHlChZj7Io5ldT0ujFqVvg+EoUPbi4NIlqEpQvN3CsQU5j41as63PF9BwwlpEViySWeZQ0+7g10ezsmiIUecw2xcu1sa9GowvXZBsDXRZshj4XdTGc8xz7MuEGUp6qLpTdbtW0Lrj6jCHB+Ma5D08yBljEwBDMrhIxMBzDIWMXDYxG7DNKSMO2018JR5HgoghQaGK0OchJwOBaY6MLBJnCYkfQwDHESiHk4BfYujsKaGLm//7ksTxg1kyAwAvcMfLN0EgCe4gcKM7MUmRuYc/oZlvhjy+6rqdCU3JSkhsJ57mNnXLgxNlS9tuViG0a/yrOQ3aK13Re9nU9qeVjbGbBqFRqKN+FnTzNgwyZyo+41XF0dTttEvOu3Leje/Dw0bHgosnESMjvP1hG1q3dXOsvF8Snm2ouKNlkEi7LDA3BRMWxOg7liSzEEBWMEMAswEAAjBoCHgsaV0Zj4UmKOaYHCZgQdGBQWISeYeUJvpCA4SxASBiEM/OyLDk5DV/t/MWQuSQolR4pCDCRJkKCAZ7RQNMV+cZr7b3RXfCLJIblLfE7UtfvDoa2/o5OEbKHNNeUjYydamR8oTV0r3cbTtaKO3NF2+5tPdXR/dbVhqe0kkVV1j4ou8q+UzzqOUvHKjwmXLtdpblCEpnmPFR2tfr1aMNi0lMF9oGuxU+6VDLfZQojs8wDBADBMAN+wxGjdRGEwDAOyUBYZCI8ADeFoJSoFqqJXcwAZhEAgAODBQ8OjHsDCRGwrAa934n61JyHq35440JQdeFyooyMCLsjyIlBOEV7l7/+5LE7ANX7f8AD3DDyx5BYAXuGLnCNkyfTqYt6xEqur4ZmWVM1S8k3W0jeRiFW6KKUKNXrt3h0l68TTfbjV6ghjeKvGUYvWPRVh+qerrCj33cLObauHwVarx3z+Ny5IIuVlHES3SMWjrU+9NaOc8yK1DSyl+DrwCMg/ZPs/3emf7RpZTImpsAEAA3JbCiSjBgIzGt2D58szEcEAMCKPyE0MAww3BkwRAMBBCGEEDAmb0YAkdBgxHA2Hoit9e1L8gwgVXWgoQzYBxyARwYRWRKFWzR96ZxYSUY6Za1C/AxVnvbec2V/7eb7OZTHqKPMgysxqh+ho2bU9HZjAUTU778ZiRUVVtFuXNrddfWTd0iPQMc+paGgPlM0TiUGJKOme2cnRz//DcW+lFr+IbMGmnS9nT69RntpqVgDBsAWMfE5k/Mx0jFjA9M3AoDHcw8DDE4COfbc2oUBHmDQYSC6cM3BIweNDCprOymwwKAUTxIGqWb7a8p0wlpZPbe4o9/EBEIlWHJJIIjYlYg3JnVEkcsw8glC1vbeS1SZlPUT1yuYbnB//uSxO8AGGYJAC9wxcLBtGI11JokV8qtE4pcxpYmmguoxQolnnIsU0yRQhDYZb4FlMRTvfJyeL3iaOSauLyikfZOSScRNqoU5QpGjnrEZPNJobabbmoafPFXXOCJicqepVTjrbLD5YpSNjIHVEyp0+9bUkjs2mGGLk3rDUlEdrRijqUGbTIrXgxAwHQujCBf3NWk4YwWQnTBALjAEDRECRg2BRljMRk2EhhGqBiUEQkCgcohKD5gQOZkMDScslVpRZl4GSIOBS4ZBFakYRDTBvP1LVEoWEEKrtWUhDrMoqi6vaREmK8+6KrGdZm0xkGFU8SVlQU55yaLmyaxmGMyomtEio7X4OoEKMRRWe826YKOVCRCkyjOecyBbxBpT6iSLFcti7JaRjqu6T08jCsS9JFaCfkH8wTVLRBIto92RIN/vlBPwQe9MYFdAatOk7xoSEndkOSSbTBpCeMQpg031igjC8BzMXiwwYFwKEBEJzK+1MDDUxqDTPACMVl0BR0wmCAALRLYJiOA+0N0szen7oTsQuVczZiB2hkDqFqLD5h8wP/7ksT7g1vaDPwvcSODNEEfwe6YcftZk9ZoeWtWoy2GEIaPrnL5VhaTB6qMq6FZHoK1yq5wvD7sQbLl5TLmyPhepHKPsxjTCeznhXLTsmbGpJRqrNmmpCtFVOl1FnSlJ/Ynt+pyTVILMzizrHc+bEIetOULUMd9UNjNPmKspB3RNFxZjJLHyc0IZUhg0gOGNABMeVwNJQSaDlkLEkHBcLiQ4kVDIQzMqzEysBTJcFMMC1uYoTiAtsqfhLNqU6RFmSUvLJuFc2XSky25DHNe2lWsJG6buDcLlqNys0t2basYvmn4XKSHMSu2oWsGydbXIVY2ujyoI6UkpKU1k0tRtv1+S07SPJyulJPTm1UdzYd8EvbTVwThVRnTF1XW8Za0fXjLGrbSpZJJWaRxB+1eVs/FO7e90Ow1qjrtCkjl6tC9nJp5OexSVcstCOFYpOzF4daHjivRsCAJQeTC+XGNsYpcwhAaDEIpAAIBIVMKB85CyjBJgM2KMWYYWiYQp2eg4JgazEQHbnFYhmCHAM0yhyb27sjz1a0NKwhJTs2nkyc/cn7/+5LE7APYHgcAD3EDyyxAn8HuJHFirWMtetqSBnOpZqovLpZbnTbNtf3sl/NzUFFuRXJ3jEvCTQZqBHmlmwkazkk9m0ZuNbbg7EYpklzWUlWHnNp7e26Ksc9p7pt5MzkDy9Sd9YrpmySrD/p5SEvWNKOYd/vtDXM1yE1rYZj26AunIp5iJaQkwYgtTDJcQNbswEwiQgjEw1MBhACA8w2IzM1vASzMRCgeqRlBXg69iILEBbABKaS46rGO5+tJCGwLJ06FDkYB5Q3dX199cgl6Nv/SaGhar/a+QJ6xtIqKi0DILOhLKAlw1tlUxz+q+oQCw5Z96tz3lApGV1FtWOkgyGmSgTyTckp1Ock8JesPwK1C3UUS6tPjSnNVGWozUDzznwpy0DEFbb2mEBrrGo9JiUqYGsoxvokt3wlXk5CgYRp2IOx2wTVaDpwFlkS0VvUQDBsBNMXsno7cQzTENAcMFIAMDAfGCAOl0aepgiSZjVmByqMIHY2OClmDgOIuwjCtCmfG1XpN00GRerbslJn01Zadtj3pT6iXdF1YJo42iiKi//uSxOyDV9oFAC9ww4sewZ/B7hhwdA0dacbOImUPhNPazpvSCd50tZgPwo3XdRmbUWqcKPJ5pzQRpMsfIgtbhWESsir8VSjLxBDYkhcFtQlE1XEmTfExO/mynzy0ni/OonkSGJaaiY7dFVJUdSyKLWa7Xi+6dtolWemPh9MhWarLXjFDiAjWSD3KmbMBYFwxE1CzkJJMMMEFkxUDjB4JQGFUCGpamYLWQJFxEZzGEMNKgwuOVS4YhN6g0gKAG0Kzag6DKysU8IMdc0zvUY6QGaeXqY5ngwiSLenxGqbkrIn6RSLbZzpkkpR2HHLJU1DsOL5hyOQdmJFbEQ0qtEt2g1F+QXjFXZtzZ6ypNW56F3jwfJTPXYgQMQbHY0nq7otkOiTAopKO0nag6xDP9ezITebZWi3vWc8wtinghZq0eWtR1UXfznIIL1HEyaJT2zou5CEwDBFCmMFJs0yNi7jAwCDEIuFAik8AgOZ+CBiFfjgNMJgYwDFgsIAQDQKAjbYMGg+yttYIrm46sVJYZzc5yW3GWNxfHkuCOYnSksKAXYYxfP/7ksTvg1kSCP4vcMXLGUGfwe4YcEJOlFVUhk5q4SxtONtpxyaW5N8zircF15vrJoE8Ta1IXlN2PVdVPlvkqhk3JnN2Url2GmkEffkeyOT2TtnC155eKN2wkul4tTnK5zvVjLbiZW54pWMpW32Gl1e0pGCNKPO+SCSq8WK20FN2lksP3FafmiYlGa9RnqWXB8U4mpQxlmRgzg1GKIe6c3wvhhzAgmjggKNUBwkagRsN2SguwAoaMnqAF8swEJKZooMBoE2GoWlKWkJI2aIrMY3o6fRac1I9BqPJW1GFHb7StMnN1YPCbGbDyk7rpHGSfdNPImg59QRyG1/KD0RktlFkCaMUeQuanNerMmXz27+BhRo5gdviMDZkpm8HK4x4hgfFkcZMobuyydGmQWYRs3EeG3NvW3wQUh9NA72XLewiH8aSsvfkzKSzZSoeYcfKT6cfpSNKwqpmFTAnAhMQIu44WhYTC0AmMpCwggSjIQY0dEPBlDNLYygQMLNQWMIDzEAI6gVT4fSBof1qdZVHzpaq6eeXu8lF1fcpNr9PJ6K8tyr/+5DE7oNaPgz+L3EjgwXAn8HtmHHZyZeF3LXO7hetGa24nn1sq9282uafi+01tx3x7Y29bGncQydjFQ0QSy+soutye4vlE6Qk41k80nTckWfmTr3EKyTFeXpcv2zWlFi87VUw0sw4t+Rm7FMyNS24YjGkaWVia35kWUXp8N62ulOYFgVJgNOIGUUYuYBgQRIBWOADMQMAUAAADWmDUIGFeIB3oruk5IDhAVYDT0VSqyt9i1LQ0tFSY59zncJVuk1qZu0EkpK26gwxHD/DoaR1CMkpK08qEjJ9s7sJndIQdZRSZM6xpHgaa0mktZxEREakWooZ0jAGRZl4W/KTQcmm7z1IueP9hOHPGSeSC6DEd3lnUopP7CelAvNkL9QRYUHCyhgEHuNMMSOJJVB8v4k6ciCxYIfYGfRGI6SbYWYyW8yGTugzy92QURJokYvopGv0CcpuMFoHkxA0pjfBHjMLcEYxgIzA4CThMFhIzR3jApiMhlEBXkwOxRAEw4FuWHXpCNrcM0Fp8vrWYgMiHLK0eaBCT1UDIlkWwy1vssNSXhj/+5LE6oPWpgcAD2zDi0tBn4HtmThSO4hKlGc42JotAHxyqc5B/CdqJY5kVDa1HyyNIusD7qW6iylFsSUTOqIT3RcsWc1JFUYsUdWjiCd5Gm1T7MX81rpZSElPDJdLCRE9VwR07dc4kjuY6HRiQKGtKc8GuRgOB9l0fjnF05sVaG84hiY/0oLa0C4W+Vrl6QhMDIYgYqpwfhZGFqAKVgVEwB6tKYphXifmCuAaYY9mlBYpCgKjMGAgSWiE0a3F2OPlTUVSn/lvCkz7b1Xt2qtPSZSvUZiaCB88kVy74owkgbh/NJFOYWa8aUUg+IVsvpXS8TD25KvJ9WGz7tSju9zpaKepMOn50att8KRfD1lI08qkq5uUUi4KBTCpXzfeMVN7uRR7u0UkVsvaEK2dVkGXr8tmhpPPqsc5izbdJi/B07rhR3swofGIrOo7EnP0ueRxqknw+gAkAYAIORg4qqmkaS0YJoL5hQ0OhagCXx9TgbQCmBWIJJTChkeugCFpMEbynw/lalmEEAP9KC1T4ikfM0meXbBRAlbizCYWUZF70ZJ1//uSxO0DWNYM/g9ww4MXwSAJ7Zk5+RaicQz66LczUCFhEQmjZpxi1oakHMJW5Mg4fGMQSzvlI+USjUTM3O048xElktl9ayRdxU5lQo7rO10DUILuH6DZlhXQX6hBimSZVGrLOd8XMFPoEekb15sEspzKe8hboTUJTGp8+Do9Ec3xqDJYzpeIW1Jglg+GFwn+axhChg/AsmQhwKEUIzDAM9tsNdMjDZM3EDACELWwKFBgyCx20iypy1KiYDUIFjdslJtxaSD/1OFlojyzkcLQXG7ETTFaShNpY0PSTO/WvETqdNkizGVll9AqcEEzGTgKs/lQbybXZhmUusRcy/kNyW9j8k/4XCKGxtZsHTdHyt37PHst0qeNF7Oc98gjrEUTFOapy1Y6c6+7wJbf9ogGIOI0uF7M0gcY4QBSYfyaGcs3U5L9EiGsXSZWIjBRAiMUQOM6AABgEOKPP4YWo1hACddmmXEpjUOceBmFPgOihUHJgMNlkB8NwdOVShR9FOFxPBZIkmCe6HJkXtG7k0ooswrBBxIzziyaIi6klCKPLD4BpP/7ksTtAlgeBv6vbMODB8Ffwe2YcMmtEKQuK3ludCI1IUB4T1PseGXAs04NLYBHpkjSB8JC6QyjEEGQpeKYwkk0nwekx5nF8D3ZOAliufBMugyQ00KRJ3Zn0gYo84iYCXuEU168FZVqJnq8k0+PwCll8wLOQDwLbkZQIPRgs80FMLdMuJ5xxdZZc0QBZQgGgvmGEnQbYRGphEAoGQjpggQFw0ZBDEcw00mM+WBr6AjgPBQECCqdmWIUMwMt1zb9yBkTvj9YFNyHTKh3nQnDCBDQGcjwhKaiLdiXZzAKxWG7EXUqHKgFKUmh2P9ZiC6xZqZKM662z4oJv4wMf+MrPSAfmDGp6wiRkMhjEh8wg9eRkU6QXdshAHv1uoULB6BEUThX/Ai3Pp02OKMqKTMa9sDyic6mXYEim7IjRZA4cooSahrryRikgY5WgSSGfmowa0J0YTw8D6mqIAwNAdzBrT8MzEh0wQwWDDB0CgAiA0djFRsxcdMSpDPQgLHwGKAaAlyDdg9SAIBpdOaGu+BhWGpVI5TOoYswowmvhGYySA8JtjH/+5LE8gPaAgz8D2zDgyVBn4HtmHDVI1WYn537jzdz6DaatWSbEI5rCyUy7fQronSh6cjS90yiV8b6b5yVhckUpJ7k14xxHtyuK8cWRpM25NbsbmJFb82stVBUUkoX1vSKNNS9MRZQ6ku2/MV8o2QxMq9lHcIbqdbUWDWTX07lRTxuEZ5lNr2ytBWSPK1xhBsDTaSwgwOALzDXHiNssKUwlwEAxFGhZLEwkBMLSzJiwwS4CEwQHQOGVmA0KMJG366+c9etSsN7viyV1bNMFqw849YKgo6j93HdDO8CPurNejtM6zW+TgHeUxyoVNOfklSXJKV9RBGHUmJxlnu2wjVYxKotzfxyZtSxZT1FEET6OiYVmmJszsjs5VEKVb5SLGsxE+S36eaYV2ytJvJZWG0XdEtyt1TMrdfJuUayyk4gDMsq54kqNrSiqxNGIEZSMA4CwwxTJTahFuMIkCsx4EDg9SC0jWNIBERm7sHghg5oaAAIHITTPwyDwsMEGkSjHwkVEGoYqMcupNYovs2mlmYdS7wijKNP3USvSoZYbbcw5BV1//uSxOuD2TIE/i9tI1rlPmAB7ZhxSOxsNhxle2PIGTRzu5UylhRN9OnN5jmEEGqfpyVmHSQgbbpGT5OIOkcrsZrj2XKdlyTnUTdPaEhVRdP3enlV2SlWpQmlqikW1VFT6+UQd9KJHvhjJ0p0SLoFwfA0kHj0bmFHEdw1cPF1SCRISW6VUwREowG5sxIYgEByKgQn6vJXBiOLJKF5guN40XINAYSGFvRwAQcHEhSc58U5EaSFnJtWl5OrrOWWITLXmiieuUCxcpFk4HkZIfzfBR6OnA6wCpMoWTd7k5vZ+oDLTliVQYRnXJrovJJF60avGei8wsI9/suYjGHwc7OSmT4kpGIJUWi8NAepotTnGIviSR1JPZ6cLJlUcdKWRRiUT294UzY9Metn7wVc7KEMzlPMMfhptb1u2pPtbtzlbc9A4pQwWwZjEUPnOGQYgwxAPzHYMAwRL1A4GmhC6ZiIRjWomJBOYNEI0rR4DAQIGFALgJDT23MugYi0OSpiCDKolNze3XQKsRWZipgoURmFiKRqCiJ5vF4QkyRsWmMDjDovnP/7ksTwghf6Cv4PbMNLCUFgZdSZ8fv5Zk6jrt/XcjLkaOF4btlsgkownpFaU1kEi8KMo2g8kIWlItvkLz3FmcWTWn5p8l7M1WEQuoZcusyyq9c667JjM2oCch80aU2j+PLihjoV0S7pMF14UoI0apO2fmRVpI+BEREtsUyUYyo+bHOFYTkkRkDV6gcv9moSpmrs5khgPgDmGgPQbaAc5hHAJApDEgQAgKUBisETQZpUebOHglXDlFIVEwHC8PWLsPbTnDVxGdKpQyENw4hfVXfYlxCXJ8soqUMneTwqKQazZuDDDyykNgs8qINPTe8lD88GvaVRTwm7QISM9sMTpzNIWDyRDJGKQIlJrLg5bkeklpZSsRKsegkqZeoouuT1ZVzSEXY48ynwvoFNFAVNXKuZLnJUxSUKtzL+V8svJYpKJw4y9pR+0HCzT8Pfdlwv6ykpempQAwEEkwa6o38ZcwODoRgWjoSACl6YSjiFA1MDBUEiKMAhPgVlypw4Wo3NBTCc0uxHYwQTTQx0hZQHWnPHm1hOdIlzqzC6rRcwYgjTQrP/+5LE9gPbvgr6D3EjSvrAn8HtmHELtKXZA01pxhYIKqIYU6aKBmBaaOWeND/Eu6eJFWakia8PqE415WGzLcx0oxuzGx78+fOMrDRCONMa9O7m810VZRWy1F87Nl+t+ptG1h0MgY2yUxweTCiR+Y1/Mlmk1Htkm+04xzpO8lVXZSsgtUkMWRMD4GEwuT6DWpGZMH8DwxwJBQEglEg405qMgNjP7geNjCDsSI2uCgiZAFRWYsJZ2MTk0gYzGW/NVaJRdd6K3JM3F+zWhKMUkTFLsEVO36gi9kPSerCjrk1EeIdcsqVRMJOWlkdT1k0eQqyTX7a6cmxHGLSS9ocFGa1BNLWVS7yeBxQ+iyzy8JYu2xCKi80KpZ9yXhkLwumtFtFUayTZa4aeYYZnJaNRXIx2rbUXkxTEceupDwXWvCI4pHpCNMgtiPxKGI4IVmjJRRphWSFiEUcnxK9ykDADATTDLCHNpMFQIEXHnKB6RIcDO+lC44wQYvUGBRZteReATmHCAfRo9i63ZNp0IR1L7qrUYw7SJ2JvXNI48iNoJIxHqIrR//uSxO4DGBH5AE6kz8tSQZ+B7aRoHs9/mvibWIJ9OCSjB+snm6735QbvJpclOzucYnVr15KuzCHi133L41a9IU4wUyUamnyq3uooE5ooYr4wVam1JVZ0tQViOpQTMec0Xx3rGY3FvVySoUg2UIrlkF2tfO3XW61Qai+Tdd8HtyXYb2HnO5XaUczr1sXFxlFQTDBpQJNC0cYwRQQTCgov+xQiADijMzAhBpYmkCCIOFmsEoIZaBy5KRqm14qpm11FspjGGEqXvzIh2BQ6qJtdQLjDkkCkjqJRGR69JGwheWFZweQSTYPk09mxkcZNyVQrWo5aQgSiu1LE0jNt7NqoYixQhbJcKqRbg03FvGWknIDeQ7D5G4n8rKY6TUlMOViR6KE2pzO+4Ub8YJpoKbxFVzJ2sqlClJzjCLC80a67LkC7R+bcm3tIWpRx+vZadJiM04tTeT4kliyxdSDUWJI55EVIajCcUDGbkz1ZejEINzFii4K0kqDv4gaBMngKzgqyZgymCzEgoHvQmxhaEEdkwrecimWGTZtdtja64dlELJlrVv/7ksTqA1fqBv4vaSNLVEGfie2kaDVc6mDVPsy1l1dNjJzGUezQh9iGzKPchvVkHJXHKKRfnr0piB0m3dJKur0rWLbTKqTkgLCRiKZKs4tLMkyv3Ob2cxC7SNzBeWyEAzky8NtVJV3CZSMs/TDDVWuEEaXeZacvaDsWxMYZJZpgElUtEWigXZi8cpM4SWlpgfgRGH0KOb6gKRhXABhFYeKlohGBC/s1SQ1og7QoBCiZ4hEk6UOKBLR1t1NLxT2acsVMtwMnf+lFzpNGO1IiQ0hNKrkz1I5GimMPORQEH1VGzSSLIM4rGczdPehM4apleDqlLe2giQm3sGHvLNoKREy+683Sqilu3YtsmUUBBUlRALSWQxSqToAgTCSqljMI0nPt6abp9xGUSFmoC1qbqNowjXQMTe8shuCFBaTT4xeii+JgnjRlaVqNybcoUo0lNFSBxMKmTCDESOc9jkIHkElEQqoKg+YzTMfyIeYiA0CiaYDT16kBohABWWGYTFrxZQtV9EDbME/p/lGPUHrU7kXg+WQE47X0ZMh9cqVHfnR+h7j/+5LE5gPXFgj+DujDg07BX0HtJGmgOZqmqS8dJyIsvoQh+T6pM0vTi8q9IaSxONaEcXjzRmMxc6sE7VOzBhmKh/sJv0TUZSmjtdLcbFhuV8n6oo69xHpbqONMtGNRtDrF0tLJs79VE5UpUJucRpksJdzVltkY2Ia+MzJTuvmxTQqNOecwgFcw3/w3TbEwhEAEB6NxUAx0GM4FQAIhaJUVES6OAKumBDRHPq1iHVElpoLnKpLRZZZbYjro9VlAuhRTRpIycQMqvjFS0ktlG4KMI11IwlIiuqVqloP1plUq3KMNNivqZKMLQrU9CSxOkFJpShhl9WgUi2QVpdzWLLrktJPsvA6IizmI1F/tjWENJRkhucp6XtKbzrS2UnCEKQNtJJwhEwrzmrJyQF02qlztosittWfpyCS8pqykcXifVySCquCkJJMtxUalvxmaN88AAAhkAAwMALzC7IINe8L0wgQEgM1Dgxd1Dw5roBBjIUwj2FppEzSYql9KfmECHWVVMuCCUlF3QnR+5vXgobDwqEINKhfH5476E5Unm2ojfLUa//uSxOYD1cIJAA7ow0svwV+B3aRppGnrFZFiCO6UZUludaSaJnzZTchkhQ3R/NUW1C9DBRPJ4cWVTY6R5pVhA2inWIM6NOaZI5Oz7k8W88kyw2qrGKt3uaTEGPTYjsklNYNs6dvFDTOzRHXlJm4SgRdJlaC8lWLj21FtzUshS6V1BAwg5ATorlLMnrCznNJxOY3VYthDAGAKMIkec0zQ2jBfARDjiNbFSAGYLmDAhniBF+Bg0evxJghWS7Cm2lEDaUaZhD6mp8rMUjsiZheocsuhQlWdlB0EciBWNxha2wUajUZRj5/U00VxpVOW5C02lXxpnaisrGevM7B1J71kTeprI45vUuWsrx6Dvi5a6zIz6OD01ZPUWRJdtDOkl9uKSpfUo1HnIyeS59TRY12r1BTudekxii0ZQye7WpTtnJWm3kIe4h443kzFpvdFK2IXC5pI8pWB5JUAI0AAYGiYVOvMtWSLAcjIGJvtEBQBmDRIBcLwaSBhKAxgAEQ8NSjCNzG6zB8faxa1sLMMGT0Gy0y9KZAVtFOotPDQRUKyRHkAhf/7ksTvglo+DP0vaSNDCcGfxe0kaBiM6IFSwpWJnRK434449BQgIwUYqTSSOG8R0r5ZF5CiWEHOW1JDFcxoQuKIUce5M9yZnRIQiaPOKB+Pk6j0XoJx0iQeITZBr5YIXhp2nIwmMESQPBhBgqaMR0265Z8d5ij7xIh8J80k+mEzVYaGDFwieCVVo1kHwi4EsmSPQZHnVrPDMkuk0G2GCYOGLjannBSGHQFg4CmCv0tgwTE0wWCgwFE4SBQhBxA6B7xQD1t8r7R3m7zTtnf8OkLc4wxlIMBMBGJJ6nnNri0J6KpC1iC45WCAbk6Lsgs2I4DvRgoMiqClzkKY4RwaBIzhAI21Iopif9ASplRPyRlUiMQuGUGKV6Avg5RV8MHih3ZnMkscRjPhB2INeTLiGgH0Y7qQgqpLh1CHKyLVKWHiLI4OjACGgHAXmFEJIawARpg4AAD1aNDN07j0UJrxwkJlMOBVsVVTSMibWLQTSkYQ/XslF0k5zeQK7Aqw2wqgtyrjxK4s8mhMgVUWPDrBO6rim8sKmi0WGJyL3ImLqtkeGDP/+5LE64JaOgj8zqTPip1A4EXTDekELfPNyKJIek5yipmRpR52ppN1qarMpNIImk0SjCAlmrRjxWTey2/WmUiXd1C3K1WkD2yROa+LV0UIG8fJA4qorpvS8CRvYYosnjSCdIVoI6VuZWaVMI3LNQ3TOoFM97aqLsTZmqwhhVtMpm3NjNuaisegIAgkmGnWHUzNmDwcA0ajYkeiKd3oYCyMvSaAk2jSx5tCahQKHW6iwT3NknIFnKIYv7EnWsq3A/Z1pSGRxeWrr84qy10lbW589CbYw8LoTRxeaLdggEBYbI1UzkKVlD6ysmJGUmTRgjRo5Ix/NkQRXnGVzRRPYSwbtjQkSokTFWlBQoecm7GFp2g1wy2dQObaWZSaSOp3hmoHDsGU1XGTzG3c5tMJJJkDDKZo5Nszq2zYYZXnOEpr2ZaSaeTSRMS6h5owaQNmULS551ibBVizpwTZxuYwgD0xttY+LSUxHCYwIANIZ1aMwmKMECwdFj1RWMKaaqsFQ6JTZNGiBpA3NqD5XiNJJRNfGVtd49md63s28QrNnJ02mOQ2//uSxPWCGjoI/K9lI0tMwZ9B3SRotKIEDNsoWULGWov3Oi3qK+RzlFKVsvUVkvGd88gjBWlpQn2FHwNUlPFrRMkbVoXNKYulNifQuTSSYa2cGW5rS6cJanGC+stNr4TncsjtypuOlW5vb0gHG1i6qXglOEesVlGFIHK+126ivCfe3cCjaB1+K2x3okWxTLrw1dWUG5GIlAcBKYQ4ARpGgDFAWY8ZTyZynMSWAarAqlTUVErrjzRxZdI5eExaDPQzZcozY0wgmdW7hsHLI2+ESglySZailrxAzMuVoGO+leKDTiOnwUX+CUtIcgW+iU2Cae01nKggVOWmZ5k8041bGl5CeQmgZboEniyrNOUQ2Fmyt80E7r27x2cyTjPZeUy0ub7AiKREwsye0VT2o6E6/N0MUejSihG2f4oT8QuNcmtBN5ZnYh7ujg+65FIpZToETmrACQKDE+ozz9JjDUIzABFh6RDEw4MyQ0Z5hyt7iYO6pUBqUXdBBVSy7NxTQoVmECAlJ2ybrGWTEkiXWsV10FfPXy7dRmopL0krz50mfpIhhf/7ksTpg9kCCvwO4SiK6kHfwe0YaM+icMJKIyc0iYmjkyVxJJs+ZX9bU3W/LmpZtrcLruSgj1ltFfIZPQuUZZnoikzrTcljpPd05hBFlyHtLQxq46upJqNpr4/Ja5yPZNNvUpD0lFXF12OnJ1PaZTurlCWvNprOxA9cmQTSpOidODU/TLJiMYvl67k5IoqyMFQ6MPrjOMEwMJglMEJSmNDBo7CMpG4qP9ghYoPgprI+BFCJLxbkpJVeDqXPounetxXkuzspIZOR41qT0TUI6eXybKhMzzVNUpBisaZQqzmp7rYeDUYJSUkinCl1mVbuTMcjFJhhzeyjOK8YsT5MWhTDo3zLlVKIxGkUVkkmsw25aDePnOF5bCQo1eLGI9xlKR6DiKBKq3iN2ROK0rBq5yEzdKNG8J0924vunqRaaig0+xC8gVpZHBJqaFAhI21ZtOatswpIsokpMCUBYwohNTVSBaAQbokVIwtTgozYmBAmY5BGYgRYLENmckgAFAOUKDzUJiJHWPYxeD25ICfHQoiMvNlpzKs/ZldCbFGEJqUyhm7/+5LE7oNZQgz8LukjQyPBX4HcpGmghRMNRSIVwk3K4UiYbXWyC3KCPdL3RongpD0qSLWokjaXYX4ktY65i7XcoqhztxIsVbb1GO6WWhs1IU1sfStYQt6o1ixRbFJt+E6INXUNITDRITYOQJMLGCgoOJXFhqJCvK5uP2gxbcIkhHBZdHJotJkggT524LChxDSihA2myVkiu+n9toULHmSziHEICmHSmHQBGmEgCI5uJL4uGB8YBgIFxMFgAIQAdS3mTAvm+tdRBlplRrNOx4t2c4suoNS0043EX3t+DLTitJJs+h5NPSkVTqzQrCDQV0jflRJEV9WtAHkQnd4HfAUSxiZqLRnDu/ToN0OgwoY91R2NaTjqCYWNw0NRZrwagjIcUiJTHELGMkGMGcvcCJVBoHCDrCVXWA42tDB5O2yJsADvdE8SMBkwWEswZ5wzvYcwNDoKA6i2aVxiUKYcBmNrg9csiKBCGiUJFQTYPEh5QnVkWSUICU01iEmIiFLuYRpJQSIh+E5RKJuSKMzgKyhtVmKZxGiuCUBlhklQomyd7Rcj//uSxOuCWqoM+g9tI0KaQKBV0w35qJIaTaQKIBWwrFZtJZJtvWiNNAitFJPPu8TygqSsIeQn+XJY8qocER2OxEpJzSqjchlCjyDBokSPI4Il4lfWo0E+gSSPsXOa7K9qh9ijYfZxZlZyFpeLf0ZUaIT8i2psF4vVYV0kYnMRTs6ampbBp6aJckUONpSgSi6kiBBALzaS85g0DpjmzB/iSZiaBAkRVicVnggvPSFSY+FYcRCIPdwmiQcljOlVYMpRUWSVy2SBi+vT2K6bTUJVOcUTLUp9PZ3BBIV7I7WpMEJxSqfJdRc2yjTm3Oqg35XstQKksdS1CqzBeXsRkTMkGwrV4yUsqvSk9WXYyalP8SSDS8ZxMPFKKqTmbYIEU7ZvFpIsO5F0kc4NM6ofteMHroEkJjqXlNpPUOwu3FGYMrJq3Ao7FpIpLCRyGNOiynUjTcSW7potGj2KNu6JvqQVAwAGNqin95IGJIBiRBdbgKUmDxpmkEkaQx5C3RAAL60hBImNRiEVWeQSoso20YKQA5ksn79EkUTJIKxJJo1Nk8FSbP/7ksT0A9umCPgO7SNLHMGfgd0kaBNE+rN/s8qq54bUkkSJBEo5BiDEkmqyEKSr4ecDYcrllMSeTKpbk3UHLNohFvKUJH1E4Yfi1SjEkJHoWm48qCzCZMjJKapgGlEscfaaGXidqSLWtioQgm08Wb00klayB3SgoUdKayRMgZU5JRdkkxIEWIvAu2PTBwMfpDSzrmcCQoAs/mfqGCEHyAAxl4GtmslGGEjDlp7CE8a8aKH8PF1Fk0KnQ4vt/k5hndXgeRsygfMk8l5on6gI3bEzix8hBxy601Uo7BRqT0NrVrE4t3SVY9Cg7FTZlFmRK0TY2uom91qXOSs3opSlnUmrF+ssb19rZdlJAuzMwg3G2rjGbc3sUtBpHYqayqejKoFo05iakWy5uCstUvF8OGV/JZvzTYwgkgZamGq+xJ4YieSsM0ghBca7MjimpqyY8lyyqBhTJL9iGtzVEAwVCIxWec8WLww4A8HBLVc9lpG8FyjMfIrlFCISNJtoSrZ0lchvYtt3QlI6WxNeLoTR32CLn05UYnZEkRYUf0cNeoKVdiT/+5LE6ANYMgr8DujDSxtBn4XdJGgSRaojzzQIIJKJXcpeUY+kbKWpKolyRVZ+k6Z9uNPQz6bLmt62qzQVUY6gRlpLoL1KewnBOMF1kGIG1e2dd0E3lSVtEjkJTCj6JD8POLlSJBC0VprI21l27S3YodLNoUtr65HrcoX1JEiJIur1HSnLprMosd11IwlBWNfVsaOok1pwlJgKMXBqPXgzFh0JjtWht1Dl9QZa5N+TkSZt9ScFJbbMGrUUbk+OqnUNd9KSYQKRk1p8ZiGlnmTKVLNyQ2TqLrOVZUL9k1c2mCGR2fQZBO4cyhXm9m8hnWuaq7eIWNIl3z2bKxSS0U46ik7EcFWU18k3PGIZ7njMGmK3YJaTXHdZpqGRktS6rs8r9s60+Ou5qSqOPtBjZ17Mme35t+UGq6GTQ69pFySOycrIqyundrq5aaS12lG6fJHFNCvI+qoATADAOmEEQG9BzmCALJzug3eSA1wq8KzKRjJ08IuoYj7SaKoxfJ3jcyTWrkkXoWMqOZXimUUOUqykVXjRJOaorR69dVR+xR9e4KXJ//uSxOoDWRIE/C7lI0r7wJ/J3CRpObRBCz9wJWUGyxvaevSHW10bKlvZWTxqfQL3rDdqo3RxJOcjGRJqtATaRso7guQ7BUtNS7xcwJV0FzjiTmE0puQFV4Nrzehdis0LmGFZEiNRHKaCaSBuEZvyLSnZkqTLStSCb3romp9NCrCGCtBIjpEszZyMUFLndYxmHUWgbpkEy/KKYCCpiXFHo0yYVBCgrvP7SPIIQE0weF4oA4zLW7DwPrdHFV7JtZW/FNSRDSStoiPXoGFZibSUCHiyYJqLXY0GwbBUUEQWFLTmCaHHWhAZWXlSNA88kxo4zy8LOILbU6l1mvDOwmbJPZknqR89HvSXzIBiui6iqY3tesQZsWC2kBmW6VlPSNvIfobyfRY5NZE/SDlJTJ0r05jKEpApR+H4aeG72pLIcqyS0Whfc2oSo6px9PMmzMalu74hkosAIioFAqYxiwG42PEETASuN7IPMAAFHgPCgTDwHFgC2nzCwZb6vHMRQVtyi0rShFZFo/h+0/kSRhLfPSkFrazCDNRUTZ2CY6jb6NHWVP/7ksTsgBmCCvyu4SNLCT/gGcSZ+cRKjKCiZENIcc4IZ7PEhgtTZcw56Y5nECDTJomyROi7IXiZImxE2Sw2fD7SXyzixqKSMxNH1zH1FRZMmk9WgHWSw6g806Hu8sJDMKWSScqWZyaeiTyKIUaTJDkyKZJ94LjpUSIRPSQ7KO+Zy/qQsHLLvYwWUURE0dQQTtcG1cqiQAQxDPz66GMIgNYRy4AXchyTFEYiVgZyt7CDUaJCotacFXKvrJG5rihG9pqqOBmiGwomydkMhkROjo+ZI1lHo0iUVFVuYTfTimdOkjZKjiii0JSBFSyj4J0biFJGXdhB3XJoKH55RyJxIjCytYpiUUe4G5qChrO5LdZql/DB9T+NqblUjr4kTNClJLLfDLIW1aniRC450CkPPUClJRPTOghJNzXbXcpRyGr15g667zRh0kEsy++xtao/WXswLCgwekM1QOowOBdE5nLcn2BoTCYGgHwIcGhSl4EFaVU2bQqvz9lasWFetB5Coqo2NUhZNSaWbt5SPWgzxVvm20yevG2WF1qUNrYhRKsLLE3/+5LE64AYwgr8DqTPyv/BYBnEmfA1kC0/TcorYo0OrKjU2z7LC8CRJxV1NI3Tw3qEruNzpeR6DSuoYijNNIMLtGG0SSBqkS7JEk15uTUXyRthSbQErXrBY+iUKFEKBli9YMKkZrqN0joktpjBUkkqswUb0jUZOqipq4IYHpo4IBNOL+qq9U6mtNGKy6xWQ9NRdIVpIyRsMcYFgIYpG6eDB8DhtQicVr2KCUQNSpSgIRRSliSr8V2mGl31CkJG2rSDT3qJ43zyJEo6YeBeSMQOHEziziYQp6Gl4FoUzsVEKAoylSk8NGW10Dl5LSxlEzKldk1NkiWj5MXWsU0xmNI7li8MozBsowpPsLE7Kb6jtRminBDaG14oUy6o5raJllaK6O5pXBGsfVlv9tYu06oRyMSp7paotWdNAqkVxfdhsTSdQ5SMoIqe3FVpToNvuutYMMsHNdGnwvXZNa0KWoFC55h8kR00QIGEhHNrj7qHAAFkyl7MceBitQ7HKNPA9VOsaVRbekCc5jWt3vC7AoPr0VL1XmB1V0cWSufuqUhiYxOB//uSxO8DWnoK+g7hI0sSwV+F3CRoMhvg8oGVCybEAUIkKNEH8nqsYJpIGzZo+soJHZBhnWjmVytvQSlIbUQ99eGTUNoo0pJxHUrKkyaqBqDC3eFidiWKoSRNo8sLuags2WWKlFSqBjaTkrDE4NZaKcZjC0ZJPiyhjFnW9WY1WU/PWV9cxBjzjGcqeVklJt1PmqhXYQWqqyw5I4vdxWToKAEhvqRUEI7wEqmm89M12dMFDYtBG25wjVDINZZ407WZMxKRKfCjsQ08DEgQ8GJmBJDS5M0ScjZcmWdqwJHmaaTKiycPQG6RMKbycGiEXutIntqIMQYQdwqQckD10BXTBubnJOvxaje2hAsLc6YMXyEagz3VbLazmqPBiQrBRC6LZI8i7QuLmt5w/RKRv6L1L8wc4TldD0UhK/jpWiAMFgfMbW6PnyhMQwKDBLBmKqSOw6DDpceBSEuvWXvwrRSFGAobJK6FtWHgqnNJglExGOlUUAPNBQBwbgRAiMikjBBIdwPa0Q0EyJCQbGYlGGzJPQiMkSCUDNa22083EhbkzM6KCP/7ksTpAhoaBPxOsS3Kazrg5bMOOaoTsZUJSoqWUIAodD50TDQIxRkhQ23ciSdL6mtIjIYxA0ZUaMkQ2Qqtg0G3+GIRx1FVChssuH0EUZlgVEB1GWJemJ0Unj40aZTWFQXRp/qHmWZGUQmlMYC5CYVPCyrBHixQxJ6hXBsiLlR8jPMI2XIyx6cx62JWTSIVikFwtg+8UJCDCySiNBh+Tp0qIgYJ6cD3YtiDXgEkkbLxwl18Yak9cpNJdGYWkVQxBMyPqZmGlMeKSMIxQIHXqiCFED6PKAjsLRPMgWkYQjutAupIRXOQIFnFaHFSfVMhQL7xJNNAgBWvSnpFaCz3KclpdVRYNZKyiB1/HSTNJByd7llG2SRPNK7J0ZhBTJlFyJZI9a9bnnAE4Dv84SU5xJQ88cVH0KyXYThZrHKTOYk5hiHoJHikFAzIpJilwiCqOxR8cfhgeDegahWFQAVCABwpt9QBcDqOQG7jIzCwjMAA92F/oMoE7Ftb9PepJqqpPlR1KMWf4HomkZAEkKIReitKPpIxFEBlOYTqzyQ89PuciSH/+5DE+YPddgr2LukjSwBBX4HcmGlvgG6ykENUOdG3SPKGmHk+gQwiUaCRUmn7al0EpHh0UVjiRpNYM6LIHECAym2SNlgNYEmR0xgnlkPXcshRC1m3SZiVA2rymTCjkBh7iz+iCoNJZ59y8Ki0rJY1p7jmg6J/11hKZdF4mhHSHnkaASgkCwdKoM/QpIeSNjJPYs0EQ0wJBgw6ak5SKAwkAlBZ3a1IZGQKDCVAziKFAedib4VtFLKaqMT9uK6BAaBZCiRsMEJdgmmsFWGCLQ9MR0WCmlx4UjxonbIU1YkKNCdbEM5wRz9liUCkCxtx0xGEWMXRdV/QlxUXQbw5bSNrrviXXKyXFl5NQZXMQsoVNz7QPMrvtQs3cECdpfUWYgwkO4u2ULzXmojyVqtJKkZkLokojDC6E40FRLA0PNaMG2NWQoEYfZR3B15A4IZnHDp69cg3zKnuq0yrqNqBpVY22qRMkRNBJRCRGzK0NzVIKlfGJgAfSAJQJFPyaXQ4FgO08EMEwRg27uite4VblS75bdF2bryZLlqK7FNmPzI+J9r/+5LE6YNY6g78LiTPA2fBnwHdJGjMraOiT0Ky3ZtYt4L1KfN3EE9zUFFSjc5Ul7u5R+l4TVjTKHxFdoN4eTjsT3NleHlH+q7UV02zKj7aO/OSp4KPj3MYXbsnZyzN9ailty+8hRsyg6Gt2TlXhRzR3QSjoJNU3GqjGPuNcxBOLu2JCCqc05gIyFgFmFrMeIS5gYDLDvRlEAUJFgKrJokomp05Eh81iBEwy1qBulK2KhylpoiRFBMjGyATI3MgKoijxSiiwce3MwhJBDA6yZQWhJfOW1qNuB5GhbkiXRFOimntjgpVRSgsh1yNHIwouw98UaJLFYSYk0WSaVUlUiakc2LYmdcgihYrymlzmSnKak/Bshb8TyBJ4meqUVVFAlFC0Fi1QaL9OMF4rzN+mCAgSNTxRXCVY2trXxEsqm6KSCcyyKA60QIjC8mlEClrMr6fIEaxpJNcqjX2BlBAICzCdAONnkwKAlyvtKYYhxkxYEq9UCqemstTrlMgfpCUQxqbVKFooETjzYQpXFE0IWOTUEhUvEoiFABzwZhESLA4/DpI//uSxN8CVGIFAA48yItLQd9ZzCRgQQmWcqcQhQ7AVoXFmFVFmgoTxQtt1I8zOkl2k5qt2zM3ia8Ci17JAef21nXbMpW1W9VVB0MXHkjszOomUHRHkc8kicZQNNnyYSjhSnJoYdbqPZNrNsIfL6sQKYTqGzLIpIEUUno0M2miF0aVokdKDqqK7dY0hNm7NnUGpuhHWN1ha5sIV0JRAwDAAhFE08Y+uAR4VMVh6QuGkG3URBdUask5vF1u4tSrzqMrTY1zUhRfp8mDNi80g40t8bT0hx0F0juny8hLCYSKIYhpSjEk9zuhEJuz2zMtQXUHGFwKOLRL5Ai5vKSPxOGtJN4ydpJM1SCEMRnGO68dJSikq+PpkHZps+qhhkpshSkneomU98X0hxdYniSYGmc1NU05WWySVTibq7lfSduWaii5PX8t7Ojk3a33clFqACYAwAhhWl5waQBgqAKdDrwdD43FKx+SucScygp16VEb3ImCvYzX6wrWtXPvYO6wG6xqBdWxwdWSI3Dqh5xKPiApYM1R+mf9SiUxYqcN5RROEZ91iv/7ksTqghouCPxOGS8KuMGf0a4YMDjSk7yBxGtgSrI1ap35judRTdDjXFdF2upXqMJ2H1pMOnDqX+2rFXoT1Fp+uUNsoeUabvkTd7Ma46rxdLeMuqj5SYKkOzNzxIdOP8ePrHso/FeyhamtQ/PGr25YqWrWlq/0N4pq1Z8uP3EUGFrD4YPULSxu4kV0nr0Ty15fx087Auo0tPmVzqy61hURgIEQMy8YEBLtR2a6ZULWKhFGb7yZzTa45OQ7RFn9XnzJbKhOzLRJAUGL5+phPfDix9OZDUh0JiCIPrGMxs4234NQXJE3KX7NQkp4KlHUUaISTE1OEIKrLOOJQckpkmstnungwpF/qLh6KLezaZycrLlbcUl9Yi7p2+qMbr00kbOFHIoYPSQKfW39R7Jo0eXFNZE5iel3zibG4RZGZTuHi1nLc5wjeh4v46SRTNUwMCM2yzkgOgcIqSUtmn/CgQqYhcFGPRFoM23J16GI89tbtqTQisuqycNQZ1KBrSBgSRbhychRsEB9sq9rtoYnDrGWR+EJnzpKhP2wRRkPGdEo2Sr/+5LE8QJcAgr4ruGDSrTBX8HMGGkmVUKIjUQNUKmTTa3QlTS8tgyT6wbPNL4fXLY5noxaV0wGRNOIrwgRdu12yIhKXjdroulHH4RTdB+F/JsrNZCTpWVtC4VqNmDXUZsmHiZGaHzrEF5K1FZjFBk+wwiIW1Cu+R8wZxRVUgs4sdJvJgQG2F2YkTC+qMmkCM2R2w0sjeLJKDmJFIfYIoYJFY34k8GDFGAEBMXTeWaxX9beaITija2wrSzbO72ImVGmpnV1UQeIyBuem4ml3qtELJIQKhg2hWKsSXiTUugK5C5qKOqaE2q1SsE6+SDknICdqEVBQUamSSZX1tWU1IfY/VEeQRsK2cQxLEyGasWoqopqym7UktUYOTxhjTojhFqEZmJqtQQtL1bclWyMkWllzSbQDMsRNssoWqSlPESSJ7xMWJJSmavwQLlC01pzkbZqpnlUzSiAhaZTYLtEjCk4smVqcAUAZBBjZZUCnxjlBYLnucvhtHplMsGwxH3BKbnLPqmzeajRmkmjrJMiKwJe1OBdJkmtzbMsBA2j5G7UBhMo//uSxPCD2sYM+A31IYMvwd9BzCRouuRMKKN6jjyFSQqg0xJt6qHKrFW2FCLimotl5WyWtk1hgY+b9Y3wWZeqtT0EtWmrFo61az0VM3K1GIMeEJW+WsSSYjJ8y6qznsrNzjNQ6aXZoqvcZsqlttISsPORmyiu1YqKKt7BpBOOui9KKzZu7ybpQgsnso0g3DKBqSI6hQo3gBKF1TDK2OqjkMCS6XevPO2aHW6ObS09fTm0mq9zPcqs14rXB0VKOI9RowNGBZoLFcaUVXRqI7fwHJ1BEiPLT0sWRK4bVMx6m+b9tHhuJlC/Eci7cJ21OCzWo5womkVEe1RhbYzRpMlpRzoE0xxVsgP2Q706EEKlSVWBSeWnd5cAZZhcQYQ77WJzEjTgNA2g/MopCiTyZpAw0zAUuzswVOByTp5WXVMYRJVCZEitW1JbF8qzD6NSizTK1JAODCBpNJRM9mAYoaWGfJDhEJ2KRqMTSwy+lg1aSA+uMBso9ARTZTa1nTMmILPYggHESiyMKoDBqQpCg+dPk6hG1NRCRZKVTMf6TH8YQwdM9P/7ksTmA1gmBvwuaSFLC8HficSaeIpNAuommnTTazLDGmFrQrKFESJi5ELRVSajJLibE7dF5lqbDKvXRZ8meX3zJauKiSjTC5CSQJ5KptQYlOmCojUWbZKWaRRw2qcXQj7oRKYwNId0xRDyRofQoVCFSLsMRkgI9uOoGSqxGhqT+90UqTJ4ymK0Ka4qScfWg8WiuxaEkpebcg9D4E/Z3rAX/cCvhbSFkpUEYS9EqpsYGp+mKtRAPFp7WnEElrCemsBNZAkFE4BKJIUcWL0hBDNcZ8kKNNIUiEFo0IwEtGRKmGXLNqHUppkCK1NttkiRk8y4mZVigZPnXJH0fMKrJtN0nA4yjRWRk6aq1TafCclU3QOLqf0zUULZk/a0UcWl4LVKZRcpM1JxEozaGIXJGjS2rsWrA0hUIb5C0cW3EowPtpwexhPZ8gxpJa1GLx6yiGZHBqcWpr0UbRF2GInS0SgrXbmqLdGFX59B8GALXojfusydVP1i7xRTaYAnRp0pqNQPBY4c9yipIC6ezhKtSvmoE26kTI9NyipdqexYrJmbWnL/+5LE6oNZogj6LXEhCyTB30GzJfhEuzCkb7hFCVbpBsYLfILxlk2C8fKTLsRq2xJXZqJUNRPoZTgqzCNa9df/GppW5tHuQhibpJUfYnG3oV7yE17dJiDT9xYo2QbGHetTK85otmvq7UHYo+O+SB2WbFN8nphRAnrME9qCXv1VroJr4TpvrFkNlYoZKoWSSYYDL/Sy6wYGkealjCrO7Ltxx+Gz6g7eGbXi61ySbSjeNVCUrSsngRkKzZoCd6E3qap+iJwjgT2rIdZQJj2VQS6ZOJyY7xgGEIoj9PsUC6kgjbnzDoIH5YlTkUSisocJjSQaD8tFyQMSJucjJdQhV0YcYrn49YJLdE7oQTMRRPTUqiddSGVIS8wXvfGk1rJpNNZRbp4cuE2q2zGNnlm1HfcX9k35ra57zrwqvd0ZfSP7nMPJVQE003I3YkSDNjEx9Bw5G72qd5JKk5LqGQ3VEca1Bc8PYRomr1bSI5I2mQvjkpFnjgJSA2yTCI+J4tWLQQ4SpGGkZWnmtgtVGQ6WIkr1zikZhFMOixZei1nKjELYi2sB//uSxOWCFyYK/A2ZLYrIQKBltJm5GSRktFPmNhhppijDGxGrc+yjmTAz3wXnlog/Cr6bnLzM+LOI07tRHyg76jKnZ4jxHrK6saih3tEsYNrrMpVIEFfZIUaQArSgAIBpgulG6T+YBAjIW7VX+TDVgEYIU8mW2aQvDXb2fbEtOcCVgoq3jK+dKRWn8rn6fSczBJJOo1OrherSHqk/FC1J+GXVqH0Yg9CAYDhQo80QuKgRLVwwGJGHN48NEsTRfH0QS6pJwDSc6anZN8+K5TSLH1a9QVYTFG8wqEtJAZGTdDkiNVYXHq6TGjNkM3LD49pzJOta+l0pOPl46yP8Ck9s2iXRPn5JpCtPJTN1ufqDw4dUHZDODwfETZufD2vPSsfsGa2MnRGiAenV2jUpnVTqykfuTnK1lwu7GoVwz/Fo7iWn7AloZabbQjk5ho1BAcLcebxIlaQ3zs7jTXmVAACmrqRa6YCPBMOq6Hb/Mn8iU1CXpqZ40mdNhhcm0CptLsGJCWy0+rj9/3kJ5z/xt+G8UK11rjAyLs3MNdGqik5zVVrl5f/7ksT2ABRxow2spM3kB0FemcexubElvDtK6YHXWrl1qVxe0WcMQjRSsLPpAi5IQeMqiNpk32c08nU9R75S/SKT74Ordnqyi7pHJKshJkl9jUPr7pfOmSNOJRbTnK2SWOpaSBXrNpOD4+xk9K0NycXrN2aP4p+zvmUaa/hmx6iSowp1mkGGVedzIwOB7iW5RtPdsKyX5C0nroB1LcKy9z9LhmyTnzKCqCetPqq3UJTInLCyibQ24WFKj1iIE0iI6uGIRIA+wGnY8ka5AbVXMjrzZYgbPmFE4CBAbLk0Q8gpQG2A+8ViqRP3EjC5gyq/Bx4MDxdCumQEJA5FKplotuIYC0QEZODBZOALEsmiY5iOCNGGi6KbU4rhYRnlaP+ZxbGXqKisdXPIllXmYahWXatYlW1DS4yygYHUYneSHGEOGVBKjasbI9QHxIRk5MicXOpCp84jbc+i1iCqzAkH2TcknSJNIUwzFEJYEeoVy0BlBNNbC83WR2bRytdpCiusnaPETeqH0D0cWU4PQPRMKoE2CZDBaTTzQq46WfUJ/zLmiyf/+5LE6YIWigsDLbDRy33BXsHGJXEpOHKdkVYIovJXLIIrRcFGFTLaTFEd5NeTFsZLW1ThZJZRpqOKLQPkC3iTLMO1BpREbgVWmbXWfOkU5SkhE0mDNLdmDUEPWkPvSh2UK82W3PtAeTEBApS0CqhcmVdBLyatlZ6qhnU35iJCg9xlZlaSrBGKcHW2ESyqDJs2tMmOntfA01WqYx2s4oGBICvdFT5QC4hfDI9i5MgQsKEKHZiKbI0uWnApEjynPO8WafqCmkK6qyhPBI0cyCxFHFEOcaTbu8RxqZEvyFPksUWIJFZTkqZWe+1YpIyUn6LCyXYIp4PoIm3Yv5kS7FnTUFDtrWzNomJBQjJZW8ke9uLEUCN6modWi9rrdemZv7fdjdWPM3tQZoo4iYMkLK7Mk3ETa2nCS0mTiJycjeEhZUhlZQ6iYMFn7ElJVk4KtrodMTKTQJ0jIp7bVKkMw6oALwQ+YMbH4CKNEjsVohYjzh4SSe5N1L0zGJrx/LqKzxe2xGpaAhJU3GxO8aYcjQClEQsJl4iMnOidCuQNkxceQJAe//uSxOYD2GYK+g2xIwsUwV9BriQJaSjj7PsFkQg0BJjgg1PFi2KXbmQUdCUrMOaCthSFEg7podPsccFo7diGStKRhKT6CZJ8qKnwQxKglrbQCDjnSmXSZRZ0CBSQKjcYtjQ6Za3RWmKKIQiiUckWwkpikjpEopWPR6zP41IYLRHoLQht5xSZgqOcNZItatJHzJg7TXSJRUgojPDtpA9poYhHAODrTAsXXHCzysBrEZg8iko0MVFaaKKNfbYMqKjTCRNSFxc0RzaTEJfRNYpIEbMVUn0KiiNRrFFpIWmzhKWgQJk8OaxfxI5SojmYx7RFFzcaKtC3dM03S8nr/DMeKcNMCkqVRkxIdQuxWGwQXF7SyJ7TNusqyn0poFBE4siF1ll0ZhODBVGJrTQMvIy8kc17dNmipCswMEacYlItKks1HqJkGr6c6jBwf/F0lVVhWiJZKkRpWK0yY0ty2HW4kiaSYCAWY60ZWsDImIR4CQioDZ412uWWfhjHHcmOIUYKN4izJtAwllJ4dqmg9zyrFuxHMCiSrPtAxM2sOMB9CEiAPv/7ksToAlhmCvytpM/DMsFfRbYkWReixCzif9loSkXSbpEkDiwqmLSeSCBFVy3BkoxxpAayOn0xtpuVybktIBlDMTQaaMEvpSbIU5yRtCEkUaa9UiwxgSh97DHkXihistHqWdzSZSzh43m73TctBapdFG4BjLk8sMJykZsyCkgERokYrQUeiogWla3pvWcpABWA3srzsrUuZ8tr7T5Q6ZTq3I6Ph9GrWI2+TOccWKoTm6y2KS27E23WRYmQsoFHnlY00GmyBCKhCzMGD4JxQMzd0xcjgeMnZLnlrJV9aWkfVPHUjaTjrS7T3jpOgiSMI1YULJkjBxpy0B0qIRMb7JRSbCEj6fcocaUmESbzREpZAJ50szqiBSaxO61SE+zElUtfuIFMD5hALzLQWMkTcSmHWY6eIzgpUIz0BCtI6kKEIXEdTVETaKmVjpA7CHDwiJYpqtli0SUvhhi17XoDBEWpUBuwh2nnRM7lF3V1+WxtwkHxuVXcMLW5qkwxrVYJcMvtdLE/lCWbNNVOGj4qtltchldCGCl3B8NLHQ5n6i3LmaP/+5LE5oPWrgj8DaTCw0jBXwGOJCEXdM+PkNSyy6rPVqnk91qw/w715q8BssfSGaeyyJBocr1h5fXF6tuE0xcn6Wbgc9vMZULRRMfCbEdBqAywZgQm2Qri6n2gtXw7JwasxNjkkyEJzKXKOo4EMtV6i9InhaDItKMzMMmeF1/DYcZhw4ejwo6CMcMhOFFS0+LMWnGLRTLddNIwCnOoNkNVNBXow5l0SNGHERHqFmCdsheIqKwB0kNJohWueOIBUgNNxQRRk0npjloqgywQFyTtzChc085s1mgeNGykl0BGaXkshTI0ESYeP8kJE2BQomWhRUVErExEYVMNajkGRUK2o4cWnMTKKChAKUUiNFukwaSpDMlGAyrtI/MTEE0zxBGxW/jRxNnWzUK0qK14JRCJAmWXXNr2hPgmaFYUISElUdqh0wULaQsRwuRqB8jIWxEY0RqJIVkbCZQmZZKNYuXOkpKskqcTTSaEhghZYaJkfaeTtx4ATqU5EmkkhWoUwEi9OPs3R2ftXrNfXrcac19fdJ0x0yiq4ORJLTMB9LR1QgMW//uSxOkAGPIK/S0w08txQV7Bt6RZilSFQycgcrBSPIw4N1RPUUPuRbuwkCDBEsFkCRmcCNohzqL8cM0as9dVTyYJhaRVTrufFi70iYTAq5ZnSpRlvpkGYw4omoyeYACKnxZEYi+bfsuNn5liFhzBJI+g3RwcugwpUbGGxOLRkMxCQ2kRoC48QE0V3s9YTnoFBsRrrKmiAEpH9IlVNRiXiM5Y5IJi+nSIS18incr4SYfl1UJBIP3YGToxUHjDa4pFyh+PLB3rJUpEmXoRM06M1U4STo5tPQGKEuIapvmNjVEs5PqNOv8XXolJaooPViaxYOiqndUiSQDxxOeFI6NLoEJKD1aykLSpEVsLh8hpzeq545UL6F2I+HSxIuWDw5NDJYW8K5XPTZmquhdOjUnHrZdQ0ykeVLAuLJeqsLXNLl76F1zAtmJUXLSUZFR5YeVUHY7HBUjM1kKypWoABIWpkB2RmgaEnDVLju5G41UlVDXuTNJfprXaTDWGG2G4ml2mfTUGpIIMFcJzttFQIHb1yMeRr0K2B+BgWXZV1Fi+l2lJNv/7ksTdgBCpiw1KGG3DuEDegbSxeSZkKM2iAwIC4PiNuGHw9ZGoDlpUPQSToILCHYGrSYFtDZsvDF17DvdGrLU1xzLDy5T6ayRSyrfUFURh+mSxRp45E03bLWcN8FFpUy9Sl9BGSN10aotM32MWBnOfcKlI+3IIXmQTpZBZInJlsGmopkrpR3fCF93UzAIDgZyYKYAOnTiMXzA5Ayl7TI+yeVNUfwXmCCDiM2pGJLN51oVrOmappxCoSjweaEw0AIHyVALsj4iDYqC4NHDJ0VgqTCThsbSYWFRJ1JnKhqAaIGRQf18VkkBBBywqc9dtrCXW6Kq0hycHEbTuSsaKn0kRHFtP9GTTaQjD50byU8LI0m2oM4gZihogaQtNI7QOJ2HkGrjZyE5+kDMTZBgpaOLzRHVYQJmTVPkT6UeuRPaG3EDLR1CKA9qhMjhBBCDJOXcQ6w2mWaVRQFEURhHAshghEygDEAAEoCqE+YRtzDqaC1HOQ2iCRDoF6ySgreWot2+Dbazfp56pT3oYnkKNNom0Yk5NXh63XNxGEr1dv4hMraj/+5LE6gAX5gj/LSTRy1tBXxW2JFFH7FIRDHoU7zasJo6Ru9QHKh8murKqz7IXRI6neDGKdoMnRy1wimtaWrCNSCchjGU+So8mYXZZRDcorY+NKSN8minYW266rSInEB6ZW4insNURh9Ok1HKpEWGmjD4PRu0CC+y9XDGAU/nSKkOISxqt+AaaWMEp7luIT8NpDwyPky0pNL2VdXjBf4hFg/bJC0lpk6NDiHAG58htDs+WoXTw+PBCFROVImokqoRjA2ZEbFJAiJHSsykSniEugC7chSREJEOISZtEQoajjU9o76QkUVDtESIUEc4h9uBZZpcOo4lijE2pCgaWNmzxtodVeiWmqsaYGoIVInSeYOj2KikfVuAURMgusoR4sOIGg0ujeZYFSOLPGDxoFlTqyoxCVY0qWPuA5JgfVWZRkKO+TSLoYoZjsE2RS46OSFi9h9YSOwZPJsoonCorLTLOAKVSAQ0FkoDiOLTXsqlPUl1yprHWFS9yzaVQs2nONp0vZ9NIncITRsU0aZKDEmdOkKpKKW5lBShioVbznTfFRFof//uSxOWBVMYE/q0kwouLwZ7FtiW4LhhtGJShFtLqNsqshhQwvJI+SoDeck4kpaLaXjovdENx0NXr3rnGIG4rCWbKIHOInlmBy4dG9zU/iCGlrXJpfKIfS39aRvnF5BZdCFIWqkJgPDKkqkVhBhEwuR1GSQs24L+oUnxlxKBbG6pRRFBdIHo0tMqKiO1BeyU4IFAGsr8LRE+5ZjGqJrDtKEszS4pTbJxKFswhOnDsnLNtkKKImVEa0rFzRgF0yRWSARvJ2FDAtiBxsQw00tclxng+u2wOpSaOikSiyEkavTaqSxZn0w0sqSnlqsqbPwgTkBCwsTSaCzB+VCo+sofJWaRrTJzkpspJoEEW7WIjSMQChEh0GCx1ZdlRWQzyixRGmvZtK3GEnUSm3QUpQgQk5tFUSF50y2RjJoihR4UGCZunG1EbNLQtd5FaBzBlM9FAS9NaMUCiFupmjNkpD1CiofP6EAcEMjnx+bKBGxbQdcaMJEqOB/Z6wm04rbyTatHrezx89iYJzkvNUhbk2kKizSBCKiNBNJpZELtkVCJdV90ikP/7ksTnghd2CP7NJNHLTUHfAbYkWFVZM4tmQnKZJVLRZYmosigyxBSFkPXJVF+jlvthVdkTojccWjSpu1mNFSiMn+F2W2CqA3SOosNoN6saXlUdkw30yCivcpmNE2G20DAoZUQT8Y+DT8XtObkDket0lBRGzcv2mqpKy8zMCm2qusriU15nNITxwqam9NFMzalLYh9Qu8OyJbYxIFFAsWDYhL8qjmjU08zFtA0ljLSWo0GTL1WolCSUnmSVhMwndKGYlEkkK+SS9GVRXEyjXLIbIsTJ5RkKSc8/DPMsH1KkbFaEjaVVNZJNZRDjNYKBZlQwdaQkC7JiDGCCFiPcg/SsCFkwUi85HuyJBZGwjKdhFhpVmCKBk5PV1LbgwdKlKmpEgLtGCeK6No40+BXWdjsy4pgWRI8dWNnYLxaRCWVWeyidBC1GsM0StwagsRa9jFqEVqkpWbDjClVEh7FzJj4GJoiMNDwVQjLJLdJmRVpCjiqobKrICpBsRQpCCOBhljrLI1TLJGmnRKTMTRi0ESblXGYqmk8VkdQnSKtXrwEhVeD/+5LE5oFXygr8rOEgAxfBn0GmJFBnrtl5ESpG1OUcwUGoIVEA29BFlE0TJEi6ZC9GjQTVVUK05DdQgaMdar6c2hWXSXuSB1kxsNRTTeq2ygJSQUTZxQuSqyVWaRAqdOuDsiNIuqWWFaFHTCEvNCoPFjUWBYUTI1w3bKM+gbioV1GggQZBdGomx7JkkETYi1qdF1DkESBtSjRkmQ1AckEep/mNbhySzmMlmy4PShYTaZzh+iXo/CYwi4O0QpmJFpajrSiBAfhr6RaFiw0km9AlIuy2RyYAKTzOToDsqxB0m6YagQG6absmtDNYmrE0adIEGrnpbbcotkE8u0Z5PEGKNHljzoJRWofWjR+X6JtGj2B12RE5Vs7SsUKyOVz1CyVyR/abPwmn6Q6Sr7JxXpwK32DySG2LNqyQSbLssnmUZxtWBM1OUjqDUKBCdtWM05ubezF+JITbWLiNGXpFaACMyokPAh4RVlUBvxA0ReKafqK4LVKO4r3xillaVySyxSyYnBlQbPoCdjgJky1oZuJC1EQQ9AdaeoaZyTvmkjLPfJxR//uSxOqCWeYO+AftIAMHwV9VkyUwiGvkk1uyirGnruzlooKFkaoTFhSzofn+DvpVxbQVJdOafrUYSVRcEzYTdPKFGJyui5NKG0USmrFwfVoYt7Y4ya3CiqvdmrSYFiUt5sd2z1k6jbs5UzKaCJrN0zMt+ajTr8EWg1SDuWcDIeBUkWWLcRD47PiCRzocH7FqhVWFNbcr53+iMeaOLslOM7YK6ommqxSbkBdc5GkyUrloaL1D6AbrXydY2cLB+clclNj4tKKI5q+IaZwqDzApBEKOFgacIwI111YDRwjjqyiEYMi8UIno+mqzsRfDwnbSUHV2lgQTpEbRJqOFBCzSBRcogVXXMEjZEnJRAmqqmw2oIz4gclWISVxVVtQjFCBgiDCFI9GQWRMkhORn5uZxlgCC8xdJCu2sRRJCeLhUY1tW6lahpUSEM7FElBnUxAMrE5cVSoCwoDKzEUlVEAAElVfqkpGDuk2E2p6VZJBUlpx7MloqvMusd7z08Oc/sWiYQTCAIsbYHDjptKh5VAMgIJoESYEk56AKATSiT9BJk+lAQP/7ksToghWmAwDMJMnLdcFe1MMnwcJ3vkhwhwoQkEaaCoTKEoEB4yRJ4hBZ6DCgM8/Zs8FTM0Qacimhk1DWEZyWoMD3FBdxLbKayF+pRxd2wRIlGj9RnSJJU2o6Ez5DiKTh3eYhtqRWcsnSHHIxJtSEzSROhGEK8ylGYrKeaBcnbxztZZiNpKTew1yq05mvBCv+pTBFEwO9MPOAuib5Sd+6bvSvBA53GmdxvRPU2SJyQyEYIzArQKErMQ9MYc5YPU3otgJnYohgSQOIxLkzKAhLyFlCpJqkuqG4RJwqxuFuxhMIjnLRkiKA+aTkdKRKRhhEiah5AVSOhFd45WrLRrbMm24FbEcUf51A1obEWRnCZdaoDpImgpSCUM96cyBlL6TY8tvapd78FQZtQUpE6HY3OrLeNkx9LjUco0vOA240sLiAaFYpNLhgMBFAsjaTCgyjaOOlhZsVvYBENiMgRCEbGRidCIfjS8atuOieDQ9K5VgqwIh+0cL7ojpW+U7lw2W4+fohLQ0O7b62iAUw+xk4pQ7TF8uVeEIrHGojWNCSurH/+5LE6YAX2gr6pJk3mry/oGRkmqE7qJaZi3R8P164Sz9awasHTexvmCzFb1yKUlhYMz8aSywbi9GcwGxu6lKqcfpjVHhWdOb3QmjAHCxoChpx4NID4WBshJSRAqKSZgpGKMlmKRAU5YVLTEaJGdORLqEhLEuhDsZUaIiANMEALWPnwohOFZclFUw+dRBsTooikRrnEbI0jIRkydLv0RKSN0LWTtVEFlYeRBdQjFajaMy9vGFVCkVH0WexgYeTCaIrLePkom+VTFMyNxKR/K4ss4iURiYs+Dwuu+paWomkmbZyzVikwM15yUHnOmVEba/KMpsWcpHGSeTyJDDS2Im1piI1AgTPTTcprogkPaozFNQo/17MOT5ZK+5H6BnlKkbtyU4ScNcxhaRFC0mnLpLSoND0QU1IWTmYhkSZ5mFyjTsVemXVbTGEUixkxTiWLJAKQfsySkdh0XdMecWImES82BS0IhtssuGTTUFqEMVHqrHGz7hKgUTQHiEZYQqlIEdhUnxhZGKyNql0lTh3JjKMyVUYRmmiVePIw8OvT7kcVzpd//uSxPkB3bIO9ASxN8KbwR+UYxigACCjDCGoXEk60pLFKyh0UzdchVGhUtRX1ETTA5NmGlK5W4lTOpi89ZKsXGcZDXF8kEtAWCCwPDZxY750prmlxZXGloFr0LpaZiW8ycKiedOIkM4VHhsyvxxJCZcUkiGVFzR4nmr6RIWFi1RVBKq6Ma05aSrkFBbfdbNKJ62SFW7lErrh1AcJ7Q+XmvyRZDAmWHYI1BGQSQpIEEN0LWhgUQMI3yGaxzEScrNNGiiH1ijiRlBKo5MnpsyuU5w0u9/ZTWixAaQlaOzkNK4mu0gRjbDTMGT5ggElwD5wuXt+sEqjJhLYcT68qoxFc2LR2ROcQ6ZFbQuig2XSDyd2SyIF9eurBYgNNu3JFUTa+zEqnTnibaJReiBpkieICjMjGE6FNibDnanTU0Tai1LRKNWs0gfBQtIQtNxKpvC6qOBAkm6Bm4YiRIhSQossgJLvPru7hiZhql7cPyMavirCLV5G7eekooRUgbxxRJQnaDnKgwEWZmjptM+XR5RmaJPV0TROLqRZVSJFCJUqjQAo2P/7kMT1A9veDPYEpZPDE0FfAJGkiSxc/EDTkFguuUojVQzVLkJC3yVCsYbHT7g8qSLspsk1dDMsP3AuQnDbmLRGKnOw0MbtWFnmHVU+jnTiiIxAGPRPAO1CulUHG2mk2ORPkq1zSzYNtzT1JKq5PQPEXOlFos5G9989KNDkAbLUne+KaxBolHLoxmOgyCADQqEUaKaTsQNSP6INkkjUN055GRIPAibo1zdMbfhbSJ/J7tgUNiAMaQkkmkMQ3oXB6JZegklAxIwTsrPTIElvkrfsBUSoNQhdNUTvJGLLKtMMM6qhXRk8TsyQ5oXDSNppwLoUApPn6RsktiPkE6RoiRRhNSRMdMORTnFIuk46jXXhFYQyiwdw65aEE7bPJ1LLgNwWZk3UoKMzezT5sFD6qJLpddNTLVmosTspRMnouQttKYbmRmys4rzaiYXJprE6KGoGXkwebPpxViNqZNymNGERUKmRoUH+USOELZkqNCeI2nlTRIfB3Z9dU6KN7MJlriGXvvGcpKMNxIrGbX0X4qLXK1h6lX6VDw6Vn50c0JWq+v/7ksTpABfCDPzEpNXDNUFfWJYmYayY8SlCzFyNCUicqQnykhGpEXOp3WyUhyYnS64njTxbD9qmmxGG03FBXQjJ8RiWYgE6I0ZJDUS5VEPPxERCKjrjTCBEhYI0SwmJNWIRATIS0iBEyi1CzIXLlBXsyQ5Nch1pATCohOCCY22gB1RAYSHlcXESIsXDxOXVF2CY4ZRniAS8yXcblUy6yEH37KQ2bkqTnT53pvIgTeE0logRYMW2IC1MvBhyEJpdMGA2Ci5StKWJBKiLjwIMAJAYQTA7MKtnFLY1AF6RJ4RUzMBkblkUeY/QSJ3EG6IKNvNk0jQtqEpyZgGgEy5jxSbrWkXQQ1oF28cjbmfq8kglAk1tZjH4x8n4cMwmPY4JR4g1RJEPok9fqaqXxc/dqIfH6hk1I3iaqKMU1k1orM0hVNwkQKMpymcjy9xlrZXEoIiqNTTM7V1GsiRsKMmC7dUQIptswVtaBSXIK1MijqBKuoggSQc0l76x06yIE2IqmagfRswbVXJUbjIkGTgoLIiw8qiweYsXJPuyYGacGAaYosP/+5LE6YNbkgz2BLEzwtDB34RjJvhpBxJLnEkDh60gpJhrpI2tqQXItwg3wGvjLTME2id9CVrhQ4KAwoPKNah1CixkV6m0iSr2y6GonEkEKJ5GrLZQYgXFa7THNyNLqTmKMktJzoPkozE2gSYFaRYnJlb3TIgpkbT9qqKOUh9IFiPTqhNdsSTPqTJWG5RPuY1NRUQEEM20oJrdoawec5aIodowN4JMbA7E5UAALCKBtInHhQxabYnHTjCRCOt5OmRaE0SxwQH0MOhCM1qRyEDY0eJEtqUiky6Ad2ZrwXLLoURZkSkhRCSitCrN3ID0GGGVROiNSbaETDptJqMs7GV0jYRBFAgQ8mBLVxtDBR0h1UnVRORkLKqJSBjXoy58nIJvRwJVmyNUiwminRGYWVeNUQmSBVZ7FHUJ9d6JytH1MEglHGFE2zo4iUbIIeTkDAiJgyhI9FLlqUWRA6qiF8WqAlZEzCB6NHM5F7cXp4UlYeu0zqMmOGSsKTkRFG0fXLGy1kLFhSachqRjEZdEkLpqihEXKDJki5AsgkYLVzAKqGhh//uSxOeBV+oK+iSZPMszwV8UkyWoUqdWrD6gSFVEE4rk7mTRICQfVCqUhIlJuCrCxNNtvIoqi1GZGe1hmCN41A/iBNyhO0wURo11alZIueQ38RkmEDKus6+xiSUsK8wgiWVQHoQSCya5mUkKpaGMqSqJApG2Yimaa7TrIokzckKZY1nk+5sJo3mR6mQqSo5ImTSTWK1NEo1NAAACwG7TnFycYtJNSOkKGmYCtEKNatlhlY64qkgRVqBHZC2uXIGLKMmV83wUH5HkxCjHwugFShIqRCgiKE7IkXEenQCA2QOGjzrgqSEImJYeHRLwSB+Ekj6CUGhRnQe+8xh7bmqLPayZl7RckTvRghifKa9JtRRNA0WXSTcZe87UobFBHVyOCIf0ssfhT+li6Z2evUYlrDB2GI4kEc1V51EwkgRvhSk+gguhUQhokjraG3bAugcweRC5qbJhNdTJoZQbkogPAhSyjZNR6RikCJAJMIE9MmlOB5mrKiEinqDEpmgqdNzcCJlcumRIBdRxPM6PTgQkGm5nxASmBgZAVAGiQVigmDiPqP/7ksTngBi+CvqkmTxLD8EfYJMnyayp9JFWiQ6i75ucszvK4wTzhu6JWHPtLQ4OggfBhuILODmqI4QKoHPs6+ipE1BIaRs+yBzTJA0PpyTsgefIGDA3SRCQj3+TiwYzdIw6h2ccDHixwlCkEwQoHJDSIsSpCw9aLFkBikpuDiRhqZoQNDEyQGURPNAhhQQmmcfqeydKEDCL60gOCBs4UkskXiwqgZowiL5ZDeP0quYEpOSBgbH4nMB+amSw6dB20qriNkoQjpG0UbcCYaUHunM8RqxkJ5rMr5hickmOVxPosPRW6pZjNRitOR5po+Q5Ag3chbbTkVdp2RPRbmxk2WbQCNRrSJGkwfQ3DUmYJpkLBto5h1iBCw9yF6DIEhtt6GT4lEbR1pxFSEniujdRNrzFRKIHOg5yfhBs9kMcyogWXZUo2NCx57FR09EiUIiGDLmkMYJmFsXpCkrVGFpxh7pLTk0iFjZSP1aIkBmIANCtBi4erNCFGkSYMKXqyjDV3aOHFER9OQAoDp6xGmWacskxjVMIhYnMq6feZPwkyTimEjD/+5LE6QFYlgz6oyTTwxZBX2SWJsG6AjnZxKLLamybkSrtJIlUhCSkBQw9uZlRZNQgtgE2yxImMNmzDLDXUXZNIIyE9SS1NNoUkZk0cxfleQOZIzK1yWEcUSorJ4ozmro3wLyaVyytmtDwYYiMt2aLIlxRm0wiRTZiBWoYRbiOllhCk0pBOidtRabUTih9fQonInbjiSHV1ILrI0DTSEaakebshlarjZGE9UVg2VOHWyGc/R6TDyiR5EpJzJDkT5pI1x8BhTELEAxpQLKQmQkC6Jc0YmOBSSUjCFnjQgBsNJOYPwUYWIIgIJBJ1Gw6XNbbximW4olm0c9Ll0bkJMs2PJjhIzMrSCTSiSNMQE5snkyIlVEazbxAjXXRBEpTBAPmUmFC8TYoHkSBpi2CFCmPt0usqW1QggsuJY0emwTMvFaZRqIrFD0ESQZTaG0BbOSkq7QqZUEK9kjGmyrCFI+oTwLMyMSswag0HBTzTMkoaKfuoyYiibwseWnOWgDaGWgzqMGFlkivTxZxsRVisFlKPSxF7+oHhKDw5zIEig9z6tFY//uSxOoDWMYK+AMZLcs/QV8EkyfJiUE5bAVV0ZOgSGmaSOJSzFFtCaTgx4QTIKNNU1dmLKZFJGYUVC9HUzIFEbqzWkCgos2CBmOHZA9M9bM8xqtTm6rGsnhqyinmx4GaYm1mpGFqSNEr+pJlqCU08gjzrmyuvoFOwEJRJcm6OIMFBKBRRxElSdwBDpJTZ4VhUQFhwsTn0PSTagyeMtRQCjEiYZHpNLvNHEYgKxQkCSaJGcGyaZRdAiNqSQQRo0eKwTRpQ0tF5aDAoX0LzmoTFigZcYEzJR6M22jlIBA0JWEAkDAHETBGmq1qSxOuWmSqo/I6gRqrwFJg2gQkpBAUsBQNIT/FZcEueRoiUnB4lxdUTzJioqQxI6gKUpBIS2jcKXuiCbiVtOCpgXICok5DkB5C+0S8G1jb1pLguMlBKFWDhMiPCFBNEw2jBs5ImMrmTcEYLBtEX+wMKUADAiFG2MMgAHxscWQCvkikPPFSirKVO7LDtJRNooUmqSkQfNaoj1FFZOiI4MEp1gfKhkJguQDAhQoLER8G0Inm0smQikaPkP/7ksTlgdUmDPwDDM4DZ0Ge1GSluKI6s8iTE70LcDU4ONLhjSzkkCvkwyfVaL6iRzecQ8+RLdIEiexCMrpcQkwB5MLsDysiCYoXMGl2jxFAxIusaelGeq3ArSyDVyRSM2K2JHuiMdihRMMrvWJ0jhGkDiI3JkmgiRQhicYRYaETkC5DnPOxlEwpGiy59oVtk5/WyF0krNMKr2qMCh6YhPtbH20jcyjpZqU+096qAvFNBvYNb8JOrGoUgWs/dw8nYzObko8cgqRMSezaiaZTKJmsBZIGgQM9KmWvZO0JLxSCVpPBIuFECOFIlR8YQRBHSF7CHvkzylHHelJ5RxADPgymWQQfCsktAgKRrMiMqNgP2ACN8wQa9oPpI56VFMkkXmKJJkkFmRaWlYievC+ow+TEYsaskncDi+lmVVS3KLLLucX7mxQrHHWqXb0gBgIx8hCg+OJSRURnyh1A8BkTB9CS2K0YKiMfmuyorARk0yhcqmSQOFCAyUJNTZ5CbIRMNBQ6ZRisyZk5I/A8isdKTkWRmQwu2oTIlC+NiggXVo1FGQD/+5LE6oFaMgz4oxkgirJB34CTJ6iYqOqnJSjhcRFNOuoqdiwqtBFhQogttAZhB71hNizM2IoU2hVGERWWahMySpMylPSecg9gzkzpN4TJFUVDKMffcpJGDTZlmJFEmtlRluZ4gRHUlqoyiJyhcUdAYiigUxEThmA+SuInaRzd0Q88+KVYGGxJqjULVxtASbEnack0B9FIRvbI4WEwaINDVEq08uophgNTPNksRIje2jIUTWRUJUPQjB1UmTOMzMIBiTw8ZZYpsskR4fVMEZMX0/YeQHJpiteLOEjC7BtEmbDxREXWRn5jJ9VEygUFzoFCojpEmlBpLZIxSd1SMy6766DEc0l4FTEz+oE5NNLKI5CtMnRTQaTwggNigNLOf5sHy5WUW0zeSJE2yNBiMw0F5G2JMD6whMoTaO2pFDCCypkhg+KiiMlsntZzTS0MPIZNIxxo03dRVkcSdioEAAEhgnMAE4DFtycxrNtpEybOcYLI0UZIg4gHWThMVFRSOrKih7LKEKEzJ64JKJlVMkrDsKyPSx0bjR48unAkSZX0j7BA//uSxPIBWkoK+KSZIEsrwd8AkyUgQyTEw0qrsXRXGGly7yZdC0mpaSKk12iVdz5qmWTpWaDRNFjCU9mkUEeRsqzT7kiHLorCNkYgsw8gJQCmKwCpiNMDsJJukbYOaDI0INogYmBLKTMOPPgiDES5soXCZVIlIDTKMAKGjWTnDAZRxMcGTC6kBoUYdiZR6VAqTJwWTlk1RQgCiEENFESYMFBSzC9RB6oipIgDMErwmiUshokLhIgH5yh5DCdaeQVJPFMXhRMSGycXQMoUaz2S8YEh1pxpAtEu2l12FmV1CRG0CWeahEmMKJGQo2dSFWJnylJqTtQwibi5I6D1dZVmRp8ViY3AGiVNm0Q2S4qbe2jaICqiBNcqqoec9CoerSCJEbZFREsgUtd8kMOSrbGU4nmaRSBhGwIkBd9Ntc2jRrI4UwUQONLjnWYstMgUnROO0tnM6oowgQrh1cCIppIjSRS6fUMJa4BJnJOLUZA/hZG0wQmwkmdRGRhrbwVLLJKillJC5QkaQQcZ5s8iQxQJCOE0hWsTmILpIEdJkjDnn1QFfP/7ksTpgdguDPqjJNeTJEFfAJMleRoZXEGFSdVJhVE9lNvBtcQqxPLoUBK7CMQKmEbjFKFDxsgXQrLW5EQG2ZjKx3CIoXXZYKEbcEjkRWdbpA5hKUjoQnRgoyWIiehKXaQoL4yTvSYTkqSs2keM0j9tmSRCgd0l22NXYHSQkZRR1OC4nKo044aVRWimaogiu0cCxcjbxihIQrruWVVRqCNlAQtwQpem2SFY6kg1OAg3EjApgY2gUBUqRCQQOKojIMgsLahFQEMl4kizorHUSg1rBRCugxo0RiAU/ihm0z69Ea6JpOR/oESZsfsRl5JlGWRShWlsZrI4NoU1Dh1omfLZahtR6Hihsss0MkC+MwjT1eHG4J21JRCYNtkRr64Em70+HkUXPo0jJ2V1EkW5MkOWgnAjecp56llJolReZmaJaNECRCYbRwTkYJGCFYxE2zJJmKMnFBySI6tZiiA/TKowIRTwSEINihwPoWzEDhJNHk0SsOfC7k4STQFSSPRNSKLLj7RiRslLFSpyJGVQMOcmdaZWkucmkhwVtlGPJgSyY0X/+5LE6oPZOgz4AxkpwyHBXwCTJpF2uyuzBWrXitaJPyUSRKsTgRa0qXYekSEKFD0aG26kY3akolBmoF2Zo23KfGV01Ec3IXTeiXQi8PM27LlkKcgTnc+el1xHFWjakh0m2ctYXXI0+wx0B06cIEyrj6Um04wgiOScoxc/FpcREcjbkmFSx9pY0s+T3yl8XfOQKEAae1EZnR3RxCPFTjz687zbJMMandD7zh9Y/msL2FvRR43YxL4UrF5WEBzD/i4WVZSBdIZlUkHKUrRyCP5ATaRjn2osFEQmHAOmy5ZEKRk41d4o3LSkoL1A94hGKFeUyJWnASCD0geNC5KJhYTRBFcMqCZhBQEZYuw4UsUHKEIGBZpP4lZJJSEl0WSGpgqS0TKJpyyJxcKJrJ3fSINnBlpQ3BSSKolo2QoFENsHNW2MFpSwgt0lydDbVUsfJiMhZkpAgYwgIqohd6RE1IoESWMWjoZDxBNc3zjCdHtLr4dHYLGnL1ZUVcXn5YLxw6FrpdPrix86wjQtI7LMwJTKISo/BeF0RCReCxkhZ0UniM+o//uSxOeCF6YK+iMZKcsXwd9YwyeoZtd7ix008Kxbmo2hFMJiegwpUUBU6qQYYdKLaTKNCTpomnhdZk8oabKAtROQoq0bNa2QFJNUoekOCA9KnHjx5R6xoiINxVGJBQQlxCixVkfWiyYUMRtEZFm1kHIEKBdCPXRDdxbFSZIqugOtkr3MaVeoONIziGUR9CfgPWacImWIOzSTIARiqZAkRJ6gmVhmjUzqwouk+PDpbdxz6EozKRiRw4NRbyRkLjpZo8wDSBtA2oiPgqjTjZGCqKi0iEJnQyG5oR8iORSySFZ/JNmgOzdNjGo6MN4D58nOjIxegqKMIMRWiWmSHJTpRIsucAyS40wqYRJXRKrt4srVx7dCiNoO8j5/xNW9X8WmakQMNPhXlA1aizCUygVGvRLOMqjTqnBjpeCBAtE2kyOlHEnDJNi+spD7RllHeNJySUIDgwAowUeSEJLw8FCWgS8a8MmXroGpWIUCenl4oTopZt2LArBeKL9ZMmuQCnibQ8HaCxUwSCY2QCcFJg4bmicsdA0D0VxRA0FhXIGMMFYoQ//7ksTsgBomCvgksTZK20Cf2GSbISEjxxQU2mZItnABjSOAI3sIYgJhklsa1U6JFgHQMqlkKFyzaStohiwgm1FpJy4iXOuosmusjHBkRGkPSRpkopNLMpNpGUmx44ysaiVcRkrIyQDZ4iQ+NEzLKwZeYNqUi0uKidokG0iFGgaZmZtESyIzaFCmYFWzi04jYtJZV+yBJZ9dE+b05ywCgFbVxWNEJLYpcRNKu96rklUmoxlcY5JE8KtoY50mlarfcVtVZKmSxpXFXAkgDSaGiJ4VPRITwqapMUnCWpWkTEJkiZIm2cqVwxEmZInoXETKyLbIWSJoqgBJGGYTwVQalPFkyU4GSga2yFkiJkhUuhikTLhkqw0rm1K7SJipLBZFKiImEIlIkW3JpNlaebUa2tQ5LZWsmys1yqIuCJQ1iIqJVWY1rKzyGeWhqVbHrTZ2KSJNq2UlukxBTUUzLjk5LjWqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqr/+5LE7wAawgr2pBkhiu/AHIBgJQGqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqq"}};const _i=new class extends gt{constructor(){super(),this.info={description:()=>Se.element("ul",null,Se.element("li",null,"Brings back the Trades button to the SteamGifts header.")),id:"htb",name:"Header Trades Button",sg:!0,type:"trades"}}init(){const e=c.header.addButtonContainer({buttonName:"Trades",position:"beforeend",openInNewTab:!0,side:"left",url:"https://www.steamtrades.com"});c.header.nodes.leftNav.insertBefore(e.nodes.outer,c.header.buttonContainers.discussions.nodes.outer)}},ki=hs.createElements.bind(hs),xi=hs.createHeadingButton.bind(hs),Ai=hs.getTextNodesIn.bind(hs),Ci={borderlandsgameoftheyear:"borderlandsgoty",mafia2:"mafiaii"};const Si=new class extends gt{constructor(){super(),this.info={description:()=>Se.element("ul",null,Se.element("li",null,"Adds a button (",Se.element("i",{className:"fa fa-list"}),") to the right side of the first page heading of any trade that allows you to check the have/want list against your wishlisted/owned games, along with some filtering options.")),id:"hwlc",name:"Have/Want List Checker",st:!0,type:"trades"}}init(){if(!c.esgst.tradePath)return;let e={button:xi({context:document.getElementsByClassName("page_heading")[0],id:"hwlc",icons:["fa-list"]})};e.button.addEventListener("click",this.hwlc_openPopup.bind(this,e))}async hwlc_openPopup(e){await ut.contains([["steamApi"],["steamStore"]])&&(e.popup?e.popup.open():(e.popup=new lt({icon:"fa-list",title:"Have/Want List Checker",addScrollable:"left"}),this.hwlc_addPanel(e),e.popup.open(),window.setTimeout(async()=>{await this.hwlc_getGames(),e.games={},this.hwlc_addGames(e,"have",c.esgst.appList),this.hwlc_addGames(e,"want",c.esgst.appList)},1e3)))}hwlc_addPanel(e){e.panel=e.popup.getScrollable(),e.panel.classList.add("esgst-hwlc-panel","markdown"),e.sections={},this.hwlc_addSection(e,"have","want"),this.hwlc_addSection(e,"want","have")}hwlc_addSection(e,t,s){e[t]=document.querySelector("."+t),ki(e.panel,"beforeend",[{attributes:{class:"esgst-hwlc-section"},type:"div",children:[{text:`You ${s}:`,type:"h2"},{type:"br"},{attributes:{id:`esgst-hwlc-${t}-textArea`},type:"textarea"},{type:"br"},{type:"br"},{text:`Matches (you ${s} x they ${t}):`,type:"h2"},{attributes:{id:`esgst-hwlc-${t}-matches`},type:"ul",children:[{attributes:{class:"fa fa-circle-o-notch fa-spin"},type:"i"}]},{type:"br"},{text:`They ${t}:`,type:"h2"},{attributes:{id:`esgst-hwlc-${t}-games`},type:"ul",children:[{attributes:{class:"fa fa-circle-o-notch fa-spin"},type:"i"}]},{type:"br"},{type:"h2",children:[{text:"Unable to identify: ",type:"node"},{attributes:{class:"fa fa-question-circle",title:"You can report unidentified games in the ESGST thread so that exceptions can be added for them"},type:"i"}]},{attributes:{id:`esgst-hwlc-${t}-unidentified`},type:"ul",children:[{attributes:{class:"fa fa-circle-o-notch fa-spin"},type:"i"}]}]}]),e.sections[t]={textArea:document.getElementById(`esgst-hwlc-${t}-textArea`),matches:document.getElementById(`esgst-hwlc-${t}-matches`),games:document.getElementById(`esgst-hwlc-${t}-games`),unidentified:document.getElementById(`esgst-hwlc-${t}-unidentified`)},e.sections[t].textArea.addEventListener("input",this.hwlc_filter.bind(this,e,t,null))}async hwlc_getGames(e){if(!c.esgst.appList)try{const t=(await Ne.get("https://api.steampowered.com/ISteamApps/GetAppList/v2/")).json;if(e){c.esgst.appList={};for(const e of t.applist.apps)c.esgst.appList[e.appid]=e.name}else c.esgst.appList=t}catch(e){window.console.log(e),window.alert("Could not retrieve list of Steam games. Games will not be identified by name.")}}async hwlc_addGames(e,t,s){e.games[t]={apps:[],subs:[]};const n=[],a=Ai(e[t]);for(const i of a){const a=i.parentElement;if(a.closest("del"))continue;const o=i.textContent.trim(),r=a.closest("a"),l=r&&r.getAttribute&&r.getAttribute("href");if(l){const s=l.match(/\/(app|sub)\/(\d+)/);if(s){e.games[t][s[1]+"s"].push({id:parseInt(s[2]),name:o,parent:a});continue}}if(this.hwlc_tidyName(o)){if(s){const n=s.applist.apps.filter(e=>this.hwlc_formatName(e.name)===this.hwlc_formatName(o));if(n.length){e.games[t].apps.push({id:parseInt(n[0].appid),name:o,parent:a});continue}}n.filter(e=>e.name===o).length||n.push({name:o,parent:a})}}if("want"===t)try{const n=document.querySelector(".author_name").getAttribute("href").match(/\d+/)[0],a=(await Ne.get(`https://api.steampowered.com/IWishlistService/GetWishlist/v1/?steamid=${n}&format=json`)).json.response.items;a&&a.forEach(n=>{const a=parseInt(n.appid),i=e.games[t].apps.filter(e=>e.id===a)[0];if(i)return void(i.wishlisted=!0);const o=s.applist.apps.filter(e=>parseInt(e.appid)===a)[0]||null;o?e.games[t].apps.push({id:a,name:o.name,wishlisted:!0}):e.games[t].apps.push({id:a,name:""+a,wishlisted:!0})})}catch(e){}for(const s in e.sections[t])e.sections[t].hasOwnProperty(s)&&(e.sections[t][s].innerHTML="");e.games[t].apps=e.games[t].apps.map(e=>{if("want"===t&&e.wishlisted)return e.html={type:"li",children:[{attributes:{class:"fa fa-star",title:"On their wishlist"},type:"i"},{attributes:{href:"https://store.steampowered.com/app/"+e.id},text:e.name,type:"a"}]},e;if("have"===t&&c.esgst.games.apps[e.id]){if(c.esgst.games.apps[e.id].owned)return e.owned=!0,e.html={type:"li",children:[{attributes:{class:"fa fa-folder",title:"On your library"},type:"i"},{attributes:{href:"https://store.steampowered.com/app/"+e.id},text:e.name,type:"a"}]},e;if(c.esgst.games.apps[e.id].wishlisted)return e.wishlisted=!0,e.html={type:"li",children:[{attributes:{class:"fa fa-star",title:"On your wishlist"},type:"i"},{attributes:{href:"https://store.steampowered.com/app/"+e.id},text:e.name,type:"a"}]},e}return e.html={type:"li",children:[{attributes:{href:"https://store.steampowered.com/app/"+e.id},text:e.name,type:"a"}]},e}).sort(this.hwlc_sortGames),e.games[t].subs=e.games[t].subs.sort(this.hwlc_sortGames);const i=[];for(const s of e.games[t].apps)i.push(s.html);ki(e.sections[t].games,"beforeend",i);const o=[];for(const s of e.games[t].subs)o.push({type:"li",children:[{attributes:{class:"fa fa-suitcase",title:"This is a package (packages are not checked for wishlisted/owned status)"},type:"i"},{attributes:{href:"https://store.steampowered.com/sub/"+s.id},text:s.name||s.id,type:"a"}]});ki(e.sections[t].games,"beforeend",o);const l=[];for(const e of n)l.push({text:e.name,type:"li"});ki(e.sections[t].unidentified,"beforeend",l);for(const s in e.sections[t]){if(e.sections[t].hasOwnProperty(s)){if("textArea"===s||e.sections[t][s].innerHTML)continue;ki(e.sections[t][s],"atinner",[{text:"None.",type:"node"}])}const n=r.get("hwlc_"+t);n&&(e.sections[t].textArea.value=n,this.hwlc_filter(e,t))}}hwlc_filter(e,t){e.sections[t].matches.innerHTML="";const s=e.sections[t].textArea.value;r.set("hwlc_"+t,s);let n=[];const a=s.split(/\n/);for(let s of a)s=s.trim().toLowerCase(),s&&(e.games[t].apps.filter(e=>e.name.toLowerCase().match(s)).forEach(e=>{n.filter(t=>t.name===e.name).length||n.push({id:e.id,name:e.name,owned:e.owned,wishlisted:e.wishlisted,type:"app"})}),e.games[t].subs.filter(e=>e.name.toLowerCase().match(s)).forEach(e=>{n.filter(t=>t.name===e.name).length||n.push({id:e.id,name:e.name,owned:e.owned,wishlisted:e.wishlisted,type:"sub"})}));n=n.sort(this.hwlc_sortGames);const i=[];for(const e of n)i.push({type:"li",children:["have"===t&&e.owned?{attributes:{class:"fa fa-folder",title:"On your library"},type:"i"}:null,e.wishlisted?{attributes:{class:"fa fa-star",title:`On ${"want"===t?"their":"your"} wishlist`},type:"i"}:null,{attributes:{href:`https://store.steampowered.com/${e.type}/${e.id}`},text:e.name||e.id,type:"a"}]});ki(e.sections[t].matches,"beforeend",i),e.sections[t].matches.innerHTML||ki(e.sections[t].matches,"atinner",[{text:"None.",type:"node"}])}hwlc_tidyName(e){return e.replace(/[^\w]/g,"").toLowerCase().replace(/steamkeys/,"")}hwlc_formatName(e){return e=e.replace(/[^\w]/g,"").toLowerCase().replace(/windowsedition/,""),Ci[e]||e}hwlc_sortGames(e,t){return e.wishlisted&&!t.wishlisted?-1:!e.wishlisted&&t.wishlisted||e.owned&&!t.owned?1:!e.owned&&t.owned?-1:e.name.localeCompare(t.name,{sensitivity:"base"})}},Ei=hs.createElements.bind(hs);const Ti=new class extends gt{constructor(){super(),this.info={description:()=>Se.element("ul",null,Se.element("li",null,'Adds a "Last Page" link to the pagination navigation of some pages that do not have it. For example: user pages, group pages with 100+ pages, etc...')),id:"lpl",name:"Last Page Link",sg:!0,type:"general"}}init(){this.esgst.paginationNavigation&&(this.esgst.userPath?this.lpl_addUserLink():this.esgst.groupPath&&this.lpl_addGroupLink())}lpl_getLastPage(e,t,s,n,a,i,o){let r,l,c,d,g,u,m,h;return d=e.getElementsByClassName("pagination")[0],u=e.getElementsByClassName("pagination__results")[0],g=e.getElementsByClassName("pagination__navigation")[0],g?(r=g.lastElementChild,c=r.classList.contains("is-selected")||r.classList.contains("is_selected")||r.querySelector(".fa-angle-double-right")?parseInt(r.getAttribute("data-page-number")):t&&this.esgst.userPath||s?t&&window.location.pathname.match(/\/giveaways\/won/)||n?Math.ceil(parseInt(e.querySelector('.featured__table__row__right a[href*="/giveaways/won"]').textContent.replace(/,/g,""))/25):Math.ceil(parseInt(e.getElementsByClassName("sidebar__navigation__item__count")[0].textContent.replace(/,/g,""))/25):t&&this.esgst.groupPath||a?t&&window.location.pathname.match(/\/users/)||i?Math.ceil(parseInt(e.getElementsByClassName("sidebar__navigation__item__count")[1].textContent.replace(/,/g,""))/25):t&&this.esgst.groupWishlistPath||o?999999999:Math.ceil(parseInt(e.getElementsByClassName("sidebar__navigation__item__count")[0].textContent.replace(/,/g,""))/25):999999999):c=999999999,999999999===c&&u&&(l=u.firstElementChild,l&&(m=l.nextElementSibling,m&&(h=m.nextElementSibling,h&&!h.textContent.match(/Giveaway\sFilters/)&&(c=Math.ceil(parseInt(h.textContent.replace(/,/g,""))/(t&&this.esgst.itemsPerPage||parseInt(m.textContent.replace(/,/g,""))-parseInt(l.textContent.replace(/,/g,""))+1)))))),c}lpl_addUserLink(){let e,t,s;s=window.location.pathname.match(/^\/user\/(.+?)(\/.*?)?$/)[1],t=window.location.pathname.match(/\/giveaways\/won/)?`/user/${s}/giveaways/won/search?page=${this.esgst.lastPage}`:`/user/${s}/search?page=${this.esgst.lastPage}`,this.esgst.lastPageLink=[{attributes:{"data-page-number":this.esgst.lastPage,href:t},type:"a",children:[{text:"Last",type:"span"},{attributes:{class:"fa fa-angle-double-right"},type:"i"}]}],e=this.esgst.paginationNavigation.lastElementChild,this.esgst.currentPage===this.esgst.lastPage||e.classList.contains("is-selected")||e.querySelector(".fa-angle-double-right")||Ei(this.esgst.paginationNavigation,"beforeend",this.esgst.lastPageLink)}lpl_addGroupLink(){let e,t,s;e=window.location.pathname.match(/^\/group\/(.+?\/.+?)(\/.*?)?$/)[1],s=window.location.pathname.match(/\/users/)?`/group/${e}/users/search?page=${this.esgst.lastPage}`:this.esgst.groupWishlistPath?`/group/${e}/wishlist/search?page=${this.esgst.lastPage}`:`/group/${e}/search?page=${this.esgst.lastPage}`,this.esgst.lastPageLink=[{attributes:{"data-page-number":this.esgst.lastPage,href:s},type:"a",children:[{text:"Last",type:"span"},{attributes:{class:"fa fa-angle-double-right"},type:"i"}]}],t=this.esgst.paginationNavigation.lastElementChild,this.esgst.currentPage===this.esgst.lastPage||t.classList.contains("is-selected")||t.querySelector(".fa-angle-double-right")||Ei(this.esgst.paginationNavigation,"beforeend",this.esgst.lastPageLink)}},Ni=hs.createElements.bind(hs),Pi=hs.getFeatureTooltip.bind(hs),Li=hs.round.bind(hs);const Ii=new class extends gt{constructor(){super(),this.info={colors:{barColor:"Bar Color",projectedBarColor:"Projected Bar Color",barColorHover:"Bar Color (Hover / Account Page)",projectedBarColorHover:"Projected Bar Color (Hover / Account Page)",barColorSelected:"Bar Color (Account Page Hover)",projectedBarColorSelected:"Projected Bar Color (Account Page Hover)"},description:()=>Se.element("ul",null,Se.element("li",null,"Displays a green bar in the account button at the header of any page that represents your level progress.")),features:{lpv_e:{description:()=>Se.element("li",null,"Also displays a lighter green bar, if you have any giveaways open, to estimate what your level will be when the giveaways are marked as received. If you hover over the account button, it shows the number of the estimated level."),name:"Show estimated level.",sg:!0,sync:"Giveaways, No CV Games, Reduced CV Games",syncKeys:["Giveaways","NoCvGames","ReducedCvGames"]}},id:"lpv",name:"Level Progress Visualizer",sg:!0,type:"general"}}async init(){Ee.subscribe(Ue,this.lpv_setStyle.bind(this)),await this.lpv_setStyle(null,Be.counters.level),this.joinStyles()}async getCache(){r.get("lpvCache_v2")&&r.delete("lpvCache_v2");const e=JSON.parse(r.get("lpvCache",'{ "cv": 0, "level": 0, "v": 3 }')),t=Be.counters.level.full;if(3!==e.v||t!==e.level){e.v=3,e.level=t;const s=(await Ne.get("/user/"+d.get("username"))).html.querySelectorAll(".featured__table__row__right")[6];e.cv=c.common.round(parseFloat(JSON.parse(s.firstElementChild.lastElementChild.getAttribute("data-ui-tooltip")).rows[0].columns[1].name.replace(/[$,]/g,""))),r.set("lpvCache",JSON.stringify(e))}return e}async lpv_setStyle(e,t){if(10===t.base)return;const s=c.header.buttonContainers.account.nodes.button.offsetWidth,n=c.header.buttonContainers.account.nodes.outer.offsetWidth,a=Math.trunc(100*Li(t.full-t.base)),i=Math.trunc(a*(n/100)),o=i+"px",r=Math.max(0,i-s)+"px";let l="0",g="0";if(d.get("lpv_e")){const e=await this.getCache(),a=this.lpv_getCv();if(a>0){const i=c.common.getLevelFromCv(e.cv+a),o=Math.trunc(i),r=Math.trunc(100*Li(i-o)),d=Math.trunc(Math.min(100,r)*(n/100));l=d+"px",g=Math.max(0,d-s)+"px",c.header.buttonContainers.account.nodes.level.title=Pi("lpv",`${t.full} (${i})`)}}const u=d.get("lpv_barColor"),m=d.get("lpv_projectedBarColor"),h=d.get("lpv_barColorHover"),p=d.get("lpv_projectedBarColorHover"),f=d.get("lpv_barColorSelected"),b=d.get("lpv_projectedBarColorSelected");this.esgst.lpvStyleArray=[{selector:".esgst-lpv-container",rules:[{name:"background-image",values:[`linear-gradient(to right, ${u} ${o}, ${m} ${o}, ${m} ${l}, transparent ${o})`,"var(--esgst-lpv-button, linear-gradient(#8a92a1 0px, #757e8f 8px, #4e5666 100%))"]}]},{selector:".esgst-lpv-container .nav__button--is-dropdown:hover",rules:[{name:"background-image",values:[`linear-gradient(to right, ${h} ${o}, ${p} ${o}, ${p} ${l}, transparent ${o})`,"var(--esgst-lpv-button-hover, linear-gradient(#9ba2b0 0px, #8c94a3 8px, #596070 100%))"]}]},{selector:".esgst-lpv-container .nav__button--is-dropdown-arrow:hover",rules:[{name:"background-image",values:[`linear-gradient(to right, ${h} ${r}, ${p} ${r}, ${p} ${g}, transparent ${r})`,"var(--esgst-lpv-button-hover, linear-gradient(#9ba2b0 0px, #8c94a3 8px, #596070 100%))"]}]},{selector:".esgst-lpv-container .nav__button--is-dropdown-arrow.is-selected",rules:[{name:"background-image",values:[`linear-gradient(to right, ${u} ${r}, ${m} ${r}, ${m} ${g}, transparent ${r})`,"var(--esgst-lpv-arrow, linear-gradient(#4e525f 0px, #434857 5px, #2b2e3a 100%))"]}]},{selector:".esgst-lpv-container.is-selected .nav__button--is-dropdown",rules:[{name:"background-image",values:[`linear-gradient(to right, ${h} ${o}, ${p} ${o}, ${p} ${l}, transparent ${o})`,"var(--esgst-lpv-button-selected, linear-gradient(#d0d5de 0px, #c9cdd7 5px, #9097a6 100%))"]}]},{selector:".esgst-lpv-container.is-selected .nav__button--is-dropdown-arrow ",rules:[{name:"background-image",values:[`linear-gradient(to right, ${h} ${r}, ${p} ${r}, ${p} ${g}, transparent ${r})`,"var(--esgst-lpv-button-selected, linear-gradient(#d0d5de 0px, #c9cdd7 5px, #9097a6 100%)) "]}]},{selector:".esgst-lpv-container.is-selected .nav__button--is-dropdown:hover",rules:[{name:"background-image",values:[`linear-gradient(to right, ${f} ${o}, ${b} ${o}, ${b} ${l}, transparent ${o})`,"var(--esgst-lpv-button-selected-hover, linear-gradient(#f0f1f5 0px, #d1d4de 100%)) "]}]},{selector:".esgst-lpv-container.is-selected .nav__button--is-dropdown-arrow:hover:not(.is-selected)",rules:[{name:"background-image",values:[`linear-gradient(to right, ${f} ${r}, ${b} ${r}, ${b} ${g}, transparent ${r})`,"var(--esgst-lpv-button-selected-hover, linear-gradient(#f0f1f5 0px, #d1d4de 100%))"]}]},{selector:".esgst-lpv-container.is-selected .nav__button--is-dropdown-arrow.is-selected ",rules:[{name:"background-image",values:[`linear-gradient(to right, ${f} ${r}, ${b} ${r}, ${b} ${g}, transparent ${r})`,"var(--esgst-lpv-arrow-selected, linear-gradient(#4e525f 0px, #434857 5px, #2b2e3a 100%)) "]}]}]}joinStyles(){let e;if(this.esgst.lpvStyleArray){if(e=JSON.parse(JSON.stringify(this.esgst.lpvStyleArray)),this.esgst.pvStyleArray)for(const[t,s]of e.entries()){for(const[e,n]of s.rules.entries())n.values=n.values.concat(JSON.parse(JSON.stringify(this.esgst.pvStyleArray[t].rules[e].values)));s.rules.push({name:"background-position",values:["left top","left top","left bottom","left bottom"]},{name:"background-repeat",values:new Array(4).fill("no-repeat")},{name:"background-size",values:["auto 50%","0","auto 50%","auto"]})}}else this.esgst.pvStyleArray&&(e=JSON.parse(JSON.stringify(this.esgst.pvStyleArray)));if(!e||!Array.isArray(e))return;let t="";for(const s of e){t+=s.selector+" {\n";for(const e of s.rules)t+=`  ${e.name}: ${e.values.join(", ")} !important;\n`;t+="}\n\n"}this.esgst.lpvStyle||(this.esgst.lpvStyle=Ni(this.esgst.style,"afterend",[{attributes:{id:"esgst-lpv-style"},type:"style"}])),this.esgst.lpvStyle.textContent=t,c.header.buttonContainers.account.nodes.outer.classList.add("esgst-lpv-container")}lpv_getCv(){let e=0;const t=this.esgst.users.users[d.get("steamId")];if(!t)return e;const s=t.giveaways;if(!s)return e;const n=Date.now();for(const t of["apps","subs"]){const a=s.sent[t];for(const s in a)if(a.hasOwnProperty(s)){let i=0,o=0,r=0;for(const e of a[s]){const t=this.esgst.giveaways[e];if(t){if(r=t.points,n<t.endTime||!t.started)i+=t.copies;else if(t.entries>=5||!t.inviteOnly&&!t.group&&!t.whitelist)if(Array.isArray(t.winners))for(const e of t.winners)"Received"===e.status&&(o+=1);else t.winners>0&&(o+=Math.min(t.entries,t.winners))}else dt.info(`Could not find giveaway ${e}...`)}const l=this.esgst.games[t][s];if(l&&(l.noCV?r=0:l.reducedCV&&(r*=.15)),o>5||o+i>5){for(let e=o-5;e>0;e--)r*=.9;let t=0;for(let e=i;e>0;e--)r*=.9,t+=r;t>0&&(e+=t)}else i>0&&(r*=i,r>0&&(e+=r))}}return e}},Bi=hs.buildGiveaway.bind(hs),Di=hs.copyValue.bind(hs),Gi=hs.createAlert.bind(hs),qi=hs.createElements.bind(hs),Ri=hs.createTooltip.bind(hs),Mi=hs.downloadFile.bind(hs),Oi=hs.getFeatureNumber.bind(hs),Ui=hs.getFeatureTooltip.bind(hs),Fi=hs.getUser.bind(hs),$i=hs.lockAndSaveGiveaways.bind(hs),Wi=hs.parseMarkdown.bind(hs),Vi=hs.saveUser.bind(hs),ji=hs.setCountdown.bind(hs);const Hi=new class extends gt{constructor(){super(),o()(this,"mgc_toggleEditButton",e=>{e.selected.length>0?(e.addButton.hide(),e.editButton.show()):(e.editButton.hide(),e.addButton.show())}),this.info={description:()=>Se.element("ul",null,Se.element("li",null,"Adds a section 0 to the"," ",Se.element("a",{href:"https://www.steamgifts.com/giveaways/new"},"new giveaway")," page that allows you to create multiple giveaways at once."),Se.element("li",null,"There is also a special tool to create a train (multiple giveaways linked to each other), which has the option to automatically create a discussion for the train."),Se.element("li",null,"The icon ",Se.element("i",{className:"fa fa-question-circle"}),' next to "Create Multiple Giveaways" in the section contains all of the steps that you have to follow to use the feature correctly.'),Se.element("li",null,"When you add a giveaway to the queue, a small numbered box appears at the panel below the buttons to represent that giveaway. If you hover over the box it shows the details of the giveaway."),Se.element("li",null,"You can re-order/remove a giveaway by dragging and dropping the box."),Se.element("li",null,"The giveaways will be created without reviewing or validating, so make sure that all of the fields were filled correctly or the creation will fail (if a train is being created, the failed giveaway will be disconnected and the previous giveaway will be connected to the next one instead).")),id:"mgc",name:"Multiple Giveaway Creator",sg:!0,type:"giveaways"}}async init(){this.esgst.newGiveawayPath&&this.mgc_addSection(),this.esgst.newDiscussionPath?(r.get("mgcAttach_step1")||r.get("mgcAttach_step2"))&&(r.delete("mgcAttach_step1"),r.delete("mgcAttach_step2"),this.mgc_addCreateAndAttachButton()):this.esgst.editDiscussionPath?r.get("mgcAttach_step4")&&this.mgc_editDiscussion():this.esgst.discussionPath&&(r.get("mgcAttach_step2")?(r.delete("mgcAttach_step2"),r.set("mgcAttach_step3",window.location.pathname.match(/\/discussion\/(.+?)\//)[1]),await Ne.post(c.esgst.locationHref,{data:`xsrf_token=${Be.xsrfToken}&do=close_discussion`}),window.close()):r.get("mgcAttach_step4")?document.querySelector('form[action="/discussions/edit"]').submit():r.get("mgcAttach_step5")?(r.delete("mgcAttach_step5"),await Ne.post(c.esgst.locationHref,{data:`xsrf_token=${Be.xsrfToken}&do=reopen_discussion`}),r.set("mgcAttach_step6",!0),window.location.reload()):r.get("mgcAttach_step6")&&(r.delete("mgcAttach_step6"),new lt({addScrollable:!0,icon:"fa-check",isTemp:!0,title:"Train created with success! You can close this now."}).open()))}mgc_addSection(){let e,t,s,n,a,i,o,l;if(o=document.getElementsByClassName("form__rows")[0],o){a={countries:document.querySelector('[name="country_item_string"]'),gameId:document.querySelector('[name="game_id"]'),gameType:document.querySelector('[name="type"]'),copies:document.querySelector('[name="copies"]'),keys:document.querySelector('[name="key_string"]'),startTime:document.querySelector('[name="start_time"]'),endTime:document.querySelector('[name="end_time"]'),region:document.querySelector('[name="region_restricted"]'),whoCanEnter:document.querySelector('[name="who_can_enter"]'),whitelist:document.querySelector('.form__row--who-can-enter [name="whitelist"]'),groups:document.querySelector('[name="group_item_string"]'),level:document.querySelector('[name="contributor_level"]'),description:document.querySelector('[name="description"]'),timezone:(new Date).getTimezoneOffset(),datas:[],values:[],selected:[],created:[],createdValues:[],countryNames:{},groupNames:{},gameName:void 0,editButton:void 0,discussionPanel:void 0,discussionLink:void 0,giveaways:void 0};let c=document.querySelector('[data-input="country_item_string"]').querySelectorAll("[data-item-id]");for(let e=0,t=c.length;e<t;e++){let t=c[e];a.countryNames[t.getAttribute("data-item-id")]=t.getAttribute("data-name")}c=document.querySelector('[data-input="group_item_string"]').querySelectorAll("[data-item-id]");for(let e=0,t=c.length;e<t;e++){let t=c[e];a.groupNames[t.getAttribute("data-item-id")]=t.getAttribute("data-name")}a.gameName=a.gameId.nextElementSibling;let g=qi(o,"afterbegin",[{attributes:{class:"esgst-form-row",title:Ui("mgc")},type:"div",children:[{attributes:{class:"esgst-form-heading"},type:"div",children:[{attributes:{class:"esgst-form-heading-number"},text:"0.",type:"div"},{attributes:{class:"esgst-form-heading-text"},type:"div",children:[{text:"Create Multiple Giveaways ",type:"node"},{attributes:{class:"fa fa-question-circle esgst-clickable"},type:"i"}]}]},{attributes:{class:"esgst-gm-section esgst-form-row-indent"},type:"div",children:[{type:"div",children:[{type:"div"},{attributes:{class:"esgst-hidden"},type:"div",children:[{type:"div"}]}]}]}]}]);l=g.lastElementChild,Ri(g.firstElementChild.lastElementChild.lastElementChild,"\n\t\t\t\t<div class=\"esgst-bold\">How To Use</div>\n\t\t\t\t<ol>\n\t\t\t\t\t<li>If you want to create a train, enable 'Create train', otherwise go to step 3.</li>\n\t\t\t\t\t<li>If you want to attach a discussion to the train, click 'Attach' and follow the steps.</li>\n\t\t\t\t\t<li>Fill the details of the giveaway (you can use Giveaway Templates for this).</li>\n\t\t\t\t\t<li>If you are creating a train, you must generate next/previous links by clicking 'Generate' and following the steps, otherwise go to the next step.</li>\n\t\t\t\t\t<li>If you want to add a counter to the giveaways, click 'Generate' and follow the steps.</li>\n\t\t\t\t\t<li>You can either add each giveaway at a time, by typing the game name, filling the copies/keys fields and clicking 'Add', or all giveaways at the same time, by clicking 'Import' and following the steps.</li>\n\t\t\t\t\t<li>If you want to play with the order of the giveaways you can use 'Shuffle' to change their order.</li>\n\t\t\t\t\t<li>When you have added all the giveaways and are ready to create them, click 'Create' and wait until the process is done.</li>\n\t\t\t\t</ol>\n\t\t\t\t<div>You can add certain variables to the description of the giveaways (before clicking 'Add') that will be replaced with certain details for each giveaway:</div>\n\t\t\t\t<ul>\n\t\t\t\t\t<li>[esgst-level] - The level of the giveaway.</li>\n\t\t\t\t\t<li>[esgst-name] - The name of the game being given away.</li>\n\t\t\t\t\t<li>[esgst-steam-id] - The Steam app/sub id of the game being given away.</li>\n\t\t\t\t\t<li>[esgst-steam-type] - The Steam type of the game being given away (\"app\" or \"sub\").</li>\n\t\t\t\t\t<li>[esgst-steam-url] - The Steam store URL of the game being given away (https://store.steampowered.com/type/id).</li>\n\t\t\t\t</ul>\n\t\t\t"),s=l.firstElementChild,t=s.lastElementChild,d.get("mgc_createTrain")&&t.classList.remove("esgst-hidden"),this.esgst.mgc_createTrainSwitch=new vt(s.firstElementChild,"mgc_createTrain",!1,"Create train.",!1,!1,null,d.get("mgc_createTrain")),this.esgst.mgc_createTrainSwitch.dependencies.push(t),this.esgst.mgc_removeLinksSwitch=new vt(t.firstElementChild,"mgc_removeLinks",!1,"Remove previous/next links from the first/last wagons.",!1,!1,"Disabling this keeps the links as plain text.",d.get("mgc_removeLinks")),tt.create([{color:"green",icons:["fa-gear"],name:"Generate",onClick:this.mgc_generateFormat},{template:"loading",isDisabled:!0,name:"Generating..."}]).insert(l,"beforeend"),a.addButton=tt.create([{color:"green",icons:["fa-plus-circle"],name:"Add",onClick:this.mgc_getValues.bind(this,a)},{template:"loading",isDisabled:!0,name:"Adding..."}]).insert(l,"beforeend"),a.editButton=tt.create([{color:"green",icons:["fa-edit"],name:"Edit",onClick:this.mgc_getValues.bind(this,a,!0)},{template:"loading",isDisabled:!0,name:"Editing..."}]).insert(l,"beforeend").hide(),tt.create([{color:"green",icons:["fa-arrow-circle-up"],name:"Import",onClick:this.mgc_importGiveaways.bind(this,a)},{template:"loading",isDisabled:!0,name:"Importing..."}]).insert(l,"beforeend"),tt.create([{color:"green",icons:["fa-arrow-circle-down"],name:"Export",onClick:this.mgc_exportGiveaways.bind(this,a)},{template:"loading",isDisabled:!0,name:"Exporting..."}]).insert(l,"beforeend"),tt.create([{color:"green",icons:["fa-random"],name:"Shuffle",onClick:this.mgc_shuffleGiveaways.bind(this,a)},{template:"loading",isDisabled:!0,name:"Shuffling..."}]).insert(l,"beforeend"),tt.create([{color:"green",icons:["fa-trash"],name:"Empty",onClick:this.mgc_emptyGiveaways.bind(this,a)},{template:"loading",isDisabled:!0,name:"Emptying..."}]).insert(l,"beforeend"),e=tt.create([{color:"green",icons:["fa-paperclip"],name:"Attach",onClick:this.mgc_attachDiscussion.bind(this,a)},{template:"loading",isDisabled:!0,name:"Attaching..."}]).insert(l,"beforeend"),this.esgst.mgc_createTrainSwitch.dependencies.push(e),d.get("mgc_createTrain")||e.hide(),a.viewButton=tt.create([{color:"green",icons:["fa-eye"],name:"View Results",onClick:this.mgc_viewResults.bind(this,a)},{template:"loading",isDisabled:!0,name:"Opening..."}]).insert(l,"beforeend").hide(),tt.create([{color:"green",icons:["fa-arrow-circle-right"],name:"Create",onClick:()=>new Promise(e=>this.mgc_createGiveaways(a,e))},{template:"loading",isDisabled:!0,name:"Creating..."}]).insert(l,"beforeend"),a.discussionPanel=qi(l,"beforeend",[{attributes:{class:"esgst-hidden"},type:"div",children:[{attributes:{class:"esgst-bold"},text:"Discussion Attached:",type:"span"},{type:"a"},{attributes:{class:"esgst-clickable fa fa-times",title:"Detach discussion"},type:"i"}]}]),n=a.discussionPanel.lastElementChild,n.addEventListener("click",this.mgc_detachDiscussion.bind(this,a)),a.discussionLink=n.previousElementSibling,new vt(a.discussionPanel,"mgc_bumpLast",!1,"Only insert the bump link in the last wagon.",!1,!1,"If disabled, the bump link will appear on all wagons.",d.get("mgc_bumpLast")),a.giveaways=qi(l,"beforeend",[{attributes:{class:"pinned-giveaways__outer-wrap"},type:"div",children:[{attributes:{class:"pinned-giveaways__inner-wrap"},type:"div"},{attributes:{class:"fa fa-trash",title:"Drag a giveaway here to remove it"},type:"i"},{attributes:{class:"esgst-description"},text:"To edit a giveaway, click on it and a 'Edit' button will appear. Then make your alterations and click 'Edit'.",type:"div"},{attributes:{class:"esgst-description"},text:"To edit multiple giveaways at once, hold the Ctrl key and click on the giveaways that you want tot edit. When giveaways are selected, an 'Edit' button will appear. Then make your alterations and click 'Edit'. When editing multiple giveaways, alterations to game, giveway type, number of copies and key list are not applied.",type:"div"},{attributes:{class:"esgst-description"},text:"Giveaways successfully created will turn green, giveaways successfully connected will be strikethrough (for train creations) and giveaways that were not successfully created will turn red.",type:"div"}]}]).firstElementChild,i=a.giveaways.nextElementSibling,i.addEventListener("dragenter",this.mgc_removeGiveaway.bind(this,a)),JSON.parse(r.get("mgcCache","[]")).forEach(e=>{this.mgc_addGiveaway(a,e)})}}mgc_generateFormat(){let e=new lt({addScrollable:!0,icon:"fa-gear",title:"Generate formats:"});qi(e.description,"afterbegin",[{attributes:{class:"esgst-description"},type:"div",children:[{text:"1. Generate the format you want by editing the input fields (the text outside of the blue box is what the result will look like).",type:"p"},{type:"br"},{text:"2. Copy the text inside of the blue box (you can use the copy icon for that).",type:"p"},{type:"br"},{text:"3. Paste it in the giveaway description (section 8 in this page), wherever you want it to appear.",type:"p"}]}]);let t={};qi(e.scrollable,"beforeend",[{attributes:{class:"esgst-bold"},text:"Next/previous links",type:"div"}]),t.previousPrefix=qi(e.scrollable,"beforeend",[{attributes:{class:"esgst-mgc-input",placeholder:"← ",type:"text"},type:"input"}]),t.previous=qi(e.scrollable,"beforeend",[{attributes:{class:"esgst-mgc-input",placeholder:"Previous",type:"text"},type:"input"}]),t.previousSuffix=qi(e.scrollable,"beforeend",[{attributes:{class:"esgst-mgc-input",placeholder:" ←",type:"text"},type:"input"}]),t.separator=qi(e.scrollable,"beforeend",[{attributes:{class:"esgst-mgc-input",placeholder:" | ",type:"text"},type:"input"}]),t.nextPrefix=qi(e.scrollable,"beforeend",[{attributes:{class:"esgst-mgc-input",placeholder:"→ ",type:"text"},type:"input"}]),t.next=qi(e.scrollable,"beforeend",[{attributes:{class:"esgst-mgc-input",placeholder:"Next",type:"text"},type:"input"}]),t.nextSuffix=qi(e.scrollable,"beforeend",[{attributes:{class:"esgst-mgc-input",placeholder:" →",type:"text"},type:"input"}]);let s=qi(e.scrollable,"beforeend",[{attributes:{class:"esgst-mgc-preview esgst-text-left markdown"},type:"div",children:[{type:"div",children:[{type:"p",children:[{text:"← ",type:"node"},{attributes:{href:"#"},text:"Previous",type:"a"},{text:" ← | → ",type:"node"},{attributes:{href:"#"},text:"Next",type:"a"},{text:" →",type:"node"}]}]},{type:"br"},{type:"pre",children:[{text:"[ESGST-P]← [P]Previous[/P] ←[/ESGST-P] | [ESGST-N]→ [N]Next[/N] →[/ESGST-N]",type:"code"}]},{attributes:{class:"esgst-clickable fa fa-copy"},type:"i"}]}]),n=s.firstElementChild,a=s.lastElementChild,i=a.previousElementSibling.firstElementChild;a.addEventListener("click",()=>{Di(a,i.textContent)}),qi(e.scrollable,"beforeend",[{attributes:{class:"esgst-bold"},text:"Counter",type:"div"}]),t.counter=qi(e.scrollable,"beforeend",[{attributes:{class:"esgst-mgc-input",placeholder:" of ",type:"text"},type:"input"}]);let o=qi(e.scrollable,"beforeend",[{attributes:{class:"esgst-mgc-preview esgst-text-left markdown"},type:"div",children:[{type:"div",children:[{text:"1 of 10",type:"p"}]},{type:"br"},{type:"pre",children:[{text:"[ESGST-C] of [/ESGST-C]",type:"code"}]},{attributes:{class:"esgst-clickable fa fa-copy"},type:"i"}]}]),r=o.firstElementChild,l=o.lastElementChild,c=l.previousElementSibling.firstElementChild;l.addEventListener("click",()=>{Di(l,c.textContent)}),qi(e.scrollable,"beforeend",[{attributes:{class:"esgst-bold"},text:"Bump link (for attached discussions)",type:"div"}]),t.bump=qi(e.scrollable,"beforeend",[{attributes:{class:"esgst-mgc-input",placeholder:"Bump",type:"text"},type:"input"}]);let d=qi(e.scrollable,"beforeend",[{attributes:{class:"esgst-mgc-preview esgst-text-left markdown"},type:"div",children:[{type:"div",children:[{type:"p",children:[{attributes:{href:"#"},text:"Bump",type:"a"}]}]},{type:"br"},{type:"pre",children:[{text:"[ESGST-B]Bump[/ESGST-B]",type:"code"}]},{attributes:{class:"esgst-clickable fa fa-copy"},type:"i"}]}]),g=d.firstElementChild,u=d.lastElementChild.previousElementSibling.firstElementChild;qi(e.scrollable,"beforeend",[{attributes:{class:"esgst-bold"},text:"First train wagon link (for attached discussions)",type:"div"}]),t.train=qi(e.scrollable,"beforeend",[{attributes:{class:"esgst-mgc-input",placeholder:"Choo choo!",type:"text"},type:"input"}]);let m=qi(e.scrollable,"beforeend",[{attributes:{class:"esgst-mgc-preview esgst-text-left markdown"},type:"div",children:[{type:"div",children:[{type:"p",children:[{attributes:{href:"#"},text:"Choo choo!",type:"a"}]}]},{type:"br"},{type:"pre",children:[{text:"[ESGST-T]Choo choo![/ESGST-T]",type:"code"}]},{attributes:{class:"esgst-clickable fa fa-copy"},type:"i"}]}]),h=m.firstElementChild,p=m.lastElementChild,f=p.previousElementSibling.firstElementChild;p.addEventListener("click",()=>{Di(p,f.textContent)});for(let e in t)if(t.hasOwnProperty(e)){let s=t[e];s.addEventListener("input",async()=>{if("counter"===e)c.textContent=`[ESGST-C]${s.value}[/ESGST-C]`,Se.insert(r,"atinner",Se.element("fragment",null,await Wi(null,`1${s.value}10`)));else if("bump"===e)u.textContent=`[ESGST-B]${s.value}[/ESGST-B]`,Se.insert(g,"atinner",Se.element("fragment",null,await Wi(null,`[${s.value}](#)`)));else if("train"===e)f.textContent=`[ESGST-B]${s.value}[/ESGST-B]`,Se.insert(h,"atinner",Se.element("fragment",null,await Wi(null,`[${s.value}](#)`)));else{let e="",s="";t.previousPrefix.value||t.previousSuffix.value?(s+=`[ESGST-P]${t.previousPrefix.value}[P]${t.previous.value}[/P]${t.previousSuffix.value}[/ESGST-P]`,e+=`${t.previousPrefix.value}[${t.previous.value}](#)${t.previousSuffix.value}`):(s+=`[ESGST-P]${t.previous.value}[/ESGST-P]`,e+=`[${t.previous.value}](#)`),t.separator.value&&(s+=t.separator.value,e+=t.separator.value),t.nextPrefix.value||t.nextSuffix.value?(s+=`[ESGST-N]${t.nextPrefix.value}[N]${t.next.value}[/N]${t.nextSuffix.value}[/ESGST-N]`,e+=`${t.nextPrefix.value}[${t.next.value}](#)${t.nextSuffix.value}`):(s+=`[ESGST-N]${t.next.value}[/ESGST-N]`,e+=`[${t.next.value}](#)`),i.textContent=s,Se.insert(n,"atinner",Se.element("fragment",null,await Wi(null,e)))}s.style.width=s.value.length+75+"px"})}e.open()}async mgc_getValues(e,t){if(d.get("ngdc")&&await c.esgst.modules.giveawaysNewGiveawayDescriptionChecker.check(e.description.value))return;const s=t&&e.selected.length>0;let n={};if(s||(n.gameId=e.gameId.value,n.gameType=e.gameType.value,n.copies=e.copies.value,n.keys=e.keys.value),s||n.gameId&&("gift"===n.gameType&&parseInt(n.copies)>0||"key"===n.gameType&&n.keys)){if(this.esgst.busy=!0,n.countries=e.countries.value.trim(),s||(n.gameName=e.gameName.value),n.startTime=e.startTime.value,n.endTime=e.endTime.value,n.region=e.region.value,n.whoCanEnter=e.whoCanEnter.value,n.whitelist=e.whitelist.value,n.groups=e.groups.value.trim(),n.level=e.level.value,n.description=e.description.value,!s){const t=document.querySelector(`[data-autocomplete-id="${n.gameId}"]`);t&&(n.steam=await this.esgst.modules.games.games_getInfo(t)),n.steam||(n.steam=e.values[e.editPos]&&e.values[e.editPos].steam)}if(d.get("mgc_createTrain")&&e.description.value.match(/\[ESGST-P|\[ESGST-N/)||!d.get("mgc_createTrain"))if(e.discussion&&e.description.value.match(/\[ESGST-B]/)||!e.discussion){if(s){let t=Object.fromEntries(Object.entries(n).filter(([,e])=>e));for(const s of e.selected)this.mgc_addGiveaway(e,{...e.values[s],...t},s),e.giveaways.children[s].classList.remove("selected")}else this.mgc_addGiveaway(e,n,t?e.editPos:null);this.mgc_updateCache(e),e.copies.value="1",e.keys.value="",t&&(e.editButton.hide(),e.addButton.show()),s&&(e.selected=[])}else Gi("The bump link format is missing from the description.");else Gi("The next/previous links format is missing from the description.")}else Gi("You must first fill the details of the giveaway.")}mgc_addGiveaway(e,t,s){let n,a;a=t.gameName.replace(/"/g,"&quot;")+"\n","gift"===t.gameType?a+=`Gift\n${t.copies} Copies\n`:a+=`Keys\n${t.keys}\n`,a+=`\n${t.startTime} - ${t.endTime}\n`,"1"===t.region&&(a+="Region Restricted\n"),"everyone"===t.whoCanEnter?a+="Public\n":"invite_only"===t.whoCanEnter?a+="Invite Only\n":("1"===t.whitelist&&(a+="Whitelist\n"),t.groups.trim()&&(a+="Groups\n")),t.description=t.description.replace(/\[ESGST-LEVEL]/gi,t.level).replace(/\[ESGST-NAME]/gi,t.gameName).replace(/\[ESGST-STEAM-ID]/gi,t.steam?t.steam.id:"$0").replace(/\[ESGST-STEAM-TYPE]/gi,t.steam?t.steam.type.slice(0,-1):"$0").replace(/\[ESGST-STEAM-URL]/gi,t.steam?`http://store.steampowered.com/${t.steam.type.slice(0,-1)}/${t.steam.id}`:"$0"),a+=`Level ${t.level}\n\n${t.description}`,n=`xsrf_token=${Be.xsrfToken}&next_step=3&game_id=${t.gameId}&type=${t.gameType}&copies=${t.copies}&key_string=${encodeURIComponent(t.keys)}&timezone=${e.timezone}&start_time=${encodeURIComponent(t.startTime)}&end_time=${encodeURIComponent(t.endTime)}&region_restricted=${t.region}&country_item_string=${encodeURIComponent(t.countries)}&who_can_enter=${t.whoCanEnter}&whitelist=${t.whitelist}&group_item_string=${encodeURIComponent(t.groups)}&contributor_level=${t.level}&description=${encodeURIComponent(t.description)}`,l.isSet(s)?(e.datas[s]=n,e.values[s]=t,e.giveaways.children[s].title=a):(e.datas.push(n),e.values.push(t),this.mgc_setGiveaway(qi(e.giveaways,"beforeend",[{attributes:{class:"esgst-gm-giveaway",draggable:!0,title:a},text:e.datas.length,type:"div"}]),e))}mgc_setGiveaway(e,t){e.addEventListener("click",s=>{if(s.ctrlKey){const s=parseInt(e.textContent)-1;t.selected.includes(s)?t.selected=t.selected.filter(e=>e!==s):t.selected.push(s),e.classList.toggle("selected"),this.mgc_toggleEditButton(t)}else this.mgc_setValues(e,t)}),e.addEventListener("dragstart",this.mgc_setSource.bind(this,e,t)),e.addEventListener("dragenter",this.mgc_getSource.bind(this,e,t))}mgc_setValues(e,t){let s,n;s=parseInt(e.textContent)-1,n=t.values[s],t.countries.value=n.countries,t.gameId.value=n.gameId,t.gameType.value=n.gameType,t.copies.value=n.copies,t.keys.value=n.keys||"",t.gameName.value=n.gameName,t.startTime.value=n.startTime,t.endTime.value=n.endTime,t.region.value=n.region,t.whoCanEnter.value=n.whoCanEnter,t.whitelist.value=n.whitelist,t.groups.value=n.groups,t.level.value=n.level,t.description.value=n.description,n.edit=!0,this.esgst.modules.giveawaysGiveawayTemplates.gts_applyTemplate(n),t.editPos=s,t.editButton.show(),t.addButton.hide()}mgc_setSource(e,t,s){t.source=e,s.dataTransfer.setData("text/plain","")}mgc_getSource(e,t){let s;s=t.source;do{if(s=s.previousElementSibling,s&&s===e)return t.giveaways.insertBefore(t.source,e),void this.mgc_updateCache(t)}while(s);t.giveaways.insertBefore(t.source,e.nextElementSibling),this.mgc_updateCache(t)}mgc_importGiveaways(e){let t,s,n,a,i;s=new lt({addScrollable:!0,icon:"fa-arrow-up",isTemp:!0,title:"Import Giveaways"}),s.popup.classList.add("esgst-popup-large"),qi(s.description,"afterbegin",[{attributes:{class:"esgst-description"},type:"div",children:[{text:"Insert the keys below. ",type:"node"},{attributes:{class:"fa fa-question-circle"},type:"i"}]}]),Ri(s.description.firstElementChild.lastElementChild,`\n\t\t\t<div>Before importing, make sure you have filled the details of the giveaway (start/end times, regions, who can enter, whitelist, groups, level and description) or applied a template (with ${Oi("gts").number} Giveaway Templates). You can also specify separate details for each giveaway using the parameters below:</div>\n\t\t\t<ul>\n\t\t\t\t<li><span class="esgst-bold">[countries="..."]</span> (Replace the 3 dots with the ids of the countries that the giveaway must be restricted to, separated by a comma followed by a space. The ids must be exactly how they appear in the country selection list. For example, "BR, US". If you do not want the giveaway to be region restricted, use the id "*", for example, [countries="*"].)</li>\n\t\t\t\t<li><span class="esgst-bold">[startTime="..."]</span> (Replace the 3 dots with the date that the giveaway must start, in the format "Mon D, YYYY H:MM xm". For example, "Jan 15, 2018 12:00 am". For the names of the months, use "Jan", "Feb", "Mar", "Apr", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov" and "Dec". For single-digit days/hours, do not put a 0 at the beginning. For example, use "Jan 1" instead of "Jan 01" and "9:00 am" instead of "09:00 am".)</li>\n\t\t\t\t<li><span class="esgst-bold">[endTime="..."]</span> (Replace the 3 dots with the date that the giveaway must end, in the same format as the start time.)</li>\n\t\t\t\t<li><span class="esgst-bold">[whoCanEnter="..."]</span> (Replace the 3 dots with either: "everyone", if the giveaway must be public; "invite_only", if the giveaway must be private; or "groups", if the giveaway must be restricted to groups/whitelist.)</li>\n\t\t\t\t<li><span class="esgst-bold">[groups="..."]</span> (Replace the 3 dots with the names of the groups that the giveaway must be restricted to, separated by a comma followed by a space. The names must be exactly how they appear on the group selection list. Use "My Whitelist" to include your whitelist in the groups. For example, "My Whitelist, Playing Appreciated, S.Gifts" or "My Whitelist".)</li>\n\t\t\t\t<li><span class="esgst-bold">[level="..."]</span> (Replace the 3 dots with the level that the giveaway must be restricted to. For example, "5".)</li>\n\t\t\t\t<li><span class="esgst-bold">[description="..."]</span> (Replace the 3 dots with the description that the giveaway must have. Use "\\n" to represent a new line. You can use all of the variables explained in the "How To Use" tooltip from section 0 here. For example, "The winner will be added on Steam for the delivery.\\n\\nPlease be patient.".)</li>\n\t\t\t</ul>\n\t\t\t<div>Put each giveaway in a separate line, using one of the formats below:</div>\n\t\t\t<ul>\n\t\t\t\t<li>Gift giveaways for 1 copy.</li>\n\t\t\t\t<ul>\n\t\t\t\t\t<li><span class="esgst-bold">Game Name</span></li>\n\t\t\t\t\t<li><span class="esgst-bold">Game Name https://store.steampowered.com/xxx/XXXXX</span></li>\n\t\t\t\t\t<li><span class="esgst-bold">https://store.steampowered.com/xxx/XXXXX</span></li>\n\t\t\t\t</ul>\n\t\t\t\t<li>Gift giveaways for more than 1 copy. Replace the X with the number of copies.</li>\n\t\t\t\t<ul>\n\t\t\t\t\t<li><span class="esgst-bold">Game Name (X Copies)</span></li>\n\t\t\t\t\t<li><span class="esgst-bold">Game Name https://store.steampowered.com/xxx/XXXXX (X Copies)</span></li>\n\t\t\t\t\t<li><span class="esgst-bold">https://store.steampowered.com/xxx/XXXXX (X Copies)</span></li>\n\t\t\t\t</ul>\n\t\t\t\t<li>Key giveaways. Gift links are also acceptable, so instead of "XXXXX-XXXXX-XXXXX" you can have "https://www.humblebundle.com/?gift=XxXXxxXXxXxxxXxx". For a link to be recognized it must start with either "http" or "https".</li>\n\t\t\t\t<ul>\n\t\t\t\t\t<li><span class="esgst-bold">Game Name XXXXX-XXXXX-XXXXX</span></li>\n\t\t\t\t\t<li><span class="esgst-bold">Game Name https://store.steampowered.com/xxx/XXXXX XXXXX-XXXXX-XXXXX</span></li>\n\t\t\t\t\t<li><span class="esgst-bold">https://store.steampowered.com/xxx/XXXXX XXXXX-XXXXX-XXXXX</span></li>\n\t\t\t\t\t<li><span class="esgst-bold">XXXXX-XXXXX-XXXXX Game Name</span></li>\n\t\t\t\t\t<li><span class="esgst-bold">XXXXX-XXXXX-XXXXX Game Name https://store.steampowered.com/xxx/XXXXX</span></li>\n\t\t\t\t\t<li><span class="esgst-bold">XXXXX-XXXXX-XXXXX https://store.steampowered.com/xxx/XXXXX</span></li>\n\t\t\t\t</ul>\n\t\t\t</ul>\n\t\t\t<div>By using the format that includes the link to the Steam store page of the game (https://store.steampowered.com/xxx/XXXXX), you make sure that if there are multiple games with the same name there will be a 100% match. If you do not use that format and there are multiple games with the same name, a popup will appear for you to decide which game should be used.</div>\n\t\t\t<br>\n\t\t\t<div>Here's an example:</div>\n\t\t\t<br>\n\t\t\t<div class="esgst-bold">Portal</div>\n\t\t\t<div class="esgst-bold">Portal XXXXX-XXXXX-XXXXX</div>\n\t\t\t<div class="esgst-bold">YYYYY-YYYYY-YYYYY Portal</div>\n\t\t\t<div class="esgst-bold">Portal https://store.steampowered.com/app/400 (2 Copies)</div>\n\t\t\t<div class="esgst-bold">https://store.steampowered.com/app/400 ZZZZZ-ZZZZZ-ZZZZZ</div>\n\t\t\t<br>\n\t\t\t<div>This example will create the 5 following giveaways if the options "Group adjacent keys for the same game." and "Group all keys for the same game." are disabled:</div>\n\t\t\t<br>\n\t\t\t<div>1 Portal giveaway for 1 gift copy.</div>\n\t\t\t<div>1 Portal giveaway for 1 key (XXXXX-XXXXX-XXXXX).</div>\n\t\t\t<div>1 Portal giveaway for 1 key (YYYYY-YYYYY-YYYYY).</div>\n\t\t\t<div>1 Portal giveaway for 2 gift copies.</div>\n\t\t\t<div>1 Portal giveaway for 1 key (ZZZZZ-ZZZZZ-ZZZZZ).</div>\n\t\t\t<br>\n\t\t\t<div>If the option "Group adjacent keys for the same game." is enabled, however, only 4 giveaways will be created, because the keys in the 2nd and 3rd giveaways are for the same game (Portal) and are adjacent (next to each other), so they will be grouped together in the same giveaway. Note that the key in the 5th giveaway is not adjacent, because the 4th giveaway is separating it from the others. So with this option enabled the 4 following giveaways will be created:</div>\n\t\t\t<br>\n\t\t\t<div>1 Portal giveaway for 1 gift copy.</div>\n\t\t\t<div>1 Portal giveaway for 2 keys (XXXXX-XXXXX-XXXXX and YYYYY-YYYYY-YYYYY).</div>\n\t\t\t<div>1 Portal giveaway for 2 gift copies.</div>\n\t\t\t<div>1 Portal giveaway for 1 key (ZZZZZ-ZZZZZ-ZZZZZ).</div>\n\t\t\t<br>\n\t\t\t<div>But if the option "Group all keys for the same game." is enabled, then only 3 giveaways will be created, because every single key found for the same game will be grouped together in a single giveaway, regardless of whether or not they are next to each other. So with this option enabled the 3 following giveaways will be created:</div>\n\t\t\t<br>\n\t\t\t<div>1 Portal giveaway for 1 gift copy.</div>\n\t\t\t<div>1 Portal giveaway for 3 keys (XXXXX-XXXXX-XXXXX, YYYYY-YYYYY-YYYYY and ZZZZZ-ZZZZZ-ZZZZZ).</div>\n\t\t\t<div>1 Portal giveaway for 2 gift copies.</div>\n\t\t\t<br>\n\t\t\t<div>And here's an example using separate details for each giveaway:</div>\n\t\t\t<br>\n\t\t\t<div class="esgst-bold">Portal [countries="BR, US"] [level="5"]</div>\n\t\t\t<div class="esgst-bold">Portal XXXXX-XXXXX-XXXXX [whoCanEnter="groups"] [groups="Playing Appreciated"]</div>\n\t\t\t<div class="esgst-bold">YYYYY-YYYYY-YYYYY Portal [whoCanEnter="groups"] [groups="My Whitelist"]</div>\n\t\t\t<div class="esgst-bold">Portal (2 Copies) [startTime="Apr 1, 2018 9:00 am"] [endTime="Apr 11, 2018 15:00 pm"] [whoCanEnter="invite_only"]</div>\n\t\t\t<div class="esgst-bold">Portal ZZZZZ-ZZZZZ-ZZZZZ [level="8"] [description="Appreciation for high level users.\\n\\nEnjoy!"]</div>\n\t\t\t<br>\n\t\t\t<div>Note that any missing parameters will be copied from the details that you have filled for the giveaway in the SteamGifts page. So, for example, if you have selected Everyone for Who Can Enter, the 1st and 5th giveaways will be public, because [whoCanEnter="..."] was not specified for them, so that detail will be copied over from the SteamGifts page.</div>\n\t\t\t<br>\n\t\t\t<div>Imported giveaways will not be automatically created, you still have to review them by clicking on the 'Create' button.</div>\n\t\t\t<br>\n\t\t`);let o=new vt(s.description,"mgc_groupKeys",!1,"Group adjacent keys for the same game.",!1,!1,"",d.get("mgc_groupKeys")),r=new vt(s.description,"mgc_groupAllKeys",!1,"Group all keys for the same game.",!1,!1,"",d.get("mgc_groupAllKeys"));o.exclusions.push(r.container),r.exclusions.push(o.container),d.get("mgc_groupKeys")?r.container.classList.add("esgst-hidden"):d.get("mgc_groupAllKeys")&&o.container.classList.add("esgst-hidden"),i=qi(s.scrollable,"beforeend",[{type:"textarea"}]),a=qi(s.description,"beforeend",[{type:"div",children:[{attributes:{class:"esgst-progress-bar"},type:"div"},{type:"div",children:[{text:"0",type:"span"},{text:" of ",type:"node"},{text:"0",type:"span"},{text:" giveaways imported.",type:"node"}]}]}]),n={bar:a.firstElementChild,current:void 0,total:void 0},t=a.lastElementChild,n.current=t.firstElementChild,n.total=n.current.nextElementSibling,tt.create([{color:"green",icons:["fa-arrow-circle-up"],name:"Import",onClick:()=>new Promise(t=>this.mgc_getGiveaways(e,s,n,i,t))},{template:"loading",isDisabled:!0,name:"Importing..."}]).insert(s.description,"beforeend"),s.open(this.mgc_focusTextArea.bind(this,i)),i.style.height=.9*window.innerHeight-(s.popup.offsetHeight-s.scrollable.offsetHeight)-25+"px",i.style.overflow="auto",i.addEventListener("paste",this.mgc_resizeTextArea.bind(this,s,i))}mgc_resizeTextArea(e,t){let s,n;n=t.value,s=window.setInterval(()=>{n!==t.value&&(window.clearInterval(s),t.style.height=.9*window.innerHeight-(e.popup.offsetHeight-e.scrollable.offsetHeight)-25+"px",t.style.overflow="auto")},250)}mgc_getGiveaways(e,t,s,n,a){let i,o,r,l,c;this.esgst.busy=!0,i=[],o=n.value.trim().split(/\n/);for(let e=0,t=o.length;e<t;++e){const t=o[e].trim();t&&i.push(t)}n.value=i.join("\n")+"\n",l=i.length,window.$(s.bar).progressbar("instance")?(r=window.$(s.bar).progressbar("option","max"),c=window.$(s.bar).progressbar("option","value"),c+l!==r&&(window.$(s.bar).progressbar({max:c+l,value:c}),s.total.textContent=c+l)):(window.$(s.bar).progressbar({max:l}),s.total.textContent=l),this.mgc_importGiveaway(i,0,e,l,t,s,n,()=>{this.mgc_updateCache(e),t.close()},a)}async mgc_importGiveaway(e,t,s,n,a,i,o,r,l){let c,g,u,m,h,p,f,b,w;if(t<n){let y=e[t].match(/\[countries="(.+?)"]/),v=e[t].match(/\[startTime="(.+?)"]/),_=e[t].match(/\[endTime="(.+?)"]/),k=e[t].match(/\[whoCanEnter="(.+?)"]/),x=e[t].match(/\[groups="(.+?)"]/),A=e[t].match(/\[level="(.+?)"]/),C=e[t].match(/\[description="(.+?)"]/);if(d.get("mgc_createTrain")&&!(C&&C[1]||s.description.value||"").match(/\[ESGST-P]|\[ESGST-N]/))return Gi("The next/previous links format is missing from the description."),void l();if(s.discussion&&!(C&&C[1]||s.description.value||"").match(/\[ESGST-B]/))return Gi("The bump link format is missing from the description."),void l();if(y)if("*"===y[1])y="*";else{let e=y[1].split(/,\s/);y="",e.forEach(e=>{let t=document.querySelector('[data-input="country_item_string"]').querySelector(`[data-name$="${e}"]`);t&&(y+=t.getAttribute("data-item-id")+" ")})}let S="";if(x){let e=x[1].split(/,\s/);x="",e.forEach(e=>{if("My Whitelist"===e)return void(S="1");let t=document.querySelector('[data-input="group_item_string"]').querySelector(`[data-name$="${e}"]`);t&&(x+=t.getAttribute("data-item-id")+" ")})}let E=e[t].match(/https?:\/\/.*?store\.steampowered\.com\/(app|sub)\/(\d+)/),T=null;if(E&&(T={id:E[2],type:E[1]+"s"}),e[t]=e[t].replace(/\[(.+?)="(.+?)"]/g,"").replace(/https?:\/\/.*?store\.steampowered\.com(.*?\s|.*)/,"[ESGST] ").trim(),p=e[t].match(/^(([\d\w]{5}(-[\d\w]{5}){2,}\s?|https?:\/\/.+?\s?)+)\s(.+)$/),p?(m=!0,h=1,b=4):(p=e[t].match(/^(.+?)\s(([\d\w]{5}(-[\d\w]{5}){2,}\s?|https?:\/\/.+?\s?)+)$/),p?(m=!0,h=2,b=1):(p=e[t].match(/^(.+?)(\s\((\d+?)\sCopies\))?$/),p&&(m=!1,b=1))),p){f=p[b].replace(/\[ESGST]/,"").trim().toLowerCase(),w={countries:("*"===y?"":y||s.countries.value||"").trim(),startTime:v&&v[1]||s.startTime.value||"",endTime:_&&_[1]||s.endTime.value||"",region:"*"===y?"0":y?"1":s.region.value||"0",whoCanEnter:k&&k[1]||s.whoCanEnter.value||"everyone",whitelist:S||s.whitelist.value||"0",groups:(x||s.groups.value||"").trim(),level:A&&A[1]||s.level.value||"0",description:C?C[1].replace(/\\n/g,"\n"):s.description.value||"",gameType:void 0,keys:void 0,copies:void 0},m?(w.gameType="key",w.keys=p[h].replace(/\s/g,"\n")):(w.gameType="gift",c=p[3],w.copies=c||"1");let E=[e[t]];if((d.get("mgc_groupKeys")||d.get("mgc_groupAllKeys"))&&m){let s=t;do{if(g=!1,u=e[s+1],u){let t=u.match(/https?:\/\/.*?store\.steampowered\.com\/(app|sub)\/(\d+)/),a=null;t&&(a={id:t[2],type:t[1]+"s"}),u=u.replace(/\[(.+?)="(.+?)"]/g,"").replace(/https?:\/\/.*?store\.steampowered\.com(.*?\s|.*)/,"[ESGST] ").trim(),p=u.match(/^(([\d\w]{5}(-[\d\w]{5}){2,}\s?|https?:\/\/.+?\s?)+)\s(.+)$/),p?(m=!0,h=1,b=4):(p=u.match(/^(.+?)\s(([\d\w]{5}(-[\d\w]{5}){2,}\s?|https?:\/\/.+?\s?)+)$/),p?(m=!0,h=2,b=1):m=!1),p&&m&&(f&&p[b].replace(/\[ESGST]/,"").trim().toLowerCase()===f||a&&T&&a.type===T.type&&a.id===T.id)&&(g=!0,w.keys+="\n"+p[h].replace(/\s/g,"\n"),E.push(e.splice(s+1,1)[0]),s--,n--)}s++}while(d.get("mgc_groupKeys")&&g||d.get("mgc_groupAllKeys")&&e[s+1])}this.mgc_getGiveaway(e,t+1,E,s,n,f,a,i,T,o,w,r,l,await Ne.post("/ajax.php",{data:"do=autocomplete_giveaway_game&page_number=1&search_query="+encodeURIComponent(T&&T.id||f)}))}else Gi('The next giveaway is not in the right format. Please correct it and click on "Import" again to continue importing.'),l()}else r()}async mgc_getGiveaway(e,t,s,n,a,i,o,r,l,c,d,g,u,m){let h,p,f,b,w,y,v,_,k,x;for(b=Se.parse(m.json.html).getElementsByClassName("table__row-outer-wrap"),w=null,_=[],v=0,k=b.length;v<k;v++)if(f=b[v],f.getAttribute("data-autocomplete-name").toLowerCase()===i)if(l){if(y=await this.esgst.modules.games.games_getInfo(f),l.type===y.type&&l.id===y.id){w=f;break}}else _.push(f);else if(l&&(y=await this.esgst.modules.games.games_getInfo(f),l.type===y.type&&l.id===y.id)){w=f;break}w||1!==_.length||(w=_[0]),w?(d.gameName=w.getAttribute("data-autocomplete-name"),d.gameId=w.getAttribute("data-autocomplete-id"),d.steam=await this.esgst.modules.games.games_getInfo(w),this.mgc_addGiveaway(n,d),x=window.$(r.bar).progressbar("option","value")+s.length,window.$(r.bar).progressbar("option","value",x),r.current.textContent=x,s.forEach(e=>{c.value=c.value.replace(e+"\n","")}),window.setTimeout(()=>this.mgc_importGiveaway(e,t,n,a,o,r,c,g,u),0)):_.length>0?(h=new lt({icon:"fa-exclamation",isTemp:!0,title:`There are ${_.length} matches for ${i}. Please select the correct match.`,addScrollable:"left"}),p=h.getScrollable(),_.forEach(i=>{let l=qi(p,"beforeend",[{context:i.cloneNode(!0)}]);l.classList.remove("is-clickable");const m=tt.create({color:"green",icons:["fa-arrow-circle-right"],name:"Select",onClick:async()=>{h.close(),d.gameName=l.getAttribute("data-autocomplete-name"),d.gameId=l.getAttribute("data-autocomplete-id"),d.steam=await this.esgst.modules.games.games_getInfo(l),this.mgc_addGiveaway(n,d),x=window.$(r.bar).progressbar("option","value")+s.length,window.$(r.bar).progressbar("option","value",x),r.current.textContent=x,s.forEach(e=>{c.value=c.value.replace(e+"\n","")}),window.setTimeout(()=>this.mgc_importGiveaway(e,t,n,a,o,r,c,g,u),0)}}).insert(l,"afterbegin");m.nodes.outer.style.position="absolute",m.nodes.outer.style.right="50px"}),h.onClose=u,h.open()):(Gi((l&&`${l.type}/${l.id}`||i)+' was not found! Please correct the title of the game and click on "Import" again to continue importing (it must be exactly like on Steam).'),u())}mgc_focusTextArea(e){e.focus()}mgc_exportGiveaways(e){let t,s,n,a,i,o;i=new lt({addScrollable:!0,icon:"fa-arrow-down",title:"Export"}),new vt(i.description,"mgc_reversePosition",!1,"Export keys in reverse position (before the name of the game).",!1,!1,"",d.get("mgc_reversePosition")),tt.create({color:"green",icons:["fa-arrow-down"],name:"Export",onClick:()=>{for(t="",s=0,a=e.giveaways.children.length;s<a;++s)if(o=e.giveaways.children[s].title.split(/\n/),"Gift"===o[1])parseInt(o[2].match(/\d+/)[0])>1?t+=`${o[0]} (${o[2]})\r\n`:t+=o[0]+"\r\n";else for(n=2;o[n];++n)d.get("mgc_reversePosition")?t+=`${o[n]} ${o[0]}\r\n`:t+=`${o[0]} ${o[n]}\r\n`;Mi(t,"giveaways.txt")}}).insert(i.description,"beforeend"),i.open()}mgc_emptyGiveaways(e){window.confirm("Are you sure you want to empty the creator?")&&(r.delete("mgcCache"),this.esgst.busy=!1,e.datas=[],e.values=[],e.selected=[],e.created=[],e.createdValues=[],e.giveaways.innerHTML="",e.copies.value="1",e.keys.value="")}mgc_createGiveaways(e,t){if(!e.datas.length)return Gi('There are no giveaways in the queue. Click on the "Add" button to add a giveaway to the queue.'),void t();let s=new lt({addScrollable:!0,icon:"fa-arrow-circle-right",title:"ESGST will create the giveaways below. Are you sure you want to continue?"}),n=qi(s.scrollable,"beforeend",[{attributes:{class:"table esgst-mgc-table"},type:"div",children:[{attributes:{class:"table__heading"},type:"div",children:[{attributes:{class:"table__column--width-small"},text:"No.",type:"div"},{attributes:{class:"table__column--width-fill"},text:"Game",type:"div"},{attributes:{class:"table__column--width-small"},text:"Copies/Keys",type:"div"},{attributes:{class:"table__column--width-small"},text:"Start Time",type:"div"},{attributes:{class:"table__column--width-small"},text:"End Time",type:"div"},{attributes:{class:"table__column--width-small"},text:"Region Restricted",type:"div"},{attributes:{class:"table__column--width-small"},text:"Who Can Enter",type:"div"},{attributes:{class:"table__column--width-small"},text:"Level",type:"div"},{attributes:{class:"table__column--width-small"},text:"Description",type:"div"}]},{attributes:{class:"table__rows"},type:"div"}]}]).lastElementChild;for(let t=0,s=e.giveaways.children.length;t<s;t++){let s=e.values[parseInt(e.giveaways.children[t].textContent)-1],a="No";"1"===s.region&&(a="Yes (",s.countries.split(/\s/).forEach(t=>{a+=e.countryNames[t].match(/.+\s(.+)$/)[1]+", "}),a=a.slice(0,-2)+")");let i="Everyone";"invite_only"===s.whoCanEnter?i="Invite Only":"groups"===s.whoCanEnter&&(i="Groups (","1"===s.whitelist&&(i+="Whitelist, "),s.groups&&s.groups.split(/\s/).forEach(t=>{i+=e.groupNames[t]+", "}),i=i.slice(0,-2)+")");let o=[];if(s.keys)for(const e of s.keys.split(/\n/))e&&o.push({text:e,type:"node"},{type:"br"});qi(n,"beforeend",[{attributes:{class:"table__row-outer-wrap"},type:"div",children:[{attributes:{class:"table__row-inner-wrap"},type:"div",children:[{attributes:{class:"table__column--width-small"},text:t+1,type:"div"},{attributes:{class:"table__column--width-fill"},type:"div",children:[s.steam?{attributes:{class:"table__column__secondary-link",href:`https://store.steampowered.com/${s.steam.type.slice(0,-1)}/${s.steam.id}`},text:s.gameName,type:"a"}:{text:s.gameName,type:"span"}]},{attributes:{class:"table__column--width-small"},text:o.length?null:s.copies+" Copies",type:"div",children:o.length?o:null},{attributes:{class:"table__column--width-small"},text:s.startTime,type:"div"},{attributes:{class:"table__column--width-small"},text:s.endTime,type:"div"},{attributes:{class:"table__column--width-small"},text:a,type:"div"},{attributes:{class:"table__column--width-small"},text:i,type:"div"},{attributes:{class:"table__column--width-small"},text:s.level,type:"div"},{attributes:{class:"table__column--width-small",title:s.description.replace(/"/g,"&quot;")},text:s.description.length>100?s.description.slice(0,100)+"...":s.description,type:"div"}]}]}])}tt.create({template:"success",name:"Yes",onClick:this.mgc_createGiveaways_2.bind(this,e,s,t)}).insert(s.description,"beforeend"),tt.create({template:"error",name:"No",onClick:()=>s.close()}).insert(s.description,"beforeend"),s.onClose=()=>{s.isOpen&&t()},s.open()}mgc_createGiveaways_2(e,t,s){t.onClose=null,t.close(),e.copies.value="1",e.keys.value="",e.viewButton.hide(),e.saveGiveaways={},this.mgc_createGiveaway(0,e,e.giveaways.children.length,d.get("cewgd")||d.get("gc")&&d.get("gc_gi")||d.get("lpv")||d.get("rcvc")?this.mgc_saveGiveaways.bind(this,e,this.mgc_completeCreation.bind(this,e,s)):this.mgc_completeCreation.bind(this,e,s))}async mgc_createGiveaway(e,t,s,n){if(e<s)if(t.giveaways.children[e].classList.contains("success"))window.setTimeout(()=>this.mgc_createGiveaway(e+1,t,s,n),0);else{const a=parseInt(t.giveaways.children[e].textContent)-1;this.mgc_checkCreation(e,t,s,n,await Ne.post("/giveaways/new",{data:t.datas[a].replace(/start_time=(.+?)&/,this.mgc_correctTime.bind(this))}))}else d.get("mgc_createTrain")?this.mgc_createTrain(0,t,t.created.length,n):n()}mgc_correctTime(e,t){const s=Date.now()+5e3;return new Date(decodeURIComponent(t)).getTime()<s?`start_time=${encodeURIComponent(xe(s,this.esgst.newGiveawayDateFormat))}&`:e}async mgc_checkCreation(e,t,s,n,a){let i,o,r,l,c,g;if(r=t.giveaways.children[e],a.url.match(/\/giveaways\/new/))if(a.text.match(/Error\.\sYou\salready\sposted\san\sidentical\sgiveaway\swithin\sthe\spast\s2\sminutes\.\sTo\sprevent\sdouble\sposts,\sit's\sbeen\sblocked\./)){const a=new lt({addScrollable:!0,icon:"fa-circle-o-notch fa-spin",title:Se.element("fragment",null,"Waiting ",Se.element("span",null)," minutes to create another identical giveaway... Please do not close this popup. If you do not want this waiting period, create a single multiple-copy giveaway for the game.")});a.open(),ji(a.title.firstElementChild,120,async()=>{a.close();const i=parseInt(t.giveaways.children[e].textContent)-1;window.setTimeout(async()=>this.mgc_checkCreation(e,t,s,n,await Ne.post("/giveaways/new",{data:t.datas[i].replace(/start_time=(.+?)&/,this.mgc_correctTime.bind(this))})),0)})}else{for(r.classList.add("error"),i=a.html.getElementsByClassName("form__row__error"),o="Errors:\n",l=0,c=i.length;l<c;++l)o+=i[l].textContent+"\n";o+="\n",r.title=`${o}${r.title}`,window.setTimeout(()=>this.mgc_createGiveaway(++e,t,s,n),0)}else r.classList.add("success"),g=a.html,t.created.push({giveaway:r,html:(await Bi(g,a.url)).html,url:a.url}),t.createdValues.push(t.values[e]),d.get("cewgd")||d.get("gc")&&d.get("gc_gi")||d.get("lpv")||d.get("rcvc")?(r=(await this.esgst.modules.giveaways.giveaways_get(g,!1,a.url))[0],r&&(t.saveGiveaways[r.code]=r),window.setTimeout(()=>this.mgc_createGiveaway(++e,t,s,n),0)):window.setTimeout(()=>this.mgc_createGiveaway(++e,t,s,n),0)}async mgc_saveGiveaways(e,t){let s,n={steamId:d.get("steamId"),username:d.get("username")};const a=await Fi(null,n);let i=null;if(a&&(i=a.giveaways),!i&&(i={sent:{apps:{},subs:{}},won:{apps:{},subs:{}},sentTimestamp:0,wonTimestamp:0},a&&(s=a.ugd,s))){if(s.sent){for(let t in s.sent.apps)if(s.sent.apps.hasOwnProperty(t)){i.sent.apps[t]=[];for(let n=0,a=s.sent.apps[t].length;n<a;++n)e.saveGiveaways[s.sent.apps[t][n].code]=s.sent.apps[t][n],i.sent.apps[t].push(s.sent.apps[t][n].code)}for(let t in s.sent.subs)if(s.sent.subs.hasOwnProperty(t)){i.sent.subs[t]=[];for(let n=0,a=s.sent.subs[t].length;n<a;++n)e.saveGiveaways[s.sent.subs[t][n].code]=s.sent.subs[t][n],i.sent.subs[t].push(s.sent.subs[t][n].code)}i.sentTimestamp=s.sentTimestamp}if(s.won){for(let t in s.won.apps)if(s.won.apps.hasOwnProperty(t)){i.won.apps[t]=[];for(let n=0,a=s.won.apps[t].length;n<a;++n)e.saveGiveaways[s.won.apps[t][n].code]=s.won.apps[t][n],i.won.apps[t].push(s.won.apps[t][n].code)}for(let t in s.won.subs)if(s.won.subs.hasOwnProperty(t)){i.won.subs[t]=[];for(let n=0,a=s.won.subs[t].length;n<a;++n)e.saveGiveaways[s.won.subs[t][n].code]=s.won.subs[t][n],i.won.subs[t].push(s.won.subs[t][n].code)}i.wonTimestamp=s.wonTimestamp}}for(const t in e.saveGiveaways)if(e.saveGiveaways.hasOwnProperty(t)){let s=e.saveGiveaways[t];i.sent[s.gameType][s.gameSteamId]||(i.sent[s.gameType][s.gameSteamId]=[]),i.sent[s.gameType][s.gameSteamId].indexOf(s.code)<0&&i.sent[s.gameType][s.gameSteamId].push(s.code)}n.values={giveaways:i},await $i(e.saveGiveaways),await Vi(null,null,n),t()}async mgc_createTrain(e,t,s,n){if(e>=s||s-1==0)n();else{let a=(await Ne.get(t.created[e].url)).html,i=a.querySelector('[name="giveaway_id"]').value,o=a.querySelector('[name="description"]').value,r=null;0===e?(t.firstWagon=t.created[e].url,r=this.mgc_getNext):r=e===s-1?this.mgc_getPrevious:this.mgc_getBoth,o=o.replace(/\[ESGST-P](.+?)\[\/ESGST-P](.+?)\[ESGST-N](.+?)\[\/ESGST-N]/g,r.bind(this,e,t,!1)),o=o.replace(/\[ESGST-P](.+?)\[\/ESGST-P]|\[ESGST-N](.+?)\[\/ESGST-N]/g,r.bind(this,e,t,!0)),o=o.replace(/\[ESGST-C](.+?)\[\/ESGST-C]/g,this.mgc_getCounter.bind(this,e,s)),o=!t.discussion||d.get("mgc_bumpLast")&&e!==s-1?o.replace(/\[ESGST-B](.+?)\[\/ESGST-B]/g,""):o.replace(/\[ESGST-B](.+?)\[\/ESGST-B]/g,`[$1](/discussion/${t.discussion}/)`),await Ne.post("/ajax.php",{data:`xsrf_token=${Be.xsrfToken}&do=edit_giveaway_description&giveaway_id=${i}&description=${encodeURIComponent(o.trim())}`}),t.created[e].giveaway.classList.add("connected"),window.setTimeout(()=>this.mgc_createTrain(e+1,t,s,n),0)}}mgc_getNext(e,t,s,n,a,i,o){let r,l,c,g;return s&&i||!s?(r=(s?i:o).match(/(.*?)\[N](.+?)\[\/N](.*?)$/),r?(c=r[1],l=r[2],g=r[3]):(c="",l=s?i:o,g=""),d.get("mgc_removeLinks")||s?`${c}[${l}](${t.created[e+1].url})${g}`:`${a}${i}${c}[${l}](${t.created[e+1].url})${g}`):""}mgc_getPrevious(e,t,s,n,a,i,o){let r,l,c,g;return s&&a||!s?(r=a.match(/(.*?)\[P](.+?)\[\/P](.*?)$/),r?(c=r[1],l=r[2],g=r[3]):(c="",l=a,g=""),d.get("mgc_removeLinks")||s?`${c}[${l}](${t.created[e-1].url})${g}`:`${c}[${l}](${t.created[e-1].url})${g}${i}${o}`):""}mgc_getBoth(e,t,s,n,a,i,o){let r,l,c,d,g,u,m;return s?a?this.mgc_getPrevious(e,t,!0,n,a):this.mgc_getNext(e,t,!0,n,null,i):(r=a.match(/(.*?)\[P](.+?)\[\/P](.*?)$/),r?(u=r[1],g=r[2],m=r[3]):(u="",g=a,m=""),r=o.match(/(.*?)\[N](.+?)\[\/N](.*?)$/),r?(c=r[1],l=r[2],d=r[3]):(c="",l=o,d=""),`${u}[${g}](${t.created[e-1].url})${m}${i}${c}[${l}](${t.created[e+1].url})${d}`)}mgc_getCounter(e,t,s,n){return`${e+1}${n}${t}`}mgc_completeCreation(e,t){e.discussion?(e.created.length&&(r.delete("mgcCache"),r.set("mgcAttach_step4",e.firstWagon),yt.open(`https://www.steamgifts.com/discussion/${e.discussion}/`),e.viewButton.show()),t()):(e.created.length&&(r.delete("mgcCache"),e.viewButton.show()),t())}mgc_shuffleGiveaways(e){if(!e.datas.length)return void Gi('There are no giveaways in the queue. Click on the "Add" button to add a giveaway to the queue.');let t;for(t=e.giveaways.children.length;t>-1;--t)e.giveaways.appendChild(e.giveaways.children[Math.random()*t|0]);this.mgc_updateCache(e)}mgc_updateCache(e){let t,s,n;for(t=[],s=0,n=e.giveaways.children.length;s<n;++s)t.push(e.values[parseInt(e.giveaways.children[s].textContent)-1]);r.set("mgcCache",JSON.stringify(t))}mgc_attachDiscussion(e){let t,s;s=new lt({addScrollable:!0,icon:"fa-comments",title:"Attach discussion:"}),qi(s.description,"afterbegin",[{attributes:{class:"esgst-description"},type:"div",children:[{text:'You can attach an existing or a new discussion. To attach an existing discussion, simply enter its code below and click "Attach Existing". To attach a new discussion, simply click "Attach New".',type:"div"},{type:"br"},{text:"Use [ESGST-B][/ESGST-B] to delimit the bump link in the description of the giveaway, for example: ### [ESGST-B]Bump[/ESGST-B]",type:"div"},{type:"br"},{text:"Use [ESGST-T][/ESGST-T] to delimit the train link in the description of the discussion (this link will lead to the first giveaway of the train), for example: ### [ESGST-T]Choo choo![/ESGST-T]",type:"div"},{type:"br"},{text:"When the discussion page opens in your browser at the end of the train creation, wait until it has completely finished altering it (you will get a popup when this happens).",type:"div"},{type:"br"}]}]),t=qi(s.description,"beforeend",[{attributes:{placeholder:"XXXXX",type:"text"},type:"input"}]),tt.create([{color:"green",icons:["fa-paperclip"],name:"Attach Existing",onClick:this.mgc_attachExistingDiscussion.bind(this,t,e,s)},{template:"loading",isDisabled:!0,name:"Attaching..."}]).insert(s.description,"beforeend"),tt.create([{color:"green",icons:["fa-paperclip"],name:"Attach New",onClick:()=>new Promise(t=>this.mgc_attachNewDiscussion(e,s,t))},{template:"loading",isDisabled:!0,name:"Attaching..."}]).insert(s.description,"beforeend"),s.open()}mgc_attachExistingDiscussion(e,t,s){t.discussion=e.value,t.discussionPanel.classList.remove("esgst-hidden"),t.discussionLink.href=`/discussion/${t.discussion}/`,t.discussionLink.textContent=t.discussion,s.close()}mgc_attachNewDiscussion(e,t,s){let n;r.set("mgcAttach_step1",!0),n=yt.open("https://www.steamgifts.com/discussions/new"),window.setTimeout(()=>this.mgc_checkAttached(e,t,n,s),100)}mgc_checkAttached(e,t,s,n){s.closed?(e.discussion=r.get("mgcAttach_step3"),r.delete("mgcAttach_step3"),e.discussionPanel.classList.remove("esgst-hidden"),e.discussionLink.href=`/discussion/${e.discussion}/`,e.discussionLink.textContent=e.discussion,n(),t.close()):window.setTimeout(()=>this.mgc_checkAttached(e,t,s,n),100)}mgc_addCreateAndAttachButton(){let e;e=document.getElementsByClassName("form__rows")[0],tt.create([{template:"success",name:"Create & Attach",onClick:this.mgc_createAndAttachDiscussion.bind(this,e)},{template:"loading",isDisabled:!0,name:"Creating & attaching..."}]).insert(e,"beforeend")}mgc_createAndAttachDiscussion(e){r.set("mgcAttach_step2",!0),e.parentElement.submit()}mgc_editDiscussion(){const e=document.querySelector("[name=description]");e.value=e.value.replace(/\[ESGST-T(.+?)\[\/ESGST-T/g,`[$1](${r.get("mgcAttach_step4")})`),r.delete("mgcAttach_step4"),r.set("mgcAttach_step5",!0),document.getElementsByClassName("js__submit-form")[0].click()}mgc_detachDiscussion(e){e.discussion=null,e.discussionPanel.classList.add("esgst-hidden")}async mgc_viewResults(e){const t=new lt({addScrollable:!0}),s=pt.create("mgc",["Results"]).insert(t.description,"afterbegin"),n=[];for(const t of e.created)n.push(...t.html);if(qi(t.scrollable,"beforeend",[{attributes:{class:"popup__keys__list"},type:"div",children:n}]),d.get("mm")){const e=await this.esgst.modules.giveaways.giveaways_get(t.scrollable);this.esgst.modules.generalMultiManager.mm(s.nodes.outer,e,"Giveaways")}tt.create([{color:"white",icons:["fa-copy"],name:"Copy Giveaway List",onClick:()=>new Promise(t=>{c.common.copyValue(null,e.createdValues.map((t,s)=>`${t.gameName} - ${e.created[s].url}`).join("\n")),window.setTimeout(t,2e3)})},{template:"success",isDisabled:!0,name:"Copied!"}]).insert(s.nodes.outer,"beforeend"),t.open()}mgc_removeGiveaway(e){window.confirm("Are you sure you want to remove this giveaway?")&&(e.source.remove(),e.source=null,this.mgc_updateCache(e))}},Ji=hs.createElements.bind(hs),Yi=hs.createFadeMessage.bind(hs),Ki=hs.createHeadingButton.bind(hs),zi=hs.createTooltip.bind(hs),Qi=hs.downloadFile.bind(hs),Zi=hs.escapeMarkdown.bind(hs),Xi=hs.getChildByClassName.bind(hs),eo=hs.lockAndSaveDiscussions.bind(hs),to=hs.lockAndSaveGiveaways.bind(hs),so=hs.selectSwitches.bind(hs);const no=new class extends gt{constructor(){super(),this.info={description:()=>Se.element("ul",null,Se.element("li",null,"Adds a button (",Se.element("i",{className:"fa fa-gears"}),") to the main page heading of any page that allows you to do stuff with multiple giveaways/discussions/users/games at once."),Se.element("li",null,"When you click on the button, a popout appears where you can select what type of item you want to manage (giveaways, discussions, users or games) and enable the manager for that type. When you do this, checkboxes are added in front of each item in the page, allowing you to select which ones you want to manage."),Se.element("li",null,"You can:"),Se.element("ul",null,Se.element("li",null,"Search and replace something in the description of the selected giveaways."),Se.element("li",null,"Hide the selected giveaways, if ",Se.element("span",{"data-esgst-feature-id":"gf_s"})," is enabled."),Se.element("li",null,"Bookmark/unbookmark the selected giveaways, if"," ",Se.element("span",{"data-esgst-feature-id":"gb"})," is enabled."),Se.element("li",null,"Calculate how much time you have to wait until you have enough points to enter the selected giveaways, if ",Se.element("span",{"data-esgst-feature-id":"ttec"})," is enabled."),Se.element("li",null,"Export the selected giveaways to encrypted giveaways, if"," ",Se.element("span",{"data-esgst-feature-id":"ged"})," is enabled."),Se.element("li",null,"Hide the selected discussions, if ",Se.element("span",{"data-esgst-feature-id":"df_s"})," is enabled."),Se.element("li",null,"Mark the selected discussions as visited/unvisited, if"," ",Se.element("span",{"data-esgst-feature-id":"gdttt"})," is enabled."),Se.element("li",null,"Tag the selected users with the same tags, if ",Se.element("span",{"data-esgst-feature-id":"ut"}),", is enabled."),Se.element("li",null,"Check the selected users for whitelists/blacklists, if"," ",Se.element("span",{"data-esgst-feature-id":"wbc"})," is enabled."),Se.element("li",null,"Check the selected users for suspensions, if ",Se.element("span",{"data-esgst-feature-id":"usc"})," ","is enabled."),Se.element("li",null,"Tag the selected games with the same tags, if ",Se.element("span",{"data-esgst-feature-id":"gt"}),", is enabled."),Se.element("li",null,"Export the selected giveaways/discussions/users/games to links or to a custom format that you can specify."),Se.element("li",null,"Tag the selected groups with the same tags, if"," ",Se.element("span",{"data-esgst-feature-id":"gpt"}),", is enabled.")),Se.element("li",null,"On SteamTrades you can only manage users.")),id:"mm",name:"Multi-Manager",sg:!0,st:!0,type:"general"}}init(){this.esgst.parameters.esgst||this.mm()}mm(e,t,s){if(!e&&!this.esgst.mainPageHeading)return;let n={};n.button=Ki({context:e,id:"mm",icons:["fa-gears"],title:"Multi-manage"}),n.checkboxes={Giveaways:{},Discussions:{},Users:{},Games:{},Groups:{}},n.counters={Giveaways:0,Discussions:0,Users:0,Games:0,Groups:0},n.counterElements={},this.esgst.mm_enable=this.mm_enable.bind(this,n),this.esgst.mm_disable=this.mm_disable.bind(this,n),n.button.addEventListener("click",this.mm_openPopout.bind(this,n,t,s)),d.get("mm_enableGames")&&this.esgst.gameFeatures.push(this.mm_getGames.bind(this))}mm_getGames(e,t){this.esgst.mm_enable(rt.findData("current","games"),"Games")}mm_openPopout(e,t,s){if(e.popout)return;e.popout=new mt("esgst-mm-popout",e.button,0,!0),e.headings=Ji(e.popout.popout,"afterbegin",[{attributes:{class:"esgst-mm-headings"},type:"div"},{attributes:{class:"esgst-mm-sections"},type:"div"}]),e.sections=e.headings.nextElementSibling;let n=0;Object.keys(e.checkboxes).forEach((a,i)=>{if(!this.esgst.sg&&"Users"!==a)return;let o=Ji(e.headings,"beforeend",[{type:"div",children:[{type:"span"},{text:" "+a,type:"node"},{type:"br"},{attributes:{class:"esgst-bold"},text:e.counters[a],type:"span"},{text:" selected",type:"node"}]}]);e.counterElements[a]=o.lastElementChild;let r=new vt(o.firstElementChild,"mm_enable"+a,!0,"",!1,!1,null,d.get("mm_enable"+a));r.onEnabled=this.mm_enable.bind(this,e,s===a?t:null,a),r.onDisabled=this.mm_disable.bind(this,e,s===a?t:null,a),this.mm_setSection(e,Ji(e.sections,"beforeend",[{type:"div"}]),s===a?t:null,a),this.esgst.sg&&o.addEventListener("click",this.mm_changeActiveSection.bind(this,e,i)),d.get("mm_enable"+a)&&(n=i)}),this.mm_changeActiveSection(e,this.esgst.sg?n:0),e.popout.open()}mm_changeActiveSection(e,t){for(let t=e.headings.children.length-1;t>-1;t--)e.headings.children[t].classList.remove("esgst-selected");e.headings.children[t].classList.add("esgst-selected");for(let t=e.sections.children.length-1;t>-1;t--)e.sections.children[t].classList.remove("esgst-selected");e.sections.children[t].classList.add("esgst-selected")}mm_enable(e,t,s){t||(t=rt.findData("current",s.toLowerCase())),t.forEach(t=>{let n=Xi(t.innerWrap,"esgst-mm-checkbox")||Xi(t.innerWrap.parentElement,"esgst-mm-checkbox");if(n)return;n=new St(Ji(t.innerWrap,s.match(/Giveaways|Discussions/)?"afterbegin":"beforebegin",[{attributes:{class:"esgst-mm-checkbox"},type:"div"}]),!1,!1,{select:"Add item to Multi-Manager selection",unselect:"Remove item from Multi-Manager selection"}),t["mmCheckbox"+s]=n,n.checkbox.setAttribute("data-mm-key",s),n.onPreEnabled=this.mm_selectItem.bind(this,e,t,s,1),n.onPreDisabled=this.mm_selectItem.bind(this,e,t,s,0);let a=t.type?`${t.type}_${t.code}`:t.code;e.checkboxes[s][a]||(e.checkboxes[s][a]=[]),e.checkboxes[s][a].push(n)}),this.mm_resetCounters(e)}mm_disable(e,t,s){e.checkboxes[s]={},t||(t=rt.findData("current",s.toLowerCase())),t.forEach(e=>{let t=Xi(e.innerWrap,"esgst-mm-checkbox")||Xi(e.innerWrap.parentElement,"esgst-mm-checkbox");t&&t.remove(),e.mm=0}),this.mm_resetCounters(e)}mm_selectItem(e,t,s,n,a){if(a)if(a.shiftKey){const e="mmCheckbox"+s,n=rt.findData("current",s.toLowerCase()),i=document.querySelectorAll(`[data-mm-key="${s}"]`);let o=!1;for(const s of i){if(s.closest(".is-hidden, .is_hidden, .esgst-hidden"))continue;if(!o){s===this.esgst.mmSelectionStart&&(o=!0);continue}if(s===(t[e]&&t[e].checkbox))break;const i=n.filter(t=>s===(t[e]&&t[e].checkbox))[0];i&&i[e].change(!0,null,null,a)}this.esgst.mmSelectionStart=null}else this.esgst.mmSelectionStart=a.currentTarget;let i=!1;t.mm=n,e.checkboxes[s][t.type?`${t.type}_${t.code}`:t.code].forEach(e=>{n?e.value||(i=!0,e.isBlocked=!0,e.check(),e.isBlocked=!1):e.value&&(i=!0,e.isBlocked=!0,e.uncheck(),e.isBlocked=!1)}),!i||n&&!t.outerWrap.offsetParent||(e.counters[s]+=n?1:-1,e.counterElements[s]&&(e.counterElements[s].textContent=e.counters[s]))}mm_resetCounters(e){for(let t in e.counters)e.counters.hasOwnProperty(t)&&(e.counters[t]=0,e.counterElements[t]&&(e.counterElements[t].textContent=0))}mm_setSection(e,t,s,n){s||(s=rt.findData("current",n.toLowerCase()));let a={default:[{buttons:[{check:!0,options:[{color:"white",tooltip:"All",icons:["fa-square"],name:"",onClick:so.bind(hs,e.checkboxes[n],"check",null)},{template:"loading",isDisabled:!0,name:""}]},{check:!0,options:[{color:"white",tooltip:"None",icons:["fa-square-o"],name:"",onClick:so.bind(hs,e.checkboxes[n],"uncheck",null)},{template:"loading",isDisabled:!0,name:""}]},{check:!0,options:[{color:"white",tooltip:"Inverse",icons:["fa-plus-square-o"],name:"",onClick:so.bind(hs,e.checkboxes[n],"toggle",null)},{template:"loading",isDisabled:!0,name:""}]}],name:"Select:"},{buttons:[],name:""},{buttons:[{check:!0,options:[{color:"green",tooltip:"Links",icons:["fa-globe"],name:"",onClick:this.mm_exportLinks.bind(this,e,s,n)},{template:"loading",isDisabled:!0,name:""}]},{check:!0,options:[{color:"green",tooltip:"Custom",icons:["fa-pencil"],name:"",onClick:this.mm_exportCustom.bind(this,e,s,n)},{template:"loading",isDisabled:!0,name:""}]}],name:"Export to:"}],Giveaways:[[],[{check:!0,key:"searchReplace",options:{color:"green",tooltip:"Search and replace in descriptions of selected giveaways",icons:["fa-search"],name:""}},{check:d.get("gf")&&d.get("gf_s"),options:[{color:"green",tooltip:"Add selected giveaways to ESGST's single filter list",icons:["fa-eye-slash"],name:"",onClick:this.mm_hideGiveaways.bind(this,e,s)},{template:"loading",isDisabled:!0,name:""}]},{check:d.get("ttec"),options:[{color:"green",tooltip:"Calculate time to enter for selected giveaways",icons:["fa-clock-o"],name:"",onClick:this.mm_calculateGiveaways.bind(this,e,s)},{template:"loading",isDisabled:!0,name:""}]},{check:d.get("gb"),options:[{color:"green",tooltip:"Bookmark selected giveaways",icons:["fa-bookmark"],name:"",onClick:this.mm_bookmarkGiveaways.bind(this,e,s)},{template:"loading",isDisabled:!0,name:""}]},{check:d.get("gb"),options:[{color:"green",tooltip:"Unbookmark selected giveaways",icons:["fa-bookmark-o"],name:"",onClick:this.mm_unbookmarkGiveaways.bind(this,e,s)},{template:"loading",isDisabled:!0,name:""}]}],[{check:d.get("ged"),options:[{color:"green",tooltip:"Encrypted giveaways",icons:["fa-puzzle-piece"],name:"",onClick:this.mm_exportEncryptedGiveaways.bind(this,e,s)},{template:"loading",isDisabled:!0,name:""}]}]],Discussions:[[],[{check:d.get("df")&&d.get("df_s"),options:[{color:"green",tooltip:"Add selected discussions to ESGST's single filter list",icons:["fa-eye-slash"],name:"",onClick:this.mm_hideDiscussions.bind(this,e,s)},{template:"loading",isDisabled:!0,name:""}]},{check:!0,options:[{color:"green",tooltip:"Bookmark selected discussions",icons:["fa-bookmark"],name:"",onClick:this.mm_bookmarkDiscussions.bind(this,e,s)},{template:"loading",isDisabled:!0,name:""}]},{check:!0,options:[{color:"green",tooltip:"Unbookmark selected discussions",icons:["fa-bookmark-o"],name:"",onClick:this.mm_unbookmarkDiscussions.bind(this,e,s)},{template:"loading",isDisabled:!0,name:""}]},{check:d.get("gdttt"),options:[{color:"green",tooltip:"Mark selected discussions as visited",icons:["fa-check"],name:"",onClick:this.mm_visitDiscussions.bind(this,e,s)},{template:"loading",isDisabled:!0,name:""}]},{check:d.get("gdttt"),options:[{color:"green",tooltip:"Mark selected discussions as unvisited",icons:["fa-times"],name:"",onClick:this.mm_unvisitDiscussions.bind(this,e,s)},{template:"loading",isDisabled:!0,name:""}]}],[]],Users:[[],[{check:d.get("ut"),options:[{color:"green",tooltip:"Tag selected users",icons:["fa-tags"],name:"",onClick:this.esgst.modules.usersUserTags.tags_openMmPopup.bind(this.esgst.modules.usersUserTags,e,s)},{template:"loading",isDisabled:!0,name:""}]},{check:d.get("wbc"),options:[{color:"green",tooltip:"Check selected users for whitelists / blacklists",icons:["fa-heart","fa-ban","fa-question-circle"],name:"",onClick:this.mm_selectWbcUsers.bind(this,e,s,"wbc")},{template:"loading",isDisabled:!0,name:""}]},{check:d.get("usc"),options:[{color:"green",tooltip:"Check selected users for suspensions",icons:["fa-ban","fa-question-circle"],name:"",onClick:this.mm_selectWbcUsers.bind(this,e,s,"usc")},{template:"loading",isDisabled:!0,name:""}]},{check:d.get("glwc")&&d.get("glwc_mm"),options:[{color:"green",tooltip:"Check libraries / wishlists of selected users",icons:["fa-folder","fa-star","fa-question-circle"],name:"",onClick:this.mm_selectGlwcUsers.bind(this,e,s)},{template:"loading",isDisabled:!0,name:""}]}],[]],Games:[[],[{check:d.get("gt"),options:[{color:"green",tooltip:"Tag selected games",icons:["fa-tags"],name:"",onClick:this.esgst.modules.gamesGameTags.tags_openMmPopup.bind(this.esgst.modules.gamesGameTags,e,s)},{template:"loading",isDisabled:!0,name:""}]},{check:!0,options:[{color:"green",tooltip:"Add selected games to SteamGifts' filter list",icons:["fa-eye-slash"],name:"",onClick:this.mm_hideGames.bind(this,e,s)},{template:"loading",isDisabled:!0,name:""}]},{check:!0,options:[{color:"green",tooltip:"Categorize games for Steam",icons:["fa-clone"],name:"",onClick:this.mm_categorizeGames.bind(this,e,s)},{template:"loading",isDisabled:!0,name:""}]}],[]],Groups:[[],[{check:d.get("gpt"),options:[{color:"green",tooltip:"Tag selected groups",icons:["fa-tags"],name:"",onClick:this.esgst.modules.groupsGroupTags.tags_openMmPopup.bind(this.esgst.modules.groupsGroupTags,e,s)},{template:"loading",isDisabled:!0,name:""}]}],[]]};a.default.forEach((e,i)=>{let o=Ji(t,"beforeend",[{attributes:{class:"esgst-button-group esgst-mm-button-group"},type:"div",children:[{text:""+e.name,type:"span"}]}]);a[n][i].concat(e.buttons).forEach(e=>{if(!e.check)return;let t=tt.create(e.options).insert(o,"beforeend").nodes.outer;"searchReplace"===e.key&&new Ws({button:t,context:Se.element("div",{className:"markdown"},Se.element("ul",null)),popup:{icon:"fa-search",title:"Search & Replace",options:[{check:!0,description:Se.element("fragment",null,"Use"," ",Se.element("a",{className:"esgst-bold",href:"https://developer.mozilla.org/en/docs/Web/JavaScript/Guide/Regular_Expressions"},"regular expression"),"."),id:"mm_useRegExp",tooltip:null}],textInputs:[{placeholder:"Example without regular expression: query | Example with regular expression: /query/flags",title:"Search for: "},{placeholder:"Do not use regular expression here.",title:"Replace with: "}],addProgress:!0,addScrollable:!0},urls:{arguments:[s],doNotTrigger:!0,id:"mm",init:this.mm_initUrls.bind(this),lockPerLoad:!0,request:{request:this.mm_getSearchReplaceUrlRequest.bind(this)},restart:!0}})})}),e["progress"+n]=at.create().insert(t,"beforeend").hide(),zi(Ji(t,"beforeend",[{attributes:{class:"esgst-description"},type:"div",children:[..."Games"===n?[{text:'You can enter Steam links for the games that you want to hide below (in the https://store.steampowered.com/app/909580/ format and with one link per line). If you click on "Hide" and the text area has links, the games in the text area will be hidden instead of the selected ones.',type:"node"},{type:"br"},{type:"br"}]:[],{text:"Enter the custom format below. ",type:"node"},{attributes:{class:"fa fa-question-circle"},type:"i"}]}]).lastElementChild,'\n\t\t\t<div>Delimit the line to be replaced and duplicated (in case more than one items were selected) with [line][/line]. If you want the lines to be sorted in ascending order use [line-asc][/line] instead, and for descending order use [line-desc][/line]. Then build your custom format between [line] and [/line] using the templates below. Some templates are not available depending on which page you are on.</div>\n\t\t\t<br/>\n\t\t\t<div class="esgst-bold">Giveaways:</div>\n\t\t\t<ul>\n\t\t\t\t<li>[code] - The 5-character code of the giveaway.</li>\n\t\t\t\t<li>[comments] - The current number of comments that the giveaway has.</li>\n\t\t\t\t<li>[copies] - The number of copies being given away.</li>\n\t\t\t\t<li>[creator] - The creator of the giveaway.</li>\n\t\t\t\t<li>[end-time="$"] - When the giveaway ended/will end. Replace $ with the date templates specified at the end of this tooltip.</li>\n\t\t\t\t<li>[entries] - The current number of entries that the giveaway has.</li>\n\t\t\t\t<li>[groups] - The groups of the giveaway (only works when Content Loader > Giveaway Groups is enabled as "Panel (On Page Load)").</li>\n\t\t\t\t<li>[level] - The level of the giveaway.</li>\n\t\t\t\t<li>[name] - The name of the game being given away.</li>\n\t\t\t\t<li>[points] - The number of points that the giveaway is worth.</li>\n\t\t\t\t<li>[short-url] - The short URL of the giveaway (https://www.steamgifts.com/giveaway/XXXXX/).</li>\n\t\t\t\t<li>[start-time="$"] - When the giveaway started. Replace $ with the date templates specified at the end of this tooltip.</li>\n\t\t\t\t<li>[steam-id] - The Steam app/sub id of the game being given away.</li>\n\t\t\t\t<li>[steam-type] - The Steam type of the game being given away ("app" or "sub").</li>\n\t\t\t\t<li>[steam-url] - The Steam store URL of the game being given away.</li>\n\t\t\t\t<li>[type] - The type of the giveaway ("Public", "Invite Only", "Group", "Whitelist", "Region Restricted", "Invite Only + Region Restricted", "Group + Whitelist", "Group + Region Restricted" or "Whitelist + Region Restricted").</li>\n\t\t\t\t<li>[url] - The full URL of the giveaway (https://www.steamgifts.com/giveaway/XXXXX/game-name).</li>\n\t\t\t\t<li>[winners] - The name of the winners of the giveaway (only the maximum 3 winners shown in the page).</li>\n\t\t\t\t<li>[winners-status] - The name of the winners of the giveaway (only the maximum 3 winners shown in the page), along with their status ("Awaiting Feedback", "Received" or "Not Received").</li>\n\t\t\t</ul>\n\t\t\t<div class="esgst-bold">Discussions:</div>\n\t\t\t<ul>\n\t\t\t\t<li>[author] - The author of the discussion.</li>\n\t\t\t\t<li>[category] - The category of the discussion.</li>\n\t\t\t\t<li>[code] - The 5-character code of the discussion.</li>\n\t\t\t\t<li>[comments] - The current number of comments that the discussion has.</li>\n\t\t\t\t<li>[created-time="$"] - When the discussion was created. Replace $ with the date templates specified at the end of this tooltip.</li>\n\t\t\t\t<li>[poll] - "Yes" if the discussion has a poll and "No" otherwise.</li>\n\t\t\t\t<li>[short-url] - The short URL of the discussion (https://www.steamgifts.com/discussion/XXXXX/).</li>\n\t\t\t\t<li>[title] - The title of the discussion.</li>\n\t\t\t\t<li>[url] - The full URL of the discussion (https://www.steamgifts.com/discussion/XXXXX/title).</li>\n\t\t\t</ul>\n\t\t\t<div class="esgst-bold">Users:</div>\n\t\t\t<ul>\n\t\t\t\t<li>[url] - The URL of the user (https://www.steamgifts.com/user/username).</li>\n\t\t\t\t<li>[username] - The username of the user.</li>\n\t\t\t\t<li>[sentCount] - The number of giveaways that a user has given in a group (only available in group user pages).</li>\n\t\t\t\t<li>[sentValue] - The amount in dollars that a user has given in a group (only available in group user pages).</li>\n\t\t\t\t<li>[receivedCount] - The number of giveaways that a user has won in a group (only available in group user pages).</li>\n\t\t\t\t<li>[receivedValue] - The amount in dollars that a user has won in a group (only available in group user pages).</li>\n\t\t\t\t<li>[giftDifference] - The difference between the number of giveaways that a user has given and the number of giveaways that they have won in a group (only available in group user pages).</li>\n\t\t\t\t<li>[valueDifference] - The difference between the amount in dollars that a user has given and the amount in dollars that they have won in a group (only available in group user pages).</li>\n\t\t\t</ul>\n\t\t\t<div class="esgst-bold">Games:</div>\n\t\t\t<ul>\n\t\t\t\t<li>[id] - The Steam app/sub id of the game.</li>\n\t\t\t\t<li>[name] - The name of the game.</li>\n\t\t\t\t<li>[type] - The Steam type of the game ("app" or "sub").</li>\n\t\t\t\t<li>[url] - The Steam store URL of the game.</li>\n\t\t\t</ul>\n\t\t\t<div class="esgst-bold">Groups:</div>\n\t\t\t<ul>\n\t\t\t\t<li>[code] - The 5-character code of the group.</li>\n\t\t\t\t<li>[name] - The name of the group.</li>\n\t\t\t\t<li>[url] - The short URL of the group (https://www.steamgifts.com/group/XXXXX/).</li>\n\t\t\t</ul>\n\t\t\t<div>For the date templates, ESGST uses date-fns v2.0.0-alpha.25, so check the accepted tokens <a href="https://date-fns.org/v2.0.0-alpha.25/docs/Getting-Started">here</a>.</div>\n\t\t\t<br/>\n\t\t\t<div>Here is an example that generates a table with links to giveaways sorted in ascending order:</div>\n\t\t\t<br/>\n\t\t\t<div>Game | Giveaway | Level | Points | Ends</div>\n\t\t\t<div>:-: | :-: | :-: | :-: | :-:</div>\n\t\t\t<div>[line-asc][[name]]([steam-url]) | [Enter]([short-url]) | [level] | [points] | [end-time="MMM d, yyyy"][/line]\n\t\t\t<br/>\n\t\t\t<br/>\n\t\t'),e["textArea"+n]=Ji(t,"beforeend",[{attributes:{class:"page_outer_wrap"},type:"div",children:[{type:"textarea"}]}]).firstElementChild,d.get("cfh")&&this.esgst.modules.commentsCommentFormattingHelper.cfh_addPanel(e["textArea"+n]),e["message"+n]=Ji(t,"beforeend",[{attributes:{class:"esgst-description"},type:"div"}]),tt.create([{color:"white",icons:["fa-copy"],name:"Copy",onClick:this.mm_copyOutput.bind(this,e,n)},{template:"loading",isDisabled:!0,name:"Copying..."}]).insert(t,"beforeend")}mm_exportLinks(e,t,s){let n=[];t.forEach(e=>{e.mm&&(e.outerWrap.offsetParent||e.outerWrap.closest(".esgst-gv-container:not(.is-hidden):not(.esgst-hidden)"))&&n.push(`[${Zi(e.name||e.title||e.code)}](https://${"Games"===s?`store.steampowered.com/${e.type.slice(0,-1)}/${e.code}`:`${window.location.hostname}/${s.toLowerCase().slice(0,-1)}/${e.code}/`})`)}),e["textArea"+s].value=n.join("\n")}mm_exportCustom(e,t,s){let n=e["textArea"+s].value.match(/\[LINE(.*?)](.+)\[\/LINE]/i),a=[];if(!n)return;let i=n[1],o=n[2];switch(s){case"Giveaways":t.forEach(e=>{if(!e.mm||!e.outerWrap.offsetParent&&!e.outerWrap.closest(".esgst-gv-container:not(.is-hidden):not(.esgst-hidden)"))return;let t="";e.public?t+="Public":e.inviteOnly?(t+="Invite Only",e.regionRestricted&&(t+="Region Restricted")):e.group?(t+="Group",e.whitelist&&(t+="Whitelist"),e.regionRestricted&&(t+="Region Restricted")):e.whitelist?(t+="Whitelist",e.regionRestricted&&(t+="Region Restricted")):e.regionRestricted&&(t+="Region Restricted");const s=e.winners;e.winnerColumns.awaitingFeedback&&s.push({status:"Awaiting Feedback",username:"Anonymous"}),a.push(o.replace(/\[CODE]/gi,e.code).replace(/\[COMMENTS]/gi,e.comments).replace(/\[COPIES]/gi,e.copies).replace(/\[CREATOR]/gi,e.creator).replace(/\[END-TIME="(.+?)"]/gi,this.mm_formatDate.bind(this,e.endTime)).replace(/\[ENTRIES]/gi,e.entries).replace(/\[GROUPS]/gi,(e.groupNames||[]).join(", ")).replace(/\[LEVEL]/gi,e.level).replace(/\[NAME]/gi,Zi(e.name)).replace(/\[POINTS]/gi,e.points).replace(/\[SHORT-URL]/gi,`https://www.steamgifts.com/giveaway/${e.code}/`).replace(/\[START-TIME="(.+?)"]/gi,this.mm_formatDate.bind(this,e.startTime)).replace(/\[STEAM-ID]/gi,e.id).replace(/\[STEAM-TYPE]/gi,e.type.slice(0,-1)).replace(/\[STEAM-URL]/gi,`http://store.steampowered.com/${e.type.slice(0,-1)}/${e.id}`).replace(/\[TYPE]/gi,t).replace(/\[URL]/gi,"https://www.steamgifts.com"+e.url.match(/\/giveaway\/.+/)[0]).replace(/\[WINNERS]/gi,s.map(e=>e.username).join(", ")).replace(/\[WINNERS-STATUS]/gi,s.map(e=>`${e.username} (${e.status})`).join(", ")))});break;case"Discussions":t.forEach(e=>{e.mm&&(e.outerWrap.offsetParent||e.outerWrap.closest(".esgst-gv-container:not(.is-hidden):not(.esgst-hidden)"))&&a.push(o.replace(/\[AUTHOR]/gi,e.author).replace(/\[CATEGORY]/gi,Zi(e.category)).replace(/\[CODE]/gi,e.code).replace(/\[COMMENTS]/gi,e.comments).replace(/\[CREATED-TIME="(.+?)"]/gi,this.mm_formatDate.bind(this,e.createdTimestamp)).replace(/\[POLL]/gi,e.poll?"Yes":"No").replace(/\[SHORT-URL]/gi,`https://www.steamgifts.com/discussion/${e.code}/`).replace(/\[TITLE]/gi,Zi(e.title)).replace(/\[URL]/gi,"https://www.steamgifts.com"+e.url.match(/\/discussion\/.+/)[0]))});break;case"Users":t.forEach(e=>{e.mm&&(e.outerWrap.offsetParent||e.outerWrap.closest(".esgst-gv-container:not(.is-hidden):not(.esgst-hidden)"))&&a.push(o.replace(/\[URL]/gi,`https://${window.location.hostname}/user/${e.code}`).replace(/\[USERNAME]/gi,e.code).replace(/\[SENTCOUNT]/gi,e.sentCount).replace(/\[SENTVALUE]/gi,e.sentValue).replace(/\[RECEIVEDCOUNT]/gi,e.receivedCount).replace(/\[RECEIVEDVALUE]/gi,e.receivedValue).replace(/\[GIFTDIFFERENCE]/gi,e.giftDifference).replace(/\[VALUEDIFFERENCE]/gi,e.valueDifference))});break;case"Games":t.forEach(e=>{e.mm&&(e.outerWrap.offsetParent||e.outerWrap.closest(".esgst-gv-container:not(.is-hidden):not(.esgst-hidden)"))&&a.push(o.replace(/\[ID]/gi,e.code).replace(/\[NAME]/gi,Zi(e.name)).replace(/\[TYPE]/gi,e.type.slice(0,-1)).replace(/\[URL]/gi,`https://store.steampowered.com/${e.type.slice(0,-1)}/${e.code}`))});break;case"Groups":t.forEach(e=>{e.mm&&(e.outerWrap.offsetParent||e.outerWrap.closest(".esgst-gv-container:not(.is-hidden):not(.esgst-hidden)"))&&a.push(o.replace(/\[CODE]/gi,e.code).replace(/\[NAME]/gi,Zi(e.name)).replace(/\[URL]/gi,`https://www.steamgifts.com/group/${e.code}/`))})}i&&(a=l.sortArray(a,"-desc"===i)),e["textArea"+s].value=e["textArea"+s].value.replace(/\[LINE.*?].+\[\/LINE]/i,a.join("\n"))}mm_formatDate(e,t,s){return Zi(xe(e,s))}mm_initUrls(e,t){t.forEach(t=>{t.mm&&(t.outerWrap.offsetParent||t.outerWrap.closest(".esgst-gv-container:not(.is-hidden):not(.esgst-hidden)"))&&e.items.push({name:t.name,url:`https://www.steamgifts.com/giveaway/${t.code}/`})}),e.perLoad=e.items.length}async mm_getSearchReplaceUrlRequest(e,t,s,n){let a,i;if(d.get("mm_useRegExp"))try{let t=e.popup.getTextInputValue(0).match(/^\/(.+)\/(.*)$/);i=new RegExp(t[1],t[2]),a=e.popup.getTextInputValue(1)}catch(t){return void e.popup.progressBar.setError("Invalid regular expression!").show()}else i=e.popup.getTextInputValue(0),a=e.popup.getTextInputValue(1);let o=n.querySelector(".page__description textarea[name=description]"),r=e.items[e.index].name,l=e.items[e.index].url;if(o){if(d.get("mm_useRegExp")?o.value.match(i):o.value.includes(i)){const t=o.previousElementSibling;"success"===(await Ne.post("/ajax.php",{data:`xsrf_token=${Be.xsrfToken}&do=edit_giveaway_description&giveaway_id=${t.value}&description=${encodeURIComponent(o.value.replace(i,a))}`})).json.type?Ji(e.context.firstElementChild.firstElementChild,"beforeend",[{type:"li",children:[{text:"Found and replaced in ",type:"node"},{attributes:{href:l},text:r,type:"a"}]}]):Ji(e.context.firstElementChild.firstElementChild,"beforeend",[{type:"li",children:[{text:"Found, but failed to replace, in ",type:"node"},{attributes:{href:l},text:r,type:"a"}]}])}else Ji(e.context.firstElementChild.firstElementChild,"beforeend",[{type:"li",children:[{text:"Not found in ",type:"node"},{attributes:{href:l},text:r,type:"a"}]}])}else Ji(e.context.firstElementChild.firstElementChild,"beforeend",[{type:"li",children:[{text:"Not found in ",type:"node"},{attributes:{href:l},text:r,type:"a"}]}])}async mm_hideGiveaways(e,t){let s={};t.forEach(t=>{t.mm&&(t.outerWrap.offsetParent||t.outerWrap.closest(".esgst-gv-container:not(.is-hidden):not(.esgst-hidden)"))&&(s[t.code]={code:t.code,endTime:t.endTime,hidden:!0},"main"===e.source&&this.esgst.giveawayPath||t.outerWrap.remove())}),await to(s)}async mm_bookmarkGiveaways(e,t){let s={};t.forEach(e=>{e.mm&&(e.outerWrap.offsetParent||e.outerWrap.closest(".esgst-gv-container:not(.is-hidden):not(.esgst-hidden)"))&&e.gbButton&&1===e.gbButton.index&&(s[e.code]={bookmarked:!0,code:e.code,endTime:e.endTime,name:e.name,started:e.started},e.gbButton.change(null,2))}),await to(s)}async mm_unbookmarkGiveaways(e,t){let s={};t.forEach(e=>{e.mm&&(e.outerWrap.offsetParent||e.outerWrap.closest(".esgst-gv-container:not(.is-hidden):not(.esgst-hidden)"))&&e.gbButton&&3===e.gbButton.index&&(s[e.code]={bookmarked:!1},e.gbButton.change(null,0))}),await to(s)}mm_calculateGiveaways(e,t){let s=0;t.forEach(e=>{e.mm&&(e.outerWrap.offsetParent||e.outerWrap.closest(".esgst-gv-container:not(.is-hidden):not(.esgst-hidden)"))&&!e.ended&&(s+=e.points)});let n=60-(new Date).getMinutes();for(;n>15;)n-=15;s>Be.counters.points?e.textAreaGiveaways.value=`You will need to wait ${this.esgst.modules.giveawaysTimeToEnterCalculator.ttec_getTime(Math.round(100*(n+15*Math.floor((s-Be.counters.points)/6)))/100)} to enter all selected giveaways for a total of ${s}P.${s>400?"\n\nSince each 400P regeneration takes about 17h, you will need to return in 17h and use all your points so more can be regenerated.":""}`:e.textAreaGiveaways.value="You have enough points to enter all giveaways right now."}mm_exportEncryptedGiveaways(e,t){let s=[];t.forEach(e=>{e.mm&&(e.outerWrap.offsetParent||e.outerWrap.closest(".esgst-gv-container:not(.is-hidden):not(.esgst-hidden)"))&&s.push(`[](ESGST-${this.esgst.modules.giveawaysGiveawayEncrypterDecrypter.ged_encryptCode(e.code)})`)}),e.textAreaGiveaways.value=s.join(" ")}mm_copyOutput(e,t){e["textArea"+t].select(),document.execCommand("copy"),Yi(e["message"+t],"Copied!")}async mm_hideDiscussions(e,t){let s={};t.forEach(t=>{if(!t.mm||!t.outerWrap.offsetParent&&!t.outerWrap.closest(".esgst-gv-container:not(.is-hidden):not(.esgst-hidden)"))return;let n=Date.now();s[t.code]={hidden:n,lastUsed:n},"main"===e.source&&this.esgst.discussionPath||t.outerWrap.remove()}),await eo(s)}async mm_bookmarkDiscussions(e,t){for(const e of t)e.mm&&(e.outerWrap.offsetParent||e.outerWrap.closest(".esgst-gv-container:not(.is-hidden):not(.esgst-hidden)"))&&e.idbButton&&1===e.idbButton.index&&await e.idbButton.triggerCallback()}async mm_unbookmarkDiscussions(e,t){for(const e of t)e.mm&&(e.outerWrap.offsetParent||e.outerWrap.closest(".esgst-gv-container:not(.is-hidden):not(.esgst-hidden)"))&&e.idbButton&&3===e.idbButton.index&&await e.idbButton.triggerCallback()}async mm_visitDiscussions(e,t){let s={};t.forEach(e=>{e.mm&&(e.outerWrap.offsetParent||e.outerWrap.closest(".esgst-gv-container:not(.is-hidden):not(.esgst-hidden)"))&&e.gdtttButton&&1===e.gdtttButton.index&&(s[e.code]={visited:!0,lastUsed:Date.now()},d.get("ct_s")&&(s[e.code].count=e.count),e.gdtttButton.callbacks[0](),e.gdtttButton.change(null,2))}),await eo(s)}async mm_unvisitDiscussions(e,t){let s={};t.forEach(e=>{e.mm&&(e.outerWrap.offsetParent||e.outerWrap.closest(".esgst-gv-container:not(.is-hidden):not(.esgst-hidden)"))&&e.gdtttButton&&3===e.gdtttButton.index&&(s[e.code]={count:0,visited:!1,lastUsed:Date.now()},e.gdtttButton.callbacks[2](),e.gdtttButton.change(null,0))}),await eo(s)}mm_selectWbcUsers(e,t,s){this.esgst[s+"Button"]&&(this.esgst.mmWbcUsers=[],t.forEach(e=>{e.mm&&(e.outerWrap.offsetParent||e.outerWrap.closest(".esgst-gv-container:not(.is-hidden):not(.esgst-hidden)"))&&this.esgst.mmWbcUsers.push(e.code)}),this.esgst[s+"Button"].setAttribute("data-mm",!0),this.esgst[s+"Button"].click())}mm_selectGlwcUsers(e,t){const s=[];t.forEach(e=>{e.mm&&(e.outerWrap.offsetParent||e.outerWrap.closest(".esgst-gv-container:not(.is-hidden):not(.esgst-hidden)"))&&s.push(e.code)}),yt.open("https://www.steamgifts.com/account/settings/profile?esgst=glwc&users="+s.join(","))}async mm_hideGames(e,t){const s=e.textAreaGames.value.split(/\n/).map(e=>{const t=e.match(/(app|sub)\/(\d+)/);return t?{code:t[2],fromTextArea:!0,name:e,type:t[1]+"s"}:null}).filter(e=>e);s.length&&(t=s);const n=[],a=[];for(const e of t){if(!(e.fromTextArea||e.mm&&(e.outerWrap.offsetParent||e.outerWrap.closest(".esgst-gv-container:not(.is-hidden):not(.esgst-hidden)"))))continue;const t=this.esgst.games[e.type][e.code];t&&t.hidden||("apps"===e.type?n:a).push(e.code)}e.progressGames.setLoading(null).show();const i=await hs.hideGames({appIds:n,subIds:a,update:t=>e.progressGames.setMessage(t)});e.progressGames.reset().hide();let o="";i.apps.length&&(o+=`The following apps were not found and therefore not hidden (they are most likely internal apps, such as demos, game editors etc): ${i.apps.join(", ")}\n`),i.subs.length&&(o+=`The following subs were not found and therefore not hidden: ${i.subs.join(", ")}\n`),o&&window.alert(o)}async mm_categorizeGames(e,t){const s=new lt({addScrollable:!0,buttons:[[{template:"success",name:"Categorize",onClick:this.mm_loadFile.bind(this,e,t)},{template:"loading",isDisabled:!0,name:"Categorizing..."}]],icon:"fa-clone",textInputs:[{placeholder:"Category1, Category2, Category3, ..."}],title:Se.element("fragment",null,"Categorize Games ",Se.element("i",{className:"fa fa-question-circle"}))});e.categorizePopup=s,e.categorizeInput=Ji(s.description,"afterbegin",[{attributes:{type:"file"},type:"input"}]),zi(s.title.lastElementChild,'\n\t\t\tHow To Use\n\t\t\t<br>\n\t\t\t<br>\n\t\t\t1. Exit Steam.\n\t\t\t<br>\n\t\t\t2. Click "Browse..." to select a file from your computer.\n\t\t\t<br>\n\t\t\t3. Navigate to where "sharedconfig.vdf" is located and select it. The file should be located at "[YourSteamFolder]/userdata/[YourSteamId]/7/remote".\n\t\t\t<br>\n\t\t\t4. Enter the categories that you want to assign to the games, separated by a comma and followed by a space.\n\t\t\t<br>\n\t\t\t5. Click "Categorize".\n\t\t\t<br>\n\t\t\t6. If you did everything correctly, a new "sharedconfig.vdf" file will be downloaded to your computer.\n\t\t\t<br>\n\t\t\t7. Replace the old file with the new file. Make sure to make a backup of the old file, just in case.\n\t\t\t<br>\n\t\t\t8. Start Steam. You should see the games categorized as you wanted.\n\t\t\t<br>\n\t\t'),s.open()}mm_loadFile(e,t){return new Promise(s=>{const n=e.categorizeInput.files[0];if(!n)return window.alert("No file selected!"),void s();if("sharedconfig.vdf"!==n.name)return window.alert("File invalid!"),void s();const a=new FileReader;a.onload=this.mm_readFile.bind(this,e,t,a,s),a.readAsText(n)})}mm_readFile(e,t,s,n){if(!s)return window.alert("An error occurred!"),void n();const a=e.categorizePopup.getTextInputValue(0).replace(/,\s*/g,",").split(/,/),i=VDF.parse(s.result);for(const e of t){if(!e.mm||!e.outerWrap.offsetParent&&!e.outerWrap.closest(".esgst-gv-container:not(.is-hidden):not(.esgst-hidden)")||"apps"!==e.type)continue;const t=i.UserRoamingConfigStore.Software.Valve.Steam.Apps[e.code];t&&(t.tags||(t.tags=[]),t.tags.push(...a),t.tags=Array.from(new Set(t.tags)))}Qi(VDF.stringify(i,!0),"sharedconfig.vdf"),n()}},ao=hs.createHeadingButton.bind(hs);const io=new class extends gt{constructor(){super(),this.info={description:()=>Se.element("ul",null,Se.element("li",null,"Hides the main post of a discussion and adds a button (",Se.element("i",{className:"fa fa-home"}),") to its main page heading that allows you to open the main post through a popup."),Se.element("li",null,"This feature is useful if you have ",Se.element("span",{"data-esgst-feature-id":"fmph"})," enabled, which allows you to view the main post of a discussion from any scrolling position.")),features:{mpp_r:{dependencies:["ct"],name:"Only hide the main post if it has been marked as read.",sg:!0}},id:"mpp",name:"Main Post Popup",sg:!0,type:"discussions"}}init(){if(!this.esgst.discussionPath)return;let e,t,s=ao({id:"mpp",icons:["fa-home"],title:"Open the main post"}),n=document.createElement("div");n.className="page__outer-wrap";do{e=this.esgst.mainPageHeading.previousElementSibling,e&&n.insertBefore(e,n.firstElementChild)}while(e);if(this.esgst.mainPageHeading.parentElement.insertBefore(n,this.esgst.mainPageHeading),d.get("mpp_r")){let e=JSON.parse(c.common.getValue("discussions","{}"))[window.location.pathname.match(/^\/discussion\/(.+?)\//)[1]];e&&e.readComments&&e.readComments[""]?(t=!0,window.scrollTo(0,0)):t=!1}else t=!0,window.scrollTo(0,0);n.classList.add(t?"esgst-mpp-hidden":"esgst-mpp-visible","esgst-text-left"),s.addEventListener("click",()=>{t||(n.classList.remove("esgst-mpp-visible"),n.classList.add("esgst-mpp-hidden"));let e=new lt({icon:"",title:"",popup:n});n.classList.add("esgst-mpp-popup"),e.open(),e.onClose=()=>{n.classList.remove("esgst-mpp-popup"),t||(n.classList.remove("esgst-mpp-hidden"),n.classList.add("esgst-mpp-visible"),n.removeAttribute("style"),this.esgst.mainPageHeading.parentElement.insertBefore(n,this.esgst.mainPageHeading))}})}},oo=hs.goToComment.bind(hs);const ro=new class extends gt{constructor(){super(),this.info={description:()=>Se.element("ul",null,Se.element("li",null,"Skips to the comments of a discussion if you have used the pagination navigation. For example, if you enter a discussion and use the pagination navigation to go to page 2, on page 2 the feature will skip the main post and take you directly to the comments.")),id:"mps",name:"Main Post Skipper",sg:!0,type:"discussions"}}init(){if(!window.location.hash&&this.esgst.discussionPath&&this.esgst.pagination&&document.referrer.match(new RegExp(`/discussion/${[window.location.pathname.match(/^\/discussion\/(.+?)\//)[1]]}/`))){const e=this.esgst.pagination.previousElementSibling;e.classList.contains("comments")&&oo("",e.firstElementChild.firstElementChild,!0)}}};const lo=new class extends gt{constructor(){super(),this.info={description:()=>Se.element("ul",null,Se.element("li",null,"Adds a second inbox icon colored as red (",Se.element("i",{className:"fa fa-envelope esgst-red"}),") to the header of any page that allows you to be notified about messages from SteamTrades on SteamGifts and vice-versa."),Se.element("li",null,"This feature is compatible with ",Se.element("span",{"data-esgst-feature-id":"hr_b"}),".")),id:"nm",name:"Notification Merger",sg:!0,st:!0,type:"general"}}init(){c.header&&(Ee.subscribe(Ve,this.getNotifications.bind(this)),this.getNotifications())}async getNotifications(){switch(Be.namespace){case Pe:{const e=new Jt(Le);try{e.parse((await Ne.get("https://www.steamtrades.com")).html)}catch(e){dt.error(e.message)}if(!e.buttonContainers.messages)return void(c.header.buttonContainers.stMessages&&c.header.buttonContainers.stMessages.nodes.outer.classList.add("esgst-hidden"));c.header.buttonContainers.stMessages?(c.header.buttonContainers.stMessages.nodes.outer.classList.remove("esgst-hidden"),c.header.updateCounter("stMessages",e.buttonContainers.messages.data.counter)):c.header.addButtonContainer({buttonIcon:"fa fa-envelope esgst-nm-icon",buttonName:"ST Messages",context:c.header.buttonContainers.messages.nodes.outer,counter:e.buttonContainers.messages.data.counter,isActive:!0,isNotification:!0,position:"afterend",url:"https://www.steamtrades.com/messages"});e.buttonContainers.messages.nodes.counter||c.header.buttonContainers.stMessages.nodes.outer.classList.add("esgst-hidden");break}case Le:{const e=new Jt(Pe);try{e.parse((await Ne.get("https://www.steamgifts.com")).html)}catch(e){dt.error(e.message)}if(!e.buttonContainers.messages)return void(c.header.buttonContainers.sgMessages&&c.header.buttonContainers.sgMessages.nodes.outer.classList.add("esgst-hidden"));c.header.buttonContainers.sgMessages?(c.header.buttonContainers.sgMessages.nodes.outer.classList.remove("esgst-hidden"),c.header.updateCounter("sgMessages",e.buttonContainers.messages.data.counter)):c.header.addButtonContainer({buttonIcon:"fa fa-envelope esgst-nm-icon",buttonName:"SG Messages ",context:c.header.buttonContainers.messages.nodes.outer,counter:e.buttonContainers.messages.data.counter,isActive:!0,position:"afterend",url:"https://www.steamgifts.com/messages"});e.buttonContainers.messages.nodes.counter||c.header.buttonContainers.sgMessages.nodes.outer.classList.add("esgst-hidden");break}default:throw"Invalid namespace."}}},co=hs.createAlert.bind(hs);const go=new class extends gt{constructor(){super(),this.info={description:()=>Se.element("ul",null,Se.element("li",null,"Allows you to navigate through a train using hotkeys."),Se.element("li",null,'This feature is not 100% accurate, because the feature looks for a link with any variation of "previous"/"next" in the giveaway\'s description to make sure that it is going backward/forward, so if it does not find such a link, it will not work.'),Se.element("li",null,"It also does not work if you press the hotkey inside of an input/text area."),Se.element("li",null,"If you press Ctrl together with the hotkey, the giveaway is open in a new tab.")),id:"npth",name:"Next/Previous Train Hotkeys",inputItems:[{event:"keydown",id:"npth_previousKey",prefix:"Enter the key you want to use for previous links: "},{event:"keydown",id:"npth_nextKey",prefix:"Enter the key you want to use for next links: "},{id:"npth_previousRegex",prefix:"Enter the regex you want to use to detect previous links: "},{id:"npth_nextRegex",prefix:"Enter the regex you want to use to detect next links: "}],sg:!0,type:"giveaways"}}init(){const e=new RegExp(d.get("npth_previousRegex")),t=new RegExp(d.get("npth_nextRegex"));let s,n,a,i,o,r,l,c;if(this.esgst.giveawayCommentsPath&&(s=document.getElementsByClassName("page__description")[0],s)){for(a=s.querySelectorAll('[href*="/giveaway/"]'),o=a.length,i=0;i<o&&(!l||!r);++i)n=a[i],c=n.textContent.toLowerCase(),!l&&c.match(e)?l=n:!r&&c.match(t)&&(r=n);l&&r||(o>1?(l=a[0],r=a[1]):r=a[0]),(l||r)&&this.esgst.documentEvents.keydown.add(this.npth_loadGiveaway.bind(this,r,l))}}npth_loadGiveaway(e,t,s){let n;s.target.closest("input, textarea")||(s.key===d.get("npth_previousKey")?t?s.ctrlKey?yt.open(t.getAttribute("href")):window.location.href=t.getAttribute("href"):(n=document.referrer,n.match(/\/giveaway\//)&&(e&&n!==e.getAttribute("href")||!e)?s.ctrlKey?yt.open(n):window.location.href=n:co("No previous link found.")):s.key===d.get("npth_nextKey")&&(e?s.ctrlKey?yt.open(e.getAttribute("href")):window.location.href=e.getAttribute("href"):co("No next link found.")))}},uo=hs.getFeatureTooltip.bind(hs);const mo=new class extends gt{constructor(){super(),this.info={description:()=>Se.element("ul",null,Se.element("li",null,"Moves the pagination navigation of any page to the main page heading of the page.")),features:{pnot_s:{name:"Enable simplified view (will show only the numbers and arrows).",sg:!0,st:!0}},id:"pnot",name:"Pagination Navigation On Top",sg:!0,st:!0,type:"general"}}init(){this.esgst.paginationNavigation&&this.esgst.mainPageHeading&&(this.esgst.st&&this.esgst.paginationNavigation.classList.add("page_heading_btn"),this.esgst.paginationNavigation.title=uo("pnot"),this.pnot_simplify(),Se.insert(this.esgst.mainPageHeading.querySelector(".page__heading__breadcrumbs, .page_heading_breadcrumbs"),"afterend",this.esgst.paginationNavigation))}pnot_simplify(){if(d.get("pnot")&&d.get("pnot_s")){const e=this.esgst.paginationNavigation.querySelectorAll("span");for(const t of e)t.textContent.match(/[A-Za-z]+/)&&(t.textContent=t.textContent.replace(/[A-Za-z]+/g,""),t.previousElementSibling&&t.appendChild(t.previousElementSibling),t.nextElementSibling&&t.appendChild(t.nextElementSibling))}}},ho=hs.createElements.bind(hs);const po=new class extends gt{constructor(){super(),this.info={description:()=>Se.element("ul",null,Se.element("li",null,"Modifies the arrow button in the pinned giveaways box of the main page so that you are able to collapse the box again after expanding it.")),id:"pgb",name:"Pinned Giveaways Button",sg:!0,type:"giveaways"}}init(){let e=document.getElementsByClassName("pinned-giveaways__button")[0];if(!e)return;const t=e.previousElementSibling;t.classList.add("esgst-pgb-container"),e.remove(),e=ho(t,"afterend",[{attributes:{class:"esgst-pgb-button"},type:"div",children:[{attributes:{class:"esgst-pgb-icon fa fa-angle-down"},type:"i"}]}]);const s=e.firstElementChild;e.addEventListener("click",this.pgb_toggle.bind(this,t,s))}pgb_toggle(e,t){e.classList.toggle("pinned-giveaways__inner-wrap--minimized"),t.classList.toggle("fa-angle-down"),t.classList.toggle("fa-angle-up")}},fo=hs.getValue.bind(hs),bo=hs.setValue.bind(hs);const wo=new class extends gt{constructor(){super(),this.info={description:()=>Se.element("ul",null,Se.element("li",null,'Adds a checkbox in front of a discussion categorized as "Puzzles" (in any page) that changes states (',Se.element("i",{className:"fa fa-circle-o esgst-grey"})," by default,"," ",Se.element("i",{className:"fa fa-times-circle esgst-red"}),' for "unsolved",'," ",Se.element("i",{className:"fa fa-exclamation-circle esgst-orange"}),' for "in progress" and'," ",Se.element("i",{className:"fa fa-check-circle esgst-green"}),'for "solved") and allows you to mark the puzzle as unsolved/in progress / solved.')),features:{pm_a:{name:"Show the checkbox for all discussions, regardless of their category.",sg:!0}},id:"pm",name:"Puzzle Marker",sg:!0,type:"discussions",featureMap:{discussion:this.pm_addButtons.bind(this)}}}pm_addButtons(e,t){for(const s of e)if(d.get("pm_a")||"Puzzles"===s.category){let e=t&&this.esgst.discussionPath?s.headingContainer:s.outerWrap;e.getElementsByClassName("esgst-pm-button")[0]||(e.classList.add("esgst-relative"),new Us(e,"afterbegin",{callbacks:[this.pm_change.bind(this,s.code,"unsolved"),null,this.pm_change.bind(this,s.code,"in progress"),null,this.pm_change.bind(this,s.code,"solved"),null,this.pm_change.bind(this,s.code,"off"),null],className:"esgst-pm-button",icons:["fa-circle-o esgst-clickable esgst-grey","fa-circle-o-notch fa-spin","fa-times-circle esgst-clickable esgst-red","fa-circle-o-notch fa-spin","fa-exclamation-circle esgst-clickable esgst-orange","fa-circle-o-notch fa-spin","fa-check-circle esgst-clickable esgst-green","fa-circle-o-notch fa-spin"],id:"pm",index:["off","","unsolved","","in progress","","solved"].indexOf(s.saved&&s.saved.status||"off"),titles:["Current status is 'off', click to change to 'unsolved'","Changing status...","Current status is 'unsolved', click to change to 'in progress'","Changing status...","Current status is 'in progress', click to change to 'solved'","Changing status...","Current status is 'solved', click to change to 'off'","Changing status..."]}))}}async pm_change(e,t){const s=new Te("comment",{threshold:300});await s.lock();let n=JSON.parse(fo("discussions"));return n[e]||(n[e]={readComments:{}}),"off"===t?delete n[e].status:n[e].status=t,n[e].lastUsed=Date.now(),await bo("discussions",JSON.stringify(n)),await s.unlock(),!0}};const yo=new class extends gt{constructor(){super(),this.info={colors:{barColor:"Bar Color",barColorHover:"Bar Color (Hover / Account Page)",barColorSelected:"Bar Color (Account Page Hover)"},description:()=>Se.element("ul",null,Se.element("li",null,"Displays a green bar in the account button at the header of any page that represents the amount of points that you have.")),id:"pv",name:"Points Visualizer",sg:!0,type:"general"}}init(){Ee.subscribe(Oe,this.pv_setStyle.bind(this)),this.pv_setStyle(null,Be.counters.points),this.esgst.modules.generalLevelProgressVisualizer.joinStyles()}pv_setStyle(e,t){const s=Math.min(400,t)/400*100,n=c.header.buttonContainers.account.nodes.button.offsetWidth,a=c.header.buttonContainers.account.nodes.outer.offsetWidth,i=Math.trunc(s*(a/100)),o=i+"px",r=Math.max(0,i-n)+"px",l=d.get("pv_barColor"),g=d.get("pv_barColorHover"),u=d.get("pv_barColorSelected");this.esgst.pvStyleArray=[{selector:".esgst-lpv-container",rules:[{name:"background-image",values:[`linear-gradient(to right, ${l} ${o}, transparent ${o})`,"var(--esgst-lpv-button, linear-gradient(#8a92a1 0px, #757e8f 8px, #4e5666 100%))"]}]},{selector:".esgst-lpv-container .nav__button--is-dropdown:hover",rules:[{name:"background-image",values:[`linear-gradient(to right, ${g} ${o}, transparent ${o})`,"var(--esgst-lpv-button-hover, linear-gradient(#9ba2b0 0px, #8c94a3 8px, #596070 100%))"]}]},{selector:".esgst-lpv-container .nav__button--is-dropdown-arrow:hover",rules:[{name:"background-image",values:[`linear-gradient(to right, ${g} ${r}, transparent ${r})`,"var(--esgst-lpv-button-hover, linear-gradient(#9ba2b0 0px, #8c94a3 8px, #596070 100%))"]}]},{selector:".esgst-lpv-container .nav__button--is-dropdown-arrow.is-selected",rules:[{name:"background-image",values:[`linear-gradient(to right, ${l} ${r}, transparent ${r})`,"var(--esgst-lpv-arrow, linear-gradient(#4e525f 0px, #434857 5px, #2b2e3a 100%))"]}]},{selector:".esgst-lpv-container.is-selected .nav__button--is-dropdown",rules:[{name:"background-image",values:[`linear-gradient(to right, ${g} ${o}, transparent ${o})`,"var(--esgst-lpv-button-selected, linear-gradient(#d0d5de 0px, #c9cdd7 5px, #9097a6 100%))"]}]},{selector:".esgst-lpv-container.is-selected .nav__button--is-dropdown-arrow",rules:[{name:"background-image",values:[`linear-gradient(to right, ${g} ${r}, transparent ${r})`,"var(--esgst-lpv-button-selected, linear-gradient(#d0d5de 0px, #c9cdd7 5px, #9097a6 100%))"]}]},{selector:".esgst-lpv-container.is-selected .nav__button--is-dropdown:hover",rules:[{name:"background-image",values:[`linear-gradient(to right, ${u} ${o}, transparent ${o})`,"var(--esgst-lpv-button-selected-hover, linear-gradient(#f0f1f5 0px, #d1d4de 100%))"]}]},{selector:".esgst-lpv-container.is-selected .nav__button--is-dropdown-arrow:hover:not(.is-selected)",rules:[{name:"background-image",values:[`linear-gradient(to right, ${u} ${r}, transparent ${r})`,"var(--esgst-lpv-button-selected-hover, linear-gradient(#f0f1f5 0px, #d1d4de 100%))"]}]},{selector:".esgst-lpv-container.is-selected .nav__button--is-dropdown-arrow.is-selected",rules:[{name:"background-image",values:[`linear-gradient(to right, ${u} ${r}, transparent ${r})`,"var(--esgst-lpv-arrow-selected, linear-gradient(#4e525f 0px, #434857 5px, #2b2e3a 100%))"]}]}]}},vo=hs.createElements.bind(hs),_o=hs.getFeatureTooltip.bind(hs);const ko=new class extends gt{constructor(){super(),this.info={description:()=>Se.element("ul",null,Se.element("li",null,'Adds a search box before the "Giveaways" box at the header of any page that allows you to quickly search for giveaways from any page.'),Se.element("li",null,"Has ",Se.element("span",{"data-esgst-feature-id":"ags"})," built-in.")),features:{qgs_h:{name:"Hide the native search on the main page.",sg:!0}},id:"qgs",name:"Quick Giveaway Search",options:{title:"Position:",values:["Left","Right"]},sg:!0,type:"giveaways"}}init(){let e=vo(c.header.nodes.leftNav,0===d.get("qgs_index")?"afterbegin":"beforeend",[{attributes:{class:"esgst-qgs-container",title:_o("qgs")},type:"div",children:[{attributes:{class:"esgst-qgs-input",placeholder:"Search...",type:"text"},type:"input"},{attributes:{class:"fa fa-search"},type:"i"}]}]);e.addEventListener("mouseenter",this.qgs_expand.bind(this)),e.addEventListener("mouseleave",this.qgs_collapse.bind(this)),e.firstElementChild.addEventListener("keypress",this.qgs_trigger.bind(this)),d.get("qgs_h")&&this.esgst.giveawaysPath&&document.getElementsByClassName("sidebar__search-container")[0].remove()}qgs_expand(e){e.currentTarget.classList.add("esgst-qgs-container-expanded")}qgs_collapse(e){e.relatedTarget&&e.relatedTarget.closest(".esgst-popout")||e.currentTarget.classList.remove("esgst-qgs-container-expanded")}qgs_trigger(e){"Enter"===e.key&&(e.preventDefault(),window.location.href="/giveaways/search?q="+encodeURIComponent(e.currentTarget.value))}},xo=hs.createElements.bind(hs),Ao=hs.getFeatureTooltip.bind(hs),Co=hs.observeChange.bind(hs),So=hs.observeNumChange.bind(hs),Eo=hs.triggerOnEnter.bind(hs);const To=new class extends gt{constructor(){super(),this.info={description:()=>Se.element("ul",null,Se.element("li",null,"Adds a panel below the search field of the main page that allows you to easily search for giveaways using SteamGifts'"," ",Se.element("a",{href:"https://www.steamgifts.com/discussion/8SzdT/"},"search parameters"),".")),id:"ags",name:"Advanced Giveaway Search",sg:!0,type:"giveaways"}}init(){let e="";if(this.esgst.giveawaysPath&&(e+=".sidebar__search-container, "),d.get("qgs")&&(e+=".esgst-qgs-container, "),!e)return;const t=document.querySelectorAll(e.slice(0,-2));for(const e of t)this.ags_addPanel(e)}ags_addPanel(e){const t=e.classList.contains("esgst-qgs-container");let s={qgs:t};e.firstElementChild.remove(),s.input=xo(e,"afterbegin",[{attributes:{class:""+(t?"esgst-qgs-input":"sidebar__search-input"),placeholder:"Search...",type:"text"},type:"input"}]);let n=s.input.nextElementSibling;if(n.classList.add("esgst-clickable"),n.title=Ao("ags","Use advanced search"),!t){let e=window.location.search.match(/q=(.*?)(&.*?)?$/);e&&(s.input.value=decodeURIComponent(e[1]))}t||(!d.get("adots")||0!==d.get("adots_index"))&&d.get("adots")?s.panel=new mt("esgst-ags-panel",e,100).popout:s.panel=xo(e,"afterend",[{attributes:{class:"esgst-ags-panel"},type:"div"}]);let a=[{key:"ags_type",parameter:"type",name:"Type",options:[{name:"All",value:""},{name:"Wishlist",value:"wishlist"},{name:"Recommended",value:"recommended"},{name:"Group",value:"group"},{name:"New",value:"new"}],type:"select"},{maxKey:"ags_maxDate",minKey:"ags_minDate",maxParameter:"release_date_max",minParameter:"release_date_min",name:"Release Date",type:"input"},{maxKey:"ags_maxScore",minKey:"ags_minScore",maxParameter:"metascore_max",minParameter:"metascore_min",name:"Metascore",type:"input"},{maxKey:"ags_maxLevel",minKey:"ags_minLevel",maxParameter:"level_max",minParameter:"level_min",name:"Level",type:"select"},{maxKey:"ags_maxEntries",minKey:"ags_minEntries",maxParameter:"entry_max",minParameter:"entry_min",name:"Entries",type:"input"},{maxKey:"ags_maxCopies",minKey:"ags_minCopies",maxParameter:"copy_max",minParameter:"copy_min",name:"Copies",type:"input"},{maxKey:"ags_maxPoints",minKey:"ags_minPoints",maxParameter:"point_max",minParameter:"point_min",name:"Points",type:"input"},{key:"ags_regionRestricted",name:"Region Restricted",parameter:"region_restricted",type:"checkbox"},{key:"ags_dlc",name:"DLC",parameter:"dlc",type:"checkbox"},{key:"ags_app",name:"App",parameter:"app",type:"checkbox"},{key:"ags_sub",name:"Sub",parameter:"sub",type:"checkbox"}];s.filters=[];for(let e=0,t=a.length;e<t;++e)this.ags_createFilter(s,a[e]);s.input.addEventListener("keydown",Eo.bind(hs,this.ags_searchQuery.bind(this,s))),n.addEventListener("click",this.ags_searchQuery.bind(this,s))}ags_createFilter(e,t){if("ags_type"!==t.key||e.qgs)if("checkbox"===t.type){let s=xo(e.panel,"beforeend",[{attributes:{class:"esgst-ags-checkbox-filter"},type:"div",children:[{text:t.name,type:"span"}]}]),n=new St(s,d.get(t.key)).input;Co(n,t.key,!0,"checked","click"),e.filters.push({filter:n,key:"checked",parameter:t.parameter})}else if(t.options){let s=[{type:"select",children:[]}];t.options.forEach(e=>{s[0].children.push({attributes:{value:e.value},text:e.name,type:"option"})});let n=xo(e.panel,"beforeend",[{attributes:{style:"display: block;"},type:"div",children:[{text:t.name+" ",type:"node"},{attributes:{class:"esgst-ags-filter"},type:"class",children:s}]}]).firstElementChild.firstElementChild;n.value=d.get(t.key),So(n,t.key,!0),e.filters.push({filter:n,key:"value",parameter:t.parameter})}else{let s=[];if("select"===t.type){s.push({type:"select",children:[{type:"option"}]});for(let e=0;e<=10;++e)s[0].children.push({text:e,type:"option"})}else s="ags_maxDate"===t.maxKey?[{attributes:{type:"date"},type:"input"}]:[{attributes:{type:"text"},type:"input"}];let n=xo(e.panel,"beforeend",[{type:"div",children:[{text:t.name+" ",type:"node"},{attributes:{class:"esgst-ags-filter"},type:"div",children:s},{attributes:{class:"esgst-ags-filter"},type:"div",children:s}]}]),a=n.lastElementChild.lastElementChild;a.value=d.get(t.maxKey),So(a,t.maxKey,!0);let i=n.firstElementChild.lastElementChild;i.value=d.get(t.minKey),So(i,t.minKey,!0),"input"===t.type&&(a.addEventListener("keypress",Eo.bind(hs,this.ags_searchQuery.bind(this,e))),i.addEventListener("keypress",Eo.bind(hs,this.ags_searchQuery.bind(this,e)))),e.filters.push({filter:i,key:"value",parameter:t.minParameter}),e.filters.push({filter:a,key:"value",parameter:t.maxParameter})}}ags_searchQuery(e){let t;if(t=d.get("ags_app")||d.get("ags_sub")?"https://www.steamgifts.com/giveaways/search?q=":"https://www.steamgifts.com/giveaways/search?q="+encodeURIComponent(e.input.value),!e.qgs){let e=window.location.search.match(/(type=.*?)(&.*?)?$/);e&&(t+="&"+e[1])}for(let s=0,n=e.filters.length;s<n;++s){let n=e.filters[s],a=n.filter[n.key];a&&("app"===n.parameter?t+="&app="+e.input.value:"sub"===n.parameter?t+="&sub="+e.input.value:t+=`&${n.parameter}=${a}`)}window.location.href=t}};const No=new class extends gt{constructor(){super(),this.info={description:()=>Se.element("ul",null,Se.element("li",null,"Turns the magnifying glass icon (",Se.element("i",{className:"fa fa-search"}),") in the search field of any page into a button that submits the search when you click on it.")),id:"smgb",name:"Search Magnifying Glass Button",sg:!0,type:"general"}}init(){let e,t;for(e=document.querySelectorAll(".sidebar__search-container .fa-search, .esgst-qgs-container .fa-search"),t=e.length-1;t>-1;--t){let s,n;s=e[t],n=s.previousElementSibling,s.classList.add("esgst-clickable"),s.addEventListener("click",()=>{let e=n.value.trim();e&&(d.get("as")&&e.match(/"|id:/)?this.esgst.modules.giveawaysArchiveSearcher.as_openPage(n):window.location.href=`${this.esgst.searchUrl.replace(/page=/,"")}q=${e}`)})}}},Po=hs.checkMissingDiscussions.bind(hs),Lo=hs.getFeatureTooltip.bind(hs);const Io=new class extends gt{constructor(){super(),this.info={description:()=>Se.element("ul",null,Se.element("li",null,"Adds a button (",Se.element("i",{className:"fa fa-refresh"}),") to the page heading of the active discussions that allows you to refresh the active discussions without having to refresh the entire page.")),id:"radb",name:"Refresh Active Discussions Button",sg:!0,sgPaths:/^Discussion|Giveaway|Browse\sGiveaways/,type:"discussions"}}init(){!this.esgst.commentsPath||d.get("oadd")||d.get("adots")||this.radb_addButtons()}radb_addButtons(){let e,t;for(e=this.esgst.activeDiscussions.querySelectorAll(".block_header, .esgst-heading-button"),t=e.length-1;t>-1;--t)Se.insert(e[t],"beforebegin",Se.element("div",{className:"esgst-radb-button"+(d.get("oadd")?"":" block_header"),title:Lo("radb","Refresh active discussions/deals"),onclick:e=>{let t=e.currentTarget.firstElementChild;t.classList.add("fa-spin"),d.get("oadd")?this.esgst.modules.discussionsOldActiveDiscussionsDesign.oadd_load(!0,()=>{t.classList.remove("fa-spin")}):Po(!0,()=>{t.classList.remove("fa-spin")})}},Se.element("i",{className:"fa fa-refresh"})))}};const Bo=new class extends gt{constructor(){super(),this.info={description:()=>Se.element("ul",null,Se.element("li",null,"Allows you to customize the number of active discussions displayed.")),inputItems:[{id:"activeDiscussions_displayed",prefix:"Number of active discussions to display ",suffix:"( More than 7 will require an additional page request. )",attributes:{type:"number",min:"1",step:"1"}}],id:"adtd",name:"Active Discussions To Display",sg:!0,sgPaths:/^Discussion|Giveaway|Browse\sGiveaways/,type:"discussions"}}init(){!(this.esgst.giveawaysPath||this.esgst.discussionPath||this.esgst.giveawayPath||this.esgst.activeDiscussions)||d.get("oadd")||d.get("adots")||this.adtd_remove()}adtd_remove(){if(this.esgst.activeDiscussions){const e=this.esgst.activeDiscussions,t=d.get("activeDiscussions_displayed"),s=d.get("adots_index"),n=e.firstElementChild.querySelector(".table"),a=e.lastElementChild.querySelector(".table"),i=Array.from(n.firstElementChild.children),o=Array.from(a.firstElementChild.children),r=Math.max(i.length,o.length)-t;for(let e=0;e<r;e++)i[i.length-1-e].remove(),o[o.length-1-e].remove();const l=n.getBoundingClientRect().height,c=a.getBoundingClientRect().height,g=0===s?0:14*t;n.style.minHeight=l-g+"px",a.style.minHeight=c-g+"px"}}};const Do=new class extends gt{constructor(){super(),this.info={description:()=>Se.element("ul",null,Se.element("li",null,"Adds a button (",Se.element("i",{className:"fa fa-comment"}),") to the main page heading of any page that allows you to add comments to the page through a popup."),Se.element("li",null,"This feature is useful if you have ",Se.element("span",{"data-esgst-feature-id":"fmph"})," enabled, which allows you to add comments to the page from any scrolling position.")),id:"rbp",name:"Reply Box Popup",sg:!0,st:!0,type:"comments"}}init(){if(!c.esgst.replyBox)return;let e=c.common.createHeadingButton({id:"rbp",icons:["fa-comment"],title:"Add a comment"}),t=new lt({addProgress:!0,addScrollable:!0,icon:"fa-comment",title:"Add a comment:"});Se.insert(t.scrollable,"beforeend",Se.element("textarea",{name:"description",ref:e=>t.textArea=e})),tt.create([{template:"success",name:"Save",onClick:async()=>{await c.common.saveComment(null,c.esgst.sg?"":document.querySelector('[name="trade_code"]').value,"",t.textArea.value,c.esgst.sg?c.esgst.locationHref.match(/(.+?)(#.+?)?$/)[1]:"/ajax.php",t.progressBar,!0)}},{template:"loading",isDisabled:!0,name:"Saving..."}]).insert(t.description,"beforeend"),e.addEventListener("click",t.open.bind(t,t.textArea.focus.bind(t.textArea)))}};const Go=new class extends gt{constructor(){super(),this.info={description:()=>Se.element("ul",null,Se.element("li",null,"When you click on any text area (in any page) to start writing a comment, a panel is added above it that helps you use SteamGifts'"," ",Se.element("a",{href:"https://www.steamgifts.com/about/comment-formatting"},"comment formatting"),"."),Se.element("li",null,"There is a button (",Se.element("i",{className:"fa fa-paste"})," if enabled and"," ",Se.element("i",{className:"fa fa-paste esgst-faded"})," if disabled) in the panel that allows the feature to automatically format links/images pasted into the text area."),Se.element("li",null,"There are also buttons (",Se.element("i",{className:"fa fa-rotate-right"})," to redo and"," ",Se.element("i",{className:"fa fa-rotate-left"})," to undo) in the panel that allow you to redo/undo any formatting added.")),features:{cfh_bq:{description:()=>Se.element("fragment",null,Se.element("ul",null,Se.element("li",null,"Adds a button (",Se.element("i",{className:"fa fa-quote-left"})," ) to the panel that allows you to write text like shown below.")),Se.element("blockquote",null,"Blockquote")),name:"Blockquote",sg:!0,st:!0},cfh_b:{description:()=>Se.element("fragment",null,Se.element("ul",null,Se.element("li",null,"Adds a button (B) to the panel that allows you to write text like shown below.")),Se.element("strong",null,"Bold")),name:"Bold",sg:!0,st:!0},cfh_h1:{description:()=>Se.element("fragment",null,Se.element("ul",null,Se.element("li",null,"Adds a button (H¹) to the panel that allows you to write text like shown below.")),Se.element("h1",null,"Heading 1")),name:"Heading 1",sg:!0,st:!0},cfh_h2:{description:()=>Se.element("fragment",null,Se.element("ul",null,Se.element("li",null,"Adds a button (H²) to the panel that allows you to write text like shown below.")),Se.element("h2",null,"Heading 2")),name:"Heading 2",sg:!0,st:!0},cfh_h3:{description:()=>Se.element("fragment",null,Se.element("ul",null,Se.element("li",null,"Adds a button (H³) to the panel that allows you to write text like shown below.")),Se.element("h3",null,"Heading 3")),name:"Heading 3",sg:!0,st:!0},cfh_ic:{description:()=>Se.element("fragment",null,Se.element("ul",null,Se.element("li",null,"Adds a button (",Se.element("i",{className:"fa fa-code"})," ) to the panel that allows you to write text like shown below.")),Se.element("p",null,"Inline ",Se.element("code",null,"Code"))),name:"Inline Code",sg:!0,st:!0},cfh_i:{description:()=>Se.element("fragment",null,Se.element("ul",null,Se.element("li",null,"Adds a button (I) to the panel that allows you to write text like shown below.")),Se.element("em",null,"Italic")),name:"Italic",sg:!0,st:!0},cfh_lb:{description:()=>Se.element("fragment",null,Se.element("ul",null,Se.element("li",null,"Adds a button (",Se.element("i",{className:"fa fa-minus"}),") to the panel that allows you to write text like shown below.")),Se.element("p",null,"Line"),Se.element("hr",null),Se.element("p",null,"Break")),name:"Line Break",sg:!0,st:!0},cfh_lc:{description:()=>Se.element("fragment",null,Se.element("ul",null,Se.element("li",null,"Adds a button (",Se.element("i",{className:"fa fa-code"}),Se.element("i",{className:"fa fa-indent"}),") to the panel that allows you to write text like shown below.")),Se.element("code",null,"Line Code")),name:"Line Code",sg:!0,st:!0},cfh_ol:{description:()=>Se.element("fragment",null,Se.element("ul",null,Se.element("li",null,"Adds a button (",Se.element("i",{className:"fa fa-list-ol"}),") to the panel that allows you to write text like shown below.")),Se.element("ol",null,Se.element("li",null,"Ordered"),Se.element("li",null,"List"))),name:"Ordered List",sg:!0,st:!0},cfh_pc:{description:()=>Se.element("fragment",null,Se.element("ul",null,Se.element("li",null,"Adds a button (",Se.element("i",{className:"fa fa-code"}),Se.element("i",{className:"fa fa-paragraph"}),") to the panel that allows you to write text like shown below.")),Se.element("pre",null,Se.element("code",null,"Paragraph Code"))),name:"Paragraph Code",sg:!0,st:!0},cfh_s:{description:()=>Se.element("fragment",null,Se.element("ul",null,Se.element("li",null,"Adds a button (",Se.element("i",{className:"fa fa-eye-slash"}),") to the panel that allows you to write text like shown below.")),Se.element("span",{className:"spoiler"},"Spoiler")),name:"Spoiler",sg:!0,st:!0},cfh_st:{description:()=>Se.element("fragment",null,Se.element("ul",null,Se.element("li",null,"Adds a button (",Se.element("i",{className:"fa fa- strikethrough"}),") to the panel that allows you to write text like shown below.")),Se.element("del",null,"Strikethrough")),name:"Strikethrough",sg:!0,st:!0},cfh_ul:{description:()=>Se.element("fragment",null,Se.element("ul",null,Se.element("li",null,"Adds a button (",Se.element("i",{className:"fa fa-list-ul"}),") to the panel that allows you to write text like shown below.")),Se.element("ul",null,Se.element("li",null,"Unordered"),Se.element("li",null,"List"))),name:"Unordered List",sg:!0,st:!0},cfh_img:{description:()=>Se.element("ul",null,Se.element("li",null,"Adds a button(",Se.element("i",{className:"fa fa-image"}),") to the panel that allows you to add images to your comments with an interface where you can enter the title and the URL of the image and let ESGST format it."),Se.element("li",null,"You can also upload images from your computer instead of using a URL. The images will be uploaded to ",Se.element("a",{href:"https://imgur.com"},"Imgur"),".")),name:"Image",sg:!0,st:!0},cfh_l:{description:()=>Se.element("ul",null,Se.element("li",null,"Adds a button(",Se.element("i",{className:"fa fa-globe"}),") to the panel that allows you to add links to your comments with an interface where you can enter the title and the URL of the link and let ESGST format it.")),name:"Link",sg:!0,st:!0},cfh_t:{description:()=>Se.element("ul",null,Se.element("li",null,"Adds a button(",Se.element("i",{className:"fa fa-table"}),") to the panel that allows you to add tables to your comments with an interface where you can dynamically add as many rows / columns as you want, align each column however you want, enter the value for each cell and let ESGST format it.")),name:"Table",sg:!0,st:!0},cfh_e:{description:()=>Se.element("ul",null,Se.element("li",null,"Adds a button(",Se.element("i",{className:"fa fa-smile-o"}),") to the panel that allows you to add emojis to your comments by selecting them out of a huge list of emojis.")),name:"Emoji",sg:!0,st:!0},cfh_g:{description:()=>Se.element("ul",null,Se.element("li",null,"Adds a button(",Se.element("i",{className:"fa fa-star"}),") to the panel that allows you to add encrypted giveaways (see ",Se.element("span",{"data-esgst-feature-id":"ged"})," for more details about them) to your comments.")),name:"Giveaway Encrypter",sg:!0,st:!0},cfh_p:{description:()=>Se.element("ul",null,Se.element("li",null,"Adds a button(",Se.element("i",{className:"fa fa-eye"}),") to the panel that allows you to preview your comment before submitting it.")),features:{cfh_p_a:{name:"Automatically preview while typing.",sg:!0,st:!0}},name:"Preview",sg:!0,st:!0},cfh_sr:{description:()=>Se.element("ul",null,Se.element("li",null,"Adds a button(",Se.element("i",{className:"fa fa-floppy-o"})," ) to the panel that allows you to save replies that you frequently use so that you can reuse them later.")),name:"Saved Replies",sg:!0,st:!0,features:{cfh_sr_s:{name:"Use separate storage on SteamTrades.",st:!0}}},cfh_cf:{description:()=>Se.element("ul",null,Se.element("li",null,"Adds a button (",Se.element("i",{className:"fa fa-question-circle"}),") to the panel that links to SteamGifts'"," ",Se.element("a",{href:"https://www.steamgifts.com/about/comment-formatting"},"comment formatting page"),".")),name:"Comment Formatting",sg:!0,st:!0},cfh_ghwsgi:{description:()=>Se.element("ul",null,Se.element("li",null,"Adds a button (",Se.element("i",{className:"fa fa-github"})," ) to the panel that allows you to easily generate links for"," ",Se.element("a",{href:"https://www.steamgifts.com/discussion/fVwFM/github-wiki-steamgifts-integration"},"GitHub Wiki SteamGifts Integration"),".")),name:"GitHub Wiki SteamGifts Integration",sg:!0,st:!0}},id:"cfh",name:"Comment Formatting Helper",sg:!0,st:!0,type:"comments"}}async init(){this.savedRepliesId="savedReplies"+(d.get("cfh_sr_s")?"_st":""),this.esgst.endlessFeatures.push(this.cfh_setTextAreas.bind(this)),this.esgst.cfh={backup:[],history:[],panel:document.createElement("div"),preview:document.createElement("div")},this.esgst.cfh.panel.className="esgst-cfh-panel";let e=[{id:"cfh_i",icons:["fa-italic"],name:"Italic",prefix:"*",suffix:"*"},{id:"cfh_b",icons:["fa-bold"],name:"Bold",prefix:"**",suffix:"**"},{id:"cfh_s",icons:["fa-eye-slash"],name:"Spoiler",prefix:"~",suffix:"~"},{id:"cfh_st",icons:["fa-strikethrough"],name:"Strikethrough",prefix:"~~",suffix:"~~"},{id:"cfh_h1",icons:["fa-header"],name:"Heading 1",prefix:"# ",text:"1"},{id:"cfh_h2",icons:["fa-header"],name:"Heading 2",prefix:"## ",text:"2"},{id:"cfh_h3",icons:["fa-header"],name:"Heading 3",prefix:"### ",text:"3"},{id:"cfh_bq",icons:["fa-quote-left"],name:"Blockquote",prefix:"> "},{id:"cfh_lb",icons:["fa-minus"],name:"Line Break",prefix:"---"},{id:"cfh_ol",icons:["fa-list-ol"],multiline:!0,name:"Ordered List",prefix:"[n]. "},{id:"cfh_ul",icons:["fa-list-ul"],multiline:!0,name:"Unordered List",prefix:"* "},{id:"cfh_ic",icons:["fa-code"],name:"Inline Code",prefix:"`",suffix:"`"},{id:"cfh_lc",icons:["fa-code","fa-indent"],name:"Line Code",prefix:"    "},{id:"cfh_pc",icons:["fa-code","fa-paragraph"],name:"Paragraph Code",prefix:"```\n",suffix:"\n```"},{id:"cfh_l",icons:["fa-globe"],name:"Link",setPopout:e=>{let t,s;Se.insert(e.popout,"atinner",Se.element("fragment",null,Se.element("div",null,"URL:",Se.element("input",{placeholder:"http://www.example.com",type:"text",ref:e=>s=e})),Se.element("div",null,"Title:",Se.element("input",{placeholder:"Cat",type:"text",ref:e=>t=e})),Se.element("div",{className:"form__saving-button btn_action white",onclick:async()=>{await this.cfh_formatLink(t.value,s.value),s.value="",t.value="",e.close()}},"Add")))},callback:e=>{let t,s;s=e.firstElementChild.firstElementChild,t=e.firstElementChild.nextElementSibling.firstElementChild,t.value=this.esgst.cfh.textArea.value.slice(this.esgst.cfh.textArea.selectionStart,this.esgst.cfh.textArea.selectionEnd),s.value&&t.value?e.lastElementChild.click():s.value?t.focus():s.focus()}},{id:"cfh_img",icons:["fa-image"],name:"Image",setPopout:e=>{let t,s;Se.insert(e.popout,"atinner",Se.element("fragment",null,Se.element("div",null,"URL:",Se.element("input",{placeholder:"http://www.example.com/image.jpg",type:"text",ref:e=>s=e}),Se.element("i",{className:"fa fa-upload esgst-clickable",title:"Upload image to Imgur and use it",onclick:async()=>{await ut.contains([["imgur"]])&&c.common.multiChoice("white","fa-user-secret","Anonymously","white","fa-user","Through Account","How would you like to upload?",this.cfh_uploadImage.bind(this,"Client-ID e25283ef48ab9aa",e,s),async()=>{await c.common.delValue("imgurToken"),c.common.openSmallWindow("https://api.imgur.com/oauth2/authorize?client_id=e25283ef48ab9aa&response_type=token&state=imgur"),this.cfh_checkImgur(e,s)})}})),Se.element("div",null,"Title:",Se.element("input",{placeholder:"Cat",type:"text",ref:e=>t=e})),Se.element("div",{className:"form__saving-button btn_action white",onclick:async()=>{await this.cfh_formatLink(t.value,s.value,!0),s.value="",t.value="",e.close()}},"Add")))},callback:e=>{let t,s;s=e.firstElementChild.firstElementChild,t=e.firstElementChild.nextElementSibling.firstElementChild,t.value=this.esgst.cfh.textArea.value.slice(this.esgst.cfh.textArea.selectionStart,this.esgst.cfh.textArea.selectionEnd),s.value&&t.value?e.lastElementChild.click():s.value?t.focus():s.focus()}},{id:"cfh_t",icons:["fa-table"],name:"Table",setPopup:e=>{let t;Se.insert(e.scrollable,"atinner",Se.element("fragment",null,Se.element("table",{ref:e=>t=e}),Se.element("div",{className:"form__saving-button btn_action white",onclick:()=>this.cfh_insertTableRows(1,t)},"Insert Row"),Se.element("div",{className:"form__saving-button btn_action white",onclick:()=>this.cfh_insertTableColumns(1,t)},"Insert Column"),Se.element("div",{className:"form__saving-button btn_action white",onclick:()=>{let s,n,a,i,o,r,l,c;for(r=t.rows,n=1,o=r.length;n<o;++n)for(a=1,i=r[0].cells.length;a<i;++a)r[n].cells[a].firstElementChild.value||(n=o+1,a=i+1);if(n<=o||n>o&&window.confirm("Some cells are empty. This might lead to unexpected results. Are you sure you want to continue?")){for(c="",n=1;n<o;++n)for(c+="\n",a=1;a<i;++a)c+=`${r[n].cells[a].firstElementChild.value}${a<i-1?" | ":""}`;c=c.replace(/^\n/,""),l=this.esgst.cfh.textArea.selectionStart,s=this.esgst.cfh.textArea.selectionEnd,this.esgst.cfh.textArea.value=`${this.esgst.cfh.textArea.value.slice(0,l)}${c}${this.esgst.cfh.textArea.value.slice(s)}`,this.esgst.cfh.textArea.setSelectionRange(s+c.length,s+c.length),this.esgst.cfh.textArea.focus(),e.close()}}},"Add"))),this.cfh_insertTableRows(4,t),this.cfh_insertTableColumns(2,t)}},{id:"cfh_e",icons:["fa-smile-o"],name:"Emojis",setPopout:async e=>{let t,s;Se.insert(e.popout,"atinner",Se.element("fragment",null,Se.element("div",{className:"esgst-cfh-emojis",ref:e=>t=e},await this.cfh_getEmojis()),Se.element("div",{className:"form__saving-button btn_action white",onclick:async()=>{try{let e=window.prompt("Enter the custom emoji:").trim();const s=[];for(let t=0,n=e.length;t<n;t++)s.push(e.codePointAt(t));e=String.fromCodePoint(...s),this.cfh_setEmoji(Se.insert(t,"beforeend",Se.element("span",{"data-draggable-id":e},e))),c.common.draggable_set({addTrash:!0,context:t,id:"emojis",item:{}});const n=[];for(const e of t.children)n.push(e.getAttribute("data-draggable-id"));await c.common.setValue("emojis",JSON.stringify(n))}catch(e){window.alert("Invalid emoji!"),dt.warning(e.message,e.stack)}}},"Add Custom Emoji"),Se.element("div",{className:"form__saving-button btn_action white",onclick:async()=>{if(s)s.open(()=>{e.popout.classList.add("esgst-hidden")});else{let t,n,a,i;s=new lt({icon:"fa-smile-o",title:"Select emojis:",addScrollable:!0}),s.getScrollable(Se.element("fragment",null,Se.element("input",{placeholder:"Filter emojis...",type:"text",ref:e=>a=e}),Se.element("div",{className:"esgst-cfh-emojis"}),Se.element("div",{className:"esgst-description"},"Simply click on an emoji above to add it to your selection. You can re-order emojis in your selection by dragging and dropping them. To remove an emoji from your selection, start dragging it and a trash area will appear, then drop it there."),Se.element("div",{className:"global__image-outer-wrap page_heading_btn esgst-cfh-emojis"}))),n=a.nextElementSibling;const o=n.nextElementSibling.nextElementSibling;Se.insert(o,"atinner",Se.element("fragment",null,await this.cfh_getEmojis()));const r={addTrash:!0,context:o,id:"emojis",item:{}};c.common.draggable_set(r);for(const e of emojisUtils.emojis)Se.insert(n,"beforeend",Se.element("span",{"data-draggable-id":e.emoji,title:`${e.name} (Keyword: :${e.short_name}:)`,onclick:()=>{Se.insert(o,"beforeend",Se.element("span",{"data-draggable-id":e.emoji,title:`${e.name} (Keyword: :${e.short_name}:)`},e.emoji)),c.common.draggable_set(r)}},e.emoji));s.onClose=()=>{const e=[];for(const t of o.children)e.push(t.getAttribute("data-draggable-id"));c.common.setValue("emojis",JSON.stringify(e))},a.addEventListener("input",()=>{if(a.value)for(i=n.children.length-1;i>-1;--i)t=n.children[i],t.getAttribute("title").toLowerCase().match(a.value)?t.classList.remove("esgst-hidden"):t.classList.add("esgst-hidden");else for(i=n.children.length-1;i>-1;--i)n.children[i].classList.remove("esgst-hidden")}),s.open(()=>{e.popout.classList.add("esgst-hidden")})}}},"Select Emojis"))),c.common.draggable_set({addTrash:!0,context:t,id:"emojis",item:{}}),this.cfh_setEmojis(t)},callback:async e=>{let t=e.firstElementChild;Se.insert(t,"atinner",Se.element("fragment",null,await this.cfh_getEmojis())),c.common.draggable_set({addTrash:!0,context:t,id:"emojis",item:{}}),this.cfh_setEmojis(t)}},{id:"cfh_g",icons:["fa-star"],name:"Giveaway Encrypter",setPopout:e=>{let t;Se.insert(e.popout,"atinner",Se.element("fragment",null,"Giveaway Code:",Se.element("input",{placeholder:"XXXXX",type:"text",ref:e=>t=e}),Se.element("div",{className:"form__saving-button btn_action white",onclick:async()=>{if(t.value.match(/^[\d\w]{5}$/)){let s=this.esgst.modules.giveawaysGiveawayEncrypterDecrypter.ged_encryptCode(t.value);await this.cfh_formatLink("","ESGST-"+s),t.value="",e.close()}else window.alert("Wrong format. The right format is XXXXX.")}},"Add")))},callback:e=>{let t=e.firstElementChild;t.value=this.esgst.cfh.textArea.value.slice(this.esgst.cfh.textArea.selectionStart,this.esgst.cfh.textArea.selectionEnd),t.focus()}},{id:"cfh_sr",icons:["fa-floppy-o"],name:"Saved Replies",setPopout:async e=>{let t,s,n,a;for(a=JSON.parse(c.common.getValue(this.savedRepliesId,"[]")),Se.insert(e.popout,"atinner",Se.element("fragment",null,Se.element("div",null,Se.element("input",{placeholder:"Filter replies...",type:"text",oninput:this.cfh_filterReplies.bind(this,n)})),Se.element("div",{className:"esgst-cfh-sr-container",ref:e=>n=e}),Se.element("div",{className:"form__saving-button btn_action white",onclick:this.cfh_openReplyPopup.bind(this,null,null,n,null)},"Add New Reply"),Se.element("div",{className:"form__saving-button btn_action white",onclick:()=>this.cfh_saveReply(null,this.esgst.cfh.textArea.value,null,"Untitled",null,null,n,null)},"Save Reply"))),t=0,s=a.length;t<s;++t)this.cfh_setReply(n,a[t]);this.savedRepliesObj={addTrash:!0,context:n,id:this.savedRepliesId,item:{}},c.common.draggable_set(this.savedRepliesObj)},callback:e=>{e.firstElementChild.firstElementChild.focus()}},{id:"cfh_ghwsgi",icons:["fa-github"],name:"GitHub Wiki SteamGifts Integration",setPopout:e=>{let t;Se.insert(e.popout,"atinner",Se.element("fragment",null,Se.element("div",null,"Wiki URL:",Se.element("input",{placeholder:"https://github.com/username/repository/wiki",type:"text",ref:e=>t=e})),Se.element("div",{className:"form__saving-button btn_action white",onclick:async()=>{const s="wiki-gh/"+t.value.replace(/https?:\/\/(www\.)?github\.com\//,"");await this.cfh_formatItem(`This thread contains a Wiki visible with the [GHWSGI userscript](https://www.steamgifts.com/discussion/fVwFM/). If you prefer to see it directly on GitHub instead, [click here](${t.value}).\n`),await this.cfh_formatLink("",s),t.value="",e.close()}},"Add")))},callback:e=>{e.firstElementChild.firstElementChild.focus()}},{addSpan:!0,icons:["fa-paste"],name:"Automatic Links / Images Paste Formatting: OFF",callback:e=>{this.esgst.cfh.alipf=e,this.cfh_setAlipf(d.get("cfh_pasteFormatting"),!0)},onClick:()=>this.cfh_setAlipf()},{icons:["fa-rotate-left"],name:"Undo Formatting",callback:e=>{this.esgst.cfh.undo=e.firstElementChild,this.esgst.cfh.undo.classList.add("esgst-faded")},onClick:()=>{let e,t;this.esgst.cfh.history.length&&(this.cfh_redo(this.esgst.cfh.textArea,this.esgst.cfh.textArea.value),t=this.esgst.cfh.history.pop(),e=this.esgst.cfh.textArea.selectionEnd-(this.esgst.cfh.textArea.value.length-t.length),this.esgst.cfh.textArea.value=t,this.esgst.cfh.textArea.setSelectionRange(e,e),this.esgst.cfh.history.length||this.esgst.cfh.undo.classList.add("esgst-faded"),this.esgst.cfh.textArea.focus())}},{icons:["fa-rotate-right"],name:"Redo Formatting",callback:e=>{this.esgst.cfh.redo=e.firstElementChild,this.esgst.cfh.redo.classList.add("esgst-faded")},onClick:()=>{let e,t;this.esgst.cfh.backup.length&&(this.cfh_undo(this.esgst.cfh.textArea,this.esgst.cfh.textArea.value),t=this.esgst.cfh.backup.pop(),e=this.esgst.cfh.textArea.selectionEnd+(t.length-this.esgst.cfh.textArea.value.length),this.esgst.cfh.textArea.value=t,this.esgst.cfh.textArea.setSelectionRange(e,e),this.esgst.cfh.backup.length||this.esgst.cfh.redo.classList.add("esgst-faded"),this.esgst.cfh.textArea.focus())}}];for(let t=0,s=e.length;t<s;t++){let s=e[t];if(!s.id||d.get(s.id)){let e;if(Se.insert(this.esgst.cfh.panel,"beforeend",Se.element("div",{title:""+c.common.getFeatureTooltip(s.id||"cfh",s.name),ref:t=>e=t})),s.icons.forEach(t=>{Se.insert(e,"beforeend",Se.element("i",{className:"fa "+t}))}),s.addSpan&&Se.insert(e,"beforeend",Se.element("span",null)),s.text&&e.insertAdjacentText("beforeend",s.text),s.setPopout)await s.setPopout(new mt("esgst-cfh-popout",e,0,!0,null,s.callback));else if(s.setPopup){let t;e.addEventListener("click",()=>{t||(t=new lt({addScrollable:!0,icon:"fa-table",title:"Add a table:"}),s.setPopup(t)),t.open()})}else s.callback&&s.callback(e),e.addEventListener("click",async()=>{s.onClick?s.onClick():await this.cfh_formatItem(s.prefix,s.suffix,s.multiline)})}}d.get("cfh_cf")&&Se.insert(this.esgst.cfh.panel,"beforeend",Se.element("a",{href:"/about/comment-formatting",title:c.common.getFeatureTooltip("cfh_cf","Comment Formatting")},Se.element("i",{className:"fa fa-question-circle"}))),d.get("cfh_p")&&!d.get("cfh_p_a")&&Se.insert(this.esgst.cfh.panel,"beforeend",Se.element("div",{title:c.common.getFeatureTooltip("cfh_p","Preview"),onclick:async()=>{Se.insert(this.esgst.cfh.preview,"atinner",Se.element("fragment",null,await c.common.parseMarkdown(this.esgst.cfh.textArea,this.esgst.cfh.textArea.value))),this.cfh_formatImages(this.esgst.cfh.preview)}},Se.element("i",{className:"fa fa-eye"}))),this.esgst.cfh.preview.className="esgst-cfh-preview markdown"}async cfh_getEmojis(){return JSON.parse(c.common.getValue("emojis","[]")).map(e=>{const t=emojisUtils.emojis.filter(t=>t.emoji===e||emojisUtils.getEntities(t.emoji).join("")===e)[0];return e=t?t.emoji:e,Se.element("span",{"data-draggable-id":e,title:t?`${t.name} (Keyword: :${t.short_name}:)`:""},e)}).filter(e=>null!==e)}cfh_setTextAreas(e,t,s,n){const a=e.querySelectorAll(""+(n?`.esgst-es-page-${n} textarea[name*="description"], .esgst-es-page-${n}textarea[name*="description"]`:'textarea[name*="description"]'));let i=!1;for(const e of a)e.onfocus=this.cfh_addPanel.bind(this,e),i||e.closest(".is-hidden, .is_hidden, .esgst-hidden")||(this.cfh_addPanel(e),i=!0);const o=e.querySelector(".page__description__edit");o&&o.addEventListener("click",this.cfh_addPanel.bind(this,o.closest(".page__description").querySelector("textarea")))}cfh_addPanel(e){if(e===this.esgst.cfh.textArea)return;const t=e.closest(".esgst-popup, .esgst-popout");this.esgst.cfh.panel.style.top=t?"0px":this.esgst.commentsTop+"px",e.parentElement.insertBefore(this.esgst.cfh.panel,e),e.onfocus=this.cfh_addPanel.bind(this,e),e.onpaste=async t=>{if(d.get("cfh_pasteFormatting")){let s,n;s=t.clipboardData.getData("text/plain"),s.match(/^https?:/)&&(t.preventDefault(),n=e.value,this.cfh_undo(e,`${n.slice(0,e.selectionStart)}${s}${n.slice(e.selectionEnd)}`),await this.cfh_formatLink("",s,s.match(/\.(jpg|jpeg|gif|bmp|png)/i),!0))}},e.onclick=()=>c.esgst.cfh.recent=!1,e.onkeydown=e=>{"Backspace"===e.key&&this.esgst.cfh.recent&&(e.preventDefault(),this.esgst.cfh.undo.click()),this.esgst.cfh.recent=!1,e.ctrlKey&&("y"===e.key&&(this.esgst.cfh.backup.length||this.esgst.cfh.history.length)?(e.preventDefault(),this.esgst.cfh.redo.click()):"z"===e.key&&this.esgst.cfh.history.length&&(e.preventDefault(),this.esgst.cfh.undo.click()))},d.get("cfh_p")&&(this.esgst.cfh.preview.innerHTML="",e.parentElement.insertBefore(this.esgst.cfh.preview,e.nextElementSibling),d.get("cfh_p_a")&&(e.oninput=async()=>{Se.insert(this.esgst.cfh.preview,"atinner",Se.element("fragment",null,await c.common.parseMarkdown(e,e.value))),this.cfh_formatImages(this.esgst.cfh.preview)})),this.esgst.cfh.textArea=e}cfh_undo(e,t){this.esgst.cfh.history.push(t),this.esgst.cfh.undo.classList.remove("esgst-faded")}cfh_redo(e,t){this.esgst.cfh.backup.push(t),this.esgst.cfh.redo.classList.remove("esgst-faded")}async cfh_formatItem(e="",t="",s){let n,a,i,o,r,l;l=this.esgst.cfh.textArea.value,this.cfh_undo(this.esgst.cfh.textArea,l),o=this.esgst.cfh.textArea.selectionStart,n=this.esgst.cfh.textArea.selectionEnd,r=l.slice(o,n),i=r.length,s?(a=0,r=r.replace(/^|\n/g,t=>(a+=1,`${t}${e.replace(/\[n]/,a)}`))):r=`${e}${r}${t}`,i+=i>0?o+r.length-i:o+r.length-i-t.length,this.esgst.cfh.textArea.value=`${l.slice(0,o)}${r}${l.slice(n)}`,this.esgst.cfh.textArea.setSelectionRange(i,i),this.esgst.cfh.textArea.focus(),d.get("cfh_p")&&d.get("cfh_p_a")&&(Se.insert(this.esgst.cfh.preview,"atinner",Se.element("fragment",null,await c.common.parseMarkdown(this.esgst.cfh.textArea,this.esgst.cfh.textArea.value))),this.cfh_formatImages(this.esgst.cfh.preview))}async cfh_formatLink(e,t,s,n){let a,i,o;n?this.esgst.cfh.recent=!0:this.cfh_undo(this.esgst.cfh.textArea,this.esgst.cfh.textArea.value),i=this.esgst.cfh.textArea.selectionStart,a=this.esgst.cfh.textArea.selectionEnd,t=t.replace(/\[/g,"%5B").replace(/\]/g,"%5D").replace(/\(/g,"%28").replace(/\)/g,"%29"),o=s?`![${e}](${t})`:`[${e}](${t})`,this.esgst.cfh.textArea.value=`${this.esgst.cfh.textArea.value.slice(0,i)}${o}${this.esgst.cfh.textArea.value.slice(a)}`,e?this.esgst.cfh.textArea.setSelectionRange(a+o.length,a+o.length):this.esgst.cfh.textArea.setSelectionRange(a+o.indexOf("[")+1,a+o.indexOf("[")+1),this.esgst.cfh.textArea.focus(),d.get("cfh_p")&&d.get("cfh_p_a")&&(Se.insert(this.esgst.cfh.preview,"atinner",Se.element("fragment",null,await c.common.parseMarkdown(this.esgst.cfh.textArea,this.esgst.cfh.textArea.value))),this.cfh_formatImages(this.esgst.cfh.preview))}async cfh_checkImgur(e,t){let s=c.common.getValue("imgurToken");s?this.cfh_uploadImage("Bearer "+s,e,t):window.setTimeout(()=>this.cfh_checkImgur(e,t),250)}cfh_uploadImage(e,t,s){let n,a,i;a=new lt({addScrollable:!0,icon:"fa-upload",isTemp:!0,title:"Upload Image"}),Se.insert(a.description,"beforeend",Se.element("input",{type:"file",ref:e=>n=e})),Se.insert(a.description,"beforeend",Se.element("div",{className:"esgst-description esgst-warning",ref:e=>i=e})),tt.create([{color:"green",icons:["fa-upload"],name:"Upload",onClick:()=>new Promise(o=>{let r=n.files[0];if(r)if(r.type.match(/^image/))if(r.size/1024/1024<=10){let n=new FileReader;n.onload=this.cfh_readImgur.bind(this,e,t,a,n,s,i,o),n.readAsDataURL(r)}else c.common.createFadeMessage(i,"Image is larger than 10 MB!"),o();else c.common.createFadeMessage(i,"File is not an image!"),o();else c.common.createFadeMessage(i,"No file was loaded!"),o()})},{template:"loading",isDisabled:!0,name:"Uploading..."}]).insert(a.description,"beforeend"),d.get("cfh_img_remember")&&tt.create([{color:"white",icons:["fa-rotate-left"],name:"Reset",onClick:async()=>{await c.common.setSetting("cfh_img_remember",!1),a.close()}},{template:"loading",isDisabled:!0,name:"Resetting..."}]).insert(a.description,"beforeend"),a.open()}async cfh_readImgur(e,t,s,n,a,i,o){let r=(await Ne.post("https://api.imgur.com/3/image",{data:"image="+encodeURIComponent(n.result.match(/base64,(.+)/)[1]),headers:{authorization:e}})).json;r.success?(o(),s.close(),a.value=r.data.link,t.open()):(c.common.createFadeMessage(i,"Could not upload image!"),o())}cfh_insertTableRows(e,t){let s,n,a,i,o;for(;e>0;){for(i=t.rows.length,o=t.insertRow(i),n=0,a=t.rows[0].cells.length-1;n<a;++n)Se.insert(o.insertCell(0),"atinner",Se.element("input",{placeholder:"Value",type:"text"}));s=o.insertCell(0),i>2&&Se.insert(s,"atinner",Se.element("a",null,Se.element("i",{className:"fa fa-times-circle",title:"Delete row",onclick:()=>{t.rows.length>4?(s.remove(),o.remove()):window.alert("A table must have a least one row and two columns.")}}))),--e}}cfh_insertTableColumns(e,t){let s,n,a,i,o;for(;e>0;){for(o=t.rows,i=o[0].cells.length,n=3,a=o.length;n<a;++n)Se.insert(o[n].insertCell(i),"atinner",Se.element("input",{placeholder:"Value",type:"text"}));Se.insert(o[2].insertCell(i),"atinner",Se.element("select",null,Se.element("option",{value:":-"},"Left"),Se.element("option",{value:":-:"},"Center"),Se.element("option",{value:"-:"},"Right"))),s=o[1].insertCell(i),Se.insert(s,"atinner",Se.element("input",{placeholder:"Header",type:"text"})),Se.insert(o[0].insertCell(i),"atinner",Se.element("a",null,Se.element("i",{className:"fa fa-times-circle",title:"Delete column",onclick:()=>{if(o=t.rows,i=o[1].cells.length,i>3){do{--i}while(o[1].cells[i]!==s);for(n=0,a=o.length;n<a;++n)o[n].deleteCell(i)}else window.alert("A table must have at least one row and two columns.")}}))),--e}}cfh_setEmojis(e){let t,s;for(s=e.children.length-1;s>-1;--s)t=e.children[s],this.cfh_setEmoji(t)}cfh_setEmoji(e){e.addEventListener("click",this.cfh_formatItem.bind(this,e.textContent,""))}cfh_setReply(e,t){let s,n,a,i;Se.insert(e,"beforeend",Se.element("div",{className:"esgst-cfh-sr-box","data-draggable-id":`${t.name}${t.description}`,"data-draggable-obj":JSON.stringify(t),ref:e=>a=e},Se.element("div",{className:"esgst-cfh-sr-summary",ref:e=>i=e,onclick:()=>{let e,s,n,a,i;this.cfh_undo(this.esgst.cfh.textArea,this.esgst.cfh.textArea.value),e=this.esgst.cfh.textArea.selectionEnd,i=t.description,n=i.match(/\[ESGST-R][\s\S]+?\[\/ESGST-R]/g),n&&(a=n.length,s=Math.floor(Math.random()*a),i=n[s].match(/\[ESGST-R]([\s\S]+?)\[\/ESGST-R]/)[1]),this.esgst.cfh.textArea.value=`${this.esgst.cfh.textArea.value.slice(0,this.esgst.cfh.textArea.selectionStart)}${i}${this.esgst.cfh.textArea.value.slice(e)}`,this.esgst.cfh.textArea.dispatchEvent(new Event("input")),this.esgst.cfh.textArea.setSelectionRange(e+i.length,e+i.length),this.esgst.cfh.textArea.focus()}},Se.element("div",{className:"esgst-cfh-sr-name",ref:e=>n=e},t.name),Se.element("div",{className:"esgst-cfh-sr-description",ref:e=>s=e},t.description)),Se.element("div",{className:"esgst-cfh-sr-controls"},Se.element("i",{className:"esgst-clickable fa fa-retweet",title:"Replace description with current reply",onclick:()=>this.cfh_saveReply(a,t.description,this.esgst.cfh.textArea,t.name,null,null,e,i)}),Se.element("i",{className:"esgst-clickable fa fa-edit",title:"Edit reply",onclick:this.cfh_openReplyPopup.bind(this,t.description,t.name,e,i)}),Se.element("i",{className:"fa fa-question-circle",title:"Drag the reply to move / delete it"}))))}cfh_openReplyPopup(e,t,s,n){let a,i,o,r;r=new lt({addScrollable:!0,icon:"fa-floppy-o",isTemp:!0,title:n?"Edit reply:":"Save new reply:"}),Se.insert(r.scrollable,"beforeend",Se.element("div",{className:"esgst-description"},"You can save a defined list of replies to be picked at random when using it. To do so, enclose each option with ",Se.element("span",{className:"esgst-bold"},"[ESGST-R][/ESGST-R]"),'. For example, a defined list that renders a random "thank you" comment when using it would look like this:',Se.element("br",null),Se.element("br",null),"[ESGST-R]Thanks![/ESGST-R]",Se.element("br",null),"[ESGST-R]Thank you![/ESGST-R]",Se.element("br",null),"[ESGST-R]Thank you so much!",Se.element("br",null),Se.element("br",null),"Can't wait to play this game![/ESGST-R]")),Se.insert(r.scrollable,"beforeend",Se.element("div",{ref:e=>o=e},Se.element("div",null,Se.element("div",null,"Name"),Se.element("input",{type:"text",value:t||""})),Se.element("div",null,Se.element("div",null,"Description"),Se.element("textarea",null,e||"")))),i=o.firstElementChild,a=i.nextElementSibling,i=i.lastElementChild,a=a.lastElementChild,d.get("cfh")&&this.cfh_addPanel(a),tt.create([{template:"success",name:"Save",onClick:()=>this.cfh_saveReply(null,e,a,t,i,r,s,n)},{template:"loading",isDisabled:!0,name:"Saving..."}]).insert(r.description,"beforeend"),r.open()}async cfh_saveReply(e,t,s,n,a,i,o,r){let[l,d]=[s?s.value.trim():t,a?a.value.trim():n];if(l&&d){let s=JSON.parse(c.common.getValue(this.savedRepliesId,"[]")),a={description:l,name:d};if(r){let i;for(i=s.length-1;i>-1&&(s[i].name!==n||s[i].description!==t);i--);i>-1&&(s[i]=a,r.firstElementChild.textContent=d,r.lastElementChild.textContent=l),e.setAttribute("data-draggable-obj",JSON.stringify(a))}else s.push(a),this.cfh_setReply(o,a),c.common.draggable_set(this.savedRepliesObj);await c.common.setValue(this.savedRepliesId,JSON.stringify(s)),i&&i.close()}else i&&c.common.createAlert("Both fields are required.")}cfh_filterReplies(e,t){let s,n,a;for(a=t.currentTarget.value,s=e.children.length-1;s>-1;--s)n=e.children[s],n.textContent.toLowerCase().match(a.toLowerCase())?n.classList.remove("esgst-hidden"):n.classList.add("esgst-hidden")}cfh_setAlipf(e,t){void 0===e&&(e=!d.get("cfh_pasteFormatting")),t||c.common.setSetting("cfh_pasteFormatting",e),e?(this.esgst.cfh.alipf.title=c.common.getFeatureTooltip("cfh","Automatic Links / Images Paste Formatting: ON"),this.esgst.cfh.alipf.classList.remove("esgst-faded"),this.esgst.cfh.alipf.lastElementChild.textContent="ON"):(this.esgst.cfh.alipf.title=c.common.getFeatureTooltip("cfh","Automatic Links / Images Paste Formatting: OFF"),this.esgst.cfh.alipf.classList.add("esgst-faded"),this.esgst.cfh.alipf.lastElementChild.textContent="OFF"),this.esgst.cfh.textArea&&this.esgst.cfh.textArea.focus()}cfh_formatImages(e){let t,s,n;for(s=e.getElementsByTagName("img"),t=0,n=s.length;t<n;++t){const t=s[0];e.appendChild(t),t.classList.add("is-hidden","is_hidden"),Se.insert(t,"atouter",Se.element("div",null,Se.element("div",{className:""+(this.esgst.sg?"comment__toggle-attached":"view_attached")},"View attached image."),Se.element("a",{href:t.getAttribute("src"),rel:"nofollow noreferrer",target:"_blank"},t.cloneNode(!0))))}}};const qo=new class extends gt{constructor(){super(),this.info={description:()=>Se.element("ul",null,Se.element("li",null,"Replaces certain variables with values when submitting a comment.")),id:"cv",name:"Comment Variables",sg:!0,st:!0,type:"comments",features:{cv_e:{description:()=>Se.element("ul",null,Se.element("li",null,"Allows you to enter keywords that are replaced by emojis. To see the keywords, open the emojis popup with ",Se.element("span",{"data-esgst-feature-id":"cfh_e"})," and hover over the emojis."),Se.element("li",null,"Since the keyword format is ",Se.element("code",null,":short_name:"),", if you want to use that format without replacing it with an emoji, simply escape it with a backslash e.g."," ",Se.element("code",null,"\\:short_name:"),".")),name:"Enable emojis.",dependencies:["cfh","cfh_e"],sg:!0,st:!0}},inputItems:[{id:"cv_username",prefix:"Your username: "},{id:"cv_steamId",prefix:"Your Steam id: "},{id:"cv_creator",prefix:"The creator of the giveaway/thread: "},{id:"cv_replyUser",prefix:"The user you are replying to: "},{id:"cv_esgstFeature",prefix:"Link a ESGST feature (must have a (.+?) field to represent where you will type either the ID of the feature or a term to search for the feature): "}]}}init(){c.esgst.replyBox&&c.common.addReplyButton(c.esgst.replyBox),Ee.subscribe(ze,this.replaceVariables.bind(this)),this.usernameRegex=this.getRegExp("username"),this.steamIdRegex=this.getRegExp("steamId"),this.creatorRegex=this.getRegExp("creator"),this.replyUserRegex=this.getRegExp("replyUser"),this.featureRegex=this.getRegExp("esgstFeature"),this.localFeatureRegex=this.getRegExp("esgstFeature",!0),this.emojiRegex=/(^|[^\\])(:\w+?:)/g,this.escapedEmojiRegex=/\\(:\w+?:)/g}replaceVariables(e){e.comment=e.comment.replace(this.usernameRegex,d.get("username")).replace(this.steamIdRegex,d.get("steamId"));const t=document.querySelector(".featured__column--width-fill.text-right a, .comment__username, .author_name");if(t){const s=t.textContent;e.comment=e.comment.replace(this.creatorRegex,s)}if(e.context){let t=e.context.closest(".comment__children, .comment_children");t=t&&t.closest(".comment, .comment_outer").querySelector(".comment__username, .author_name")||document.querySelector(".featured__column--width-fill.text-right a, .comment__username, .author_name"),t&&(t=t.textContent,e.comment=e.comment.replace(this.replyUserRegex,t))}const s=e.comment.match(this.featureRegex);if(s)for(const t of s){const s=t.match(this.localFeatureRegex);if(s){const n=s[1];let a=c.esgst.featuresById[n];if(a||(a=c.common.findFeature(n)),a){let s=`[${a.name}](https://www.steamgifts.com/account/settings/profile?esgst=settings&id=${a.id})`,n=c.esgst.featuresAncestors[a.id];for(;n;){const e=c.esgst.featuresById[n];s=`[${e.name}](https://www.steamgifts.com/account/settings/profile?esgst=settings&id=${e.id}) > ${s}`,n=c.esgst.featuresAncestors[n]}e.comment=e.comment.replace(t,s)}}}d.get("cv_e")&&(e.comment=e.comment.replace(this.emojiRegex,(...e)=>{const t=emojisUtils.getEmoji(e[2].slice(1,-1));return t?`${e[1]}${t}`:`${e[1]}\\${e[2]}`}).replace(this.escapedEmojiRegex,"$1"))}getRegExp(e,t){return new RegExp(d.get("cv_"+e),t?"i":"gi")}},Ro=hs.createElements.bind(hs),Mo=hs.delValue.bind(hs),Oo=hs.getValue.bind(hs),Uo=hs.setValue.bind(hs);const Fo=new class extends gt{constructor(){super(),this.info={description:()=>Se.element("ul",null,Se.element("li",null,'Adds a "Real CV" row containing how much real CV you should get for a giveaway to the table of the review giveaway page (the page where you can confirm the creation of a giveaway).')),id:"rcvc",name:"Real CV Calculator",sg:!0,sync:"Giveaways, No CV Games, Reduced CV Games",syncKeys:["Giveaways","NoCvGames","ReducedCvGames"],type:"giveaways"}}async init(){if(this.esgst.newGiveawayPath){if(!await ut.contains([["steamStore"]]))return;let e,t=document.getElementsByClassName("table--summary")[0];if(t){let s=Oo("rcvcGame");if(s){let n,a,i=s.type,o=s.id,r=document.getElementsByClassName("featured__heading__small"),l=r.length>1?parseInt(r[0].textContent.match(/\d+/)[0]):1;try{let e,s,r=(await Ne.get(`http://store.steampowered.com/api/${"apps"===i?"appdetails?appids":"packagedetails?packageids"}=${o}&cc=us&filters=price,price_overview`)).json[o].data,c=Math.ceil((r.price_overview||r.price).initial/100);e=JSON.parse(Oo("games")),e[i][o]&&(e[i][o].noCV?c=0:e[i][o].reducedCV&&(c*=.15)),s={Username:d.get("username"),SteamID64:d.get("steamId")};let g,u=JSON.parse(Oo("users")).users[s.SteamID64],m=0,h=Date.now();if(u&&u.giveaways&&u.giveaways.sent&&u.giveaways.sent[i][o]){let e=u.giveaways.sent[i][o];for(n=0,a=e.length;n<a;++n){let t=this.esgst.giveaways[e[n]];t&&(t.entries>=5||!t.inviteOnly&&!t.group&&!t.whitelist?Array.isArray(t.winners)?t.winners.length>0?t.winners.forEach(e=>{"Received"===e.status&&(m+=1)}):h<t.endTime&&(m+=t.copies):t.winners>0&&(m+=Math.min(t.entries,t.winners)):h<t.endTime&&(m+=t.copies))}if(m>5)for(n=0,a=m-5;n<a;++n)c*=.9}if(l>1){let e=l+m;if(e>5)for(a=e-5,g=(l-a)*c,n=0;n<a;++n)c*=.9,g+=c;else g=c*l}else g=m+1>5?.9*c:c;g=Math.round(100*g)/100,Ro(t,"beforeend",[{attributes:{class:"table__row-outer-wrap"},type:"div",children:[{attributes:{class:"table__row-inner-wrap"},type:"div",children:[{attributes:{class:"table__column--width-medium table__column--align-top"},type:"div",children:[{attributes:{class:"esgst-bold"},text:"Real CV",type:"span"}]},{attributes:{class:"table__column--width-fill"},text:`You should get ~$${g} real CV for this giveaway.`,type:"div"}]}]}])}catch(e){dt.warning(e.message,e.stack)}e=document.getElementsByClassName("js__submit-form")[0],e.addEventListener("click",()=>{Mo("rcvcGame")})}}else{e=document.querySelector(".js__submit-form, [data-esgst=reviewButton]");let t=document.querySelector('[name="game_id"]');e.addEventListener("click",async()=>{let e=t.value,s=document.querySelector(`[data-autocomplete-id="${e}"]`),n=await this.esgst.modules.games.games_getInfo(s);Uo("rcvcGame",{type:n.type,id:n.id})})}}}},$o=hs.getValue.bind(hs),Wo=hs.setValue.bind(hs);const Vo=new class extends gt{constructor(){super(),this.info={description:()=>Se.element("ul",null,Se.element("li",null,"Adds a button (",Se.element("i",{className:"fa fa-thumb-tack"})," if the country is stickied and"," ",Se.element("i",{className:"fa fa-thumb-tack esgst-faded"})," if it is not) next to each country in the ",Se.element("a",{href:"https://www.steamgifts.com/giveaways/new"},"new giveaway")," page that allows you to sticky the country so that it appears at the top of the country list when creating a giveaway for quick use.")),id:"sgac",name:"Stickied Giveaway Countries",sg:!0,type:"giveaways"}}init(){if(!this.esgst.newGiveawayPath)return;let e,t,s,n,a,i,o;if(!document.getElementsByClassName("form__rows")[0])return;o=JSON.parse(c.common.getValue("stickiedCountries","[]")),e=document.querySelector('.form_list[data-input="country_item_string"]'),s=e.children;const r={separator:e.firstElementChild};for(n=0,i=s.length;n<i;++n)t=s[n],a=t.getAttribute("data-item-id"),o.indexOf(a)>=0&&(t===r.separator&&(r.separator=r.separator.nextElementSibling),e.insertBefore(t,r.separator)),new Us(t,"afterbegin",{callbacks:[this.sgac_stickyCountry.bind(this,r,e,t,a),null,this.sgac_unstickyCountry.bind(this,r,e,t,a),null],className:"esgst-sgac-button",icons:["fa-thumb-tack esgst-clickable esgst-faded","fa-circle-o-notch fa-spin","fa-thumb-tack esgst-clickable","fa-circle-o-notch fa-spin"],id:"sgac",index:o.indexOf(a)>=0?2:0,titles:["Sticky country","Stickying...","Unsticky country","Unstickying..."]})}async sgac_stickyCountry(e,t,s,n,a){a.stopPropagation(),t&&(s===e.separator&&(e.separator=e.separator.nextElementSibling),t.insertBefore(s,e.separator));let i=JSON.parse($o("stickiedCountries","[]"));return i.indexOf(n)<0&&(i.push(n),await Wo("stickiedCountries",JSON.stringify(i))),!0}async sgac_unstickyCountry(e,t,s,n,a){a.stopPropagation(),t&&(t.insertBefore(s,e.separator),e.separator=e.separator.previousElementSibling);let i=JSON.parse($o("stickiedCountries","[]")),o=i.indexOf(n);return o>=0&&(i.splice(o,1),await Wo("stickiedCountries",JSON.stringify(i))),!0}};const jo=new class extends gt{constructor(){super(),this.info={description:()=>Se.element("ul",null,Se.element("li",null,"Allows you to perform many different tasks by pressing certain keys.")),features:{sk_cp:{inputItems:"sk_closePopups",name:"Close all currently opened popups.",sg:!0,st:!0},sk_sb:{inputItems:"sk_searchBox",name:"Focus on the search box.",sg:!0,st:!0},sk_fp:{inputItems:"sk_firstPage",name:"Go to the first page.",sg:!0,st:!0},sk_pp:{inputItems:"sk_previousPage",name:"Go to the previous page.",sg:!0,st:!0},sk_np:{inputItems:"sk_nextPage",name:"Go to the next page.",sg:!0,st:!0},sk_lp:{inputItems:"sk_lastPage",name:"Go to the last page.",sg:!0,st:!0},sk_tf:{inputItems:"sk_toggleFilters",name:"Toggle the giveaway filters.",sg:!0},sk_hg:{inputItems:"sk_hideGame",name:"Hide the game when inside of a giveaway.",sg:!0},sk_hga:{inputItems:"sk_hideGiveaway",name:"Hide the giveaway when inside of a giveaway.",sg:!0},sk_ge:{inputItems:"sk_giveawayEntry",name:"Enter/leave the giveaway when inside of a giveaway.",sg:!0},sk_c:{inputItems:"sk_creator",name:"Insert the username of the creator of the giveaway/discussion/trade to the current reply box.",sg:!0,st:!0},sk_rb:{inputItems:"sk_replyBox",name:"Focus on the reply box.",sg:!0,st:!0},sk_ru:{inputItems:"sk_replyUser",name:"Insert the username of the user to whom you are replying to the current reply box.",sg:!0,st:!0},sk_sr:{inputItems:"sk_submitReply",name:"Submit the current reply.",sg:!0,st:!0}},id:"sk",name:"Shortcut Keys",sg:!0,st:!0,type:"general"}}init(){let e={};d.get("sk_cp")&&(e[d.get("sk_closePopups")]=e=>{if(!e.target.tagName.match(/^(INPUT|TEXTAREA)$/)){let t,s=document.querySelectorAll(".b-close, .esgst-popup-close, .lightbox_header_icon--close");for(t=s.length-1;t>-1;--t)s[t].click();e.preventDefault()}}),d.get("sk_sb")&&(e[d.get("sk_searchBox")]=e=>{if(!e.target.tagName.match(/^(INPUT|TEXTAREA)$/)){let t=document.getElementsByClassName("sidebar__search-input")[0];t&&(t.focus(),e.preventDefault())}}),d.get("sk_fp")&&(e[d.get("sk_firstPage")]=e=>{!e.target.tagName.match(/^(INPUT|TEXTAREA)$/)&&this.esgst.paginationNavigation&&this.esgst.currentPage>1&&(window.location.href=this.esgst.searchUrl+"1",e.preventDefault())}),d.get("sk_pp")&&(e[d.get("sk_previousPage")]=e=>{!e.target.tagName.match(/^(INPUT|TEXTAREA)$/)&&this.esgst.paginationNavigation&&this.esgst.currentPage>1&&(window.location.href=`${this.esgst.searchUrl}${this.esgst.currentPage-1}`,e.preventDefault())}),d.get("sk_np")&&(e[d.get("sk_nextPage")]=e=>{!e.target.tagName.match(/^(INPUT|TEXTAREA)$/)&&this.esgst.paginationNavigation&&this.esgst.currentPage<this.esgst.lastPage&&(window.location.href=`${this.esgst.searchUrl}${this.esgst.currentPage+1}`,e.preventDefault())}),d.get("sk_lp")&&(e[d.get("sk_lastPage")]=e=>{!e.target.tagName.match(/^(INPUT|TEXTAREA)$/)&&this.esgst.paginationNavigation&&this.esgst.currentPage<this.esgst.lastPage&&999999999!==this.esgst.lastPage&&(window.location.href=`${this.esgst.searchUrl}${this.esgst.lastPage}`,e.preventDefault())}),d.get("sk_tf")&&(e[d.get("sk_toggleFilters")]=e=>{if(!e.target.tagName.match(/^(INPUT|TEXTAREA)$/)){let t=document.querySelector(".esgst-gf-toggle-switch");t&&(t.click(),e.preventDefault())}}),d.get("sk_hg")&&(e[d.get("sk_hideGame")]=e=>{if(!e.target.tagName.match(/^(INPUT|TEXTAREA)$/)&&this.esgst.giveawayPath){let t=document.getElementsByClassName("popup--hide-games")[0].style.display&&"none"!==document.getElementsByClassName("popup--hide-games")[0].style.display&&document.getElementsByClassName("js__submit-hide-games")[0]||document.querySelector(".esgst-ochgb, .giveaway__hide, .featured__giveaway__hide");t&&((t.classList.contains("esgst-ochgb")?t.firstElementChild:t).click(),e.preventDefault())}}),d.get("sk_hga")&&(e[d.get("sk_hideGiveaway")]=e=>{if(!e.target.tagName.match(/^(INPUT|TEXTAREA)$/)&&this.esgst.giveawayPath){let t=document.querySelector(".esgst-gf-hide-button, .esgst-gf-unhide-button");t&&(t.firstElementChild.dispatchEvent(new Event("click")),e.preventDefault())}}),d.get("sk_ge")&&(e[d.get("sk_giveawayEntry")]=e=>{!e.target.tagName.match(/^(INPUT|TEXTAREA)$/)&&this.esgst.enterGiveawayButton&&(this.esgst.enterGiveawayButton.classList.contains("is-hidden")?this.esgst.leaveGiveawayButton.click():this.esgst.enterGiveawayButton.click(),e.preventDefault())}),d.get("sk_c")&&(e[d.get("sk_creator")]=e=>{if(e.target.tagName.match(/^(INPUT|TEXTAREA)$/)){let t=e.target.value,s=e.target.selectionEnd;const n=document.querySelector(".featured__column--width-fill.text-right a, .comment__username, .author_name");if(n){const a=n.textContent;let i=s+a.length;e.target.value=`${t.slice(0,e.target.selectionStart)}${a}${t.slice(s)}`,e.target.setSelectionRange(i,i),e.target.focus(),e.preventDefault()}}}),d.get("sk_rb")&&(e[d.get("sk_replyBox")]=e=>{!e.target.tagName.match(/^(INPUT|TEXTAREA)$/)&&this.esgst.replyBox&&(this.esgst.replyBox.getElementsByTagName("textarea")[0].focus(),e.preventDefault())}),d.get("sk_ru")&&(e[d.get("sk_replyUser")]=e=>{if("TEXTAREA"===e.target.tagName){let t=e.target.value,s=e.target.selectionEnd,n=e.target.closest(".comment__children, .comment_children");if(n=n&&n.closest(".comment, .comment_outer").querySelector(".comment__username, .author_name")||document.querySelector(".featured__column--width-fill.text-right a, .comment__username, .author_name"),n){n=n.textContent;let a=s+n.length;e.target.value=`${t.slice(0,e.target.selectionStart)}${n}${t.slice(s)}`,e.target.setSelectionRange(a,a),e.target.focus(),e.preventDefault()}}}),d.get("sk_sr")&&(e[d.get("sk_submitReply")]=e=>{if("TEXTAREA"===e.target.tagName){let t=e.target.closest(".comment, .reply_form, .esgst-popup");if(t){let s=t.querySelector(".esgst-button, .js__submit-form, .js_submit");s&&(s.click(),e.preventDefault())}}}),Object.keys(e).length>0&&this.esgst.documentEvents.keydown.add(t=>{let s="";t.ctrlKey?s+="ctrlKey + ":t.shiftKey?s+="shiftKey + ":t.altKey&&(s+="altKey + "),s+=t.key.toLowerCase(),e[s]&&(t.stopPropagation(),e[s](t))})}},Ho=hs.createElements.bind(hs),Jo=hs.createHeadingButton.bind(hs),Yo=hs.downloadFile.bind(hs),Ko=hs.observeChange.bind(hs),zo=hs.observeNumChange.bind(hs);const Qo=new class extends gt{constructor(){super(),this.info={description:()=>Se.element("ul",null,Se.element("li",null,"Adds a button (",Se.element("i",{className:"fa fa-key"})," ",Se.element("i",{className:"fa fa-search"}),") to the main page heading of your"," ",Se.element("a",{href:"https://www.steamgifts.com/giveaways/created"},"created")," page that allows you to search for a key or a set of keys in all of keys that you have ever sent."),Se.element("li",null,"There is also an option to export all of the keys that you have ever sent to a text file.")),id:"sks",name:"Sent Key Searcher",sg:!0,type:"giveaways"}}init(){if(!this.esgst.createdPath)return;let e=Jo({id:"sks",icons:["fa-key","fa-search"],title:"Search keys"});e.addEventListener("click",this.sks_openPopup.bind(this,{button:e}))}sks_openPopup(e){if(e.popup)return void e.popup.open();e.popup=new lt({addScrollable:!0,icon:"fa-key",title:"Search for keys:"}),e.textArea=Ho(e.popup.scrollable,"beforeend",[{attributes:{class:"esgst-description"},text:"Insert the keys below, one per line.",type:"div"},{type:"textarea"}]),new vt(e.popup.description,"sks_exportKeys",!1,"Export all keys ever sent.",!1,!1,"This will search all your giveaways and export a file with all keys ever sent. You don't need to enter any keys if this option is enabled.",d.get("sks_exportKeys"));let t=new vt(e.popup.description,"sks_searchCurrent",!1,"Only search the current page.",!1,!1,null,d.get("sks_searchCurrent")),s=new vt(e.popup.description,"sks_limitDate",!1,Se.element("fragment",null,"Limit search by date, from"," ",Se.element("input",{className:"esgst-switch-input esgst-switch-input-large",type:"date",value:d.get("sks_minDate")})," to ",Se.element("input",{className:"esgst-switch-input esgst-switch-input-large",type:"date",value:d.get("sks_maxDate")}),"."),!1,!1,null,d.get("sks_limitDate")).name.firstElementChild,n=s.nextElementSibling,a=new vt(e.popup.description,"sks_limitPages",!1,Se.element("fragment",null,"Limit search by pages, from"," ",Se.element("input",{className:"esgst-switch-input",min:"1",type:"number",value:d.get("sks_minPage")})," to ",Se.element("input",{className:"esgst-switch-input",min:"1",type:"number",value:d.get("sks_maxPage")}),"."),!1,!1,null,d.get("sks_limitPages")),i=a.name.firstElementChild,o=i.nextElementSibling;t.exclusions.push(a.container),a.exclusions.push(t.container),d.get("sks_searchCurrent")?a.container.classList.add("esgst-hidden"):d.get("sks_limitPages")&&t.container.classList.add("esgst-hidden"),Ko(s,"sks_minDate",!0),Ko(n,"sks_maxDate",!0),zo(i,"sks_minPage",!0),zo(o,"sks_maxPage",!0),e.results=Ho(e.popup.scrollable,"beforeend",[{type:"div"}]),tt.create([{color:"green",icons:["fa-search"],name:"Search",onClick:this.sks_searchGiveaways.bind(this,e)},{template:"error",name:"Cancel",switchTo:{onReturn:0},onClick:this.sks_cancelSearch.bind(this,e)}]).insert(e.popup.description,"beforeend"),e.progressBar=at.create().insert(e.popup.description,"beforeend").hide(),e.overallProgressBar=at.create().insert(e.popup.description,"beforeend").hide(),e.popup.open()}async sks_searchGiveaways(e){e.button.classList.add("esgst-busy"),e.canceled=!1,e.count=0,e.giveaways={},e.allKeys=[],e.keys=[],e.progressBar.setLoading(null).show(),e.overallProgressBar.reset().show(),e.results.innerHTML="";let t=e.textArea.value.trim().split(/\n/),s=t.length;if(!d.get("sks_exportKeys")&&s<1)return;for(let n=0;n<s;n++){let s=t[n].trim();s&&(e.keys.push(s),e.count+=1)}e.textArea.value=e.keys.join("\n");let[n,a]=d.get("sks_limitPages")?[d.get("sks_minPage"),d.get("sks_maxPage")+1]:d.get("sks_searchCurrent")?[this.esgst.currentPage,this.esgst.currentPage+1]:[this.esgst.currentPage,null],[i,o]=d.get("sks_limitDate")?[new Date(d.get("sks_minDate")).getTime()-1,new Date(d.get("sks_maxDate")).getTime()+1]:[null,null],r=null,l=!1,c=!1;do{let t=null;if(l=!1,n===this.esgst.currentPage)t=document,e.lastPage=this.esgst.modules.generalLastPageLink.lpl_getLastPage(t,!0),e.lastPage=a?" of "+(a-1):999999999===e.lastPage?"":" of "+e.lastPage;else{if(document.getElementsByClassName("esgst-es-page-"+n)[0]){l=!0;continue}t=(await Ne.get("/giveaways/created/search?page="+n)).html,e.lastPage||(e.lastPage=this.esgst.modules.generalLastPageLink.lpl_getLastPage(t),e.lastPage=a?" of "+(a-1):999999999===e.lastPage?"":" of "+e.lastPage)}e.overallProgressBar.setMessage(`Page ${n}${e.lastPage} (${e.count} keys left)`);let s=t.getElementsByClassName("trigger-popup--keys");for(let t=0,n=s.length;!e.canceled&&t<n;t++){e.progressBar.setMessage(`Retrieving keys (${t+1} of ${n})...`);let a=s[t],r=1e3*parseInt(a.closest(".table__row-inner-wrap").querySelector("[data-timestamp]").getAttribute("data-timestamp"));if(i&&o){if(r>o){l=!0;continue}if(r<i){c=!0;continue}}let g={active:Date.now()<r,code:a.parentElement.querySelector("[name=code]").value,name:a.getAttribute("data-name")},u=Se.parse((await Ne.post("/ajax.php",{data:`xsrf_token=${Be.xsrfToken}&do=popup_keys&code=${g.code}`})).json.html).getElementsByClassName("popup__keys__heading")[0];if(!u||"Assigned"!==u.textContent&&!g.active)continue;let m=u.nextElementSibling.nextElementSibling.children;for(let t=m.length-1;!e.canceled&&t>-1;t--){let s=m[t].textContent;e.keys.indexOf(s)>-1&&(e.giveaways[s]=g,e.count-=1),d.get("sks_exportKeys")&&e.allKeys.push(`${g.active?"UNASSIGNED ":"ASSIGNED"},"${s.replace(/"/g,'""')}","${g.name.replace(/"/g,'""')}",https://www.steamgifts.com/giveaway/${g.code}/`)}}n+=1,r=e.count>0||d.get("sks_exportKeys")?t.getElementsByClassName("pagination__navigation")[0]:null}while(!e.canceled&&!c&&(!a||n<a)&&(l||r&&!r.lastElementChild.classList.contains("is-selected")));if(e.canceled)return;let g=[],u=[];for(let t=0,s=e.keys.length;t<s;t++){let s=e.keys[t],n=e.giveaways[s];n?g.push({type:"li",children:[{text:`${n.active?"[UNASSIGNED] ":""}${s} (`,type:"node"},{attributes:{href:`/giveaway/${n.code}/`},text:n.name,type:"a"},{text:")",type:"node"}]}):u.push({text:s,type:"li"})}const m=[{array:g,name:"Found"},{array:u,name:"Did not find"}];for(const t of m){let s=t.array.length;s<1||Ho(e.results,"beforeend",[{attributes:{class:"markdown"},type:"div",children:[{type:"div",children:[{attributes:{class:"esgst-bold"},text:`${t.name} ${s} keys:`,type:"span"}]},{type:"ul",children:t.array}]}])}d.get("sks_exportKeys")&&Yo(e.allKeys.join("\r\n"),`esgst_sks_keys_${(new Date).toISOString()}.csv`),e.progressBar.reset().hide(),e.count>0?e.overallProgressBar.setWarning(e.count+" keys were not found."):e.overallProgressBar.setSuccess("All keys were found!"),e.button.classList.remove("esgst-busy")}sks_cancelSearch(e){e.canceled=!0,e.button.classList.remove("esgst-busy"),e.progressBar.reset().hide()}},Zo=hs.animateScroll.bind(hs),Xo=hs.createElements.bind(hs),er=hs.createHeadingButton.bind(hs),tr=hs.getFeatureTooltip.bind(hs);const sr=new class extends gt{constructor(){super(),this.info={description:()=>Se.element("ul",null,Se.element("li",null,"Adds a button (",Se.element("i",{className:"fa fa-chevron-down"}),") either to the bottom right corner, the main page heading or the footer (you can decide where) of any page that takes you to the bottom of the page.")),id:"stbb",name:"Scroll To Bottom Button",options:{title:"Show in:",values:["Bottom Right Corner","Main Page Heading","Footer"]},sg:!0,st:!0,type:"general"}}init(){let e;switch(d.get("stbb_index")){case 0:e=Xo(document.body,"beforeend",[{attributes:{class:"esgst-stbb-button esgst-stbb-button-fixed",title:""+tr("stbb","Scroll to bottom")},type:"div",children:[{attributes:{class:"fa fa-chevron-down"},type:"i"}]}]),window.addEventListener("scroll",()=>{document.documentElement.offsetHeight-window.innerHeight>=window.scrollY+100?e.classList.remove("esgst-hidden"):e.classList.add("esgst-hidden")});break;case 1:e=er({id:"stbb",icons:["fa-chevron-down"],title:"Scroll to bottom"}),e.classList.add("esgst-stbb-button");break;case 2:{const t=c.footer.addLinkContainer({icon:"fa fa-chevron-down",position:"beforeend",side:"right"});t.nodes.outer.classList.add("esgst-stbb-button"),t.nodes.outer.title=tr("stbb","Scroll to bottom"),e=t.nodes.outer;break}}e.addEventListener("click",()=>Zo(document.documentElement.offsetHeight,()=>{d.get("es")&&this.esgst.es.paginations&&this.esgst.modules.generalEndlessScrolling.es_changePagination(this.esgst.es,this.esgst.es.reverseScrolling?1:this.esgst.es.paginations.length)}))}},nr=hs.animateScroll.bind(hs),ar=hs.createElements.bind(hs),ir=hs.createHeadingButton.bind(hs),or=hs.getFeatureTooltip.bind(hs);const rr=new class extends gt{constructor(){super(),this.info={description:()=>Se.element("ul",null,Se.element("li",null,"Adds a button (",Se.element("i",{className:"fa fa-chevron-up"}),") either to the bottom right corner, the main page heading or the footer (you can decide where) of any page that takes you to the top of the page.")),id:"sttb",name:"Scroll To Top Button",options:{title:"Show in:",values:["Bottom Right Corner","Main Page Heading","Footer"]},sg:!0,st:!0,type:"general"}}init(){let e;switch(d.get("sttb_index")){case 0:e=ar(document.body,"beforeend",[{attributes:{class:"esgst-sttb-button esgst-sttb-button-fixed",title:""+or("sttb","Scroll to top")},type:"div",children:[{attributes:{class:"fa fa-chevron-up"},type:"i"}]}]),e.classList.add("esgst-hidden"),window.addEventListener("scroll",()=>{window.scrollY>100?e.classList.remove("esgst-hidden"):e.classList.add("esgst-hidden")});break;case 1:e=ir({id:"sttb",icons:["fa-chevron-up"],title:"Scroll to top"}),e.classList.add("esgst-sttb-button");break;case 2:{const t=c.footer.addLinkContainer({icon:"fa fa-chevron-up",position:"beforeend",side:"right"});t.nodes.outer.classList.add("esgst-sttb-button"),t.nodes.outer.title=or("sttb","Scroll to top"),e=t.nodes.outer;break}}e.addEventListener("click",nr.bind(hs,0,()=>{d.get("es")&&this.esgst.es.paginations&&this.esgst.modules.generalEndlessScrolling.es_changePagination(this.esgst.es,this.esgst.es.reverseScrolling?this.esgst.es.paginations.length:1)}))}},lr=hs.createElements.bind(hs),cr=hs.createHeadingButton.bind(hs),dr=hs.getValue.bind(hs),gr=hs.setValue.bind(hs);const ur=new class extends gt{constructor(){super(),this.info={description:()=>Se.element("ul",null,Se.element("li",null,"Adds a button (",Se.element("i",{className:"fa fa-chevron-circle-up"}),") to the main page heading of your"," ",Se.element("a",{href:"https://www.steamtrades.com/trades/search?user="+d.get("steamId")},"created trades")," "," page that allows you to bump all of your open trades at once.")),features:{tb_a:{description:()=>Se.element("ul",null,Se.element("li",null,"Automatically bumps all of your trades every hour."),Se.element("li",null,"Requires either SteamGifts or SteamTrades to be open, depending on where you have this option enabled.")),name:"Auto bump every hour.",sg:!0,st:!0}},id:"tb",name:"Trade Bumper",sg:!0,st:!0,type:"trades"}}init(){if(c.esgst.locationHref.match(new RegExp("\\/trades\\/search\\?user="+d.get("steamId")))){const e=cr({id:"tb",icons:["fa-chevron-circle-up"],title:"Bump trades"});e.addEventListener("click",this.tb_getTrades.bind(this,e,document)),d.get("tb_a")&&this.tb_setAutoBump(e)}else d.get("tb_a")&&this.tb_setAutoBump()}async tb_getTrades(e,t){e&&lr(e,"atinner",[{attributes:{class:"fa fa-circle-o-notch fa-spin"},type:"i"}]);const s=t.querySelectorAll(".row_inner_wrap:not(.is_faded)");for(const e of s)await Ne.post("https://www.steamtrades.com/ajax.php",{data:`xsrf_token=${Be.xsrfToken}&do=trade_bump&code=${e.querySelector('[href*="/trade/"]').getAttribute("href").match(/\/trade\/(.+?)\//)[1]}`});e?window.location.reload():window.setTimeout(this.tb_setAutoBump.bind(this),39e5,e)}async tb_setAutoBump(e){const t=Date.now(),s=t-dr("lastBump",0);s>36e5?(await gr("lastBump",t),this.tb_autoBumpTrades(e)):window.setTimeout(this.tb_setAutoBump.bind(this),36e5-s,e)}async tb_autoBumpTrades(e){c.esgst.locationHref.match(new RegExp("\\/trades\\/search\\?user="+d.get("steamId")))?this.tb_getTrades(e,document):this.tb_getTrades(null,(await Ne.get("https://www.steamtrades.com/trades/search?user="+d.get("steamId"),{queue:!0})).html)}};const mr=new class extends gt{constructor(){super(),this.info={description:()=>Se.element("ul",null,Se.element("li",null,"If you have less than 400P and you hover over the number of points at the header of any page, it shows how much time you have to wait until you have 400P.")),features:{ttpcc_a:{name:"Show time alongside points.",sg:!0}},id:"ttpcc",name:"Time To Point Cap Calculator",sg:!0,type:"general"}}init(){Ee.subscribe(Oe,this.update.bind(this)),this.update(null,Be.counters.points)}update(e,t){if(t>=400)return;let s=60-(new Date).getMinutes();for(;s>15;)s-=15;const n=this.esgst.modules.giveawaysTimeToEnterCalculator.ttec_getTime(Math.round(100*(s+15*Math.floor((400-t)/6)))/100),a=c.header.buttonContainers.account.nodes.points;a.textContent=`${t.toLocaleString("en-US")}${d.get("ttpcc_a")?`P / ${n} to 400`:""}`,a.title=hs.getFeatureTooltip("ttpcc",n+" to 400P")}},hr=hs.createElements.bind(hs),pr=hs.createHeadingButton.bind(hs),fr=hs.getSteamId.bind(hs),br=hs.getUser.bind(hs),wr=hs.getValue.bind(hs),yr=hs.observeNumChange.bind(hs),vr=hs.saveUsers.bind(hs),_r=hs.setValue.bind(hs);const kr=new class extends gt{constructor(){super(),this.info={description:()=>Se.element("ul",null,Se.element("li",null,"Adds a button (",Se.element("i",{className:"fa fa-gift"})," ",Se.element("i",{className:"fa fa-send"}),") to the main page heading of your"," ",Se.element("a",{href:"https://www.steamgifts.com/giveaways/created"},"created")," page that allows you to send all of your unsent gifts at once."),Se.element("li",null,"You can limit which gifts are sent based on whether or not the winner has any not activated/multiple wins (using ",Se.element("a",{href:"https://www.sgtools.info/"},"SGTools"),"), whether or not the winner is still a member of the group and has a certain gift difference for group giveaways, and whether or not the winner is on your whitelist/blacklist.")),id:"ugs",name:"Unsent Gift Sender",sg:!0,type:"giveaways"}}init(){if(this.esgst.createdPath){let e=pr({id:"ugs",icons:["fa-gift","fa-send"],title:"Send unsent gifts"});e.addEventListener("click",this.ugs_openPopup.bind(this,{button:e}))}else this.esgst.newTicketPath&&document.getElementsByClassName("form__submit-button")[0].addEventListener("click",this.ugs_saveReroll.bind(this,document.querySelector('[name="category_id"]'),document.querySelector('[name="reroll_winner_id"]')))}async ugs_saveReroll(e,t){let s;if("1"===e.value){const e=t.value;e&&(s=JSON.parse(wr("rerolls")),s.indexOf(e)<0&&(s.push(e),_r("rerolls",JSON.stringify(s))))}}ugs_openPopup(e){if(!e.popup){e.popup=new lt({addScrollable:!0,icon:"fa-gift",title:"Send unsent gifts:"}),new vt(e.popup.description,"ugs_checkRules",!1,"Do not send if the winner has any not activated/multiple wins.",!1,!1,"The winners will be checked in real time.",d.get("ugs_checkRules"));const t=new vt(e.popup.description,"ugs_checkMember",!1,"Do not send if the winner is no longer a member of at least one of the groups for group giveaways.",!1,!1,"The winners will be checked in real time.",d.get("ugs_checkMember")),s=new vt(e.popup.description,"ugs_checkDifference",!1,Se.element("fragment",null,"Do not send if the winner has a gift difference lower than"," ",Se.element("input",{className:"esgst-ugs-difference",step:"0.1",type:"number",value:d.get("ugs_difference")}),"."),!1,!1,"The winners will be checked in real time.",d.get("ugs_checkDifference"));new vt(e.popup.description,"ugs_checkWhitelist",!1,"Do not send if the winner is not on your whitelist.",!1,!1,"You must sync your whitelist through the settings menu. Whitelisted winners get a pass for broken rules, so if this option is enabled and the winner is whitelisted, the gift will be sent regardless of whether or not the first option is enabled.",d.get("ugs_checkWhitelist")),new vt(e.popup.description,"ugs_checkBlacklist",!1,"Do not send if the winner on your blacklist.",!1,!1,"You must sync your blacklist through the settings menu. If the winner is blacklisted, but is a member of one of the groups, the gift will be sent anyway.",d.get("ugs_checkBlacklist")),d.get("ugs_checkMember")||s.container.classList.add("esgst-hidden"),yr(s.name.firstElementChild,"ugs_setDifference",!0),t.dependencies.push(s.container),e.results=hr(e.popup.scrollable,"beforeend",[{attributes:{class:"esgst-hidden markdown"},type:"div",children:[{type:"ul",children:[{attributes:{class:"esgst-inline-list"},type:"li",children:[{attributes:{class:"esgst-bold"},type:"span",children:[{text:"Successfully sent gifts to ",type:"node"},{text:"0",type:"span"},{text:" winners:",type:"node"}]},{attributes:{class:"esgst-inline-list"},type:"span"}]},{attributes:{class:"esgst-inline-list"},type:"li",children:[{attributes:{class:"esgst-bold"},type:"span",children:[{text:"Failed to send gifts to ",type:"node"},{text:"0",type:"span"},{text:" winners (check the tooltips to find out the cause of the failures):",type:"node"}]},{attributes:{class:"esgst-inline-list"},type:"span"}]},{attributes:{class:"esgst-inline-list"},type:"li",children:[{attributes:{class:"esgst-bold"},type:"span",children:[{text:"0",type:"span"},{text:" giveaways with leftover gifts/keys:",type:"node"}]},{attributes:{class:"esgst-inline-list"},type:"span"}]}]}]}]),e.sent=e.results.firstElementChild.firstElementChild,e.sentCount=e.sent.firstElementChild.firstElementChild,e.sentGifts=e.sent.lastElementChild,e.unsent=e.sent.nextElementSibling,e.unsentCount=e.unsent.firstElementChild.firstElementChild,e.unsentGifts=e.unsent.lastElementChild,e.leftover=e.unsent.nextElementSibling,e.leftoverCount=e.leftover.firstElementChild.firstElementChild,e.leftoverGifts=e.leftover.lastElementChild,tt.create([{color:"green",icons:["fa-send"],name:"Send",onClick:this.ugs_start.bind(this,e)},{template:"error",name:"Cancel",switchTo:{onReturn:0},onClick:this.ugs_cancel.bind(this,e)}]).insert(e.popup.description,"beforeend"),e.progressBar=at.create().insert(e.popup.description,"beforeend").hide(),e.overallProgressBar=at.create().insert(e.popup.description,"beforeend").hide(),e.popup.description.appendChild(e.popup.scrollable)}e.popup.open()}async ugs_start(e){if(d.get("ugs_checkMember")&&!await ut.contains([["steamCommunity"]]))return;if(e.isCanceled=!1,e.giveaways=[],e.groups={},e.button.classList.add("esgst-busy"),e.results.classList.add("esgst-hidden"),e.sent.classList.add("esgst-hidden"),e.unsent.classList.add("esgst-hidden"),e.leftover.classList.add("esgst-hidden"),e.sentGifts.innerHTML="",e.unsentGifts.innerHTML="",e.leftoverGifts.innerHTML="",e.sentCount.textContent=e.unsentCount.textContent=e.leftoverCount.textContent="0",!Be.counters.created)return e.button.classList.remove("esgst-busy"),void e.progressBar.setWarning("You do not have any unsent gifts.").show();e.progressBar.setLoading(null).show(),e.overallProgressBar.reset().show(),e.count=Be.counters.created;let t=[],s=1,n=null,a=!1;do{let i=null;if(a=!1,s===this.esgst.currentPage)i=document;else{if(document.getElementsByClassName(`esgst-es-page-${s}}`)[0]){a=!0;continue}i=(await Ne.get("/giveaways/created/search?page="+s)).html}1===s&&(e.lastPage=this.esgst.modules.generalLastPageLink.lpl_getLastPage(i,i===document),e.lastPage=999999999===e.lastPage?"":" of "+e.lastPage),e.progressBar.setMessage(`Searching for unsent gifts (page ${s}${e.lastPage})...`),e.continue=!1;let o=i.getElementsByClassName("table__row-outer-wrap");for(let s=0,n=o.length;s<n;s++){let n=o[s],a=n.getElementsByClassName("fa icon-red fa-warning")[0];if(a){let s=n.getElementsByClassName("table__column__heading")[0],i=s.getAttribute("href");t.push({code:i.match(/\/giveaway\/(.+?)\//)[1],context:a,name:s.firstChild.textContent.trim().match(/(.+?)(\s\(.+\sCopies\))?$/)[1],url:i}),e.continue=!0,e.count-=1}}n=i.getElementsByClassName("pagination__navigation")[0],s+=1}while(!e.isCanceled&&(e.count>0||e.continue)&&(a||n&&!n.lastElementChild.classList.contains("is-selected")));for(let s=0,n=t.length;!e.isCanceled&&s<n;s++){e.overallProgressBar.setMessage(`${s} of ${n} giveaways checked`);let a=t[s];e.giveaways[a.code]={code:a.code,copies:0,context:a.context,name:a.name,url:a.url,totalWinners:0,winners:[]};let i=1,o=null;do{let t=(await Ne.get(`${a.url}/winners/search?page=${i}`)).html;if(1===i&&(e.lastWinnersPage=this.esgst.modules.generalLastPageLink.lpl_getLastPage(t),e.lastWinnersPage=999999999===e.lastWinnersPage?"":" of "+e.lastWinnersPage),e.progressBar.setMessage(`Retrieving winners (page ${i}${e.lastWinnersPage})...`),!e.giveaways[a.code].copies){const s=t.querySelectorAll(".featured__heading__small");s&&2===s.length&&(e.giveaways[a.code].copies=parseInt(s[0].textContent.replace(/,|\(|\)|Copies/g,"").trim()))}let s=t.getElementsByClassName("table__row-outer-wrap");const n=s.length;e.giveaways[a.code].totalWinners+=n;for(let t=0;t<n;t++){let n=s[t];n.querySelector(".table__gift-not-sent:not(.is-hidden)")&&(e.giveaways[a.code].winners.push({username:n.getElementsByClassName("table__column__heading")[0].textContent,values:{},winnerId:n.querySelector('[name="winner_id"]').value}),e.count-=1)}e.giveaways[a.code].group||(e.giveaways[a.code].group=t.getElementsByClassName("featured__column--group")[0]),e.giveaways[a.code].whitelist||(e.giveaways[a.code].whitelist=t.getElementsByClassName("featured__column--whitelist")[0]),o=t.getElementsByClassName("pagination__navigation")[0],i+=1}while(!e.isCanceled&&o&&!o.lastElementChild.classList.contains("is-selected"));if(e.giveaways[a.code].copies||(e.giveaways[a.code].copies=1),e.giveaways[a.code].copies>e.giveaways[a.code].totalWinners&&(e.leftover.classList.remove("esgst-hidden"),e.leftoverCount.textContent=parseInt(e.leftoverCount.textContent)+1,hr(e.leftoverGifts,"beforeend",[{type:"span",children:[{attributes:{href:a.url},text:a.name,type:"a"},{text:` (${e.giveaways[a.code].copies-e.giveaways[a.code].totalWinners})`,type:"node"}]}])),d.get("ugs_checkMember")&&e.giveaways[a.code].group){e.giveaways[a.code].groups=[];let t=1,s=null;do{let n=(await Ne.get(`${a.url}/groups/search?page=${t}`)).html;1===t&&(e.lastGroupsPage=this.esgst.modules.generalLastPageLink.lpl_getLastPage(n),e.lastGroupsPage=999999999===e.lastGroupsPage?"":" of "+e.lastGroupsPage),e.progressBar.setMessage(`Retrieving groups (page ${t}${e.lastGroupsPage})...`);let i=n.getElementsByClassName("table__row-outer-wrap");for(let t=0,s=i.length;t<s;t++){let s=i[t],n=s.getElementsByClassName("table__column__heading")[0],o=n.getAttribute("href").match(/\/group\/(.+?)\/(.+)/);e.giveaways[a.code].groups.push({avatar:s.getElementsByClassName("table_image_avatar")[0].style.backgroundImage.match(/url\("(.+)"\)/)[1],code:o[1],name:n.textContent,urlName:o[2]})}s=n.getElementsByClassName("pagination__navigation")[0],t+=1}while(!e.isCanceled&&s&&!s.lastElementChild.classList.contains("is-selected"))}}if(e.isCanceled)return;let i=Object.keys(e.giveaways),o=i.length;if(o>0){e.rerolls=JSON.parse(c.common.getValue("rerolls","[]")),e.sentWinners={},e.winners={},e.results.classList.remove("esgst-hidden");for(let t=0;!e.isCanceled&&t<o;t++){e.overallProgressBar.setMessage(`${t} of ${o} giveaways checked`);let s=e.giveaways[i[t]];for(let t=0,n=s.winners.length;t<n;t++){let n=s.winners[t],a=await br(this.esgst.users,n);if(e.rerolls.indexOf(n.winnerId)>-1)n.error=n.username+" is currently being rerolled.";else{if(d.get("ugs_checkRules")){e.progressBar.setMessage(`Checking if ${n.username} has not activated/multiple wins...`),n.values.namwc={lastCheck:Date.now(),results:{}};try{await this.esgst.modules.usersNotActivatedMultipleWinChecker.namwc_checkNotActivated(e,n),await this.esgst.modules.usersNotActivatedMultipleWinChecker.namwc_checkMultiple(e,n);let t=Array.isArray(n.values.namwc.results.notActivated)?n.values.namwc.results.notActivated.length:n.values.namwc.results.notActivated,s=Array.isArray(n.values.namwc.results.multiple)?n.values.namwc.results.multiple.length:n.values.namwc.results.multiple;(Array.isArray(n.values.namwc.results.unknown)?n.values.namwc.results.unknown.length:n.values.namwc.results.unknown)?n.error=`Could not check ${n.username}'s not activated / multiple wins (probably a private profile).`:t&&s?n.error=`${n.username} has ${t} not activated wins and ${s} multiple wins.`:t?n.error=`${n.username} has ${t} not activated wins.`:s&&(n.error=`${n.username} has ${s} multiple wins.`),n.sgToolsErrorNAW=t,n.sgToolsErrorMW=s}catch(e){n.error=`Could not check ${n.username}'s not activated / multiple wins (probably a connection error).`}}if(d.get("ugs_checkMember")&&s.group&&!n.error){e.progressBar.setMessage(`Checking if ${n.username} is a member of one of the groups...`),await fr(null,!1,this.esgst.users,n);let t=!1;for(let a=0,i=s.groups.length;a<i;a++){let i=s.groups[a],o=i.code;if(!e.groups[o]){let t;for(t=this.esgst.groups.length-1;t>-1&&this.esgst.groups[t].code!==o;t--);for(t<0&&(this.esgst.groups.push({avatar:i.avatar,code:o,name:i.name}),t=this.esgst.groups.length-1),this.esgst.groups[t].steamId||(this.esgst.groups[t].steamId=(await Ne.get(`/group/${o}/`)).html.getElementsByClassName("sidebar__shortcut-inner-wrap")[0].firstElementChild.getAttribute("href").match(/\d+/)[0]),e.groups[o]=(await Ne.get(`http://steamcommunity.com/gid/${this.esgst.groups[t].steamId}/memberslistxml?xml=1`)).text.match(/<steamID64>.+?<\/steamID64>/g),t=e.groups[o].length-1;t>-1;t--)e.groups[o][t]=e.groups[o][t].match(/<steamID64>(.+?)<\/steamID64>/)[1]}if(e.groups[o].indexOf(n.steamId)<0)continue;if(!d.get("ugs_checkDifference")){t=!0;break}e.progressBar.setMessage(`Checking if ${n.username} has a gift difference higher than the one set...`);let r=(await Ne.get(`/group/${o}/${i.urlName}/users/search?q=${n.username}`)).html.getElementsByClassName("table__row-outer-wrap")[0];if(r&&r.getElementsByClassName("table__column__heading")[0].textContent===n.username){let e=parseFloat(r.getElementsByClassName("table__column--width-small")[2].textContent);if(e>=d.get("ugs_difference")){t=!0;break}n.error=`${n.username} has a ${e} gift difference.`;break}}n.error||t||(n.error=n.username+" is not a member of one of the groups.")}d.get("ugs_checkWhitelist")&&(n.error=a&&a.whitelisted?null:n.username+" is not whitelisted."),d.get("ugs_checkBlacklist")&&a&&a.blacklisted&&!n.error&&(n.error=n.username+" is blacklisted.")}e.winners[n.username]||(e.winners[n.username]=[]),e.winners[n.username].indexOf(s.name)<0?n.error?(e.unsent.classList.remove("esgst-hidden"),e.unsentCount.textContent=parseInt(e.unsentCount.textContent)+1,hr(e.unsentGifts,"beforeend",[{type:"span",children:[{attributes:{href:"/user/"+n.username},text:n.username,type:"a"},{text:" (",type:"node"},{attributes:{href:s.url+"/winners"},text:s.name,type:"a"},{text:") ",type:"node"},n.sgToolsErrorNAW?{attributes:{class:"esgst-red",href:"http://www.sgtools.info/nonactivated/"+n.username},type:"a",children:[{text:n.sgToolsErrorNAW+" ",type:"node"},{attributes:{class:"fa fa-steam",title:"Not activated wins"},type:"i"}]}:null,n.sgToolsErrorMW?{attributes:{class:"esgst-red",href:"http://www.sgtools.info/multiple/"+n.username},type:"a",children:[{text:n.sgToolsErrorMW+" ",type:"node"},{attributes:{class:"fa fa-clone",title:"Multiple wins"},type:"i"}]}:null,{attributes:{class:"fa fa-question-circle",title:n.error},type:"i"}]}])):e.isCanceled||(await Ne.post("/ajax.php",{data:`xsrf_token=${Be.xsrfToken}&do=sent_feedback&action=1&winner_id=${n.winnerId}`}),e.sentWinners[s.code]||(e.sentWinners[s.code]=[]),e.sent.classList.remove("esgst-hidden"),e.sentWinners[s.code].push(n.username),e.sentCount.textContent=parseInt(e.sentCount.textContent)+1,hr(e.sentGifts,"beforeend",[{type:"span",children:[{attributes:{href:"/user/"+n.username},text:n.username,type:"a"},{text:" (",type:"node"},{attributes:{href:s.url+"/winners"},text:s.name,type:"a"},{text:")",type:"node"}]}]),e.winners[n.username].push(s.name),document.body.contains(s.context)&&(s.context.className="fa fa-check-circle icon-green",s.context.nextElementSibling.textContent="Sent")):(e.unsent.classList.remove("esgst-hidden"),e.unsentCount.textContent=parseInt(e.unsentCount.textContent)+1,hr(e.unsentGifts,"beforeend",[{type:"span",children:[{attributes:{href:"/user/"+n.username},text:n.username,type:"a"},{text:" (",type:"node"},{attributes:{href:s.url+"/winners"},text:s.name,type:"a"},{text:") ",type:"node"},{attributes:{class:"fa fa-question-circle",title:`${n.username} already won ${s.name} from another giveaway of yours`},type:"i"}]}]))}}let t=JSON.parse(wr("winners","{}"));for(let s in e.sentWinners)if(e.sentWinners.hasOwnProperty(s)){t[s]||(t[s]=[]);for(let n=0,a=e.sentWinners[s].length;n<a;n++)t[s].push(e.sentWinners[s][n])}let s=[];for(let t in e.giveaways)if(e.giveaways.hasOwnProperty(t))for(let n=0,a=e.giveaways[t].winners.length;n<a;n++)s.push(e.giveaways[t].winners[n]);e.progressBar.setMessage("Saving data..."),e.overallProgressBar.hide(),await Promise.all([_r("winners",JSON.stringify(t)),vr(s),_r("groups",JSON.stringify(this.esgst.groups))]),e.button.classList.remove("esgst-busy"),e.progressBar.reset().hide(),e.overallProgressBar.setSuccess("All giveaways checked!").show()}else e.button.classList.remove("esgst-busy"),e.progressBar.setWarning("You do not have any unsent gifts."),e.overallProgressBar.reset().hide()}ugs_cancel(e){e.isCanceled=!0,e.button.classList.remove("esgst-busy"),e.progressBar.reset().hide()}};const xr=new class extends gt{constructor(){super(),this.info={description:()=>Se.element("ul",null,Se.element("li",null,"Adds a button (",Se.element("i",{className:"fa fa-user"})," ",Se.element("i",{className:"fa fa-ban"})," ",Se.element("i",{className:"fa fa-question-circle"}),") to the main page heading of any page that allows you to check which users in the page are suspended.")),id:"usc",name:"User Suspension Checker",sg:!0,type:"users"}}init(){c.esgst.mainPageHeading&&(c.esgst.uscButton=c.common.createHeadingButton({id:"usc",icons:["fa-user","fa-ban","fa-question-circle"],title:"Check users for suspensions"}),this.addButton(c.esgst.uscButton))}addButton(e){const t={};window.location.pathname.match(new RegExp(`^/user/(?!${d.get("username")})`))&&(t.username=document.getElementsByClassName("featured__heading__medium")[0].textContent);const s=new lt({addScrollable:!0,icon:"fa-question",title:"Check users for suspensions:"});let n;Se.insert(s.description,"beforeend",Se.element("div",{ref:e=>t.options=e})),t.username&&(n=new vt(t.options,"usc_checkSingle",!1,`Only check ${t.username||"current user"}.`,!1,!1,"If disabled, all users in the current page will be checked.",d.get("usc_checkSingle")));const a=c.common.getFeatureNumber("mm"),i=new vt(t.options,"usc_checkSelected",!1,"Only check selected.",!1,!1,`Use ${a.number} ${a.name} to select the users that you want to check. Then click the button 'Check Suspensions' in the Multi-Manager popout and you will be redirected here.`,d.get("usc_checkSelected"));let o,r;if(!window.location.pathname.match(/^\/(discussions|users|archive)/)){o=new vt(t.options,"usc_checkAll",!1,"Check all pages.",!1,!1,"If disabled, only the current page will be checked.",d.get("usc_checkAll")),r=new vt(t.options,"usc_checkPages",!1,Se.element("fragment",null,"Check only pages from"," ",Se.element("input",{className:"esgst-switch-input",min:"1",type:"number",value:d.get("usc_minPage")})," to ",Se.element("input",{className:"esgst-switch-input",min:"1",type:"number",value:d.get("usc_maxPage")}),"."),!1,!1,null,d.get("usc_checkPages"));const e=r.name.firstElementChild,s=e.nextElementSibling,n=c.esgst.modules.generalLastPageLink.lpl_getLastPage(document,!0);999999999!==n&&s.setAttribute("max",n),c.common.observeNumChange(e,"usc_minPage",!0),c.common.observeNumChange(s,"usc_maxPage",!0)}(n||o||r)&&(n&&(o&&n.exclusions.push(o.container),r&&n.exclusions.push(r.container),n.exclusions.push(i.container),i.exclusions.push(n.container),d.get("usc_checkSingle")?(o&&o.container.classList.add("esgst-hidden"),r&&r.container.classList.add("esgst-hidden"),i.container.classList.add("esgst-hidden")):d.get("usc_checkSelected")&&n.container.classList.add("esgst-hidden")),o&&(n&&o.exclusions.push(n.container),r&&o.exclusions.push(r.container),i.exclusions.push(o.container),o.exclusions.push(i.container),d.get("usc_checkAll")?(n&&n.container.classList.add("esgst-hidden"),r&&r.container.classList.add("esgst-hidden"),i.container.classList.add("esgst-hidden")):d.get("usc_checkSelected")&&o.container.classList.add("esgst-hidden")),r&&(n&&r.exclusions.push(n.container),o&&r.exclusions.push(o.container),i.exclusions.push(r.container),r.exclusions.push(i.container),d.get("usc_checkPages")?(n&&n.container.classList.add("esgst-hidden"),o&&o.container.classList.add("esgst-hidden"),i.container.classList.add("esgst-hidden")):d.get("usc_checkSelected")&&r.container.classList.add("esgst-hidden"))),tt.create([{color:"green",icons:["fa-question-circle"],name:"Check",onClick:async()=>{e.classList.add("esgst-busy"),await this.setCheck(t),t.progressBar.setSuccess("All users checked!"),e.classList.remove("esgst-busy"),s.setDone()}},{template:"error",name:"Cancel",switchTo:{onReturn:0},onClick:()=>{t.canceled=!0,window.setTimeout(()=>{t.progressBar.reset().hide()},500),e.classList.remove("esgst-busy")}}]).insert(s.description,"beforeend"),t.progressBar=at.create().insert(s.description,"beforeend").hide(),Se.insert(s.scrollable,"beforeend",Se.element("div",{ref:e=>t.results=e})),c.common.createResults(t.results,t,[{Icon:"fa fa-times-circle esgst-red",Description:"Suspended: ",Key:"suspended"},{Icon:"fa fa-times esgst-red",Description:"Banned: ",Key:"banned"},{Icon:"fa fa-check esgst-green",Description:"None: ",Key:"none"}]),e.addEventListener("click",()=>{if(e.getAttribute("data-mm")){if(!d.get("usc_checkSelected")){if(d.get("usc_checkSingle")&&n){let e=c.common.createElements(n.container,"afterbegin",[{attributes:{class:"esgst-bold esgst-red"},text:"Disable this --\x3e",type:"span"}]);window.setTimeout(()=>e.remove(),5e3)}else if(d.get("usc_checkAll")){let e=c.common.createElements(o.container,"afterbegin",[{attributes:{class:"esgst-bold esgst-red"},text:"Disable this --\x3e",type:"span"}]);window.setTimeout(()=>e.remove(),5e3)}else if(d.get("usc_checkPages")){let e=c.common.createElements(r.container,"afterbegin",[{attributes:{class:"esgst-bold esgst-red"},text:"Disable this --\x3e",type:"span"}]);window.setTimeout(()=>e.remove(),5e3)}let e=c.common.createElements(i.container,"afterbegin",[{attributes:{class:"esgst-bold esgst-red"},text:"Enable this --\x3e",type:"span"}]);window.setTimeout(()=>e.remove(),5e3)}e.removeAttribute("data-mm")}s.open()})}async setCheck(e){if(e.progressBar.setLoading(null).show(),e.suspended.classList.add("esgst-hidden"),e.banned.classList.add("esgst-hidden"),e.none.classList.add("esgst-hidden"),e.suspendedCount.textContent=e.bannedCount.textContent=e.noneCount.textContent="0",e.suspendedUsers.innerHTML="",e.bannedUsers.innerHTML="",e.noneUsers.innerHTML="",e.users=[],e.canceled=!1,e.username&&d.get("usc_checkSingle"))e.users.push(e.username),await this.checkUsers(e);else{if(d.get("usc_checkSelected"))e.users=Array.from(c.esgst.mmWbcUsers);else if(!d.get("usc_checkPages")){const t=c.esgst.pageOuterWrap.querySelectorAll('a[href*="/user/"]');for(const s of t){const t=s.getAttribute("href").match(/\/user\/(.+)/);if(!t)continue;const n=t[1];e.users.indexOf(n)>-1||n===d.get("username")||n!==s.textContent||s.closest(".markdown")||e.users.push(n)}}!d.get("usc_checkAll")&&!d.get("usc_checkPages")||(!e.username||d.get("usc_checkSingle"))&&e.username||window.location.pathname.match(/^\/(discussions|users|archive)/)||await this.getUsers(e),e.users=l.sortArray(e.users),window.location.pathname.match(/^\/users/)&&(e.users=e.users.slice(0,25)),await this.checkUsers(e)}}async checkUsers(e){let t,s;for(t=0,s=e.users.length;t<s&&!e.canceled;t++){e.progressBar.setMessage(`Checking users (${t} of ${s})...`);const n=e.users[t],a=(await Ne.get("/user/"+n)).html;if(e.canceled)return;let i="",o="";const r=a.querySelector(".sidebar__suspension");if(r)if(r.textContent.match(/Suspended/)){i="suspended";o=a.querySelector(".sidebar__suspension-time").textContent}else i="banned";else i="none";e[i].classList.remove("esgst-hidden"),Se.insert(e[i+"Users"],"beforeend",Se.element("div",null,Se.element("a",{href:"/user/"+n},n)," ",o?` (${o})`:null)),e[i+"Count"].textContent=parseInt(e[i+"Count"].textContent)+1}e.progressBar.setMessage(`Checking users (${t} of ${s})...`)}async getUsers(e){if(e.canceled)return;let t,s=null;d.get("usc_checkPages")?(t=d.get("usc_minPage"),e.lastPage="of "+d.get("usc_maxPage")):(t=1,e.lastPage="");do{let n;if(n=t===c.esgst.currentPage?c.esgst.pageOuterWrap:(await Ne.get(`${c.esgst.searchUrl}${t}`)).html,e.canceled)return;e.lastPage||(e.lastPage=c.esgst.modules.generalLastPageLink.lpl_getLastPage(n,!0),e.lastPage=999999999===e.lastPage?"":" of "+e.lastPage),e.progressBar.setMessage(`Retrieving users (page ${t}${e.lastPage})...`);const a=n.querySelectorAll('a[href*="/user/"]');for(const t of a){const s=t.getAttribute("href").match(/\/user\/(.+)/);if(s){const n=s[1];e.users.indexOf(n)<0&&n!==d.get("username")&&n===t.textContent&&!t.closest(".markdown")&&e.users.push(n)}}s=n.querySelector(".pagination__navigation"),t+=1}while(!e.canceled&&s&&!s.lastElementChild.classList.contains("is-selected")&&(!d.get("usc_checkPages")||t<=d.get("usc_maxPage")))}},Ar=hs.createElements.bind(hs),Cr=hs.createHeadingButton.bind(hs),Sr=hs.getFeatureNumber.bind(hs),Er=hs.getFeatureTooltip.bind(hs),Tr=hs.getTimestamp.bind(hs),Nr=hs.getUser.bind(hs),Pr=hs.getUserId.bind(hs),Lr=hs.getValue.bind(hs),Ir=hs.observeNumChange.bind(hs),Br=hs.saveUser.bind(hs);const Dr=new class extends gt{constructor(){super(),this.info={description:()=>Se.element("ul",null,Se.element("li",null,"Adds a button (",Se.element("i",{className:"fa fa-heart"})," ",Se.element("i",{className:"fa fa-ban"})," ",Se.element("i",{className:"fa fa-question-circle"}),") to the main page heading of any page that allows you to check which users in the page have whitelisted/blacklisted you."),Se.element("li",null,"That information is retrieved by searching for whitelist giveaways in the user's"," ",Se.element("a",{href:"https://www.steamgifts.com/user/cg"},"profile")," page and checking if you can access them. If no whitelist giveaways are found, the feature searches for group + whitelist giveaways instead and checks if you can access them using the groups that you are a member of to determine whether you can access them for being a group member or for being in the user's whitelist."),Se.element("li",null,"There are many options that allow you to narrow down the check: you can select which users to check, check only if the user has blacklisted you (which is faster than checking if they have whitelisted you because it does not need to find a whitelist giveaway), how many pages to check, whether or not to check again users that were already checked and whether or not to skip users that the feature is taking too long to find whitelist giveaways from."),Se.element("li",null,"There are also options to return whitelists/blacklists, which means that if a user that has whitelisted/blacklisted you is found, they will be whitelisted/blacklisted back."),Se.element("li",null,"Adds a button (",Se.element("i",{className:"fa fa-heart"})," ",Se.element("i",{className:"fa fa-ban"})," ",Se.element("i",{className:"fa fa-gear"}),") to the page heading of this menu that allows you to view/update all of the users that have been checked."),Se.element("li",null,"Results are cached for 24 hours, so if you check the same user again within that timeframe, their status will not change, unless you check them with the option to clear the cache enabled.")),features:{wbc_h:{description:()=>Se.element("ul",null,Se.element("li",null,"Adds an icon (",Se.element("i",{className:"fa fa-check esgst-whitelist"})," if the user has whitelisted you and ",Se.element("i",{className:"fa fa-times esgst-blacklist"})," if they have blacklisted you) next to a checked user's username (in any page)."),Se.element("li",null,"If you hover over the icon, it shows the date when they were checked for the last time.")),name:"Highlight checked users.",sg:!0,st:!0},wbc_n:{description:()=>Se.element("ul",null,Se.element("li",null,"If you have ",Se.element("span",{"data-esgst-feature-id":"un"})," enabled, a note will be saved for a user if they were whitelisted / blacklisted back.")),name:"Save automatic notes when returning whitelists/blacklists.",sg:!0},wbc_hb:{description:()=>Se.element("ul",null,Se.element("li",null,"With this option enabled, the feature will not tell you if a user has blacklisted you (in fact, the name of the feature will change to Whitelist Checker for you). If the feature finds a user that has blacklisted you, it will tell you that it could not determine their status.")),name:"Hide blacklist information.",sg:!0}},id:"wbc",name:"Whitelist/Blacklist Checker",sg:!0,sync:"Steam Groups",syncKeys:["Groups"],type:"users"}}init(){if(d.get("wbc_h")&&c.esgst.userFeatures.push(this.wbc_users.bind(this)),!c.esgst.mainPageHeading)return;let[e,t]=d.get("wbc_hb")?[["fa-heart","fa-question-circle"],"Check for whitelists"]:[["fa-heart","fa-ban","fa-question-circle"],"Check for whitelists/blacklists"];c.esgst.wbcButton=Cr({id:"wbc",icons:e,title:t}),this.wbc_addButton(!0,c.esgst.wbcButton)}wbc_users(e){for(const t of e)if(t.saved&&t.saved.wbc&&!t.context.parentElement.getElementsByClassName("esgst-wbc-icon")[0]){let e=t.saved.wbc.result;("whitelisted"===e||"blacklisted"===e&&!d.get("wbc_hb"))&&Ar(t.context,"beforebegin",[{attributes:{class:"esgst-wbc-icon esgst-user-icon",title:Er("wbc",`${t.username} has ${e} you (last checked ${Tr(t.saved.wbc.lastCheck)})`)},type:"span",children:[{attributes:{class:"fa "+("whitelisted"===e?"fa-check esgst-whitelist":"fa-times esgst-blacklist")},type:"i"}]}])}}wbc_addButton(e,t){let s,n,a,i,o,r={};r.Update=!e,r.B=!d.get("wbc_hb"),r.Username=d.get("username"),i=new lt({addScrollable:!0}),window.location.pathname.match(new RegExp(`^/user/(?!${r.Username})`))&&(r.User={Username:document.getElementsByClassName("featured__heading__medium")[0].textContent,ID:document.querySelector('[name="child_user_id"]').value,SteamID64:document.querySelector('a[href*="/profiles/"]').href.match(/\d+/)[0]}),this.heading=pt.create("wbc",[r.Update?"Manage Whitelist/Blacklist Checker caches":"Check for whitelists"+(r.B?"/blacklists":"")]).insert(i.description,"beforeend"),o=tt.create({color:"alternate-white",tooltip:"Options",icons:["fa-gear"]}).insert(this.heading.nodes.outer,"beforeend");const l=new mt("",o.nodes.outer,0,!0);i.Options=Ar(l.popout,"beforeend",[{type:"div"}]),r.User&&(a=new vt(i.Options,"wbc_checkSingle",!1,`Only check ${r.User?r.User.Username:"current user"}.`,!1,!1,"If disabled, all users in the current page will be checked.",d.get("wbc_checkSingle")));let g=Sr("mm"),u=new vt(i.Options,"wbc_checkSelected",!1,"Only check selected.",!1,!1,`Use ${g.number} ${g.name} to select the users that you want to check. Then click the button 'Check WL/BL' in the Multi-Manager popout and you will be redirected here.`,d.get("wbc_checkSelected")),m=new vt(i.Options,"wbc_checkFromList",!1,Se.element("fragment",null,"Only check these users:"," ",Se.element("input",{className:"esgst-switch-input esgst-switch-input-large",placeholder:"user1, user2, user3, ...",type:"text",value:d.get("wbc_userList").join(", "),onchange:e=>{d.set("wbc_userList",Array.from(new Set(e.target.value.split(/,\s*/)))),c.common.setSetting("wbc_userList",d.get("wbc_userList"))}})),!1,!1,"Enter the usernames of the users that you want to check, separated by a comma.",d.get("wbc_checkFromList"));if(r.B&&new vt(i.Options,"wbc_checkBlacklist",!1,"Only check blacklist.",!1,!1,"If enabled, a blacklist-only check will be performed (faster).",d.get("wbc_checkBlacklist")),!r.Update&&!window.location.pathname.match(/^\/(discussions|users|archive)/)){s=new vt(i.Options,"wbc_checkAll",!1,"Check all pages.",!1,!1,"If disabled, only the current page will be checked.",d.get("wbc_checkAll")),n=new vt(i.Options,"wbc_checkPages",!1,Se.element("fragment",null,"Check only pages from"," ",Se.element("input",{className:"esgst-switch-input",min:"1",type:"number",value:d.get("wbc_minPage")})," to ",Se.element("input",{className:"esgst-switch-input",min:"1",type:"number",value:d.get("wbc_maxPage")}),"."),!1,!1,null,d.get("wbc_checkPages"));let e=n.name.firstElementChild,t=e.nextElementSibling,a=c.esgst.modules.generalLastPageLink.lpl_getLastPage(document,!0);999999999!==a&&t.setAttribute("max",a),Ir(e,"wbc_minPage",!0),Ir(t,"wbc_maxPage",!0)}new vt(i.Options,"wbc_returnWhitelists",!1,"Return whitelists.",!1,!1,"If enabled, everyone who has whitelisted you will be whitelisted back.",d.get("wbc_returnWhitelists")),r.B&&new vt(i.Options,"wbc_returnBlacklists",!1,"Return blacklists.",!1,!1,"If enabled, everyone who has blacklisted you will be blacklisted back.",d.get("wbc_returnBlacklists")),new vt(i.Options,"wbc_checkNew",!1,`Only check users who have not whitelisted ${r.B?"/blacklisted":""} you.`,!1,!1,`If enabled, everyone who has whitelisted ${r.B?"/blacklisted":""} you will be ignored (might lead to outdated data if someone who had whitelisted ${r.B?"/blacklisted":""} you in the past removed you from those lists).`,d.get("wbc_checkNew")),Ir(new vt(i.Options,"wbc_skipUsers",!1,Se.element("fragment",null,"Skip users after"," ",Se.element("input",{className:"esgst-ugs-difference",type:"number",value:d.get("wbc_pages")})," ","pages."),!1,!1,"If enabled, when a user check passes the number of pages specified, the user will be skipped.",d.get("wbc_skipUsers")).name.firstElementChild,"wbc_pages",!0),new vt(i.Options,"wbc_clearCache",!1,"Clear caches.",!1,!1,"If enabled, the caches of all checked users will be cleared (slower).",d.get("wbc_clearCache")),console.log(d.get("wbc_checkSingle"),d.get("wbc_checkSelected"),d.get("wbc_checkFromList"),d.get("wbc_checkBlacklist"),d.get("wbc_checkAll"),d.get("wbc_returnWhitelists"),d.get("wbc_returnBlacklists"),d.get("wbc_checkNew"),d.get("wbc_skipUsers")),(a||s||n)&&(a&&(s&&a.exclusions.push(s.container),n&&a.exclusions.push(n.container),a.exclusions.push(u.container),a.exclusions.push(m.container),u.exclusions.push(a.container),m.exclusions.push(a.container),d.get("wbc_checkSingle")?(s&&s.container.classList.add("esgst-hidden"),n&&n.container.classList.add("esgst-hidden"),u.container.classList.add("esgst-hidden"),m.container.classList.add("esgst-hidden")):(d.get("wbc_checkSelected")||d.get("wbc_checkFromList"))&&a.container.classList.add("esgst-hidden")),s&&(a&&s.exclusions.push(a.container),n&&s.exclusions.push(n.container),u.exclusions.push(s.container),m.exclusions.push(s.container),s.exclusions.push(u.container),s.exclusions.push(m.container),d.get("wbc_checkAll")?(a&&a.container.classList.add("esgst-hidden"),n&&n.container.classList.add("esgst-hidden"),u.container.classList.add("esgst-hidden"),m.container.classList.add("esgst-hidden")):(d.get("wbc_checkSelected")||d.get("wbc_checkFromList"))&&s.container.classList.add("esgst-hidden")),n&&(a&&n.exclusions.push(a.container),s&&n.exclusions.push(s.container),u.exclusions.push(n.container),m.exclusions.push(n.container),n.exclusions.push(u.container),n.exclusions.push(m.container),d.get("wbc_checkPages")?(a&&a.container.classList.add("esgst-hidden"),s&&s.container.classList.add("esgst-hidden"),u.container.classList.add("esgst-hidden"),m.container.classList.add("esgst-hidden")):(d.get("wbc_checkSelected")||d.get("wbc_checkFromList"))&&n.container.classList.add("esgst-hidden"))),u.exclusions.push(m.container),m.exclusions.push(u.container),Ar(i.Options,"afterend",[{attributes:{class:"esgst-description"},text:"If an user is highlighted, that means they have been either checked for the first time or updated.",type:"div"}]),tt.create([{color:"green",icons:[r.Update?"fa-refresh":"fa-question-circle"],name:r.Update?"Update":"Check",onClick:()=>new Promise(e=>{r.ShowResults=!1,t.classList.add("esgst-busy"),this.wbc_setCheck(r,()=>{this.skip&&(this.skip.destroy(),this.skip=null),r.progressBar.reset().hide(),r.overallProgressBar.setSuccess(),t.classList.remove("esgst-busy"),e(),r.popup.setDone()})})},{template:"error",name:"Cancel",switchTo:{onReturn:0},onClick:()=>{this.skip&&(this.skip.destroy(),this.skip=null),window.clearInterval(r.Request),window.clearInterval(r.Save),r.Canceled=!0,window.setTimeout(()=>{r.progressBar.reset().hide()},500),t.classList.remove("esgst-busy")}}]).insert(this.heading.nodes.outer,"beforeend"),r.progressBar=at.create().insert(i.description,"beforeend").hide(),r.overallProgressBar=at.create().insert(i.description,"beforeend").hide(),i.Results=Ar(i.scrollable,"beforeend",[{type:"div"}]),this.table=new Rs([[{size:"fill",value:Se.element("fragment",null,Se.element("i",{className:"fa fa-heart esgst-whitelist"})," Whitelisted (",Se.element("span",{ref:e=>this.whitelistedCount=e},"0"),") ",Se.element("i",{className:"fa fa-question-circle",title:"Users that have whitelisted you"}))},{size:"fill",value:Se.element("fragment",null,Se.element("i",{className:"fa fa-ban esgst-blacklist"})," Blacklisted (",Se.element("span",{ref:e=>this.blacklistedCount=e},"0"),") ",Se.element("i",{className:"fa fa-question-circle",title:"Users that have blacklisted you"}))},{size:"fill",value:Se.element("fragment",null,Se.element("i",{className:"fa fa-check"}),` ${r.B?"None":"Not Blacklisted"} (`,Se.element("span",{ref:e=>this.noneCount=e},"0"),") ",Se.element("i",{className:"fa fa-question-circle",title:r.B?"Users that have neither whitelisted nor blacklisted you":"Users that have not whitelisted you"}))},{size:"fill",value:Se.element("fragment",null,Se.element("i",{className:"fa fa-question"})," Not Blacklisted (",Se.element("span",{ref:e=>this.notBlacklistedCount=e},"0"),") ",Se.element("i",{className:"fa fa-question-circle",title:"Users that have not blacklisted you, but there is not enough information to know if they have whitelisted you"}))},{size:"fill",value:Se.element("fragment",null,Se.element("i",{className:"fa fa-question"})," Unknown (",Se.element("span",{ref:e=>this.unknownCount=e},"0"),") ",Se.element("i",{className:"fa fa-question-circle",title:r.B?"There is not enough information to know if these users have whitelisted or blacklisted you":"There is not enough information to know if these users have whitelisted you"}))},{size:"fill",value:Se.element("fragment",null,Se.element("i",{className:"fa fa-times"})," Not Found (",Se.element("span",{ref:e=>this.nonexistentCount=e},"0"),") ",Se.element("i",{className:"fa fa-question-circle",title:"These users were not found (most likely they changed usernames or deleted their account)"}))}]]),r.B||this.table.hideColumns(2,4),this.table.table.style.minWidth="1200px",i.Results.appendChild(this.table.table),t.addEventListener("click",()=>{if(t.getAttribute("data-mm")){if(!d.get("wbc_checkSelected")){if(d.get("wbc_checkSingle")&&a){let e=Ar(a.container,"afterbegin",[{attributes:{class:"esgst-bold esgst-red"},text:"Disable this --\x3e",type:"span"}]);window.setTimeout(()=>e.remove(),5e3)}else if(d.get("wbc_checkAll")){let e=Ar(s.container,"afterbegin",[{attributes:{class:"esgst-bold esgst-red"},text:"Disable this --\x3e",type:"span"}]);window.setTimeout(()=>e.remove(),5e3)}else if(d.get("wbc_checkPages")){let e=Ar(n.container,"afterbegin",[{attributes:{class:"esgst-bold esgst-red"},text:"Disable this --\x3e",type:"span"}]);window.setTimeout(()=>e.remove(),5e3)}let e=Ar(u.container,"afterbegin",[{attributes:{class:"esgst-bold esgst-red"},text:"Enable this --\x3e",type:"span"}]);window.setTimeout(()=>e.remove(),5e3)}t.removeAttribute("data-mm")}r.popup=i,i.open(()=>{r.Update&&(r.ShowResults=!0,this.wbc_setCheck(r,()=>{r.progressBar.reset().hide()}))})})}async wbc_setCheck(e,t){let s,n,a;if(e.progressBar.setLoading(null).show(),e.overallProgressBar.reset().show(),this.whitelistedCount.textContent="0",this.blacklistedCount.textContent="0",this.noneCount.textContent="0",this.notBlacklistedCount.textContent="0",this.unknownCount.textContent="0",this.nonexistentCount.textContent="0",this.whitelistedRow=0,this.whitelistedColumn=0,this.blacklistedRow=0,this.blacklistedColumn=1,this.noneRow=0,this.noneColumn=2,this.notBlacklistedRow=0,this.notBlacklistedColumn=3,this.unknownRow=0,this.unknownColumn=4,this.nonexistentRow=0,this.nonexistentColumn=5,this.table.clear(),e.Users=[],e.Canceled=!1,e.Update){for(n in s=JSON.parse(Lr("users")),s.users)s.users.hasOwnProperty(n)&&s.users[n].wbc&&s.users[n].wbc.result&&(e.Users.push(s.users[n].username),s.users[n].username||dt.info(`Log for #1084: ${n}, ${JSON.stringify(s.users[n])}`));if(e.Users=l.sortArray(e.Users),e.ShowResults){for(n=0,a=e.Users.length;n<a;++n){if(l.isSet(e.Users[n])&&!s.users[s.steamIds[e.Users[n]]])continue;let t={steamId:s.steamIds[e.Users[n]],id:s.users[s.steamIds[e.Users[n]]].id,username:e.Users[n]};await this.wbc_setResult(e,t,s.users[s.steamIds[e.Users[n]]].wbc,s.users[s.steamIds[e.Users[n]]].notes,s.users[s.steamIds[e.Users[n]]].whitelisted,s.users[s.steamIds[e.Users[n]]].blacklisted,!1)}t()}else this.skip=tt.create({color:"green",icons:["fa-forward"],name:"Skip User",onClick:()=>{e.manualSkip=!0}}).insert(this.heading.nodes.outer,"beforeend"),this.wbc_checkUsers(e,0,e.Users.length,t)}else if(e.User&&d.get("wbc_checkSingle"))e.Users.push(e.User.Username),this.wbc_checkUsers(e,0,1,t);else{if(d.get("wbc_checkFromList"))e.Users=d.get("wbc_userList");else if(d.get("wbc_checkSelected"))e.Users=Array.from(c.esgst.mmWbcUsers);else if(!d.get("wbc_checkPages")){let t=c.esgst.pageOuterWrap.querySelectorAll('a[href*="/user/"]');for(let s of t){let t=s.getAttribute("href").match(/\/user\/(.+)/);if(!t)continue;let n=t[1];e.Users.indexOf(n)>-1||n===d.get("username")||n!==s.textContent||s.closest(".markdown")||e.Users.push(n)}}!d.get("wbc_checkAll")&&!d.get("wbc_checkPages")||(!e.User||d.get("wbc_checkSingle"))&&e.User||e.Update||window.location.pathname.match(/^\/(discussions|users|archive)/)?(this.skip=tt.create({color:"green",icons:["fa-forward"],name:"Skip User",onClick:()=>{e.manualSkip=!0}}).insert(this.heading.nodes.outer,"beforeend"),e.Users=l.sortArray(e.Users),window.location.pathname.match(/^\/users/)&&(e.Users=e.Users.slice(0,25)),this.wbc_checkUsers(e,0,e.Users.length,t)):(e.lastPage=d.get("wbc_checkPages")?"of "+d.get("wbc_maxPage"):"",this.wbc_getUsers(e,d.get("wbc_checkPages")?d.get("wbc_minPage")-1:0,c.esgst.currentPage,c.esgst.searchUrl,()=>{this.skip=tt.create({color:"green",icons:["fa-forward"],name:"Skip User",onClick:()=>{e.manualSkip=!0}}).insert(this.heading.nodes.outer,"beforeend"),e.Users=l.sortArray(e.Users),window.location.pathname.match(/^\/users/)&&(e.Users=e.Users.slice(0,25)),this.wbc_checkUsers(e,0,e.Users.length,t)}))}}async wbc_checkUsers(e,t,s,n){let a,i;if(!e.Canceled)if(e.overallProgressBar.setMessage(`${t} of ${s} users checked`),t<s){a=e.User&&d.get("wbc_checkSingle")?e.User:{Username:e.Users[t]};let o,r,l,c,g={steamId:a.SteamID64,id:a.ID,username:a.Username};const u=await Nr(null,g);u&&(o=u.notes,r=u.whitelisted,l=u.blacklisted,c=u.wbc),c&&c.result&&(i=c.result),e.manualSkip?(c||(c={}),window.setTimeout(()=>this.wbc_setResult(e,g,c,o,r,l,i!==c.result,t,s,n),0)):(c&&d.get("wbc_checkNew")||(c||(c={}),await this.wbc_checkUser(c,e,g)),window.setTimeout(()=>this.wbc_setResult(e,g,c,o,r,l,i!==c.result,t,s,n),0))}else n&&n()}async wbc_setResult(e,t,s,n,a,i,o,r,l,g){let u;const m=e.manualSkip||e.autoSkip;if(e.manualSkip=!1,e.autoSkip=!1,!e.Canceled){u="blacklisted"!==s.result&&"notBlacklisted"!==s.result||e.B?s.result:"unknown";const h={href:"/user/"+t.username};o&&(h.className="esgst-bold esgst-italic");let p=null;if(!m||"unknown"!==s.result&&"notBlacklisted"!==s.result){const e=s.wl_ga||s.g_wl_ga||s.ga;p=Se.element("div",null,Se.element("a",h,t.username),s.wl_ga||s.g_wl_ga||s.ga?Se.element("fragment",null," ",Se.element("a",{href:"/giveaway/"+(e.includes("/")?e:e+"/"),target:"_blank"},Se.element("i",{className:"fa fa-external-link",title:"Confirm"}))):null)}else p=Se.element("span",null,Se.element("a",h,t.username)," ",Se.element("i",{className:"fa fa-forward",title:"This user was skipped, so there may actually be enough information available."}));this[u+"Count"].textContent=parseInt(this[u+"Count"].textContent)+1;const f=this.table.addCell(this[u+"Row"],this[u+"Column"],{size:"fill",value:p});await c.common.endless_load(f),this[u+"Row"]+=1,e.ShowResults||(d.get("wbc_returnWhitelists")&&"whitelisted"===s.result&&!a||e.B&&d.get("wbc_returnBlacklists")&&"blacklisted"===s.result&&!i?(t.id||await Pr(t),this.wbc_returnWlBl(e,s,t.username,t.id,n,async(n,a)=>{n&&(t.values={wbc:s,whitelisted:!1,blacklisted:!1},a&&(t.values.notes=a),t.values[s.result]=!0,t.values[s.result+"Date"]=Date.now()),await Br(null,null,t),window.setTimeout(()=>this.wbc_checkUsers(e,++r,l,g),0)})):"whitelisted"===s.result||"blacklisted"===s.result||a||i?(t.values={wbc:s},await Br(null,null,t),window.setTimeout(()=>this.wbc_checkUsers(e,++r,l,g),0)):o?(t.values={wbc:null},await Br(null,null,t),window.setTimeout(()=>this.wbc_checkUsers(e,++r,l,g),0)):window.setTimeout(()=>this.wbc_checkUsers(e,++r,l,g),0))}}async wbc_returnWlBl(e,t,s,n,a,i){let o,r;if(!e.Canceled)if(o=t.result,r=o.match(/(.+)ed/)[1],e.progressBar.setMessage(`Returning ${r} for ${s}...`),window.location.pathname.match(new RegExp("^/user/"+s))){if(document.getElementsByClassName("sidebar__shortcut__"+r)[0].click(),d.get("wbc_n")){let e=`Returned ${r}.`;a=a?`${e}\n\n${a}`:e}i(!0,a)}else{var l;let e=!1;if("success"===(null===(l=(await Ne.post("/ajax.php",{data:`xsrf_token=${Be.xsrfToken}&do=${r}&child_user_id=${n}&action=insert`,queue:!0})).json)||void 0===l?void 0:l.type)&&(e=!0,d.get("wbc_n"))){let e=o+" in return.";a=a?`${e}\n\n${a}`:e}i(e,a)}}async wbc_checkUser(e,t,s){if(!t.Canceled&&!t.manualSkip){if(d.get("wbc_clearCache"))for(const t in e)e.hasOwnProperty(t)&&delete e[t];if(e.lastCheck||(e.lastCheck=0),e.timestamp||(e.timestamp=0),e.giveaway){const t=e.giveaway.match(/\/giveaway\/(.+?)\//);t&&(delete e.giveaway,e.ga=t[1])}if(e.whitelistGiveaway){const t=e.whitelistGiveaway.match(/\/giveaway\/(.+?)\//);t&&(delete e.whitelistGiveaway,e.wl_ga=t[1])}if(e.groupGiveaways){for(const t in e.groupGiveaways){const s=t.match(/^(.+?)\//);s&&(e.g_wl_gas||(e.g_wl_gas={}),e.g_wl_gas[s[1]]=e.groupGiveaways[t],delete e.groupGiveaways[t])}0===Object.keys(e.groupGiveaways).length&&delete e.groupGiveaways}Date.now()-e.lastCheck<=864e5&&!t.Update||((!d.get("wbc_checkBlacklist")||!t.B)&&(e.wl_ga||e.g_wl_ga)||d.get("wbc_checkBlacklist")&&t.B&&e.ga?(t.Timestamp=e.timestamp,await this.wbc_checkGiveaway(e,t,s,!0)):(t.Timestamp=0,await this.wbc_getGiveaways(e,t,s)))}}async wbc_checkGiveaway(e,t,s,n){if(t.Canceled)return;const a=e.wl_ga||e.g_wl_ga||e.ga;let i,o=(await Ne.get("/giveaway/"+(a.includes("/")?a:a+"/"),{queue:!0})).html.getElementsByClassName("table--summary")[0];if(o)o=o.textContent,o.match(/blacklisted the giveaway creator/)?(e.result="notBlacklisted",i=!0):o.match(/blacklisted by the giveaway creator/)?e.result="blacklisted":o.match(/not a member of the giveaway creator's whitelist/)?e.result="none":e.result="notBlacklisted",e.lastCheck=Date.now(),e.timestamp=t.Timestamp;else if(e.wl_ga)e.result="whitelisted",e.lastCheck=Date.now(),e.timestamp=t.Timestamp;else if(e.g_wl_ga){let a,i,o,r,l;for(a=!1,i=JSON.parse(Lr("groups","[]")),o=0,l=e.g_wl_gas[e.g_wl_ga].length;o<l&&!a;++o){for(r=i.length-1;r>-1&&i[r].code!==e.g_wl_gas[e.g_wl_ga][o];--r);r>-1&&i[r].member&&(a=!0)}a?n?(e.result="notBlacklisted",e.lastCheck=Date.now(),e.timestamp=t.Timestamp):(t.Timestamp=0,t.GroupGiveaways=[],await this.wbc_getGiveaways(e,t,s)):(e.result="whitelisted",e.lastCheck=Date.now(),e.timestamp=t.Timestamp)}else e.result="notBlacklisted",e.lastCheck=Date.now(),e.timestamp=t.Timestamp;return i}async wbc_getGiveaways(e,t,s){if(t.Canceled)return;let n=!1,a=!1,i=null,o=[],r=1;const l=`/user/${s.username}?format=json&page=`;do{if(i=await Ne.get(`${l}${r}`,{queue:!0}),!i.url.includes("/user/")||!i.json.success){n=!0;break}o=i.json.results,s.steamId=i.json.user.steam_id,s.id=i.json.user.id,t.progressBar.setMessage(`Retrieving ${s.username}'s giveaways (page ${r})...`);const c=[],g=Date.now();for(const s of o){if(!s.link)continue;if(0===t.Timestamp){const e=1e3*s.end_timestamp;e<g&&(t.Timestamp=e)}const n=s.link.split("/giveaway/")[1];e.ga||(e.ga=n),s.whitelist&&(s.group?c.push(n):e.wl_ga=n)}let u=!1;if(e.ga&&!a&&(a=!0,u=await this.wbc_checkGiveaway(e,t,s),"notBlacklisted"!==e.result||u||d.get("wbc_checkBlacklist")&&t.B))break;if(u=!1,e.wl_ga){await this.wbc_checkGiveaway(e,t,s),u=!0;break}if(e.g_wl_gas&&Object.keys(e.g_wl_gas).length||c.length){if(c.length){if(await this.wbc_getGroupGiveaways(e,c,t,s))break}const n=JSON.parse(Lr("groups","[]"));let a=!1;for(const t in e.g_wl_gas)if(e.g_wl_gas.hasOwnProperty(t)){a=!1;const s=e.g_wl_gas[t],i=s.length;for(let e=0;e<i&&!a;e++)a=n.filter(t=>t.code===s[e]&&t.member)[0];if(!a){e.g_wl_ga=t;break}}if(!a){e.result="whitelisted";break}}r+=1,t.autoSkip=d.get("wbc_skipUsers")&&r>d.get("wbc_pages")}while(!t.Canceled&&!t.manualSkip&&!t.autoSkip&&(t.Timestamp>=e.timestamp||0===t.Timestamp)&&o.length===i.json.per_page);!n&&(e.ga||e.wl_ga||e.g_wl_ga)||(e.lastCheck=Date.now(),e.result=n?"nonexistent":"unknown",e.timestamp=t.Timestamp)}async wbc_getGroupGiveaways(e,t,s,n){const a=t.length;for(let i=0;i<a;i++){const o=t[i];if(s.progressBar.setMessage(`Retrieving ${n.username}'s group giveaways (${i+1} of ${a})...`),e.groupGiveaways&&e.groupGiveaways[o])continue;const r=await this.wbc_getGroups(e,o,s);if(r)return r;if(s.Canceled)break}return!1}async wbc_getGroups(e,t,s){let n=`/giveaway/${t.includes("/")?t:t+"/_"}/groups/search?page=`;do{const s=await Ne.get(n+"1",{queue:!0}),a=s.html,i=a.getElementsByClassName("table__column__heading"),o=i.length;if(o<1)return e.result="none",!0;e.g_wl_gas||(e.g_wl_gas={}),e.g_wl_gas[t]||(e.g_wl_gas[t]=[]);for(let s=0;s<o;s++){const n=i[s].getAttribute("href").match(/\/group\/(.+?)\//)[1];e.g_wl_gas[t].indexOf(n)<0&&e.g_wl_gas[t].push(n)}const r=a.getElementsByClassName("pagination__navigation")[0];if(!r||r.lastElementChild.classList.contains("is-selected"))return!1;n=s.url+"/search?page="}while(!s.Canceled);return!1}async wbc_getUsers(e,t,s,n,a,i){let o,r,l,g,u,m;if(!e.Canceled)if(i){for(e.lastPage||(e.lastPage=c.esgst.modules.generalLastPageLink.lpl_getLastPage(i,!0),e.lastPage=999999999===e.lastPage?"":" of "+e.lastPage),e.progressBar.setMessage(`Retrieving users (page ${t}${e.lastPage})...`),o=i.querySelectorAll('a[href*="/user/"]'),r=0,l=o.length;r<l;++r)g=o[r].getAttribute("href").match(/\/user\/(.+)/),g&&(u=g[1],e.Users.indexOf(u)<0&&u!==e.Username&&u===o[r].textContent&&!o[r].closest(".markdown")&&e.Users.push(u));m=i.getElementsByClassName("pagination__navigation")[0],m&&!m.lastElementChild.classList.contains("is-selected")?window.setTimeout(()=>this.wbc_getUsers(e,t,s,n,a),0):a()}else e.Canceled||(t+=1,!d.get("wbc_checkPages")||t<=d.get("wbc_maxPage")?s!==t?window.setTimeout(async()=>this.wbc_getUsers(e,t,s,n,a,(await Ne.get(`${n}${t}`,{queue:!0})).html),0):window.setTimeout(()=>this.wbc_getUsers(e,t,s,n,a,c.esgst.pageOuterWrap),0):a())}},Gr=hs.createElements.bind(hs),qr=hs.getFeatureTooltip.bind(hs),Rr=hs.getTimestamp.bind(hs);const Mr=new class extends gt{constructor(){super(),this.info={description:()=>Se.element("ul",null,Se.element("li",null,"Adds an icon (",Se.element("i",{className:"fa fa-heart esgst-whitelist"})," if the user is whitelisted and ",Se.element("i",{className:"fa fa-ban esgst-blacklist"})," if they are blacklisted) next to the a user's username (in any page) to indicate that they are on your whitelist/blacklist."),Se.element("li",null,"If you hover over the icon, it shows the date when you added the user to your whitelist/blacklist.")),features:{wbh_b:{colors:!0,description:()=>Se.element("ul",null,Se.element("li",null,"Adds a background color of your own preference to the user's username if they are blacklisted, instead of an icon."),Se.element("li",null,"If you hover over the username, it shows the date when you added the user to your whitelist/blacklist.")),name:"Use background colors for blacklisted users instead of icons.",sg:!0,st:!0},wbh_w:{colors:!0,description:()=>Se.element("ul",null,Se.element("li",null,"Adds a background color of your own preference to the user's username if they are whitelisted, instead of an icon."),Se.element("li",null,"If you hover over the username, it shows the date when you added the user to your whitelist/blacklist.")),name:"Use background colors for whitelisted users instead of icons.",sg:!0,st:!0}},id:"wbh",name:"Whitelist/Blacklist Highlighter",sg:{include:[{enabled:1,pattern:".*"}],exclude:[{enabled:1,pattern:"^/account/manage/whitelist"},{enabled:1,pattern:"^/account/manage/blacklist"}]},st:!0,sync:"Blacklist, Whitelist",syncKeys:["Blacklist","Whitelist"],type:"users",featureMap:{user:this.wbh_getUsers.bind(this)}}}wbh_getUsers(e){for(const t of e)if(t.saved&&(t.saved.whitelisted||t.saved.blacklisted)&&!t.context.parentElement.querySelector(".esgst-wbh-highlight, .esgst-wbh-icon")){let[e,s]=t.saved.whitelisted?["fa-heart sidebar__shortcut__whitelist","whitelisted"]:["fa-ban sidebar__shortcut__blacklist","blacklisted"],n=`You ${s} ${t.username} on ${Rr(t.saved[s+"Date"])}`;d.get("wbh_w")&&t.saved.whitelisted||d.get("wbh_b")&&t.saved.blacklisted?(t.element.classList.add("esgst-wbh-highlight","esgst-wbh-highlight-"+s),t.element.title=qr("wbh",n)):Gr(t.context,"beforebegin",[{attributes:{class:"esgst-wbh-icon esgst-user-icon",title:qr("wbh",n)},type:"span",children:[{attributes:{class:`fa ${e} esgst-${s.slice(0,-2)}`},type:"i"}]}])}}},Or=hs.createElements.bind(hs),Ur=hs.createHeadingButton.bind(hs),Fr=hs.endless_load.bind(hs),$r=hs.getTimestamp.bind(hs),Wr=hs.getValue.bind(hs),Vr=hs.setValue.bind(hs);const jr=new class extends gt{constructor(){super(),this.info={description:()=>Se.element("ul",null,Se.element("li",null,"Adds 2 buttons (",Se.element("i",{className:"fa fa-sort-amount-asc"})," to sort in ascending order and"," ",Se.element("i",{className:"fa fa-sort-amount-desc"})," to sort in descending order) to the main page heading of your"," ",Se.element("a",{href:"https://www.steamgifts.com/account/manage/whitelist"},"whitelist"),"/",Se.element("a",{href:"https://www.steamgifts.com/account/manage/blacklist"},"blacklist")," pages that allow you to view all of the users in your whitelist/blacklist at once sorted by added date.")),id:"wbs",name:"Whitelist/Blacklist Sorter",sg:!0,sync:"Blacklist, Whitelist",syncKeys:["Blacklist","Whitelist"],type:"users"}}init(){if(!c.esgst.whitelistPath&&!c.esgst.blacklistPath)return;let[e,t,s]=c.esgst.whitelistPath?["whitelistedDate","whitelist","whitelisted"]:["blacklistedDate","blacklist","blacklisted"],n={dateKey:e,icon:"fa-sort-amount-asc",key:t,saveKey:s,title:`Oldest to newest ${s} users:`};Ur({featureId:"wbs",id:"wbsAsc",icons:["fa-sort-amount-asc"],title:"Sort by added date from oldest to newest"}).addEventListener("click",this.wbs_sort.bind(this,n)),n={dateKey:e,icon:"fa-sort-amount-desc",isDescending:!0,key:t,saveKey:s,title:`Newest to oldest ${s} users:`},Ur({featureId:"wbs",id:"wbsDesc",icons:["fa-sort-amount-desc"],title:"Sort by added date from newest to oldest"}).addEventListener("click",this.wbs_sort.bind(this,n))}async wbs_sort(e){let t=JSON.parse(Wr("users")).users,s=[];for(let n in t)if(t.hasOwnProperty(n)){let a=t[n];if(!a[e.saveKey])continue;a.steamId=n,s.push(a)}s=l.sortArray(s,e.isDescending,e.dateKey);let n=new lt({addScrollable:!0,icon:e.icon,isTemp:!0,title:e.title});n.popup.classList.add("esgst-wbs-popup");let a=Or(n.scrollable,"beforeend",[{attributes:{class:"esgst-text-left table"},type:"div",children:[{attributes:{class:"table__heading"},type:"div",children:[{attributes:{class:"table__column--width-fill"},text:"User",type:"div"},{attributes:{class:"table__column--width-small text-center"},text:"Added",type:"div"},{attributes:{class:"table__column--width-small text-center"},text:"Remove",type:"div"}]},{attributes:{class:"table__rows"},type:"div"}]}]),i=a.lastElementChild;s.forEach(t=>{let s=Or(i,"beforeend",[{attributes:{class:"table__row-outer-wrap"},type:"div",children:[{attributes:{class:"table__row-inner-wrap"},type:"div",children:[{attributes:{class:"table__column--width-fill"},type:"div",children:[{attributes:{class:"table__column__heading",href:"/user/"+t.username},text:t.username,type:"a"}]},{attributes:{class:"table__column--width-small text-center"},text:$r(t[e.dateKey]),type:"div"},{attributes:{class:"table__column--width-small text-center"},type:"div",children:[{attributes:{class:"table__remove-default esgst-clickable"},type:"div",children:[{attributes:{class:"icon-red fa fa-times-circle"},type:"i"},{attributes:{class:"table__column__secondary-link"},text:"Remove",type:"span"}]},{attributes:{class:"table__remove-loading esgst-hidden"},type:"div",children:[{attributes:{class:"fa fa-refresh fa-spin"},type:"i"},{text:" Removing",type:"node"}]},{attributes:{class:"table__remove-complete esgst-hidden"},type:"div",children:[{attributes:{class:"fa fa-times-circle"},type:"i"},{text:" Removed",type:"node"}]}]}]}]}]),n={dateKey:e.dateKey,key:e.key,saveKey:e.saveKey,user:t};n.removeButton=s.firstElementChild.lastElementChild.firstElementChild,n.removingButton=n.removeButton.nextElementSibling,n.removedButton=n.removingButton.nextElementSibling,n.removeButton.addEventListener("click",this.wbs_removeMember.bind(this,n))}),n.open(),Fr(a)}async wbs_removeMember(e){e.removeButton.classList.add("esgst-hidden"),e.removingButton.classList.remove("esgst-hidden"),await Ne.post("/ajax.php",{data:`xsrf_token=${Be.xsrfToken}&do=${e.key}&action=delete&child_user_id=${e.user.id}`});const t=new Te("user",{threshold:300});await t.lock();let s=JSON.parse(Wr("users"));delete s.users[e.user.steamId][e.dateKey],delete s.users[e.user.steamId][e.saveKey],await Vr("users",JSON.stringify(s)),await t.unlock(),e.removingButton.classList.add("esgst-hidden"),e.removedButton.classList.remove("esgst-hidden")}},Hr=hs.createConfirmation.bind(hs),Jr=hs.createElements.bind(hs),Yr=hs.createFadeMessage.bind(hs),Kr=hs.createHeadingButton.bind(hs),zr=hs.downloadFile.bind(hs),Qr=hs.formatTags.bind(hs),Zr=hs.setSetting.bind(hs);const Xr=new class extends gt{constructor(){super(),this.info={description:()=>Se.element("ul",null,Se.element("li",null,"Adds a button (",Se.element("i",{className:"fa fa-arrow-up"})," ",Se.element("i",{className:"fa fa-arrow-down"})," ",Se.element("i",{className:"fa fa-trash"}),") to the main page heading of your"," ",Se.element("a",{href:"https://www.steamgifts.com/account/manage/whitelist"},"whitelist"),"/",Se.element("a",{href:"https://www.steamgifts.com/account/manage/blacklist"},"blacklist")," pages that allows you to import/export/clear your whitelist/blacklist.")),id:"wbm",name:"Whitelist/Blacklist Manager",sg:!0,type:"users"}}init(){if(!c.esgst.whitelistPath&&!c.esgst.blacklistPath)return;let e={};c.esgst.whitelistPath?(e.key="whitelist",e.name="Whitelist"):(e.key="blacklist",e.name="Blacklist"),e.button=Kr({id:"wbm",icons:["fa-arrow-up","fa-arrow-down","fa-trash"],title:"Manage "+e.key}),e.button.addEventListener("click",this.wbm_openPopup.bind(this,e))}wbm_openPopup(e){if(!e.popup){e.popup=new lt({addScrollable:!0,icon:"fa-gear",title:`Manage ${e.name}:`});const t=new vt(e.popup.description,"wbm_useCache",!1,"Use cache.",!1,!1,"Uses the cache created the last time you synced your whitelist/blacklist. This speeds up the process, but could lead to incomplete results if your cache isn't up-to-date.",d.get("wbm_useCache")),s=new vt(e.popup.description,"wbm_exportSteamIds",!1,"Export Steam IDs.",!1,!1,"When exporting the whitelist/blacklist, the Steam IDs of the users will be exported instead of their SteamGifts IDs. This is useful, for example, for blocking / unblocking the users on Steam with the Steam IDs.",d.get("wbm_exportSteamIds"));t.dependencies.push(s.container),d.get("wbm_useCache")||s.container.classList.add("esgst-hidden"),new vt(e.popup.description,"wbm_clearTags",!1,Se.element("fragment",null,"Only clear users who are tagged with these specific tags (separate with comma):"," ",Se.element("input",{className:"esgst-switch-input esgst-switch-input-large",type:"text",value:d.get("wbm_tags").join(", ")})),!1,!1,"Uses the User Tags database to remove only users with the specified tags.",d.get("wbm_clearTags")).name.firstElementChild.addEventListener("change",e=>{let t=e.currentTarget.value.replace(/(,\s*)+/g,Qr).split(", ");Zr("wbm_tags",t)}),e.input=Jr(e.popup.description,"beforeend",[{attributes:{type:"file"},type:"input"}]),e.message=Jr(e.popup.description,"beforeend",[{attributes:{class:"esgst-description"},type:"div"}]),e.warning=Jr(e.popup.description,"beforeend",[{attributes:{class:"esgst-description esgst-warning"},type:"div"}]),tt.create([{color:"green",icons:["fa-arrow-up"],name:"Import",onClick:()=>new Promise(t=>this.wbm_start(e,this.wbm_importList.bind(this,e),t))},{template:"error",name:"Cancel",switchTo:{onReturn:0},onClick:this.wbm_cancel.bind(this,e)}]).insert(e.popup.description,"beforeend"),tt.create([{color:"green",icons:["fa-arrow-down"],name:"Export",onClick:()=>new Promise(t=>this.wbm_start(e,this.wbm_exportList.bind(this,e,[],1),t))},{template:"error",name:"Cancel",switchTo:{onReturn:0},onClick:this.wbm_cancel.bind(this,e)}]).insert(e.popup.description,"beforeend"),tt.create([{color:"green",icons:["fa-trash"],name:"Clear",onClick:()=>new Promise(t=>this.wbm_start(e,this.wbm_clearList.bind(this,e,[],1),t))},{template:"error",name:"Cancel",switchTo:{onReturn:0},onClick:this.wbm_cancel.bind(this,e)}]).insert(e.popup.description,"beforeend"),e.results=Jr(e.popup.scrollable,"beforeend",[{type:"div"}])}e.popup.open()}wbm_start(e,t,s){Hr("Are you sure you want to do this?",()=>{e.isCanceled=!1,e.button.classList.add("esgst-busy"),e.usernames=[],e.results.innerHTML="",t(this.wbm_complete.bind(this,e,s))},s)}wbm_complete(e,t){e.button.classList.remove("esgst-busy"),t()}wbm_cancel(e){e.isCanceled=!0,e.button.classList.remove("esgst-busy")}wbm_importList(e,t){let s=e.input.files[0];if(s){let n=new FileReader;n.onload=()=>{try{let s=JSON.parse(n.result);this.wbm_insertUsers(e,s,0,s.length,t)}catch(s){Yr(e.warning,"Cannot parse file!"),t()}},n.readAsText(s)}else Yr(e.warning,"No file was loaded!"),t()}async wbm_insertUsers(e,t,s,n,a){e.isCanceled||(Jr(e.message,"atinner",[{attributes:{class:"fa fa-circle-o-notch fa-spin"},type:"i"},{text:`Importing list (${s} of ${n})...`,type:"span"}]),s<n?(await Ne.post("/ajax.php",{data:`xsrf_token=${Be.xsrfToken}&do=${e.key}&action=insert&child_user_id=${t[s]}`}),window.setTimeout(()=>this.wbm_insertUsers(e,t,++s,n,a),0)):(Yr(e.message,"List imported with success!"),a()))}async wbm_exportList(e,t,s,n){if(!e.isCanceled)if(d.get("wbm_useCache")){const s=d.get("wbm_exportSteamIds");for(const n in c.esgst.users.users)c.esgst.users.users.hasOwnProperty(n)&&c.esgst.users.users[n][e.key+"ed"]&&t.push(s?n:c.esgst.users.users[n].id);zr(JSON.stringify(t),`esgst_${e.key}_${(new Date).toISOString()}.json`),Yr(e.message,"List exported with success!"),n()}else{let a,i,o,r,l;for(Jr(e.message,"atinner",[{attributes:{class:"fa fa-circle-o-notch fa-spin"},type:"i"},{text:`Retrieving list (page ${s})...`,type:"span"}]),l=(await Ne.get(`https://www.steamgifts.com/account/manage/${e.key}/search?page=${s}`)).html,a=l.querySelectorAll('[name="child_user_id"]'),i=0,o=a.length;i<o;++i)t.push(a[i].value);r=l.getElementsByClassName("pagination__navigation")[0],r&&!r.lastElementChild.classList.contains("is-selected")?window.setTimeout(()=>this.wbm_exportList(e,t,++s,n),0):(zr(JSON.stringify(t),`esgst_${e.key}_${(new Date).toISOString()}.json`),Yr(e.message,"List exported with success!"),n())}}async wbm_clearList(e,t,s,n){if(!e.isCanceled)if(d.get("wbm_useCache")){let s;for(s in c.esgst.users.users)if(c.esgst.users.users.hasOwnProperty(s)){let n=c.esgst.users.users[s];if(n[e.key+"ed"])if(d.get("wbm_clearTags")){if(n.tags){let s;for(s=n.tags.length-1;s>-1&&d.get("wbm_tags").indexOf(n.tags[s])<0;--s);s>-1&&(t.push(n.id),e.usernames.push(n.username))}}else t.push(n.id)}this.wbm_deleteUsers(e,t,0,t.length,n)}else{let a,i,o,r,l,g;for(Jr(e.message,"atinner",[{attributes:{class:"fa fa-circle-o-notch fa-spin"},type:"i"},{text:`Retrieving list (page ${s})...`,type:"span"}]),g=(await Ne.get(`https://www.steamgifts.com/account/manage/${e.key}/search?page=${s}`)).html,i=g.querySelectorAll('[name="child_user_id"]'),o=0,r=i.length;o<r;++o)if(a=i[o],d.get("wbm_clearTags")){let s,n;if(n=a.closest(".table__row-inner-wrap").getElementsByClassName("table__column__heading")[0].textContent,s=c.esgst.users.steamIds[n],s){let i=c.esgst.users.users[s];if(i.tags){let s;for(s=i.tags.length-1;s>-1&&d.get("wbm_tags").indexOf(i.tags[s])<0;--s);s>-1&&(t.push(a.value),e.usernames.push(n))}}}else t.push(a.value);l=g.getElementsByClassName("pagination__navigation")[0],l&&!l.lastElementChild.classList.contains("is-selected")?window.setTimeout(()=>this.wbm_clearList(e,t,++s,n),0):this.wbm_deleteUsers(e,t,0,t.length,n)}}async wbm_deleteUsers(e,t,s,n,a){e.isCanceled||(Jr(e.message,"atinner",[{attributes:{class:"fa fa-circle-o-notch fa-spin"},type:"i"},{text:`Clearing list (${s} of ${n})...`,type:"span"}]),s<n?(await Ne.post("/ajax.php",{data:`xsrf_token=${Be.xsrfToken}&do=${e.key}&action=delete&child_user_id=${t[s]}`}),window.setTimeout(()=>this.wbm_deleteUsers(e,t,++s,n,a),0)):(Yr(e.message,"List cleared with success!"),Jr(e.results,"atinner",[{attributes:{class:"esgst-bold"},text:`Users cleared (${e.usernames.length}):`,type:"span"},{attributes:{class:"esgst-popup-actions"},type:"span"}]),e.usernames.forEach(t=>{Jr(e.results.lastElementChild,"beforeend",[{attributes:{href:"/user/"+t},text:t,type:"a"}])}),a()))}};const el=new class extends gt{constructor(){super(),this.info={description:()=>Se.element("ul",null,Se.element("li",null,'Redirects broken URLs to the correct URLs. For example, "/giveaway/XXXXX" redirects to "/giveaway/XXXXX/".')),id:"urlr",name:"URL Redirector",sg:!0,st:!0,type:"general"}}};const tl=new class extends Xa{constructor(){super("ut"),this.info={description:()=>Se.element("ul",null,Se.element("li",null,"Adds a button (",Se.element("i",{className:"fa fa-tag"}),") next a user's username (in any page) that allows you to save tags for the user (only visible to you)."),Se.element("li",null,"You can press Enter to save the tags."),Se.element("li",null,"Each tag can be colored individually."),Se.element("li",null,"There is a button (",Se.element("i",{className:"fa fa-list"}),") in the tags popup that allows you to view a list with all of the tags that you have used ordered from most used to least used."),Se.element("li",null,"Adds a button (",Se.element("i",{className:"fa fa-user"})," ",Se.element("i",{className:"fa fa-tags"}),") to the page heading of this menu that allows you to manage all of the tags that have been saved."),Se.element("li",null,"This feature is recommended for cases where you want to associate a short text with a user, since the tags are displayed next to their username.For a long text, check",Se.element("span",{"data-esgst-feature-id":"un"}),".")),features:{ut_s:{name:"Show tag suggestions while typing.",sg:!0,st:!0}},id:"ut",name:"User Tags",sg:!0,st:!0,type:"users"}}init(){c.esgst.userFeatures.push(this.tags_addButtons.bind(this)),this.tags_getTags()}};const sl=new class extends gt{constructor(){super(),this.info={description:()=>Se.element("ul",null,Se.element("li",null,"Adds an icon (",Se.element("i",{className:"fa fa-user"}),") next to the a user's username (in any page) to indicate that they are on your Steam friends list."),Se.element("li",null,"If you hover over the icon, it shows the date when you became friends.")),id:"sfi",inputItems:[{id:"sfi_icon",prefix:"Icon: "}],name:"Steam Friends Indicator",sg:!0,st:!0,sync:"Steam Friends",syncKeys:["SteamFriends"],type:"users",featureMap:{user:this.addIcons.bind(this)}}}addIcons(e){for(const t of e)t.saved&&t.saved.steamFriend&&!t.context.parentElement.querySelector(".esgst-sfi-icon")&&Se.insert(t.context,"afterend",Se.element("span",{className:"esgst-sfi-icon esgst-user-icon",title:c.common.getFeatureTooltip("sfi",`You have been friends with ${t.username} on Steam since ${c.common.getTimestamp(1e3*t.saved.steamFriend)}`)},Se.element("i",{className:"fa fa-"+d.get("sfi_icon")})))}};Math.pow(10,8);function nl(e,t){return k(2,arguments),A(e).getTime()-A(t).getTime()}var al={ceil:Math.ceil,round:Math.round,floor:Math.floor,trunc:function(e){return e<0?Math.ceil(e):Math.floor(e)}};function il(e){return e?al[e]:al.trunc}const ol=new class extends gt{constructor(){super(),this.info={description:()=>Se.element("ul",null,Se.element("li",null,'Replaces a timestamp (in any page) with an accurate timestamp. For example, "2 hours ago" becomes "Jan 1, 2017, 0:00:00 - 2 hours ago".'),Se.element("li",null,"Here are some format examples:"),Se.element("ul",null,Se.element("li",null,"Jan 1, 2017 - MMM d, yyyy"),Se.element("li",null,"Jan 01, 2017 - MMM dd, yyyy"),Se.element("li",null,"01/01/2017 - dd/MM/yyyy"),Se.element("li",null,"2017/01/01 - yyyy/MM/dd"),Se.element("li",null,"6:00 - H:mm"),Se.element("li",null,"6:00 AM - h:mm a"),Se.element("li",null,"06:00 - HH:mm"),Se.element("li",null,"06:00:00 - HH:mm:ss")),Se.element("li",null,'If you don\'t want the day and month to be shown when the difference is less than 24 hours, delimit them with "DM{}" in the format. For example, let\'s suppose that it\'s currently January 1, 2017, 06:00:00, and that the format is "MMM d, HH:mm:ss". Let\'s use the timestamp "Jan 1, 12:00:00" as an example. That\'s a less than 24 hours difference, so if the format was changed to "DM{MMM d, }HH:mm:ss", the timestamp would be just "12:00:00".'),Se.element("li",null,'If you don\'t want the year to be shown when it\'s the current year, delimit it with "Y{}" in the format. For example, let\'s suppose that it\'s currently January 1, 2017, 06:00:00, and that the format is "MMM d, yyyy, HH:mm:ss". Let\'s use the timestamp "Jan 1, 2017, 12:00:00" as an example. That\'s the current year, so if the format was changed to "MMM d, Y{yyyy }HH:mm:ss", the timestamp would be just "Jan 1, 12:00:00".'),Se.element("li",null,'If you don\'t want the seconds to be shown when they are equal to 0, delimit them with "S{}" in the format. For example, let\'s suppose that it\'s currently January 1, 2017, 06:30:00, and that the format is "MMM d, yyyy, HH:mm:ss". The timestamp would be "Jan 1, 2017, 06:30:00". The seconds are equal to 0, so if the format was changed to "MMM d, yyyy HH:mmS{:ss}", the timestamp would be just "Jan 1, 2017, 06:30".'),Se.element("li",null,"And of course, you can combine the three, for example: DM{MMM d, }Y{yyyy }HH:mmS{:ss}")),features:{at_t:{name:"Apply format to SteamGifts' date tooltips.",sg:!0}},id:"at",name:"Accurate Timestamp",inputItems:[{id:"at_format",prefix:"Timestamp format: ",tooltip:"For the date templates, ESGST uses date-fns v2.0.0-alpha.25, so check the accepted tokens here: https://date-fns.org/v2.0.0-alpha.25/docs/Getting-Started."}],sg:!0,st:!0,type:"general"}}init(){if(d.get("at_t")){const e=document.createElement("script");e.textContent='\n\t\t\t\tif (document.readyState === "complete") {\n\t\t\t\t\tesgst_at_t();\n\t\t\t\t} else {\n\t\t\t\t\t$(window).on("load", function () {\n\t\t\t\t\t\tesgst_at_t();\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\tfunction esgst_at_t() {\n\t\t\t\t\t$(document).off("mouseenter", "[data-timestamp]");\n\t\t\t\t\t$(document).on("mouseenter", "[data-timestamp]", function() {\n\t\t\t\t\t\tvar e = $(this).attr("title");\n\t\t\t\t\t\tif (void 0 === e || !1 === e) {\n\t\t\t\t\t\t\t$(this).attr("data-ui-tooltip", \'{"rows":[{"icon" : [{"class" : "fa-clock-o", "color" : "#84cfda"}], "columns":[{"name" : "\' + $(this).attr("data-esgst-timestamp") + \'"}]}]}\');\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t',document.body.appendChild(e),e.remove()}this.esgst.endlessFeatures.push(this.at_getTimestamps.bind(this))}at_formatTimestamp(e){return xe(e,(d.get("at_format")||"MMM dd, yyyy, HH:mm:ss").replace(/DM\{(.+?)}/,Math.abs(function(e,t,s){k(2,arguments);var n=nl(e,t)/36e5;return il(null==s?void 0:s.roundingMethod)(n)}(Date.now(),e))<24?"":"$1").replace(/Y\{(.+?)}/,function(e,t){k(2,arguments);var s=A(e),n=A(t);return s.getFullYear()===n.getFullYear()}(Date.now(),e)?"":"$1").replace(/S\{(.+?)}/,0===new Date(e).getSeconds()?"":"$1"))}at_getTimestamps(e,t,s,n){let a,i,o,r,l,c,g,u;for(a=e.querySelectorAll(""+(n?`.esgst-es-page-${n} [data-timestamp], .esgst-es-page-${n}[data-timestamp]`:"[data-timestamp]")),i=0,o=a.length;i<o;++i)r=a[i],(!this.esgst.activeDiscussions||(!this.esgst.activeDiscussions.contains(r)||0!==d.get("adots_index"))&&this.esgst.activeDiscussions.contains(r))&&this.esgst.activeDiscussions||r.classList.contains("esgst-at")||(l=r.textContent,c=l.match(/\*/),g=1e3*parseInt(r.getAttribute("data-timestamp")),u=this.at_formatTimestamp(g),r.setAttribute("data-esgst-timestamp",u),l=c?` (Edited ${u})`:`${u} - ${l}`,r.classList.add("esgst-at"),r.textContent=l)}},rl=hs.createElements.bind(hs);const ll=new class extends gt{constructor(){super(),this.info={description:()=>Se.element("ul",null,Se.element("li",null,"Embeds any YouTube/Vimeo videos found in a comment (in any page) into the comment."),Se.element("li",null,'Videos are only embedded if their links are in the[URL](URL) format and are the only content in a line.For example, "[https://youtu.be/ihd9dKek2gc](https://youtu.be/ihd9dKek2gc)" gets embedded, but "[Watch this!](https://youtu.be/ihd9dKek2gc)" and "Watch this: [https://youtu.be/ihd9dKek2gc](https://youtu.be/ihd9dKek2gc)" do not.')),id:"ev",name:"Embedded Videos",sg:!0,st:!0,type:"general",featureMap:{endless:this.ev_getVideos.bind(this)}}}ev_getVideos(e,t,s,n){let a,i,o,r,l,c,d,g,u,m,h,p,f,b;for(a=["youtube.com","youtu.be","vimeo.com"],i=0,o=a.length;i<o;++i)for(r=a[i],l=e.querySelectorAll(""+(n?`.esgst-es-page-${n} a[href*="${r}"], .esgst-es-page-${n}a[href*="${r}"]`:`a[href*="${r}"]`)),c=0,d=l.length;c<d;++c)g=l[c],u=g.previousSibling,m=g.nextSibling,u&&u.textContent.trim()||m&&m.textContent.trim()||(p=g.getAttribute("href"),h=this.ev_getEmbedUrl(i,p),h&&(f=g.textContent,b=p!==f?`<div>${f}</div>`:"",rl(g,"atouter",[{type:"div",children:[{text:b,type:"node"},{attributes:{allowfullscreen:"0",frameborder:"0",height:"360",src:h,width:"640"},type:"iframe"}]}])))}ev_getEmbedUrl(e,t){let s,n,a,i,o,r;return s=[/youtube.com\/watch\?v=(.+?)(\/.*)?(&.*)?$/,/youtu.be\/(.+?)(\/.*)?$/,/vimeo.com\/(.+?)(\/.*)?$/],n=s[e],a=t.match(n),a?(i=["https://www.youtube.com/embed/","https://www.youtube.com/embed/","https://player.vimeo.com/video/"],o=i[e],r=a[1],`${o}${r}`):null}};const cl=new class extends gt{constructor(){super(),this.info={description:()=>Se.element("ul",null,Se.element("li",null,"Brings back image borders to SteamGifts.")),id:"ib",name:"Image Borders",sg:!0,type:"general",featureMap:{endless:this.ib_addBorders.bind(this)}}}ib_addBorders(e,t,s,n){const a=e.querySelectorAll(`${n?`.esgst-es-page-${n} .giveaway_image_avatar, .esgst-es-page-${n}.giveaway_image_avatar`:".giveaway_image_avatar"}, ${n?`.esgst-es-page-${n} .featured_giveaway_image_avatar, .esgst-es-page-${n}.featured_giveaway_image_avatar`:".featured_giveaway_image_avatar"}, ${n?`.esgst-es-page-${n} :not(.esgst-ggl-panel) .table_image_avatar, .esgst-es-page-${n}:not(.esgst-ggl-panel) .table_image_avatar`:":not(.esgst-ggl-panel) .table_image_avatar"}`);for(let e=0,t=a.length;e<t;++e)a[e].classList.add("esgst-ib-user");const i=e.querySelectorAll(`${n?`.esgst-es-page-${n} .giveaway_image_thumbnail, .esgst-es-page-${n}.giveaway_image_thumbnail`:".giveaway_image_thumbnail"}, ${n?`.esgst-es-page-${n} .giveaway_image_thumbnail_missing, .esgst-es-page-${n}.giveaway_image_thumbnail_missing`:".giveaway_image_thumbnail_missing"}, ${n?`.esgst-es-page-${n} .table_image_thumbnail, .esgst-es-page-${n}.table_image_thumbnail`:".table_image_thumbnail"}, ${n?`.esgst-es-page-${n} .table_image_thumbnail_missing, .esgst-es-page-${n}.table_image_thumbnail_missing`:".table_image_thumbnail_missing"}`);for(let e=0,t=i.length;e<t;++e)i[e].classList.add("esgst-ib-game")}};const dl=new class extends gt{constructor(){super(),this.info={conflicts:["ail"],description:()=>Se.element("ul",null,Se.element("li",null,'Displays all of the attached images (in any page) by default so that you do not need to click on "View attached image" to view them.')),features:{vai_gifv:{name:"Rename .gifv images to .gif so that they are properly attached.",sg:!0,st:!0}},id:"vai",name:"Visible Attached Images",sg:!0,st:!0,type:"general",featureMap:{endless:this.vai_getImages.bind(this)}}}vai_getImages(e,t,s,n){let a=e.querySelectorAll(`${n?`.esgst-es-page-${n} .comment__toggle-attached, .esgst-es-page-${n}.comment__toggle-attached`:".comment__toggle-attached"}, ${n?`.esgst-es-page-${n} .view_attached, .esgst-es-page-${n}.view_attached`:".view_attached"}`);for(let e=0,t=a.length;e<t;e++){let t=a[e].nextElementSibling.firstElementChild,s=t.getAttribute("src");s&&d.get("vai_gifv")&&(s=s.replace(/\.gifv/,".gif"),t.setAttribute("src",s)),t.classList.remove("is_hidden","is-hidden")}}};const gl=new class extends gt{constructor(){super(),this.info={conflicts:["vai"],description:()=>Se.element("ul",null,Se.element("li",null,'Only loads an attached image (in any page) when you click on its "View attached image" button, instead of loading it on page load, which should speed up page loads.')),id:"ail",name:"Attached Image Loader",sg:!0,st:!0,type:"general"}}init(){d.get("vai")||this.esgst.endlessFeatures.push(this.ail_getImages.bind(this))}ail_getImages(e,t,s,n){const a=e.querySelectorAll(`${n?`.esgst-es-page-${n} .comment__toggle-attached, .esgst-es-page-${n}.comment__toggle-attached`:".comment__toggle-attached"}, ${n?`.esgst-es-page-${n} .view_attached, .esgst-es-page-${n}.view_attached`:".view_attached"}`);for(let e=0,t=a.length;e<t;e++){const t=a[e],s=t.nextElementSibling.firstElementChild,n=s.getAttribute("src");s.removeAttribute("src"),t.addEventListener("click",s.setAttribute.bind(s,"src",n))}}};const ul=new class extends gt{constructor(){super(),this.currentId=null,this.created=null,this.entered=null,this.won=null,this.giveaways=null,this.info={description:()=>Se.element("ul",null,Se.element("li",null,"Adds more details to each giveaway in your"," ",Se.element("a",{href:"https://www.steamgifts.com/giveaways/created"},"created"),"/",Se.element("a",{href:"https://www.steamgifts.com/giveaways/entered"},"entered"),"/",Se.element("a",{href:"https://www.steamgifts.com/giveaways/won"},"won")," pages:"),Se.element("ul",null,Se.element("li",null,"How many points the giveaway is worth next to the game's name."),Se.element("li",null,"An icon (",Se.element("i",{className:"fa fa-steam"}),") next to the game's name that links to the game's Steam store page."),Se.element("li",null,"For the entered/won pages only, the creator's username next to the giveaway's end time."),Se.element("li",null,'A column "Type" containing the giveaway\'s type (public, invite only, group, whitelist or region restricted).'),Se.element("li",null,'A column "Level" containing the giveaway\'s level.'),Se.element("li",null,'For the created page only, a column "Winner(s)" containing the giveaway\'s winner(s) and how many of them have marked it as received/not received.'))),features:{cewgd_c:{name:"Enable for Created pages.",sg:!0,features:{cewgd_c_p:{name:"Points",sg:!0},cewgd_c_sl:{name:"Steam Link",sg:!0},cewgd_c_t:{name:"Type",sg:!0},cewgd_c_l:{name:"Level",sg:!0},cewgd_c_w:{name:"Winners",sg:!0}}},cewgd_e:{name:"Enable for Entered pages.",sg:!0,features:{cewgd_e_p:{name:"Points",sg:!0},cewgd_e_sl:{name:"Steam Link",sg:!0},cewgd_e_t:{name:"Type",sg:!0},cewgd_e_l:{name:"Level",sg:!0}}},cewgd_w:{name:"Enable for Won pages.",sg:!0,features:{cewgd_w_p:{name:"Points",sg:!0},cewgd_w_sl:{name:"Steam Link",sg:!0},cewgd_w_t:{name:"Type",sg:!0},cewgd_w_l:{name:"Level",sg:!0},cewgd_w_e:{name:"Entries",sg:!0}}}},id:"cewgd",name:"Created/Entered/Won Giveaway Details",sg:!0,type:"giveaways"}}init(){c.common.isCurrentPath("My Giveaways - Created")&&d.get("cewgd_c")?(this.currentId="cewgd_c",this.created=!0):c.common.isCurrentPath("My Giveaways - Entered")&&d.get("cewgd_e")?(this.currentId="cewgd_e",this.entered=!0):c.common.isCurrentPath("My Giveaways - Won")&&d.get("cewgd_w")&&(this.currentId="cewgd_w",this.won=!0),this.currentId&&(c.esgst.endlessFeatures.push(this.addHeading.bind(this)),c.esgst.giveawayFeatures.push((...e)=>this.getGiveaways(...e)))}addHeading(e,t,s,n){if(!t)return;const a=e.querySelector(c.common.getSelectors(n,["X.table__heading"]));if(!a||a.querySelector(".esgst-cewgd-heading"))return;const i=[];d.get(this.currentId+"_t")&&i.push(Se.element("div",{className:"table__column--width-small text-center esgst-cewgd-heading"},"Type")),d.get(this.currentId+"_l")&&i.push(Se.element("div",{className:"table__column--width-small text-center esgst-cewgd-heading"},"Level")),this.created&&d.get(this.currentId+"_w")&&i.push(Se.element("div",{className:"table__column--width-small text-center esgst-cewgd-heading"},"Winner(s)")),this.won&&d.get(this.currentId+"_e")&&i.push(Se.element("div",{className:"table__column--width-small text-center esgst-cewgd-heading"},"Entries")),Se.insert(a.firstElementChild,"afterend",Se.element("fragment",null,i))}async getGiveaways(e,t){if(!t)return;this.giveaways={};const s=[],n=Date.now();for(const t of e)s.push(this.getGiveaway(t,n));await Promise.all(s),await c.common.lockAndSaveGiveaways(this.giveaways),t&&c.esgst.gf&&c.esgst.gf.filteredCount&&d.get("gf_enable"+c.esgst.gf.type)&&c.esgst.modules.giveawaysGiveawayFilters.filters_filter(c.esgst.gf),!t&&c.esgst.gfPopup&&c.esgst.gfPopup.filteredCount&&d.get("gf_enable"+c.esgst.gfPopup.type)&&c.esgst.modules.giveawaysGiveawayFilters.filters_filter(c.esgst.gfPopup)}async getGiveaway(e,t){const s=c.esgst.giveaways[e.code];let n=!1;!e.deleted&&s&&s.gameSteamId&&Array.isArray(s.winners)&&(n=s.v!==c.esgst.CURRENT_GIVEAWAY_VERSION||!s.winners.length||s.winners.filter(e=>"Received"!==e.status&&"Not Received"!==e.status).length>0),this.created&&n?await this.fetchWinners(e,t):t-(s&&s.lastUpdate||0)<=6048e5&&(e.deleted||s&&s.gameSteamId&&(!this.won||s.creator!==d.get("username")))?this.addDetails(e,s):await this.fetchDetails(e,t)}async fetchDetails(e,t){const s=await Ne.get(e.url),n=await c.esgst.modules.giveaways.giveaways_get(s.html,!1,s.url);if(n.length>0){const s=n[0];s.lastUpdate=t,this.giveaways[e.code]=s,this.addDetails(e,s)}else this.addDetails(e)}async fetchWinners(e,t){let s=1,n=null,a=null;do{const t=await Ne.get(`${e.url}/winners/search?page=${s}`),i=t.html;if(!n){const e=await c.esgst.modules.giveaways.giveaways_get(i,!1,t.url);e.length>0&&(n=e[0],n.winners=[])}if(!n)return void this.addDetails(e);const o=i.querySelectorAll(".table__row-inner-wrap");for(const e of o)n.winners.push({status:e.lastElementChild.textContent.trim(),username:e.firstElementChild.nextElementSibling.firstElementChild.textContent.trim()});s+=1,a=i.querySelector(".pagination__navigation")}while(a&&!a.lastElementChild.classList.contains("is-selected"));n.lastUpdate=t,this.giveaways[e.code]=n,this.addDetails(e,n)}addDetails(e,t){if(!e.id){const s=e.name.match(/^\$(.+?)\sSteam\sGift\sCard$/);if(s)e.points=parseInt(s[1].replace(/,/g,"")),e.id="SteamGiftCard"+e.points,e.type="apps";else{e.name.match(/^Humble.+?Bundle/)?(e.id=e.name.replace(/\s/g,""),e.type="apps"):t&&t.gameSteamId&&t.gameType&&(e.id=t.gameSteamId,e.type=t.gameType)}}if(e.id){const t=c.esgst.games[e.type][e.id];if(t){const s=["hidden","ignored","noCV","owned","previouslyEntered","previouslyWon","reducedCV","wishlisted","previouslyWishlisted"];for(const n of s)t["previouslyEntered"===n?"entered":"previouslyWon"===n?"won":n]&&(e[n]=!0)}}if(!e.points)if(t)e.points=t.points;else if(e.id){const t=JSON.parse(r.get("gcCache","{}")),s=t&&t[e.type]&&t[e.type][e.id];s&&s.price>-1&&(e.points=s.price)}const s=[];d.get(this.currentId+"_p")&&s.push(Se.element("span",null,` (${t?e.points||0:"?"}P)`)),e.id&&d.get(this.currentId+"_sl")&&s.push(Se.element("a",{className:"giveaway__icon",href:`http://store.steampowered.com/${e.type.slice(0,-1)}/${e.id}`,target:"_blank"},Se.element("i",{className:"fa fa-steam"}))),Se.insert(e.headingName,"afterend",Se.element("fragment",null,s));for(const t of e.heading.children){if(t===e.headingName||t.classList.contains("giveaway__heading__name")||t.classList.contains("featured__heading__medium")){t.setAttribute("data-draggable-id","name");continue}if(t.textContent.match(/\(.+?\sCopies\)/)){t.setAttribute("data-draggable-id","copies");continue}if(t.textContent.match(/\(.+?P\)/)){t.setAttribute("data-draggable-id","points");continue}const s=t.getAttribute("href");if(s){if(s.match(/store.steampowered.com/)){t.setAttribute("data-draggable-id","steam");continue}s.match(/\/giveaways\/search/)&&t.setAttribute("data-draggable-id","search")}}t?(e.inviteOnly=t.inviteOnly,e.group=t.group,e.regionRestricted=t.regionRestricted,e.whitelist=t.whitelist,e.public=!e.inviteOnly&&!e.group&&!e.whitelist,e.level=t.level,e.entries||(e.entries=t.entries)):e.deleted?e.public=!1:e.blacklist=!0,e.creator=t&&t.creator||"-",e.creators.indexOf(e.creator.toLowerCase())<0&&e.creators.push(e.creator.toLowerCase()),(this.entered||this.won)&&Se.insert(e.endTimeColumn,"beforeend",Se.element("fragment",null," by ",t?Se.element("a",{className:"table__column__secondary-link",href:"/user/"+e.creator},e.creator):"?"));const n=[];if(d.get(this.currentId+"_t")){let t;t=e.deleted?"Deleted":e.blacklist?"Blacklist":e.inviteOnly?e.regionRestricted?"Invite + Region":"Invite":e.group?e.whitelist?e.regionRestricted?"Group + Whitelist + Region":"Group + Whitelist":e.regionRestricted?"Group + Region":"Group":e.whitelist?e.regionRestricted?"Whitelist + Region":"Whitelist":e.regionRestricted?"Region":e.public?"Public":"-",n.push(Se.element("div",{className:"table__column--width-small text-center"},t))}if(d.get(this.currentId+"_l")&&n.push(Se.element("div",{className:"table__column--width-small text-center"},t&&l.isSet(e.level)?e.level:"-")),this.created&&d.get(this.currentId+"_w")){let s;const a=t&&t.winners&&t.winners.length||0;if(a>0){s=[];const n=t.winners[0].username;if(s.push(Se.element("a",{className:"table__column__secondary-link",href:"/user/"+n},n)),a>1){s.push(Se.element("span",{className:"esgst-clickable table__column__secondary-link",onclick:this.openWinnersPopup.bind(this,t)}," ","(+",a-1," more)"));let n=0;for(const e of t.winners)"Received"===e.status&&(n+=1);e.innerWrap.lastElementChild.insertAdjacentText("beforeend",` (${n}/${a})`)}}else s="-";n.push(Se.element("div",{className:"table__column--width-small text-center"},s))}this.won&&d.get(this.currentId+"_e")&&n.push(Se.element("div",{className:"table__column--width-small text-center"},t&&l.isSet(e.entries)?e.entries:"-")),Se.insert(e.panel||e.innerWrap.querySelector(".table__column--width-fill"),"afterend",Se.element("fragment",null,n)),e.gwcContext&&(e.chancePerPoint=e.chance/Math.max(1,e.points),e.projectedChancePerPoint=e.projectedChance/Math.max(1,e.points),e.gwcContext.title=c.common.getFeatureTooltip("gwc",`Giveaway Winning Chance (${c.common.round(e.chancePerPoint,4)}% per point)`)),e.gptwContext&&c.esgst.modules.giveawaysGiveawayPointsToWin.gptw_addPoint(e),d.get("cgb")&&c.esgst.modules.giveawaysCustomGiveawayBackground.color([e]),e.group&&d.get("cl")&&d.get("ggl")&&c.esgst.modules.generalContentLoader.loadGiveawayGroups(!0,"ggl",[e])}openWinnersPopup(e){const t=new lt({icon:"fa-users",title:"Winners",addScrollable:"left"});let s=[];for(const t of e.winners){let e="";switch(t.status){case"Received":e="fa fa-check-circle esgst-green";break;case"Not Received":e="fa fa-times-circle esgst-red";break;case"Awaiting Feedback":e="fa fa-question-circle esgst-grey"}s.push(Se.element("div",{className:"table__row-outer-wrap"},Se.element("div",{className:"table__row-inner-wrap"},Se.element("div",{className:"table__column--width-small"},Se.element("a",{className:"table__column__secondary-link",href:"/user/"+t.username},t.username)),Se.element("div",{className:"table__column--width-small"},Se.element("i",{className:e})))))}let n=Se.element("fragment",null,Se.element("div",{className:"table__heading"},Se.element("div",{className:"table__column--width-small"},"Winner"),Se.element("div",{className:"table__column--width-small"},"Received")),Se.element("div",{className:"table__rows"},s));t.open(),c.common.endless_load(t.getScrollable(n))}},ml=hs.createConfirmation.bind(hs),hl=hs.createElements.bind(hs);const pl=new class extends gt{constructor(){super(),this.info={description:()=>Se.element("ul",null,Se.element("li",null,"Shows a confirmation popup if you try to delete a giveaway's key(s) (in any"," ",Se.element("a",{href:"https://www.steamgifts.com/giveaway/aeqw7/dead-space/winners"},"winners")," ","page).")),id:"dkc",name:"Delete Key Confirmation",sg:!0,type:"giveaways"}}init(){this.esgst.giveawayPath&&this.esgst.endlessFeatures.push(this.dkc_getLinks.bind(this))}dkc_getLinks(e,t,s,n){const a=e.querySelectorAll(""+(n?`.esgst-es-page-${n} .form__key-btn-delete, .esgst-es-page-${n}.form__key-btn-delete`:".form__key-btn-delete"));for(let e=a.length-1;e>-1;--e){const t=a[e],s=hl(t,"afterend",[{attributes:{class:"table__column__secondary-link esgst-clickable"},text:"Delete",type:"span"}]);t.remove(),s.addEventListener("click",ml.bind(hs,"Are you sure you want to delete this key?",this.dkc_deleteKey.bind(ml,s),null))}}async dkc_deleteKey(e){let t=e.closest(".table__row-inner-wrap");t.getElementsByClassName("form__key-read")[0].classList.add("is-hidden"),t.getElementsByClassName("form__key-loading")[0].classList.remove("is-hidden"),t.querySelector('[name="key_value"]').value="",t.getElementsByClassName("form__key-value")[0].textContent="",await Ne.post("/ajax.php",{data:`xsrf_token=${Be.xsrfToken}&do=set_gift_key&key_value=&winner_id=${t.querySelector('[name="winner_id"]').value}`}),t.getElementsByClassName("form__key-loading")[0].classList.add("is-hidden"),t.getElementsByClassName("form__key-insert")[0].classList.remove("is-hidden"),t.getElementsByClassName("js__sent-text")[0].textContent="Sent Gift",t.getElementsByClassName("js__sent-text")[1].textContent="Sent Gift"}},fl=hs.createElements.bind(hs),bl=hs.getFeatureTooltip.bind(hs);const wl=new class extends gt{constructor(){super(),this.info={description:()=>Se.element("ul",null,Se.element("li",null,"Adds an element (",Se.element("i",{className:"fa fa-area-chart"})," [Chance] %) below a giveaway's start time (in any page) that shows your chance of winning the giveaway."),Se.element("li",null,"The chance is calculated by rounding up (using 2 decimals) the result of the following formula: number_of_copies / number_of_entries * 100"),Se.element("li",null,"You can move the element around by dragging and dropping it.")),features:{gwc_e:{description:()=>Se.element("ul",null,Se.element("li",null,"The formula changes to: number_of_copies / (number_of_entries + 1) * 100"),Se.element("li",null,"For example, if a giveaway has 5 entries, the current chance of winning it is 20%, but after you enter it, it will have 6 entries, so the chance will decrease to 16.67%.")),name:"Show what the chance will be when you enter the giveaway instead of the current chance.",sg:!0},gwc_a:{description:()=>Se.element("ul",null,Se.element("li",null,"Uses an advanced formula (number_of_copies / (number_of_entries / time_open_in_milliseconds * duration_in_milliseconds) * 100) to calculate the chance based on how much time the giveaway has been open and the duration of the giveaway. This gives you an estimate of what the chance will be when the giveaway ends.")),features:{gwc_a_b:{name:'Show the basic chance along with the advanced one (the advanced chance will appear in a parenthesis, like "[Basic]% ([Advanced]%)").',sg:!0}},name:"Use advanced formula.",sg:!0},gwc_h:{conflicts:["gwr_h"],description:()=>Se.element("ul",null,Se.element("li",null,"Changes the color of the giveaway's title to the same color as the chance and adds a border of same color to the giveaway's game image.")),inputItems:[{id:"gwc_h_width",prefix:"Image Border Width: "}],name:"Highlight the giveaway.",sg:!0}},id:"gwc",name:"Giveaway Winning Chance",sg:!0,type:"giveaways",featureMap:{giveaway:this.gwc_addChances.bind(this)}}}init(){!d.get("gptw")&&(this.esgst.enteredPath||this.esgst.wonPath&&d.get("cewgd")&&d.get("cewgd_w")&&d.get("cewgd_w_e"))&&this.esgst.endlessFeatures.push(this.gwc_addHeading.bind(this))}gwc_addChances(e,t,s){e.forEach(e=>{e.sgTools||t&&(this.esgst.createdPath||this.esgst.wonPath&&(!d.get("cewgd")||!d.get("cewgd_w")||!d.get("cewgd_w_e"))||this.esgst.newGiveawayPath||this.esgst.archivePath)||(e.inviteOnly&&(t&&(this.esgst.giveawayPath||this.esgst.enteredPath||this.esgst.wonPath&&d.get("cewgd")&&d.get("cewgd_w")&&d.get("cewgd_w_e"))||!t||e.ended||e.id)||!e.inviteOnly)&&!e.innerWrap.getElementsByClassName("esgst-gwc")[0]&&(e.started?(e.gwcContext=fl(e.panel,d.get("gv")&&(t&&this.esgst.giveawaysPath||"gb"===s&&d.get("gv_gb")||"ged"===s&&d.get("gv_ged")||"ge"===s&&d.get("gv_ge"))?"afterbegin":"beforeend",[{attributes:{class:(this.esgst.giveawayPath?"featured__column":"")+" esgst-gwc","data-draggable-id":"gwc",title:bl("gwc","Giveaway Winning Chance")},type:"div"}]),this.gwc_addChance(e)):(e.chance=100,e.projectedChance=100,e.chancePerPoint=e.chance/Math.max(1,e.points),e.projectedChancePerPoint=e.chancePerPoint))})}gwc_addChance(e){let t,s,n,a,i,o,r=0;for(i=e.entered||e.ended||e.created||!d.get("gwc_e")?e.entries:e.entries+1,s=i>0?e.copies/i*100:100,s=s>100?100:s<=0?.01:s,d.get("gwc_a")&&!e.ended&&e.startTime&&(r=i>0?e.copies/(i/(Date.now()-e.startTime)*(e.endTime-e.startTime))*100:100,r=r>100?100:r<=0?.01:r),e.chance=s,e.projectedChance=r,e.chancePerPoint=e.chance/Math.max(1,e.points),e.projectedChancePerPoint=e.projectedChance/Math.max(1,e.points),e.points&&(e.gwcContext.title=bl("gwc",`Giveaway Winning Chance (${hs.round(e.chancePerPoint,4)}% basic and ${hs.round(e.projectedChancePerPoint)}% advanced per point)`)),e.gwcContext.setAttribute("data-chance",e.chance),e.gwcContext.setAttribute("data-projectedChance",e.projectedChance),o=d.get("gwc_colors").length-1;o>-1;--o)if(a=d.get("gwc_colors")[o],s>=parseFloat(a.lower)&&s<=parseFloat(a.upper)){n=a.color;break}for(o=d.get("gwc_colors").length-1;o>-1;--o)if(a=d.get("gwc_colors")[o],r>=parseFloat(a.lower)&&r<=parseFloat(a.upper)){t=a.color;break}d.get("gwc_h")&&(e.headingName.classList.add("esgst-gwc-highlight"),e.headingName.style.color=d.get("gwc_a")&&!d.get("gwc_a_b")?t:n,e.image&&(e.image.classList.add("esgst-gwc-highlight"),e.image.style.color=""+(d.get("gwc_a")&&!d.get("gwc_a_b")?t:n),e.image.style.boxShadow=(d.get("gwc_a")&&!d.get("gwc_a_b")?t:n)+" 0px 0px 0px var(--esgst-gwc-highlight-width, 3px) inset")),(this.esgst.enteredPath||this.esgst.wonPath)&&(e.gwcContext.style.display="inline-block");const l=[];this.esgst.enteredPath||this.esgst.wonPath||l.push({attributes:{class:"fa fa-area-chart"},type:"i"});const c=[],g={};n&&(g.style=`color: ${n}; font-weight: bold;`);const u={};t&&(u.style=`color: ${t}; font-weight: bold;`),d.get("gwc_a")&&r?d.get("gwc_a_b")?c.push({attributes:g,text:hs.round(s)+"%",type:"span"},{text:" (",type:"node"},{attributes:u,text:hs.round(r)+"%",type:"span"},{text:")",type:"node"}):c.push({attributes:u,text:hs.round(r)+"%",type:"span"}):c.push({attributes:g,text:hs.round(s)+"%",type:"span"}),l.push({type:"span",children:c}),(this.esgst.enteredPath||this.esgst.wonPath)&&d.get("gwr")&&l.push({text:" / ",type:"node"}),fl(e.gwcContext,"atinner",l)}gwc_addHeading(e,t,s,n){if(this.esgst.createdPath||this.esgst.wonPath&&(!d.get("cewgd")||!d.get("cewgd_w")||!d.get("cewgd_w_e"))||!t)return;const a=e.querySelector(""+(n?`.esgst-es-page-${n} .table__heading, .esgst-es-page-${n}.table__heading`:".table__heading"));if(!a||a.getElementsByClassName("esgst-gwcr-heading")[0])return;let i="";d.get("gwc")&&(i+="Chance / "),d.get("gwr")&&(i+="Ratio / "),d.get("gptw")&&(i+="Points To Win / "),i=i.slice(0,-3),fl(a.firstElementChild,"afterend",[{attributes:{class:"table__column--width-small text-center esgst-gwcr-heading"},text:i,type:"div"}])}},yl=hs.createElements.bind(hs),vl=hs.getFeatureTooltip.bind(hs);const _l=new class extends gt{constructor(){super(),this.info={description:()=>Se.element("ul",null,Se.element("li",null,"Adds an element (",Se.element("i",{className:"fa fa-pie-chart"})," [Ratio]: 1) below a giveaway's start time (in any page) that shows the ratio (number of entries per copy) of the giveaway."),Se.element("li",null,"The ratio is calculated by rounding up the result of the following formula: number_of_entries / number_of_copies"),Se.element("li",null,"You can move the element around by dragging and dropping it.")),features:{gwr_e:{description:()=>Se.element("ul",null,Se.element("li",null,"The formula changes to: (number_of_entries + 1) / number_of_copies"),Se.element("li",null,"For example, if a giveaway has 2 copies and 6 entries, the current ratio is 3:1, but after you enter it, it will have 7 entries, so the ratio will increase to 4:1.")),name:"Show what the ratio will be when you enter the giveaway instead of the current ratio.",sg:!0},gwr_a:{description:()=>Se.element("ul",null,Se.element("li",null,"Uses an advanced formula ((number_of_entries / time_open_in_milliseconds * duration_in_milliseconds) / number_of_copies) to calculate the ratio based on how much time the giveaway has been open and the duration of the giveaway. This gives you an estimate of what the ratio will be when the giveaway ends.")),features:{gwr_a_b:{name:'Show the basic ratio along with the advanced one (the advanced ratio will appear in a parenthesis, like "[Basic]:1 ([Advanced]:1)").',sg:!0}},name:"Use advanced formula.",sg:!0},gwr_h:{conflicts:["gwc_h"],description:()=>Se.element("ul",null,Se.element("li",null,"Changes the color of the giveaway's title to the same color as the ratio and adds a border of same color to the giveaway's game image.")),inputItems:[{id:"gwr_h_width",prefix:"Image Border Width: "}],name:"Highlight the giveaway.",sg:!0}},id:"gwr",name:"Giveaway Winning Ratio",sg:!0,type:"giveaways",featureMap:{giveaway:this.gwr_addRatios.bind(this)}}}init(){d.get("gptw")||d.get("gwc")||!(this.esgst.enteredPath||this.esgst.wonPath&&d.get("cewgd")&&d.get("cewgd_w")&&d.get("cewgd_w_e"))||this.esgst.endlessFeatures.push(this.esgst.modules.giveawaysGiveawayWinningChance.gwc_addHeading.bind(this.esgst.modules.giveawaysGiveawayWinningChance))}gwr_addRatios(e,t,s){e.forEach(e=>{if(!(e.sgTools||t&&(this.esgst.createdPath||this.esgst.wonPath&&(!d.get("cewgd")||!d.get("cewgd_w")||!d.get("cewgd_w_e"))||this.esgst.newGiveawayPath||this.esgst.archivePath))&&e.started&&(e.inviteOnly&&(t&&(this.esgst.giveawayPath||this.esgst.enteredPath||this.esgst.wonPath&&d.get("cewgd")&&d.get("cewgd_w")&&d.get("cewgd_w_e"))||!t||e.ended||e.id)||!e.inviteOnly)&&!e.innerWrap.getElementsByClassName("esgst-gwr")[0]){let n=yl(e.panel,d.get("gv")&&(t&&this.esgst.giveawaysPath||"gb"===s&&d.get("gv_gb")||"ged"===s&&d.get("gv_ged")||"ge"===s&&d.get("gv_ge"))?"afterbegin":"beforeend",[{attributes:{class:(this.esgst.giveawayPath?"featured__column":"")+" esgst-gwr","data-draggable-id":"gwr",title:vl("gwr","Giveaway Winning Ratio")},type:"div"}]);this.gwr_addRatio(n,e)}})}gwr_addRatio(e,t){let s,n,a,i,o,r,l=0;for(o=t.entered||t.ended||t.created||!d.get("gwr_e")?t.entries:t.entries+1,a=Math.ceil(o/t.copies),d.get("gwr_a")&&!t.ended&&t.startTime&&(l=Math.ceil(o/(Date.now()-t.startTime)*(t.endTime-t.startTime)/t.copies)),t.ratio=a,t.projectedRatio=l,e.setAttribute("data-ratio",t.ratio),e.setAttribute("data-projectedRatio",t.projectedRatio),r=d.get("gwr_colors").length-1;r>-1;--r)if(i=d.get("gwr_colors")[r],a>=parseInt(i.lower)&&a<=parseInt(i.upper)){n=i.color;break}for(r=d.get("gwr_colors").length-1;r>-1;--r)if(i=d.get("gwr_colors")[r],l>=parseInt(i.lower)&&l<=parseInt(i.upper)){s=i.color;break}d.get("gwr_h")&&(t.headingName.classList.add("esgst-gwr-highlight"),t.headingName.style.color=d.get("gwr_a")&&!d.get("gwr_a_b")?s:n,t.image&&(t.image.classList.add("esgst-gwr-highlight"),t.image.style.color=""+(d.get("gwr_a")&&!d.get("gwr_a_b")?s:n),t.image.style.boxShadow=(d.get("gwr_a")&&!d.get("gwr_a_b")?s:n)+" 0px 0px 0px var(--esgst-gwr-highlight-width, 3px)  inset")),(this.esgst.enteredPath||this.esgst.wonPath)&&(e.style.display="inline-block");const c=[];this.esgst.enteredPath||this.esgst.wonPath||c.push({attributes:{class:"fa fa-pie-chart"},type:"i"});const g=[],u={};n&&(u.style=`color: ${n}; font-weight: bold;`);const m={};s&&(m.style=`color: ${s}; font-weight: bold;`),d.get("gwr_a")&&l?d.get("gwr_a_b")?g.push({attributes:u,text:a+":1",type:"span"},{text:" (",type:"node"},{attributes:m,text:l+":1",type:"span"},{text:")",type:"node"}):g.push({attributes:m,text:l+":1",type:"span"}):g.push({attributes:u,text:a+":1",type:"span"}),c.push({type:"span",children:g}),(this.esgst.enteredPath||this.esgst.wonPath)&&d.get("gptw")&&c.push({text:" / ",type:"node"}),yl(e,"atinner",c)}},kl=hs.createElements.bind(hs),xl=hs.getFeatureTooltip.bind(hs);const Al=new class extends gt{constructor(){super(),this.info={description:()=>Se.element("ul",null,Se.element("li",null,"Adds an element (",Se.element("i",{className:"fa fa-rub"}),"[Points]) below a giveaway's start time (in any page) that shows how many points you would have to spend to win the giveaway."),Se.element("li",null,"The points are calculated by rounding up (using 2 decimals) the result of the following formula: number_of_points / number_of_copies * number_of_entries"),Se.element("li",null,"You can move the element around by dragging and dropping it.")),features:{gptw_e:{description:()=>Se.element("ul",null,Se.element("li",null,"The formula changes to: number_of_points / number_of_copies * (number_of_entries + 1)"),Se.element("li",null,"For example, if a giveaway for 2 copies has 5 entries and is worth 10 points, the current points to win are 25, but after you enter it, it will have 6 entries, so the points will increase to 30.")),name:"Show what the points to win will be when you enter the giveaway instead of the current points to win.",sg:!0}},id:"gptw",name:"Giveaway Points To Win",sg:!0,type:"giveaways",featureMap:{giveaway:this.gptw_addPoints.bind(this)}}}init(){(this.esgst.enteredPath||this.esgst.wonPath&&d.get("cewgd")&&d.get("cewgd_w")&&d.get("cewgd_w_e"))&&this.esgst.endlessFeatures.push(this.esgst.modules.giveawaysGiveawayWinningChance.gwc_addHeading.bind(this))}gptw_addPoints(e,t,s){for(const n of e)n.sgTools||t&&(this.esgst.createdPath||this.esgst.wonPath&&(!d.get("cewgd")||!d.get("cewgd_w")||!d.get("cewgd_w_e"))||this.esgst.newGiveawayPath||this.esgst.archivePath)||(n.inviteOnly&&(t&&(this.esgst.giveawayPath||this.esgst.enteredPath||this.esgst.wonPath&&d.get("cewgd")&&d.get("cewgd_w")&&d.get("cewgd_w_e"))||!t||n.ended||n.id)||!n.inviteOnly)&&!n.innerWrap.getElementsByClassName("esgst-gptw")[0]&&(n.started?(n.gptwContext=kl(n.panel,d.get("gv")&&(t&&this.esgst.giveawaysPath||"gb"===s&&d.get("gv_gb")||"ged"===s&&d.get("gv_ged")||"ge"===s&&d.get("gv_ge"))?"afterbegin":"beforeend",[{attributes:{class:(this.esgst.giveawayPath?"featured__column":"")+" esgst-gptw","data-draggable-id":"gptw",title:xl("gptw","Giveaway Points To Win")},type:"div"}]),this.gptw_addPoint(n)):n.pointsToWin=0)}gptw_addPoint(e){const t=e.entered||e.ended||e.created||!d.get("gptw_e")?e.entries:e.entries+1;e.pointsToWin=Math.round((e.points||0)/e.copies*t*100)/100,e.gptwContext.setAttribute("data-pointsToWin",e.pointsToWin);let s=null;for(const t of d.get("gptw_colors"))if(e.pointsToWin>=parseFloat(t.lower)&&e.pointsToWin<=parseFloat(t.upper)){s=t.color;break}(this.esgst.enteredPath||this.esgst.wonPath)&&(e.gptwContext.style.display="inline-block");const n=[];this.esgst.enteredPath||this.esgst.wonPath||n.push({attributes:{class:"fa fa-rub"},type:"i"});const a={};s&&(a.style=`color: ${s}; font-weight: bold;`),n.push({attributes:a,text:e.pointsToWin,type:"span"}),kl(e.gptwContext,"atinner",n)}};const Cl=new class extends gt{constructor(){super(),this.info={description:()=>Se.element("ul",null,Se.element("li",null,"Allows you to highlight the end time of a giveaway (in any page) by coloring it based on how many hours there are left.")),id:"geth",name:"Giveaway End Time Highlighter",sg:!0,type:"giveaways",featureMap:{giveaway:this.geth_getGiveaways.bind(this)}}}geth_getGiveaways(e){if(d.get("geth_colors").length)for(const t of e){if(!t.started)continue;const e=(t.endTime-Date.now())/36e5;for(let s=d.get("geth_colors").length-1;s>-1;s--){const n=d.get("geth_colors")[s];if(e>=parseFloat(n.lower)&&e<=parseFloat(n.upper)){(t.endTimeColumn_gv||t.endTimeColumn).style.color=n.color;break}}}}},Sl=hs.createElements.bind(hs),El=hs.getFeatureTooltip.bind(hs);const Tl=new class extends gt{constructor(){super(),this.info={description:()=>Se.element("ul",null,Se.element("li",null,"Adds 2 optional icons (",Se.element("i",{className:"fa fa-steam"})," for the Steam client and"," ",Se.element("i",{className:"fa fa-globe"}),' for the browser) next to each key in the "Key" column of your ',Se.element("a",{href:"https://www.steamgifts.com/giveaways/won"},"won")," page that allow you to quickly activate a won game on Steam, either through the client or the browser."),Se.element("li",null,"When you click on the icon, the key is automatically copied to the clipboard.")),id:"sal",name:"Steam Activation Links",options:{title:"Show links to:",values:["Steam Client","Browser","Both"]},sg:!0,type:"giveaways"}}init(){this.esgst.wonPath&&this.esgst.endlessFeatures.push(this.sal_addLinks.bind(this),this.sal_addObservers.bind(this))}sal_addObservers(e,t,s,n){const a=e.querySelectorAll(""+(n?`.esgst-es-page-${n} .view_key_btn, .esgst-es-page-${n}.view_key_btn`:".view_key_btn"));for(const e of a)this.sal_addObserver(e)}sal_addObserver(e){let t=null;const s=e.closest(".table__row-outer-wrap");e.addEventListener("click",()=>{t||(t=window.setInterval(()=>{if(!s.contains(e)){if(window.clearInterval(t),t=null,d.get("sal")){const e=s.querySelector("[data-clipboard-text]"),t=e.getAttribute("data-clipboard-text").match(/^[\d\w]{5}(-[\d\w]{5}){2,}$/);t&&this.sal_addLink(e,t[0])}d.get("ef")&&this.esgst.modules.generalElementFilters.ef_hideElements(s)}},100))})}sal_addLinks(e,t,s,n){const a=e.querySelectorAll(""+(n?`.esgst-es-page-${n} [data-clipboard-text], .esgst-es-page-${n}[data-clipboard-text]`:"[data-clipboard-text]"));for(const e of a){if(e.parentElement.getElementsByClassName("esgst-sal")[0])continue;const t=e.getAttribute("data-clipboard-text").match(/^[\d\w]{5}(-[\d\w]{5}){2,}$/);t&&this.sal_addLink(e,t[0])}}sal_addLink(e,t){let s,n;if(e.nextElementSibling&&!e.nextElementSibling.classList.contains("esgst-sal")||!e.nextElementSibling)switch(s=Sl(e,"afterend",[{type:"span"}]),d.get("sal_index")){case 0:Sl(s,"beforeend",[{attributes:{class:"esgst-sal esgst-clickable",title:El("sal","Activate on Steam (client)")},type:"span",children:[{attributes:{class:"fa fa-steam"},type:"i"}]}]).addEventListener("click",()=>{n=Sl(document.body,"beforeend",[{type:"textarea"}]),n.value=t,n.select(),document.execCommand("copy"),n.remove(),window.location.href="steam://open/activateproduct"});break;case 1:Sl(s,"beforeend",[{attributes:{class:"esgst-sal esgst-clickable",href:"https://store.steampowered.com/account/registerkey?key="+t,target:"_blank",title:El("sal","Activate on Steam (browser)")},type:"a",children:[{attributes:{class:"fa fa-globe"},type:"i"}]}]);break;case 2:Sl(s,"beforeend",[{attributes:{class:"esgst-sal esgst-clickable",title:El("sal","Activate on Steam (client)")},type:"span",children:[{attributes:{class:"fa fa-steam"},type:"i"}]},{attributes:{class:"esgst-sal esgst-clickable",href:"https://store.steampowered.com/account/registerkey?key="+t,target:"_blank",title:El("sal","Activate on Steam (browser)")},type:"a",children:[{attributes:{class:"fa fa-globe"},type:"i"}]}]).previousElementSibling.addEventListener("click",()=>{n=Sl(document.body,"beforeend",[{type:"textarea"}]),n.value=t,n.select(),document.execCommand("copy"),n.remove(),window.location.href="steam://open/activateproduct"})}}};const Nl=new class extends gt{constructor(){super(),this.info={description:()=>Se.element("ul",null,Se.element("li",null,"Removes SteamGifts' default fade for entered giveaways.")),id:"ueg",name:"Unfaded Entered Giveaway",sg:!0,type:"giveaways",featureMap:{endless:this.ueg_remove.bind(this)}}}ueg_remove(e,t,s,n){const a=e.querySelectorAll(""+(n?`.esgst-es-page-${n} .giveaway__row-inner-wrap.is-faded, .esgst-es-page-${n}.giveaway__row-inner-wrap.is-faded`:".giveaway__row-inner-wrap.is-faded"));for(let e=0,t=a.length;e<t;++e)a[e].classList.add("esgst-ueg")}},Pl=hs.getValue.bind(hs),Ll=hs.lockAndSaveGroups.bind(hs);const Il=new class extends gt{constructor(){super(),this.info={description:()=>Se.element("ul",null,Se.element("li",null,"Adds a button (",Se.element("i",{className:"fa fa-thumb-tack"})," if the group is stickied and"," ",Se.element("i",{className:"fa fa-thumb-tack esgst-faded"})," if it is not) next to each group in the ",Se.element("a",{href:"https://www.steamgifts.com/giveaways/new"},"new giveaway"),"/",Se.element("a",{href:"https://www.steamgifts.com/account/steam/groups"},"groups")," pages that allows you to sticky the group so that it appears at the top of the group list when creating a giveaway for quick use.")),id:"sgg",name:"Stickied Giveaway Groups",sg:!0,type:"giveaways",sync:"Steam Groups",syncKeys:["Groups"]}}init(){this.esgst.newGiveawayPath&&!document.getElementsByClassName("table--summary")[0]&&this.sgg_setGiveawayGroups(),c.common.isCurrentPath("Steam - Groups")&&this.esgst.endlessFeatures.push(this.sgg_setGroups.bind(this))}sgg_setGiveawayGroups(){let e,t,s,n,a,i,o,r,l,d,g;d=JSON.parse(c.common.getValue("groups","[]")),s=document.querySelector('.form_list[data-input="group_item_string"]'),a=s.children;const u={separator:s.firstElementChild.nextElementSibling};for(i=1,l=a.length;i<l;++i){n=a[i],o=n.getAttribute("data-item-id");for(e=n.firstElementChild.style.backgroundImage,t=null,g=!1,r=d.length-1;r>=0;--r)if(e.match(d[r].avatar)){t=d[r].code,d[r].stickied&&(g=!0);break}t&&(g&&(n===u.separator&&(u.separator=u.separator.nextElementSibling),s.insertBefore(n,u.separator)),new Us(n,"afterbegin",{callbacks:[this.sgg_stickyGroup.bind(this,u,t,s,n,o),null,this.sgg_unstickyGroup.bind(this,u,t,s,n,o),null],className:"esgst-sgg-button",icons:["fa-thumb-tack esgst-clickable esgst-faded","fa-circle-o-notch fa-spin","fa-thumb-tack esgst-clickable","fa-circle-o-notch fa-spin"],id:"sgg",index:g?2:0,titles:["Sticky group","Stickying...","Unsticky group","Unstickying..."]}))}}async sgg_setGroups(e,t,s,n){const a=e.querySelectorAll(""+(n?`.esgst-es-page-${n} .table__row-inner-wrap, .esgst-es-page-${n}.table__row-inner-wrap`:".table__row-inner-wrap"));if(!a.length)return;const i=JSON.parse(Pl("groups","[]"));for(let e=0,t=a.length;e<t;e++){let t=a[e],s=t.getElementsByClassName("table_image_avatar")[0].style.backgroundImage,n=!1,o=null;for(let e=i.length-1;e>=0;e--)if(s.match(i[e].avatar)){o=i[e].code,i[e].stickied&&(n=!0);break}o&&new Us(t,"afterbegin",{callbacks:[this.sgg_stickyGroup.bind(this,{},o,null,t,null),null,this.sgg_unstickyGroup.bind(this,{},o,null,t,null),null],className:"esgst-sgg-button",icons:["fa-thumb-tack esgst-clickable esgst-faded","fa-circle-o-notch fa-spin","fa-thumb-tack esgst-clickable","fa-circle-o-notch fa-spin"],id:"sgg",index:n?2:0,titles:["Sticky group","Stickying...","Unsticky group","Unstickying..."]})}}async sgg_stickyGroup(e,t,s,n,a,i){i.stopPropagation(),s&&(n===e.separator&&(e.separator=e.separator.nextElementSibling),s.insertBefore(n,e.separator));let o={};return o[t]={stickied:!0},a&&(o[t].id=a),await Ll(o),!0}async sgg_unstickyGroup(e,t,s,n,a,i){i.stopPropagation(),s&&(s.insertBefore(n,e.separator),e.separator=e.separator.previousElementSibling);let o={};return o[t]={stickied:!1},a&&(o[t].id=a),await Ll(o),!0}};const Bl=new class extends gt{constructor(){super(),this.info={description:()=>Se.element("ul",null,Se.element("li",null,"Replaces SteamGifts' native comment box (in any page) with a comment box that allows you to reply to multiple comments at the same time and does not reload the page after submitting a reply (submitting a comment that is not a reply to another comment still reloads the page).")),id:"mr",name:"Multi-Reply",sg:!0,st:!0,type:"comments",featureMap:{endless:this.mr_getButtons.bind(this)}}}mr_getButtons(e,t,s,n){if((!d.get("mr")||c.common.isCurrentPath("Messages"))&&(!d.get("rfi")||!c.common.isCurrentPath("Messages")&&t))return;const a=e.querySelectorAll(`${n?`.esgst-es-page-${n} .comment__actions, .esgst-es-page-${n}.comment__actions`:".comment__actions"}, ${n?`.esgst-es-page-${n} .action_list, .esgst-es-page-${n}.action_list`:".action_list"}`);for(let e=0,s=a.length;e<s;++e)this.mr_addButton(a[e],t)}mr_addButton(e,t){let s,n,a,i={};i.Context=e,i.Comment=e.closest(c.esgst.sg?".comment":".comment_outer"),i.Comment&&(s=i.Comment.closest(c.esgst.sg?".comment":".comment_outer"),i.Container=i.Comment.getElementsByClassName(c.esgst.sg?"comment__summary":"comment_inner")[0],i.Timestamp=i.Context.firstElementChild,n=i.Context.getElementsByClassName(c.esgst.sg?"js__comment-reply":"js_comment_reply")[0],a=i.Context.querySelectorAll('[href*="/go/comment/"]'),a=a[a.length-1],(n||!t||c.common.isCurrentPath("Messages"))&&(n?(n.remove(),i.ParentID=s.getAttribute(c.esgst.sg?"data-comment-id":"data-id"),t&&!c.common.isCurrentPath("Messages")||(i.URL=a.getAttribute("href")),i.url=a.getAttribute("href")):(i.url=i.URL=a.getAttribute("href"),Se.insert(i.Comment,"beforeend",Se.element("div",{className:"comment__children comment_children"}))),c.esgst.sg?(i.TradeCode="",i.Username=i.Comment.getElementsByClassName("comment__username")[0].textContent):(t&&!c.common.isCurrentPath("Messages")&&(i.TradeCode=window.location.pathname.match(/^\/trade\/(.+?)\//)[1]),i.Username=i.Comment.getElementsByClassName("author_name")[0].textContent),Se.insert(i.Timestamp,"afterend",Se.element("a",{className:"comment__actions__button esgst-mr-reply"},"Reply")),i.Timestamp.nextElementSibling.addEventListener("click",()=>{i.Box?i.Description.focus():this.mr_addBox(i)})),i.Children=i.Comment.getElementsByClassName(c.esgst.sg?"comment__children":"comment_children")[0],this.mr_setEdit(i),this.mr_setDelete(i),this.mr_setUndelete(i))}mr_addBox(e){let t;t=d.get("username");const s=Se.element("fragment",null,Se.element("input",{name:"trade_code",type:"hidden",value:e.TradeCode}),Se.element("input",{name:"parent_id",type:"hidden",value:e.ParentID}),Se.element("textarea",{className:"esgst-mr-description",name:"description",placeholder:`Write a reply to ${e.Username}...`}),Se.element("div",{className:"align-button-container btn_actions"},Se.element("div",null),Se.element("div",{className:"comment__cancel-button btn_cancel esgst-mr-cancel"},Se.element("span",null,"Cancel")))),n=[];c.esgst.sg?n.push(Se.element("div",{className:"comment__child"},Se.element("a",{className:"global__image-outer-wrap global__image-outer-wrap--avatar-small",href:"/user/"+t},Se.element("div",{className:"global__image-inner-wrap",style:`background-image: url(${d.get("avatar")});`})),Se.element("div",{className:"comment__summary"},Se.element("div",{className:"comment__author"},Se.element("div",{className:"comment__username"},Se.element("a",{href:"/user/"+t},t))),Se.element("div",{className:"comment__display-state"},Se.element("div",{className:"comment__description"},s))))):n.push(s),Se.insert(e.Children,"afterbegin",Se.element("div",{className:"comment reply_form MRBox"},n)),e.Box=e.Children.firstElementChild,e.Description=e.Box.getElementsByClassName("esgst-mr-description")[0],e.Cancel=e.Box.getElementsByClassName("esgst-mr-cancel")[0],d.get("cfh")&&c.esgst.modules.commentsCommentFormattingHelper.cfh_addPanel(e.Description),e.Description.focus(),c.common.addReplyButton(e.Box,e.URL,async(t,s,n)=>{let a;c.esgst.sg?t?(a=s.html.getElementById(t).closest(".comment"),d.get("rfi")&&d.get("rfi_s")&&await c.esgst.modules.commentsReplyFromInbox.rfi_saveReply(t,a.outerHTML,e.url),c.esgst.modules.commentsReplyMentionLink.rml_addLink(e.Container,[a]),await c.common.endless_load(a),e.Box.remove(),e.Box=null,e.Children.appendChild(a),!d.get("qiv")||c.esgst.qiv.comments&&c.esgst.qiv.comments.contains(a)||(window.location.hash=t)):Se.insert(n,"atinner",Se.element("fragment",null,Se.element("i",{className:"fa fa-times"}),Se.element("span",null,"Failed!"))):t?(a=Se.parse(s.json.html).getElementById(t),d.get("rfi")&&d.get("rfi_s")&&await c.esgst.modules.commentsReplyFromInbox.rfi_saveReply(t,a.outerHTML,e.url),c.esgst.modules.commentsReplyMentionLink.rml_addLink(e.Container,[a]),await c.common.endless_load(a),e.Box.remove(),e.Box=null,e.Children.appendChild(a),!d.get("qiv")||c.esgst.qiv.comments&&c.esgst.qiv.comments.contains(a)||(window.location.hash=t)):Se.insert(n,"atinner",Se.element("fragment",null,Se.element("i",{className:"fa fa-times"}),Se.element("span",null,"Failed!")))}),e.Cancel.addEventListener("click",()=>{e.Box.remove(),e.Box=null})}mr_setEdit(e){let t,s,n,a,i,o;e.Edit=e.Context.getElementsByClassName(c.esgst.sg?"js__comment-edit":"js_comment_edit")[0],e.Edit&&(Se.insert(e.Edit,"afterend",Se.element("a",{className:"comment__actions__button esgst-mr-edit"},"Edit")),e.Edit=e.Edit.nextElementSibling,e.Edit.previousElementSibling.remove(),t=e.Comment.getElementsByClassName(c.esgst.sg?"comment__display-state":"comment_body_default")[0],s=e.Comment.getElementsByClassName(c.esgst.sg?"comment__edit-state":"edit_form")[0],n=s.querySelector(".js__comment-edit-save, .js_submit, .EditSave"),Se.insert(n,"afterend",Se.element("a",{className:"comment__submit-button btn_action white EditSave"},Se.element("i",{className:"fa fa-edit"}),Se.element("span",null,"Edit"))),n=n.nextElementSibling,n.previousElementSibling.remove(),a=s.querySelector('[name="comment_id"]').value,i=c.esgst.sg?s.querySelector('[name="allow_replies"]').value:"",o=s.querySelector('[name="description"]'),e.Edit.addEventListener("click",()=>{let n;c.esgst.sg?(t.classList.add("is-hidden"),e.Context.classList.add("is-hidden")):e.Container.classList.add("is_hidden"),s.classList.remove(c.esgst.sg?"is-hidden":"is_hidden"),n=o.value,o.focus(),o.value="",o.value=n}),n.addEventListener("click",async()=>{let n,r;const l={comment:o.value};if(await Ee.dispatch(ze,l),n=(await Ne.post("/ajax.php",{data:`xsrf_token=${Be.xsrfToken}&do=comment_edit&comment_id=${a}&allow_replies=${i}&description=${encodeURIComponent(l.comment)}`})).json,"success"===n.type||n.success){if(r=Se.parse(n[c.esgst.sg?"comment":"html"]),d.get("rfi")&&d.get("rfi_s")){let t=e.Comment.cloneNode(!0);c.esgst.sg?Se.insert(t,"atinner",Se.element("fragment",null,Se.element("div",{className:"ajax comment__child"},Array.from(r.body.childNodes).map(e=>e.cloneNode(!0))),Se.element("div",{className:"comment__children"}))):Se.insert(t,"atinner",Se.element("fragment",null,Array.from(r.body.childNodes).map(e=>e.cloneNode(!0)),Se.element("div",{className:"comment__children"}))),await c.esgst.modules.commentsReplyFromInbox.rfi_saveReply(e.url.match(/\/comment\/(.+)/)[1],t.outerHTML,null,!0)}Se.insert(t,"atinner",Se.element("fragment",null,Array.from(r.getElementsByClassName(c.esgst.sg?"comment__display-state":"comment_body_default")[0].childNodes))),s.classList.add(c.esgst.sg?"is-hidden":"is_hidden"),Se.insert(e.Timestamp,"atinner",Se.element("fragment",null,Array.from(r.getElementsByClassName(c.esgst.sg?"comment__actions":"action_list")[0].firstElementChild.childNodes))),d.get("at")&&c.esgst.modules.generalAccurateTimestamp.at_getTimestamps(e.Timestamp),d.get("ged")&&await c.esgst.ged_addIcons([{actions:e.Container.getElementsByClassName(c.esgst.sg?"comment__actions":"action_list")[0],displayState:t,comment:e.Container,id:e.url.match(/\/comment\/(.+)/)[1]}]),c.esgst.sg?(t.classList.remove("is-hidden"),e.Context.classList.remove("is-hidden")):e.Container.classList.remove("is_hidden")}}))}mr_setDelete(e){let t,s,n;e.delete=e.Context.getElementsByClassName(c.esgst.sg?"js__comment-delete":"js_comment_delete")[0],e.delete&&(c.esgst.sg?(t=e.delete.parentElement.querySelector('[name="allow_replies"]').value,n=e.delete.parentElement.querySelector('[name="comment_id"]').value,s=`xsrf_token=${Be.xsrfToken}&do=comment_delete&allow_replies=${t}&comment_id=${n}`):s=e.delete.getAttribute("data-form"),Se.insert(e.delete,"afterend",Se.element("a",{className:"comment__actions__button esgst-mr-delete"},"Delete")),e.delete=e.delete.nextElementSibling,e.delete.previousElementSibling.remove(),e.delete.addEventListener("click",async()=>{this.mr_editReply(e,await Ne.post("/ajax.php",{data:s}))}))}mr_setUndelete(e){let t,s,n;e.undelete=e.Context.getElementsByClassName(c.esgst.sg?"js__comment-undelete":"js_comment_undelete")[0],e.undelete&&(c.esgst.sg?(t=e.undelete.parentElement.querySelector('[name="allow_replies"]').value,n=e.undelete.parentElement.querySelector('[name="comment_id"]').value,s=`xsrf_token=${Be.xsrfToken}&do=comment_undelete&allow_replies=${t}&comment_id=${n}`):s=e.undelete.getAttribute("data-form"),Se.insert(e.undelete,"afterend",Se.element("a",{className:"comment__actions__button esgst-mr-undelete"},"Undelete")),e.undelete=e.undelete.nextElementSibling,e.undelete.previousElementSibling.remove(),e.undelete.addEventListener("click",async()=>{this.mr_editReply(e,await Ne.post("/ajax.php",{data:s}))}))}async mr_editReply(e,t){let s,n;if(n=t.json,"success"===n.type||n.success){if(s=Se.parse(n[c.esgst.sg?"comment":"html"]),c.esgst.sg?Se.insert(e.Container,"atinner",Se.element("fragment",null,Array.from(s.getElementsByClassName("comment__summary")[0].childNodes))):Se.insert(e.Container,"atinner",Se.element("fragment",null,Array.from(s.getElementsByClassName("comment_inner")[0].childNodes))),d.get("rfi")&&d.get("rfi_s")){let t=e.Comment.cloneNode(!0);c.esgst.sg?Se.insert(t,"atinner",Se.element("fragment",null,Se.element("div",{className:"ajax comment__child"},Array.from(s.body.childNodes)),Se.element("div",{className:"comment__children"}))):Se.insert(t,"atinner",Se.element("fragment",null,Array.from(s.body.childNodes),Se.element("div",{className:"comment__children"}))),await c.esgst.modules.commentsReplyFromInbox.rfi_saveReply(e.url.match(/\/comment\/(.+)/)[1],t.outerHTML,null,!0)}await c.common.endless_load(e.Container)}}};const Dl=new class extends gt{constructor(){super(),this.info={description:()=>Se.element("ul",null,Se.element("li",null,'Adds a "Reply" link next to a comment\'s "Permalink" (in your'," ",Se.element("a",{href:"https://www.steamgifts.com/messages"},"inbox")," page) that allows you to reply to the comment directly from your inbox."),Se.element("li",null,"It is essentially ",Se.element("span",{"data-esgst-feature-id":"mr"})," for the inbox page.")),features:{rfi_s:{description:()=>Se.element("ul",null,Se.element("li",null,"Caches any replies you submit for 1 week so that they are still in your inbox page when you refresh it."),Se.element("li",null,"If you edit/delete/undelete a saved reply its cache is updated and lasts 1 week longer.")),name:"Cache replies.",sg:!0,st:!0},rfi_c:{description:()=>Se.element("ul",null,Se.element("li",null,"Whenever you try to submit a reply to a comment, the feature will check if there are other replies to that comment and show them to you so that you can review your reply before sending it."),Se.element("li",null,"This option is useful if you want to avoid repeating something that another user already said or discard your reply if someone else already said everything that you were going to say.")),name:"Check if there are other replies to a comment before submitting a reply.",sg:!0,st:!0}},id:"rfi",name:"Reply From Inbox",sg:!0,st:!0,type:"comments"}}init(){d.get("mr")||c.esgst.endlessFeatures.push(c.esgst.modules.commentsMultiReply.mr_getButtons.bind(c.esgst.modules.commentsMultiReply))}async rfi_saveReply(e,t,s,n){let a,i,o,r;if(s&&(o=s.match(/\/comment\/(.+)/)[1]),r=JSON.parse(c.common.getValue(c.esgst.name+"RfiCache","{}")),n){for(const s in r)if(r.hasOwnProperty(s)){for(a=0,i=r[s].length;a<i&&r[s][a].id!==e;++a);a<i&&(r[s][a].reply=t,r[s][a].timestamp=Date.now())}}else r[o]||(r[o]=[]),r[o].push({id:e,reply:t,timestamp:Date.now()});await c.common.setValue(c.esgst.name+"RfiCache",JSON.stringify(r))}async rfi_getReplies(e,t){let s,n,a,i,o,r,l,d,g,u=!1;for(g=JSON.parse(c.common.getValue(c.esgst.name+"RfiCache","{}")),a=0,l=e.length;a<l;++a)if(n=e[a],i=n.id,i&&g[i]){for(s=n.comment.closest(".comment, .comment_outer").querySelector(".comment__children, .comment_children"),o=0,d=g[i].length;o<d;++o){let e=Se.parse(g[i][o].reply).body.firstElementChild;Se.insert(s,"beforeend",e);const t=e.querySelector("[data-timestamp]");t&&(t.textContent=c.common.getTimeSince(g[i][o].timestamp))}s.setAttribute("data-rfi",!0),await c.common.endless_load(s,!1,null,!1,t),s.removeAttribute("data-rfi")}for(r in g)if(g.hasOwnProperty(r)){for(a=0,l=g[r].length;a<l;++a)Date.now()-g[r][a].timestamp>6048e5&&(u=!0,g[r].splice(a,1),a-=1,l-=1);g[r].length||(u=!0,delete g[r])}u&&await c.common.setValue(c.esgst.name+"RfiCache",JSON.stringify(g))}};const Gl=new class extends gt{constructor(){super(),this.info={description:()=>Se.element("ul",null,Se.element("li",null,'Adds a link (@user) next to a reply\'s "Permalink" (in any page) that mentions the user being replied to and links to their comment.'),Se.element("li",null,"This feature is useful for conversations that have very deep nesting levels, which makes it impossible to know who replied to whom.")),id:"rml",name:"Reply Mention Link",sg:!0,st:!0,type:"comments",featureMap:{commentV2:this.addLinks.bind(this)}}}addLinks(e){for(const t of e)this.addLink(t),this.addLinks(t.children)}addLink(e){e.parent&&!e.nodes.rmlLink&&Se.insert(e.nodes.actions,"beforeend",Se.element("a",{href:"#"+e.parent.data.code,className:"comment__actions__button esgst-rml-link",ref:t=>e.nodes.rmlLink=t},"@"+(e.data.isDeleted?"[Deleted]":e.parent.author.data.username)))}rml_addLink(e,t){const s=e.querySelector(".comment__username, .author_name").textContent.trim(),n=e.id;for(const e of t){const t=e.querySelector(".comment__actions, .action_list"),a=t.querySelector(".esgst-rml-link");a?a.textContent="@"+s:Se.insert(t,"beforeend",Se.element("a",{href:"#"+n,className:"comment__actions__button esgst-rml-link"},"@"+s))}}},ql=hs.createElements.bind(hs),Rl=hs.getFeatureTooltip.bind(hs),Ml=hs.getValue.bind(hs),Ol=hs.setValue.bind(hs);const Ul=new class extends gt{constructor(){super(),this.info={description:()=>Se.element("ul",null,Se.element("li",null,"Adds an icon (",Se.element("i",{className:"fa fa-trophy"}),") next to the username of a giveaway comment made by the giveaway's winner(s) (in the"," ",Se.element("a",{href:"https://www.steamgifts.com/messages"},"inbox")," page)."),Se.element("li",null,"A winner is only highlighted if you sent the gift to them after this feature was enabled.")),id:"iwh",name:"Inbox Winner Highlighter",sg:!0,type:"users",featureMap:{endless:this.iwh_getUsers.bind(this)}}}async iwh_getUsers(e,t,s,n){if(!(c.esgst.winnersPath||c.common.isCurrentPath("Messages")||e.getAttribute&&e.getAttribute("data-esgst-qiv")))return;const[a,i]=c.esgst.winnersPath?[this.iwh_setObserver,""+(n?`.esgst-es-page-${n} .table__gift-not-sent, .esgst-es-page-${n}.table__gift-not-sent`:".table__gift-not-sent")]:[this.iwh_highlightWinner,""+(n?`.esgst-es-page-${n} .comments__entity, .esgst-es-page-${n}.comments__entity`:".comments__entity")],o=e.querySelectorAll(i);if(!o.length)return;const r=JSON.parse(Ml("winners","{}"));for(let e=0,t=o.length;e<t;++e)a(o[e],r)}iwh_setObserver(e,t){let s,n;s=window.location.pathname.match(/\/giveaway\/(.+?)\//)[1],n=e.closest(".table__row-inner-wrap").getElementsByClassName("table__column__heading")[0].querySelector('a[href*="/user/"]').textContent,e.addEventListener("click",async()=>{let e;e=JSON.parse(Ml("winners","{}")),e[s]||(e[s]=[]),e[s].indexOf(n)<0&&e[s].push(n),Ol("winners",JSON.stringify(e))})}iwh_highlightWinner(e,t){let s,n,a,i,o,r;if(s=e.firstElementChild.firstElementChild.getAttribute("href").match(/\/giveaway\/(.+?)\//),s&&(n=s[1],t[n]))for(a=e.nextElementSibling.children,i=0,o=a.length;i<o;++i)r=(e=a[i].getElementsByClassName("comment__username")[0]).textContent,t[n].indexOf(r)>=0&&ql(e,"afterend",[{attributes:{class:"fa fa-trophy esgst-iwh-icon",title:Rl("iwh","This is the winner or one of the winners of this giveaway")},type:"i"}])}},Fl=hs.createElements.bind(hs);const $l=new class extends gt{constructor(){super(),this.info={description:()=>Se.element("ul",null,Se.element("li",null,'Adds 5 columns ("Last Online", "Gifts Sent", "Gifts Won", "Ratio" and "Contributor Value") to your'," ",Se.element("a",{href:"https://www.steamgifts.com/account/manage/whitelist"},"whitelist"),"/",Se.element("a",{href:"https://www.steamgifts.com/account/manage/blacklist"},"blacklist")," pages and the popup from ",Se.element("span",{"data-esgst-feature-id":"wbs"})," that show some stats about each user.")),id:"us",name:"User Stats",sg:!0,type:"users"}}init(){c.common.isCurrentPath(["Manage - Whitelist","Manage - Blacklist","Giveaway - Entries"])&&c.esgst.endlessFeatures.push(this.us_get.bind(this))}async us_get(e,t,s,n){if(!t&&!e.closest(".esgst-wbs-popup"))return;e!==document&&t||Fl(e.getElementsByClassName("table__heading")[0].firstElementChild,"afterend",[{attributes:{class:"table__column--width-small text-center"},text:"Last Online",type:"div"},{attributes:{class:"table__column--width-small text-center"},text:"Gifts Won",type:"div"},{attributes:{class:"table__column--width-small text-center"},text:"Gifts Sent",type:"div"},{attributes:{class:"table__column--width-small text-center"},text:"Ratio",type:"div"},{attributes:{class:"table__column--width-small text-center"},text:"Contributor Level",type:"div"}]);let a={},i=e.querySelectorAll(""+(n?`.esgst-es-page-${n} .table__row-inner-wrap, .esgst-es-page-${n}.table__row-inner-wrap`:".table__row-inner-wrap"));for(let e=0,s=i.length;e<s;++e){let s=i[e];a[s.getElementsByClassName("table__column__heading")[0].textContent]=t&&s.firstElementChild.nextElementSibling||s.firstElementChild}let o=[];for(let e in a){if(a.hasOwnProperty(e)){let t=Ne.get("/user/"+e);t.then(this.us_load.bind(this,a[e],e)),o.push(t)}Promise.all(o).then(c.esgst.modules.generalTableSorter.ts_sortTables.bind(c.esgst.modules.generalTableSorter))}}us_load(e,t,s){let n,a,i,o,r,l,d;i=[];const g={};for(a=s.html.getElementsByClassName("featured__table__row__left"),o=0,r=a.length;o<r;++o)switch(n=a[o],n.textContent){case"Last Online":i.push({attributes:{class:"table__column--width-small text-center"},type:"div",children:Array.from(n.nextElementSibling.childNodes).map(e=>({context:e}))});break;case"Gifts Won":g.wonRow=n.parentElement,g.wonRowLeft=n,g.wonRowRight=n.nextElementSibling,d=JSON.parse(g.wonRowRight.firstElementChild.firstElementChild.getAttribute("data-ui-tooltip")).rows,g.wonCount=parseInt(d[0].columns[1].name.replace(/,/g,"")),g.wonFull=parseInt(d[1].columns[1].name.replace(/,/g,"")),g.wonReduced=parseInt(d[2].columns[1].name.replace(/,/g,"")),g.wonZero=parseInt(d[3].columns[1].name.replace(/,/g,"")),l=g.wonRowRight.firstElementChild.lastElementChild,d=JSON.parse(l.getAttribute("data-ui-tooltip")).rows,g.wonCV=parseFloat(l.textContent.replace(/[$,]/g,"")),g.realWonCV=parseFloat(d[0].columns[1].name.replace(/[$,]/g,"")),n.nextElementSibling.firstElementChild.firstElementChild.firstElementChild.removeAttribute("style"),i.push({attributes:{class:"table__column--width-small text-center"},type:"div",children:Array.from(n.nextElementSibling.childNodes).map(e=>({context:e}))});break;case"Gifts Sent":g.sentRow=n.parentElement,g.sentRowLeft=n,g.sentRowRight=n.nextElementSibling,d=JSON.parse(g.sentRowRight.firstElementChild.firstElementChild.getAttribute("data-ui-tooltip")).rows,g.sentCount=parseInt(d[0].columns[1].name.replace(/,/g,"")),g.sentFull=parseInt(d[1].columns[1].name.replace(/,/g,"")),g.sentReduced=parseInt(d[2].columns[1].name.replace(/,/g,"")),g.sentZero=parseInt(d[3].columns[1].name.replace(/,/g,"")),g.notSent=parseInt(d[5].columns[1].name.replace(/,/g,"")),l=g.sentRowRight.firstElementChild.lastElementChild,d=JSON.parse(l.getAttribute("data-ui-tooltip")).rows,g.sentCV=parseFloat(l.textContent.replace(/[$,]/g,"")),g.realSentCV=parseFloat(d[0].columns[1].name.replace(/[$,]/g,"")),n.nextElementSibling.firstElementChild.firstElementChild.firstElementChild.removeAttribute("style"),i.push({attributes:{class:"table__column--width-small text-center"},type:"div",children:Array.from(n.nextElementSibling.childNodes).map(e=>({context:e}))});break;case"Contributor Level":c.esgst.modules.usersSentWonRatio.swr_add(g),i.push({attributes:{class:"table__column--width-small text-center"},type:"div",children:Array.from(g.sentRow.nextElementSibling.lastElementChild.childNodes).map(e=>({context:e}))},{attributes:{class:"table__column--width-small text-center"},text:parseFloat(JSON.parse(n.nextElementSibling.firstElementChild.getAttribute("data-ui-tooltip")).rows[0].columns[1].name),type:"div"})}Fl(e,"afterend",i)}},Wl=hs.getValue.bind(hs);const Vl=new class extends gt{constructor(){super(),this.info={description:()=>Se.element("ul",null,Se.element("li",null,"Adds a green background to a group that you are a member of (in any page).")),id:"gh",name:"Group Highlighter",sg:!0,sync:"Steam Groups",syncKeys:["Groups"],type:"groups"}}init(){c.common.isCurrentPath("Steam - Groups")||c.esgst.endlessFeatures.push(this.gh_highlightGroups.bind(this))}async gh_highlightGroups(e,t,s,n){const a=e.querySelectorAll(""+(n?`.esgst-es-page-${n} .table__column__heading[href*="/group/"], .esgst-es-page-${n}.table__column__heading[href*="/group/"]`:'.table__column__heading[href*="/group/"]'));if(!a.length)return;const i=JSON.parse(Wl("groups","[]"));for(let e=0,t=a.length;e<t;++e){const t=a[e],s=t.getAttribute("href").match(/\/group\/(.+?)\//)[1];let n;for(n=i.length-1;n>=0&&i[n].code!==s;--n);n>=0&&i[n].member&&t.closest(".table__row-outer-wrap").classList.add("esgst-gh-highlight")}}},jl=hs.getFeatureTooltip.bind(hs);const Hl=new class extends gt{constructor(){super(),this.info={description:()=>Se.element("ul",null,Se.element("li",null,"Adds a button (",Se.element("i",{className:"fa fa-external-link"})," ) below a giveaway's start time (in any page) that allows you to read the description of the giveaway and/or add a comment to it without having to access it."),Se.element("li",null,"You can move the button around by dragging and dropping it.")),id:"gp",name:"Giveaway Popup",sg:!0,type:"giveaways",featureMap:{giveaway:this.gp_addButton.bind(this)}}}gp_addButton(e,t,s){e.forEach(e=>{if(!(e.sgTools||t&&(this.esgst.createdPath||this.esgst.enteredPath||this.esgst.wonPath||this.esgst.giveawayPath||this.esgst.newGiveawayPath))&&!e.innerWrap.getElementsByClassName("esgst-gp-button")[0]&&(!e.inviteOnly||e.url)){let n;const a=()=>new Promise(a=>{this.esgst.modules.giveawaysEnterLeaveGiveawayButton.elgb_openPopup(e,t,s,e=>{e?n.build(3):n.build(1),a()})});n=tt.create({additionalContainerClass:"esgst-gp-button",states:[{color:"white",tooltip:jl("gp","View giveaway description / add a comment"),icons:["fa-external-link"],name:"",switchTo:{onReturn:1},onClick:a},{template:"loading",isDisabled:!0,name:""},{template:"error",tooltip:jl("gp","Could not access giveaway"),name:"",switchTo:{onReturn:3},onClick:a},{template:"loading",isDisabled:!0,name:""}]}).insert(e.panel,"beforeend"),n.nodes.outer.setAttribute("data-draggable-id","gp")}})}},Jl=hs.createElements.bind(hs),Yl=hs.getFeatureTooltip.bind(hs),Kl=hs.getValue.bind(hs),zl=hs.setSetting.bind(hs);const Ql=new class extends gt{constructor(){super(),this.info={description:()=>Se.element("ul",null,Se.element("li",null,'Adds a button ("',Se.element("i",{className:"fa fa-plus-circle"}),' Enter" to enter and "',Se.element("i",{className:"fa fa-minus-circle"})," Leave\" to leave) below a giveaway's start time (in any page) that allows you to enter/leave the giveaway without having to access it."),Se.element("li",null,"You can move the button around by dragging and dropping it.")),features:{elgb_b:{dependencies:["gb"],name:"Automatically bookmark giveaways when trying to enter them without enough points .",sg:!0},elgb_c:{name:"Cache repeated descriptions from the same creator for 1 hour and only show them once.",sg:!0},elgb_f:{inputItems:[{id:"elgb_filters",prefix:"Filters: ",title:"Enter only lowercase letters with no spaces and separate filters with '|'.\n\nFor example, if you want to filter out 'Good luck! No need to thank, unless you're the winner.', use the filter 'goodlucknoneedtothankunlessyourethewinner'.\n\nIf you're familiar with regular expressions, you can also use them. For example, to include a variation of the description above that uses 'you are' instead of 'you're' you could use the filter 'goodlucknoneedtothankunlessyoua?rethewinner'. 'a?' will match or not an 'a' between 'you' and 're'.\n\nThe '.' filter, for example, filters out any descriptions that only have one letter. Generic filters such as '.*' and '.+' will be ignored when applying the filters."}],name:"Filter descriptions.",sg:!0},elgb_p:{description:()=>Se.element("ul",null,Se.element("li",null,"Only shows the button in popups(",Se.element("span",{"data-esgst-feature-id":"gb"}),","," ",Se.element("span",{"data-esgst-feature-id":"ged"}),", ",Se.element("span",{"data-esgst-feature-id":"ge"}),", etc...), so basically only for any giveaways that are loaded dynamically by ESGST.")),name:"Only enable for popups.",sg:!0},elgb_r:{features:{elgb_r_d:{name:"Only pop up if the giveaway has a description.",sg:!0}},name:"Pop up a box to reply to the giveaway when entering it.",sg:!0},elgb_fp:{name:"Pop up the first page of comments of the giveaway when entering it, if it has any comments.",sg:!0}},id:"elgb",name:"Enter / Leave Giveaway Button",sg:!0,type:"giveaways",featureMap:{giveaway:this.elgb_addButtons.bind(this)}}}init(){Ee.subscribe(Oe,this.elgb_updateButtons.bind(this))}async elgb_addButtons(e,t,s){e.forEach(e=>{if(!(e.sgTools||t&&(d.get("elgb_p")||this.esgst.createdPath||this.esgst.wonPath)||e.innerWrap.getElementsByClassName("esgst-elgb-button")[0]))if(this.esgst.enteredPath&&t)this.elgb_setEntryButton(e);else if(!(e.blacklist||e.inviteOnly&&!e.url||!e.started||e.ended||e.created||e.level>Be.counters.level.base||e.id&&this.esgst.games[e.type][e.id]&&(this.esgst.games[e.type][e.id].owned||this.esgst.games[e.type][e.id].won||this.esgst.games[e.type][e.id].hidden&&d.get("hgebd"))))if(this.esgst.giveawayPath&&t){let n=document.getElementsByClassName("sidebar__error is-disabled")[0];if(!n||"Not Enough Points"!==n.textContent.trim())return;e.elgbPanel=Jl(n.parentElement,"afterbegin",[{type:"div"}]),n.remove(),this.elgb_addButton(e,t,s)}else this.elgb_addButton(e,t,s)})}elgb_setEntryButton(e){let t=e.outerWrap.getElementsByClassName("table__remove-default")[0];if(!t)return;let s=t.parentElement,n=Jl(s.parentElement,"beforeend",[{attributes:{class:"esgst-clickable esgst-hidden",title:Yl("elgb")},type:"div",children:[{attributes:{class:"fa fa-plus-circle esgst-green"},type:"i"},{attributes:{class:"table__column__secondary-link"},text:"Add",type:"span"}]},{attributes:{class:"esgst-clickable",title:Yl("elgb")},type:"div",children:[{attributes:{class:"fa fa-times-circle esgst-red"},type:"i"},{attributes:{class:"table__column__secondary-link"},text:"Remove",type:"span"}]},{attributes:{class:"esgst-hidden",title:Yl("elgb")},type:"div",children:[{attributes:{class:"fa fa-refresh fa-spin"},type:"i"},{text:"Adding...",type:"span"}]},{attributes:{class:"esgst-hidden",title:Yl("elgb")},type:"div",children:[{attributes:{class:"fa fa-refresh fa-spin"},type:"i"},{text:"Removing...",type:"span"}]},{attributes:{class:"esgst-hidden",title:Yl("elgb")},type:"div",children:[{attributes:{class:"fa fa-exclamation esgst-red"},type:"i"},{text:"Error",type:"span"}]}]),a=n.previousElementSibling,i=a.previousElementSibling,o=i.previousElementSibling,r=o.previousElementSibling;r.addEventListener("click",this.elgb_addEntry.bind(this,r,i,n,e,o)),o.addEventListener("click",this.elgb_removeEntry.bind(this,r,n,e,o,a)),s.remove()}async elgb_addEntry(e,t,s,n,a){e.classList.add("esgst-hidden"),t.classList.remove("esgst-hidden");try{let e=(await Ne.post("/ajax.php",{data:`xsrf_token=${Be.xsrfToken}&do=entry_insert&code=${n.code}`,doNotQueue:!0})).json;"success"===e.type?a.classList.remove("esgst-hidden"):(d.get("elgb_b")&&d.get("gb")&&n.gbButton&&1===n.gbButton.index&&n.gbButton.change(n.gbButton.callbacks[0]),s.classList.remove("esgst-hidden")),await c.header.updatePoints(e.points)}catch(e){s.classList.remove("esgst-hidden")}t.classList.add("esgst-hidden"),d.get("et")&&this.esgst.modules.giveawaysEntryTracker.et_setEntry(n.code,!0,n.name)}async elgb_removeEntry(e,t,s,n,a){n.classList.add("esgst-hidden"),a.classList.remove("esgst-hidden");try{let n=(await Ne.post("/ajax.php",{data:`xsrf_token=${Be.xsrfToken}&do=entry_delete&code=${s.code}`,doNotQueue:!0})).json;"success"===n.type?e.classList.remove("esgst-hidden"):t.classList.remove("esgst-hidden"),await c.header.updatePoints(n.points)}catch(e){t.classList.remove("esgst-hidden")}a.classList.add("esgst-hidden"),d.get("et")&&this.esgst.modules.giveawaysEntryTracker.et_setEntry(s.code,!1,s.name)}elgb_addButton(e,t,s){e.elgbButton||(e.elgbButton=tt.create({additionalContainerClass:"esgst-elgb-button",states:[{color:"green",icons:["fa-plus-circle"],name:"Enter",onClick:()=>new Promise(n=>this.elgb_enterGiveaway(e,t,null,s,n))},{template:"loading",isDisabled:!0,name:"Entering..."},{color:"yellow",icons:["fa-minus-circle"],name:"Leave",switchTo:{onReturn:1},onClick:()=>new Promise(n=>this.elgb_leaveGiveaway(e,t,s,n))},{template:"loading",isDisabled:!0,name:"Leaving..."},{color:"red",icons:["fa-plus-circle"],name:"Enter",switchTo:{onClick:2},onClick:()=>new Promise(n=>this.elgb_enterGiveaway(e,t,null,s,n))}]}),d.get("gv")&&(t&&this.esgst.giveawaysPath||"gb"===s&&d.get("gv_gb")||"ged"===s&&d.get("gv_ged")||"ge"===s&&d.get("gv_ge"))?e.elgbButton.insert(e.elgbPanel,"afterbegin"):e.elgbButton.insert(e.elgbPanel,"beforeend"),e.elgbButton.nodes.outer.setAttribute("data-draggable-id","elgb"));const n=e.elgbButton.nodes.outer.getAttribute("style");e.entered?(e.elgbButton.build(3),e.elgbButton.setTooltip("")):e.error?(e.elgbButton.build(5),e.elgbButton.setTooltip(e.error)):e.points<=Be.counters.points?(e.elgbButton.build(1),e.elgbButton.setTooltip("")):(e.elgbButton.build(5),e.elgbButton.setTooltip("Not Enough Points")),e.elgbButton.nodes.outer.setAttribute("style",n)}async elgb_openPopup(e,t,s,n){let a=new lt({addScrollable:!0,isTemp:!0,name:"elgb"});const i=pt.create("elgb",[{name:e.creator,url:"/user/"+e.creator},{name:e.name,url:e.url}]).insert(a.description,"afterbegin"),o=rt.find(a.id);if(o&&(o.sourceLink=i.nodes.breadcrumbs[1]),(d.get("cf")&&d.get("cf_m")||d.get("mm"))&&(d.get("cf")&&d.get("cf_m")&&i.nodes.outer.appendChild(this.esgst.modules.commentsCommentFilters.filters_addContainer(i.nodes.outer,"Elgb")),d.get("mm")&&this.esgst.modules.generalMultiManager.mm(i.nodes.outer)),e.entered)tt.create([{color:"yellow",icons:["fa-minus-circle"],name:"Leave Giveaway",onClick:()=>new Promise(n=>{this.elgb_leaveGiveaway(e,t,s,()=>{n(),a.close()})})},{template:"loading",isDisabled:!0,name:"Leaving..."}]).insert(i.nodes.outer,"beforeend");else{let n=JSON.parse(Kl("games"));!e.started||e.ended||e.created||!(e.level<=Be.counters.level.base)||(!e.id||(!n[e.type][e.id]||n[e.type][e.id].owned||n[e.type][e.id].hidden&&d.get("hgebd"))&&n[e.type][e.id])&&e.id||tt.create([{color:"green",icons:["fa-plus-circle"],name:"Enter Giveaway",onClick:()=>new Promise(n=>{this.elgb_enterGiveaway(e,t,!0,s,()=>{n(),a.close()})})},{template:"loading",isDisabled:!0,name:"Entering..."}]).insert(i.nodes.outer,"beforeend")}let l=null,g=null;if(!(d.get("elgb_c")||d.get("elgb_f")||d.get("elgb_r")||d.get("elgb_r_d")||d.get("elgb_fp"))||d.get("elgb_f")&&".*"===d.get("elgb_filters"))return;if(g=(await Ne.get(e.url,{doNotQueue:!0})).html,n&&!g.getElementsByClassName("featured__outer-wrap--giveaway")[0])return void n(!0);if(l=g.getElementsByClassName("page__description")[0],l&&l.textContent.trim()&&!n)if(d.get("elgb_c")){Date.now()-this.esgst.elgbCache.timestamp>36e5&&(this.esgst.elgbCache={descriptions:{},timestamp:Date.now()},r.set("elgbCache",JSON.stringify(this.esgst.elgbCache))),this.esgst.elgbCache.descriptions[e.creator]||(this.esgst.elgbCache.descriptions[e.creator]=[]);let t,s=l.innerHTML;for(t=this.esgst.elgbCache.descriptions[e.creator].length-1;t>-1&&this.esgst.elgbCache.descriptions[e.creator][t]!==s;--t);if(t>-1)l=null;else if(this.esgst.elgbCache.descriptions[e.creator].push(s),r.set("elgbCache",JSON.stringify(this.esgst.elgbCache)),d.get("elgb_f")){l.textContent.replace(/[^a-zA-Z]/g,"").toLowerCase().match(new RegExp(`^(${d.get("elgb_filters")})$`))&&(l=null)}}else if(d.get("elgb_f")){l.textContent.replace(/[^a-zA-Z]/g,"").toLowerCase().match(new RegExp(`^(${d.get("elgb_filters")})$`))&&(l=null)}l&&(l.classList.add("esgst-text-left"),Jl(a.scrollable,"beforeend",[{context:l}]));let u=null;if((d.get("elgb_r")&&(!d.get("elgb_r_d")||l)||n)&&(u=Jl(a.scrollable,"beforeend",[{type:"textarea"}]),d.get("cfh")&&this.esgst.modules.commentsCommentFormattingHelper.cfh_addPanel(u),tt.create([{color:"green",icons:["fa-arrow-circle-right"],name:"Add Comment",onClick:async()=>{u.value&&await Ne.post(e.url,{data:`xsrf_token=${Be.xsrfToken}&do=comment_new&description=${u.value}`}),a.close()}},{template:"loading",isDisabled:!0,name:"Saving..."}]).insert(a.scrollable,"beforeend")),l&&d.get("elgb_f")){const e=tt.create([{color:"alternate-white",tooltip:"Add Description To Filters",icons:["fa-eye"],onClick:async()=>{await zl("elgb_filters",`${d.get("elgb_filters")}|${l.textContent.replace(/[^a-zA-Z]/g,"").toLowerCase()}`),e.destroy()}},{template:"loading",isDisabled:!0,name:"Filtering..."}]).insert(i.nodes.outer.lastElementChild,"beforebegin")}let m=g.querySelector(".comments");if(m&&m.children.length){let e=null;if(d.get("cf")&&d.get("cf_m")&&d.get("cf_enableElgb")){const t=d.get("cf_presetElgb");t&&(e=d.get("cf_presets").filter(e=>e.name===t)[0])}if(e){let t=0;const s=c.esgst.modules.commentsCommentFilters.getFilters(),n=await c.esgst.modules.comments.comments_get(m.parentElement,g);for(const a of n)c.esgst.modules.commentsCommentFilters.filters_filterItem(s,a,e.rules)||(t+=1);t===n.length&&(m=null)}}if(m&&m.children.length)if(m.classList.add("esgst-text-left","esgst-hidden"),Jl(a.scrollable,"beforeend",[{context:m}]),d.get("elgb_fp")||n)m.classList.remove("esgst-hidden"),hs.endless_load(a.scrollable);else{const e=tt.create({color:"alternate-white",tooltip:"Show First Page Comments",icons:["fa-comments"],onClick:()=>{e.destroy(),m.classList.remove("esgst-hidden"),hs.endless_load(a.scrollable)}}).insert(i.nodes.outer.lastElementChild,"beforebegin")}(d.get("elgb_fp")&&m&&m.children.length||l||d.get("elgb_r")&&(!d.get("elgb_r_d")||l)||n)&&(n&&(a.onClose=n),a.open(()=>{u&&u.focus()}))}async elgb_enterGiveaway(e,t,s,n,a){let i=null;try{i=(await Ne.post("/ajax.php",{data:`xsrf_token=${Be.xsrfToken}&do=entry_insert&code=${e.code}`,doNotQueue:!0})).json}catch(t){dt.warning(t.message,t.stack),dt.info(e.code)}i&&("success"===i.type?(this.esgst.giveawayPath&&t||e.innerWrap.classList.add("is-faded"),e.entered=!0,Ee.dispatch(Ye,e),e.error=null,this.elgb_addButton(e,t,n),d.get("et")&&this.esgst.modules.giveawaysEntryTracker.et_setEntry(e.code,!0,e.name),await c.header.updatePoints(i.points),d.get("egh")&&this.esgst.modules.gamesEnteredGameHighlighter.egh_saveGame(e.id,e.type),d.get("gb")&&d.get("gb_ue")&&e.gbButton&&(3===e.gbButton.index&&e.gbButton.change(e.gbButton.callbacks[2]),d.get("gb_se")||e.gbButton.button.classList.add("esgst-hidden")),t&&c.esgst.gf&&c.esgst.gf.filteredCount&&d.get("gf_enable"+this.esgst.gf.type)&&this.esgst.modules.giveawaysGiveawayFilters.filters_filter(this.esgst.gf),(!t||this.esgst.parameters.esgst)&&this.esgst.gfPopup&&this.esgst.gfPopup.filteredCount&&d.get("gf_enable"+this.esgst.gfPopup.type)&&this.esgst.modules.giveawaysGiveawayFilters.filters_filter(this.esgst.gfPopup),a&&a(),s||this.esgst.giveawayPath&&t||this.elgb_openPopup(e,t,n)):(d.get("elgb_b")&&d.get("gb")&&e.gbButton&&1===e.gbButton.index&&e.gbButton.change(e.gbButton.callbacks[0]),e.entered=!1,e.error=i.msg,this.elgb_addButton(e,t,n),a&&a()))}async elgb_leaveGiveaway(e,t,s,n){let a=null;try{a=(await Ne.post("/ajax.php",{data:`xsrf_token=${Be.xsrfToken}&do=entry_delete&code=${e.code}`,doNotQueue:!0})).json}catch(t){dt.warning(t.message,t.stack),dt.info(e.code)}a&&("success"===a.type?(e.innerWrap.classList.remove("is-faded"),e.entered=!1,Ee.dispatch(Ke,e),e.error=null,this.elgb_addButton(e,t,s),d.get("et")&&this.esgst.modules.giveawaysEntryTracker.et_setEntry(e.code,!1,e.name),await c.header.updatePoints(a.points),d.get("gb")&&e.gbButton&&e.gbButton.button.classList.remove("esgst-hidden"),t&&c.esgst.gf&&this.esgst.gf.filteredCount&&d.get("gf_enable"+this.esgst.gf.type)&&this.esgst.modules.giveawaysGiveawayFilters.filters_filter(this.esgst.gf),!t&&this.esgst.gfPopup&&this.esgst.gfPopup.filteredCount&&d.get("gf_enable"+this.esgst.gfPopup.type)&&this.esgst.modules.giveawaysGiveawayFilters.filters_filter(this.esgst.gfPopup),n&&n()):n&&n())}elgb_updateButtons(){let e,t,s;const n=rt.findData("main","giveaways");for(t=0,s=n.length;t<s;++t)e=n[t],e.elgbButton&&!e.entered&&("Not Enough Points"===e.error&&(e.error=null),this.elgb_addButton(e,!0));d.get("ttec")&&this.esgst.modules.giveawaysTimeToEnterCalculator.ttec_calculateTime(n,!0)}},Zl=hs.createElements.bind(hs),Xl=hs.getValue.bind(hs),ec=hs.setValue.bind(hs);const tc=new class extends gt{constructor(){super(),this.info={description:()=>Se.element("ul",null,Se.element("li",null,"Adds a box to the sidebar of any"," ",Se.element("a",{href:"https://www.steamgifts.com/giveaway/aeqw7/"},"giveaway")," page that shows the best current deal for the game, the historical lowest price of the game and a list with all of the bundles that the game has been in. All of this information is retrieved from"," ",Se.element("a",{href:"https://isthereanydeal.com"},"IsThereAnyDeal"),"."),Se.element("li",null,"Results are cached for 24 hours, so if you access a giveaway for the same game again within that timeframe, the information will not change.")),id:"itadi",name:"IsThereAnyDeal Info",sg:!0,type:"giveaways"}}async init(){this.esgst.giveawayPath&&await ut.contains([["isThereAnyDeal"]])&&this.esgst.giveawayFeatures.push(this.itadi_getGiveaways.bind(this))}itadi_getGiveaways(e,t){if(!t)return;const s=Date.now();for(const t of e)this.itadi_getInfo(s,t)}async itadi_getInfo(e,t){const s=this.esgst.games[t.type][t.id];let n=null;const a=this.itadi_getPlain(t.name);if(s&&s.itadi&&2===s.itadi.version&&e-s.itadi.lastCheck<864e5)n=s.itadi;else{const e=Zl(this.esgst.sidebar,"beforeend",[{attributes:{class:"sidebar__heading"},type:"h3",children:[{attributes:{class:"fa fa-circle-o-notch fa-spin"},type:"i"},{text:" Loading IsThereAnyDeal info...",type:"node"}]}]);n=await this.itadi_loadInfo(t,a),e.remove()}this.itadi_addInfo(n,a)}async itadi_loadInfo(e,t){const s={bundles:[],current:null,historical:null,lastCheck:Date.now(),version:2},n=await Ne.get(`https://isthereanydeal.com/game/${t}/info/`,{queue:!0}),a=n.html.querySelectorAll("#gh-po tr");for(const e of a){const t=e.firstElementChild.textContent.trim().match(/(Current\sBest|Historical\sLow)/);t&&(s["Current Best"===t[1]?"current":"historical"]={cut:e.querySelector(".gh-po__cut").textContent.trim(),date:e.querySelector(".date").textContent.trim(),price:e.querySelector(".gh-po__price").textContent.trim(),source:e.querySelector(".gh-po__shopTitle").textContent.trim()})}const i=n.html.querySelectorAll(".bundleTable tr:not(:first-child)");for(const e of i){const t=e.querySelector(".t-st3--link");s.bundles.push({expiry:e.querySelector(".bundleTable__expiry").textContent.trim(),id:t.getAttribute("href").match(/id\/(.+)/)[1],name:t.textContent.trim(),price:e.querySelector(".t-st3__price").textContent.trim(),source:e.querySelector(".shopTitle").textContent.trim()})}const o=new Te("game",{threshold:300});await o.lock();const r=JSON.parse(Xl("games"));return r[e.type][e.id]||(r[e.type][e.id]={}),r[e.type][e.id].itadi=s,await ec("games",JSON.stringify(r)),await o.unlock(),s}itadi_template(e){return[{attributes:{class:"sidebar__heading"},text:e,type:"h3"},{attributes:{class:"sidebar__navigation"},type:"ul",children:[]}]}itadi_itemTemplate(e,t,s){return{attributes:{class:"sidebar__navigation__item"},type:"li",children:[{attributes:{class:"sidebar__navigation__item__link",href:s},type:"a",children:[{attributes:{class:"sidebar__navigation__item__name"},text:e,type:"div"},{attributes:{class:"sidebar__navigation__item__underline"},type:"div"},{attributes:{class:"sidebar__navigation__item__count"},text:t,type:"div"}]}]}}itadi_noItemTemplate(e){return{text:e,type:"node"}}itadi_addInfo(e,t){const s=[...this.itadi_template("Best Current Deal"),...this.itadi_template("Historical Lowest Price"),...this.itadi_template("Bundles")];if(e.current?s[1].children.push(this.itadi_itemTemplate(`${e.current.source} (${e.current.date})`,`${e.current.price} (${e.current.cut})`,`https://isthereanydeal.com/game/${t}/info/`)):s[1].children.push(this.itadi_noItemTemplate("There are no current deals for this game.")),e.historical?s[3].children.push(this.itadi_itemTemplate(`${e.historical.source} (${e.historical.date})`,`${e.historical.price} (${e.historical.cut})`,`https://isthereanydeal.com/game/${t}/info/`)):s[3].children.push(this.itadi_noItemTemplate("There is no price history for this game.")),e.bundles&&e.bundles.length)for(const t of e.bundles)s[5].children.push(this.itadi_itemTemplate(`${t.name} (${t.source})`,`${t.price} (${t.expiry})`,"https://isthereanydeal.com/specials/#/filter:id/"+t.id));else s[5].children.push(this.itadi_noItemTemplate("This game has never been in a bundle."));Zl(this.esgst.sidebar,"beforeend",s)}itadi_getPlain(e){return e.toLowerCase().replace(/\sthe|the\s/g,"").replace(/\s/g,"").replace(/\d/g,e=>["0","i","ii","iii","iv","v","vi","vii","viii","ix"][e]).replace(/&/g,"and").replace(/\+/g,"plus").replace(/[^\d\w]/g,"")}},sc=hs.createElements.bind(hs),nc=hs.getFeatureTooltip.bind(hs),ac=hs.unhideGame.bind(hs);const ic=new class extends gt{constructor(){super(),this.info={description:()=>Se.element("ul",null,Se.element("li",null,"Adds a button (",Se.element("i",{className:"fa fa-eye"}),") next to a giveaway's game name (in any page), if you have hidden the game on SteamGifts, that allows you to unhide the game without having to access your"," ",Se.element("a",{href:"https://www.steamgifts.com/account/settings/giveaways/filters"},"giveaway filters")," ","page.")),id:"ugb",name:"Unhide Giveaway Button",sg:!0,type:"giveaways",featureMap:{giveaway:this.ugb_add.bind(this)}}}ugb_add(e,t){e.forEach(e=>{let s=e.innerWrap.querySelector(".giveaway__hide, .featured__giveaway__hide");s||t&&!this.esgst.giveawaysPath&&!this.esgst.giveawayPath||(s=this.esgst.giveawayPath&&t?sc(e.headingName,"afterend",[{type:"a",children:[{attributes:{class:"fa fa-eye giveaway__hide",title:nc("ugb","Unhide all giveaways for this game")},type:"i"}]}]):sc(e.headingName,"afterend",[{attributes:{class:"fa fa-eye giveaway__hide giveaway__icon",title:nc("ugb","Unhide all giveaways for this game")},type:"i"}]),s.addEventListener("click",ac.bind(hs,s,e.gameId,e.name,e.id,e.type)))})}};const oc=new class extends gt{constructor(){super(),this.info={description:()=>Se.element("ul",null,Se.element("li",null,"When you click on the icon ",Se.element("i",{className:"fa fa-eye-slash"})," next to a giveaway's game name, the game will be hidden immediately, without any confirmation popup being shown.")),features:{ochgb_f:{description:()=>Se.element("ul",null,Se.element("li",null,"With this option enabled, when you hide a game, instead of all of the giveaways for the game being removed from the page, they are simply faded out.")),name:"Fade hidden giveaways instead of removing them.",sg:!0}},id:"ochgb",name:"One-Click Hide Giveaway Button",sg:!0,type:"giveaways",featureMap:{giveaway:this.ochgb_setButton.bind(this)}}}ochgb_setButton(e,t){e.forEach(e=>{let s=e.innerWrap.querySelector(".giveaway__hide, .featured__giveaway__hide");if(!s)return;let n=s.classList.contains("fa-eye");this.esgst.giveawayPath&&t&&(s=s.parentElement),e.fade=this.ochgb_fadeGiveaway.bind(this,e,t),e.unfade=this.ochgb_unfadeGiveaway.bind(this,e,t),e.ochgbButton=new Us(s,"afterend",{callbacks:[this.ochgb_hideGiveaway.bind(this,e,t),null,this.ochgb_unhideGiveaway.bind(this,e,t),null],className:"esgst-ochgb "+(this.esgst.giveawayPath&&t?"":"giveaway__icon"),icons:["fa-eye-slash esgst-clickable","fa-circle-o-notch fa-spin","fa-eye esgst-clickable","fa-circle-o-notch fa-spin"],id:"ochgb",index:n?2:0,titles:["Hide all giveaways for this game","Hiding giveaways...","Unhide all giveaways for this game","Unhiding giveaways..."]}),e.ochgbButton.button.setAttribute("data-draggable-id","hideGame"),s.remove()})}ochgb_fadeGiveaway(e,t){(this.esgst.giveawayPath&&!t||!this.esgst.giveawayPath)&&e.innerWrap.classList.add("esgst-faded")}ochgb_unfadeGiveaway(e,t){(this.esgst.giveawayPath&&!t||!this.esgst.giveawayPath)&&e.innerWrap.classList.remove("esgst-faded")}async ochgb_hideGiveaway(e,t){return await Ne.post("/ajax.php",{data:`xsrf_token=${Be.xsrfToken}&do=hide_giveaways_by_game_id&game_id=${e.gameId}`}),this.ochgb_completeProcess(e,"fade",t),await hs.updateHiddenGames(e.id,e.type),!0}async ochgb_unhideGiveaway(e,t){return await Ne.post("/ajax.php",{data:`xsrf_token=${Be.xsrfToken}&do=remove_filter&game_id=${e.gameId}`}),this.ochgb_completeProcess(e,"unfade",t),await hs.updateHiddenGames(e.id,e.type,!0),!0}ochgb_completeProcess(e,t,s){if(s&&this.esgst.giveawayPath)return;const n=rt.findData("current","giveaways");if(d.get("ochgb_f"))for(const s of n)s.gameId===e.gameId&&(s[t](),s!==e&&s.ochgbButton&&(s.ochgbButton.index="fade"===t?2:0,s.ochgbButton.change()));else for(const t of n)t.gameId===e.gameId&&t.outerWrap.remove()}};const rc=new class extends gt{constructor(){super(),this.info={description:()=>Se.element("ul",null,Se.element("li",null,"Displays information for open invite-only giveaways in profile pages if the information is available in the storage."),Se.element("li",null,"To add information about a giveaway from someone else to the storage, you must enter the giveaway and visit your entered page with ",Se.element("span",{"data-esgst-feature-id":"cewgd"})," ","enabled."),Se.element("li",null,"To add information about your own giveaways to the storage, you must sync your giveaways in the sync menu or check your profile with ",Se.element("span",{"data-esgst-feature-id":"ugd"}),".")),id:"viog",name:"Visible Invite-Only Giveaways",sg:!0,type:"giveaways",featureMap:{giveaway:this.viog_display.bind(this)}}}viog_display(e){if(c.esgst.userPath)for(const t of e){if(!t.inviteOnly||t.id)continue;const e=Object.keys(this.esgst.giveaways).map(e=>this.esgst.giveaways[e]).filter(e=>e.gameSteamId&&e.gameType&&e.gameName&&e.points&&e.copies&&(e.code&&e.code===t.code||e.creator&&e.creator.toLowerCase()==t.creator.toLowerCase()&&e.startTime&&e.startTime===t.startTime&&e.endTime&&e.endTime===t.endTime))[0];e&&(t.id=e.gameSteamId,t.type=e.gameType,t.name=e.gameName,t.points=e.points,t.copies=e.copies,t.url=`/giveaway/${e.code}/`,t.headingName.setAttribute("href",t.url),t.headingName.textContent=t.name,t.entriesLink.setAttribute("href",t.url+"_/entries"),t.commentsLink.setAttribute("href",t.url),t.image.classList.remove("giveaway_image_thumbnail_missing"),t.image.classList.add("giveaway_image_thumbnail"),t.image.setAttribute("href",t.url),t.image.style.backgroundImage=`url("https://steamcdn-a.akamaihd.net/steam/${t.type}/${t.id}/capsule_184x69.jpg")`,t.image.innerHTML="",Se.insert(t.heading,"beforeend",Se.element("fragment",null,Se.element("span",{className:"giveaway__heading__thin","data-draggable-id":"points",ref:e=>t.pointsContainer=e},`(${t.points}P)`),t.copies>1?Se.element("span",{className:"giveaway__heading__thin","data-draggable-id":"copies",ref:e=>t.copiesContainer=e},`(${t.copies} Copies)`):null,Se.element("a",{className:"giveaway__icon","data-draggable-id":"steam",href:`https://store.steampowered.com/${t.type.slice(0,-1)}/${t.id}/`,rel:"nofollow",target:"_blank"},Se.element("i",{className:"fa fa-steam"})),Se.element("a",{className:"giveaway__icon","data-draggable-id":"search",href:`/giveaways/search?${t.type.slice(0,-1)}/${t.id}`},Se.element("i",{className:"fa fa-search"})))))}}},lc=hs.createElements.bind(hs);const cc=new class extends gt{constructor(){super(),this.info={description:()=>Se.element("ul",null,Se.element("li",null,"Adds a link next to an ended giveaway's \"Entries\" link (in any page) that shows how many winners the giveaway has and takes you to the giveaway's"," ",Se.element("a",{href:"https://www.steamgifts.com/giveaway/aeqw7/dead-space/winners"},"winners")," page.")),id:"gwl",name:"Giveaway Winners Link",sg:!0,type:"giveaways",featureMap:{giveaway:this.gwl_addLinks.bind(this)}}}gwl_addLinks(e,t){((this.esgst.createdPath||this.esgst.enteredPath||this.esgst.wonPath||this.esgst.giveawayPath||this.esgst.archivePath)&&!t||!(this.esgst.giveawayPath||this.esgst.createdPath||this.esgst.enteredPath||this.esgst.wonPath||this.esgst.archivePath))&&e.forEach(e=>{if(e.innerWrap.getElementsByClassName("esgst-gwl")[0]||!e.ended)return;const t={class:"esgst-gwl","data-draggable-id":"winners_count"};e.url&&(t.href=e.url+"/winners"),lc(e.entriesLink,"afterend",[{attributes:t,type:"a",children:[{attributes:{class:"fa fa-trophy"},type:"i"},{text:e.numWinners+" winners",type:"span"}]}])})}},dc=hs.createElements.bind(hs),gc=hs.getFeatureTooltip.bind(hs);const uc=new class extends gt{constructor(){super(),this.info={description:()=>Se.element("ul",null,Se.element("li",null,"Adds an element (",Se.element("i",{className:"fa fa-clock-o"})," [Time]) below the start time of a giveaway that you do not have enough points to enter(in any page) that shows how much time you have to wait until you have enough points to enter the giveaway."),Se.element("li",null,"The time is calculated by rounding up the result (which is in milliseconds) of the following formula: next_refresh_in_milliseconds + (15 * (⌈(number_of_points_to_enter - number_of_points_you_have) / 6⌉ - 1), where next_refresh_in_milliseconds = the time that the next point refresh will happen (you get 6 points every 15 minutes of the hour on SteamGifts, so if it is currently 12:10pm, the next refresh will be at 12:15pm)"),Se.element("li",null,"You can move the element around by dragging and dropping it.")),id:"ttec",name:"Time To Enter Calculator",sg:!0,type:"giveaways",featureMap:{giveaway:this.ttec_calculateTime.bind(this)}}}ttec_calculateTime(e,t,s){let n;if(!t||!this.esgst.createdPath&&!this.esgst.enteredPath&&!this.esgst.wonPath&&!this.esgst.newGiveawayPath){for(n=60-(new Date).getMinutes();n>15;)n-=15;e.forEach(e=>{!e.ended&&!e.entered&&e.points>Be.counters.points?(e.ttec||(e.ttec=dc(e.panel,d.get("gv")&&(t&&this.esgst.giveawaysPath||"gb"===s&&d.get("gv_gb")||"ged"===s&&d.get("gv_ged")||"ge"===s&&d.get("gv_ge"))?"beforeend":"afterbegin",[{attributes:{class:(this.esgst.giveawayPath?"featured__column":"")+" esgst-ttec","data-draggable-id":"ttec",title:gc("ttec","Time to wait until you have enough points to enter this giveaway")},type:"div"}])),e.ttec.classList.remove("esgst-hidden"),dc(e.ttec,"atinner",[{attributes:{class:"fa fa-clock-o"},type:"i"},{text:" "+this.ttec_getTime(Math.round(100*(n+15*(Math.ceil((e.points-Be.counters.points)/6)-1)))/100),type:"node"}])):e.ttec&&e.ttec.classList.add("esgst-hidden")})}}ttec_getTime(e){let t,s,n;return s=Math.round(e/60*10)/10,Math.floor(s)>0?(t=Math.round(e/60/24*10)/10,Math.floor(t)>0?(n=Math.round(t/60/24/7*10)/10,Math.floor(n)>0?n+"w":t+"d"):s+"h"):e+"m"}};const mc=new class extends gt{constructor(){super(),this.info={description:()=>Se.element("ul",null,Se.element("li",null,"Allows you to load many different content (such as giveaway groups) without leaving the page.")),features:{cl_gc:{description:()=>Se.element("ul",null,Se.element("li",null,"Loads a giveaway's countries when clicking / hovering over (depending on preference) on its region restriction icon (",Se.element("i",{className:"fa fa-globe"}),").")),name:"Giveaway Countries",options:{title:"Load as:",values:["~Panel (On Page Load)","Popout (On Hover)","Popout (On Click)","Popup (On Click)"]},sg:!0},cl_ge:{description:()=>Se.element("ul",null,Se.element("li",null,'Loads a giveaway\'s entries when clicking / hovering over (depending on preference) on its "Entries" link.')),name:"Giveaway Entries",options:{title:"Load as:",values:["~Panel (On Page Load)","Popout (On Hover)","Popout (On Click)","Popup (On Click)"]},sg:!0},ggl:{description:()=>Se.element("ul",null,Se.element("li",null,"Loads a giveaway's groups when clicking / hovering over (depending on preference) on its group icon (",Se.element("i",{className:"fa fa-user"}),") or automatically when loading the page (extends to your"," ",Se.element("a",{href:"https://www.steamgifts.com/giveaways/created"},"created")," /"," ",Se.element("a",{href:"https://www.steamgifts.com/giveaways/entered"},"entered")," /"," ",Se.element("a",{href:"https://www.steamgifts.com/giveaways/won"},"won")," pages if"," ",Se.element("span",{"data-esgst-feature-id":"cewgd"})," is enabled)."),Se.element("li",null,"Has ",Se.element("span",{"data-esgst-feature-id":"gh"})," built-in.")),features:{ggl_m:{name:"Only show groups that you are a member of.",sg:!0}},name:"Giveaway Groups",options:{title:"Load as:",values:["Panel (On Page Load)","Popout (On Hover)","Popout (On Click)","Popup (On Click)"]},sg:!0,sync:"Steam Groups",syncKeys:["Groups"]},cl_gi:{description:()=>Se.element("ul",null,Se.element("li",null,"Loads a group's info when clicking / hovering over (depending on preference) its avatar.")),name:"Group Info",options:{title:"Load as:",values:["~Panel (On Page Load)","Popout (On Hover)","Popout (On Click)","~Popup (On Click)"]},sg:!0},cl_ui:{description:()=>Se.element("ul",null,Se.element("li",null,"Loads a user's info when clicking / hovering over (depending on preference) its avatar.")),name:"User Info",options:{title:"Load as:",values:["~Panel (On Page Load)","Popout (On Hover)","Popout (On Click)","~Popup (On Click)"]},sg:!0}},id:"cl",name:"Content Loader",sg:!0,st:!0,type:"general"}}init(){d.get("cl_gc")&&c.esgst.giveawayFeatures.push(this.setTriggers.bind(this,"cl_gc")),d.get("cl_ge")&&c.esgst.giveawayFeatures.push(this.setTriggers.bind(this,"cl_ge")),d.get("ggl")&&c.esgst.giveawayFeatures.push(this.setTriggers.bind(this,"ggl")),d.get("cl_gi")&&c.esgst.endlessFeatures.push(this.setTriggers.bind(this,"cl_gi")),d.get("cl_ui")&&(c.esgst.endlessFeatures.push(this.setTriggers.bind(this,"cl_ui")),c.esgst.userFeatures.push(this.setTriggers.bind(this,"cl_ui")))}setTriggers(e,t,s,n,a){let i;switch(e){case"cl_gc":if(i=t.filter(e=>e.regionRestricted),!s||!c.esgst.createdPath&&!c.esgst.enteredPath&&!c.esgst.wonPath)for(const t of i)this.setTrigger(s,e,t,t.regionRestricted);break;case"cl_ge":if(i=t.filter(e=>e.entriesLink),!s||!c.esgst.wonPath)for(const t of i){let n=t.entriesLink;(c.esgst.createdPath||c.esgst.enteredPath)&&(n.innerHTML=`\n\t\t\t\t\t\t\t\t<a class="table__column__secondary-link" href="${t.url}/entries">${n.textContent}</a>\n\t\t\t\t\t\t\t`,n=n.firstElementChild),this.setTrigger(s,e,t,n)}break;case"ggl":if(i=t.filter(e=>e.group),0===d.get(e+"_index"))this.load(s,e,i);else if(!s||!c.esgst.createdPath&&!c.esgst.enteredPath&&!c.esgst.wonPath)for(const t of i)this.setTrigger(s,e,t,t.group);break;case"cl_gi":case"cl_ui":if(Array.isArray(t)){i=t.filter(e=>e.oldElement&&!e.oldElement.classList.contains("esgst-ap-avatar"));for(const t of i)this.setTrigger(s,e,{},t.oldElement)}else{const n=c.common.getSelectors(a,["X.global__image-outer-wrap--avatar-small","X.giveaway_image_avatar","X.table_image_avatar","X.featured_giveaway_image_avatar","X.nav__avatar-outer-wrap"]);i=t.querySelectorAll(n);for(const t of i)t.classList.contains("esgst-ap-avatar")||this.setTrigger(s,e,{},t)}}}setTrigger(e,t,s,n){let a,i,o,r,l,g,u;if("cl_gi"===t||"cl_ui"===t){const e=n.getAttribute("href");if(!e)return;s.url=e.match(/\/profiles\//)?"/user/"+n.textContent:e;const a=s.url.match(/\/(user|group)\/(.+?)(\/.*)?$/);if(!a||"user"===a[1]&&"cl_ui"!==t||"group"===a[1]&&"cl_gi"!=t)return;s.type=a[1],s.id=a[2],n.classList.add("esgst-ap-avatar")}switch(d.get(t+"_index")){case 1:i=1e3,r="mouseenter",g=!1,n.addEventListener("mouseleave",e=>{o&&(window.clearTimeout(o),o=null),l=window.setTimeout(()=>{u&&!a.contains(e.relatedTarget)&&u.close()},i)}),n.addEventListener("click",()=>{o&&(window.clearTimeout(o),o=null)});break;case 2:case 3:i=0,r="click",g=!0,n.getAttribute("href")&&(n.dataset.href=n.getAttribute("href"),n.removeAttribute("href")),n.classList.add("esgst-clickable")}n.addEventListener(r,r=>{r.preventDefault(),o=window.setTimeout(async()=>{if("cl_gi"!==t&&"cl_ui"!==t||(u=c.esgst.apPopouts[s.id],u&&(a=u.popout)),u)switch(d.get(t+"_index")){case 1:u.open(n);break;case 2:u.isOpen?u.close():u.open(n);break;case 3:u.open()}else{let i,o,r,l=!1;switch(t){case"cl_gc":l=!0,i="globe",o="Giveaway Countries",r=s.url+"/region-restrictions";break;case"cl_ge":l=!0,i="tag",o="Giveaway Entries",r=s.url+"/entries";break;case"ggl":l=!0,i="user",o="Giveaway Groups",r=s.url+"/groups"}"cl_gi"===t||"cl_ui"===t?(c.esgst.apPopouts[s.id]=u=new mt("esgst-ap-popout",void 0,void 0,g),a=u.popout,u.open(n)):3===d.get(t+"_index")?(u=new lt({addScrollable:!0,icon:"fa-"+i,title:Se.element("a",{href:r},o)}),a=u.scrollable,u.open()):(u=new mt(`esgst-${t}-popout`,void 0,void 0,g),a=u.popout,Se.insert(a,"beforeend",Se.element("div",null,Se.element("a",{className:`esgst-${t}-heading`,href:r},o))),u.open(n)),Se.insert(a,"beforeend",Se.element("fragment",null,l?Se.element("input",{placeholder:"Search...",type:"text",ref:e=>u.custom.searchBox=e}):null,Se.element("div",null))),u.custom.searchBox&&u.custom.searchBox.addEventListener("input",()=>{const e=u.custom.searchBox.value.toLowerCase(),t=u.custom.rows.children;if(e){u.custom.isSearching=!0;for(const s of t)s.textContent.toLowerCase().match(e)?s.classList.remove("esgst-hidden"):s.classList.add("esgst-hidden")}else{for(const e of t)e.classList.remove("esgst-hidden");u.custom.isSearching=!1}u.reposition()}),Se.insert(a.lastElementChild,"atinner",Se.element("fragment",null,Se.element("i",{className:"fa fa-circle-o-notch fa-spin"})," Loading content...")),u.reposition(),this.load(e,t,[s],u,a)}1===d.get(t+"_index")&&(a.onmouseenter=()=>{l&&(window.clearTimeout(l),l=null)})},i)})}load(e,t,s,n,a){switch(t){case"cl_gc":this.loadGiveawayCountries(e,t,s,n,a);break;case"cl_ge":this.loadGiveawayEntries(e,t,s,n,a);break;case"ggl":this.loadGiveawayGroups(e,t,s,n,a);break;case"cl_gi":case"cl_ui":this.loadInfo(e,t,s,n,a)}}async loadGiveawayCountries(e,t,s,n,a){for(const e of s)try{await this.fetchGiveawayCountries(e,n,a)}catch(e){dt.warning(e.message,e.stack)}}async fetchGiveawayCountries(e,t,s){let n=[];const a=e.url+"/region-restrictions/search?page=";let i,o=1;do{const e=await Ne.get(`${a}${o}`);if(e.html.querySelector(".table--summary")){n=null;break}const t=e.html.querySelectorAll(".table__row-inner-wrap");for(const e of t){const t=!!e.querySelector(".table_image_flag"),s=e.querySelector(".table__column__heading").textContent,a=s.match(/\s\((.+?)\)$/)[1].toLowerCase();n.push({code:a,hasFlag:t,name:s})}o+=1,i=e.html.querySelector(".pagination__navigation")}while(i&&!i.lastElementChild.classList.contains("is-selected"));if(n){let e;Se.insert(s.lastElementChild,"atinner",Se.element("div",{className:"esgst-text-left table esgst-hidden",ref:t=>e=t},Se.element("div",{className:"table__rows",ref:e=>t.custom.rows=e})));let a=n.length;for(const e of n)Se.insert(t.custom.rows,"beforeend",Se.element("div",{className:"table__row-outer-wrap"},Se.element("div",{className:"table__row-inner-wrap"},Se.element("div",null,e.hasFlag?Se.element("div",{className:"table_image_flag",style:{backgroundImage:`url(https://cdn.steamgifts.com/img/flags/${e.code}.png)`}}):Se.element("div",{className:"table_image_flag_missing"})),Se.element("div",{className:"table__column--width-fill"},Se.element("p",{className:"table__column__heading"},e.name)))));0===a?Se.insert(s.lastElementChild,"atinner",Se.element("fragment",null,Se.element("i",{className:"fa fa-exclamation-mark"}),Se.element("span",null,"You cannot see the countries of this giveaway."))):e&&(e.classList.remove("esgst-hidden"),t.custom.searchBox&&t.custom.searchBox.classList.remove("esgst-hidden"))}else Se.insert(s.lastElementChild,"atinner",Se.element("fragment",null,Se.element("i",{className:"fa fa-times-circle"}),Se.element("span",null,"An error occurred.")));t.reposition()}async loadGiveawayEntries(e,t,s,n,a){for(const e of s)try{await this.fetchGiveawayEntries(e,n,a)}catch(e){dt.warning(e.message,e.stack)}}async fetchGiveawayEntries(e,t,s){let n=!1,a=!1;const i=e.url+"/entries/search?page=";let o,r=1;const l=async()=>{let e;n=!0,Se.insert(s,"beforeend",Se.element("div",{ref:t=>e=t},Se.element("i",{className:"fa fa-circle-o-notch fa-spin"}),Se.element("span",null,"Loading next page...")));const l=await Ne.get(`${i}${r}`);if(l.html.querySelector(".table--summary"))return a=!0,e.remove(),void Se.insert(s.lastElementChild,"atinner",Se.element("fragment",null,Se.element("i",{className:"fa fa-exclamation-mark"}),Se.element("span",null,"You cannot see the entries of this giveaway.")));t.custom.searchBox&&t.custom.searchBox.classList.remove("esgst-hidden");const d=[],g=l.html.querySelectorAll(".table__row-inner-wrap");for(const e of g){const t=e.querySelector(".table_image_avatar"),s=t?t.style.backgroundImage.match(/url\("(.+)"\)/)[1]:null,n=e.querySelector(".table__column__heading").textContent;d.push({avatar:s,name:n})}const u=document.createDocumentFragment();for(const e of d)Se.insert(u,"beforeend",Se.element("div",{className:"table__row-outer-wrap"},Se.element("div",{className:"table__row-inner-wrap"},Se.element("div",null,e.avatar?Se.element("a",{className:"table_image_avatar",href:"/user/"+e.name,style:{backgroundImage:`url(${e.avatar})`}}):Se.element("div",{className:"table_image_avatar_missing"})),Se.element("div",{className:"table__column--width-fill"},Se.element("a",{className:"table__column__heading",href:"/user/"+e.name},e.name)))));e.remove(),await c.common.endless_load(u),t.custom.rows.appendChild(u),t.reposition(),r+=1,o=l.html.querySelector(".pagination__navigation"),o&&!o.lastElementChild.classList.contains("is-selected")||(a=!0),n=!1};s.addEventListener("scroll",()=>{n||a||t.custom.isSearching||s.scrollTop+s.offsetHeight>=s.scrollHeight&&l()}),Se.insert(s.lastElementChild,"atinner",Se.element("div",{className:"esgst-text-left table"},Se.element("div",{className:"table__rows",ref:e=>t.custom.rows=e}))),t.reposition(),l()}async loadGiveawayGroups(e,t,s,n,a){const i={},o={};for(const e of s)try{await this.fetchGiveawayGroups(e,n,a,i,o)}catch(e){dt.warning(e.message,e.stack)}e&&c.esgst.gf&&c.esgst.gf.filteredCount&&d.get("gf_enable"+c.esgst.gf.type)&&c.esgst.modules.giveawaysGiveawayFilters.filters_filter(c.esgst.gf),!e&&c.esgst.gfPopup&&c.esgst.gfPopup.filteredCount&&d.get("gf_enable"+c.esgst.gfPopup.type)&&c.esgst.modules.giveawaysGiveawayFilters.filters_filter(c.esgst.gfPopup),await Promise.all([c.common.lockAndSaveGiveaways(i),c.common.lockAndSaveGroups(o)])}async fetchGiveawayGroups(e,t,s,n,a){let i;if(c.esgst.giveaways[e.code]&&Array.isArray(c.esgst.giveaways[e.code].groups)&&c.esgst.giveaways[e.code].groups.length&&!c.esgst.giveaways[e.code].groups.filter(e=>!c.esgst.groups.filter(t=>e===t.code)[0])[0])i=c.esgst.giveaways[e.code].groups;else{i=[];const t=e.url+"/groups/search?page=";let s,o=1;do{const e=await Ne.get(`${t}${o}`);if(e.html.querySelector(".table--summary")){i=null;break}const n=e.html.querySelectorAll(".table__row-inner-wrap");for(const e of n){const t=e.querySelector(".table_image_avatar"),s=t?t.style.backgroundImage.match(/url\("(.+)"\)/)[1]:null,n=e.querySelector(".table__column__heading"),o=n.getAttribute("href").match(/group\/(.+?)\//)[1],r=n.textContent||t.href.replace("/group/","").split("/").pop().replace(/[-_]+/g," ")||"";i.push(o),a[o]={avatar:s,code:o,name:r}}o+=1,s=e.html.querySelector(".pagination__navigation")}while(s&&!s.lastElementChild.classList.contains("is-selected"));i&&(n[e.code]={groups:i})}if(t){if(i){let e;Se.insert(s.lastElementChild,"atinner",Se.element("div",{className:"esgst-text-left table esgst-hidden",ref:t=>e=t},Se.element("div",{className:"table__rows",ref:e=>t.custom.rows=e})));let n=0;for(const e of i){let s;const i=c.esgst.groups.filter(t=>t.code===e)[0]||a[e];i.member?(s="esgst-ggl-member",n+=1):d.get("ggl_m")?s="esgst-hidden":(s="",n+=1),"esgst-hidden"!==s&&Se.insert(t.custom.rows,"beforeend",Se.element("div",{className:"table__row-outer-wrap "+s},Se.element("div",{className:"table__row-inner-wrap"},Se.element("div",null,i.avatar?Se.element("a",{className:"table_image_avatar",href:"/group/"+i.code,style:{backgroundImage:`url(${i.avatar})`}}):Se.element("div",{className:"table_image_avatar_missing"})),Se.element("div",{className:"table__column--width-fill"},Se.element("a",{className:"table__column__heading",href:`/group/${i.code}/`},i.name)))))}0===n?Se.insert(s.lastElementChild,"atinner",Se.element("fragment",null,Se.element("i",{className:"fa fa-exclamation-mark"}),Se.element("span",null,"You are not a member of any group in this giveaway."))):e&&(e.classList.remove("esgst-hidden"),t.custom.searchBox&&t.custom.searchBox.classList.remove("esgst-hidden"),c.common.endless_load(e))}else Se.insert(s.lastElementChild,"atinner",Se.element("fragment",null,Se.element("i",{className:"fa fa-times-circle"}),Se.element("span",null,"An error occurred.")));t.reposition()}else if(i&&!e.summary.querySelector(".esgst-ggl-panel")){let t;Se.insert(e.extraPanel||e.summary,"beforeend",Se.element("div",{className:"esgst-ggl-panel","data-draggable-id":"ggl",ref:e=>t=e})),c.esgst.modules.giveaways.giveaways_reorder(e),e.groups=[],e.groupNames=[],e.nonMemberGroup=!1;let s=0,n=0;for(const o of i){let i;const r=c.esgst.groups.filter(e=>e.code===o)[0]||a[o];r.member?(i="esgst-ggl-member",s+=1,n+=1):d.get("ggl_m")?i="esgst-hidden":(i="",s+=1),e.groups.push(r.name.toLowerCase()),e.groupNames.push(r.name),"esgst-hidden"!==i&&(Se.insert(t,"beforeend",Se.element("div",{className:i},r.avatar?Se.element("a",{className:"table_image_avatar",href:`/group/${r.code}/`,style:{backgroundImage:`url(${r.avatar})`}}):Se.element("div",{className:"table_image_avatar_missing"}),Se.element("a",{href:`/group/${r.code}/`},r.name))),d.get("cl_gi")&&this.setTriggers("cl_gi",t))}0===s&&t.remove(),0===n&&(e.nonMemberGroup=!0)}}async loadInfo(e,t,s,n,a){for(const e of s)try{await this.fetchInfo(e,n,a)}catch(e){dt.warning(e.message,e.stack)}}async fetchInfo(e,t,s){const n=await Ne.get(e.url),a=n.html.querySelector(".featured__heading__medium");if(""===a.textContent.trim()){const e=n.html.querySelector('head script[type="text/javascript"]').textContent.match(/var baseUrl = "([^"]+)";/)[1].split("/").pop();a.textContent=e?e.replace(/[-_]+/g," "):""}s.innerHTML="",s.appendChild(n.html.querySelector(".featured__outer-wrap"));const i=s.querySelector(".global__image-outer-wrap--avatar-large");let o;Se.insert(i,"afterend",Se.element("a",{className:"esgst-ap-link",ref:e=>o=e})),o.appendChild(i),o.setAttribute("href",e.url);const r=s.querySelector(".featured__table"),l=n.html.querySelector(".sidebar__shortcut-outer-wrap");l.lastElementChild.remove(),r.parentElement.insertBefore(l,r);const g=r.children;for(let e=0,t=g[1].children.length;e<t;e++)g[0].appendChild(g[1].firstElementChild);g[1].remove();const u=n.html.querySelector(".sidebar__suspension");u&&Se.insert(g[0],"beforeend",Se.element("div",{className:"esgst-ap-suspended featured__table__row"},Se.element("div",{className:"featured__table__row__left"},u.textContent),Se.element("div",{className:"featured__table__row__right"},u.nextElementSibling.textContent)));const m=n.html.querySelectorAll(".sidebar__navigation__item__name");for(const e of m){const t=e.textContent.match(/^Giveaways|Users$/);t&&Se.insert(g[0],"beforeend",Se.element("div",{className:"featured__table__row"},Se.element("div",{className:"featured__table__row__left"},t[0]),Se.element("div",{className:"featured__table__row__right"},e.nextElementSibling.nextElementSibling.textContent)))}const h=s.querySelector(".js__submit-form-inner");if(h){const e=h.querySelector("form");h.addEventListener("click",e.submit.bind(e))}"user"===e.type&&await c.esgst.modules.profile.profile_load(s),d.get("at")&&c.esgst.modules.generalAccurateTimestamp.at_getTimestamps(s),t.reposition()}};const hc=new class extends gt{constructor(){super(),this.info={description:()=>Se.element("ul",null,Se.element("li",null,"Pops up a reply box when you mark a giveaway as received (in your"," ",Se.element("a",{href:"https://www.steamgifts.com/giveaways/won"},"won")," page) so that you can add a comment thanking the creator.")),id:"rrbp",name:"Received Reply Box Popup",sg:!0,type:"comments"}}init(){c.esgst.wonPath&&c.esgst.giveawayFeatures.push(this.rrbp_addEvent.bind(this))}rrbp_addEvent(e){e.forEach(e=>{let t=e.outerWrap.getElementsByClassName("table__gift-feedback-awaiting-reply")[0];t&&t.addEventListener("click",this.rrbp_openPopup.bind(this,e))})}rrbp_openPopup(e){let t,s;t=new lt({addProgress:!0,addScrollable:!0,icon:"fa-comment",title:"Add a comment:"}),Se.insert(t.scrollable,"beforeend",Se.element("textarea",{ref:e=>s=e})),d.get("cfh")&&c.esgst.modules.commentsCommentFormattingHelper.cfh_addPanel(s),tt.create([{template:"success",name:"Save",onClick:async()=>{await c.common.saveComment(null,"","",s.value,e.url,t.progressBar),t.close()}},{template:"loading",isDisabled:!0,name:"Saving..."}]).insert(t.description,"beforeend"),t.open(()=>{s.focus()})}},pc=hs.createElements.bind(hs),fc=hs.getFeatureTooltip.bind(hs),bc=(hs.getUser.bind(hs),hs.hideGame.bind(hs)),wc=hs.sortContent.bind(hs);const yc=new class extends gt{constructor(){super(),this.info={endless:!0,id:"giveaways",featureMap:{endless:this.giveaways_load.bind(this)}}}async giveaways_load(e,t,s,n){if(e.getAttribute&&e.getAttribute("data-rfi"))return;let a=await this.giveaways_get(e,t,null,!1,null,!1,n);if(!a.length)return;document.querySelector(".lightbox")||document.body.insertAdjacentHTML("afterbegin",'<div class="lightbox hide"><div class="lightbox-header"><div class="lightbox-header-description"><div class="lightbox-header-description-name"></div><div class="lightbox-header-description-count"></div></div><div class="lightbox-header-icons"><i data-category="images" class="lightbox-header-icon fa fa-camera"></i><i data-category="videos" class="lightbox-header-icon fa fa-video-camera"></i><i class="lightbox-header-icon lightbox-header-icon--close fa fa-times"></i></div></div><div class="lightbox-status lightbox-status--loading"><div><div class="lightbox-status-icon"><i class="fa fa-cog fa-spin"></i></div><div class="lightbox-status-text">Please wait</div></div></div><div class="lightbox-status lightbox-status--empty"><div><div class="lightbox-status-icon"><i class="fa fa-picture-o"></i></div><div class="lightbox-status-text">No results</div></div></div><div class="lightbox-content"><div class="lightbox-content-nav"><div class="lightbox-content-nav-btn lightbox-content-nav-btn--prev"><div class="lightbox-content-nav-btn-icon"><i class="fa fa-angle-left"></i></div></div><div class="lightbox-content-nav-btn lightbox-content-nav-btn--next"><div class="lightbox-content-nav-btn-icon"><i class="fa fa-angle-right"></i></div></div></div><div class="lightbox-content-image"></div></div><div class="lightbox-footer-outer"><div class="lightbox-footer-inner"><div class="lightbox-thumbnails"></div></div></div></div>');let i=rt.findData("current","giveaways").length;for(const e of a)e.sortIndex=i,i+=1;rt.addData("current","giveaways",a,n);for(let e of this.esgst.giveawayFeatures)await e(a,t,s);a.forEach(e=>this.giveaways_reorder(e)),this.esgst.gas&&d.get(this.esgst.gas.autoKey)&&wc(rt.findData("current","giveaways"),d.get(this.esgst.gas.optionKey)),t&&c.esgst.gf&&this.esgst.gf.filteredCount&&d.get("gf_enable"+this.esgst.gf.type)&&this.esgst.modules.giveawaysGiveawayFilters.filters_filter(this.esgst.gf,!1,n),!t&&this.esgst.gfPopup&&this.esgst.gfPopup.filteredCount&&d.get("gf_enable"+this.esgst.gfPopup.type)&&this.esgst.modules.giveawaysGiveawayFilters.filters_filter(this.esgst.gfPopup),d.get("mm_enableGiveaways")&&this.esgst.mm_enable&&this.esgst.mm_enable(rt.findData("current","giveaways"),"Giveaways")}async giveaways_get(e,t,s,n,a,i,o){let r,l,d,g,u;l=[],u=!n&&t&&(this.esgst.createdPath||this.esgst.enteredPath||this.esgst.wonPath||this.esgst.archivePath)?c.common.getSelectors(o,["X.giveaway__row-outer-wrap","X.featured__outer-wrap--giveaway",".table:not(.table--summary) X.table__row-outer-wrap"]):this.esgst.gamePath?c.common.getSelectors(o,["X.giveaway__row-outer-wrap"]):c.common.getSelectors(o,["X.giveaway__row-outer-wrap","X.featured__outer-wrap--giveaway"]),a?d=e:s?(d=e,a="data"):(d=document,a="giveaway"),g=e.querySelectorAll(u);for(const e of g)r=await this.giveaways_getInfo(e,d,null,null,t,s,i,o),r&&l.push(r[a]);return l}async giveaways_getInfo(e,t,s,n,a,i,o,r){let l,g,u,m,h,p,f,b;const w={creators:[],groups:[],winners:[]};if(w.outerWrap=e,w.gameId=w.outerWrap.getAttribute("data-game-id"),u=await this.esgst.modules.games.games_getInfo(w.outerWrap),u&&(w.id=u.id,w.type=u.type,this.esgst.games&&this.esgst.games[w.type][w.id]))for(h=["owned","wishlisted","previouslyWishlisted","followed","hidden","ignored","previouslyEntered","previouslyWon","reducedCV","noCV","banned","removed"],g=0,f=h.length;g<f;++g)m=h[g],("banned"===m&&c.esgst.delistedGames.banned.indexOf(parseInt(w.id))>-1||"removed"===m&&(c.esgst.delistedGames.removed.indexOf(parseInt(w.id))>-1||c.esgst.games[w.type][w.id].removed)||c.esgst.games[w.type][w.id]["previouslyEntered"===m?"entered":"previouslyWon"===m?"won":m])&&(w[m]=!0);const y=hs.testPath("Giveaway","sg",i||window.location.pathname),v=hs.testPath("My Giveaways - Created","sg",i||window.location.pathname),_=hs.testPath("My Giveaways - Entered","sg",i||window.location.pathname),k=hs.testPath("My Giveaways - Won","sg",i||window.location.pathname),x=hs.testPath("Community Wishlist","sg",i||window.location.pathname),A=hs.testPath("Archive","sg",i||window.location.pathname),C=hs.testPath("Giveaways","sg",i||window.location.pathname),S=hs.testPath("Game","sg",i||window.location.pathname),E=hs.testPath("Group","sg",i||window.location.pathname),T=hs.testPath("User - Giveaways - Sent","sg",i||window.location.pathname),N=hs.testPath("User - Giveaways - Won","sg",i||window.location.pathname);if(w.outerWrap.classList.contains("table__row-outer-wrap")&&y)return;if(w.innerWrap=w.outerWrap.querySelector(".giveaway__row-inner-wrap, .featured__inner-wrap, .table__row-inner-wrap"),w.avatar=w.outerWrap.querySelector(".giveaway_image_avatar, .featured_giveaway_image_avatar"),w.image=w.outerWrap.querySelector(".giveaway_image_thumbnail, .giveaway_image_thumbnail_missing, .global__image-outer-wrap--game-medium"),w.summary=w.innerWrap.querySelector(".giveaway__summary, .featured__summary, .table__column--width-fill"),w.outerWrap.getAttribute("data-entered"))w.entered=!0;else if(y&&a){let e=t.getElementsByClassName("sidebar__entry-delete")[0];e&&(w.entered=!e.classList.contains("is-hidden"))}else w.entered=!(!_&&!k||!a)||w.innerWrap.classList.contains("is-faded");if(w.headingName=w.innerWrap.querySelector(".giveaway__heading__name, .featured__heading__medium, .table__column__heading"),w.heading=x?w.headingName:w.headingName.parentElement,w.name=w.headingName.textContent,p=w.name.match(/\s\((.+) Copies\)/),p?(w.name=w.name.replace(p[0],""),w.copies=parseInt(p[1].replace(/,/g,"").match(/\d+/)[0])):w.copies=1,w.url=y&&a&&!s?i&&hs.getPath(i)||window.location.pathname:i||w.headingName.getAttribute("href"),w.url)if(w.url=w.url.replace(/\/(entries|groups|region-restrictions|winners)$/,""),p=w.url.match(/\/giveaway\/(.+?)(\/.+?)$/),p)w.code=p[1];else{if(p=w.url.match(/\/giveaways\/(.+)/),!p)return;w.code=p[1],w.sgTools=!0}if(w.pinned=w.outerWrap.closest(".pinned-giveaways__outer-wrap"),b=w.innerWrap.querySelectorAll(".giveaway__heading__thin:not(.dyegb_playtime):not(.dyegb_achievement), .featured__heading__small"),f=b.length,w.points=0,w.copiesContainer=null,f>0&&(f>1?(w.copiesContainer=b[0],w.copies=parseInt(b[0].textContent.replace(/,/g,"").match(/\d+/)[0]),w.pointsContainer=b[1],w.points=parseInt(b[1].textContent.match(/\d+/)[0])):(w.copies=1,w.pointsContainer=b[0],w.points=parseInt(b[0].textContent.match(/\d+/)[0]))),w.columns=w.innerWrap.querySelector(".giveaway__columns, .featured__columns"),!w.columns||A&&a?w.started=!0:(w.endTimeColumn=w.columns.firstElementChild,w.endTimeColumn.classList.contains("esgst-ged-source")&&(w.sourceColumn=w.endTimeColumn,w.endTimeColumn=w.sourceColumn.nextElementSibling),w.startTimeColumn=w.columns.querySelector(".giveaway__column--width-fill.text-right, .featured__column--width-fill.text-right"),w.started=!w.endTimeColumn.textContent.match(/Begins/),w.endTime=1e3*parseInt(w.endTimeColumn.lastElementChild.getAttribute("data-timestamp")),w.ended=Boolean(w.deleted||w.endTimeColumn.textContent.match(/Ended/)),w.startTime=1e3*parseInt(w.startTimeColumn.firstElementChild.getAttribute("data-timestamp")),w.creatorContainer=w.startTimeColumn.querySelector('a[href*="/user/"], a[style]')),a&&A&&(w.startTimeColumn=w.innerWrap.querySelector("[data-timestamp]"),w.startTimeColumn?w.startTime=1e3*parseInt(w.startTimeColumn.getAttribute("data-timestamp")):w.startTime=0,w.creatorContainer=w.innerWrap.querySelector('a[href*="/user/"]')),!w.endTime&&a&&(v||_||k)&&(w.endTime=w.innerWrap.querySelector("[data-timestamp]"),w.endTime?(w.endTimeColumn=w.endTime.parentElement,w.started=!w.endTimeColumn.textContent.match(/Begins/),w.deleted=w.endTimeColumn.parentElement.textContent.match(/Deleted/),w.endTime=1e3*parseInt(w.endTime.getAttribute("data-timestamp")),w.ended=Boolean(w.deleted||w.endTimeColumn.parentElement.textContent.match(/Ended/))):(w.endTime=0,w.ended=!0)),w.creatorContainer?w.creator=w.creatorContainer.textContent:s?"sent"===n&&(w.creator=s):T&&!N&&a&&!o?w.creator=(i&&hs.getPath(i)||window.location.pathname).match(/^\/user\/(.+?)(\/.*)?$/)[1]:v&&a&&(w.creator=d.get("username")),w.creator&&w.creators.push(w.creator.toLowerCase()),a)if(v){let e=w.outerWrap.querySelector(".table__column--width-small.text-center:last-of-type");e&&(e.textContent.match(/Not\sReceived/)?w.notReceived=!0:e.textContent.match(/Received/)?w.received=!0:e.textContent.match(/Awaiting\sFeedback/)&&(w.awaitingFeedback=!0))}else if(k){w.received=!1,w.notReceived=!1;const e=w.outerWrap.querySelectorAll(".table__column--gift-feedback");for(const t of e){const e=t.textContent.trim();if(e.match(/^Received$/)&&t.querySelector(".icon-green")||t.querySelector(".table__gift-feedback-received:not(.is-hidden)")){w.received=!0;break}if(e.match(/^Not\sReceived$/)&&t.querySelector(".icon-red")||t.querySelector(".table__gift-feedback-not-received:not(.is-hidden)")){w.notReceived=!0;break}}w.awaitingFeedback=!w.received&&!w.notReceived}if(w.created=w.creator===d.get("username"),d.get("gf")&&d.get("gf_s")&&a){let e=this.esgst.giveaways[w.code];(C||S||E)&&e&&e.hidden&&e.code&&e.endTime&&e.endTime>Date.now()&&(w.outerWrap.classList.add("esgst-hidden"),w.outerWrap.setAttribute("data-esgst-not-filterable","gf"),d.get("gf_s_s")&&c.esgst.modules.giveawaysGiveawayFilters.updateSingleCounter())}if(w.links=w.innerWrap.getElementsByClassName("giveaway__links")[0],w.links?(w.links.classList.add("esgst-giveaway-links"),w.entriesLink=w.links.firstElementChild,w.commentsLink=w.entriesLink.nextElementSibling):y&&(w.entriesLink=t.getElementsByClassName("sidebar__navigation__item__count")[1],w.commentsLink=t.getElementsByClassName("sidebar__navigation__item__count")[0]),w.entriesLink&&w.commentsLink&&(w.entriesLink.setAttribute("data-draggable-id","entries"),w.commentsLink.setAttribute("data-draggable-id","comments"),w.entries=parseInt(w.entriesLink.textContent.replace(/,/g,"").match(/\d+/)[0]),w.comments=parseInt(w.commentsLink.textContent.replace(/,/g,"").match(/\d+/)[0])),!w.entriesLink&&!k){const e=w.innerWrap.querySelectorAll(".table__column--width-small")[v?1:0];e&&(w.entriesLink=e,w.entries=parseInt(e.textContent.replace(/,/g,"")))}Se.insert(w.summary,"beforeend",Se.element("div",{ref:e=>w.extraPanel=e})),w.panel=w.innerWrap.getElementsByClassName("esgst-giveaway-panel")[0],!w.panel&&(d.get("gwc")||d.get("gwr")||d.get("gptw")||d.get("gp")||d.get("elgb")||d.get("cewgd"))&&(w.links?(Se.insert(w.links,"afterend",Se.element("div",{className:"esgst-panel-flexbox",ref:e=>w.panelFlexbox=e})),w.panelFlexbox.appendChild(w.links),w.panel=pc(w.panelFlexbox,"beforeend",[{attributes:{class:"giveaway__columns esgst-giveaway-panel"},type:"div"}])):w.columns?A?(w.columns.style.justifyContent="flex-end",w.panel=pc(w.columns,"afterend",[{attributes:{class:"giveaway__columns esgst-giveaway-panel"},type:"div"}])):w.panel=pc(w.columns,"afterend",[{attributes:{class:"featured__columns esgst-giveaway-panel"},type:"div"}]):(_||k&&d.get("cewgd")&&d.get("cewgd_w")&&d.get("cewgd_w_e"))&&(d.get("gwc")||d.get("gwr")||d.get("gptw"))&&(w.panel=pc(w.innerWrap.firstElementChild.nextElementSibling,"afterend",[{attributes:{class:"table__column--width-small text-center esgst-giveaway-panel"},type:"div"}]))),w.sgTools&&!w.panel.getElementsByClassName("esgst-ge-sgt-button")[0]&&pc(w.panel,"beforeend",[{attributes:{class:"esgst-ge-sgt-button esgst-giveaway-column-button","data-draggable-id":"sgTools",href:"https://www.sgtools.info/giveaways/"+w.code,target:"_blank"},type:"a",children:[{attributes:{class:"form__submit-button"},text:"SGTools",type:"div"}]}]),w.elgbPanel=w.panel,w.levelColumn=w.outerWrap.querySelector(".giveaway__column--contributor-level, .featured__column--contributor-level"),w.level=w.levelColumn?parseInt(w.levelColumn.textContent.match(/\d+/)[0]):0,w.inviteOnly=w.outerWrap.querySelector(".giveaway__column--invite-only, .featured__column--invite-only"),w.regionRestricted=w.outerWrap.querySelector(".giveaway__column--region-restricted:not(.touhou_giveaway_points), .featured__column--region-restricted:not(.touhou_giveaway_points)"),w.group=w.outerWrap.querySelector(".giveaway__column--group, .featured__column--group"),w.whitelist=w.outerWrap.querySelector(".giveaway__column--whitelist, .featured__column--whitelist"),w.public=!(w.sgTools||w.inviteOnly||w.regionRestricted||w.group||w.whitelist),w.touhouBox=w.outerWrap.querySelector(".touhou_giveaway_points"),a&&y||(w.inviteOnly&&pc(w.inviteOnly,"atinner",[{attributes:{class:"fa fa-lock"},type:"i"}]),w.group&&pc(w.group,"atinner",[{attributes:{class:"fa fa-user"},type:"i"}]),w.whitelist&&pc(w.whitelist,"atinner",[{attributes:{class:"fa fa-heart"},type:"i"}])),l=e.getElementsByClassName("esgst-gwc")[0],w.chance=l?parseFloat(l.getAttribute("data-chance")):0,w.projectedChance=l?parseFloat(l.getAttribute("data-projectedChance")):0,w.chancePerPoint=w.chance/Math.max(1,w.points),w.projectedChancePerPoint=w.projectedChance/Math.max(1,w.points),w.blacklist=w.outerWrap.getAttribute("data-blacklist"),w.error=w.outerWrap.getAttribute("data-error");const P=e.getElementsByClassName("esgst-gwr")[0];w.ratio=P?parseFloat(P.getAttribute("data-ratio")):0,w.projectedRatio=P?parseFloat(P.getAttribute("data-projectedRatio")):0;const L=e.getElementsByClassName("esgst-gptw")[0];if(w.pointsToWin=L?parseFloat(L.getAttribute("data-pointsToWin")):0,w.enterable=w.outerWrap.getAttribute("data-enterable"),w.currentlyEnterable=w.outerWrap.getAttribute("data-currently-enterable"),a&&d.get("gr")&&w.creator===d.get("username")&&(d.get("gr_a")||w.ended&&(0===w.entries||w.entries<w.copies))&&(!d.get("gr_r")||!this.esgst.giveaways[w.code]||!this.esgst.giveaways[w.code].recreated)&&!w.heading.getElementsByClassName("esgst-gr-button")[0]){let e=pc(w.headingName,"beforebegin",[{attributes:{class:"esgst-gr-button","data-draggable-id":"gr",title:""+fc("gr","Recreate giveaway")},type:"div",children:[{attributes:{class:"fa fa-rotate-left"},type:"i"}]}]);e.firstElementChild.addEventListener("click",this.esgst.modules.giveawaysGiveawayRecreator.gr_recreateGiveaway.bind(this.esgst.modules.giveawaysGiveawayRecreator,e,w),!0)}let I=w.innerWrap.querySelector(".giveaway__hide, .featured__giveaway__hide");if(I&&!I.classList.contains("fa-eye"))if(!a||r){I.classList.contains("featured__giveaway__hide")&&(I=I.parentElement);let e=I.previousElementSibling;pc(I,"atouter",[{attributes:{class:"fa fa-eye-slash giveaway__hide giveaway__icon",title:fc(null,"Hide all giveaways for this game")},type:"i"}]),I=e.nextElementSibling,I.addEventListener("click",bc.bind(hs,I,w.gameId,w.name,w.id,w.type))}else d.get("lastSyncHiddenGames")>0&&I.addEventListener("click",()=>{this.esgst.hidingGame={id:w.id,type:w.type}});I&&(I.classList.contains("featured__giveaway__hide")?I.parentElement.setAttribute("data-draggable-id","hideGame"):I.setAttribute("data-draggable-id","hideGame"));for(const e of w.heading.children)e===w.headingName||e.classList.contains("giveaway__heading__name")||e.classList.contains("featured__heading__medium")?e.setAttribute("data-draggable-id","name"):e.textContent.match(/\(.+?\sCopies\)/)?e.setAttribute("data-draggable-id","copies"):e.textContent.match(/\(.+?P\)/)?e.setAttribute("data-draggable-id","points"):e.getAttribute("href")&&e.getAttribute("href").match(/store.steampowered.com/)?e.setAttribute("data-draggable-id","steam"):(e.matches(".giveaway__icon.fa-camera[data-lightbox-id]")&&e.setAttribute("data-draggable-id","screenshots-videos"),e.getAttribute("href")&&e.getAttribute("href").match(/\/giveaways\/search/)&&e.setAttribute("data-draggable-id","search"));if(w.winnerColumns={},w.numWinners=Math.min(w.entries||0,w.copies),w.startTimeColumn&&w.endTimeColumn){let e=w.endTimeColumn.nextElementSibling;for(;e&&e!==w.startTimeColumn;){let t="",s="";if(e.classList.contains("giveaway__column--positive"))[t,s]=["received","Received"];else if(e.classList.contains("giveaway__column--negative"))[t,s]=["notReceived","Not Received"];else if(e.textContent.trim().match(/Awaiting\sfeedback/))[t,s]=["awaitingFeedback","Awaiting Feedback"];else{if(!e.textContent.trim().match(/No\swinners/))continue;[t,s]=["noWinners",""]}const n=[];"received"!==t&&"notReceived"!==t||(n.push(...e.textContent.trim().split(/,\s/).filter(e=>e)),w.winners.push(...n.map(e=>({status:s,username:e}))),"received"===t&&(w.winnerNames=n.map(e=>e.toLowerCase()))),w.winnerColumns[t]={column:e,status:s,winners:n},e.setAttribute("data-draggable-id","winners"),e=e.nextElementSibling}}return(!w.winners.length||w.numWinners<4)&&(w.numWinners=w.winners.length),w.endTimeColumn&&w.endTimeColumn.setAttribute("data-draggable-id","endTime"),w.startTimeColumn&&w.startTimeColumn.setAttribute("data-draggable-id","startTime"),w.inviteOnly&&w.inviteOnly.setAttribute("data-draggable-id","inviteOnly"),w.whitelist&&w.whitelist.setAttribute("data-draggable-id","whitelist"),w.group&&w.group.setAttribute("data-draggable-id","group"),w.regionRestricted&&w.regionRestricted.setAttribute("data-draggable-id","regionRestricted"),w.levelColumn&&w.levelColumn.setAttribute("data-draggable-id","level"),w.sourceColumn&&w.sourceColumn.setAttribute("data-draggable-id","ged"),w.touhouBox&&w.touhouBox.setAttribute("data-draggable-id","touhou"),{giveaway:w,data:{gameId:w.gameId,gameSteamId:w.id,gameType:w.type,gameName:w.name,code:w.code,copies:w.copies,points:w.points,ended:w.ended,endTime:w.endTime,startTime:w.startTime,started:w.started,creator:w.creator,winners:w.numWinners>3?[]:w.winners,numWinners:w.numWinners,entries:w.entries,comments:w.comments,level:w.level,public:w.public,inviteOnly:!(!w.inviteOnly&&!w.sgTools),regionRestricted:!!w.regionRestricted,group:!!w.group,whitelist:!!w.whitelist,v:c.esgst.CURRENT_GIVEAWAY_VERSION}}}giveaways_reorder(e){if(e.columns&&!c.common.isGiveawayColumnsDefault||e.gvIcons&&!c.common.isGiveawayColumnsGvDefault){for(const t of e.gvIcons?d.get("giveawayColumns_gv"):d.get("giveawayColumns")){if("startTime"===t&&c.common.isCurrentPath("Archive"))continue;const s=e.outerWrap.querySelectorAll(`[data-draggable-id="${t}"]`);for(const t of s){try{tt.create().parse(t).insert(e.gvIcons||e.columns,"beforeend")}catch(s){(e.gvIcons||e.columns).appendChild(t)}e.elementOrdering||(t.getAttribute("data-draggable-id").match(/^(elgb|gp)$/)&&t.classList.add("esgst-giveaway-column-button"),!this.esgst.giveawayPath&&t.getAttribute("data-draggable-id").match(/steam|screenshots-videos|search|hideGame/)&&t.classList.remove("giveaway__icon"),t.classList.add(this.esgst.giveawayPath?"featured__column":"giveaway__column"),t.getAttribute("data-color")&&(t.firstElementChild.style.color=t.getAttribute("data-bgColor"),t.style.color="",t.style.backgroundColor=""))}}e.columns&&e.avatar&&e.columns.contains(e.avatar)&&e.columns.appendChild(e.avatar)}if(e.panel&&(!e.gvIcons&&!c.common.isGiveawayPanelDefault||e.gvIcons&&!c.common.isGiveawayPanelGvDefault))for(const t of e.gvIcons?d.get("giveawayPanel_gv"):d.get("giveawayPanel")){const s=e.outerWrap.querySelectorAll(`[data-draggable-id="${t}"]`);for(const t of s){try{tt.create().parse(t).insert(e.panel,"beforeend")}catch(s){e.panel.appendChild(t)}e.elementOrdering||(t.getAttribute("data-draggable-id").match(/^(elgb|gp)$/)?t.classList.remove("esgst-giveaway-column-button",this.esgst.giveawayPath?"featured__column":"giveaway__column"):t.classList.add(this.esgst.giveawayPath?"featured__column":"giveaway__column"),!this.esgst.giveawayPath&&t.getAttribute("data-draggable-id").match(/steam|screenshots-videos|search|hideGame/)&&t.classList.remove("giveaway__icon"),t.getAttribute("data-color")&&(t.style.color=t.getAttribute("data-color"),t.style.backgroundColor=t.getAttribute("data-bgColor")))}}if(e.heading&&(!e.gvIcons&&!c.common.isGiveawayHeadingDefault||e.gvIcons&&!c.common.isGiveawayHeadingGvDefault))for(const t of e.gvIcons?d.get("giveawayHeading_gv"):d.get("giveawayHeading")){const s=e.outerWrap.querySelectorAll(`[data-draggable-id="${t}"]`);for(const t of s){try{tt.create().parse(t).insert(e.heading,"beforeend")}catch(s){e.heading.appendChild(t)}e.elementOrdering||(t.getAttribute("data-draggable-id").match(/^(elgb|gp)$/)&&t.classList.remove("esgst-giveaway-column-button"),!this.esgst.giveawayPath&&t.getAttribute("data-draggable-id").match(/steam|screenshots-videos|search|hideGame/)&&t.classList.add("giveaway__icon"),t.classList.remove(this.esgst.giveawayPath?"featured__column":"giveaway__column"),t.getAttribute("data-color")&&(t.style.color=t.getAttribute("data-color"),t.style.backgroundColor=t.getAttribute("data-bgColor")))}}if(e.links&&(!e.gvIcons&&!c.common.isGiveawayLinksDefault||e.gvIcons&&!c.common.isGiveawayLinksGvDefault))for(const t of e.gvIcons?d.get("giveawayLinks_gv"):d.get("giveawayLinks")){const s=e.outerWrap.querySelectorAll(`[data-draggable-id="${t}"]`);for(const t of s){try{tt.create().parse(t).insert(e.links,"beforeend")}catch(s){e.links.appendChild(t)}e.elementOrdering||(t.getAttribute("data-draggable-id").match(/^(elgb|gp)$/)&&t.classList.remove("esgst-giveaway-column-button"),!this.esgst.giveawayPath&&t.getAttribute("data-draggable-id").match(/steam|screenshots-videos|search|hideGame/)&&t.classList.remove("giveaway__icon"),t.classList.remove(this.esgst.giveawayPath?"featured__column":"giveaway__column"),t.getAttribute("data-color")&&(t.style.color=t.getAttribute("data-color"),t.style.backgroundColor=t.getAttribute("data-bgColor")))}}if(e.extraPanel&&(!e.gvIcons&&!c.common.isGiveawayExtraPanelDefault||e.gvIcons&&!c.common.isGiveawayExtraPanelGvDefault))for(const t of e.gvIcons?d.get("giveawayExtraPanel_gv"):d.get("giveawayExtraPanel")){const s=e.outerWrap.querySelectorAll(`[data-draggable-id="${t}"]`);for(const t of s){try{tt.create().parse(t).insert(e.extraPanel,"beforeend")}catch(s){e.extraPanel.appendChild(t)}e.elementOrdering||(t.getAttribute("data-draggable-id").match(/^(elgb|gp)$/)&&t.classList.remove("esgst-giveaway-column-button"),!this.esgst.giveawayPath&&t.getAttribute("data-draggable-id").match(/steam|screenshots-videos|search|hideGame/)&&t.classList.remove("giveaway__icon"),t.classList.remove(this.esgst.giveawayPath?"featured__column":"giveaway__column"),t.getAttribute("data-color")&&(t.style.color=t.getAttribute("data-color"),t.style.backgroundColor=t.getAttribute("data-bgColor")))}}if(e.gcPanel){for(const t of e.gvIcons?d.get("gc_categories_gv"):d.get("gc_categories")){const s=e.outerWrap.querySelectorAll(`[data-draggable-id="${t}"]`);for(const t of s){try{tt.create().parse(t).insert(e.gcPanel,"beforeend")}catch(s){e.gcPanel.appendChild(t)}e.elementOrdering||(t.getAttribute("data-draggable-id").match(/^(elgb|gp)$/)&&t.classList.remove("esgst-giveaway-column-button"),!this.esgst.giveawayPath&&t.getAttribute("data-draggable-id").match(/steam|screenshots-videos|search|hideGame/)&&t.classList.remove("giveaway__icon"),t.classList.remove(this.esgst.giveawayPath?"featured__column":"giveaway__column"),t.getAttribute("data-color")&&(t.style.color=t.getAttribute("data-color"),t.style.backgroundColor=t.getAttribute("data-bgColor")))}}const t=e.gcPanel.querySelector(".esgst-gc-loading");t&&e.gcPanel.appendChild(t)}}},vc=(hs.getUser.bind(hs),hs.sortContent.bind(hs));const _c=new class extends gt{constructor(){super(),this.info={endless:!0,id:"discussions",featureMap:{endless:this.discussions_load.bind(this)}}}async discussions_load(e,t,s,n){let a=await this.discussions_get(e,t,n);if(!a.length)return;const i=[],o=[];let r=rt.findData("current","discussions").length;for(let e=a.length-1;e>-1;--e)switch(a[e].sortIndex=r,a[e].type){case"discussion":i.push(a[e]),r+=1;break;case"trade":o.push(a[e])}rt.addData("current","discussions",i,n),rt.addData("current","trades",o,n),t&&!this.esgst.discussionsPath||(t&&c.esgst.df&&this.esgst.df.filteredCount&&d.get("df_enable"+this.esgst.df.type)&&this.esgst.modules.discussionsDiscussionFilters.filters_filter(this.esgst.df,!1,n),d.get("ds")&&d.get("ds_auto")&&vc(rt.findData("main","discussions"),d.get("ds_option"))),t&&!this.esgst.tradesPath||t&&c.esgst.tf&&this.esgst.tf.filteredCount&&d.get("tf_enable"+this.esgst.tf.type)&&this.esgst.modules.tradesTradeFilters.filters_filter(this.esgst.tf,!1,n),d.get("mm_enableDiscussions")&&this.esgst.mm_enable&&this.esgst.mm_enable(rt.findData("current","discussions"),"Discussions");for(const e of this.esgst.discussionFeatures)await e(a.filter(e=>!e.menu&&"discussion"===e.type),t);for(const e of this.esgst.tradeFeatures)await e(a.filter(e=>!e.menu&&"trade"===e.type),t)}async discussions_get(e,t,s){let n=[],a=e.querySelectorAll(".esgst-dt-menu");for(const e of a){const t=e.getAttribute("href").match(/\/discussion\/(.+?)\//)[1];n.push({code:t,container:e.parentElement,context:e,id:t,menu:!0,name:e.textContent.trim(),saved:this.esgst.discussions[t],tagContext:e,tagPosition:"afterend",sortIndex:0,type:""})}a=e.querySelectorAll(""+(s?`.esgst-es-page-${s} .table__row-outer-wrap, .esgst-es-page-${s} .row_outer_wrap, .esgst-es-page-${s}.table__row-outer-wrap, .esgst-es-page-${s}.row_outer_wrap`:".table__row-outer-wrap, .row_outer_wrap"));for(let e=a.length-1;e>-1;--e){let s=await this.discussions_getInfo(a[e],t);s&&n.push(s)}if(n&&this.esgst.commentsPath&&!d.get("oadd")&&d.get("adots")&&1===d.get("adots_index")&&(d.get("idb")&&await this.esgst.modules.discussionsImprovedDiscussionBookmarks.addButtons(n),d.get("df")&&this.esgst.modules.discussionsDiscussionFilters.df_addButtons(n)),e===document&&t&&this.esgst.discussionPath){var i,o,r,l,c,g;let e=window.location.pathname.match(/^\/discussion\/(.+?)\//),t={code:e?e[1]:null,heading:document.getElementsByClassName("page__heading__breadcrumbs")[0],headingContainer:document.getElementsByClassName("page__heading")[0],menu:!1,sortIndex:0,type:""};t.id=t.code,t.container=t.headingContainer,t.tagContext=t.container.querySelector('[href*="/discussion/"]'),t.name=null!==(i=null===(o=t.tagContext)||void 0===o||null===(o=o.textContent)||void 0===o?void 0:o.trim())&&void 0!==i?i:null,t.tagPosition="afterend",t.saved=this.esgst.discussions[t.code],t.title=null!==(r=null===(l=t.heading)||void 0===l||null===(l=l.getElementsByTagName("H1")[0])||void 0===l?void 0:l.textContent.trim())&&void 0!==r?r:null,t.category=null!==(c=null===(g=t.heading)||void 0===g||null===(g=g.firstElementChild)||void 0===g||null===(g=g.nextElementSibling)||void 0===g||null===(g=g.nextElementSibling)||void 0===g?void 0:g.textContent)&&void 0!==c?c:null,t.type="discussion",n.push(t)}return n}async discussions_getInfo(e,t){let s;if(e.closest(".poll"))return;const n={menu:!1,sortIndex:0};if(n.outerWrap=e,n.innerWrap=n.outerWrap.querySelector(".table__row-inner-wrap, .row_inner_wrap"),n.innerWrap&&(n.avatarColumn=n.innerWrap.firstElementChild,n.avatarColumn&&(n.avatar=n.avatarColumn.firstElementChild,n.avatar&&(n.headingColumn=n.avatarColumn.nextElementSibling,n.headingContainer=n.headingColumn.firstElementChild,n.headingContainer&&(n.bookmarkNode=n.headingColumn.querySelector(".icon-heading.fa.fa-bookmark, .icon-heading.fa.fa-bookmark-o"),n.closed=n.headingContainer.querySelector(".fa-lock"),n.heading=n.headingContainer.lastElementChild,n.info=n.headingContainer.nextElementSibling,n.heading&&(n.title=n.heading.textContent,n.url=n.heading.getAttribute("href"),n.url&&(s=n.url.match(/(discussion|trade)\/(.+?)\//),s))))))){switch(n.type=s[1],n.code=s[2],n.type){case"discussion":if(n.saved=this.esgst.discussions[n.code],t&&d.get("df")&&d.get("df_s")&&n.saved&&n.saved.hidden)return n.outerWrap.classList.add("esgst-hidden"),n.outerWrap.setAttribute("data-esgst-not-filterable","df"),void(d.get("df_s_s")&&c.esgst.modules.discussionsDiscussionFilters.updateSingleCounter());n.categoryContainer=n.info.firstElementChild,n.headingColumn.nextElementSibling?(n.category=n.categoryContainer.textContent,n[n.category.replace(/\W/g,"").replace(/^(.)/,(e,t)=>t.toLowerCase())]=!0):n.category="",n.createdContainer=n.categoryContainer.nextElementSibling;break;case"trade":if(n.saved=this.esgst.trades[n.code],t&&d.get("tf")&&d.get("tf_s")&&n.saved&&n.saved.hidden)return n.outerWrap.classList.add("esgst-hidden"),n.outerWrap.setAttribute("data-esgst-not-filterable","tf"),void(d.get("tf_s_s")&&c.esgst.modules.tradesTradeFilters.updateSingleCounter());if(n.info=n.headingColumn.nextElementSibling,n.createdContainer=n.info.firstElementChild.firstElementChild.nextElementSibling,n.reputationElement=n.info.querySelector(".reputation"),!n.reputationElement)break;if(n.positiveReputationElement=n.reputationElement.querySelector(".is_positive"),n.negativeReputationElement=n.reputationElement.querySelector(".is_negative"),n.positiveReputation=parseInt(n.positiveReputationElement.textContent.replace(/[^\d]/g,"")),!n.negativeReputationElement)break;n.negativeReputation=parseInt(n.negativeReputationElement.textContent.replace(/[^\d]/g,""))}var a,i;if(n.bookmarked=!!n.bookmarkNode,n.saved&&(n.visited=n.saved.visited,n.subscribed=void 0!==n.saved.subscribed),n.createdContainer)if(n.createdTime=n.createdContainer.textContent,n.createdTimestamp=1e3*parseInt(n.createdContainer.getAttribute("data-timestamp")),this.esgst.giveawaysPath)n.author=(n.avatar.getAttribute("href")||n.avatar.dataset.href).match(/\/user\/(.+)/)[1];else n.author=null!==(a=null===(i=n.createdContainer.nextElementSibling)||void 0===i?void 0:i.textContent)&&void 0!==a?a:null;if(n.author)return n.authors=[n.author.toLowerCase()],n.created=n.author===d.get("username"),n.poll=n.outerWrap.querySelector(".fa-align-left"),n.commentsColumn=this.esgst.st?n.headingColumn.nextElementSibling.nextElementSibling:n.headingColumn.nextElementSibling||n.headingColumn.children[1],n.commentsColumn&&(n.comments=parseInt(n.commentsColumn.firstElementChild.textContent.replace(/,/g,"")),(this.esgst.giveawaysPath||this.esgst.commentsPath)&&d.get("adots")&&1===d.get("adots_index")&&d.get("ns")&&(n.commentsColumn.firstElementChild.textContent=n.commentsColumn.firstElementChild.textContent.replace(/\sComments/,""))),n.lastPost=n.outerWrap.querySelector(".table__column--last-comment, .row_trade_update_user"),n.lastPost&&n.lastPost.firstElementChild&&this.esgst.st?(n.lastPostTime=n.lastPost.firstElementChild.firstElementChild.nextElementSibling,n.lastPostAuthor=n.lastPostTime.parentNode.nextElementSibling.firstElementChild,n.lastPostCode=n.lastPostAuthor.nextElementSibling.nextElementSibling,n.lastPostCode&&n.lastPostCode.getAttribute("href").match(/\/comment\/(.+)/)?(n.lastPostCode=n.lastPostCode.getAttribute("href").match(/\/comment\/(.+)/)[1],n.wasLastPostBump=!1):(n.lastPostCode=null,n.wasLastPostBump=!0),n.lastPostAuthor=n.lastPostAuthor.textContent,n.lastPostTimestamp=n.lastPostTime.getAttribute("data-timestamp"),n.lastPostTime=n.lastPostTime.textContent):n.lastPost&&n.lastPost.firstElementChild&&(n.lastPostTime=n.lastPost.firstElementChild.firstElementChild,n.lastPostAuthor=n.lastPostTime.nextElementSibling,n.lastPostCode=n.lastPostAuthor.lastElementChild.getAttribute("href").match(/\/comment\/(.+)/),n.lastPostCode&&(n.lastPostCode=n.lastPostCode[1]),n.lastPostAuthor=n.lastPostAuthor.firstElementChild.textContent,n.lastPostTimestamp=n.lastPostTime.getAttribute("data-timestamp"),n.lastPostTime=n.lastPostTime.firstElementChild.textContent),n.id=n.code,n.name=n.title,n.container=n.headingContainer,n.tagContext=n.headingContainer,n.tagPosition="beforeend",n}}};const kc=new class extends gt{constructor(){super(),this.info={endless:!0,id:"discussionPanels"}}init(){(d.get("ct")&&(this.esgst.giveawaysPath||this.esgst.discussionsPath||this.esgst.commentsPath||this.esgst.tradesPath)||d.get("gdttt")&&(this.esgst.giveawaysPath||this.esgst.discussionsPath||this.esgst.commentsPath||this.esgst.discussionsTicketsTradesPath))&&this.esgst.endlessFeatures.push(this.esgst.modules.commentsCommentTracker.ct_addDiscussionPanels.bind(this.esgst.modules.commentsCommentTracker))}};class xc{constructor(){o()(this,"nodes",void 0),o()(this,"data",void 0),this.nodes=xc.getDefaultNodes(),this.data=xc.getDefaultData()}static getDefaultNodes(){return{outer:null,button:null,link:null,image:null}}static getDefaultData(){return{title:"",url:""}}static create(){switch(Be.namespace){case Pe:return new Ac;case Le:return new Cc}return null}static parseAll(e){switch(Be.namespace){case Pe:return Ac.parseAll(e);case Le:return Cc.parseAll(e)}return null}}class Ac extends xc{constructor(){super()}static parseAll(e){const t=[],s=e.querySelectorAll(".comment__toggle-attached");for(const e of s){const s=new Ac;s.parse(e.parentElement),t.push(s)}return t}parse(e){this.parseNodes(e),this.parseData()}parseNodes(e){const t=xc.getDefaultNodes();t.outer=e,t.button=t.outer.querySelector(".comment__toggle-attached"),t.link=t.outer.querySelector("a"),t.image=t.link.querySelector("img"),this.nodes=t}parseData(){const e=this.nodes,t=xc.getDefaultData();t.title=e.image.title,t.url=e.image.src,this.data=t}build(e,t){let s;this.nodes.outer&&this.nodes.outer.remove(),Se.insert(e,t,Se.element("div",{ref:e=>s=e},Se.element("div",{className:"comment__toggle-attached"},"View attached image."),Se.element("a",{href:this.data.url,rel:"nofollow noopener",target:"_blank"},Se.element("img",{alt:this.data.title,title:this.data.title,className:"is-hidden",src:this.data.url})))),this.parseNodes(s)}}class Cc extends xc{constructor(){super()}static parseAll(e){const t=[],s=e.querySelectorAll(".view_attached");for(const e of s){const s=new Cc;s.parse(e.parentElement),t.push(s)}return t}parse(e){this.parseNodes(e),this.parseData()}parseNodes(e){const t=xc.getDefaultNodes();t.outer=e,t.button=t.outer.querySelector(".view_attached"),t.link=t.outer.querySelector("a"),t.image=t.link.querySelector("img"),this.nodes=t}parseData(){const e=this.nodes,t=xc.getDefaultData();t.title=e.image.title,t.url=e.image.src,this.data=t}build(e,t){let s;this.nodes.outer&&this.nodes.outer.remove(),Se.insert(e,t,Se.element("div",{ref:e=>s=e},Se.element("div",{className:"view_attached"},"View attached image."),Se.element("a",{href:this.data.url},Se.element("img",{alt:this.data.title,title:this.data.title,className:"is_hidden",src:this.data.url})))),this.parseNodes(s)}}class Sc{constructor(e=0,t=null){o()(this,"nodes",void 0),o()(this,"data",void 0),o()(this,"author",void 0),o()(this,"attachedImages",void 0),o()(this,"generation",void 0),o()(this,"parent",void 0),o()(this,"children",void 0),o()(this,"mrBox",void 0),this.nodes=Sc.getDefaultNodes(),this.data=Sc.getDefaultData(),this.author=null,this.attachedImages=[],this.generation=e,this.parent=t,this.children=[],this.mrBox=null}static getDefaultNodes(){return{outer:null,inner:null,summary:null,author:null,collapseButton:null,expandButton:null,defaultState:null,editState:null,editTextArea:null,editSaveButton:null,editCancelButton:null,deleteState:null,collapseState:null,collapseCount:null,actions:null,createdTimestamp:null,editedTimestamp:null,deletedTimestamp:null,replyButton:null,editButton:null,deleteButton:null,undeleteButton:null,source:null,sourceComment:null,sourceThread:null,permalink:null,rmlLink:null,rating:null,children:null}}static getDefaultData(){return{id:"",isDeleted:!1,markdown:"",createdTimestamp:0,editedTimestamp:0,deletedTimestamp:0,isEdited:!1,canReply:!1,canEdit:!1,canDelete:!1,canUndelete:!1,sourceCommentUrl:"",sourceCommentAuthor:"",sourceThreadUrl:"",sourceThreadTitle:"",url:"",code:"",isOp:!1,isReview:!1,isReviewPositive:!1}}static create(e=0,t=null){switch(Be.namespace){case Pe:return new Ec(e,t);case Le:return new Tc(e,t)}return null}static parseAll(e,t=0,s=null){switch(Be.namespace){case Pe:return Ec.parseAll(e,t,s);case Le:return Tc.parseAll(e,t,s)}return null}}class Ec extends Sc{constructor(e=0,t=null){super(e,t)}static parseAll(e,t,s=null){const n=[],a=e.querySelectorAll(".comments > .comment:not(.comment--submit):not([data-esgst-parsed]), :scope > .comment:not(.comment--submit):not([data-esgst-parsed])");for(const e of a){const a=new Ec(t,s);a.parse(e),n.push(a)}return n}parse(e){this.author=Ft.create(),this.parseNodes(e),this.parseData(),this.nodes.defaultState&&(this.attachedImages=xc.parseAll(this.nodes.defaultState)),this.nodes.children&&(this.children=Ec.parseAll(this.nodes.children,this.generation+1,this))}parseNodes(e){const t=Sc.getDefaultNodes(),s=Ft.getDefaultNodes();t.outer=e,s.outer=e,t.inner=t.outer.querySelector(".comment__parent, .comment__child"),s.avatarOuter=t.inner.querySelector(".global__image-outer-wrap"),s.avatarInner=s.avatarOuter.querySelector(".global__image-inner-wrap"),t.summary=t.inner.querySelector(".comment__summary"),t.author=t.summary.querySelector(".comment__author"),t.collapseButton=t.author.querySelector(".comment__collapse-button"),t.expandButton=t.author.querySelector(".comment__expand-button"),s.usernameOuter=t.author.querySelector(".comment__username"),s.usernameInner=s.usernameOuter.querySelector('[href*="/user/"]'),s.role=t.author.querySelector(".comment__role-name"),s.patreon=t.author.querySelector('[data-ui-tooltip*="Patron"]'),t.defaultState=t.summary.querySelector(".comment__display-state"),t.editState=t.summary.querySelector(".comment__edit-state"),t.editState&&(t.editTextArea=t.editState.querySelector('[name="description"]'),t.editSaveButton=t.editState.querySelector(".js__comment-edit-save"),t.editCancelButton=t.editState.querySelector(".js__comment-edit-cancel")),t.deleteState=t.summary.querySelector(".comment__delete-state"),t.deleteState&&(t.deletedTimestamp=t.deleteState.querySelector("[data-timestamp]")),t.collapseState=t.summary.querySelector(".comment__collapse-state"),t.actions=t.summary.querySelector(".comment__actions");const n=t.actions.querySelectorAll("[data-timestamp]");t.createdTimestamp=n[0],2===n.length&&(t.editedTimestamp=n[1]),t.replyButton=t.actions.querySelector(".js__comment-reply"),t.editButton=t.actions.querySelector(".js__comment-edit"),t.deleteButton=t.actions.querySelector(".js__comment-delete"),t.undeleteButton=t.actions.querySelector(".js__comment-undelete"),t.permalink=t.actions.querySelector('[href*="/go/comment/"]'),t.children=t.outer.querySelector(".comment__children"),t.outer.dataset.esgstParsed="",this.nodes=t,this.author.nodes=s}parseData(){const e=this.nodes,t=Sc.getDefaultData();t.id=e.outer.dataset.commentId,t.isDeleted=!!e.deletedTimestamp,e.editTextArea&&(t.markdown=e.editTextArea.value),e.deletedTimestamp&&(t.deletedTimestamp=parseInt(e.deletedTimestamp.dataset.timestamp)),t.createdTimestamp=parseInt(e.createdTimestamp.dataset.timestamp),e.editedTimestamp&&(t.editedTimestamp=parseInt(e.editedTimestamp.dataset.timestamp)),t.isEdited=!!t.editedTimestamp,t.canReply=!!e.replyButton,t.canEdit=!!e.editButton,t.canDelete=!!e.deleteButton,t.canUndelete=!!e.undeleteButton,e.permalink&&(t.url=e.permalink.getAttribute("href"),t.code=t.url.split("/")[3]),t.isOp=!e.summary.id,this.data=t,this.author.parseData(),this.author.parseExtraData()}build(e,t){this.nodes.outer&&this.nodes.outer.remove();const s=this.author.data.patron&&Se.element("i",{"data-ui-tooltip":'{"rows":[{"icon" : [{"class" : "fa-star", "color" : "#84cfda"}], "columns":[{"name" : "Patron"}]}]}',className:"fa fa-star"});let n;Se.insert(e,t,Se.element("div",{"data-comment-id":this.data.id,className:"comment",ref:e=>n=e},Se.element("div",{className:"ajax "+(this.parent?"comment__child":"comment__parent")},this.data.isDeleted?Se.element("div",{className:"global__image-outer-wrap global__image-outer-wrap--avatar-small global__image-outer-wrap--missing-image"},Se.element("i",{className:"fa fa-user"})):Se.element("a",{href:this.author.data.url,className:"global__image-outer-wrap global__image-outer-wrap--avatar-small"},Se.element("div",{className:"global__image-inner-wrap",style:`background-image:url(${this.author.data.avatar});`})),Se.element("div",{id:this.data.code,className:"comment__summary"},Se.element("div",{className:"comment__author"},Se.element("i",{className:"comment__collapse-button fa fa-minus-square-o"}),Se.element("i",{className:"comment__expand-button fa fa-plus-square-o"}),this.data.isDeleted?Se.element("div",{className:"comment__username comment__username--deleted"},"Deleted"):Se.element("div",{className:"comment__username"+(this.author.data.op?" comment__username--op":"")},Se.element("a",{href:this.author.data.url},this.author.data.username)),this.author.data.roleId&&Se.element("a",{href:"/roles/"+this.author.data.roleId,className:"comment__role-name"},`(${this.author.data.roleName})`),this.author.data.patron&&(Be.isLoggedIn?Se.element("a",{href:"/account/settings/patreon"},s):s)),this.data.canEdit&&Se.element("div",{className:"comment__edit-state is-hidden"},Se.element("div",{className:"comment__description"},Se.element("form",null,Se.element("input",{type:"hidden",name:"xsrf_token",value:Be.xsrfToken}),Se.element("input",{type:"hidden",name:"do",value:"comment_edit"}),Se.element("input",{type:"hidden",name:"allow_replies",value:"1"}),Se.element("input",{type:"hidden",name:"comment_id",value:this.data.id}),Se.element("textarea",{name:"description"},this.data.markdown),Se.element("div",{className:"align-button-container"},Se.element("a",{href:"",className:"comment__submit-button js__comment-edit-save"},"Save Changes"),Se.element("div",{className:"comment__cancel-button js__comment-edit-cancel"},Se.element("span",null,"Cancel")))))),this.data.isDeleted?Se.element("div",{className:"comment__delete-state"},Se.element("div",{className:"comment__description markdown markdown--resize-body"},Se.element("p",null,"This comment was deleted"," ",Se.element("span",{"data-timestamp":this.data.deletedTimestamp},c.common.getTimeSince(this.data.deletedTimestamp))," ","ago."))):Se.element("div",{className:"comment__display-state"},Se.element("div",{className:"comment__description markdown markdown--resize-body"},this.data.markdown?Se.parse(c.esgst.markdownParser.text(this.data.markdown)).body.children:"")),Se.element("div",{className:"comment__actions"},Se.element("div",null,Se.element("span",{"data-timestamp":this.data.createdTimestamp},c.common.getTimeSince(this.data.createdTimestamp))," ","ago",this.data.isEdited&&Se.element("span",{"data-timestamp":this.data.editedTimestamp},"*")),this.data.canReply&&Se.element("div",{className:"comment__actions__button js__comment-reply"},"Reply"),this.data.canEdit&&Se.element("div",{className:"comment__actions__button js__comment-edit"},"Edit"),this.data.canDelete&&Se.element("form",null,Se.element("input",{type:"hidden",name:"xsrf_token",value:Be.xsrfToken}),Se.element("input",{type:"hidden",name:"do",value:"comment_delete"}),Se.element("input",{type:"hidden",name:"allow_replies",value:"1"}),Se.element("input",{type:"hidden",name:"comment_id",value:this.data.id}),Se.element("div",{className:"comment__actions__button js__comment-delete"},"Delete")),this.data.canUndelete&&Se.element("form",null,Se.element("input",{type:"hidden",name:"xsrf_token",value:Be.xsrfToken}),Se.element("input",{type:"hidden",name:"do",value:"comment_undelete"}),Se.element("input",{type:"hidden",name:"allow_replies",value:"1"}),Se.element("input",{type:"hidden",name:"comment_id",value:this.data.id}),Se.element("div",{className:"comment__actions__button js__comment-undelete"},"Undelete")),!this.data.isOp&&Se.element("a",{rel:"nofollow noopener",href:this.data.url,className:"comment__actions__button"},"Permalink")),Se.element("div",{className:"comment__collapse-state"},Se.element("div",{className:"comment__description markdown markdown--resize-body"},Se.element("p",null,"Comment has been collapsed."))))),!this.data.isOp&&Se.element("div",{className:"comment__children"}))),this.parseNodes(n);for(const e of this.children)e.build(this.nodes.children,"beforeend")}}class Tc extends Sc{constructor(e=0,t=null){super(e,t)}static parseAll(e,t,s=null){const n=[],a=e.querySelectorAll(".comments > .comment_outer:not([data-esgst-parsed]), :scope > .comment_outer:not([data-esgst-parsed]), .reviews > .review_outer:not([data-esgst-parsed]), :scope > .review_outer:not([data-esgst-parsed])");for(const e of a){const a=new Tc(t,s);a.parse(e),n.push(a)}return n}parse(e){this.author=Ft.create(),this.parseNodes(e),this.parseData(),this.nodes.children&&(this.children=Tc.parseAll(this.nodes.children,this.generation+1,this))}parseNodes(e){const t=Sc.getDefaultNodes(),s=Ft.getDefaultNodes();t.outer=e,s.outer=e,t.editState=t.outer.querySelector(".edit_form"),t.editState&&(t.editTextArea=t.editState.querySelector('[name="description"]'),t.editSaveButton=t.editState.querySelector(".btn_action"),t.editCancelButton=t.editState.querySelector(".btn_cancel")),t.inner=t.outer.querySelector(".comment_inner, .review_inner"),t.author=t.inner.querySelector(".author"),t.collapseButton=t.author.querySelector(".comment_collapse_btn"),t.expandButton=t.author.querySelector(".comment_expand_btn"),s.avatarOuter=t.author.querySelector(".author_avatar"),s.usernameInner=t.author.querySelector(".author_name"),s.reputation=t.author.querySelector(".author_small"),s.reputation&&(s.positiveReputation=s.reputation.querySelector(".is_positive"),s.negativeReputation=s.reputation.querySelector(".is_negative")),t.summary=t.inner.querySelector(".comment_body, .review_body"),t.defaultState=t.summary.querySelector(".comment_body_default, .review_description"),t.deleteState=t.summary.querySelector(".comment_body_delete"),t.deleteState&&(t.deletedTimestamp=t.deleteState.querySelector("[data-timestamp]")),t.actions=t.summary.querySelector(".action_list");const n=t.actions.querySelectorAll("[data-timestamp]");t.createdTimestamp=n[0],2===n.length&&(t.editedTimestamp=n[1]),t.replyButton=t.actions.querySelector(".js_comment_reply"),t.editButton=t.actions.querySelector(".js_comment_edit"),t.deleteButton=t.actions.querySelector(".js_comment_delete"),t.undeleteButton=t.actions.querySelector(".js_comment_undelete"),t.sourceThread=t.actions.querySelector('[href*="/trade/"]'),t.sourceThread&&(t.source=t.sourceThread.parentElement,t.sourceComment=t.source.querySelector('[href*="/go/comment/"]')),t.permalink=t.actions.querySelector('[href*="/go/comment/"]:last-child'),t.collapseState=t.summary.querySelector(".comment_body_collapse"),t.collapseState&&(t.collapseCount=t.collapseState.querySelector(".comment_children_count")),t.rating=t.inner.querySelector(".review_rating"),t.children=t.outer.querySelector(".review_children, .comment_children"),t.outer.dataset.esgstParsed="",this.nodes=t,this.author.nodes=s}parseData(){var e,t;const s=this.nodes,n=Sc.getDefaultData();n.id=s.outer.dataset.id,s.editTextArea&&(n.markdown=s.editTextArea.value),n.isDeleted=!!s.deletedTimestamp,s.deletedTimestamp&&(n.deletedTimestamp=parseInt(s.deletedTimestamp.dataset.timestamp)),n.createdTimestamp=parseInt(s.createdTimestamp.dataset.timestamp),s.editedTimestamp&&(n.editedTimestamp=parseInt(s.editedTimestamp.dataset.timestamp)),n.isEdited=!!n.editedTimestamp,n.canReply=!!s.replyButton,n.canEdit=!!s.editButton,n.canDelete=!!s.deleteButton,n.canUndelete=!!s.undeleteButton,s.source&&(s.sourceComment&&(n.sourceCommentUrl=s.sourceComment.getAttribute("href"),n.sourceCommentAuthor=s.sourceComment.textContent.trim().slice(1)),n.sourceThreadUrl=s.sourceThread.getAttribute("href"),n.sourceThreadTitle=s.sourceThread.textContent.trim()),s.permalink&&(n.url=s.permalink.getAttribute("href"),n.code=n.url.split("/")[3]),n.isReview=!!s.rating,n.isReviewPositive=null!==(e=null===(t=s.rating)||void 0===t?void 0:t.classList.contains("is_positive"))&&void 0!==e&&e,this.data=n,this.author.parseData(),this.author.parseExtraData()}build(e,t){this.nodes.outer&&this.nodes.outer.remove();const s=Se.element("fragment",null,Se.element("div",{className:"author"},!this.data.isReview&&Se.element("fragment",null,Se.element("i",{className:"comment_collapse_btn fa fa-minus-square-o"}),Se.element("i",{className:"comment_expand_btn fa fa-plus-square-o"})),this.data.isDeleted?Se.element("fragment",null,Se.element("div",{className:"author_avatar is_icon"},Se.element("i",{className:"fa fa-close"})),Se.element("div",{className:"author_name"},"Deleted")):Se.element("fragment",null,Se.element("a",{href:this.author.data.url,className:"author_avatar",style:`background-image:url(${this.author.data.avatar});`}),Se.element("a",{href:this.author.data.url,className:"author_name"+(this.author.data.op?" is_op":"")},this.author.data.username),Se.element("a",{href:this.author.data.url,className:"author_small"},"(",Se.element("span",{className:"is_positive"},"+",this.author.data.positiveReputation),"/",Se.element("span",{className:"is_negative"},"-",this.author.data.negativeReputation),")"))),Se.element("div",{className:this.data.isReview?"review_body":"comment_body"},this.data.isDeleted?Se.element("div",{className:"comment_body_delete markdown"},Se.element("p",null,"This comment was deleted"," ",Se.element("span",{"data-timestamp":this.data.deletedTimestamp},c.common.getTimeSince(this.data.deletedTimestamp)+" ago"),".")):Se.element("div",{className:(this.data.isReview?"review_description":"comment_body_default")+" markdown"},this.data.markdown?Se.parse(c.esgst.markdownParser.text(this.data.markdown)).body.children:""),Se.element("div",{className:"action_list"},this.data.isReview?Se.element("span",null,Se.element("span",{"data-timestamp":this.data.createdTimestamp},c.common.getTimeSince(this.data.createdTimestamp)+" ago")):Se.element("div",null,Se.element("span",{"data-timestamp":this.data.createdTimestamp},c.common.getTimeSince(this.data.createdTimestamp)+" ago"),this.data.isEdited&&Se.element("span",{"data-timestamp":this.data.editedTimestamp},"*")),this.data.canReply&&Se.element("a",{className:"js_comment_reply"},"Reply"),this.data.canEdit&&Se.element("a",{className:"js_comment_edit"},"Edit"),this.data.canDelete&&Se.element("a",{"data-form":`xsrf_token=${Be.xsrfToken}&do=comment_delete&comment_id=${this.data.id}`,className:"js_comment_delete"},"Delete"),this.data.canUndelete&&Se.element("a",{"data-form":`xsrf_token=${Be.xsrfToken}&do=comment_undelete&comment_id=${this.data.id}`,className:"js_comment_undelete"},"Undelete"),this.data.sourceThreadTitle&&Se.element("div",null,this.data.sourceCommentAuthor&&Se.element("fragment",null,Se.element("a",{rel:"nofollow",href:this.data.sourceCommentUrl},"@",this.data.sourceCommentAuthor),Se.element("i",{className:"fa fa-fw fa-angle-right"})),Se.element("a",{href:this.data.sourceThreadUrl},this.data.sourceThreadTitle)),!this.data.isOp&&Se.element("a",{rel:"nofollow",href:this.data.url},"Permalink")),Se.element("div",{className:"comment_body_collapse markdown"},Se.element("p",{className:"comment_children_count"}))));let n;Se.insert(e,t,Se.element("div",{id:this.data.code,"data-id":this.data.id,className:this.data.isReview?"review_outer":"comment_outer",ref:e=>n=e},this.data.canEdit&&Se.element("div",{className:"edit_form is_hidden"},Se.element("form",null,Se.element("input",{type:"hidden",name:"xsrf_token",value:Be.xsrfToken}),Se.element("input",{type:"hidden",name:"do",value:"comment_edit"}),Se.element("input",{type:"hidden",name:"comment_id",value:this.data.id}),Se.element("textarea",{name:"description"},this.data.markdown),Se.element("div",{className:"btn_actions"},Se.element("div",{className:"btn_action white js_submit"},Se.element("i",{className:"fa fa-edit"}),Se.element("span",null,"Edit")),Se.element("div",{className:"btn_cancel"},Se.element("span",null,"Cancel"))))),Se.element("div",{className:this.data.isReview?"review_inner":"comment_inner","data-username":this.author.data.username},this.data.isReview?Se.element("fragment",null,Se.element("div",{className:"review_flex"},s),this.data.isReviewPositive?Se.element("div",{className:"review_rating is_positive"},Se.element("div",null,Se.element("i",{className:"fa fa-thumbs-up"}))):Se.element("div",{className:"review_rating is_negative"},Se.element("div",null,Se.element("i",{className:"fa fa-thumbs-down"})))):s),!this.data.isOp&&Se.element("div",{className:this.data.isReview?"review_children":"comment_children"}))),this.parseNodes(n);for(const e of this.children)e.build(this.nodes.children,"beforeend")}}hs.getUser.bind(hs);const Nc=hs.getValue.bind(hs);const Pc=new class extends gt{constructor(){super(),this.info={endless:!0,id:"comments",featureMap:{endless:this.comments_load.bind(this)}}}async comments_load(e,t,s,n,a){const i=Sc.parseAll(e);rt.addData("current","commentsV2",i,n);for(const e of c.esgst.commentV2Features)await e(i,t);let o,r,l,g;if(r=await this.comments_get(e,document,t,n),r.length){for(rt.addData("current","comments",r,n),l=0,g=r.length;l<g;++l)r[l].index=l;for(const e of c.esgst.commentFeatures)await e(r,t);if((!t||this.esgst.commentsPath||c.common.isCurrentPath("Messages"))&&(t&&c.esgst.cf&&this.esgst.cf.filteredCount&&d.get("cf_enable"+this.esgst.cf.type)&&this.esgst.modules.commentsCommentFilters.filters_filter(this.esgst.cf,!1,n),!t&&this.esgst.cfPopup&&this.esgst.cfPopup.filteredCount&&d.get("cf_enable"+this.esgst.cfPopup.type)&&this.esgst.modules.commentsCommentFilters.filters_filter(this.esgst.cfPopup,!1,n)),d.get("ct")){if(!t||c.common.isCurrentPath("Messages"))o=0;else{const t=e.querySelectorAll(".page__heading:not([data-esgst]) .page__heading__breadcrumbs");var u;if(o=t[1]||t[0],o)o=parseInt(null===(u=o.firstElementChild.textContent.replace(/,/g,"").match(/\d+/))||void 0===u?void 0:u[0]);else o=0}this.esgst.modules.commentsCommentTracker.ct_getComments(o,r,null,!1,!1,!1,t||n||a)}d.get("rfi")&&(!d.get("rfi_s")||t&&!c.common.isCurrentPath("Messages")||e.getAttribute&&e.getAttribute("data-rfi")||await this.esgst.modules.commentsReplyFromInbox.rfi_getReplies(r,t||n||a)),d.get("ged")&&this.esgst.ged_addIcons(r)}}async comments_get(e,t,s,n){let a,i,o,r,l;for(i=[],r=e.querySelectorAll(hs.getSelectors(n,["X:not(.comment--submit) > .comment__parent","X.comment__child","X.comment_inner"])),l=t.querySelector('.page__heading__breadcrumbs a[href*="/giveaway/"], .page__heading__breadcrumbs a[href*="/discussion/"], .page__heading__breadcrumbs a[href*="/ticket/"], .page_heading_breadcrumbs a[href*="/trade/"]'),o=r.length-1;o>=0;--o){var c;a=await this.comments_getInfo(r[o],(null===(c=rt.current)||void 0===c?void 0:c.sourceLink)||l,n?this.esgst.users:JSON.parse(Nc("users")),s),a&&i.push(a)}return i}async comments_getInfo(e,t,s,n){let a,i,o;const r={};r.comment=e,r.outerWrap=r.comment,r.parent=r.comment.parentElement;const l=r.comment.querySelector(".comment__author, .author_name");if(l){if(r.author=l.textContent.trim(),r.summary=r.comment.querySelector(".comment__summary, .comment_body"),r.isOp=(r.summary&&r.summary.id)===(r.parent&&r.parent.id),r.displayState=r.comment.querySelector(".comment__display-state, .comment_body_default"),r.text=r.displayState?r.displayState.textContent.trim().replace(/View\sattached\simage\./,""):"",r.bump=r.text.replace(/[^A-Za-z]/g,"").match(/^(havea|takea|thanksand|thankyou)?bump(ing|ity|o)?$/i),r.length=r.text.length,r.words=Array.from(new Set(r.text.split(/\s/))),r.actions=r.comment.querySelector(".comment__actions, .action_list"),a=r.actions.querySelectorAll('[href*="/comment/"]'),i=a.length,i>0&&(r.permalink=a[i-1]),r.id=r.permalink?r.permalink.getAttribute("href").match(/\/comment\/(.+)/)[1]:"",r.timestamp=parseInt(r.actions.querySelector("[data-timestamp]").getAttribute("data-timestamp")),!n||c.common.isCurrentPath("Messages"))if(this.esgst.sg)try{o=r.comment.closest(".comments").previousElementSibling.firstElementChild.firstElementChild.getAttribute("href")}catch(e){}else o=r.actions.querySelector('[href*="/trade/"]').getAttribute("href");return!o&&t&&(o=t.getAttribute("href")),o?(o=o.match(/(giveaway|discussion|ticket|trade)\/(.+?)(\/.*)?$/),r.type=o[1]+"s",r.code=o[2],r):void 0}}},Lc=hs.getValue.bind(hs),Ic=hs.lockAndSaveGames.bind(hs),Bc={25657:{id:3970,type:"apps"}};const Dc=new class extends gt{constructor(){super(),this.info={endless:!0,id:"games",featureMap:{endless:this.games_load.bind(this)}}}async games_load(e,t,s,n){let a=await this.games_get(e,t,n?this.esgst.games:JSON.parse(Lc("games")),n);if(!Object.keys(a.apps).length&&!Object.keys(a.subs).length)return;const i=[];["apps","subs"].forEach(e=>{for(let t in a[e])a[e].hasOwnProperty(t)&&a[e][t].forEach(s=>{i.push({game:s,code:t,innerWrap:s.headingName,name:s.name,outerWrap:s.headingName,type:e})})}),rt.addData("current","games",i,n);for(const e of this.esgst.gameFeatures)await e(a,t,s,n,"apps");for(const e in a.apps)a.apps.hasOwnProperty(e)&&a.apps[e].forEach(e=>this.esgst.modules.giveaways.giveaways_reorder(e));for(const e in a.subs)a.subs.hasOwnProperty(e)&&a.subs[e].forEach(e=>this.esgst.modules.giveaways.giveaways_reorder(e));t&&this.esgst.gmf&&this.esgst.gmf.filteredCount&&d.get("gmf_enable"+this.esgst.gmf.type)&&this.esgst.modules.gamesGameFilters.filters_filter(this.esgst.gmf,!1,n)}async games_get(e,t,s,n){let a,i,o,r,l,g,u,m,h,p;for(i={apps:{},subs:{},all:[]},this.esgst.discussionPath&&t?(h=`${n?`.esgst-es-page-${n} .featured__outer-wrap--giveaway, .esgst-es-page-${n}.featured__outer-wrap--giveaway`:".featured__outer-wrap--giveaway"}, ${n?`.esgst-es-page-${n} .giveaway__row-outer-wrap, .esgst-es-page-${n}.giveaway__row-outer-wrap`:".giveaway__row-outer-wrap"}, ${n?`.esgst-es-page-${n} .table__row-outer-wrap, .esgst-es-page-${n}.table__row-outer-wrap`:".table__row-outer-wrap"}, ${n?`.esgst-es-page-${n} .markdown table td, .esgst-es-page-${n}.markdown table td`:".markdown table td"}`,m=".giveaway__heading__name, .featured__heading__medium, .table__column__heading, a"):(h=`${n?`.esgst-es-page-${n} .featured__outer-wrap--giveaway, .esgst-es-page-${n}.featured__outer-wrap--giveaway`:".featured__outer-wrap--giveaway"}, ${n?`.esgst-es-page-${n} .giveaway__row-outer-wrap, .esgst-es-page-${n}.giveaway__row-outer-wrap`:".giveaway__row-outer-wrap"}, ${n?`.esgst-es-page-${n} .table__row-outer-wrap, .esgst-es-page-${n}.table__row-outer-wrap`:".table__row-outer-wrap"}`,m=".giveaway__heading__name, .featured__heading__medium, .table__column__heading"),g=e.querySelectorAll(h),o=0,u=g.length;o<u;++o)if(a=rt.findData("main","giveaways").filter(e=>e.outerWrap===g[o])[0],a||(a={isGame:!0,outerWrap:g[o]}),a.container=a.outerWrap,a.columns=a.container.querySelector(".giveaway__columns, .featured__columns"),a.table=!!a.container.closest("table"),a.grid=a.container.closest(".esgst-gv-view"),a.grid&&(a.gvIcons=a.container.getElementsByClassName("esgst-gv-icons")[0]),a.panel=a.container.querySelector(".esgst-giveaway-panel"),l=await this.games_getInfo(a.container,t),a.headingName=a.container.querySelector(m),a.headingName){if(a.headingName.getAttribute("href")&&a.headingName.getAttribute("href").match(/\/(discussion|\/support\/ticket|trade)\//))continue;a.table||this.esgst.wishlistPath?a.heading=a.headingName:a.heading=a.headingName.parentElement,a.name||(a.name=a.headingName.textContent);const e=a.name.match(/^\$(.+?)\sSteam\sGift\sCard$/);e&&(a.points=parseInt(e[1].replace(/,/g,"")),l={id:"SteamGiftCard"+a.points,type:"apps"});if(a.name.match(/^Humble.+?Bundle/)&&(l={id:a.name.replace(/\s/g,""),type:"apps"}),l){if(r=l.id,p=l.type,a.id=r,a.type=p,c.esgst.games&&c.esgst.games[a.type][a.id]){const e=["owned","wishlisted","previouslyWishlisted","followed","hidden","ignored","previouslyEntered","previouslyWon","reducedCV","noCV","banned","removed"];for(const t of e)("banned"===t&&c.esgst.delistedGames.banned.indexOf(parseInt(a.id))>-1||"removed"===t&&(c.esgst.delistedGames.removed.indexOf(parseInt(a.id))>-1||c.esgst.games[a.type][a.id].removed)||c.esgst.games[a.type][a.id]["previouslyEntered"===t?"entered":"previouslyWon"===t?"won":t])&&(a[t]=!0)}if(d.get("lastSyncHiddenGames")>0&&window.location.pathname.match(/^\/account\/settings\/giveaways\/filters/)&&t){const e=a.container.getElementsByClassName("table__remove-default")[0];e&&e.addEventListener("click",hs.updateHiddenGames.bind(hs,r,p,!0))}i[p][r]||(i[p][r]=[]),a.tagContext=a.container.closest(".poll")&&a.container.getElementsByClassName("table__column__heading")[0]||a.headingName,a.tagPosition="afterend",a.saved=this.esgst.games[p][r],i[p][r].push(a),i.all.push(a)}}return i}async games_getInfo(e,t){if(!e)return null;const s=e.querySelector('[href*="store.steampowered.com/app/"], [href*="store.steampowered.com/sub/"], [href*="store.steampowered.com/bundle/"], [href*="steamcommunity.com/app/"], [href*="steamcommunity.com/sub/"], [href*="steamcommunity.com/bundle/"]'),n=e.querySelector('[style*="/apps/"], [style*="/subs/"], [style*="/bundles/"]');if(s||n){const e=s&&s.getAttribute("href")||n&&n.getAttribute("style");if(!e)return null;const t=e.match(/\/(app|sub|bundle)s?\/(\d+)/);return"bundle"===t[1]?{id:"SteamBundle"+t[2],type:"subs"}:{id:t[2],type:t[1]+"s"}}const a=e.getAttribute("data-game-id");if(a&&Bc[a])return Bc[a];if(!e.querySelector(".table_image_thumbnail_missing"))return null;const i=e.querySelector(".table__column__heading");if(!i)return null;const o=i.textContent.trim();for(const e of["apps","subs"])for(const t in this.esgst.games[e])if(this.esgst.games[e].hasOwnProperty(t)&&this.esgst.games[e][t].name===o)return{id:t,type:e};if(!i.getAttribute("href"))return null;const r=await Ne.get(i.getAttribute("href")),l=(await this.esgst.modules.giveaways.giveaways_get(r.html,!1,r.url))[0];if(!l||!l.gameType||!l.gameSteamId)return null;const g={apps:{},subs:{}};return g[l.gameType][l.gameSteamId]={name:o},rt.findData("main","giveaways").map(e=>{if(e.name!==o||e.id)return e;if(e.id=l.gameSteamId,e.type=l.gameType,this.esgst.games&&this.esgst.games[e.type][e.id]){const t=["owned","wishlisted","previouslyWishlisted","followed","hidden","ignored","previouslyEntered","previouslyWon","reducedCV","noCV","banned","removed"];for(const s of t)("banned"===s&&c.esgst.delistedGames.banned.indexOf(parseInt(e.id))>-1||"removed"===s&&(c.esgst.delistedGames.removed.indexOf(parseInt(e.id))>-1||c.esgst.games[e.type][e.id].removed)||c.esgst.games[e.type][e.id]["previouslyEntered"===s?"entered":"previouslyWon"===s?"won":s])&&(e[s]=!0)}return e}),t&&c.esgst.gf&&this.esgst.gf.filteredCount&&d.get("gf_enable"+this.esgst.gf.type)&&this.esgst.modules.giveawaysGiveawayFilters.filters_filter(this.esgst.gf),Ic(g),{id:l.gameSteamId,type:l.gameType}}};const Gc=new class extends gt{constructor(){super(),this.info={endless:!0,id:"groups",featureMap:{endless:this.groups_load.bind(this)}}}async groups_load(e,t,s,n){const a=e.querySelectorAll((n?`.esgst-es-page-${n} a[href*="/group/"]:not(.table_image_avatar), .esgst-es-page-${n}a[href*="/group/"]:not(.table_image_avatar)`:'a[href*="/group/"]:not(.table_image_avatar)')+", .form_list_item_summary_name");if(!a.length)return;const i=[];for(const e of a){var o,r,l,c;if(e.children.length||e.closest(".markdown"))continue;const t={saved:null,url:e.getAttribute("href")};if(t.url){const e=t.url.match(/\/group\/(.+?)\//);e&&(t.id=e[1],t.saved=this.esgst.groups.filter(e=>e.code===t.id)[0])}if(!t.id){var g;const s=e.parentElement.previousElementSibling;if(null!=s&&null!==(g=s.style)&&void 0!==g&&g.backgroundImage){const e=s.style.backgroundImage;t.saved=this.esgst.groups.filter(t=>e.match(t.avatar))[0],t.id=t.saved&&t.saved.code}}if(!t.id)continue;if(t.code=t.id,this.esgst.currentGroups[t.id]||(this.esgst.currentGroups[t.id]={elements:[],savedGroup:t.saved}),this.esgst.currentGroups[t.id].elements.indexOf(e)>-1)continue;const s=null===(o=e.textContent)||void 0===o?void 0:o.trim(),n=null!==(r=null===(l=t.url)||void 0===l||null===(l=l.replace("/group/",""))||void 0===l||null===(l=l.split("/"))||void 0===l||null===(l=l.pop())||void 0===l?void 0:l.replace(/[-_]+/g," "))&&void 0!==r?r:"";t.name=s||(n||t.id||"Unknown Group");const a=e.parentElement;var u;if(t.oldElement=e,this.esgst.groupPath&&a.classList.contains("page__heading__breadcrumbs"))t.element=document.getElementsByClassName("featured__heading__medium")[0],t.container=null===(u=t.element)||void 0===u?void 0:u.parentElement;else t.element=e,t.container=a;if(s)t.context=t.element;else{var m;let s=(null===(m=e.closest(".table__row-inner-wrap"))||void 0===m?void 0:m.querySelector(".table__column--width-fill"))||e.closest(".form_list_item_summary")||e.parentElement;t.context=s,t.container=s;const n=t.context.querySelector(".table__column__heading");if((null==n||!n.textContent.trim())&&t.name&&t.url){const e=document.createElement("a");e.href=t.url,e.className="table__column__heading",e.textContent=t.name;const s=t.context.querySelector("a.table_image_avatar");s&&s.parentElement===t.context?s.insertAdjacentElement("afterend",e):t.context.insertBefore(e,t.context.firstChild)}if(this.esgst.groupPath){const e=document.querySelector(".page__heading__breadcrumbs"),s=null==e?void 0:e.querySelector('a[href*="/group/"]');s&&0===s.textContent.trim().length&&(s.textContent=t.name);const n=document.querySelector(".featured__heading__medium");n&&0===n.textContent.trim().length&&(n.textContent=t.name)}}this.esgst.currentGroups[t.id].elements.push(t.element),t.innerWrap=e.closest(".table__row-inner-wrap")||t.container,t.outerWrap=e.closest(".table__row-outer-wrap")||t.container;(null===(c=t.context)||void 0===c?void 0:c.classList.contains("featured__heading__medium"))?(t.tagContext=t.container,t.tagPosition="beforeend"):s?(t.tagContext=t.context,t.tagPosition="afterend"):(t.tagContext=t.container.firstElementChild||t.container,t.tagPosition="afterend"),i.push(t)}rt.addData("current","groups",i,n),t&&this.esgst.gpf&&this.esgst.gpf.filteredCount&&d.get("gpf_enable"+this.esgst.gpf.type)&&this.esgst.modules.groupsGroupFilters.filters_filter(this.esgst.gpf,!1,n);for(const e of this.esgst.groupFeatures)await e(i,t,s,n)}};const qc=new class extends gt{constructor(){super(),this.info={endless:!0,id:"users",featureMap:{endless:this.users_load.bind(this)}}}async users_load(e,t,s,n){const a=e.querySelectorAll(c.common.getSelectors(n,["Xa[href*='/user/']","Xa[href*='/profiles/']"]));if(!a.length)return;let i=!1;const o=[],r=[];for(let e=a.length-1;e>-1;e--){let t=a[e];const s=this.esgst.sg&&!t.getAttribute("data-st")||t.getAttribute("data-sg");let n=!1,l=t.getAttribute("href").match(/\/user\/(.+)/);if(l||(l=t.getAttribute("href").match(/\/profiles\/(.+)/),n=!0),!l)continue;const d=n?t.textContent:l[1];if(!d)continue;if((!s||t.textContent!==d)&&(s||!t.textContent||t.children.length)||t.closest(".markdown"))continue;if(!this.esgst.currentUsers[d]){this.esgst.currentUsers[d]={elements:[]};const e=s?this.esgst.users.steamIds[d]:d;this.esgst.currentUsers[d].savedUser=this.esgst.users.users[e],this.esgst.currentUsers[d].savedUser&&(this.esgst.currentUsers[d].steamId=e)}let g;for(g=this.esgst.currentUsers[d].elements.length-1;g>-1&&this.esgst.currentUsers[d].elements[g]!==t;g--);if(g>-1)continue;const u=this.esgst.currentUsers[d].savedUser,m=t.parentElement,h=t;this.esgst.userPath&&m.classList.contains("page__heading__breadcrumbs")&&(t=document.getElementsByClassName("featured__heading__medium")[0]),this.esgst.currentUsers[d].elements.push(t);const p=m.classList.contains("comment__username")?m:t,f={code:d,innerWrap:p,outerWrap:p,sg:s};if(c.esgst.groupPath){const e=f.outerWrap.closest(".table__column--width-fill");if(e){const t=e.nextElementSibling,s=t.nextElementSibling,n=s.nextElementSibling,a=n.nextElementSibling,i=t.textContent.trim().match(/(.+?)\s\((.+?)\)/),o=s.textContent.trim().match(/(.+?)\s\((.+?)\)/);f.sentCount=i[1],f.sentValue=i[2],f.receivedCount=o[1],f.receivedValue=o[2],f.giftDifference=n.textContent.trim(),f.valueDifference=a.textContent.trim()}}o.push(f),i||(i=!0);const b=p.classList.contains("featured__heading__medium"),w=p.parentElement;let y=p;w.classList.contains("comment__username")&&(y=w),r.push({container:w,context:p,element:t,id:d,oldElement:h,saved:u,steamId:s?u&&u.steamId:d,tagContext:b?w:y,tagPosition:b?"beforeend":"afterend",username:s?d:u&&u.username})}rt.addData("current","users",o,n);for(const e of this.esgst.userFeatures)await e(r,t,s,n);i&&(this.esgst.wbcButton&&e===document&&!this.esgst.aboutPath&&(this.esgst.wbcButton.classList.remove("esgst-hidden"),this.esgst.wbcButton.parentElement.classList.remove("esgst-hidden")),this.esgst.uscButton&&e===document&&!this.esgst.aboutPath&&(this.esgst.uscButton.classList.remove("esgst-hidden"),this.esgst.uscButton.parentElement.classList.remove("esgst-hidden")),d.get("mm_enableUsers")&&this.esgst.mm_enable&&this.esgst.mm_enable(rt.findData("current","users"),"Users"))}};s(171);function Rc(e,t){(null==t||t>e.length)&&(t=e.length);for(var s=0,n=Array(t);s<t;s++)n[s]=e[s];return n}function Mc(e,t){var s="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!s){if(Array.isArray(e)||(s=function(e,t){if(e){if("string"==typeof e)return Rc(e,t);var s={}.toString.call(e).slice(8,-1);return"Object"===s&&e.constructor&&(s=e.constructor.name),"Map"===s||"Set"===s?Array.from(e):"Arguments"===s||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(s)?Rc(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){s&&(e=s);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,r=!1;return{s:function(){s=s.call(e)},n:function(){var e=s.next();return o=e.done,e},e:function(e){r=!0,i=e},f:function(){try{o||null==s.return||s.return()}finally{if(r)throw i}}}}function Oc(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Uc(e,t){return(Uc=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function Fc(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Uc(e,t)}function $c(e){return($c=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Wc(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(Wc=function(){return!!e})()}function Vc(e,t){if(t&&("object"==_(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return Oc(e)}function jc(e){var t=Wc();return function(){var s,n=$c(e);if(t){var a=$c(this).constructor;s=Reflect.construct(n,arguments,a)}else s=n.apply(this,arguments);return Vc(this,s)}}function Hc(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Jc(e){var t=function(e,t){if("object"!=_(e)||!e)return e;var s=e[Symbol.toPrimitive];if(void 0!==s){var n=s.call(e,t||"default");if("object"!=_(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==_(t)?t:t+""}function Yc(e,t){for(var s=0;s<t.length;s++){var n=t[s];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Jc(n.key),n)}}function Kc(e,t,s){return t&&Yc(e.prototype,t),s&&Yc(e,s),Object.defineProperty(e,"prototype",{writable:!1}),e}function zc(e,t,s){return(t=Jc(t))in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}var Qc=function(){function e(){Hc(this,e),zc(this,"priority",void 0),zc(this,"subPriority",0)}return Kc(e,[{key:"validate",value:function(e,t){return!0}}]),e}(),Zc=function(e){Fc(s,e);var t=jc(s);function s(e,n,a,i,o){var r;return Hc(this,s),(r=t.call(this)).value=e,r.validateValue=n,r.setValue=a,r.priority=i,o&&(r.subPriority=o),r}return Kc(s,[{key:"validate",value:function(e,t){return this.validateValue(e,this.value,t)}},{key:"set",value:function(e,t,s){return this.setValue(e,t,this.value,s)}}]),s}(Qc),Xc=function(e){Fc(s,e);var t=jc(s);function s(){var e;Hc(this,s);for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return zc(Oc(e=t.call.apply(t,[this].concat(a))),"priority",10),zc(Oc(e),"subPriority",-1),e}return Kc(s,[{key:"set",value:function(e,t){if(t.timestampIsSet)return e;var s=new Date(0);return s.setFullYear(e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate()),s.setHours(e.getUTCHours(),e.getUTCMinutes(),e.getUTCSeconds(),e.getUTCMilliseconds()),s}}]),s}(Qc),ed=function(){function e(){Hc(this,e),zc(this,"incompatibleTokens",void 0),zc(this,"priority",void 0),zc(this,"subPriority",void 0)}return Kc(e,[{key:"run",value:function(e,t,s,n){var a=this.parse(e,t,s,n);return a?{setter:new Zc(a.value,this.validate,this.set,this.priority,this.subPriority),rest:a.rest}:null}},{key:"validate",value:function(e,t,s){return!0}}]),e}(),td=function(e){Fc(s,e);var t=jc(s);function s(){var e;Hc(this,s);for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return zc(Oc(e=t.call.apply(t,[this].concat(a))),"priority",140),zc(Oc(e),"incompatibleTokens",["R","u","t","T"]),e}return Kc(s,[{key:"parse",value:function(e,t,s){switch(t){case"G":case"GG":case"GGG":return s.era(e,{width:"abbreviated"})||s.era(e,{width:"narrow"});case"GGGGG":return s.era(e,{width:"narrow"});case"GGGG":default:return s.era(e,{width:"wide"})||s.era(e,{width:"abbreviated"})||s.era(e,{width:"narrow"})}}},{key:"set",value:function(e,t,s){return t.era=s,e.setUTCFullYear(s,0,1),e.setUTCHours(0,0,0,0),e}}]),s}(ed),sd=/^(1[0-2]|0?\d)/,nd=/^(3[0-1]|[0-2]?\d)/,ad=/^(36[0-6]|3[0-5]\d|[0-2]?\d?\d)/,id=/^(5[0-3]|[0-4]?\d)/,od=/^(2[0-3]|[0-1]?\d)/,rd=/^(2[0-4]|[0-1]?\d)/,ld=/^(1[0-1]|0?\d)/,cd=/^(1[0-2]|0?\d)/,dd=/^[0-5]?\d/,gd=/^[0-5]?\d/,ud=/^\d/,md=/^\d{1,2}/,hd=/^\d{1,3}/,pd=/^\d{1,4}/,fd=/^-?\d+/,bd=/^-?\d/,wd=/^-?\d{1,2}/,yd=/^-?\d{1,3}/,vd=/^-?\d{1,4}/,_d=/^([+-])(\d{2})(\d{2})?|Z/,kd=/^([+-])(\d{2})(\d{2})|Z/,xd=/^([+-])(\d{2})(\d{2})((\d{2}))?|Z/,Ad=/^([+-])(\d{2}):(\d{2})|Z/,Cd=/^([+-])(\d{2}):(\d{2})(:(\d{2}))?|Z/;function Sd(e,t){return e?{value:t(e.value),rest:e.rest}:e}function Ed(e,t){var s=t.match(e);return s?{value:parseInt(s[0],10),rest:t.slice(s[0].length)}:null}function Td(e,t){var s=t.match(e);return s?"Z"===s[0]?{value:0,rest:t.slice(1)}:{value:("+"===s[1]?1:-1)*(36e5*(s[2]?parseInt(s[2],10):0)+6e4*(s[3]?parseInt(s[3],10):0)+1e3*(s[5]?parseInt(s[5],10):0)),rest:t.slice(s[0].length)}:null}function Nd(e){return Ed(fd,e)}function Pd(e,t){switch(e){case 1:return Ed(ud,t);case 2:return Ed(md,t);case 3:return Ed(hd,t);case 4:return Ed(pd,t);default:return Ed(new RegExp("^\\d{1,"+e+"}"),t)}}function Ld(e,t){switch(e){case 1:return Ed(bd,t);case 2:return Ed(wd,t);case 3:return Ed(yd,t);case 4:return Ed(vd,t);default:return Ed(new RegExp("^-?\\d{1,"+e+"}"),t)}}function Id(e){switch(e){case"morning":return 4;case"evening":return 17;case"pm":case"noon":case"afternoon":return 12;case"am":case"midnight":case"night":default:return 0}}function Bd(e,t){var s,n=t>0,a=n?t:1-t;if(a<=50)s=e||100;else{var i=a+50;s=e+100*Math.floor(i/100)-(e>=i%100?100:0)}return n?s:1-s}function Dd(e){return e%400==0||e%4==0&&e%100!=0}var Gd=function(e){Fc(s,e);var t=jc(s);function s(){var e;Hc(this,s);for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return zc(Oc(e=t.call.apply(t,[this].concat(a))),"priority",130),zc(Oc(e),"incompatibleTokens",["Y","R","u","w","I","i","e","c","t","T"]),e}return Kc(s,[{key:"parse",value:function(e,t,s){var n=function(e){return{year:e,isTwoDigitYear:"yy"===t}};switch(t){case"y":return Sd(Pd(4,e),n);case"yo":return Sd(s.ordinalNumber(e,{unit:"year"}),n);default:return Sd(Pd(t.length,e),n)}}},{key:"validate",value:function(e,t){return t.isTwoDigitYear||t.year>0}},{key:"set",value:function(e,t,s){var n=e.getUTCFullYear();if(s.isTwoDigitYear){var a=Bd(s.year,n);return e.setUTCFullYear(a,0,1),e.setUTCHours(0,0,0,0),e}var i="era"in t&&1!==t.era?1-s.year:s.year;return e.setUTCFullYear(i,0,1),e.setUTCHours(0,0,0,0),e}}]),s}(ed),qd=function(e){Fc(s,e);var t=jc(s);function s(){var e;Hc(this,s);for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return zc(Oc(e=t.call.apply(t,[this].concat(a))),"priority",130),zc(Oc(e),"incompatibleTokens",["y","R","u","Q","q","M","L","I","d","D","i","t","T"]),e}return Kc(s,[{key:"parse",value:function(e,t,s){var n=function(e){return{year:e,isTwoDigitYear:"YY"===t}};switch(t){case"Y":return Sd(Pd(4,e),n);case"Yo":return Sd(s.ordinalNumber(e,{unit:"year"}),n);default:return Sd(Pd(t.length,e),n)}}},{key:"validate",value:function(e,t){return t.isTwoDigitYear||t.year>0}},{key:"set",value:function(e,t,s,n){var a=q(e,n);if(s.isTwoDigitYear){var i=Bd(s.year,a);return e.setUTCFullYear(i,0,n.firstWeekContainsDate),e.setUTCHours(0,0,0,0),G(e,n)}var o="era"in t&&1!==t.era?1-s.year:s.year;return e.setUTCFullYear(o,0,n.firstWeekContainsDate),e.setUTCHours(0,0,0,0),G(e,n)}}]),s}(ed),Rd=function(e){Fc(s,e);var t=jc(s);function s(){var e;Hc(this,s);for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return zc(Oc(e=t.call.apply(t,[this].concat(a))),"priority",130),zc(Oc(e),"incompatibleTokens",["G","y","Y","u","Q","q","M","L","w","d","D","e","c","t","T"]),e}return Kc(s,[{key:"parse",value:function(e,t){return Ld("R"===t?4:t.length,e)}},{key:"set",value:function(e,t,s){var n=new Date(0);return n.setUTCFullYear(s,0,4),n.setUTCHours(0,0,0,0),N(n)}}]),s}(ed),Md=function(e){Fc(s,e);var t=jc(s);function s(){var e;Hc(this,s);for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return zc(Oc(e=t.call.apply(t,[this].concat(a))),"priority",130),zc(Oc(e),"incompatibleTokens",["G","y","Y","R","w","I","i","e","c","t","T"]),e}return Kc(s,[{key:"parse",value:function(e,t){return Ld("u"===t?4:t.length,e)}},{key:"set",value:function(e,t,s){return e.setUTCFullYear(s,0,1),e.setUTCHours(0,0,0,0),e}}]),s}(ed),Od=function(e){Fc(s,e);var t=jc(s);function s(){var e;Hc(this,s);for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return zc(Oc(e=t.call.apply(t,[this].concat(a))),"priority",120),zc(Oc(e),"incompatibleTokens",["Y","R","q","M","L","w","I","d","D","i","e","c","t","T"]),e}return Kc(s,[{key:"parse",value:function(e,t,s){switch(t){case"Q":case"QQ":return Pd(t.length,e);case"Qo":return s.ordinalNumber(e,{unit:"quarter"});case"QQQ":return s.quarter(e,{width:"abbreviated",context:"formatting"})||s.quarter(e,{width:"narrow",context:"formatting"});case"QQQQQ":return s.quarter(e,{width:"narrow",context:"formatting"});case"QQQQ":default:return s.quarter(e,{width:"wide",context:"formatting"})||s.quarter(e,{width:"abbreviated",context:"formatting"})||s.quarter(e,{width:"narrow",context:"formatting"})}}},{key:"validate",value:function(e,t){return t>=1&&t<=4}},{key:"set",value:function(e,t,s){return e.setUTCMonth(3*(s-1),1),e.setUTCHours(0,0,0,0),e}}]),s}(ed),Ud=function(e){Fc(s,e);var t=jc(s);function s(){var e;Hc(this,s);for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return zc(Oc(e=t.call.apply(t,[this].concat(a))),"priority",120),zc(Oc(e),"incompatibleTokens",["Y","R","Q","M","L","w","I","d","D","i","e","c","t","T"]),e}return Kc(s,[{key:"parse",value:function(e,t,s){switch(t){case"q":case"qq":return Pd(t.length,e);case"qo":return s.ordinalNumber(e,{unit:"quarter"});case"qqq":return s.quarter(e,{width:"abbreviated",context:"standalone"})||s.quarter(e,{width:"narrow",context:"standalone"});case"qqqqq":return s.quarter(e,{width:"narrow",context:"standalone"});case"qqqq":default:return s.quarter(e,{width:"wide",context:"standalone"})||s.quarter(e,{width:"abbreviated",context:"standalone"})||s.quarter(e,{width:"narrow",context:"standalone"})}}},{key:"validate",value:function(e,t){return t>=1&&t<=4}},{key:"set",value:function(e,t,s){return e.setUTCMonth(3*(s-1),1),e.setUTCHours(0,0,0,0),e}}]),s}(ed),Fd=function(e){Fc(s,e);var t=jc(s);function s(){var e;Hc(this,s);for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return zc(Oc(e=t.call.apply(t,[this].concat(a))),"incompatibleTokens",["Y","R","q","Q","L","w","I","D","i","e","c","t","T"]),zc(Oc(e),"priority",110),e}return Kc(s,[{key:"parse",value:function(e,t,s){var n=function(e){return e-1};switch(t){case"M":return Sd(Ed(sd,e),n);case"MM":return Sd(Pd(2,e),n);case"Mo":return Sd(s.ordinalNumber(e,{unit:"month"}),n);case"MMM":return s.month(e,{width:"abbreviated",context:"formatting"})||s.month(e,{width:"narrow",context:"formatting"});case"MMMMM":return s.month(e,{width:"narrow",context:"formatting"});case"MMMM":default:return s.month(e,{width:"wide",context:"formatting"})||s.month(e,{width:"abbreviated",context:"formatting"})||s.month(e,{width:"narrow",context:"formatting"})}}},{key:"validate",value:function(e,t){return t>=0&&t<=11}},{key:"set",value:function(e,t,s){return e.setUTCMonth(s,1),e.setUTCHours(0,0,0,0),e}}]),s}(ed),$d=function(e){Fc(s,e);var t=jc(s);function s(){var e;Hc(this,s);for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return zc(Oc(e=t.call.apply(t,[this].concat(a))),"priority",110),zc(Oc(e),"incompatibleTokens",["Y","R","q","Q","M","w","I","D","i","e","c","t","T"]),e}return Kc(s,[{key:"parse",value:function(e,t,s){var n=function(e){return e-1};switch(t){case"L":return Sd(Ed(sd,e),n);case"LL":return Sd(Pd(2,e),n);case"Lo":return Sd(s.ordinalNumber(e,{unit:"month"}),n);case"LLL":return s.month(e,{width:"abbreviated",context:"standalone"})||s.month(e,{width:"narrow",context:"standalone"});case"LLLLL":return s.month(e,{width:"narrow",context:"standalone"});case"LLLL":default:return s.month(e,{width:"wide",context:"standalone"})||s.month(e,{width:"abbreviated",context:"standalone"})||s.month(e,{width:"narrow",context:"standalone"})}}},{key:"validate",value:function(e,t){return t>=0&&t<=11}},{key:"set",value:function(e,t,s){return e.setUTCMonth(s,1),e.setUTCHours(0,0,0,0),e}}]),s}(ed);var Wd=function(e){Fc(s,e);var t=jc(s);function s(){var e;Hc(this,s);for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return zc(Oc(e=t.call.apply(t,[this].concat(a))),"priority",100),zc(Oc(e),"incompatibleTokens",["y","R","u","q","Q","M","L","I","d","D","i","t","T"]),e}return Kc(s,[{key:"parse",value:function(e,t,s){switch(t){case"w":return Ed(id,e);case"wo":return s.ordinalNumber(e,{unit:"week"});default:return Pd(t.length,e)}}},{key:"validate",value:function(e,t){return t>=1&&t<=53}},{key:"set",value:function(e,t,s,n){return G(function(e,t,s){k(2,arguments);var n=A(e),a=S(t),i=M(n,s)-a;return n.setUTCDate(n.getUTCDate()-7*i),n}(e,s,n),n)}}]),s}(ed);var Vd=function(e){Fc(s,e);var t=jc(s);function s(){var e;Hc(this,s);for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return zc(Oc(e=t.call.apply(t,[this].concat(a))),"priority",100),zc(Oc(e),"incompatibleTokens",["y","Y","u","q","Q","M","L","w","d","D","e","c","t","T"]),e}return Kc(s,[{key:"parse",value:function(e,t,s){switch(t){case"I":return Ed(id,e);case"Io":return s.ordinalNumber(e,{unit:"week"});default:return Pd(t.length,e)}}},{key:"validate",value:function(e,t){return t>=1&&t<=53}},{key:"set",value:function(e,t,s){return N(function(e,t){k(2,arguments);var s=A(e),n=S(t),a=I(s)-n;return s.setUTCDate(s.getUTCDate()-7*a),s}(e,s))}}]),s}(ed),jd=[31,28,31,30,31,30,31,31,30,31,30,31],Hd=[31,29,31,30,31,30,31,31,30,31,30,31],Jd=function(e){Fc(s,e);var t=jc(s);function s(){var e;Hc(this,s);for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return zc(Oc(e=t.call.apply(t,[this].concat(a))),"priority",90),zc(Oc(e),"subPriority",1),zc(Oc(e),"incompatibleTokens",["Y","R","q","Q","w","I","D","i","e","c","t","T"]),e}return Kc(s,[{key:"parse",value:function(e,t,s){switch(t){case"d":return Ed(nd,e);case"do":return s.ordinalNumber(e,{unit:"date"});default:return Pd(t.length,e)}}},{key:"validate",value:function(e,t){var s=Dd(e.getUTCFullYear()),n=e.getUTCMonth();return s?t>=1&&t<=Hd[n]:t>=1&&t<=jd[n]}},{key:"set",value:function(e,t,s){return e.setUTCDate(s),e.setUTCHours(0,0,0,0),e}}]),s}(ed),Yd=function(e){Fc(s,e);var t=jc(s);function s(){var e;Hc(this,s);for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return zc(Oc(e=t.call.apply(t,[this].concat(a))),"priority",90),zc(Oc(e),"subpriority",1),zc(Oc(e),"incompatibleTokens",["Y","R","q","Q","M","L","w","I","d","E","i","e","c","t","T"]),e}return Kc(s,[{key:"parse",value:function(e,t,s){switch(t){case"D":case"DD":return Ed(ad,e);case"Do":return s.ordinalNumber(e,{unit:"date"});default:return Pd(t.length,e)}}},{key:"validate",value:function(e,t){return Dd(e.getUTCFullYear())?t>=1&&t<=366:t>=1&&t<=365}},{key:"set",value:function(e,t,s){return e.setUTCMonth(0,s),e.setUTCHours(0,0,0,0),e}}]),s}(ed);function Kd(e,t,s){var n,a,i,o,r,l,c,d;k(2,arguments);var g=D(),u=S(null!==(n=null!==(a=null!==(i=null!==(o=null==s?void 0:s.weekStartsOn)&&void 0!==o?o:null==s||null===(r=s.locale)||void 0===r||null===(l=r.options)||void 0===l?void 0:l.weekStartsOn)&&void 0!==i?i:g.weekStartsOn)&&void 0!==a?a:null===(c=g.locale)||void 0===c||null===(d=c.options)||void 0===d?void 0:d.weekStartsOn)&&void 0!==n?n:0);if(!(u>=0&&u<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");var m=A(e),h=S(t),p=m.getUTCDay(),f=h%7,b=(f+7)%7,w=(b<u?7:0)+h-p;return m.setUTCDate(m.getUTCDate()+w),m}var zd=function(e){Fc(s,e);var t=jc(s);function s(){var e;Hc(this,s);for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return zc(Oc(e=t.call.apply(t,[this].concat(a))),"priority",90),zc(Oc(e),"incompatibleTokens",["D","i","e","c","t","T"]),e}return Kc(s,[{key:"parse",value:function(e,t,s){switch(t){case"E":case"EE":case"EEE":return s.day(e,{width:"abbreviated",context:"formatting"})||s.day(e,{width:"short",context:"formatting"})||s.day(e,{width:"narrow",context:"formatting"});case"EEEEE":return s.day(e,{width:"narrow",context:"formatting"});case"EEEEEE":return s.day(e,{width:"short",context:"formatting"})||s.day(e,{width:"narrow",context:"formatting"});case"EEEE":default:return s.day(e,{width:"wide",context:"formatting"})||s.day(e,{width:"abbreviated",context:"formatting"})||s.day(e,{width:"short",context:"formatting"})||s.day(e,{width:"narrow",context:"formatting"})}}},{key:"validate",value:function(e,t){return t>=0&&t<=6}},{key:"set",value:function(e,t,s,n){return(e=Kd(e,s,n)).setUTCHours(0,0,0,0),e}}]),s}(ed),Qd=function(e){Fc(s,e);var t=jc(s);function s(){var e;Hc(this,s);for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return zc(Oc(e=t.call.apply(t,[this].concat(a))),"priority",90),zc(Oc(e),"incompatibleTokens",["y","R","u","q","Q","M","L","I","d","D","E","i","c","t","T"]),e}return Kc(s,[{key:"parse",value:function(e,t,s,n){var a=function(e){var t=7*Math.floor((e-1)/7);return(e+n.weekStartsOn+6)%7+t};switch(t){case"e":case"ee":return Sd(Pd(t.length,e),a);case"eo":return Sd(s.ordinalNumber(e,{unit:"day"}),a);case"eee":return s.day(e,{width:"abbreviated",context:"formatting"})||s.day(e,{width:"short",context:"formatting"})||s.day(e,{width:"narrow",context:"formatting"});case"eeeee":return s.day(e,{width:"narrow",context:"formatting"});case"eeeeee":return s.day(e,{width:"short",context:"formatting"})||s.day(e,{width:"narrow",context:"formatting"});case"eeee":default:return s.day(e,{width:"wide",context:"formatting"})||s.day(e,{width:"abbreviated",context:"formatting"})||s.day(e,{width:"short",context:"formatting"})||s.day(e,{width:"narrow",context:"formatting"})}}},{key:"validate",value:function(e,t){return t>=0&&t<=6}},{key:"set",value:function(e,t,s,n){return(e=Kd(e,s,n)).setUTCHours(0,0,0,0),e}}]),s}(ed),Zd=function(e){Fc(s,e);var t=jc(s);function s(){var e;Hc(this,s);for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return zc(Oc(e=t.call.apply(t,[this].concat(a))),"priority",90),zc(Oc(e),"incompatibleTokens",["y","R","u","q","Q","M","L","I","d","D","E","i","e","t","T"]),e}return Kc(s,[{key:"parse",value:function(e,t,s,n){var a=function(e){var t=7*Math.floor((e-1)/7);return(e+n.weekStartsOn+6)%7+t};switch(t){case"c":case"cc":return Sd(Pd(t.length,e),a);case"co":return Sd(s.ordinalNumber(e,{unit:"day"}),a);case"ccc":return s.day(e,{width:"abbreviated",context:"standalone"})||s.day(e,{width:"short",context:"standalone"})||s.day(e,{width:"narrow",context:"standalone"});case"ccccc":return s.day(e,{width:"narrow",context:"standalone"});case"cccccc":return s.day(e,{width:"short",context:"standalone"})||s.day(e,{width:"narrow",context:"standalone"});case"cccc":default:return s.day(e,{width:"wide",context:"standalone"})||s.day(e,{width:"abbreviated",context:"standalone"})||s.day(e,{width:"short",context:"standalone"})||s.day(e,{width:"narrow",context:"standalone"})}}},{key:"validate",value:function(e,t){return t>=0&&t<=6}},{key:"set",value:function(e,t,s,n){return(e=Kd(e,s,n)).setUTCHours(0,0,0,0),e}}]),s}(ed);var Xd=function(e){Fc(s,e);var t=jc(s);function s(){var e;Hc(this,s);for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return zc(Oc(e=t.call.apply(t,[this].concat(a))),"priority",90),zc(Oc(e),"incompatibleTokens",["y","Y","u","q","Q","M","L","w","d","D","E","e","c","t","T"]),e}return Kc(s,[{key:"parse",value:function(e,t,s){var n=function(e){return 0===e?7:e};switch(t){case"i":case"ii":return Pd(t.length,e);case"io":return s.ordinalNumber(e,{unit:"day"});case"iii":return Sd(s.day(e,{width:"abbreviated",context:"formatting"})||s.day(e,{width:"short",context:"formatting"})||s.day(e,{width:"narrow",context:"formatting"}),n);case"iiiii":return Sd(s.day(e,{width:"narrow",context:"formatting"}),n);case"iiiiii":return Sd(s.day(e,{width:"short",context:"formatting"})||s.day(e,{width:"narrow",context:"formatting"}),n);case"iiii":default:return Sd(s.day(e,{width:"wide",context:"formatting"})||s.day(e,{width:"abbreviated",context:"formatting"})||s.day(e,{width:"short",context:"formatting"})||s.day(e,{width:"narrow",context:"formatting"}),n)}}},{key:"validate",value:function(e,t){return t>=1&&t<=7}},{key:"set",value:function(e,t,s){return(e=function(e,t){k(2,arguments);var s=S(t);s%7==0&&(s-=7);var n=1,a=A(e),i=a.getUTCDay(),o=s%7,r=(o+7)%7,l=(r<n?7:0)+s-i;return a.setUTCDate(a.getUTCDate()+l),a}(e,s)).setUTCHours(0,0,0,0),e}}]),s}(ed),eg=function(e){Fc(s,e);var t=jc(s);function s(){var e;Hc(this,s);for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return zc(Oc(e=t.call.apply(t,[this].concat(a))),"priority",80),zc(Oc(e),"incompatibleTokens",["b","B","H","k","t","T"]),e}return Kc(s,[{key:"parse",value:function(e,t,s){switch(t){case"a":case"aa":case"aaa":return s.dayPeriod(e,{width:"abbreviated",context:"formatting"})||s.dayPeriod(e,{width:"narrow",context:"formatting"});case"aaaaa":return s.dayPeriod(e,{width:"narrow",context:"formatting"});case"aaaa":default:return s.dayPeriod(e,{width:"wide",context:"formatting"})||s.dayPeriod(e,{width:"abbreviated",context:"formatting"})||s.dayPeriod(e,{width:"narrow",context:"formatting"})}}},{key:"set",value:function(e,t,s){return e.setUTCHours(Id(s),0,0,0),e}}]),s}(ed),tg=function(e){Fc(s,e);var t=jc(s);function s(){var e;Hc(this,s);for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return zc(Oc(e=t.call.apply(t,[this].concat(a))),"priority",80),zc(Oc(e),"incompatibleTokens",["a","B","H","k","t","T"]),e}return Kc(s,[{key:"parse",value:function(e,t,s){switch(t){case"b":case"bb":case"bbb":return s.dayPeriod(e,{width:"abbreviated",context:"formatting"})||s.dayPeriod(e,{width:"narrow",context:"formatting"});case"bbbbb":return s.dayPeriod(e,{width:"narrow",context:"formatting"});case"bbbb":default:return s.dayPeriod(e,{width:"wide",context:"formatting"})||s.dayPeriod(e,{width:"abbreviated",context:"formatting"})||s.dayPeriod(e,{width:"narrow",context:"formatting"})}}},{key:"set",value:function(e,t,s){return e.setUTCHours(Id(s),0,0,0),e}}]),s}(ed),sg=function(e){Fc(s,e);var t=jc(s);function s(){var e;Hc(this,s);for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return zc(Oc(e=t.call.apply(t,[this].concat(a))),"priority",80),zc(Oc(e),"incompatibleTokens",["a","b","t","T"]),e}return Kc(s,[{key:"parse",value:function(e,t,s){switch(t){case"B":case"BB":case"BBB":return s.dayPeriod(e,{width:"abbreviated",context:"formatting"})||s.dayPeriod(e,{width:"narrow",context:"formatting"});case"BBBBB":return s.dayPeriod(e,{width:"narrow",context:"formatting"});case"BBBB":default:return s.dayPeriod(e,{width:"wide",context:"formatting"})||s.dayPeriod(e,{width:"abbreviated",context:"formatting"})||s.dayPeriod(e,{width:"narrow",context:"formatting"})}}},{key:"set",value:function(e,t,s){return e.setUTCHours(Id(s),0,0,0),e}}]),s}(ed),ng=function(e){Fc(s,e);var t=jc(s);function s(){var e;Hc(this,s);for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return zc(Oc(e=t.call.apply(t,[this].concat(a))),"priority",70),zc(Oc(e),"incompatibleTokens",["H","K","k","t","T"]),e}return Kc(s,[{key:"parse",value:function(e,t,s){switch(t){case"h":return Ed(cd,e);case"ho":return s.ordinalNumber(e,{unit:"hour"});default:return Pd(t.length,e)}}},{key:"validate",value:function(e,t){return t>=1&&t<=12}},{key:"set",value:function(e,t,s){var n=e.getUTCHours()>=12;return n&&s<12?e.setUTCHours(s+12,0,0,0):n||12!==s?e.setUTCHours(s,0,0,0):e.setUTCHours(0,0,0,0),e}}]),s}(ed),ag=function(e){Fc(s,e);var t=jc(s);function s(){var e;Hc(this,s);for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return zc(Oc(e=t.call.apply(t,[this].concat(a))),"priority",70),zc(Oc(e),"incompatibleTokens",["a","b","h","K","k","t","T"]),e}return Kc(s,[{key:"parse",value:function(e,t,s){switch(t){case"H":return Ed(od,e);case"Ho":return s.ordinalNumber(e,{unit:"hour"});default:return Pd(t.length,e)}}},{key:"validate",value:function(e,t){return t>=0&&t<=23}},{key:"set",value:function(e,t,s){return e.setUTCHours(s,0,0,0),e}}]),s}(ed),ig=function(e){Fc(s,e);var t=jc(s);function s(){var e;Hc(this,s);for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return zc(Oc(e=t.call.apply(t,[this].concat(a))),"priority",70),zc(Oc(e),"incompatibleTokens",["h","H","k","t","T"]),e}return Kc(s,[{key:"parse",value:function(e,t,s){switch(t){case"K":return Ed(ld,e);case"Ko":return s.ordinalNumber(e,{unit:"hour"});default:return Pd(t.length,e)}}},{key:"validate",value:function(e,t){return t>=0&&t<=11}},{key:"set",value:function(e,t,s){return e.getUTCHours()>=12&&s<12?e.setUTCHours(s+12,0,0,0):e.setUTCHours(s,0,0,0),e}}]),s}(ed),og=function(e){Fc(s,e);var t=jc(s);function s(){var e;Hc(this,s);for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return zc(Oc(e=t.call.apply(t,[this].concat(a))),"priority",70),zc(Oc(e),"incompatibleTokens",["a","b","h","H","K","t","T"]),e}return Kc(s,[{key:"parse",value:function(e,t,s){switch(t){case"k":return Ed(rd,e);case"ko":return s.ordinalNumber(e,{unit:"hour"});default:return Pd(t.length,e)}}},{key:"validate",value:function(e,t){return t>=1&&t<=24}},{key:"set",value:function(e,t,s){var n=s<=24?s%24:s;return e.setUTCHours(n,0,0,0),e}}]),s}(ed),rg=function(e){Fc(s,e);var t=jc(s);function s(){var e;Hc(this,s);for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return zc(Oc(e=t.call.apply(t,[this].concat(a))),"priority",60),zc(Oc(e),"incompatibleTokens",["t","T"]),e}return Kc(s,[{key:"parse",value:function(e,t,s){switch(t){case"m":return Ed(dd,e);case"mo":return s.ordinalNumber(e,{unit:"minute"});default:return Pd(t.length,e)}}},{key:"validate",value:function(e,t){return t>=0&&t<=59}},{key:"set",value:function(e,t,s){return e.setUTCMinutes(s,0,0),e}}]),s}(ed),lg=function(e){Fc(s,e);var t=jc(s);function s(){var e;Hc(this,s);for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return zc(Oc(e=t.call.apply(t,[this].concat(a))),"priority",50),zc(Oc(e),"incompatibleTokens",["t","T"]),e}return Kc(s,[{key:"parse",value:function(e,t,s){switch(t){case"s":return Ed(gd,e);case"so":return s.ordinalNumber(e,{unit:"second"});default:return Pd(t.length,e)}}},{key:"validate",value:function(e,t){return t>=0&&t<=59}},{key:"set",value:function(e,t,s){return e.setUTCSeconds(s,0),e}}]),s}(ed),cg=function(e){Fc(s,e);var t=jc(s);function s(){var e;Hc(this,s);for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return zc(Oc(e=t.call.apply(t,[this].concat(a))),"priority",30),zc(Oc(e),"incompatibleTokens",["t","T"]),e}return Kc(s,[{key:"parse",value:function(e,t){return Sd(Pd(t.length,e),(function(e){return Math.floor(e*Math.pow(10,3-t.length))}))}},{key:"set",value:function(e,t,s){return e.setUTCMilliseconds(s),e}}]),s}(ed),dg=function(e){Fc(s,e);var t=jc(s);function s(){var e;Hc(this,s);for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return zc(Oc(e=t.call.apply(t,[this].concat(a))),"priority",10),zc(Oc(e),"incompatibleTokens",["t","T","x"]),e}return Kc(s,[{key:"parse",value:function(e,t){switch(t){case"X":return Td(_d,e);case"XX":return Td(kd,e);case"XXXX":return Td(xd,e);case"XXXXX":return Td(Cd,e);case"XXX":default:return Td(Ad,e)}}},{key:"set",value:function(e,t,s){return t.timestampIsSet?e:new Date(e.getTime()-s)}}]),s}(ed),gg=function(e){Fc(s,e);var t=jc(s);function s(){var e;Hc(this,s);for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return zc(Oc(e=t.call.apply(t,[this].concat(a))),"priority",10),zc(Oc(e),"incompatibleTokens",["t","T","X"]),e}return Kc(s,[{key:"parse",value:function(e,t){switch(t){case"x":return Td(_d,e);case"xx":return Td(kd,e);case"xxxx":return Td(xd,e);case"xxxxx":return Td(Cd,e);case"xxx":default:return Td(Ad,e)}}},{key:"set",value:function(e,t,s){return t.timestampIsSet?e:new Date(e.getTime()-s)}}]),s}(ed),ug=function(e){Fc(s,e);var t=jc(s);function s(){var e;Hc(this,s);for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return zc(Oc(e=t.call.apply(t,[this].concat(a))),"priority",40),zc(Oc(e),"incompatibleTokens","*"),e}return Kc(s,[{key:"parse",value:function(e){return Nd(e)}},{key:"set",value:function(e,t,s){return[new Date(1e3*s),{timestampIsSet:!0}]}}]),s}(ed),mg=function(e){Fc(s,e);var t=jc(s);function s(){var e;Hc(this,s);for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return zc(Oc(e=t.call.apply(t,[this].concat(a))),"priority",20),zc(Oc(e),"incompatibleTokens","*"),e}return Kc(s,[{key:"parse",value:function(e){return Nd(e)}},{key:"set",value:function(e,t,s){return[new Date(s),{timestampIsSet:!0}]}}]),s}(ed),hg={G:new td,y:new Gd,Y:new qd,R:new Rd,u:new Md,Q:new Od,q:new Ud,M:new Fd,L:new $d,w:new Wd,I:new Vd,d:new Jd,D:new Yd,E:new zd,e:new Qd,c:new Zd,i:new Xd,a:new eg,b:new tg,B:new sg,h:new ng,H:new ag,K:new ig,k:new og,m:new rg,s:new lg,S:new cg,X:new dg,x:new gg,t:new ug,T:new mg},pg=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,fg=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,bg=/^'([^]*?)'?$/,wg=/''/g,yg=/\S/,vg=/[a-zA-Z]/;function _g(e,t,s,n){var a,i,o,r,l,c,d,g,u,m,h,p,f,b,w,y,v,x;k(3,arguments);var C=String(e),E=String(t),N=D(),P=null!==(a=null!==(i=null==n?void 0:n.locale)&&void 0!==i?i:N.locale)&&void 0!==a?a:be;if(!P.match)throw new RangeError("locale must contain match property");var L=S(null!==(o=null!==(r=null!==(l=null!==(c=null==n?void 0:n.firstWeekContainsDate)&&void 0!==c?c:null==n||null===(d=n.locale)||void 0===d||null===(g=d.options)||void 0===g?void 0:g.firstWeekContainsDate)&&void 0!==l?l:N.firstWeekContainsDate)&&void 0!==r?r:null===(u=N.locale)||void 0===u||null===(m=u.options)||void 0===m?void 0:m.firstWeekContainsDate)&&void 0!==o?o:1);if(!(L>=1&&L<=7))throw new RangeError("firstWeekContainsDate must be between 1 and 7 inclusively");var I=S(null!==(h=null!==(p=null!==(f=null!==(b=null==n?void 0:n.weekStartsOn)&&void 0!==b?b:null==n||null===(w=n.locale)||void 0===w||null===(y=w.options)||void 0===y?void 0:y.weekStartsOn)&&void 0!==f?f:N.weekStartsOn)&&void 0!==p?p:null===(v=N.locale)||void 0===v||null===(x=v.options)||void 0===x?void 0:x.weekStartsOn)&&void 0!==h?h:0);if(!(I>=0&&I<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");if(""===E)return""===C?A(s):new Date(NaN);var B,G={firstWeekContainsDate:L,weekStartsOn:I,locale:P},q=[new Xc],R=E.match(fg).map((function(e){var t=e[0];return t in ee?(0,ee[t])(e,P.formatLong):e})).join("").match(pg),M=[],O=Mc(R);try{var U=function(){var t=B.value;null!=n&&n.useAdditionalWeekYearTokens||!ie(t)||oe(t,E,e),null!=n&&n.useAdditionalDayOfYearTokens||!ae(t)||oe(t,E,e);var s=t[0],a=hg[s];if(a){var i=a.incompatibleTokens;if(Array.isArray(i)){var o=M.find((function(e){return i.includes(e.token)||e.token===s}));if(o)throw new RangeError("The format string mustn't contain `".concat(o.fullToken,"` and `").concat(t,"` at the same time"))}else if("*"===a.incompatibleTokens&&M.length>0)throw new RangeError("The format string mustn't contain `".concat(t,"` and any other token at the same time"));M.push({token:s,fullToken:t});var r=a.run(C,t,P.match,G);if(!r)return{v:new Date(NaN)};q.push(r.setter),C=r.rest}else{if(s.match(vg))throw new RangeError("Format string contains an unescaped latin alphabet character `"+s+"`");if("''"===t?t="'":"'"===s&&(t=kg(t)),0!==C.indexOf(t))return{v:new Date(NaN)};C=C.slice(t.length)}};for(O.s();!(B=O.n()).done;){var F=U();if("object"===_(F))return F.v}}catch(e){O.e(e)}finally{O.f()}if(C.length>0&&yg.test(C))return new Date(NaN);var $=q.map((function(e){return e.priority})).sort((function(e,t){return t-e})).filter((function(e,t,s){return s.indexOf(e)===t})).map((function(e){return q.filter((function(t){return t.priority===e})).sort((function(e,t){return t.subPriority-e.subPriority}))})).map((function(e){return e[0]})),W=A(s);if(isNaN(W.getTime()))return new Date(NaN);var V,j=T(W,te(W)),H={},J=Mc($);try{for(J.s();!(V=J.n()).done;){var Y=V.value;if(!Y.validate(j,G))return new Date(NaN);var K=Y.set(j,H,G);Array.isArray(K)?(j=K[0],xt(H,K[1])):j=K}}catch(e){J.e(e)}finally{J.f()}return j}function kg(e){return e.match(bg)[1].replace(wg,"'")}const xg=hs.createElements.bind(hs),Ag=hs.getFeatureTooltip.bind(hs),Cg=hs.sortContent.bind(hs),Sg=/\b(?:\d{4}[-/]\d{1,2}[-/]\d{1,2}|\d{1,2}[-/]\d{1,2}[-/]\d{2,4}|(?:Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)[a-z]*\s+\d{1,2},?\s*\d{0,4}|\d{1,2}\s+(?:Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)[a-z]*,?\s*\d{0,4}|(?:Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)[a-z]*\s+\d{4}|\d{4}\s+(?:Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)[a-z]*\s+\d{1,2}|(?:Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)[a-z]*'\d{2})\b/i;const Eg=new class extends gt{constructor(){super(),this.info={description:()=>Se.element("ul",null,Se.element("li",null,"Adds a button (",Se.element("i",{className:"fa fa-sort"})," if the table is sorted by the default order, ",Se.element("i",{className:"fa fa-sort-asc"})," if it is sorted by ascending order and"," ",Se.element("i",{className:"fa fa-sort-desc"})," if it is sorted by descending order) to the heading of each table's column (in any page) that allows you to sort the table by the values of the column.")),id:"ts",name:"Table Sorter",sg:!0,st:!0,type:"general",featureMap:{endless:this.ts_getTables.bind(this)}}}ts_getTables(e,t,s,n){const a=e.querySelectorAll(`${n?`.esgst-es-page-${n} .table, .esgst-es-page-${n}.table`:".table"}, ${n?`.esgst-es-page-${n} table, .esgst-es-page-${n}table`:"table"}`);for(let e=0,t=a.length;e<t;++e)this.ts_setTable(a[e]);n||d.get("us")||this.ts_sortTables()}ts_sortTables(){let e,t;for(e=this.esgst.tsTables.length-1;e>-1;--e)t=this.esgst.tsTables[e],t.columnName&&Cg(this.ts_getArray(t.columnName,t.columnIndex,t.table),`${t.key}_${t.name}`)}ts_setTable(e){let t,s,n,a,i;if(a=e.querySelector(".table__heading, .header, thead"),a){i={columnName:"",key:"sortIndex",name:"asc",outerWrap:e,table:e},this.esgst.tsTables.push(i),n=a.querySelectorAll(".table__column--width-fill, .table__column--width-medium, .table__column--width-small, .column_flex, .column_medium, .column_small, th");for(let a=0,o=n.length;a<o;++a){let o=n[a];s=o.textContent.trim(),s.match(/^(Keys|Key|Not\sReceived|Remove)$/)||this.esgst.wonPath&&s.match(/^Received$/)||o.getElementsByClassName("esgst-ts-button")[0]||(t=xg(o,"beforeend",[{attributes:{class:"esgst-ts-button esgst-clickable"},type:"span"}]),this.ts_addDescButton(t,s,a,e,i))}}}ts_addAscButton(e,t,s,n,a){xg(e,"atinner",[{attributes:{class:"fa fa-sort-desc",title:""+Ag("ts","Currently sorted descending. Click to sort ascending.")},type:"i"}]),e.firstElementChild.addEventListener("click",this.ts_sortTable.bind(this,e,t,s,"asc",n,a))}ts_addDescButton(e,t,s,n,a){xg(e,"atinner",[{attributes:{class:"fa fa-sort",title:""+Ag("ts","Currently sorted by default. Click to sort descending.")},type:"i"}]),e.firstElementChild.addEventListener("click",this.ts_sortTable.bind(this,e,t,s,"desc",n,a))}ts_addDefButton(e,t,s,n,a){xg(e,"atinner",[{attributes:{class:"fa fa-sort-asc",title:""+Ag("ts","Currently sorted ascending. Click to sort by default.")},type:"i"}]),e.firstElementChild.addEventListener("click",this.ts_sortTable.bind(this,e,t,s,"def",n,a))}ts_sortTable(e,t,s,n,a,i){i.columnName=t,i.columnIndex=s,i.key="def"===n?"sortIndex":"value",i.name=n,"desc"===n?(Cg(this.ts_getArray(t,s,a),"value_"+n),this.ts_addAscButton(e,t,s,a,i)):"asc"===n?(Cg(this.ts_getArray(t,s,a),"value_"+n),this.ts_addDefButton(e,t,s,a,i)):(Cg(this.ts_getArray(t,s,a),"sortIndex_asc"),this.ts_addDescButton(e,t,s,a,i))}ts_handleDate(e){if("string"!=typeof e)return null;const t=e.replace(/(\d+)(st|nd|rd|th)|,/gi,"$1").replace(/\s+/g," ").trim(),s=["MMM d yyyy","MMMM d yyyy","d MMM yyyy","d MMMM yyyy","yyyy MMM d","yyyy MMMM d","yyyy-MM-dd","MM/dd/yyyy","dd/MM/yyyy","MMM d","d MMM","MMMM d","d MMMM","MMMM yyyy","MMM yyyy"];for(const e of s){const s=_g(t,e,new Date);if(C(s))return s.getFullYear()||s.setFullYear((new Date).getFullYear()),s}return null}ts_getDateSubstring(e,t,s=.7){const n=e.match(t);if(!n)return null;const a=n[0];return a.length/e.length>=s?a:null}ts_parseMiscValue(e,t){let s=e.match(/^[+-]?\d{1,3}(,\d{3})*(?:\.\d+)?(?!\w)|^[+-]?\d+(\.\d+)?(?!\w)/);if(s)return t.value=parseFloat(s[0].replace(/,/g,"")),isNaN(t.value)&&(t.value=0),!0;if(/^(from\s*)?[-+]?[A-Z]{0,3}[$€£¥₹]\d[\d,\.]*$/i.test(e)){let s=e.replace(/^from\s*/i,"").replace(/^[+]/,"").replace(/[A-Z]{0,3}[$€£¥₹]/i,"").replace(/,/g,"").trim();return t.value=parseFloat(s),isNaN(t.value)&&(t.value=0),!0}return t.value=e.replace(/[^\x00-\x7F]/gu,"").trimStart()||e,!1}ts_getArray(e,t,s){let n,a,i,o,r,l,c,d;n=[],c=s.querySelectorAll(".table__row-outer-wrap, .row_outer_wrap, tbody tr");let g=!1;const u=Date.now();for(o=0,r=c.length;o<r;++o){if(l=c[o],a=l.querySelectorAll(".table__column--width-fill, .table__column--width-medium, .table__column--width-small, .column_flex, .column_medium, .column_small, td")[t],d=a&&a.textContent.trim(),i={outerWrap:l,sortIndex:0,value:void 0},l.hasAttribute("data-sort-index")?i.sortIndex=parseInt(l.getAttribute("data-sort-index")):(i.sortIndex=o,l.setAttribute("data-sort-index",o)),d&&d.length>0||"Trending"===e)if(a.hasAttribute("data-sort-value"))i.value=parseFloat(a.getAttribute("data-sort-value"));else switch(e){case"Trending":i.value=a.getElementsByClassName("fa-caret-up").length-a.getElementsByClassName("fa-caret-down").length;break;case"Added":case"Creation Date":case"Date Entered":case"First Giveaway":case"Last Giveaway":case"Last Online":case"Last Post":case"Last Update":try{i.value=d.match(/Online|Open/)?u:1e3*parseInt(a.querySelector("[data-timestamp]").getAttribute("data-timestamp"))}catch(e){i.value=0}break;case"Game":case"Giveaway":case"Group":case"Status":case"Summary":case"Type":case"User":case"Winner(s)":i.value=d;break;default:if(d&&"―"!==d&&"-"!==d){const e=this.ts_getDateSubstring(d,Sg,.7);if(e){const t=this.ts_handleDate(e);g=t?(i.value=t.getTime(),!0):this.ts_parseMiscValue(d,i)}else g=this.ts_parseMiscValue(d,i)}else i.value=""}else i.value=0;n.push(i)}if(g)for(let e=n.length-1;e>-1;e--){let t=n[e];"string"==typeof t.value&&(t.value=0)}return n}};const Tg=new class extends gt{constructor(){super(),this.info={description:()=>Se.element("ul",null,Se.element("li",null,"Opens any link in the page in the same tab.")),id:"sto",name:"Same Tab Opener",sg:!0,st:!0,type:"general",featureMap:{endless:this.sto_setLinks.bind(this)}}}sto_setLinks(e,t,s,n){const a=e.querySelectorAll(""+(n?`.esgst-es-page-${n} [target="_blank"], .esgst-es-page-${n}[target="_blank"]`:'[target="_blank"]'));for(let e=0,t=a.length;e<t;++e)a[e].removeAttribute("target")}};const Ng=new class extends gt{constructor(){super(),this.info={description:()=>Se.element("ul",null,Se.element("li",null,"Adds a button (",Se.element("i",{className:"fa fa-caret-down"}),") next to a user's username (in their"," ",Se.element("a",{href:"https://www.steamgifts.com/user/cg"},"profile")," page) that allows you to view their username history ever since they started being tracked."),Se.element("li",null,"It is impossible to keep track of every SteamGifts user due to a database capacity limitation (and that would also be impractical), so instead the feature keeps track of a limited number of users (currently around 9000). A user starts being tracked when anyone using ESGST clicks on the button to view their username history."),Se.element("li",null,"Username changes are detected in two instances:"),Se.element("ul",null,Se.element("li",null,"Every 30 days the usernames of all of the users in the database are updated and if any changes are detected they are added to the history."),Se.element("li",null,"Every time anyone using ESGST clicks on the button to view the username history of a user the username of that user is updated and if a change is detected it is added to the history.")),Se.element("li",null,"The database is kept in a server, which means that everyone using ESGST interacts with the same database and views the same history."),Se.element("li",null,"Adds a button (",Se.element("i",{className:"fa fa-user"})," ",Se.element("i",{className:"fa fa-history"}),") to the page heading of this menu that allows you to view all of the recent username changes detected.")),id:"uh",name:"Username History",sg:!0,type:"users",featureMap:{profile:this.addButton.bind(this)}}}addButton(e){let t;Se.insert(e.heading,"beforeend",Se.element("div",{className:"esgst-uh-container",ref:e=>t=e},Se.element("a",{className:"esgst-uh-button",title:c.common.getFeatureTooltip("uh","View username history")},Se.element("i",{className:"fa fa-caret-down"})),Se.element("div",{className:"esgst-uh-box esgst-hidden"},Se.element("div",{className:"esgst-uh-title"},Se.element("span",null,"Username History")),Se.element("ul",{className:"esgst-uh-list"}))));const s=t.querySelector(".esgst-uh-button"),n=t.querySelector(".esgst-uh-box"),a=n.querySelector(".esgst-uh-list");s.addEventListener("click",this.toggleBox.bind(this,e,n,a)),c.esgst.documentEvents.click.add(this.closeBox.bind(this,t,n))}async toggleBox(e,t,s){if(t.classList.toggle("esgst-hidden"),s.innerHTML)return;if(await ut.contains([["server"]])){Se.insert(s,"atinner",Se.element("div",null,Se.element("i",{className:"fa fa-circle-o-notch fa-spin"}),Se.element("span",null,"Loading username history...")));try{const t=await this.getUserNames(e.steamId,e.username);Se.insert(s,"atinner",Se.element("fragment",null,t.result.usernames.map(e=>Se.element("li",null,e))))}catch(e){Logger.warning(e),Se.insert(s,"atinner",Se.element("div",null,Se.element("i",{className:"fa fa-times"}),Se.element("span",null,"Failed to load history. Please try again later.")))}}else Se.insert(s,"atinner",Se.element("div",null,Se.element("i",{className:"fa fa-times"}),Se.element("span",null,"No permissions granted for https://esgst.rafaelgomes.xyz. Please grant the permissions on the settings menu so that the data can be retrieved from the ESGST API.")))}closeBox(e,t,s){t.classList.contains("esgst-hidden")||e.contains(s.target)||t.classList.add("esgst-hidden")}async getUserNames(e,t){return(await Ne.get(`https://esgst.rafaelgomes.xyz/api/user/+${e}/uh?username=${t}`)).json}},Pg=hs.createElements.bind(hs),Lg=hs.getFeatureTooltip.bind(hs),Ig=hs.getValue.bind(hs),Bg=hs.removeDuplicateNotes.bind(hs),Dg=hs.saveUser.bind(hs);const Gg=new class extends gt{constructor(){super(),this.info={description:()=>Se.element("ul",null,Se.element("li",null,"Adds a button (",Se.element("i",{className:"fa fa-sticky-note"})," if there are notes saved and"," ",Se.element("i",{className:"fa fa-sticky-note-o"})," if there are not) next to a user's username (in their ",Se.element("a",{href:"https://www.steamgifts.com/user/cg"},"profile")," page) that allows you to save notes for them (only visible to you)."),Se.element("li",null,"You can press Ctrl + Enter to save the notes."),Se.element("li",null,"This feature is recommended for cases where you want to associate a long text with a user, since the notes are not displayed in the page.For a short text, check"," ",Se.element("span",{"data-esgst-feature-id":"ut"}),".")),features:{un_p:{name:"Pop up when whitelisting/blacklisting a user.",sg:!0}},id:"un",name:"User Notes",sg:!0,st:!0,type:"users",featureMap:{profile:this.un_add.bind(this)}}}un_add(e,t){let s,n,a;c.esgst.sg?(n="beforeend",d.get("un_p")&&(a=e.steamButtonContainer.getElementsByClassName("sidebar__shortcut__whitelist")[0],a&&a.addEventListener("click",this.un_open.bind(this,e)),s=e.steamButtonContainer.getElementsByClassName("sidebar__shortcut__blacklist")[0],s&&s.addEventListener("click",this.un_open.bind(this,e)))):n="afterbegin",e.unButton=Pg(e.heading,n,[{attributes:{class:"esgst-un-button",title:Lg("un","Edit user notes")},type:"a",children:[{attributes:{class:"fa"},type:"i"}]}]),e.unIcon=e.unButton.firstElementChild,t&&t.notes?e.unIcon.classList.add("fa-sticky-note"):e.unIcon.classList.add("fa-sticky-note-o"),e.unButton.addEventListener("click",this.un_open.bind(this,e))}un_open(e){e.unPopup=new lt({addScrollable:!0,icon:"fa-sticky-note",isTemp:!0,title:Se.element("fragment",null,"Edit user notes for ",Se.element("span",null,e.name),":")}),e.unTextArea=Pg(e.unPopup.scrollable,"beforeend",[{type:"textarea"}]),d.get("cfh")&&c.esgst.modules.commentsCommentFormattingHelper.cfh_addPanel(e.unTextArea);const t=tt.create([{template:"success",name:"Save",onClick:this.un_save.bind(this,e)},{template:"loading",isDisabled:!0,name:"Saving..."}]).insert(e.unPopup.description,"beforeend");e.unTextArea.addEventListener("keydown",e=>{e.ctrlKey&&"Enter"===e.key&&t.onClick()}),e.unPopup.open(this.un_get.bind(this,e))}async un_save(e){let t=Bg(e.unTextArea.value.trim()),s={steamId:e.steamId,id:e.id,username:e.username,values:{notes:t}};t?(e.unIcon.classList.remove("fa-sticky-note-o"),e.unIcon.classList.add("fa-sticky-note")):(e.unIcon.classList.remove("fa-sticky-note"),e.unIcon.classList.add("fa-sticky-note-o")),await Dg(null,null,s),e.unPopup.close()}async un_get(e){e.unTextArea.focus();let t=JSON.parse(Ig("users")).users[e.steamId];if(t){let s=t.notes;s&&(e.unTextArea.value=s)}}},qg=hs.createElements.bind(hs),Rg=hs.getFeatureTooltip.bind(hs),Mg=hs.saveUser.bind(hs);const Og=new class extends ga{constructor(){super("uf"),this.info={description:()=>Se.element("ul",null,Se.element("li",null,"Adds a button (",Se.element("i",{className:"fa fa-eye-slash"})," if the user is being filtered and"," ",Se.element("i",{className:"fa fa-eye"})," if they are not) next to a user's username (in their"," ",Se.element("a",{href:"https://www.steamgifts.com/user/cg"},"profile")," page) that allows you to hide their discussions, giveaways and posts (each one can be hidden separately)."),Se.element("li",null,"Adds a button (",Se.element("i",{className:"fa fa-user"})," ",Se.element("i",{className:"fa fa-eye-slash"}),") to the page heading of this menu that allows you to view all of the users that have been filtered.")),features:{uf_d:{name:"Automatically hide discussions from blacklisted users.",sg:!0},uf_g:{name:"Automatically hide giveaways from blacklisted users.",sg:!0},uf_dp:{name:"Automatically hide discussion posts from blacklisted users.",sg:!0},uf_gp:{name:"Automatically hide giveaway posts from blacklisted users.",sg:!0},uf_s_s:{name:"Show switch to temporarily hide / unhide users filtered by the filters in the main page heading, along with a counter.",sg:!0}},id:"uf",name:"User Filters",sg:!0,type:"users",featureMap:{profile:this.uf_add.bind(this),comment:this.filterComments.bind(this),discussion:this.filterDiscussions.bind(this),giveaway:this.filterGiveaways.bind(this)}}}init(){d.get("uf_s_s")&&this.addSingleButton("fa-user")}uf_add(e,t){e.username!==d.get("username")&&(e.ufButton=qg(e.heading,"beforeend",[{attributes:{class:"esgst-uf-button",title:Rg("uf","Edit user filters")},type:"a",children:[{attributes:{class:"fa"},type:"i"}]}]),e.ufIcon=e.ufButton.firstElementChild,t?(e.ufValues=this.fixData(t.uf),e.ufValues&&(e.ufValues.giveaways||e.ufValues.discussions||e.ufValues.discussionPosts||e.ufValues.giveawayPosts)?e.ufIcon.classList.add("fa-eye-slash"):(e.ufIcon.classList.add("fa-eye"),e.ufValues={giveaways:!1,discussions:!1,giveawayPosts:!1,discussionPosts:!1})):(e.ufIcon.classList.add("fa-eye"),e.ufValues={giveaways:!1,discussions:!1,giveawayPosts:!1,discussionPosts:!1}),e.ufButton.addEventListener("click",this.uf_open.bind(this,e)))}uf_open(e){e.ufPopup=new lt({addScrollable:!0,icon:"fa-eye",isTemp:!0,title:Se.element("fragment",null,"Apply user filters for ",Se.element("span",null,e.name),":")}),e.ufOptions=qg(e.ufPopup.description,"beforeend",[{type:"div"}]),e.ufGiveawaysOption=new vt(e.ufOptions,null,!1,"Filter this user's giveaways.",!1,!1,"Hides the user's giveaways from the main pages.",e.ufValues.giveaways),e.ufDiscussionsOption=new vt(e.ufOptions,null,!1,"Filter this user's discussions.",!1,!1,"Hides the user's discussions from the main pages.",e.ufValues.discussions),e.ufGiveawayPostsOption=new vt(e.ufOptions,null,!1,"Filter this user's giveaway posts.",!1,!1,"Hides the user's posts made on giveaways.",e.ufValues.giveawayPosts),e.ufDiscussionPostsOption=new vt(e.ufOptions,null,!1,"Filter this user's discussion posts.",!1,!1,"Hides the user's posts made on discussions.",e.ufValues.discussionPosts);const t=tt.create([{template:"success",name:"Save Settings",onClick:this.uf_save.bind(this,e,!1)},{template:"loading",isDisabled:!0,name:"Saving..."}]).insert(e.ufPopup.description,"beforeend"),s=tt.create([{color:"green",icons:["fa-rotate-left"],name:"Reset Settings",onClick:this.uf_save.bind(this,e,!0)},{template:"loading",isDisabled:!0,name:"Resetting..."}]).insert(e.ufPopup.description,"beforeend");t.addConflict(s),s.addConflict(t),e.ufPopup.open()}async uf_save(e,t){let s;t?(e.ufGiveawaysOption.input.checked=!1,e.ufDiscussionsOption.input.checked=!1,e.ufGiveawayPostsOption.input.checked=!1,e.ufDiscussionPostsOption.input.checked=!1,e.ufValues={giveaways:!1,discussions:!1,giveawayPosts:!1,discussionPosts:!1}):e.ufValues={giveaways:e.ufGiveawaysOption.input.checked,discussions:e.ufDiscussionsOption.input.checked,giveawayPosts:e.ufGiveawayPostsOption.input.checked,discussionPosts:e.ufDiscussionPostsOption.input.checked},s={steamId:e.steamId,id:e.id,username:e.username,values:{uf:e.ufValues}},e.ufValues&&(e.ufValues.giveaways||e.ufValues.discussions||e.ufValues.giveawayPosts||e.ufValues.discussionPosts)?(e.ufIcon.classList.remove("fa-eye"),e.ufIcon.classList.add("fa-eye-slash")):(e.ufIcon.classList.remove("fa-eye-slash"),e.ufIcon.classList.add("fa-eye")),await Mg(null,null,s),e.ufPopup.close()}fixData(e){if(e)return l.isSet(e.posts)&&(e.giveawayPosts=e.posts,e.discussionPosts=e.posts,delete e.posts),e}async filterDiscussions(e){for(const t of e){const e=await c.common.getUser(c.esgst.users,{username:t.author});if(!e)continue;const s=this.fixData(e.uf);(d.get("uf_d")&&e.blacklisted&&!s||s&&s.discussions)&&(t.outerWrap.classList.add("esgst-hidden"),t.outerWrap.setAttribute("data-esgst-not-filterable","uf"),d.get("uf_s_s")&&this.updateSingleCounter())}}async filterGiveaways(e,t){if(c.esgst.giveawaysPath&&t)for(const t of e){const e=await c.common.getUser(c.esgst.users,{username:t.creator});if(!e)continue;const s=this.fixData(e.uf);(d.get("uf_g")&&e.blacklisted&&!s||s&&s.giveaways)&&(t.outerWrap.classList.add("esgst-hidden"),t.outerWrap.setAttribute("data-esgst-not-filterable","uf"),d.get("uf_s_s")&&this.updateSingleCounter())}}async filterComments(e,t){for(const s of e){const e=await c.common.getUser(c.esgst.users,{username:s.author});if(!e)continue;const n=this.fixData(e.uf);if(("giveaways"===s.type&&d.get("uf_gp")||"giveaways"!==s.type&&d.get("uf_dp"))&&e.blacklisted&&!n||n&&("giveaways"===s.type&&n.giveawayPosts||"giveaways"!==s.type&&n.discussionPosts)){let e;if(e=s.comment.nextElementSibling?s.comment.nextElementSibling.querySelectorAll(":not(.comment--submit) > .comment__parent, .comment__child, .comment_inner").length:0,s.comment.parentElement.classList.add("esgst-hidden"),s.comment.parentElement.setAttribute("data-esgst-not-filterable","uf"),d.get("uf_s_s")&&this.updateSingleCounter(e+1),!t||c.common.isCurrentPath("Messages")){const e=s.comment.closest(".comments");e.querySelectorAll(".comment:not([data-esgst-not-filterable])").length||(e.previousElementSibling.classList.add("esgst-hidden"),e.previousElementSibling.setAttribute("data-esgst-not-filterable","uf"),e.classList.add("esgst-hidden"),e.setAttribute("data-esgst-not-filterable","uf"))}}}}},Ug=hs.createElements.bind(hs),Fg=hs.endless_load.bind(hs),$g=hs.getFeatureTooltip.bind(hs);const Wg=new class extends gt{constructor(){super(),this.info={description:()=>Se.element("ul",null,Se.element("li",null,"Adds a button (",Se.element("i",{className:"fa fa-users"}),") next to a user's username (in their"," ",Se.element("a",{href:"https://www.steamgifts.com/user/cg"},"profile")," page) that allows you to check which groups you are both members of.")),id:"sgc",name:"Shared Group Checker",sg:!0,type:"users",featureMap:{profile:this.sgc_add.bind(this)}}}sgc_add(e){e.username!==d.get("username")&&(e.sgcButton=Ug(e.heading,"beforeend",[{attributes:{class:"esgst-sgc-button",title:$g("sgc","Check shared groups")},type:"a",children:[{attributes:{class:"fa fa-users"},type:"i"}]}]),e.sgcButton.addEventListener("click",this.sgc_open.bind(this,e)))}async sgc_open(e){if(e.sgcPopup)e.sgcPopup.open();else{if(!await ut.contains([["steamCommunity"]]))return;e.sgcPopup=new lt({addScrollable:!0,icon:"fa-users",title:"Shared Groups"}),e.sgcProgress=Ug(e.sgcPopup.description,"beforeend",[{type:"div",children:[{attributes:{class:"fa fa-circle-o-notch fa-spin"},type:"i"},{text:"Checking shared groups...",type:"span"}]}]),e.sgcResults=Ug(e.sgcPopup.scrollable,"beforeend",[{attributes:{class:"esgst-sgc-results esgst-glwc-results esgst-text-left"},type:"div",children:[{type:"div",children:[{attributes:{class:"esgst-glwc-heading"},text:"Public",type:"div"},{attributes:{class:"table esgst-hidden"},type:"div",children:[{attributes:{class:"table__heading"},type:"div",children:[{attributes:{class:"table__column--width-fill"},text:"Group",type:"div"}]},{attributes:{class:"table__rows"},type:"div"}]}]},{type:"div",children:[{attributes:{class:"esgst-glwc-heading"},text:"Private",type:"div"},{attributes:{class:"table esgst-hidden"},type:"div",children:[{attributes:{class:"table__heading"},type:"div",children:[{attributes:{class:"table__column--width-fill"},text:"Group",type:"div"}]},{attributes:{class:"table__rows"},type:"div"}]}]}]}]),e.sgcPublic=e.sgcResults.firstElementChild.lastElementChild,e.sgcPublicResults=e.sgcPublic.lastElementChild,e.sgcPrivate=e.sgcResults.lastElementChild.lastElementChild,e.sgcPrivateResults=e.sgcPrivate.lastElementChild,e.sgcPopup.open(),this.sgc_load(e)}}async sgc_load(e){const t=[],s=[];let n=await Ne.get(`http://steamcommunity.com/profiles/${e.steamId}/groups/common`),a=!0;n.html.getElementById("groups_list")||(n=await Ne.get(`http://steamcommunity.com/profiles/${e.steamId}/groups`),a=!1);const i=n.html.getElementsByClassName("group_block");for(const e of i){const n=e.getElementsByClassName("linkTitle")[0].textContent,i=e.getElementsByClassName("avatarMedium")[0].firstElementChild.firstElementChild.getAttribute("src"),o=e.querySelector(".steamLink").getAttribute("href").match(/\d+/)[0];let r;for(r=c.esgst.groups.length-1;r>-1&&c.esgst.groups[r].steamId!==o;r--);(a||!(r<0)&&c.esgst.groups[r].member)&&(e.getElementsByClassName("pubGroup")[0]?t:s).push({name:n,html:[{attributes:{class:"table__row-outer-wrap"},type:"div",children:[{attributes:{class:"table__row-inner-wrap"},type:"div",children:[{type:"div",children:[{attributes:{class:"table_image_avatar",href:"/go/group/"+o,style:`background-image:url(${i})`},type:"a"}]},{attributes:{class:"table__column--width-fill"},type:"div",children:[{attributes:{class:"table__column__heading",href:"/go/group/"+o},type:"a"}]}]}]}]})}const o=t.length,r=s.length;o||r?(o>0?(l.sortArray(t,!1,"name").map(t=>{Ug(e.sgcPublicResults,"beforeend",t.html).getElementsByClassName("table__column__heading")[0].textContent=t.name}),e.sgcPublic.classList.remove("esgst-hidden")):Ug(e.sgcPublic,"atouter",[{text:"No shared public groups found.",type:"div"}]),r>0?(l.sortArray(s,!1,"name").map(t=>{Ug(e.sgcPrivateResults,"beforeend",t.html).getElementsByClassName("table__column__heading")[0].textContent=t.name}),e.sgcPrivate.classList.remove("esgst-hidden")):Ug(e.sgcPrivate,"atouter",[{text:"No shared private groups found.",type:"div"}]),e.sgcProgress.remove(),e.sgcProgress=null):Ug(e.sgcProgress,"atinner",[{text:"No shared groups found.",type:"node"}]),Fg(e.sgcResults)}};const Vg=new class extends gt{constructor(){super(),this.info={description:()=>Se.element("ul",null,Se.element("li",null,"Allows you to add custom links next to a user's username in their profile page."),Se.element("li",null,"Can be used in other pages through ",Se.element("span",{"data-esgst-feature-id":"cl_ui"}),"."),Se.element("li",null,"Comes by default with 5 links to BLAEO, Playing Appreciated, Touhou Giveaways, AStats and SteamRep.")),id:"ul",name:"User Links",sg:!0,type:"users",featureMap:{profile:this.ul_add.bind(this)}}}ul_add(e){const t=[],s=/^(fa-.+?)($|\s)/,n=/^(https?:\/\/.+?)($|\s)/,a=/^(.+?)($|\s(fa-|https?:\/\/))/;for(const i of d.get("ul_links")){const o=[];let r=i.label;for(;r;){const e=r.match(s);if(e){r=r.replace(s,""),o.push(Se.element("i",{className:"fa "+e[1]}));continue}const t=r.match(n);if(t){r=r.replace(n,""),o.push(Se.element("img",{height:16,src:t[1],style:"vertical-align: middle;",width:16}));continue}const i=r.match(a);i&&(r=r.replace(a,"$3"),o.push(i[1]))}t.push(Se.element("a",{href:i.url.replace(/%username%/g,e.username).replace(/%steamid%/g,e.steamId),target:"_blank"},o))}Se.insert(e.heading,"beforeend",Se.element("fragment",null,t))}},jg=hs.createElements.bind(hs),Hg=hs.getFeatureTooltip.bind(hs);const Jg=new class extends gt{constructor(){super(),this.info={description:()=>Se.element("ul",null,Se.element("li",null,'Turns "Gifts Won" and "Gifts Sent" in a user\'s'," ",Se.element("a",{href:"https://www.steamgifts.com/user/cg"},"profile")," page into links that take you to their real won/sent CV pages on ",Se.element("a",{href:"https://www.sgtools.info/"},"SGTools"),".")),features:{rwscvl_r:{name:"Link SGTools' reverse pages (from newest to oldest).",sg:!0}},id:"rwscvl",name:"Real Won/Sent CV Link",sg:!0,type:"users",featureMap:{profile:this.rwscvl_add.bind(this)}}}rwscvl_add(e){let t,s;s="http://www.sgtools.info/won/"+e.username,t="http://www.sgtools.info/sent/"+e.username,d.get("rwscvl_r")&&(s+="/newestfirst",t+="/newestfirst"),jg(e.wonRowLeft,"atinner",[{attributes:{class:"esgst-rwscvl-link",href:s,target:"_blank",title:Hg("rwscvl")},text:"Gifts Won",type:"a"}]),jg(e.sentRowLeft,"atinner",[{attributes:{class:"esgst-rwscvl-link",href:t,target:"_blank",title:Hg("rwscvl")},text:"Gifts Sent",type:"a"}])}},Yg=hs.createElements.bind(hs),Kg=hs.endless_load.bind(hs),zg=hs.getFeatureTooltip.bind(hs),Qg=hs.getPlayerAchievements.bind(hs),Zg=hs.getUser.bind(hs),Xg=hs.getValue.bind(hs),eu=hs.lockAndSaveGiveaways.bind(hs),tu=hs.saveUser.bind(hs),su=hs.setSetting.bind(hs);const nu=new class extends gt{constructor(){super(),this.info={description:()=>Se.element("ul",null,Se.element("li",null,"Adds 2 identical buttons (",Se.element("i",{className:"fa fa-bar-chart"}),') to the "Gifts Won" and "Gifts Sent" rows of a user\'s ',Se.element("a",{href:"https://www.steamgifts.com/user/cg"},"profile")," ","page that allow you to gather data about their giveaways:"),Se.element("ul",null,Se.element("li",null,"The won data contains a table with the number and percentage of won giveaways per type/level, a list with the creators that the user has most won from and (optionally) 2 other tables with the user's playtime/achievement stats for the games (DLCs cannot be counted, but packages will be listed with playtime > 0 and achievements > 0 if one or more of the games in the package have playtime/achievements)."),Se.element("li",null,"The sent data contains a table with the number and percentage of sent giveaways per type/level and a list with the games that the user has most given away.")),Se.element("li",null,"Results are cached forever, so every time you check the same user again the feature will only retrieve the giveaways that they have created/won since the last check, unless you check them with the option to clear the cache enabled, in which case all of their giveaways will be retrieved again as if they were being checked for the first time.")),features:{ugd_s:{name:"Display playtime/achievement stats in the user's profile page.",sg:!0},ugd_g:{name:"Display how many gifts you have won from / sent to the user to their profile page.",sg:!0,sync:"Won Giveaways",syncKeys:["WonGiveaways"]}},id:"ugd",name:"User Giveaway Data",sg:!0,type:"users",featureMap:{profile:this.ugd_addButtons.bind(this)}}}init(){d.get("ugd_s")&&c.esgst.profileFeatures.push(this.ugd_addStats.bind(this)),d.get("ugd_g")&&c.esgst.profileFeatures.push(this.ugd_addGifts.bind(this))}async ugd_addButtons(e){const t={steamId:e.steamId,id:e.id,username:e.username};await this.ugd_add(e.wonRowLeft,"won",t),await this.ugd_add(e.sentRowLeft,"sent",t)}ugd_addStats(e,t){if(!t)return;const s=t.ugdCache;if(!s)return;let n;Se.insert(e.commentsRow,"afterend",Se.element("fragment",null,Se.element("div",{className:"esgst-ugd featured__table__row",title:zg("ugd"),ref:e=>n=e},Se.element("div",{className:"featured__table__row__left"},"Won Games Playtime > ",Se.element("input",{className:"esgst-ugd-input",min:"0",step:"0.1",type:"number",value:d.get("ugd_playtime")})," hours"),Se.element("div",{className:"featured__table__row__right"})),Se.element("div",{className:"esgst-ugd featured__table__row",title:zg("ugd")},Se.element("div",{className:"featured__table__row__left"},"Won Games Achievements > ",Se.element("input",{className:"esgst-ugd-input",max:"100",min:"0",step:"0.1",type:"number",value:d.get("ugd_achievements")})," %"),Se.element("div",{className:"featured__table__row__right"})),Se.element("div",{className:"esgst-ugd featured__table__row",title:zg("ugd")},Se.element("div",{className:"featured__table__row__left"}),Se.element("div",{className:"featured__table__row__right"},Se.element("span",{className:"esgst-italic"},`Last checked ${xe(s.lastCheck,"MMM dd, yyyy, HH:mm:ss")}.`)))));const a=n.firstElementChild.lastElementChild,i=n.lastElementChild,o=n.nextElementSibling.firstElementChild.lastElementChild,r=n.nextElementSibling.lastElementChild;a.addEventListener("change",this.ugd_calculatePlaytime.bind(this,i,a,s,!1)),o.addEventListener("change",this.ugd_calculateAchievements.bind(this,r,o,s,!1)),this.ugd_calculatePlaytime(i,a,s,!0),this.ugd_calculateAchievements(r,o,s,!0)}ugd_calculatePlaytime(e,t,s,n){d.set("ugd_playtime",parseFloat(t.value));let a=0;for(const e in s.playtimes)if(s.playtimes.hasOwnProperty(e)){s.playtimes[e][1]/60>d.get("ugd_playtime")&&(a+=1)}const i=Object.keys(s.playtimes).length;e.textContent=`${a}/${i} (${i>0?Math.round(a/i*1e4)/100:0}%)`,n||su("ugd_playtime",d.get("ugd_playtime"))}ugd_calculateAchievements(e,t,s,n){d.set("ugd_achievements",parseFloat(t.value));let a=0;for(const e in s.achievements)if(s.achievements.hasOwnProperty(e)){const t=s.achievements[e];parseFloat(t.match(/\((.+?)%\)/)[1])>d.get("ugd_achievements")&&(a+=1)}const i=Object.keys(s.achievements).length;e.textContent=`${a}/${i} (${i>0?Math.round(a/i*1e4)/100:0}%)`,n||su("ugd_achievements",d.get("ugd_achievements"))}ugd_addGifts(e){if(e.username===d.get("username"))return;const t=c.esgst.users.users[d.get("steamId")];if(!t)return;const s=t.giveaways;if(!s)return;const n=[],a=[];for(const t of["apps","subs"]){for(const a in s.won[t])for(const i of s.won[t][a]){const t=c.esgst.giveaways[i];t&&t.creator&&t.creator.toLowerCase()===e.username.toLowerCase()&&n.push(t.gameName)}for(const n in s.sent[t])for(const i of s.sent[t][n]){const t=c.esgst.giveaways[i];if(t)for(const s of t.winners)s.username.toLowerCase()===e.username.toLowerCase()&&"Received"===s.status&&a.push(t.gameName)}}Se.insert(e.levelRow,"afterend",Se.element("fragment",null,Se.element("div",{className:"esgst-ugd featured__table__row",title:zg("ugd")},Se.element("div",{className:"featured__table__row__left"},"Gifts Won From This User"),Se.element("div",{className:"featured__table__row__right",title:n.join(", ")},n.length)),Se.element("div",{className:"esgst-ugd featured__table__row",title:zg("ugd")},Se.element("div",{className:"featured__table__row__left"},"Gifts Sent To This User"),Se.element("div",{className:"featured__table__row__right",title:a.join(", ")},a.length))))}async ugd_add(e,t,s,n){let a=null;e&&(a=Yg(e,"beforeend",[{attributes:{class:"esgst-ugd-button",title:zg("ugd",`Get ${t} giveaway data`)},type:"span",children:[{attributes:{class:"fa fa-bar-chart"},type:"i"}]}]));const i=await Zg(null,s),o=i&&i.ugdCache,r={button:a,popup:{icon:"fa-bar-chart",title:`Get ${s.username}'s ${t} giveaway data:`,options:[{check:"won"===t,dependencies:["ugd_forceUpdate"],description:"Get playtime stats.",id:"ugd_getPlaytime",tooltip:"Get playtime stats for each won game by this user (requires a Steam API Key inserted into the settings menu - does not check DLCs/packages)."},{check:"won"===t,dependencies:["ugd_forceUpdate"],description:"Get achievements stats.",id:"ugd_getAchievements",tooltip:"Get achievements stats for each won game by this user (slower - does not check DLCs/packages)."},{check:"won"===t,description:"Force-update playtime/achievements stats.",id:"ugd_forceUpdate",tooltip:"Playtime/achievements stats are updated automatically if you re-check the user after a week. With this option enabled, they are force-updated."},{check:!0,description:"Clear cache.",id:"ugd_clearCache",tooltip:"If enabled, the cache will be cleared and all giveaways will be retrieved again (slower)."}],addProgress:!0,addScrollable:"left",scrollableContent:!n&&o?Se.element("span",{className:"esgst-italic"},`Last checked ${xe(o.lastCheck,"MMM dd, yyyy, HH:mm:ss")}.`):null},mainPopup:n,init:this.ugd_init.bind(this,t,s),requests:[{url:`/user/${s.username}${"won"===t?"/giveaways/won":""}/search?page=`,request:this.ugd_requestGiveaways.bind(this)},this.ugd_requestGiveawaysDone.bind(this)],id:"ugd",permissions:{steamApi:()=>"won"===t&&(d.get("ugd_getPlaytime")||d.get("ugd_getAchievements")),steamStore:()=>!0}};return new Ws(r)}async ugd_init(e,t,s){s.giveaways={},s.key=e,s.requests=s.requests.slice(0,2),s.user=t;const n=await Zg(null,s.user);s.ugdCache=n&&n.ugdCache,s.userGiveaways=await this.ugd_getUserGiveaways(n),s.popup&&d.get("ugd_clearCache")&&(s.userGiveaways[s.key]=null,"won"===s.key&&(s.ugdCache=null)),(!s.userGiveaways.sent||"sent"===s.key&&"7.13.0"!==s.userGiveaways.version)&&(s.userGiveaways.sent={apps:{},subs:{}},s.userGiveaways.sentTimestamp=0,s.userGiveaways.version="7.13.0"),s.userGiveaways.won||(s.userGiveaways.won={apps:{},subs:{}},s.userGiveaways.wonTimestamp=0)}async ugd_getUserGiveaways(e){let t=e&&e.giveaways;if(t)return t;if(t={sent:{apps:{},subs:{}},won:{apps:{},subs:{}},sentTimestamp:0,wonTimestamp:0,version:"7.13.0"},!e)return t;const s=e.ugd;if(!s)return t;let n={};const a=["sent","won"],i=["apps","subs"];for(const e of a)if(s[e]){for(const a of i){const i=s[e][a];for(const o of i){t[e][a][o]=[];const i=s[e][a][o],r=i.length;for(let s=0;s<r;s++){const r=i[s],l=r.code;n[l]=r,t[e][a][o].push(l)}}}t[e+"Timestamp"]=s[e+"Timestamp"]}return Object.keys(n).length&&await eu(n),t}async ugd_requestGiveaways(e,t,s,n){const a=`Retrieving giveaways (page ${t.nextPage}${t.lastPage})...`;e.popup?e.popup.progressBar.setLoading(a).show():e.mainPopup.isSilent||e.mainPopup.progressBar.setMessage(a);let i=!1;const o=Date.now(),r=n.getElementsByClassName("giveaway__row-outer-wrap"),l=r.length;for(let t=0;t<l;t++){const s=await c.esgst.modules.giveaways.giveaways_getInfo(r[t],document,e.user.username,e.key),n=s.giveaway;let a=s.data;const l=a.endTime;if((l>=o||a.numWinners<1)&&(e.user.username!==d.get("username")||"sent"!==e.key))continue;if(l<e.userGiveaways[e.key+"Timestamp"]){i=!0;break}!e.timestamp&&l<o&&(e.timestamp=l);let g=a.gameSteamId;if(!g){if(e.user.username!==d.get("username")||"sent"!==e.key)continue;{const e=await Ne.get(`/giveaway/${a.code}/`);if(a=(await c.esgst.modules.giveaways.giveaways_get(e.html,!1,e.url))[0],g=a&&a.gameSteamId,!g)continue}}const u=e.userGiveaways[e.key][a.gameType],m=a.code;if(u[g]||(u[g]=[]),m){u[g].indexOf(m)<0&&u[g].push(m);const t=c.esgst.giveaways[m];if(!(t&&Array.isArray(t.winners)||"sent"!==e.key))if(a.winners=[],(n.winners.length||n.numWinners)>3)e.requests.push({giveaway:a,request:this.ugd_requestGiveaway,url:`/giveaway/${m}/_/winners/search?page=`});else for(const e in n.winnerColumns)if(n.winnerColumns.hasOwnProperty(e)){const t=n.winnerColumns[e];if(!t.status||"Awaiting Feedback"===t.status)continue;for(const e of t.winners)a.winners.push({status:t.status,username:e})}e.giveaways[m]=a}else u[g].push(a)}if(i)return!0}async ugd_requestGiveawaysDone(e){if("sent"!==e.key)return void await this.ugd_requestGiveawaysDone_2(e);const t=["apps","subs"];for(const s of t){const t=e.userGiveaways.sent[s];for(const s in t)if(t.hasOwnProperty(s)){const n=t[s];for(const t of n){const s="string"==typeof t?e.giveaways[t]||c.esgst.giveaways[t]:t;if(!s||!Array.isArray(s.winners))break;let n;for(n=s.winners.length-1;n>-1;n--){const e=s.winners[n];if("Received"!==e.status&&"Not Received"!==e.status)break}if(n>-1){const t=s.code;t&&(e.giveaways[t]=s),e.requests.push({giveaway:s,request:this.ugd_requestGiveaway,url:`/giveaway/${t}/_/winners/search?page=`})}}}}e.requests.push(this.ugd_requestGiveawaysDone_2.bind(this))}async ugd_requestGiveawaysDone_2(e){if(e.userGiveaways[e.key+"Timestamp"]=e.timestamp,await eu(e.giveaways),e.user.values={giveaways:e.userGiveaways,ugd:null},!e.popup)return void await tu(null,null,e.user);e.popup.progressBar.setLoading("Calculating results...").show(),e.games=e.userGiveaways[e.key],e.perType={},e.typeTotal={},e.levelTotal=new Array(11).fill(0),e.total=0,e.lists={},"sent"===e.key?(e.lists.gameName={name:"Games",values:[]},e.lists.username={name:Se.element("fragment",null,"Winners"," ",e.user.username===d.get("username")?null:Se.element("i",{className:"fa fa-question-circle",title:"This list might not be 100% accurate if the user has giveaways for more than 3 copies that you cannot access."})),values:[]}):e.lists.creator={name:"Creators",values:[]};const t={public:"Everyone",regionRestricted:{name:"Region",combo:["inviteOnly","group","whitelist"]},inviteOnly:"Invite",group:{name:"Group",combo:["whitelist"]},whitelist:"Whitelist"},s=[];for(const e in t){const n=t[e];if("string"==typeof n)s.push(n);else{s.push(n.name);for(const e of n.combo){const a=t[e];if(s.push(`${n.name}_${"string"==typeof a?a:a.name}`),a.combo)for(const e of a.combo){const i=t[e];s.push(`${n.name}_${"string"==typeof a?a:a.name}_${"string"==typeof i?i:i.name}`)}}}}for(const t of s)e.perType[t]=new Array(11).fill(0),e.typeTotal[t]=0;e.savedGiveaways=JSON.parse(Xg("giveaways")),await this.ugd_count(e,e.games.apps,e.savedGiveaways,t),await this.ugd_count(e,e.games.subs,e.savedGiveaways,t);const n=e.popup.getScrollable(),a=["Type"];for(let e=0;e<11;e++)a.push("Level "+e);a.push("Total");const i=new Rs([a]);for(const t in e.perType)if(e.perType.hasOwnProperty(t)){const s=e.perType[t],n=[t.replace(/_/g," + ")];for(let e=0;e<11;e++){const t=s[e];n.push(t)}const a=e.typeTotal[t],o=e.total>0?Math.round(a/e.total*1e4)/100:0;n.push(`${a} (${o}%)`),i.addRow(n)}const o=["Total"];for(let t=0;t<11;t++){const s=e.levelTotal[t],n=e.total>0?Math.round(s/e.total*1e4)/100:0;o.push(`${s} (${n}%)`)}o.push(e.total),i.addRow(o),n.appendChild(i.table);for(const t in e.lists)if(e.lists.hasOwnProperty(t)){const s=[],n=e.lists[t],a=n.values;for(const e in a)if(a.hasOwnProperty(e)){const t=a[e];t.name=e,s.push(t)}n.values=l.sortArray(s,!0,"value")}if("won"!==e.key||!d.get("ugd_getPlaytime")&&!d.get("ugd_getAchievements")||!d.get("steamApiKey"))return await this.ugd_complete(e,n),void await tu(null,null,e.user);e.playtimeTable=new Rs([[{alignment:"left",size:"fill",value:"Game"},"Playtime (Last 2 Weeks)","Playtime (Forever)","Achievements","Gifter"]]),d.get("ugd_getPlaytime")||e.playtimeTable.hideColumns(2,3),d.get("ugd_getAchievements")||e.playtimeTable.hideColumns(4),e.isUpdating=!1;const c=Date.now();if((!e.ugdCache||c-e.ugdCache.lastCheck>6048e5||d.get("ugd_getPlaytime")&&!Object.keys(e.ugdCache.playtimes).length||d.get("ugd_getAchievements")&&!Object.keys(e.ugdCache.achievements).length||d.get("ugd_forceUpdate"))&&(e.isUpdating=!0,e.ugdCache||(e.ugdCache={achievements:{},playtimes:{}}),e.ugdCache.lastCheck=c),e.playtimes=null,d.get("ugd_getPlaytime")&&e.isUpdating){e.popup.progressBar.setLoading("Retrieving playtime stats...").show(),e.ugdCache.playtimes={};try{const t=await Ne.get(`https://api.steampowered.com/IPlayerService/GetOwnedGames/v0001/?key=${d.get("steamApiKey")}&steamid=${e.user.steamId}&format=json`);e.playtimes=t.json.response.games}catch(t){return dt.warning(t.message,t.stack),window.alert("An error occurred when retrieving playtime stats. Please check your Steam API key in the settings menu or try again later."),await this.ugd_complete(e,n),void await tu(null,null,e.user)}}d.get("ugd_getAchievements")&&e.isUpdating&&(e.ugdCache.achievements={}),e.playedCount=0,e.achievementCount=0,e.achievementTotal=0,e.appsTotal=Object.keys(e.games.apps).length,e.subsTotal=Object.keys(e.games.subs).length;const g=e.appsTotal+e.subsTotal;for(const t in e.games.apps)e.games.apps.hasOwnProperty(t)&&(await this.ugd_addGame(e,t),e.appsTotal--);let u=JSON.parse(r.get("gcCache",'{ "apps": {}, "subs": {}, "hltb": {}, "timestamp": 0, "version": 7 }'));7!==u.version&&(u={apps:{},subs:{},hltb:u.hltb,timestamp:0,version:7}),u.hltb||(u.hltb={});for(const t in e.games.subs)if(e.games.subs.hasOwnProperty(t)){let s=u.subs[t]&&u.subs[t].apps;if(!s)try{s=(await Ne.get(`http://store.steampowered.com/api/packagedetails?packageids=${t}&filters=basic`)).json[t].data.apps,u.subs[t]||(u.subs[t]={}),u.subs[t].apps=s.map(e=>parseInt(e.id))}catch(e){}if(s)for(const n of s)e.packagePlayed=!1,e.packageAchieved=!1,await this.ugd_addGame(e,n.id,t,n.name);e.subsTotal--}r.set("gcCache",JSON.stringify(u)),n.appendChild(e.playtimeTable.table);const m=[];d.get("ugd_getPlaytime")&&m.push({attributes:{class:"esgst-bold"},text:`${e.playedCount} out of ${g} games with more than 0 hours playtime (${g>0?Math.round(e.playedCount/g*1e4)/100:0}%)`,type:"div"}),d.get("ugd_getAchievements")&&m.push({attributes:{class:"esgst-bold"},text:`${e.achievementCount} out of ${e.achievementTotal} games with more than 0 achievements (${Math.round(e.achievementCount/Math.max(1,e.achievementTotal)*1e4)/100}%)`,type:"div"}),Yg(n,"beforeend",m),await this.ugd_complete(e,n),e.user.values.ugdCache=e.ugdCache,await tu(null,null,e.user)}async ugd_addGame(e,t,s,n){const a=t;let i;if(e.playtimes)for(i=e.playtimes.length-1;i>-1&&e.playtimes[i].appid!=a;i--);const o=e.games[s?"subs":"apps"][s||t][0],r="string"==typeof o?e.savedGiveaways[o]:o;let l=0,c=0,g="0",u="0",m=null,h="?";if(d.get("ugd_getPlaytime")&&(i>-1||e.ugdCache.playtimes[a])){if(e.isUpdating){const t=e.playtimes[i];l=t.playtime_2weeks||0,c=t.playtime_forever,e.ugdCache.playtimes[a]=[l,c]}else[l,c]=e.ugdCache.playtimes[a];!(c>0)||s&&e.packagePlayed||(e.playedCount+=1,e.packagePlayed=!0),g=l&&l>0?l>60?Math.round(l/60*100)/100+"h":l+"m":"0",u=c>0?c>60?Math.round(c/60*100)/100+"h":c+"m":"0"}let p=0,f=0;if(d.get("ugd_getAchievements")){let t=e.ugdCache&&e.ugdCache.achievements[a];if(e.isUpdating){e.popup.progressBar.setLoading(`Retrieving achievement stats for ${r.gameName||s} (${s?e.subsTotal+" packages":e.appsTotal} left)...`).show();try{const s=(await Qg(a,e.user.steamId)).playerstats;s.success&&(t=s.achievements)}catch(e){dt.warning(e.message,e.stack)}}if(h="0/0",t){if(e.isUpdating){for(const e of t)e.achieved&&(p+=1),f+=1;m=f>0?Math.round(p/f*1e4)/100:0,h=`${p}/${f} (${m}%)`,e.ugdCache.achievements[a]=h}else{const e=t.match(/(.+?)\/(.+?)\s\((.+?)%\)/);p=parseInt(e[1]),f=parseInt(e[2]),m=parseFloat(e[3]),h=t}s&&e.packageAchieved||(p>0&&(e.achievementCount+=1),e.achievementTotal+=1,e.packageAchieved=!0)}}let b=null;if(s){b=e.playtimeTable.getRowGroup(s),b||e.playtimeTable.addRow([{alignment:"left",size:"fill",value:r.gameName},{attributes:['data-sort-value="0"'],value:"0"},{attributes:['data-sort-value="0"'],value:"0"},{attributes:['data-sort-value="0"'],value:"0/0 (0%)"},Se.element("a",{className:"table__column__secondary-link",href:"/user/"+r.creator},r.creator)],s,!0,!1,"Hide contents of the package","Show contents of the package"),b=e.playtimeTable.getRowGroup(s);const t=60*parseFloat(b.columns[1].textContent)+l;b.columns[1].textContent=t&&t>0?t>60?Math.round(t/60*100)/100+"h":t+"m":"0",b.columns[1].setAttribute("data-sort-value",t);const n=60*parseFloat(b.columns[2].textContent)+c;b.columns[2].textContent=n&&n>0?n>60?Math.round(n/60*100)/100+"h":n+"m":"0",b.columns[2].setAttribute("data-sort-value",n);const a=b.columns[3].textContent.match(/(.+?)\/(.+?)\s\((.+?)%\)/),i=parseInt(a[1])+p,o=parseInt(a[2])+f,d=o>0?Math.round(i/o*1e4)/100:0;b.columns[3].textContent=`${i}/${o} (${d}%)`,b.columns[3].setAttribute("data-sort-value",d)}e.playtimeTable.addRow([{alignment:"left",size:"fill",value:s?n:r.gameName},{attributes:[`data-sort-value="${l}"`],value:g},{attributes:[`data-sort-value="${c}"`],value:u},{attributes:[`data-sort-value="${m}"`],value:h},Se.element("a",{className:"table__column__secondary-link",href:"/user/"+r.creator},r.creator)],s,!1,!0)}async ugd_count(e,t,s,n){for(const a in t)if(t.hasOwnProperty(a)){const i=t[a];for(const t of i){const a="string"==typeof t?s[t]:t;if(!a||!a.code){dt.info("[UGD] Giveaway not found:",t);continue}let i="";for(const e in n)if(n.hasOwnProperty(e)){const t=n[e];a[e]&&(i+="string"==typeof t?t:t.name,i+="_")}i=i.slice(0,-1),i||(i="Everyone");const o=a.level,r=Array.isArray(a.winners),l=r?a.winners.filter(e=>"Received"===e.status):a.winners,c="sent"===e.key?l.length||(r?Math.min(a.copies,a.entries):Math.min(a.copies,a.entries,l)):1;e.perType[i][o]+=c,e.typeTotal[i]+=c,e.levelTotal[o]+=c,e.total+=c;for(const t in e.lists)if(e.lists.hasOwnProperty(t)){const s=e.lists[t].values,n="username"===t?l:[a];if(!Array.isArray(n))continue;for(const e of n){const n=e[t];if(s[n]||(s[n]={code:"gameName"===t?null:a.code,gameSteamId:a.gameSteamId,gameType:a.gameType,value:0,values:[]}),s[n].value+="username"===t?1:c||1,"gameName"===t){if(r)for(const e of l)s[n].values.push({code:a.code,name:e.username},null)}else s[n].values.push({code:a.code,gameSteamId:a.gameSteamId,gameType:a.gameType,name:a.gameName},null)}}}}}async ugd_requestGiveaway(e,t,s,n){const a=`Retrieving giveaway winners (${t.giveaway.gameName})...`;if(e.popup?e.popup.progressBar.setLoading(a).show():e.mainPopup.isSilent||e.mainPopup.progressBar.setMessage(a),n.getElementsByClassName("table--summary")[0])return!0;const i=n.getElementsByClassName("table__row-inner-wrap"),o=i.length;for(let e=0;e<o;e++){const s=i[e];t.giveaway.winners.push({status:s.lastElementChild.textContent.trim(),username:s.firstElementChild.nextElementSibling.firstElementChild.textContent.trim()})}1===t.nextPage&&(t.url=s.url+"/search?page=")}async ugd_complete(e,t){const s=[];for(const t in e.lists)if(e.lists.hasOwnProperty(t)){const n=e.lists[t],a=n.values,i=[];for(const e of a)i.push([{alignment:"left",size:"fill",value:Se.element("a",{className:"table__column__secondary-link",href:"gameName"===t?`https://store.steampowered.com/${e.gameType.slice(0,-1)}/${e.gameSteamId}`:"/user/"+e.name},e.name)},{alignment:"center",size:"small",value:e.value},{alignment:"left",size:"fill",value:e.values.map(e=>e?Se.element("span",null,e.code?Se.element("a",{className:"table__column__secondary-link",href:`/giveaway/${e.code}/`,title:"Go to the giveaway"},Se.element("i",{className:"fa fa-gift"})):null," ",Se.element("a",{className:"table__column__secondary-link",href:"gameName"===t?"/user/"+e.name:`https://store.steampowered.com/${e.gameType.slice(0,-1)}/${e.gameSteamId}`},e.name)):Se.element("br",null))}]);const o=new Rs([[{alignment:"left",size:"fill",value:"gameName"===t?"Game":"sent"===e.key?"Winner":"Creator"},{alignment:"center",size:"small",value:"Count"},{alignment:"left",size:"fill",value:"gameName"===t?"Winners":"Games"}],...i]),r=pt.create("ugd",[n.name]).build();s.push(r.nodes.outer,o.table,Se.element("br",null))}Se.insert(t,"beforeend",Se.element("div",{className:"esgst-ugd-lists"},s)),await Kg(t)}},au=hs.createElements.bind(hs),iu=hs.createHeadingButton.bind(hs),ou=hs.createOptions.bind(hs),ru=hs.createResults.bind(hs),lu=hs.getFeatureTooltip.bind(hs),cu=hs.getTimestamp.bind(hs),du=hs.getUser.bind(hs),gu=hs.getValue.bind(hs),uu=hs.saveUser.bind(hs);hs.saveUsers.bind(hs);const mu=new class extends gt{constructor(){super(),this.info={description:()=>Se.element("ul",null,Se.element("li",null,"Adds a button (",Se.element("i",{className:"fa fa-question-circle"}),') to the "Gifts Won" row of a user\'s ',Se.element("a",{href:"https://www.steamgifts.com/user/cg"},"profile")," page that allows you to check if they have any not activated/multiple wins (using"," ",Se.element("a",{href:"https://www.sgtools.info/"},"SGTools"),")."),Se.element("li",null,"Adds a button (",Se.element("i",{className:"fa fa-trophy"})," ",Se.element("i",{className:"fa fa-question-circle"}),") to the main page heading of any"," ",Se.element("a",{href:"https://www.steamgifts.com/giveaway/aeqw7/dead-space/winners"},"winners")," page that allows you to check all of the winners in the page at once. You cannot check more than that at once due to certain limitations when requesting the data to SGTools."),Se.element("li",null,"Adds a button (",Se.element("i",{className:"fa fa-trophy"})," ",Se.element("i",{className:"fa fa-gear"}),") to the page heading of this menu that allows you to view all of the users that have been checked."),Se.element("li",null,"Results are cached for 1 week, so if you check the same user again within that timeframe, their status will not change.")),features:{namwc_h:{description:()=>Se.element("ul",null,Se.element("li",null,"Changes the color (to green if the user passed the check, red if they failed and grey if their profile is private) of a checked user's username (in any page)."),Se.element("li",null,"If you hover over the username, it shows how many not activated/multiple wins the user has and the date when they were checked for the last time.")),features:{namwc_h_m:{description:()=>Se.element("ul",null,Se.element("li",null,"Multiple wins are not the winner's fault sometimes. For example, if they tried to contact the giveaway creator to ask for a reroll and were unable to."),Se.element("li",null,"With this option enabled, multiple wins are ignored when highlighting the user. So if the user has 0 not activated wins and 1 or more multiple wins, they will be considered as having passed the check.")),name:"Ignore multiple wins.",sg:!0,st:!0},namwc_h_f:{name:"Only highlight users who failed to pass the check.",sg:!0,st:!0},namwc_h_i:{description:()=>Se.element("ul",null,Se.element("li",null,"Adds an icon (",Se.element("i",{className:"fa fa-thumbs-up esgst-green"})," if the user passed the check, ",Se.element("i",{className:"fa fa-thumbs-down esgst-red"})," if they failed and"," ",Se.element("i",{className:"fa fa-warning esgst-grey"})," if their profile is private) next to the user's username instead of coloring it."),Se.element("li",null,"If you hover over the icon, it shows how many not activated/multiple wins the user has and the date when they were checked for the last time.")),name:"Use icons instead of colors.",sg:!0,st:!0}},name:"Highlight checked users.",sg:!0,st:!0}},id:"namwc",name:"Not Activated/Multiple Win Checker",sg:!0,type:"users",featureMap:{profile:this.namwc_addUser.bind(this)}}}init(){d.get("namwc_h")&&c.esgst.userFeatures.push(this.namwc_getUsers.bind(this)),c.esgst.winnersPath&&this.namwc_setPopup({button:iu({id:"namwc",icons:["fa-trophy","fa-question-circle"],title:"Check for not activated/multiple wins"})})}namwc_getUsers(e){for(const t of e)if(t.saved&&t.saved.namwc&&t.saved.namwc.results&&!t.context.parentElement.querySelector(".esgst-namwc-highlight, .esgst-namwc-icon")){let e=t.saved.namwc.results,s=null,n=null;if(e.activated&&(e.notMultiple||d.get("namwc_h_m"))?(s="positive",n="fa-thumbs-up"):e.unknown?(s="unknown",n="fa-warning"):(s="negative",n="fa-thumbs-down"),("positive"===s||"unknown"===s)&&!d.get("namwc_h_f")||"negative"===s){let a=`${t.username} has ${e.unknown?"?":Array.isArray(e.notActivated)?e.notActivated.length:e.notActivated} not activated wins and ${Array.isArray(e.multiple)?e.multiple.length:e.multiple} multiple wins (last checked ${cu(t.saved.namwc.lastCheck)})`;d.get("namwc_h_i")||d.get("wbh")&&(d.get("wbh_w")||d.get("wbh_b"))?au(t.context,"beforebegin",[{attributes:{class:"esgst-namwc-icon esgst-user-icon",title:lu("namwc",a)},type:"span",children:[{attributes:{class:`fa ${n} esgst-${s}`},type:"i"}]}]):(t.element.classList.add("esgst-namwc-highlight","esgst-"+s),t.element.title=lu("namwc",a))}}}namwc_addUser(e){this.namwc_setPopup({button:au(e.wonRowLeft,"beforeend",[{attributes:{class:"esgst-namwc-button"},type:"span",children:[{attributes:{class:"fa fa-question-circle",title:lu("namwc","Check for not activated/multiple wins")},type:"i"}]}]),user:{id:e.id,steamId:e.steamId,username:e.username}})}namwc_setPopup(e){(e=e.button?e:{button:e,isMenu:!0}).popup=new lt({addProgress:!0,addScrollable:!0});const t=pt.create("namwc",[e.isMenu?"Manage Not Activated / Multiple Wins Checker caches":`Check for ${e.user?e.user.username+"'s ":""} not activated / multiple wins:`]).insert(e.popup.description,"afterbegin");if(!e.isMenu){const s=tt.create({color:"alternate-white",tooltip:"Options",icons:["fa-gear"]}).insert(t.nodes.outer,"beforeend"),n=new mt("",s.nodes.outer,0,!0);n.popout.appendChild(ou([{check:!0,description:"Only check for not activated wins.",exclusions:["namwc_checkMultiple"],id:"namwc_checkNotActivated",tooltip:"If enabled, multiple wins will not be checked (faster)."},{check:!0,description:"Only check for multiple wins.",exclusions:["namwc_checkNotActivated"],id:"namwc_checkMultiple",tooltip:"If enabled, not activated wins will not be checked (faster)."},{check:!0,description:"Clear cache.",id:"namwc_clearCache",tooltip:"If enabled, the user will be checked with SGTools again (slower)."}])),au(n.popout,"beforeend",[{attributes:{class:"esgst-description"},text:"If a user is highlighted, that means that they have been either checked for the first time or updated",type:"div"}]),tt.create([{color:"green",icons:["fa-question-circle"],name:"Check",onClick:this.namwc_start.bind(this,e)},{template:"error",name:"Cancel",switchTo:{onReturn:0},onClick:this.namwc_stop.bind(this,e)}]).insert(t.nodes.outer,"beforeend")}e.popup.results=au(e.popup.scrollable,"beforeend",[{type:"div"}]),ru(e.popup.results,e.popup,[{Icon:"fa fa-check-circle esgst-positive",Description:"Users with 0 not activated wins",Key:"activated"},{Icon:"fa fa-check-circle esgst-positive",Description:"Users with 0 multiple wins",Key:"notMultiple"},{Icon:"fa fa-times-circle esgst-negative",Description:"Users with not activated wins",Key:"notActivated"},{Icon:"fa fa-times-circle esgst-negative",Description:"Users with multiple wins",Key:"multiple"},{Icon:"fa fa-question-circle",Description:"Users who cannot be checked for not activated wins either because they have a private profile or SteamCommunity is down",Key:"unknown"}]),e.button.addEventListener("click",e.popup.open.bind(e.popup,e.isMenu?this.namwc_start.bind(this,e):null))}async namwc_start(e){e.isCanceled=!1,e.button.classList.add("esgst-busy"),e.popup.progressBar.setLoading(null).show(),e.popup.overallProgressBar.reset().show(),e.popup.activated.classList.add("esgst-hidden"),e.popup.notMultiple.classList.add("esgst-hidden"),e.popup.notActivated.classList.add("esgst-hidden"),e.popup.multiple.classList.add("esgst-hidden"),e.popup.unknown.classList.add("esgst-hidden"),e.popup.activatedCount.textContent=e.popup.notMultipleCount.textContent=e.popup.notActivatedCount.textContent=e.popup.multipleCount.textContent=e.popup.unknownCount.textContent="0",e.popup.activatedUsers.innerHTML="",e.popup.notMultipleUsers.textContent="",e.popup.notActivatedUsers.innerHTML="",e.popup.multipleUsers.innerHTML="",e.popup.unknownUsers.innerHTML="";let t=[];if(e.isMenu){let e=JSON.parse(gu("users"));for(let s in e.users)if(e.users.hasOwnProperty(s)){let n=e.users[s];if(!n.namwc||!n.namwc.results)continue;t.push(n.username)}}else if(e.user)t.push(e.user.username);else{let e=c.esgst.pageOuterWrap.querySelectorAll('a[href*="/user/"]');for(let s of e){let e=s.getAttribute("href").match(/\/user\/(.+)/);if(!e)continue;let n=e[1];if(!(t.indexOf(n)>-1||n===d.get("username")||n!==s.textContent||s.closest(".markdown"))&&(t.push(n),t.length>25))break}}if(0===t.length)return void e.popup.setDone();t=l.sortArray(t);let s=[],n={activated:{},notMultiple:{},notActivated:{},multiple:{},unknown:{}};for(let a=0,i=t.length;!e.isCanceled&&a<i;a++){e.popup.progressBar.removeMessage(),e.popup.overallProgressBar.setMessage(`${a} of ${i} users checked`);let o=e.user||{username:t[a]},r=await du(null,o);o.values={namwc:r&&r.namwc};let l=!1;if(!e.isMenu){let t=o.values.namwc&&o.values.namwc.results;if(o.values.namwc||(o.values.namwc={lastCheck:0,results:{}}),d.get("namwc_clearCache")&&(o.values.namwc.lastCheck=0),Date.now()-o.values.namwc.lastCheck>6048e5&&(d.get("namwc_checkNotActivated")?await this.namwc_checkNotActivated(e,o):(d.get("namwc_checkMultiple")||await this.namwc_checkNotActivated(e,o),await this.namwc_checkMultiple(e,o))),t){for(let e in t)if(t.hasOwnProperty(e)){if((Array.isArray(t[e])&&t[e].length||!Array.isArray(t[e])&&t[e])===(Array.isArray(o.values.namwc.results[e])&&o.values.namwc.results[e].length||!Array.isArray(o.values.namwc.results[e])&&o.values.namwc.results[e]))continue;l=!0;break}}else l=!0}let c=[];for(let t in o.values.namwc.results)if(o.values.namwc.results.hasOwnProperty(t)){let s=Array.isArray(o.values.namwc.results[t])&&o.values.namwc.results[t].length||!Array.isArray(o.values.namwc.results[t])&&o.values.namwc.results[t];if(!s)continue;e.popup[t].classList.remove("esgst-hidden");let n=e.popup[t+"Count"];n.textContent=parseInt(n.textContent)+1;const a={href:`http://www.sgtools.info/${t.match(/multiple/i)?"multiple":"nonactivated"}/${o.username}`,target:"_blank"};l&&(a.class="esgst-bold esgst-italic"),c[t]=au(e.popup[t+"Users"],"beforeend",[{attributes:a,text:`${o.username}${t.match(/^(notActivated|multiple)$/)?` (${s})`:""}`,type:"a"}])}e.isMenu||(await uu(null,null,o),s.push(o.steamId),n[o.steamId]=c),e.popup.overallProgressBar.setMessage(`${a} of ${i} users checked`)}e.isCanceled||(e.button.classList.remove("esgst-busy"),e.popup.progressBar.reset().hide(),e.popup.overallProgressBar.setSuccess("All users checked!")),e.popup.setDone()}namwc_stop(e){e.button.classList.remove("esgst-busy"),e.popup.progressBar.reset().hide(),e.isCanceled=!0}async namwc_checkNotActivated(e,t){if(e.isCanceled)return;e.popup.progressBar&&e.popup.progressBar.setMessage(`Retrieving ${t.username}'s not activated wins...`);const s=await Ne.get("http://www.sgtools.info/nonactivated/"+t.username,{queue:!0});if(s.text.match(/has a private profile/))t.values.namwc.results.activated=0,t.values.namwc.results.notActivated=[],t.values.namwc.results.unknown=1;else{t.values.namwc.results.notActivated=[];let e=s.html.getElementsByClassName("notActivatedGame"),n=e.length;for(let s=0;s<n;++s)t.values.namwc.results.notActivated.push(new Date(e[s].textContent.match(/\((\d{4}-\d{2}-\d{2}\s\d{2}:\d{2}:\d{2})\)/)[1]).getTime());t.values.namwc.results.activated=0===n?1:0,t.values.namwc.results.unknown=0}t.values.namwc.lastCheck=Date.now()}async namwc_checkMultiple(e,t){var s;if(e.isCanceled)return;e.popup.progressBar&&e.popup.progressBar.setMessage(`Retrieving ${t.username}'s multiple wins...`),t.values.namwc.results.multiple=[];let n=null===(s=(await Ne.get("http://www.sgtools.info/multiple/"+t.username,{queue:!0})).html)||void 0===s?void 0:s.getElementsByClassName("multiplewins"),a=n.length;for(let e=0;e<a;++e)t.values.namwc.results.multiple.push(new Date(n[e].textContent.match(/,\s(\d{4}-\d{2}-\d{2}\s\d{2}:\d{2}:\d{2})\)/)[1]).getTime());t.values.namwc.results.notMultiple=0===a?1:0,t.values.namwc.lastCheck=Date.now()}},hu=hs.createElements.bind(hs),pu=hs.endless_load.bind(hs),fu=hs.getFeatureTooltip.bind(hs),bu=hs.getUser.bind(hs),wu=hs.saveUser.bind(hs);const yu=new class extends gt{constructor(){super(),this.info={description:()=>Se.element("ul",null,Se.element("li",null,"Adds a button (",Se.element("i",{className:"fa fa-times-circle"}),') to the "Gifts Won" and "Gifts Sent" rows of a user\'s ',Se.element("a",{href:"https://www.steamgifts.com/user/cg"},"profile")," page that allows you to find all of their won/created giveaways that were marked as not received."),Se.element("li",null,"Giveaways for more than 3 copies that were marked as not received can only be found if the winner(s) that marked it as not received is(are) visible in the creator's profile page or if you can access the giveaway and the option to search inside of giveaways is enabled. If they are not found, a list with all of the creator's giveaways for more than 3 copies will be shown."),Se.element("li",null,"Results are cached for 1 week, so if you check the same user again within that timeframe, their status will not change.")),id:"nrf",name:"Not Received Finder",sg:!0,type:"users"}}init(){c.esgst.profileFeatures.push(this.nrf_add.bind(this,"won")),c.esgst.profileFeatures.push(this.nrf_add.bind(this,"sent"))}nrf_add(e,t){if(t[e+"NotReceived"]<1)return;const s=hu(t[e+"RowLeft"],"beforeend",[{attributes:{class:"esgst-nrf-button"},type:"span",children:[{attributes:{class:"fa fa-times-circle",title:fu("nrf","Find not received giveaways")},type:"i"}]}]);new Ws({button:s,init:this.nrf_init.bind(this,e,t),popup:{addProgress:!0,addScrollable:"left",icon:"fa-times",options:[{check:"sent"===e,description:"Also search inside giveaways with multiple copies.",id:"nrf_searchMultiple",tooltip:"If disabled, only giveaways with visible not received copies will be found (faster)."},{check:!0,description:"Clear cache.",id:"nrf_clearCache",tooltip:"If enabled, the cache for this user will be cleared (slower)."}],title:`Find ${t.username}'s not received giveaways:`},requests:[{url:"sent"===e?`/user/${t.username}/search?page=`:`/user/${t.username}/giveaways/won/search?page=`,onDone:this.nrf_onRequestDone.bind(this),request:this.nrf_request.bind(this),user:!0,["sent"===e?"sourceUser":"sourceUserWon"]:!0}]})}async nrf_init(e,t,s){t.username===d.get("username")||s.nrfMessage||(s.nrfMessage=hu(s.popup.scrollable,"beforebegin",[{attributes:{class:"esgst-description"},text:"If you're blacklisted / not whitelisted / not a member of the same Steam groups, not all giveaways will be found.",type:"div"}])),s.nrfUser={steamId:t.steamId,id:t.id,username:t.username};const n=await bu(null,s.nrfUser);n&&(s.nrfData=n["nrf"+("sent"===e?"":"Won")]),!d.get("nrf_clearCache")&&s.nrfData||(s.nrfData={lastCheck:0,found:0,total:0,results:""}),s.nrfResults=s.popup.getScrollable(),Date.now()-s.nrfData.lastCheck>6048e5?(s.nrfFound=0,s.nrfKey=e,s.nrfMultiple=0,s.nrfResultsRaw="",s.nrfUsername=s.nrfUser.username,s.nrfTotal=t[e+"NotReceived"],s.onDone=this.nrf_onDone,s.requests=s.requestsBackup):(s.onDone=null,s.requests=[],hu(s.nrfResults,"atinner",[...Array.from(Se.parse(s.nrfData.results).body.childNodes).map(e=>({context:e}))]),s.popup.overallProgressBar.setMessage(`${s.nrfData.found} of ${s.nrfData.total} not received giveaways found...`).show(),await pu(s.nrfResults))}nrf_request(e,t,s,n){e.popup.progressBar.setLoading(`Searching ${e.nrfUsername}'s giveaways (page ${t.nextPage}${t.lastPage})...`).show();const a=n.querySelectorAll("div.giveaway__column--negative");for(const t of a){e.nrfFound+=t.querySelectorAll('a[href*="/user/"]').length;const s=t.closest(".giveaway__row-outer-wrap").cloneNode(!0);e.nrfResults.appendChild(s),e.nrfResultsRaw+=s.outerHTML}if(e.popup.overallProgressBar.setMessage(`${e.nrfFound} of ${e.nrfTotal} not received giveaways found...`).show(),d.get("nrf_searchMultiple")&&"sent"===e.nrfKey&&e.nrfFound<e.nrfTotal){const t=n.getElementsByClassName("giveaway__heading__thin");for(const s of t){const t=s.textContent.match(/\((.+) Copies\)/);if(t&&parseInt(t[1])>3){const t=s.closest(".giveaway__row-outer-wrap"),n=t.getElementsByClassName("giveaway__heading__name")[0].getAttribute("href");n&&(e.nrfMultiple+=1,e.requests.push({giveaway:t.cloneNode(!0),onDone:this.nrf_onRequestGiveawayDone,request:this.nrf_requestGiveaway,url:n+"/winners/search?page="}))}}}if(e.nrfFound>=e.nrfTotal)return!0}nrf_onRequestDone(e){e.nrfFound>=e.nrfTotal&&(e.requests=[])}nrf_requestGiveaway(e,t,s,n){e.popup.progressBar.setLoading(`Searching inside giveaways with multiple copies (${e.nrfMultiple} left)...`).show();const a=n.getElementsByClassName("table__column--width-small");t.nrfFound=!1;for(const s of a)if(s.textContent.match(/Not Received/)&&(t.nrfFound=!0,e.nrfFound+=1,e.nrfFound>=e.nrfTotal))break;e.popup.overallProgressBar.setMessage(`${e.nrfFound} of ${e.nrfTotal} not received giveaways found...`).show()}nrf_onRequestGiveawayDone(e,t){t.nrfFound&&(e.nrfResults.appendChild(t.giveaway),e.nrfResultsRaw+=t.giveaway.outerHTML)}async nrf_onDone(e){e.nrfData.lastCheck=Date.now(),e.nrfData.found=e.nrfFound,e.nrfData.total=e.nrfTotal,e.nrfData.results=e.nrfResultsRaw,e.nrfUser.values={["nrf"+("sent"===e.nrfKey?"":"Won")]:e.nrfData},await wu(null,null,e.nrfUser),await pu(e.nrfResults)}},vu=hs.createElements.bind(hs),_u=hs.getFeatureTooltip.bind(hs);const ku=new class extends gt{constructor(){super(),this.info={description:()=>Se.element("ul",null,Se.element("li",null,'Adds a "Ratio" row containing a user\'s sent/won ratio (which is their number of gifts sent divided by their number of gifts won) below the "Gifts Sent" row of their'," ",Se.element("a",{href:"https://www.steamgifts.com/user/cg"},"profile")," page.")),id:"swr",name:"Sent/Won Ratio",sg:!0,type:"users",featureMap:{profile:this.swr_add.bind(this)}}}swr_add(e){let t,s,n,a,i,o;t=e.wonCount>0?Math.round(e.sentCount/e.wonCount*100)/100:0,s=e.wonFull>0?Math.round(e.sentFull/e.wonFull*100)/100:0,n=e.wonReduced>0?Math.round(e.sentReduced/e.wonReduced*100)/100:0,a=e.wonZero>0?Math.round(e.sentZero/e.wonZero*100)/100:0,i=e.wonCV>0?Math.round(e.sentCV/e.wonCV*100)/100:0,o=e.realWonCV>0?Math.round(e.realSentCV/e.realWonCV*100)/100:0;let r={rows:[{columns:[{name:"Ratio"},{color:"#8f96a6",name:t}],icon:[{class:"fa-pie-chart",color:"#77899a"}]},{columns:[{color:"#8f96a6",name:"Full Value"},{color:"#8f96a6",name:s}],indent:"80px"},{columns:[{color:"#8f96a6",name:"Reduced Value"},{color:"#8f96a6",name:n}],indent:"80px"},{columns:[{color:"#8f96a6",name:"No Value"},{color:"#8f96a6",name:a}],indent:"80px;"}]},l={rows:[{columns:[{name:"Real Value"},{color:"#8f96a6",name:""+o}],icon:[{class:"fa-dollar",color:"#84cfda"}]}]};vu(e.sentRow,"afterend",[{attributes:{class:"esgst-swr-ratio featured__table__row",title:_u("swr")},type:"div",children:[{attributes:{class:"featured__table__row__left"},text:"Ratio",type:"div"},{attributes:{class:"featured__table__row__right"},type:"div",children:[{attributes:{"data-ui-tooltip":JSON.stringify(r)},text:t,type:"span"},{text:" (",type:"node"},{attributes:{"data-ui-tooltip":JSON.stringify(l)},text:d.get("vrcv")?`${i} / ${o.toLocaleString("en")}`:i,type:"span"},{text:")",type:"node"}]}]}])}};const xu=new class extends gt{constructor(){super(),this.info={description:()=>Se.element("ul",null,Se.element("li",null,"Shows the gifts breakdown of a user in their profile page, with the following initials:"),Se.element("ul",null,Se.element("li",null,"FCV - Full CV"),Se.element("li",null,"RCV - Reduced CV"),Se.element("li",null,"NCV - No CV"),Se.element("li",null,"A - Awaiting Feedback"),Se.element("li",null,"NR - Not Received"))),id:"vgb",inputItems:[{id:"vgb_wonFormat",prefix:"Won Format: ",tooltip:"[FCV], [RCV], [NCV] and [NR] will be replaced with their respective values."},{id:"vgb_sentFormat",prefix:"Sent Format: ",tooltip:"[FCV], [RCV], [NCV], [A] and [NR] will be replaced with their respective values."}],name:"Visible Gifts Breakdown",options:{title:"Position: ",values:["Left","Right"]},sg:!0,type:"users",featureMap:{profile:this.vgb_add.bind(this)}}}vgb_add(e){const t=0===d.get("vgb_index")?"afterbegin":"beforeend";Se.insert(e.wonRowRight.firstElementChild.firstElementChild,t,Se.element("fragment",null,` ${d.get("vgb_wonFormat").replace(/\[FCV]/,e.wonFull).replace(/\[RCV]/,e.wonReduced).replace(/\[NCV]/,e.wonZero).replace(/\[NR]/,e.wonNotReceived)} `)),Se.insert(e.sentRowRight.firstElementChild.firstElementChild,t,Se.element("fragment",null,` ${d.get("vgb_sentFormat").replace(/\[FCV]/,e.sentFull).replace(/\[RCV]/,e.sentReduced).replace(/\[NCV]/,e.sentZero).replace(/\[A]/,e.sentAwaiting).replace(/\[NR]/,e.sentNotReceived)} `))}};const Au=new class extends gt{constructor(){super(),this.info={description:()=>Se.element("ul",null,Se.element("li",null,"Displays the real sent/won CV next to the raw value in a user's"," ",Se.element("a",{href:"https://www.steamgifts.com/user/cg"},"profile")," page."),Se.element("li",null,"This also extends to ",Se.element("span",{"data-esgst-feature-id":"swr"}),", if you have that feature enabled."),Se.element("li",null,"With this feature disabled, you can still view the real CV, as provided by SteamGifts, by hovering over the raw value.")),id:"vrcv",name:"Visible Real CV",sg:!0,type:"users",featureMap:{profile:this.vrcv_add.bind(this)}}}vrcv_add(e){e.sentCvContainer.insertAdjacentText("beforeend"," / $"+e.realSentCV.toLocaleString("en")),e.wonCvContainer.insertAdjacentText("beforeend"," / $"+e.realWonCV.toLocaleString("en"))}};const Cu=new class extends gt{constructor(){super(),this.info={description:()=>Se.element("ul",null,Se.element("li",null,"Shows how much real CV a user needs to level up in their profile page."),Se.element("li",null,"Uses the values mentioned on"," ",Se.element("a",{href:"https://www.steamgifts.com/discussion/XaCbA/"},"this discussion")," for the calculation.")),features:{luc_c:{name:"Display current user level.",sg:!0}},id:"luc",name:"Level Up Calculator",sg:!0,type:"users",featureMap:{profile:this.luc_calculate.bind(this)}}}luc_calculate(e){for(const[t,s]of c.esgst.cvLevels.entries()){const n=Math.round(e.realSentCV);if(n<s){Se.insert(e.levelRowRight,"beforeend",Se.element("span",{className:"esgst-luc-value",title:c.common.getFeatureTooltip("luc")},`(${d.get("luc_c")?e.level+" / ":""}~$${c.common.round(s-n)} real CV to level ${t})`));break}}}},Su=hs.createElements.bind(hs),Eu=hs.getFeatureTooltip.bind(hs);const Tu=new class extends gt{constructor(){super(),this.info={description:()=>Se.element("ul",null,Se.element("li",null,'Adds a button next to the "Visit Steam Profile" button of a user\'s'," ",Se.element("a",{href:"https://www.steamtrades.com/user/76561198020696458"},"profile")," page that allows you to go to their SteamGifts profile page.")),id:"sgpb",name:"SteamGifts Profile Button",st:!0,type:"users"}}init(){c.esgst.userPath&&c.esgst.profileFeatures.push(this.sgpb_add.bind(this))}sgpb_add(e){let t;t=Su(e.steamButtonContainer,"beforeend",[{attributes:{class:"esgst-sgpb-container",title:Eu("sgpb")},type:"div",children:[{attributes:{class:"esgst-sgpb-button",href:"https://www.steamgifts.com/go/user/"+e.steamId,rel:"nofollow",target:"_blank"},type:"a",children:[{attributes:{class:"fa"},type:"i",children:[{attributes:{src:c.esgst.sgIcon},type:"img"}]},{text:"Visit SteamGifts Profile",type:"span"}]}]}]),t.insertBefore(e.steamButton,t.firstElementChild)}},Nu=hs.createElements.bind(hs),Pu=hs.getFeatureTooltip.bind(hs);const Lu=new class extends gt{constructor(){super(),this.info={description:()=>Se.element("ul",null,Se.element("li",null,"Allows you to add links to your"," ",Se.element("a",{href:"https://www.steamgifts.com/account/manage/whitelist"},"whitelist"),"/",Se.element("a",{href:"https://www.steamgifts.com/account/manage/blacklist"},"blacklist"),"/",Se.element("a",{href:"https://www.steamgifts.com/account/steam/games"},"games"),"/",Se.element("a",{href:"https://www.steamgifts.com/account/steam/groups"},"groups"),"/",Se.element("a",{href:"https://www.steamgifts.com/account/steam/wishlist"},"wishlist")," pages to the sidebar of your ",Se.element("a",{href:"https://www.steamgifts.com/user/your-username"},"profile")," ","page."),Se.element("li",null,"The count for each link might be off if you do not have your whitelist/blacklist/owned games/groups/wishlisted games synced through ESGST (first button in the page heading of this menu). The count for games might be always off, since the method ESGST uses to sync your owned games includes DLCs.")),features:{pl_w:{name:"Show whitelist link.",sg:!0},pl_b:{name:"Show blacklist link.",sg:!0},pl_g:{name:"Show games link.",sg:!0},pl_gs:{name:"Show groups link.",sg:!0},pl_wl:{name:"Show wishlist link.",sg:!0}},id:"pl",name:"Profile Links",sg:!0,type:"users"}}init(){c.esgst.userPath&&c.esgst.profileFeatures.push(this.pl_add.bind(this))}pl_add(e){if(e.username!==d.get("username"))return;const t=[],s=[{items:[{count:0,id:"pl_w",name:"Whitelist",url:"/account/manage/whitelist"},{count:0,id:"pl_b",name:"Blacklist",url:"/account/manage/blacklist"}],name:"Manage"},{items:[{count:0,id:"pl_g",name:"Games",url:"/account/steam/games"},{count:0,id:"pl_gs",name:"Groups",url:"/account/steam/groups"},{count:0,id:"pl_wl",name:"Wishlist",url:"/account/steam/wishlist"}],name:"Steam"}];for(const e in c.esgst.users.users)if(c.esgst.users.users.hasOwnProperty(e)){const t=c.esgst.users.users[e];t.whitelisted?s[0].items[0].count+=1:t.blacklisted&&(s[0].items[1].count+=1)}for(const e in c.esgst.games.apps)if(c.esgst.games.apps.hasOwnProperty(e)){const t=c.esgst.games.apps[e];t.owned?s[1].items[0].count+=1:t.wishlisted&&(s[1].items[2].count+=1)}for(const e of c.esgst.groups)e.member&&(s[1].items[1].count+=1);for(const e of s){let s=!1;const n=[];for(const t of e.items)d.get(t.id)&&(n.push({attributes:{class:"sidebar__navigation__item"},type:"li",children:[{attributes:{class:"sidebar__navigation__item__link",href:t.url},type:"a",children:[{attributes:{class:"sidebar__navigation__item__name"},text:t.name,type:"div"},{attributes:{class:"sidebar__navigation__item__underline"},type:"div"},{attributes:{class:"sidebar__navigation__item__count"},text:t.count,type:"div"}]}]}),s=!0);s&&t.push({attributes:{class:"sidebar__heading"},text:e.name,type:"h3"},{attributes:{class:"sidebar__navigation",title:Pu("pl")},type:"ul",children:n})}Nu(c.esgst.sidebar.getElementsByClassName("sidebar__navigation")[0],"afterend",t)}};const Iu=new class extends gt{constructor(){super(),this.info={description:()=>Se.element("ul",null,Se.element("li",null,"Adds a clear button to each search input in the page.")),id:"scb",name:"Search Clear Button",sg:!0,type:"general"}}init(){this.getInputs(document)}getInputs(e){const t=e.querySelectorAll(".sidebar__search-input");for(const e of t)e.parentElement.classList.add("esgst-scb"),Se.insert(e.parentElement,"beforeend",Se.element("i",{className:"fa fa-times",title:"Clear search",onclick:()=>{e.value="",e.dispatchEvent(new Event("change")),e.focus()}}))}},Bu=hs.checkUsernameChange.bind(hs),Du=hs.saveUser.bind(hs);const Gu=new class extends gt{constructor(){super(),this.info={endless:!0,id:"profile"}}async init(){if(d.get("lastSyncWhitelist")>0&&c.esgst.whitelistPath||d.get("lastSyncBlacklist")>0&&c.esgst.blacklistPath){const e=c.esgst.whitelistPath?"whitelisted":"blacklisted";c.esgst.endlessFeatures.push(this.getUsers.bind(this,e))}this.esgst.userPath&&await this.profile_load(document)}getUsers(e,t,s,n,a){const i=t.querySelectorAll(c.common.getSelectors(a,["X.table__remove-default:not(.is-hidden)"]));for(const t of i){const s=t.closest(".table__row-inner-wrap").querySelector(".table__column__heading").textContent.trim();t.addEventListener("click",()=>c.common.updateWhitelistBlacklist(e,{username:s},null))}}async profile_load(e){let t,s,n,a,i,o,r;const l={};for(this.esgst.sg?(l.heading=e.getElementsByClassName("featured__heading")[0],a=e.querySelector('[name="child_user_id"]'),l.id=a?a.value:"",l.username=l.heading.querySelector(".featured__heading__medium").textContent.replace(/\s[\s\S]*/,""),l.steamButtonContainer=e.getElementsByClassName("sidebar__shortcut-outer-wrap")[0],l.steamButton=l.steamButtonContainer.querySelector('[href*="/profiles/"]'),l.steamId=l.steamButton.getAttribute("href").match(/\d+/)[0],l.name=l.username):(l.heading=this.esgst.mainPageHeading,l.id="",l.username="",l.steamButtonContainer=e.getElementsByClassName("profile_links")[0],l.steamButton=l.steamButtonContainer.querySelector('[href*="/profiles/"]'),l.steamId=l.steamButton.getAttribute("href").match(/\d+/)[0],l.name=l.steamId),s=e.getElementsByClassName("featured__table__row__left"),n=s.length-1;n>=0;--n)t=s[n],o=t.textContent.match(/(Comments|Gifts\s(Won|Sent)|Contributor\sLevel|Registered)/),o&&(i=o[2],i?"Won"===i?(l.wonRow=t.parentElement,l.wonRowLeft=t,l.wonRowRight=t.nextElementSibling,r=JSON.parse(l.wonRowRight.firstElementChild.firstElementChild.getAttribute("data-ui-tooltip")).rows,l.wonCount=parseInt(r[0].columns[1].name.replace(/,/g,"")),l.wonFull=parseInt(r[1].columns[1].name.replace(/,/g,"")),l.wonReduced=parseInt(r[2].columns[1].name.replace(/,/g,"")),l.wonZero=parseInt(r[3].columns[1].name.replace(/,/g,"")),l.notWon=parseInt(r[4].columns[1].name.replace(/,/g,"")),l.wonNotReceived=l.notWon,l.wonCvContainer=l.wonRowRight.firstElementChild.lastElementChild,r=JSON.parse(l.wonCvContainer.getAttribute("data-ui-tooltip")).rows,l.wonCV=parseFloat(l.wonCvContainer.textContent.replace(/[$,]/g,"")),l.realWonCV=parseFloat(r[0].columns[1].name.replace(/[$,]/g,""))):"Sent"===i&&(l.sentRow=t.parentElement,l.sentRowLeft=t,l.sentRowRight=t.nextElementSibling,r=JSON.parse(l.sentRowRight.firstElementChild.firstElementChild.getAttribute("data-ui-tooltip")).rows,l.sentCount=parseInt(r[0].columns[1].name.replace(/,/g,"")),l.sentFull=parseInt(r[1].columns[1].name.replace(/,/g,"")),l.sentReduced=parseInt(r[2].columns[1].name.replace(/,/g,"")),l.sentZero=parseInt(r[3].columns[1].name.replace(/,/g,"")),l.sentAwaiting=parseInt(r[4].columns[1].name.replace(/,/g,"")),l.notSent=parseInt(r[5].columns[1].name.replace(/,/g,"")),l.sentNotReceived=l.notSent,l.sentCvContainer=l.sentRowRight.firstElementChild.lastElementChild,r=JSON.parse(l.sentCvContainer.getAttribute("data-ui-tooltip")).rows,l.sentCV=parseFloat(l.sentCvContainer.textContent.replace(/[$,]/g,"")),l.realSentCV=parseFloat(r[0].columns[1].name.replace(/[$,]/g,""))):"Comments"===o[1]?l.commentsRow=t.parentElement:"Contributor Level"===o[1]?(l.levelRow=t.parentElement,l.levelRowLeft=t,l.levelRowRight=t.nextElementSibling,r=JSON.parse(l.levelRowRight.firstElementChild.getAttribute("data-ui-tooltip")).rows,l.level=parseFloat(r[0].columns[1].name)):"Registered"===o[1]&&(l.registrationDate=parseInt(t.nextElementSibling.firstElementChild.getAttribute("data-timestamp"))));l.whitelistButton=l.steamButtonContainer.getElementsByClassName("sidebar__shortcut__whitelist")[0],l.blacklistButton=l.steamButtonContainer.getElementsByClassName("sidebar__shortcut__blacklist")[0],l.whitelistButton&&d.get("lastSyncWhitelist")>0&&l.whitelistButton.addEventListener("click",hs.updateWhitelistBlacklist.bind(hs,"whitelisted",l)),l.blacklistButton&&d.get("lastSyncBlacklist")>0&&l.blacklistButton.addEventListener("click",hs.updateWhitelistBlacklist.bind(hs,"blacklisted",l));let c=this.esgst.users.users[l.steamId];if(c){const e={steamId:l.steamId,username:l.username,values:{}};Bu(this.esgst.users,e)&&(await Du(null,this.esgst.users,e),c=this.esgst.users.users[l.steamId])}for(const e of this.esgst.profileFeatures)try{await e(l,c)}catch(e){dt.error(e.message,e.stack)}}},qu=hs.createElements.bind(hs),Ru=hs.endless_load.bind(hs);const Mu=new class extends gt{constructor(){super(),this.info={description:()=>Se.element("ul",null,Se.element("li",null,"If you hover over the inbox icon (",Se.element("i",{className:"fa fa-envelope"}),") at the header, it shows a popout with your messages so that you do not need to access your inbox page to read them."),Se.element("li",null,"You can also mark the messages as read from the popout and reply to them if"," ",Se.element("span",{"data-esgst-feature-id":"rfi"})," is enabled.")),features:{qiv_p:{description:()=>Se.element("ul",null,Se.element("li",null,"Preloads the first page so that you do not have to wait for it to load after hovering over the inbox icon (this can slow down the page load though).")),name:"Preload the first page.",sg:!0,st:!0}},id:"qiv",name:"Quick Inbox View",sg:!0,st:!0,type:"general"}}init(){Ee.subscribe(Ve,()=>{this.qiv(),this.esgst.qiv.popout&&Be.counters.messages>0&&d.get("qiv_p")&&(this.esgst.qiv.nextPage=1,this.qiv_addMarkReadButton(),this.qiv_scroll(!1,!0))}),this.qiv(!0)}qiv(e){c.header&&c.header.buttonContainers.messages&&("object"!=typeof this.esgst.qiv&&(this.esgst.qiv={nextPage:1}),e&&d.get("qiv_p")&&(this.esgst.qiv.popout=new mt("esgst-qiv-popout",null,1e3),this.esgst.qiv.popout.onClose=this.qiv_removeNew.bind(this),Be.counters.messages>0&&this.qiv_addMarkReadButton(),this.esgst.qiv.comments=qu(this.esgst.qiv.popout.popout,"beforeend",[{attributes:{class:"esgst-qiv-comments"},type:"div"}]),this.esgst.qiv.comments.addEventListener("scroll",this.qiv_scroll.bind(this,!1,!1)),this.qiv_scroll(!0)),c.header.buttonContainers.messages.nodes.outer.addEventListener("mouseenter",this.qiv_openPopout.bind(this)),c.header.buttonContainers.messages.nodes.outer.addEventListener("mouseleave",e=>{this.esgst.qiv.timeout&&(window.clearTimeout(this.esgst.qiv.timeout),this.esgst.qiv.timeout=null),this.esgst.qiv.exitTimeout=window.setTimeout(()=>{this.esgst.qiv.popout&&!this.esgst.qiv.popout.popout.contains(e.relatedTarget)&&this.esgst.qiv.popout.close()},1e3)}))}qiv_openPopout(){this.esgst.qiv.timeout=window.setTimeout(()=>{this.esgst.qiv.popout?this.esgst.qiv.popout.open(c.header.buttonContainers.messages.nodes.outer):(this.esgst.qiv.popout=new mt("esgst-qiv-popout",null,1e3),this.esgst.qiv.popout.onClose=this.qiv_removeNew.bind(this),Be.counters.messages>0&&this.qiv_addMarkReadButton(),this.esgst.qiv.comments=qu(this.esgst.qiv.popout.popout,"beforeend",[{attributes:{class:"esgst-qiv-comments"},type:"div"}]),this.esgst.qiv.popout.open(c.header.buttonContainers.messages.nodes.outer),this.esgst.qiv.comments.addEventListener("scroll",this.qiv_scroll.bind(this,!1,!1)),this.qiv_scroll(!0)),this.esgst.qiv.popout.popout.onmouseenter=()=>{this.esgst.qiv.exitTimeout&&(window.clearTimeout(this.esgst.qiv.exitTimeout),this.esgst.qiv.exitTimeout=null)}},1e3)}qiv_removeNew(){const e=this.esgst.qiv.popout.popout.getElementsByClassName("esgst-qiv-new");for(let t=e.length-1;t>-1;t--)e[t].remove()}async qiv_scroll(e,t){if((e||t||this.esgst.qiv.comments.scrollTop+this.esgst.qiv.comments.offsetHeight>=this.esgst.qiv.comments.scrollHeight)&&!this.esgst.qiv.busy){this.esgst.qiv.busy=!0;const s=this.esgst.qiv.comments.firstElementChild;let n=!1;do{const a=qu(this.esgst.qiv.popout.popout,e||t?"afterbegin":"beforeend",[{type:"span",children:[{attributes:{class:"fa fa-circle-o-notch fa-spin"},type:"i"},{text:" Loading...",type:"node"}]}]);this.esgst.qiv.popout.reposition(c.header.buttonContainers.messages.nodes.outer);const i=(await Ne.get("/messages/search?page="+this.esgst.qiv.nextPage)).html.querySelector(".page__heading, .page_heading").nextElementSibling;if(a.remove(),t){const e=this.esgst.qiv.comments.querySelector('[href*="/go/comment/"]').getAttribute("href").match(/\/go\/comment\/(.+)/)[1],t=i.querySelectorAll(".comment, .comment_outer");let a=t.length-1;for(;a>-1&&t[a].querySelector('[href*="/go/comment/"]').getAttribute("href").match(/\/go\/comment\/(.+)/)[1]!==e;)a--;if(a>-1){n=!1,a--;for(let e=t.length-1;e>a;e--){const s=t[e].parentElement;t[e].remove(),s.children.length||(s.previousElementSibling.remove(),s.remove())}}else n=!0;if(i.children.length){for(const e of t)qu(e,"afterbegin",[{attributes:{class:"esgst-qiv-new esgst-warning"},text:"[NEW]",type:"div"}]);this.esgst.qiv.comments.insertBefore(i,s)}}else{const e=i.querySelectorAll(".comment, .comment_outer");let t=e.length-1;for(;t>-1&&!this.esgst.qiv.comments.querySelector(`[href*="/go/comment/${e[t].querySelector('[href*="/go/comment/"]').getAttribute("href").match(/\/go\/comment\/(.+)/)[1]}"]`);)t--;if(t>-1){for(;t>-1;){const s=e[t].parentElement;e[t].remove(),s.children.length||(s.previousElementSibling.remove(),s.remove()),t--}n=!i.children.length}else n=!1;i.children.length&&this.esgst.qiv.comments.appendChild(i)}i.children.length&&(i.setAttribute("data-esgst-qiv","true"),await Ru(i)),this.esgst.qiv.popout.isOpen&&this.esgst.qiv.popout.reposition(c.header.buttonContainers.messages.nodes.outer),this.esgst.qiv.nextPage+=1}while(n);this.esgst.qiv.busy=!1}}qiv_addMarkReadButton(){let e,t;this.esgst.qiv.markReadButton||(this.esgst.sg?(this.esgst.qiv.markReadButton=qu(this.esgst.qiv.popout.popout,"afterbegin",[{attributes:{class:"sidebar__action-button"},type:"div",children:[{attributes:{class:"fa fa-check-circle"},type:"i"},{text:" Mark as Read",type:"node"}]}]),e="read_messages",t="/messages"):(this.esgst.qiv.markReadButton=qu(this.esgst.qiv.popout.popout,"afterbegin",[{attributes:{class:"page_heading_btn green"},type:"a",children:[{attributes:{class:"fa fa-check-square-o"},type:"i"},{text:"Mark as Read",type:"span"}]}]),e="mark_as_read",t="/ajax.php"),this.esgst.qiv.markReadButton.addEventListener("click",async()=>{await Ne.post(t,{data:`xsrf_token=${Be.xsrfToken}&do=${e}`}),this.esgst.qiv.markReadButton.remove(),this.esgst.qiv.markReadButton=null;let s=this.esgst.qiv.comments.querySelectorAll(".comment__envelope");for(let e=s.length-1;e>-1;e--)s[e].remove();await c.header.updateCounter("messages",0)}))}},Ou="function"==typeof window.WeakMap&&"function"==typeof window.Map,Uu=function(){if(Ou)return window.WeakMap;function e(e,t){let s=-1;return e.some((e,n)=>{let a=e[0]===t;return a&&(s=n),a}),s}return class{constructor(){this.__entries__=[]}get(t){let s=e(this.__entries__,t);return this.__entries__[s][1]}set(t,s){let n=e(this.__entries__,t);~n?this.__entries__[n][1]=s:this.__entries__.push([t,s])}delete(t){let s=this.__entries__,n=e(s,t);~n&&s.splice(n,1)}has(t){return!!~e(this.__entries__,t)}}}(),Fu=Ou?window.Map:class extends Uu{get size(){return this.__entries__.length}clear(){this.__entries__.splice(0,this.__entries__.length)}entries(){return this.__entries__.slice()}keys(){return this.__entries__.map(e=>e[0])}values(){return this.__entries__.map(e=>e[1])}forEach(e,t=null){for(const s of this.__entries__)e.call(t,s[1],s[0])}};var $u=window.performance&&window.performance.now?()=>window.performance.now():()=>Date.now();const Wu="function"==typeof window.MutationObserver,Vu=window.requestAnimationFrame?window.requestAnimationFrame:e=>setTimeout(()=>e($u()),1e3/60);function ju(e,t=0){let s=!1;return function(...n){!1!==s&&clearTimeout(s),s=setTimeout(()=>{s=!1,e.apply(this,n)},t)}}function Hu(e){const t={};for(const s of Object.keys(e))t[s]={value:e[s]};return Object.defineProperties({},t)}function Ju(e=0,t=0,s=0,n=0){return{left:e,top:t,width:s,height:n,bottom:t+n,right:e+s}}function Yu(e){return e===document.documentElement?Ju(0,0,e.clientWidth,e.clientHeight):e.getBoundingClientRect()}function Ku(e){return e.width*e.height}class zu{constructor(e,t,s,n,a,i){Object.defineProperties(this,{boundingClientRect:{value:t},intersectionRatio:{value:n},intersectionRect:{value:Hu(s)},rootBounds:{value:Hu(a)},target:{value:e},time:{value:i}})}}const Qu=Ju();function Zu(e,t){const s=Math.max(t.left,e.left),n=Math.min(t.right,e.right),a=Math.max(t.top,e.top);return Ju(s,a,n-s,Math.min(t.bottom,e.bottom)-a)}class Xu{constructor(e,t){this.target=e,this.observer=t,this.prevTargetRect=Qu,this.prevThreshold=0,this.prevRatio=0}updateIntersection(e,t){let s,n=Yu(this.target),a=this.getIntersectionData(e,t,n),i=+a.exists,o=a.ratio!==this.prevRatio,r=(l=n,c=this.prevTargetRect,!(l.top===c.top&&l.left===c.left&&l.right===c.right&&l.bottom===c.bottom));var l,c,d;if(a.exists&&(0!==(d=n).height||0!==d.width)&&(i=this.observer.getThresholdGreaterThan(a.ratio)),s=i!==this.prevThreshold,this.prevTargetRect=n,this.prevThreshold=i,this.prevRatio=a.ratio,a.exists||(a.ratio=0,a.rect=Qu),s){const e=new zu(this.target,n,a.rect,a.ratio,t,$u());this.observer.queueEntry(e)}return{ratioChanged:o,thresholdChanged:s,targetRectChanged:r}}getIntersectionData(e,t,s){const n=this.target;s||(s=Yu(this.target)),t||(t=Yu(e));let a=function(e,t){const s=document.documentElement;return e!==s&&!s.contains(e)||!e.contains(t)}(e,n),i=a?Qu:function(e,t,s,n){let a=n,i=t.parentNode,o=!1;for(;!o;){let t=null;i===e||1!==i.nodeType?(o=!0,t=s):"visible"!==window.getComputedStyle(i).overflow&&(t=Yu(i)),t&&(a=Zu(a,t)),i=i.parentNode}return a}(e,n,t,s),o=!a&&i.width>=0&&i.height>=0;return{rect:i,ratio:Ku(i)/Ku(s)||0,exists:o}}}class em{constructor(e,t={},s,n){if("function"!=typeof e)throw new TypeError("The callback provided as parameter 1 is not a function.");if("object"!=typeof t)throw new TypeError("parameter 2 is not an object.");if("root"in t&&!(t.root instanceof Element))throw new TypeError("member root is not of type Element.");const a=function(e=0){let t=e;return Array.isArray(e)?e.length||(t=[0]):t=[e],t.map(e=>{if(e=Number(e),!window.isFinite(e))throw new TypeError("The provided double value is non-finite.");if(e<0||e>1)throw new RangeError("Threshold values must be between 0 and 1.");return e}).sort()}(t.threshold),i=function(e="0px"){if((e=(e+"").split(/\s+/)).length>4)throw new Error("Extra text found at the end of rootMargin.");return e[0]=e[0]||"0px",e[1]=e[1]||e[0],e[2]=e[2]||e[0],e[3]=e[3]||e[1],{rawData:e.join(" "),parsedData:e.map(e=>{let[,t,s]=/^(-?\d*\.?\d+)(px|%)$/.exec(e)||[];const n="px"===s;if(t=parseFloat(t),!window.isFinite(t))throw new Error("rootMargin must be specified in pixels or percent.");return n||(t/=100),{value:t,pixels:n}})}}(t.rootMargin);this.root=t.root||null,this.rootMargin=i.rawData,this.thresholds=Object.freeze(a),this._root=t.root||document.documentElement,this._callback=e,this._rootMargin=i.parsedData,this._targets=new Fu,this._quedEntries=[],this._publicObserver=n||this,this.controller=s}observe(e){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if(!(e instanceof Element))throw new TypeError('parameter 1 is not of type "Element".');let t=this._targets;t.has(e)||(t.set(e,new Xu(e,this)),this.controller.isConnected(this)||this.controller.connect(this),this.controller.startUpdateCycle())}unobserve(e){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if(!(e instanceof Element))throw new TypeError('parameter 1 is not of type "Element".');let t=this._targets;t.has(e)&&t.delete(e),t.size||this.disconnect()}disconnect(){this._targets.clear(),this.controller.disconnect(this)}takeRecords(){return this._quedEntries.splice(0)}notifySubscriber(){const e=this.takeRecords(),t=this._publicObserver;e.length&&this._callback.call(t,e,t)}queueEntry(e){this._quedEntries.push(e)}hasEntries(){return!!this._quedEntries.length}updateObservations(){let e=this._root,t=this.getRootRect(),s=!1;return this._targets.forEach(n=>{const a=n.updateIntersection(e,t);(a.ratioChanged||a.targetRectChanged)&&(s=!0)}),s}getThresholdGreaterThan(e){let t=this.thresholds,s=t.length,n=0;for(;n<s&&t[n]<=e;)++n;return n}getRootRect(){return function(e,t){t=t.map((t,s)=>{let n=t.value;return t.pixels||(n*=s%2?e.width:e.height),n});const s={top:e.top-t[0],right:e.right+t[1],bottom:e.bottom+t[2],left:e.left-t[3]};return s.width=s.right-s.left,s.height=s.bottom-s.top,s}(Yu(this._root),this._rootMargin)}}const tm=new class{constructor(e=50,t=!1){this._idleTimeout=e,this._trackHovers=t,this._cycleStartTime=-1,this._isUpdateScheduled=!1,this._repeatCycle=!1,this._hoverInitiated=!1,this._mutationsObserver=null,this._isListening=!1,this._observers=[],this.startUpdateCycle=this.startUpdateCycle.bind(this),this.scheduleUpdate=this.scheduleUpdate.bind(this),this._onMutation=this._onMutation.bind(this),this._repeatHandler=ju(this.scheduleUpdate,200),this._onMouseOver=ju(this.startUpdateCycle,200)}get idleTimeout(){return this._idleTimeout}set idleTimeout(e){this._idleTimeout=e}connect(e){this.isConnected(e)||this._observers.push(e),this._isListening||this._initListeners()}disconnect(e){let t=this._observers,s=t.indexOf(e);~s&&t.splice(s,1),!t.length&&this._isListening&&this._removeListeners()}isConnected(e){return!!~this._observers.indexOf(e)}_updateObservers(){let e=!1;for(const t of this._observers)t.updateObservations()&&(e=!0),t.hasEntries()&&t.notifySubscriber();return e}startUpdateCycle(){this._cycleStartTime=$u(),this.scheduleUpdate()}scheduleUpdate(e){if("number"==typeof e){const e=this._updateObservers();if(this._isUpdateScheduled=!1,!this._wasCycleStarted())return;e?this.startUpdateCycle():this._hasIdleTimeEnded()?this._onCycleEnded():this.scheduleUpdate()}else this._isUpdateScheduled||(Vu(this.scheduleUpdate),this._isUpdateScheduled=!0)}_hasIdleTimeEnded(){return $u()-this._cycleStartTime>this._idleTimeout}_wasCycleStarted(){return-1!==this._cycleStartTime}_onCycleEnded(){this._cycleStartTime=-1,this._repeatCycle&&(this._cycleStartTime=0,this._repeatHandler())}_initListeners(){this._isListening||(this._isListening=!0,window.addEventListener("resize",this.startUpdateCycle,!0),window.addEventListener("scroll",this.scheduleUpdate,!0),this._trackHovers&&this._addHoverListener(),Wu?(this._mutationsObserver=new MutationObserver(this._onMutation),this._mutationsObserver.observe(document,{attributes:!0,childList:!0,characterData:!0,subtree:!0})):(this._repeatCycle=!0,window.addEventListener("click",this.startUpdateCycle,!0),this.startUpdateCycle()))}_removeListeners(){this._isListening&&(window.removeEventListener("resize",this.startUpdateCycle,!0),window.removeEventListener("scroll",this.scheduleUpdate,!0),this._removeHoverListener(),Wu?this._mutationsObserver&&(this._mutationsObserver.disconnect(),this._mutationsObserver=null):(this._repeatCycle=!1,window.removeEventListener("click",this.startUpdateCycle,!0)),this._isListening=!1)}enableHover(){this._trackHovers=!0,this._isListening&&this._addHoverListener()}disableHover(){this._trackHovers=!1,this._removeHoverListener()}isHoverEnabled(){return this._trackHovers}_addHoverListener(){this._hoverInitiated||(window.addEventListener("mouseover",this._onMouseOver,!0),this._hoverInitiated=!0)}_removeHoverListener(){this._hoverInitiated&&(window.removeEventListener("mouseover",this._onMouseOver,!0),this._hoverInitiated=!1)}_onMutation(e){e.every(e=>"attributes"!==e.type)?this.scheduleUpdate():this.startUpdateCycle()}},sm=new Uu;class nm{constructor(e,t){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");const s=new em(e,t,tm,this);Object.defineProperties(this,{root:{value:s.root},thresholds:{value:s.thresholds},rootMargin:{value:s.rootMargin}}),sm.set(this,s)}static get idleTimeout(){return tm.idleTimeout}static set idleTimeout(e){if("number"!=typeof e)throw new TypeError('type of "idleTimeout" value must be a number.');if(typeof e<0)throw new TypeError('"idleTimeout" value must be greater than 0.');tm.idleTimeout=e}static get trackHovers(){return tm.isHoverEnabled()}static set trackHovers(e){if("boolean"!=typeof e)throw new TypeError('type of "trackHovers" value must be a boolean.');e?tm.enableHover():tm.disableHover()}}["observe","unobserve","disconnect","takeRecords"].forEach(e=>{nm.prototype[e]=function(){return sm.get(this)[e](...arguments)}});var am=nm;let im;im="function"==typeof window.IntersectionObserver?window.IntersectionObserver:am;var om=im;const rm=hs.animateScroll.bind(hs),lm=hs.checkMissingDiscussions.bind(hs),cm=hs.createElements.bind(hs),dm=hs.createHeadingButton.bind(hs),gm=hs.endless_load.bind(hs),um=hs.reverseComments.bind(hs),mm=hs.setSetting.bind(hs);const hm=new class extends gt{constructor(){super(),this.info={description:()=>Se.element("ul",null,Se.element("li",null,"Loads the next page when you scroll down to the end of any page, allowing you to endlessly scroll through pages."),Se.element("li",null,"Adds multiple buttons to the main page heading of the page:"),Se.element("ul",null,Se.element("li",null,Se.element("i",{className:"fa fa-play"})," if the endless scrolling is paused and"," ",Se.element("i",{className:"fa fa-pause"})," if it is not, which allows you to pause/resume the endless scrolling."),Se.element("li",null,Se.element("i",{className:"fa fa-step-forward"}),", which allows you to load the next page without having to scroll down."),Se.element("li",null,Se.element("i",{className:"fa fa-fast-forward"}),", which allows you continuously load the next pages until either the last page is reached or you pause the endless scrolling."),Se.element("li",null,Se.element("i",{className:"fa fa-refresh"})," ",Se.element("i",{className:"fa fa-map-marker"}),", which allows you to refresh the page currently visible in the window."),Se.element("li",null,Se.element("i",{className:"fa fa-refresh"}),", which allows you to refresh all of the pages that have been loaded.")),Se.element("li",null,"You can choose whether or not to show page dividers (page headings separating each loaded page)."),Se.element("li",null,"As you scroll through the page, the pagination navigation of the page changes according to the page currently visible in the window."),Se.element("li",null,"If you use the pagination navigation of the page to try to go to a page that has been loaded, it scrolls to the page instead of opening it."),Se.element("li",null,"There is a reverse scrolling option for discussions that loads the pages in descending order and loads the last page instead of the first one when visiting a discussion from the main/inbox page.")),features:{es_murl:{name:"Modify URL when changing pages to reflect the current page that you're on.",sg:!0,st:!0},es_ch:{name:"Enable for Comment History.",sg:!0},es_df:{name:"Enable for Discussion Filters.",sg:!0},es_tf:{name:"Enable for Trade Filters.",st:!0},es_gb:{name:"Enable for Giveaway Bookmarks.",sg:!0},es_ged:{name:"Enable for Giveaway Encrypter/Decrypter.",sg:!0},es_ge:{name:"Enable for Giveaway Extractor.",sg:!0},es_gf:{name:"Enable for Giveaway Filters.",sg:!0},es_cl:{inputItems:[{attributes:{max:10,min:0,type:"number"},id:"es_pages",prefix:"Pages (Max 10): "}],name:"Continuously load X more pages automatically when visiting any page.",sg:!0},es_r:{description:()=>Se.element("ul",null,Se.element("li",null,"Loads the pages of a discussion in descending order."),Se.element("li",null,"Loads the last page instead of the first one when visiting a discussion from the main/inbox page.")),name:"Enable reverse scrolling.",sg:!0},es_rd:{name:"Refresh active discussions/deals when refreshing the main page.",sg:!0},es_pd:{description:()=>Se.element("ul",null,Se.element("li",null,"With this option enabled, each loaded page is separated by a page heading, which makes it very clear where a page ends and another begins. With it disabled, there is no such distinction, so it looks like the entire page is a single page, giving a true endless feeling.")),name:"Show page dividers.",sg:!0,st:!0}},id:"es",name:"Endless Scrolling",sg:!0,st:!0,includeOptions:[{id:"pause",name:"Paused"}],type:"general"}}async init(){if(!this.esgst.mainPageHeading||!this.esgst.pagination)return;this.esgst.pagination.classList.contains("pagination--no-results")?this.esgst.itemsPerPage=50:this.esgst.itemsPerPage=parseInt(this.esgst.pagination.firstElementChild.firstElementChild.nextElementSibling.textContent.replace(/,/g,""))-parseInt(this.esgst.pagination.firstElementChild.firstElementChild.textContent.replace(/,/g,""))+1;let e={};this.esgst.es=e,e.dividers=d.get("es_pd"),e.mainContext=this.esgst.pagination.previousElementSibling,this.esgst.commentsPath&&!e.mainContext.classList.contains("comments")&&Se.insert(e.mainContext,"afterend",Se.element("div",{className:"comments",ref:t=>e.mainContext=t}));let t=e.mainContext.getElementsByClassName("table__rows")[0];if(t&&(e.mainContext=t),e.paginations=[this.esgst.paginationNavigation?this.esgst.paginationNavigation.innerHTML:""],e.reverseScrolling=d.get("es_r")&&this.esgst.discussionPath,e.reverseScrolling)if(1===this.esgst.currentPage&&this.esgst.paginationNavigation&&!this.esgst.parameters.page){var s;for(let t=0,s=e.mainContext.children.length;t<s;++t)e.mainContext.children[0].remove();null===(s=rt.find("main"))||void 0===s||s.resetData("comments"),this.esgst.pagination.firstElementChild.firstElementChild.nextElementSibling.textContent="0";let t=this.esgst.paginationNavigation.lastElementChild;if(t.classList.contains("is-selected")&&t.querySelector(".fa-angle-double-right")&&!this.esgst.lastPageLink)e.currentPage=parseInt(t.getAttribute("data-page-number"));else{let t=(await Ne.get(this.esgst.searchUrl+"last")).html;this.esgst.pagination.firstElementChild.firstElementChild.textContent=t.body.getElementsByClassName("pagination__results")[0].firstElementChild.innerHTML,this.esgst.pagination.firstElementChild.firstElementChild.nextElementSibling.textContent=t.body.getElementsByClassName("pagination__results")[0].firstElementChild.nextElementSibling.innerHTML,e.currentPage=Math.ceil(parseInt(this.esgst.pagination.firstElementChild.firstElementChild.textContent.replace(/,/g,""))/25),e.pageBase=e.currentPage+1}e.nextPage=e.currentPage,e.reversePages=!0,e.ended=!1}else e.currentPage=this.esgst.currentPage,e.nextPage=e.currentPage-1,e.pageBase=e.currentPage+1,e.ended=0===e.nextPage;else e.currentPage=this.esgst.currentPage,e.nextPage=e.currentPage+1,e.pageBase=e.currentPage-1,e.ended=!this.esgst.paginationNavigation||this.esgst.paginationNavigation.lastElementChild.classList.contains(this.esgst.selectedClass);const n={rootMargin:`-${this.esgst.commentsTop+1}px 0px 0px 0px`};e.observer=new om(this.es_observe.bind(this,e),n),this.es_activate(e),window.location.href.includes("happy-holidays")&&Se.insert(document.head,"beforeend",Se.element("script",null,'\n\t\t\t\t\t  const boxList = document.querySelector(".giveaway_box_list");\n\t\t\t\t\t  var holidayBoxes = new MutationObserver(function() {\n\t\t\t\t\t\tgiveaway_box_redraw();\n\t\t\t\t\t  });\n\t\t\t\t\t  holidayBoxes.observe(boxList, { childList: true });\n\t\t\t\t\t'))}es_observe(e,t){for(const s of t)if(s.boundingClientRect&&s.rootBounds&&(s.target.getAttribute("data-esgst-intersection")||(s.target.setAttribute("data-esgst-intersection",!0),s.isIntersecting)))if(s.target.classList.contains("pagination"))s.isIntersecting?(this.esgst.pagination.setAttribute("data-esgst-intersecting","true"),this.esgst.es_loadNext(null,!0)):this.esgst.pagination.removeAttribute("data-esgst-intersecting");else{const t=parseInt(s.target.className.match(/es-page-(\d+)/)[1]);s.isIntersecting?this.es_changePagination(e,t):s.boundingClientRect.y<=s.rootBounds.y&&this.es_changePagination(e,e.reverseScrolling?t-1:t+1)}}async es_activate(e){for(let t=0,s=e.mainContext.children.length;t<s;++t)t===s-1&&e.observer.observe(e.mainContext.children[t]),e.mainContext.children[t].classList.add("esgst-es-page-"+e.currentPage);if(e.nextButton=dm({featureId:"es",id:"esNext",icons:["fa-step-forward"],title:"Load next page"}),e.continuousButton=dm({featureId:"es",id:"esContinuous",icons:["fa-fast-forward"],title:"Continuously load pages"}),e.ended&&e.continuousButton.classList.add("esgst-hidden"),e.pauseButton=dm({featureId:"es",id:"esPause",icons:["fa-pause"],title:"Pause the endless scrolling"}),e.resumeButton=dm({featureId:"es",id:"esResume",orderId:"esPause",icons:["fa-play"],title:"Resume the endless scrolling"}),e.refreshButton=dm({featureId:"es",id:"esRefresh",icons:["fa-refresh","fa-map-marker"],title:"Refresh current page"}),e.refreshAllButton=dm({featureId:"es",id:"esRefreshAll",icons:["fa-refresh"],title:"Refresh all pages"}),this.esgst.es_refresh=this.es_refresh.bind(this,e),e.refreshButton.addEventListener("click",this.esgst.es_refresh.bind(this)),this.esgst.es_refreshAll=this.es_refreshAll.bind(this,e),e.refreshAllButton.addEventListener("click",this.esgst.es_refreshAll.bind(this)),e.continuousButton.addEventListener("click",this.es_continuouslyLoad.bind(this,e)),e.nextButton.addEventListener("click",this.es_stepNext.bind(this,e)),e.pauseButton.addEventListener("click",this.es_pause.bind(this,e,!1)),e.resumeButton.addEventListener("click",this.es_resume.bind(this,e,!1)),this.esgst.paginationNavigation){this.esgst.modules.generalPaginationNavigationOnTop.pnot_simplify(),this.es_fixFirstPageLinks();let t=this.esgst.paginationNavigation.lastElementChild;!this.esgst.lastPageLink||this.esgst.lastPage===e.pageIndex||t.classList.contains("is-selected")||t.querySelector(".fa-angle-double-right")||cm(this.esgst.paginationNavigation,"beforeend",this.esgst.lastPageLink),this.es_setPagination(e)}e.isLimited=!1,e.limitCount=0,e.busy=!1,e.paused=d.get("es")&&d.get("es").options&&d.get("es").options.pause,this.esgst.es_loadNext=this.es_loadNext.bind(this,e),e.paused?this.es_pause(e,!0):this.es_resume(e,!0),e.pageIndex=e.currentPage;const t={rootMargin:`0px 0px ${window.innerHeight}px 0px`};new om(this.es_observe.bind(this,e),t).observe(this.esgst.pagination),e.paused&&e.reversePages?this.esgst.es_loadNext():d.get("es_cl")&&this.es_continuouslyLoad(e),hs.moveAdsDown(e)}async es_loadNext(e,t,s){this.esgst.pagination.classList.contains("pagination--no-results")||this.esgst.stopEs||e.busy||e.paused&&!e.reversePages||e.ended||(!s||e.continuous||e.step)&&(s||!e.continuous&&!e.step)||e.isLimited&&!(e.limitCount>0)?t&&"function"==typeof t&&t():(e.limitCount-=1,e.busy=!0,e.progressBar||(e.progressBar=at.create().build().setLoading("Loading next page...")),e.progressBar.insert(this.esgst.pagination,"afterend").show(),this.es_getNext(e,!1,!1,t,await Ne.get(`${this.esgst.searchUrl}${e.nextPage}`)))}async es_getNext(e,t,s,n,a){let i=a.html.getElementsByClassName("pagination")[0],o=i.previousElementSibling,r=o.getElementsByClassName("table__rows")[0];if(this.esgst.commentsPath&&!o.classList.contains("comments"))return void(s||(e.refreshButton.addEventListener("click",this.esgst.es_refresh.bind(this)),cm(e.refreshButton,"atinner",[{attributes:{class:"fa fa-refresh"},type:"i"},{attributes:{class:"fa fa-map-marker"},type:"i"}])));r&&(o=r);let l=i.getElementsByClassName(this.esgst.paginationNavigationClass)[0];if(e.reversePages){if(e.paginations[0]=l.innerHTML,cm(this.esgst.paginationNavigation,"atinner",[...Array.from(Se.parse(e.paginations[0]).body.childNodes).map(e=>({context:e}))]),this.esgst.paginationNavigation){this.esgst.modules.generalPaginationNavigationOnTop.pnot_simplify(),this.es_fixFirstPageLinks();let t=this.esgst.paginationNavigation.lastElementChild;!this.esgst.lastPageLink||this.esgst.lastPage===e.pageIndex||t.classList.contains("is-selected")||t.querySelector(".fa-angle-double-right")||cm(this.esgst.paginationNavigation,"beforeend",this.esgst.lastPageLink),this.es_setPagination(e)}e.reversePages=!1,d.get("es_murl")&&this.updateUrl(e.currentPage),this.esgst.pagination.firstElementChild.firstElementChild.textContent=(parseInt(this.esgst.pagination.firstElementChild.firstElementChild.nextElementSibling.textContent.replace(/,/g,""))+1).toString().replace(/\B(?=(\d{3})+(?!\d))/g,","),this.esgst.pagination.firstElementChild.firstElementChild.textContent=this.esgst.pagination.firstElementChild.firstElementChild.nextElementSibling.textContent}else t?(i=e.paginations[(e.reverseScrolling?e.pageBase-(s||e.pageIndex):(s||e.pageIndex)-e.pageBase)-1],l&&i!==l.innerHTML&&(e.paginations[(e.reverseScrolling?e.pageBase-(s||e.pageIndex):(s||e.pageIndex)-e.pageBase)-1]=l.innerHTML,e.ended=!1)):e.paginations.push(l.innerHTML);let c=document.createDocumentFragment();d.get("cr")&&this.esgst.discussionPath&&um(o);let g=o.children.length;const u=t?s||e.pageIndex:e.nextPage;for(let e=0;e<g;++e){let e=o.children[0];e.classList.add("esgst-es-page-"+u),c.appendChild(e)}let m=0;if(t){let t=document.getElementsByClassName("esgst-es-page-"+u);m=t.length;for(let e=1;e<m;++e)t[0].remove();let n=t[0];n?(e.mainContext.insertBefore(c,n),e.observer.observe(n.previousElementSibling),n.remove()):(e.mainContext.appendChild(c),e.observer.observe(e.mainContext.lastElementChild)),s||(hs.moveAdsDown(e),await gm(e.mainContext,!0,null,u),this.es_setRemoveEntry(e.mainContext),d.get("ts")&&!d.get("us")&&this.esgst.modules.generalTableSorter.ts_sortTables(),e.refreshButton.addEventListener("click",this.esgst.es_refresh.bind(this)),cm(e.refreshButton,"atinner",[{attributes:{class:"fa fa-refresh"},type:"i"},{attributes:{class:"fa fa-map-marker"},type:"i"}]))}else e.dividers&&cm(e.mainContext,"beforeend",[{attributes:{class:"esgst-page-heading esgst-es-page-divider"},type:"div",children:[{attributes:{class:"page__heading__breadcrumbs page_heading_breadcrumbs"},type:"div",children:[{attributes:{href:`${this.esgst.searchUrl}${e.nextPage}`},text:"Page "+e.nextPage,type:"a"}]}]}]),e.mainContext.appendChild(c),e.observer.observe(e.mainContext.lastElementChild),hs.moveAdsDown(e),await gm(e.mainContext,!0,null,u),this.es_setRemoveEntry(e.mainContext),d.get("ts")&&!d.get("us")&&this.esgst.modules.generalTableSorter.ts_sortTables(),e.progressBar.hide(),e.reverseScrolling?(--e.nextPage,e.busy=!1,e.nextPage<=0?(e.ended=!0,n&&"function"==typeof n&&n()):e.paused||e.step?n&&"function"==typeof n&&n():e.continuous?this.esgst.es_loadNext(n):n&&"function"==typeof n?n():this.esgst.pagination.getAttribute("data-esgst-intersecting")&&this.esgst.es_loadNext(null,!0)):(++e.nextPage,e.busy=!1,l.lastElementChild.classList.contains(this.esgst.selectedClass)?(e.ended=!0,n&&"function"==typeof n&&n()):e.paused||e.step?n&&"function"==typeof n&&n():e.continuous?this.esgst.es_loadNext(n):n&&"function"==typeof n?n():this.esgst.pagination.getAttribute("data-esgst-intersecting")&&this.esgst.es_loadNext(null,!0));let h=null;this.esgst.pagination.textContent.match(/No\sresults\swere\sfound\./)?(this.esgst.pagination.firstElementChild.firstChild.remove(),Se.insert(this.esgst.pagination.firstElementChild,"afterbegin",Se.element("fragment",null,"Displaying ",Se.element("strong",null,"1")," to ",Se.element("strong",null,g)," of ",Se.element("strong",null,g)," result"+(g>1?"s":"")))):(h=e.reverseScrolling&&!t?this.esgst.pagination.firstElementChild.firstElementChild:this.esgst.pagination.firstElementChild.firstElementChild.nextElementSibling,h.textContent=(parseInt(h.textContent.replace(/,/g,""))-m+(e.reverseScrolling&&!t?-g:g)).toString().replace(/\B(?=(\d{3})+(?!\d))/g,","))}es_changePagination(e,t){const s=e.reverseScrolling?e.pageBase-t:t-e.pageBase,n=e.paginations[s-1];if(n&&this.esgst.paginationNavigation.innerHTML!==n){cm(this.esgst.paginationNavigation,"atinner",[...Array.from(Se.parse(n).body.childNodes).map(e=>({context:e}))]),this.esgst.modules.generalPaginationNavigationOnTop.pnot_simplify(),this.es_fixFirstPageLinks();let s=this.esgst.paginationNavigation.lastElementChild;!this.esgst.lastPageLink||this.esgst.lastPage===e.pageIndex||s.classList.contains("is-selected")||s.querySelector(".fa-angle-double-right")||cm(this.esgst.paginationNavigation,"beforeend",this.esgst.lastPageLink),this.es_setPagination(e),d.get("es_murl")&&this.updateUrl(t)}}es_fixFirstPageLinks(){const e=this.esgst.paginationNavigation.querySelectorAll('[data-page-number="1"]');for(const t of e)t.setAttribute("href",t.getAttribute("href")+"/search?page=1")}async es_stepNext(e){if(e.step)return;cm(e.nextButton,"atinner",[{attributes:{class:"fa fa-circle-o-notch fa-spin"},type:"i"}]),e.step=!0;const t=e.paused;await this.es_resume(e),this.esgst.es_loadNext(async()=>{e.step=!1,t?await this.es_pause(e):await this.es_resume(e),cm(e.nextButton,"atinner",[{attributes:{class:"fa fa-step-forward"},type:"i"}])})}async es_continuouslyLoad(e){if(e.continuous)return;cm(e.continuousButton,"atinner",[{attributes:{class:"fa fa-circle-o-notch fa-spin"},type:"i"}]),e.continuous=!0;const t=e.paused;await this.es_resume(e),d.get("es_cl")&&(e.isLimited=!0,e.limitCount=Math.min(10,parseInt(d.get("es_pages")))),this.esgst.es_loadNext(async()=>{e.isLimited=!1,e.limitCount=0,e.continuous=!1,t?await this.es_pause(e):await this.es_resume(e),cm(e.continuousButton,"atinner",[{attributes:{class:"fa fa-fast-forward"},type:"i"}])})}async es_pause(e,t){if(e.paused=!0,e.pauseButton.classList.add("esgst-hidden"),e.resumeButton.classList.remove("esgst-hidden"),!t){const t=d.getFull("es");t.include=t.include.map(t=>(t!==d.get("es")||(t.options||(t.options={}),t.options.pause=e.paused,d.set("es",t)),t)),await mm("es_"+c.esgst.name,t)}e.continuous=!1,cm(e.continuousButton,"atinner",[{attributes:{class:"fa fa-fast-forward"},type:"i"}])}async es_resume(e,t){if(e.paused=!1,e.resumeButton.classList.add("esgst-hidden"),e.pauseButton.classList.remove("esgst-hidden"),!t){const t=d.getFull("es");t.include=t.include.map(t=>(t!==d.get("es")||(t.options||(t.options={}),t.options.pause=e.paused,d.set("es",t)),t)),await mm("es_"+c.esgst.name,t)}this.esgst.pagination.getAttribute("data-esgst-intersecting")&&this.esgst.es_loadNext(null,!0)}async es_refresh(e){e.refreshButton.removeEventListener("click",this.esgst.es_refresh),cm(e.refreshButton,"atinner",[{attributes:{class:"fa fa-circle-o-notch fa-spin"},type:"i"}]);let t=await Ne.get(`${this.esgst.searchUrl}${e.pageIndex}`);this.es_getNext(e,!0,!1,null,t),this.esgst.giveawaysPath&&d.get("es_rd")&&(d.get("oadd")?this.esgst.modules.discussionsOldActiveDiscussionsDesign.oadd_load(!0):lm(!0)),this.esgst.pinnedGiveaways&&(cm(this.esgst.pinnedGiveaways,"atinner",[...Array.from(t.html.getElementsByClassName("pinned-giveaways__outer-wrap")[0].childNodes).map(e=>({context:e}))]),await gm(this.esgst.pinnedGiveaways,!0),this.esgst.modules.giveawaysPinnedGiveawaysButton.init()),await Ee.dispatch(We,(await Ne.get(c.esgst.sg?"/giveaways/search?type=wishlist":"/")).html)}async es_refreshAll(e){e.refreshAllButton.removeEventListener("click",this.esgst.es_refreshAll),cm(e.refreshAllButton,"atinner",[{attributes:{class:"fa fa-circle-o-notch fa-spin"},type:"i"}]);let t=e.reverseScrolling?e.pageBase-1:e.pageBase+1,s=await Ne.get(`${this.esgst.searchUrl}${t}`);this.es_getNext(e,!0,t,null,s);const n=[];for(let s=1,a=e.paginations.length;s<a;++s)t=e.reverseScrolling?e.pageBase-(s+1):e.pageBase+(s+1),n.push(this.es_getNext(e,!0,t,null,await Ne.get(`${this.esgst.searchUrl}${t}`)));await Ee.dispatch(We,(await Ne.get(c.esgst.sg?"/giveaways/search?type=wishlist":"/")).html),await Promise.all(n),hs.moveAdsDown(e),await gm(e.mainContext,!0),this.es_setRemoveEntry(e.mainContext),e.refreshAllButton.addEventListener("click",this.esgst.es_refreshAll.bind(this)),cm(e.refreshAllButton,"atinner",[{attributes:{class:"fa fa-refresh"},type:"i"}]),d.get("ts")&&!d.get("us")&&this.esgst.modules.generalTableSorter.ts_sortTables(),this.esgst.giveawaysPath&&d.get("es_rd")&&(d.get("oadd")?this.esgst.modules.discussionsOldActiveDiscussionsDesign.oadd_load(!0):lm(!0)),this.esgst.pinnedGiveaways&&(cm(this.esgst.pinnedGiveaways,"atinner",[...Array.from(s.html.getElementsByClassName("pinned-giveaways__outer-wrap")[0].childNodes).map(e=>({context:e}))]),await gm(this.esgst.pinnedGiveaways,!0),this.esgst.modules.giveawaysPinnedGiveawaysButton.init())}es_setPagination(e){let t=this.esgst.paginationNavigation.children;for(let s=0,n=t.length;s<n;++s)t[s].addEventListener("click",this.es_setPaginationItem.bind(this,e))}es_setPaginationItem(e,t){t.preventDefault();let s=parseInt(t.currentTarget.getAttribute("data-page-number")),n=document.querySelector(`.esgst-es-page-${s}:not(.esgst-hidden)`);n?rm(n.offsetTop,()=>{this.es_changePagination(e,s)}):window.location.href=t.currentTarget.getAttribute("href")}es_setRemoveEntry(e){let t=e.getElementsByClassName("table__row-inner-wrap");for(let e=0,s=t.length;e<s;++e)this.es_removeEntry(t[e])}es_removeEntry(e){let t,s,n,a;t=e.getElementsByClassName("table__remove-default")[0],t&&(s=t.nextElementSibling,n=s.nextElementSibling,t.addEventListener("click",async()=>{let i,o,r;for(t.classList.toggle("is-hidden"),s.classList.toggle("is-hidden"),i=e.getElementsByTagName("input"),a="",o=0,r=i.length;o<r;++o)a+=`${i[o].getAttribute("name")}=${i[o].value}${o<r-1?"&":""}`;s.classList.toggle("is-hidden");let l=(await Ne.post("/ajax.php",{data:a})).json;"success"===l.type?(e.classList.add("is-faded"),n.classList.toggle("is-hidden"),l.points&&c.header.updatePoints(l.points)):t.classList.toggle("is-hidden")}))}updateUrl(e){const t=1===e,s=window.location.search.replace(/\?|&page=(\d+)|page=(\d+)&|page=(\d+)/g,"");let n="";"/"===window.location.pathname&&(n=c.esgst.sg?"giveaways":"trades");let a="";s?a=`${n}/search?${s}${t?"":"&page="+e}`:t||(a=`${n}/search?page=${e}`),window.history.replaceState(null,"",`${window.location.origin}${window.location.pathname.replace("/search","")}${a}${window.location.hash}`)}},pm={common:hs,settingsModule:Mt,loadDataCleaner:gs,loadDataManagement:ds,manageData:us,generalPageLoadTimestamp:ps,generalVisibleFullLevel:fs,giveawaysBlacklistGiveawayLoader:ys,giveawaysVisibleInviteOnlyGiveaways:rc,generalNarrowSidebar:vs,generalHiddenCommunityPoll:_s,discussionsReversedActiveDiscussions:ks,discussionsOldActiveDiscussionsDesign:As,discussionsActiveDiscussionsOnTopSidebar:Cs,generalElementFilters:Ss,giveaways_addToStorage:Ts,generalAttachedImageCarousel:Ls,giveawaysFollowedGamesPage:Is,giveawaysArchiveSearcher:Ds,giveawaysCommentEntryChecker:Os,discussionsCloseOpenDiscussionButton:Fs,commentsCommentReverser:$s,commentsCommentSearcher:Vs,commentsCommentTracker:js,giveawaysCommunityWishlistSearchLink:Js,discussionsImprovedDiscussionBookmarks:Ys,discussionsDiscussionsSorter:Qs,gamesEnteredGameHighlighter:Zs,giveawaysEntryTracker:on,commentsCommentHistory:rn,generalCustomHeaderFooterLinks:Yt,generalFixedFooter:ln,generalFixedHeader:cn,generalFixedMainPageHeading:dn,commentsCollapseExpandReplyButton:gn,commentsReplyBoxOnTop:un,generalFixedSidebar:mn,giveawaysGiveawaysSorter:wn,giveawaysQuickGiveawaySearch:ko,giveawaysGiveawayBookmarks:Cn,gamesGameCategories:Nn,giveawaysGiveawayCopyHighlighter:Pn,giveawaysGiveawayLevelHighlighter:Ln,giveawaysCustomGiveawayBackground:In,giveawaysCustomGiveawayCalendar:Bn,generalGiveawayDiscussionTicketTradeTracker:Un,generalThreadSubscription:Fn,giveawaysGiveawayExtractor:Kn,giveawaysGiveawayEncrypterDecrypter:aa,giveawaysGiveawayErrorSearchLinks:oa,commentsCommentFilters:ua,discussionsDiscussionFilters:wa,tradesTradeFilters:Aa,groupsGroupFilters:Ca,giveawaysGiveawayFilters:Na,gamesGameFilters:Pa,groupsGroupLibraryWishlistChecker:Da,giveawaysGiveawayRecreator:Oa,groupsGroupStats:Ua,discussionsDiscussionTags:ei,gamesGameTags:ti,groupsGroupTags:si,giveawaysNewGiveawayDescriptionChecker:ni,giveawaysGiveawayTemplates:ci,giveawaysGridView:mi,generalHiddenBlacklistStats:hi,giveawaysHiddenGamesEnterButtonDisabler:fi,giveawaysHiddenGamesManager:yi,generalHeaderRefresher:vi,tradesHeaderTradesButton:_i,tradesHaveWantListChecker:Si,generalLastPageLink:Ti,generalLevelProgressVisualizer:Ii,giveawaysMultipleGiveawayCreator:Hi,generalMultiManager:no,discussionsMainPostPopup:io,discussionsMainPostSkipper:ro,generalNotificationMerger:lo,giveawaysNextPreviousTrainHotkeys:go,generalPaginationNavigationOnTop:mo,giveawaysPinnedGiveawaysButton:po,discussionsPuzzleMarker:wo,generalPointsVisualizer:yo,giveawaysAdvancedGiveawaySearch:To,generalSearchMagnifyingGlassButton:No,discussionsRefreshActiveDiscussionsButton:Io,discussionsActiveDiscussionsToDisplay:Bo,commentsReplyBoxPopup:Do,commentsCommentFormattingHelper:Go,commentsCommentVariables:qo,giveawaysRealCVCalculator:Fo,giveawaysStickiedGiveawayCountries:Vo,generalShortcutKeys:jo,giveawaysSentKeySearcher:Qo,generalScrollToBottomButton:sr,generalScrollToTopButton:rr,tradesTradeBumper:ur,generalTimeToPointCapCalculator:mr,giveawaysUnsentGiftSender:kr,usersUserSuspensionChecker:xr,usersWhitelistBlacklistChecker:Dr,usersWhitelistBlacklistHighlighter:Mr,usersWhitelistBlacklistSorter:jr,usersWhitelistBlacklistManager:Xr,generalURLRedirector:el,usersUserTags:tl,usersSteamFriendsIndicator:sl,generalAccurateTimestamp:ol,generalEmbeddedVideos:ll,generalImageBorders:cl,generalVisibleAttachedImages:dl,generalAttachedImageLoader:gl,giveawaysCreatedEnteredWonGiveawayDetails:ul,giveawaysDeleteKeyConfirmation:pl,giveawaysGiveawayWinningChance:wl,giveawaysGiveawayWinningRatio:_l,giveawaysEnteredGiveawaysStats:Dn,giveawaysGiveawayPointsToWin:Al,giveawaysGiveawayEndTimeHighlighter:Cl,giveawaysSteamActivationLinks:Tl,giveawaysUnfadedEnteredGiveaway:Nl,giveawaysStickiedGiveawayGroups:Il,commentsMultiReply:Bl,commentsReplyFromInbox:Dl,commentsReplyMentionLink:Gl,usersInboxWinnerHighlighter:Ul,usersUserStats:$l,generalContentLoader:mc,groupsGroupHighlighter:Vl,giveawaysGiveawayPopup:Hl,giveawaysEnterLeaveGiveawayButton:Ql,giveawaysIsThereAnyDealInfo:tc,giveawaysUnhideGiveawayButton:ic,giveawaysOneClickHideGiveawayButton:oc,giveawaysGiveawayWinnersLink:cc,giveawaysTimeToEnterCalculator:uc,commentsReceivedReplyBoxPopup:hc,giveaways:yc,discussions:_c,discussionPanels:kc,comments:Pc,games:Dc,groups:Gc,users:qc,generalTableSorter:Eg,generalSameTabOpener:Tg,usersUsernameHistory:Ng,usersUserNotes:Gg,usersUserFilters:Og,usersSharedGroupChecker:Wg,generalCakeDayReminder:Ms,usersUserLinks:Vg,usersRealWonSentCVLink:Jg,usersUserGiveawayData:nu,usersNotActivatedMultipleWinChecker:mu,usersNotReceivedFinder:yu,usersSentWonRatio:ku,usersVisibleGiftsBreakdown:xu,usersVisibleRealCV:Au,usersLevelUpCalculator:Cu,usersSteamGiftsProfileButton:Tu,usersProfileLinks:Lu,generalSearchClearButton:Iu,profile:Gu,generalQuickInboxView:Mu,generalEndlessScrolling:hm};const fm=new class{constructor(){this.CURRENT_GIVEAWAY_VERSION=2,this.gmf=void 0,this.es_loadNext=void 0,this.es_refresh=void 0,this.es_refreshAll=void 0,this.gpf=void 0,this.es=void 0,this.mgc_createTrainSwitch=void 0,this.mgc_removeLinksSwitch=void 0,this.gas=void 0,this.ged_addIcons=void 0,this.cf=void 0,this.cfh=void 0,this.qiv=void 0,this.mm_enable=void 0,this.mm_disable=void 0,this.tf=void 0,this.df=void 0,this.gf=void 0,this.wbcButton=void 0,this.minimizePanel=void 0,this.leftMainPageHeadingButtons=void 0,this.rightMainPageHeadingButtons=void 0,this.cvLevels=[0,.01,25,50,100,250,500,1e3,2e3,3e3,5e3],this.currentPaths=void 0,this.winners=void 0,this.emojis=void 0,this.uscButton=void 0,this.isSyncing=void 0,this.giveawayExtraPanel=void 0,this.giveawayExtraPanel_gv=void 0,this.mmSelectionStart=void 0,this.lpvStyleArray=void 0,this.pvStyleArray=void 0,this.currentPage=void 0,this.itemsPerPage=void 0,this.delistedGames=void 0,this.featuresById=void 0,this.featuresAncestors=void 0,this.gc_queue=[],this.gc_queue_index=0,this.is_gc_running_queue=!1,this.settingsUrl="https://www.steamgifts.com/account/settings/profile?esgst=settings",this.syncUrl="https://www.steamgifts.com/account/settings/profile?esgst=sync",this.backupUrl="https://www.steamgifts.com/account/settings/profile?esgst=backup",this.restoreUrl="https://www.steamgifts.com/account/settings/profile?esgst=restore",this.deleteUrl="https://www.steamgifts.com/account/settings/profile?esgst=delete",this.cleanUrl="https://www.steamgifts.com/account/settings/profile?esgst=clean",this.dataManagementUrl="https://www.steamgifts.com/account/settings/profile?esgst=data-management",this.path=window.location.pathname.replace(/\/search/,""),this.customPages={},this.sidebarGroups=[],this.paths={sg:[{name:"Everywhere",pattern:".*"},{name:"Giveaways",pattern:"^/($|giveaways)"},{name:"Browse Giveaways",pattern:"^/($|giveaways($|/search))"},{name:"Browse Giveaways - All",pattern:"^/($|giveaways($|/search\\?(?!type)))"},{name:"Browse Giveaways - Wishlist",pattern:"^/giveaways/search\\?type=wishlist"},{name:"Browse Giveaways - Recommended",pattern:"^/giveaways/search\\?type=recommended"},{name:"Browse Giveaways - Group",pattern:"^/giveaways/search\\?type=group"},{name:"Browse Giveaways - New",pattern:"^/giveaways/search\\?type=new"},{name:"Community Wishlist",pattern:"^/giveaways/wishlist"},{name:"My Giveaways - New",pattern:"^/giveaways/new"},{name:"My Giveaways - Created",pattern:"^/giveaways/created"},{name:"My Giveaways - Entered",pattern:"^/giveaways/entered"},{name:"My Giveaways - Won",pattern:"^/giveaways/won"},{name:"Archive",pattern:"^/archive"},{name:"Archive - All",pattern:"^/archive($|/search)"},{name:"Archive - Coming Soon",pattern:"^/archive/coming-soon"},{name:"Archive - Open",pattern:"^/archive/open"},{name:"Archive - Closed",pattern:"^/archive/closed"},{name:"Archive - Deleted",pattern:"^/archive/deleted"},{name:"Bundle Games",pattern:"^/bundle-games"},{name:"Giveaway",pattern:"^/giveaway/"},{name:"Giveaway - Comments",pattern:"^/giveaway/.+?/[^/]+($|/search)"},{name:"Giveaway - Entries",pattern:"^/giveaway/.+?/[^/]+/entries"},{name:"Giveaway - Winners",pattern:"^/giveaway/.+?/[^/]+/winners"},{name:"Giveaway - Groups",pattern:"^/giveaway/.+?/[^/]+/groups"},{name:"Giveaway - Region Restrictions",pattern:"^/giveaway/.{5}/[A-Za-z0-9-]+/region-restrictions"},{name:"Game",pattern:"^/game/"},{name:"Game - Giveaways",pattern:"^/game/.+?/[^/]+($|/search)"},{name:"Game - Coming Soon",pattern:"^/game/.+?/[^/]+/coming-soon"},{name:"Game - Open",pattern:"^/game/.+?/[^/]+/open"},{name:"Game - Closed",pattern:"^/game/.+?/[^/]+/closed"},{name:"Game - Deleted",pattern:"^/game/.+?/[^/]+/deleted"},{name:"Game - Stats",pattern:"^/game/.+?/[^/]+/stats"},{name:"Group",pattern:"^/group/"},{name:"Group - Giveaways",pattern:"^/group/.+?/[^/]+($|/search)"},{name:"Group - Users",pattern:"^/group/.+?/[^/]+/users"},{name:"Group - Stats",pattern:"^/group/.+?/[^/]+/stats"},{name:"Group - Wishlist",pattern:"^/group/.+?/[^/]+/wishlist"},{name:"Discussions",pattern:"^/discussions"},{name:"Discussions - All",pattern:"^/discussions($|/search)"},{name:"Discussions - Add-ons / Tools",pattern:"^/discussions/addons-tools"},{name:"Discussions - Announcements",pattern:"^/discussions/announcements"},{name:"Discussions - Bugs / Suggestions",pattern:"^/discussions/bugs-suggestions"},{name:"Discussions - Deals",pattern:"^/discussions/deals"},{name:"Discussions - Game Showcase",pattern:"^/discussions/game-showcase"},{name:"Discussions - General",pattern:"^/discussions/general"},{name:"Discussions - Group Recruitment",pattern:"^/discussions/group-recruitment"},{name:"Discussions - Hardware",pattern:"^/discussions/hardware"},{name:"Discussions - Help",pattern:"^/discussions/help"},{name:"Discussions - Let's Play Together",pattern:"^/discussions/lets-play-together"},{name:"Discussions - Movies / TV",pattern:"^/discussions/movies-tv"},{name:"Discussions - Off Topic",pattern:"^/discussions/off-topic"},{name:"Discussions - Puzzles / Events",pattern:"^/discussions/puzzles-events"},{name:"Discussions - Uncategorized",pattern:"^/discussions/uncategorized"},{name:"Discussions - User Projects",pattern:"^/discussions/user-projects"},{name:"Discussions - Whitelist Recruitment",pattern:"^/discussions/whitelist-recruitment"},{name:"My Discussions - New",pattern:"^/discussions/new"},{name:"My Discussions - Edit",pattern:"^/discussions/edit"},{name:"My Discussions - Subscribed",pattern:"^/discussions/subscribed"},{name:"My Discussions - Bookmarked",pattern:"^/discussions/bookmarked"},{name:"My Discussions - Created",pattern:"^/discussions/created"},{name:"Discussion",pattern:"^/discussion/"},{name:"Tickets",pattern:"^/support/tickets"},{name:"Tickets - All",pattern:"^/support/tickets($|/search)"},{name:"Tickets - Change Giveaway Game",pattern:"^/support/tickets/change-giveaway-game"},{name:"Tickets - Delete Giveaway",pattern:"^/support/tickets/delete-giveaway"},{name:"Tickets - Other",pattern:"^/support/tickets/other"},{name:"Tickets - Request New Winner",pattern:"^/support/tickets/request-new-winner"},{name:"Tickets - Unsuspend Request",pattern:"^/support/tickets/unsuspend-request"},{name:"Tickets - User Report",pattern:"^/support/tickets/user-report"},{name:"Ticket",pattern:"^/support/ticket/"},{name:"User",pattern:"^/user"},{name:"User - Giveaways - Sent",pattern:"^/user/\\w+?($|/search)"},{name:"User - Giveaways - Won",pattern:"^/user/\\w+?/giveaways/won"},{name:"Messages",pattern:"^/messages"},{name:"Messages - All",pattern:"^/messages($|/search)"},{name:"Messages - Giveaways",pattern:"^/messages/giveaways"},{name:"Messages - Discussions",pattern:"^/messages/discussions"},{name:"Messages - Tickets",pattern:"^/messages/tickets"},{name:"Manage - Whitelist",pattern:"^/account/manage/whitelist"},{name:"Manage - Blacklist",pattern:"^/account/manage/blacklist"},{name:"Steam - Games",pattern:"^/account/steam/games"},{name:"Steam - Groups",pattern:"^/account/steam/groups"},{name:"Steam - Wishlist",pattern:"^/account/steam/wishlist"},{name:"About - Brand Assets",pattern:"^/about/brand-assets"},{name:"About - Comment Formatting",pattern:"^/about/comment-formatting"},{name:"About - FAQ",pattern:"^/about/faq"},{name:"About - Guidelines",pattern:"^/about/guidelines"},{name:"Legal - Privacy Policy",pattern:"^/legal/privacy-policy"},{name:"Legal - Cookie Policy",pattern:"^/legal/cookie-policy"},{name:"Legal - Terms Of Service",pattern:"^/legal/terms-of-service"},{name:"Account",pattern:"^/account"},{name:"Settings - Profile",pattern:"^/account/settings/profile"},{name:"Settings - Patreon",pattern:"^/account/settings/patreon"},{name:"Settings - Giveaways",pattern:"^/account/settings/giveaways"},{name:"Settings - Giveaways - Filters",pattern:"^/account/settings/giveaways/filters"},{name:"Settings - Email Notifications",pattern:"^/account/settings/email-notifications"},{name:"Settings - Referrals",pattern:"^/account/settings/referrals"},{name:"Privacy - Delete Account",pattern:"^/account/privacy/delete-account"},{name:"Stats - Personal - Community",pattern:"^/stats/personal/community"},{name:"Stats - Personal - Steam",pattern:"^/stats/personal/steam"},{name:"Stats - Community - Giveaways",pattern:"^/stats/community/giveaways"},{name:"Stats - Community - Discussions",pattern:"^/stats/community/discussions"},{name:"Stats - Community - Comments",pattern:"^/stats/community/comments"},{name:"Stats - Community - Support",pattern:"^/stats/community/support"},{name:"Stats - Community - Users",pattern:"^/stats/community/users"},{name:"Stats - Steam - Games",pattern:"^/stats/steam/games"},{name:"ESGST - Settings",pattern:"^/account/settings/profile\\?esgst=settings"},{name:"ESGST - Sync",pattern:"^/account/settings/profile\\?esgst=sync"},{name:"ESGST - Backup",pattern:"^/account/settings/profile\\?esgst=backup"},{name:"ESGST - Restore",pattern:"^/account/settings/profile\\?esgst=restore"},{name:"ESGST - Delete",pattern:"^/account/settings/profile\\?esgst=delete"},{name:"ESGST - Clean",pattern:"^/account/settings/profile\\?esgst=clean"},{name:"ESGST - Data Management",pattern:"^/account/settings/profile\\?esgst=data-management"},{name:"ESGST - Archive Searcher",pattern:"^/account/settings/profile\\?esgst=as"},{name:"ESGST - Comment / Entry Checker",pattern:"^/account/settings/profile\\?esgst=cec"},{name:"ESGST - Giveaway Bookmarks",pattern:"^/account/settings/profile\\?esgst=gb"},{name:"ESGST - Giveaway Encryptor / Decryptor",pattern:"^/account/settings/profile\\?esgst=ged"},{name:"ESGST - Giveaway Extractor",pattern:"^/account/settings/profile\\?esgst=ge"},{name:"ESGST - Group Library / Wishlist Checker",pattern:"^/account/settings/profile\\?esgst=glwc"}],st:[{name:"Everywhere",pattern:".*"},{name:"Trades",pattern:"^/($|trades)"},{name:"Browse Trades",pattern:"^/($|trades($|/search))"},{name:"My Trades - New",pattern:"^/trades/new"},{name:"My Trades - Created",pattern:"^/trades/search\\?user=%steamId%"},{name:"Trade",pattern:"^/trade/"},{name:"Vote",pattern:"^/vote/"},{name:"Messages",pattern:"^/messages"},{name:"User",pattern:"^/user"},{name:"Reviews",pattern:"^/reviews"},{name:"Comments",pattern:"^/comments"},{name:"Settings",pattern:"^/settings"},{name:"About - Comment Formatting",pattern:"^/about/comment-formatting"},{name:"About - Guidelines",pattern:"^/about/guidelines"},{name:"Legal - Privacy Policy",pattern:"^/legal/privacy-policy"},{name:"Legal - Cookie Policy",pattern:"^/legal/cookie-policy"},{name:"Legal - Terms Of Service",pattern:"^/legal/terms-of-service"}]},this.formatDistanceLocale={formatDistance:(e,t)=>{switch(e){case"xSeconds":return t+"s";case"xMinutes":return t+"m";case"xHours":return t+"h";case"xDays":return t+"d";case"xMonths":return t+"mo";case"xYears":return t+"y"}}},this.newGiveawayDateFormat="MMM d, yyyy h:mm a",this.documentEvents={click:null,keydown:null},this.windowEvents={},this.parameters={},this.markdownParser=null,this.sg=null,this.st=null,this.icon="data:image/x-icon;base64,AAABAAEAEBAAAAEAIABoBAAAFgAAACgAAAAQAAAAIAAAAAEAIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAqv8DCbP/Hgeq+CQIrf8iCK3/Igit/yIIrf8iB6//Iwit9x8Aqv8DAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAKr0GAa2/c0DvfzfA7f83QO3/N0Dt/zdA7f83QO+/d4Gs/3OAKP1GQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACm/xQFs/n2Bcf//wW///8FwP//BcD//wW///8Fx///BbP69gC2/xUAAAAAAAAAAAAAAAAA/1UDFptOFxSZMxkLpJktAq720QW1+ugEsfvjA7b92wO2/dsEsfvjBbX66Aau/dEoiO4tUlLWGU5k3hdVVf8DEJxKHxWqT8cVrU7uE6VN0guqny0Apv8XAJfQGwBAVywAQFcsAJfQGwCx/xcogugtS2Lk0lBl6u5Qae7ISmPeHxagSSMVr07jF7lV/xOiSu0brgATAAAAAAAAAA8AAAC/AAAAwAAAABAAAAAAYznjEkth4OxWb/3/T2jv40lf4iMXnksiEq1O3RayUv8UpEnkEo0+HQAAABkAAABBAAAA8QAAAPEAAABBAAAAGUBSvxxOYeDjU2v0/05m7d1LYuEiF55LIhKtTt0Ws1L/FahN2gU1FTAAAADAAAAA7AAAAP0AAAD9AAAA7AAAAMAVG0owUGPm2lNr9P9OZu3dS2LhIheeSyISrU7dFrNS/xWoTdoFNRswAAAAvwAAAOsAAAD9AAAA/QAAAOsAAADAFRtKMFBj6NpTa/T/Tmbt3Uti4SIXnksiEq1O3RayUv8UpEnkEo0+HQAAABgAAABAAAAA8QAAAPEAAABBAAAAGT5PuR1OYeDjU2v0/05m7d1LYuEiFqBJIxWuT+QXuVX/E6JL7QC8XhMAAAAAAAAADwAAAL8AAAC/AAAAEAAAAAAOR/8SSWLh7FZv/f9PaO/jSV/iIxCUSh8Vrk7HFqxN7ROlS9JskzMt1XULGK12EhxGLgYsRy8GK612EhzVgAsYgmxxLU1i39JNZ+vtT2fwx0pj1h8AqlUDF65GFgqZUhlsiC0txH0T0s5/EujJgBPkz4QR28+EEdvJgBPkzn8Q6Md+E9KLdHosM1LWGUZo6BZVVf8DAAAAAAAAAAAAAAAA/2YAFMl9EvbgjRb/14gV/9eIFf/XiBX/14gV/9+NFv/KgBD254YAFQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAL91FRjKgRHN1IgU3s+EEt3PhBLdz4QS3c+EEt3UiBTezYMRzcJ6FBkAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACqqgADxIARHr18FiO8eA8ivHgPIrx4DyK8eA8ivXwPI8SAER7/VQADAAAAAAAAAAAAAAAA78cAAPA3AAD4FwAABCAAADGOAAAE+AAAkBEAAJ55AACYOQAAlgEAAER4AAAXaAAATnoAAPgXAAD0JwAA69cAAA==",this.sgIcon="data:image/x-icon;base64,AAABAAEAEBAAAAEAIABoBAAAFgAAACgAAAAQAAAAIAAAAAEAIAAAAAAAQAQAABMLAAATCwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIUAAAD5AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAPoAAACFAAAAAAAAAAAAAAD8AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA+QAAAAAAAAAAAAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAAAAAAAAAAAAP8AAAD/AAAA/wAAABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcAAAA/wAAAP8AAAD/AAAAAAAAAAAAAAD/AAAA/wAAAP8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAP8AAAD/AAAA/wAAAAAAAAAAAAAA/wAAAP8AAAD/AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD/AAAA/wAAAP8AAAAAAAAAAAAAAP8AAAD/AAAA/wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA/wAAAP8AAAD/AAAAAAAAAAAAAAD/AAAA/wAAAP8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAP8AAAD/AAAA/wAAAAAAAAAAAAAA/wAAAP8AAAD/AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD/AAAA/wAAAP8AAAAAAAAAAAAAAP8AAAD/AAAA/wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA/wAAAP8AAAD/AAAAAAAAAAAAAAD/AAAA/wAAAP8AAAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAP8AAAD/AAAA/wAAAAAAAAAAAAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAAAAAAAAAAAAPwAAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD5AAAAAAAAAAAAAACFAAAA+QAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD5AAAAhQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA//8AAP//AADAAwAAwAMAAMfjAADP8wAAz/MAAM/zAADP8wAAz/MAAM/zAADH4wAAwAMAAMADAAD//wAA//8AAA==",this.stIcon="data:image/x-icon;base64,AAABAAEAEBAAAAEAIABoBAAAFgAAACgAAAAQAAAAIAAAAAEAIAAAAAAAQAQAABMLAAATCwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABbD6SgWw+ucFsPrkBbD6SgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAWw+uYFsPr/BbD6/wWw+ucAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFsPrmBbD6/wWw+v8FsPrmAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABbD6SQWw+uYFsPrmBbD6SQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFKRLShSkS+cUpEvkFKRLSgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAExi4EpMYuDnTGLg5Exi4EoAAAAAAAAAABSkS+YUpEv/FKRL/xSkS+cAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABMYuDmTGLg/0xi4P9MYuDnAAAAAAAAAAAUpEvmFKRL/xSkS/8UpEvmAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAATGLg5kxi4P9MYuD/TGLg5gAAAAAAAAAAFKRLSRSkS+YUpEvmFKRLSQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAExi4ElMYuDmTGLg5kxi4EkAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMZ9E0rGfRPnxn0T5MZ9E0oAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADGfRPmxn0T/8Z9E//GfRPnAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAxn0T5sZ9E//GfRP/xn0T5gAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMZ9E0nGfRPmxn0T5sZ9E0kAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA//8AAPw/AAD8PwAA/D8AAPw/AAD//wAAh+EAAIfhAACH4QAAh+EAAP//AAD8PwAA/D8AAPw/AAD8PwAA//8AAA==",this.attachedImages=[],this.popups=[],this.openPopups=0,this.elgbCache={},this.originalHash=window.location.hash,this.userPath=!1,this.gamePath=!1,this.groupPath=!1,this.regionsPath=!1,this.groupWishlistPath=!1,this.mainPath=!1,this.winnersPath=!1,this.giveawaysPath=!1,this.giveawayCommentsPath=!1,this.discussionsTicketsPath=!1,this.ticketsPath=!1,this.tradesPath=!1,this.discussionsTicketsTradesPath=!1,this.discussionTicketTradeCommentsPath=!1,this.archivePath=!1,this.profilePath=!1,this.giveawayPath=!1,this.discussionPath=!1,this.ticketPath=!1,this.tradePath=!1,this.discussionsPath=!1,this.newDiscussionPath=!1,this.editDiscussionPath=!1,this.createdDiscussionsPath=!1,this.newGiveawayPath=!1,this.newTicketPath=!1,this.wishlistPath=!1,this.createdPath=!1,this.wonPath=!1,this.enteredPath=!1,this.commentsPath=!1,this.aboutPath=!1,this.whitelistPath=!1,this.blacklistPath=!1,this.headerSize=0,this.mainPageHeadingSize=0,this.footerSize=0,this.pageTop=0,this.commentsTop=0,this.apPopouts={},this.tsTables=[],this.currentUsers={},this.currentGroups={},this.mmWbcUsers=[],this.gameFeatures=[],this.groupFeatures=[],this.giveawayFeatures=[],this.commentFeatures=[],this.commentV2Features=[],this.discussionFeatures=[],this.tradeFeatures=[],this.profileFeatures=[],this.userFeatures=[],this.endlessFeatures=[],this.games={},this.minimizeList=null,this.sidebar=null,this.currentVersion=void 0,this.previousVersion=void 0,this.isFirstRun=!1,this.isUpdate=!1,this.storage=void 0,this.settings=void 0,this.groups=null,this.features=null,this.firstInstall=void 0,this.requestLog=[],this.giveaways=null,this.mainContext=null,this.pageOuterWrap=null,this.leftButtons=null,this.rightButtons=null,this.hidingGame=void 0,this.mainPageHeading=null,this.pageOuterWrapClass="",this.pageHeadingClass="",this.pageHeadingBreadcrumbsClass="",this.replyBox=null,this.cancelButtonClass="",this.paginationNavigationClass="",this.hiddenClass="",this.selectedClass="",this.originalUrl="",this.favicon=null,this.originalTitle="",this.searchUrl="",this.pagination=null,this.featuredContainer=null,this.paginationNavigation=null,this.enterGiveawayButton=null,this.leaveGiveawayButton=null,this.activeDiscussions=null,this.pinnedGiveaways=null,this.discussions=null,this.tickets=null,this.trades=null,this.users=null,this.busy=!1,this.showChangelog=null,this.name=void 0,this.style=null,this.ustButton=null,this.modules=null,this.decryptedGiveaways=null,this.gfPopup=null,this.cfPopup=null,this.gc_categories_ids=["gc_gi","gc_r","gc_hltb","gc_ocv","gc_fcv","gc_rcv","gc_ncv","gc_h","gc_i","gc_o","gc_w","gc_f","gc_pw","gc_a","gc_bd","gc_bvg","gc_sp","gc_mp","gc_sc","gc_tc","gc_l","gc_m","gc_ea","gc_lg","gc_rm","gc_dlc","gc_p","gc_rd","gc_g"],this.giveawayErrorButton=null,this.gcToFetch=null,this.rerolls=null,this.lastPageLink=null,this.stopEs=!1,this.lastPage=null,this.lpvStyle=null,this.pvStyle=null,this.toDismiss=[],this.draggable={},this.modules=pm;for(const e in this.modules)this.modules.hasOwnProperty(e)&&this.modules[e].setEsgst&&this.modules[e].setEsgst.call(this.modules[e],this);this.documentEvents.click=new Set,this.documentEvents.keydown=new Set,rt.create("main",document),rt.setCurrent("main"),this.parameters=l.getQueryParams(),this.locationHref=window.location.href,this.markdownParser=new v,this.sg=window.location.hostname.match(/www.steamgifts.com/),this.st=window.location.hostname.match(/www.steamtrades.com/),this.elgbCache=JSON.parse(r.get("elgbCache",`{"descriptions": {}, "timestamp": ${Date.now()}}`)),this.userPath=window.location.pathname.match(/^\/user\//),this.userWonPath=this.userPath&&window.location.pathname.match(/\/giveaways\/won/),this.gamePath=window.location.pathname.match(/^\/game\//),this.groupPath=window.location.pathname.match(/^\/group\//),this.regionsPath=window.location.pathname.match(/^\/regions\//),this.groupWishlistPath=window.location.pathname.match(/^\/group\/(.*?)\/wishlist/),this.mainPath=window.location.pathname.match(/^\/$/),this.winnersPath=window.location.pathname.match(/^\/giveaway\/.+\/winners/),this.giveawaysPath=this.locationHref.match(/steamgifts.com($|\/$|\/giveaways(?!.*\/(new|wishlist|created|entered|won)))/),this.giveawayCommentsPath=window.location.pathname.match(/^\/giveaway\/(?!.+\/(entries|winners|groups|region-restrictions|stats))/),this.discussionsTicketsPath=window.location.pathname.match(/^\/(discussions|support\/tickets)/),this.ticketsPath=window.location.pathname.match(/^\/support\/tickets/),this.tradesPath=this.locationHref.match(/steamtrades.com($|\/$|\/trades(?!\/(new|edit)))/),this.discussionsTicketsTradesPath=this.locationHref.match(/steamtrades.com($|\/$)/)||window.location.pathname.match(/^\/(discussions|support\/tickets|trades)/),this.discussionTicketTradeCommentsPath=window.location.pathname.match(/^\/(discussion|support\/ticket|trade)\//),this.archivePath=window.location.pathname.match(/^\/archive/),this.profilePath=window.location.pathname.match(/^\/account\/settings\/profile/),this.giveawayPath=window.location.pathname.match(/^\/giveaway\//),this.discussionPath=window.location.pathname.match(/^\/discussion\//),this.ticketPath=window.location.pathname.match(/^\/support\/ticket\//),this.tradePath=window.location.pathname.match(/^\/trade\//),this.discussionsPath=window.location.pathname.match(/^\/discussions(?!\/(new|edit))/),this.newDiscussionPath=window.location.pathname.match(/^\/discussions\/new/),this.editDiscussionPath=window.location.pathname.match(/^\/discussions\/edit/),this.newTradePath=window.location.pathname.match(/^\/trades\/new/),this.editTradePath=window.location.pathname.match(/^\/trades\/edit/),this.createdDiscussionsPath=window.location.pathname.match(/^\/discussions\/created/),this.newGiveawayPath=window.location.pathname.match(/^\/giveaways\/new/),this.newTicketPath=window.location.pathname.match(/^\/support\/tickets\/new/),this.wishlistPath=window.location.pathname.match(/^\/giveaways\/wishlist/),this.createdPath=window.location.pathname.match(/^\/giveaways\/created/),this.wonPath=window.location.pathname.match(/^\/giveaways\/won/),this.enteredPath=window.location.pathname.match(/^\/giveaways\/entered/),this.commentsPath=window.location.pathname.match(/^\/(giveaway\/(?!.*\/(entries|winners|groups|region-restrictions|stats))|discussion\/|support\/ticket\/|trade\/)/),this.aboutPath=window.location.pathname.match(/^\/(about|legal)/),this.whitelistPath=window.location.pathname.match(/^\/account\/manage\/whitelist/),this.blacklistPath=window.location.pathname.match(/^\/account\/manage\/blacklist/),this.appList=void 0,this.pageHeadings=void 0,this.hasAddedFilterContainer=void 0}};c.add({esgst:fm,modules:pm});class bm{constructor(){this.nodes={inner:null,leftNav:null,nav:null,outer:null,rightNav:null},this.linkContainers={}}static generateId(e){return e.replace(/[^A-Za-z\s].*/,"").trim().split(" ").filter(e=>e).map(e=>`${e[0].toUpperCase()}${e.slice(1).toLowerCase()}`).join("").replace(/^(.)/,(e,t)=>t.toLowerCase())}}class wm extends bm{constructor(){super()}addLinkContainer(e){const[t,s]=e.context?[e.context,e.position]:"left"===e.side?[this.nodes.leftNav,e.position||"beforeend"]:[this.nodes.rightNav,e.position||"afterbegin"];let n;return Se.insert(t,s,Se.element("div",{ref:e=>n=e},e.icon?Se.element("i",{className:e.icon}):null," ",e.url?Se.element("a",{href:e.url},e.name):e.name)),this.parseLinkContainer(n)}parse(e){const t=e.querySelector("footer");if(!t)throw"No footer present.";if(t.dataset.esgstParsed)throw"Footer already parsed.";this.nodes.outer=t,this.nodes.inner=this.nodes.outer.querySelector(".footer_lower"),this.nodes.nav=this.nodes.inner,Se.insert(this.nodes.nav,"afterbegin",Se.element("div",{ref:e=>this.nodes.leftNav=e,style:"flex: 1;"})),this.nodes.leftNav.appendChild(this.nodes.nav.querySelector(".footer_steam")),this.nodes.rightNav=this.nodes.nav.querySelector(".footer_sites");const s=[...Array.from(this.nodes.leftNav.querySelectorAll(":scope > a")),...Array.from(this.nodes.rightNav.querySelectorAll(":scope > a"))];for(const e of s)this.parseLinkContainer(e);this.nodes.outer.dataset.esgstParsed="true"}parseLinkContainer(e){const t={nodes:{outer:e},data:{id:"",name:""}},s=t.nodes.outer.querySelector(".fa");s&&(t.nodes.icon=s,t.data.icon=t.nodes.icon.className);return t.nodes.outer.querySelector("a")?(t.nodes.link=t.nodes.outer.querySelector("a"),t.data.name=t.nodes.link.textContent.trim()||t.nodes.outer.title,t.data.url=t.nodes.link.getAttribute("href")):t.data.name=t.nodes.outer.textContent.trim()||t.nodes.outer.title,t.data.id=bm.generateId(t.data.name),this.linkContainers[t.data.id]=t,t}}class ym extends bm{constructor(){super()}addLinkContainer(e){const[t,s]=e.context?[e.context,e.position]:"left"===e.side?[this.nodes.leftNav,e.position||"beforeend"]:[this.nodes.rightNav,e.position||"afterbegin"];let n;return Se.insert(t,s,Se.element("div",{ref:e=>n=e},e.icon?Se.element("i",{className:e.icon}):null," ",e.url?Se.element("a",{href:e.url},e.name):e.name)),this.parseLinkContainer(n)}parse(e){const t=e.querySelector("footer");if(!t)throw"No footer present.";if(t.dataset.esgstParsed)throw"Footer already parsed.";this.nodes.outer=t,this.nodes.inner=this.nodes.outer.querySelector(".footer_lower .footer_inner_wrap"),this.nodes.nav=this.nodes.inner,Se.insert(this.nodes.nav,"afterbegin",Se.element("div",{ref:e=>this.nodes.leftNav=e,style:"display: flex; gap: 15px;"})),this.nodes.leftNav.appendChild(this.nodes.nav.querySelector(".footer_steam")),this.nodes.rightNav=this.nodes.nav.querySelector(".footer_sites");const s=[...Array.from(this.nodes.leftNav.querySelectorAll(":scope > a")),...Array.from(this.nodes.rightNav.querySelectorAll(":scope > a"))];for(const e of s)this.parseLinkContainer(e);this.nodes.outer.dataset.esgstParsed="true"}parseLinkContainer(e){const t={nodes:{outer:e},data:{id:"",name:""}},s=t.nodes.outer.querySelector(".fa");s&&(t.nodes.icon=s,t.data.icon=t.nodes.icon.className);return t.nodes.outer?(t.nodes.link=t.nodes.outer,t.data.name=t.nodes.link.textContent.trim()||t.nodes.outer.title,t.data.url=t.nodes.link.getAttribute("href")):t.data.name=t.nodes.outer.textContent.trim()||t.nodes.outer.title,t.data.id=bm.generateId(t.data.name),this.linkContainers[t.data.id]=t,t}}function vm(e=Be.namespace){switch(e){case Pe:return new wm;case Le:return new ym;default:throw"Invalid namespace."}}(()=>{const e=fm.modules.common;async function t(){fm.bodyLoaded=!0;let t=!1;if(fm.sg)try{const e=document.getElementsByClassName("nav__avatar-inner-wrap")[0].style.backgroundImage.match(/\("(.+)"\)/)[1];fm.settings.avatar!==e&&(fm.settings.avatar=e,t=!0);const s=document.getElementsByClassName("nav__avatar-outer-wrap")[0].href.match(/\/user\/(.+)/)[1];if(fm.settings.username_sg!==s&&(fm.settings.username_sg=s,t=!0),!fm.settings.registrationDate_sg||!fm.settings.steamId){const e=(await Ne.get("https://www.steamgifts.com/user/"+fm.settings.username_sg)).html,s=e.getElementsByClassName("featured__table__row__left");for(const e of s)if("Registered"===e.textContent){fm.settings.registrationDate_sg=parseInt(e.nextElementSibling.firstElementChild.getAttribute("data-timestamp"));break}fm.settings.steamId=e.querySelector('a[href*="/profiles/"]').getAttribute("href").match(/\d+/)[0],t=!0}}catch(e){}else try{const e=document.getElementsByClassName("nav_avatar")[0].style.backgroundImage.match(/\("(.+)"\)/)[1];fm.settings.avatar!==e&&(fm.settings.avatar=e,t=!0);const s=document.querySelector(`.author_name[href*="/user/${fm.settings.steamId}"], .underline[href*="/user/${fm.settings.steamId}"]`).textContent;fm.settings.username_st!==s&&(fm.settings.username_st=s,t=!0)}catch(e){}t&&await e.setValue("settings",JSON.stringify(fm.settings)),d.init(),fm.sg?(fm.headerSize=39,fm.footerSize=44):(fm.headerSize=document.querySelector("header").classList.contains("small")?88:284,fm.footerSize=d.get("ff")?44:245),fm.mainPageHeadingSize=45,fm.pageTop=d.get("fh")?fm.headerSize:0,fm.commentsTop=fm.pageTop+(d.get("fmph")?fm.mainPageHeadingSize:0),function(){let e,t,s,n,a,i;for(i=`\n\t:root {\n\t\t--esgst-gwc-highlight-width: ${d.get("gwc_h_width")};\n\t\t--esgst-gwr-highlight-width: ${d.get("gwr_h_width")};\n\t}\n`,s=[{id:"gc_h",key:"hidden",mainKey:"esgst-gc"},{id:"gc_gi",key:"giveawayInfo",mainKey:"esgst-gc"},{id:"gc_ocv_fcv",key:"originalCV-fcv",mainKey:"esgst-gc"},{id:"gc_ocv_rcv",key:"originalCV-rcv",mainKey:"esgst-gc"},{id:"gc_fcv",key:"fullCV",mainKey:"esgst-gc"},{id:"gc_rcv",key:"reducedCV",mainKey:"esgst-gc"},{id:"gc_ncv",key:"noCV",mainKey:"esgst-gc"},{id:"gc_hltb",key:"hltb",mainKey:"esgst-gc"},{id:"gc_w",key:"wishlisted",mainKey:"esgst-gc"},{id:"gc_f",key:"followed",mainKey:"esgst-gc"},{id:"gc_o",key:"owned",mainKey:"esgst-gc"},{id:"gc_pw",key:"won",mainKey:"esgst-gc"},{id:"gc_i",key:"ignored",mainKey:"esgst-gc"},{id:"gc_lg",key:"learning",mainKey:"esgst-gc"},{id:"gc_rm",key:"removed",mainKey:"esgst-gc"},{id:"gc_ea",key:"earlyAccess",mainKey:"esgst-gc"},{id:"gc_tc",key:"tradingCards",mainKey:"esgst-gc"},{id:"gc_a",key:"achievements",mainKey:"esgst-gc"},{id:"gc_bd",key:"banned",mainKey:"esgst-gc"},{id:"gc_bvg",key:"bartervg",mainKey:"esgst-gc"},{id:"gc_sp",key:"singleplayer",mainKey:"esgst-gc"},{id:"gc_mp",key:"multiplayer",mainKey:"esgst-gc"},{id:"gc_sc",key:"steamCloud",mainKey:"esgst-gc"},{id:"gc_l",key:"linux",mainKey:"esgst-gc"},{id:"gc_m",key:"mac",mainKey:"esgst-gc"},{id:"gc_dlc",key:"dlc",mainKey:"esgst-gc"},{id:"gc_p",key:"package",mainKey:"esgst-gc"},{id:"gc_rd",key:"releaseDate",mainKey:"esgst-gc"},{id:"gc_g",key:"genres",mainKey:"esgst-gc"}],n=0,a=s.length;n<a;++n)t=d.get(s[n].id+"_color"),e=d.get(s[n].id+"_bgColor"),i+=`\n\t\t${"genres"===s[n].key?"a":""}.${s[n].mainKey}-${s[n].key}:not(.giveaway__column):not(.featured__column) {\n\t\t\tbackground-color: ${e};\n\t\t\t${t?`color: ${t};`:""}\n\t\t}\n\t\t.${s[n].mainKey}-${s[n].key}.giveaway__column, .${s[n].mainKey}-${s[n].key}.featured__column {\n\t\t\tcolor: ${e};\n\t\t}\n\t`;for(s=[{id:"wbh_w",key:"whitelisted",mainKey:"esgst-wbh-highlight"},{id:"wbh_b",key:"blacklisted",mainKey:"esgst-wbh-highlight"}],n=0,a=s.length;n<a;++n)t=d.get(s[n].id+"_color"),e=d.get(s[n].id+"_bgColor"),i+=`\n\t\t.${s[n].mainKey}-${s[n].key} {\n\t\t\tbackground-color: ${e} !important;\n\t\t\t${t?`color: ${t} !important;`:""}\n\t\t}\n\t`;i+=`\n\t.esgst-button.sidebar__error {\n\t\tmargin-bottom: 0;\n\t}\n\n\t.form__saving-button--gray {\n\t\tbackground-image: linear-gradient(#dadde4 0%, #c8ccd7 50%, #b2b7c2 100%);\n\t\tborder-color: #bcc1cc #9da4b2 #7e8797 #a5adbc;\n\t\tcolor: #5d636f;\n\t\ttext-shadow: 1px 1px 1px rgba(233, 236, 245, 0.5);\n\t}\n\n\t.form__saving-button--gray:not(.is-disabled):hover {\n    background-image: linear-gradient(#dcdfe6 0%, #caced9 50%, #b4b9c4 100%);\n\t}\n\n\t.btn-action.yellow {\n\t\tbackground-image: linear-gradient(#f6f6ec 0%, #e9e9ca 100%);\n\t\tborder-color: #e0e0a8 #dbdba0 #d6d68b #dedea4;\n\t\tcolor: #a59d7c;\n\t\ttext-shadow: 1px 1px 1px rgba(255, 255, 255, 0.7);\n\t}\n\n\t.btn_action.yellow:hover:not(.is_saving):not(.is_disabled):not(:active) {\n\t\tbackground-image: linear-gradient(#fcfcec 0%, #e9e9ca 100%);\n\t}\n\n\t.btn_action.yellow:active:not(.is_saving):not(.is_disabled) {\n\t\tbackground-image: linear-gradient(#e6e6c9 0%, #e2e2b8 100%)\n\t\tbox-shadow: 2px 2px 5px #a59d7c inset;\n\t\ttext-shadow: 1px 1px 1px rgba(255, 255, 255, 0.5);\n\t}\n\n\t.notification--info, .notification.blue {\n\t\tbackground-image: linear-gradient(#eafef7 0%, #d9edf7 100%);\n\t\tborder-color: #bce8f1;\n\t\tcolor: #53928f;\n\t}\n\n\t.notification--danger, .notification.red {\n\t\tbackground-image: linear-gradient(#f2efef 0%, #f2dede 100%);\n\t\tborder-color: #ebccd1;\n\t\tcolor: #a96664;\n\t}\n\n\t.notification--default, .notification.gray {\n\t\tbackground-image: linear-gradient(#f3f4f6 0%, #e2e3e5 100%);\n\t\tborder-color: #d6d8db;\n\t\tcolor: #5a5f63;\n\t}\n\n\t.esgst-sm-feature-container {\n\t\tdisplay: flex;\n\t\tflex-direction: column;\n\t}\n\n\t.esgst-sm-feature, .esgst-sm-feature-name {\n\t\talign-items: center;\n\t\tdisplay: flex;\n\t}\n\n\t.form-control {\n\t\tfont-size: 12px !important;\n\t\theight: 22px !important;\n\t\tpadding: 2px !important;\n\t}\n\n\t.form-control.has-error {\n\t\tborder-color: #a94442;\n\t\tbox-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075);\n\t}\n\n\t.footer_inner_wrap {\n\t\tjustify-content: space-between;\n\t}\n\n\t.footer_inner_wrap > ul > :not(last-child) {\n\t\tmargin-right: 15px;\n\t}\n\n\t.nav__button img, .nav_btn img {\n\t\tvertical-align: middle;\n\t}\n\n\t.nav_btn img {\n\t\tmargin-right: 10px;\n\t}\n\n\t.esgst-tds-sidebar-item {\n\t\talign-items: center;\n\t\tdisplay: flex;\n\t\tjustify-content: space-between;\n\t}\n\n\t.esgst-tds-sidebar-item .sidebar__navigation__item__link {\n\t\tflex: 1;\n\t}\n\n\t.ui-datepicker:not([style]) {\n\t\tdisplay: none;\n\t}\n\n\t.esgst-tds-popout {\n\t\tmax-height: 600px;\n\t\tmax-width: 300px;\n\t}\n\n\t.esgst-tds-item {\n\t\talign-items: center;\n\t\tborder: 1px solid #ccc;\n\t\tborder-radius: 5px;\n\t\tdisplay: flex;\n\t\tjustify-content: space-between;\n\t\tmargin-bottom: 2px;\n\t\tpadding: 5px;\n\t}\n\n\t.esgst-tds-item-active {\n\t\tbackground-color: #eee;\n\t}\n\n\t.esgst-tds-item-name {\n\t\tfont-size: 14px;\n\t\tfont-weight: bold;\n\t}\n\n\t.esgst-tds-item-count {\n\t\topacity: 0.75;\n\t}\n\n\t.esgst-tds-item-active .esgst-tds-item-count {\n\t\tfont-weight: bold;\n\t}\n\n\t.esgst-tds-item-actions {\n\t\tdisplay: flex;\n\t}\n\n\t.esgst-tds-item-actions >* {\n\t\tcursor: pointer;\n\t\tmargin-right: 5px;\n\t}\n\n\t.esgst-cdr-highlight {\n\t\tcolor: #ff0000;\n\t\tfont-weight: bold;\n\t}\n\n\t.esgst-logs-error i {\n\t\tcolor: #d9534f;\n\t}\n\n\t.esgst-log-error {\n\t\tbackground-color: #d9534f;\n\t\tcolor: #ffffff;\n\t\ttext-shadow: none;\n\t}\n\n\t.esgst-logs-warning i {\n\t\tcolor: #f0ad4e;\n\t}\n\n\t.esgst-log-warning {\n\t\tbackground-color: #f0ad4e;\n\t\tcolor: #ffffff;\n\t\ttext-shadow: none;\n\t}\n\n\t#esgst_permissions .esgst-ugd-table {\n\t\tmin-width: unset;\n\t}\n\n\t.tour-backdrop {\n\t\topacity: 0.5;\n\t\tz-index: 9999991100;\n\t}\n\n\t.tour-prevent {\n\t\tbackground: none;\n\t\topacity: 0;\n\t\tz-index: 9999991102;\n\t}\n\n\t.popover[class*="tour-"] {\n\t\tcolor: #000;\n\t\tz-index: 9999991110;\n\t}\n\n\t.giveaway__links .esgst-button {\n\t\tbackground: none;\n\t\tborder: none;\n\t\tfont: inherit;\n\t\tmargin: 0;\n\t\tpadding: 0;\n\t}\n\n\t.giveaway__links .esgst-button:hover, .giveaway__links .esgst-button:active {\n\t\tbackground: none;\n\t\tborder: none;\n\t\tbox-shadow: none;\n\t\ttext-shadow: none;\n\t}\n\n\t.esgst-restore-entry {\n\t\tdisplay: flex;\n\t\tjustify-content: space-between;\n\t}\n\n\t.esgst-restore-entry >* {\n\t\tmargin: 0 5px 0;\n\t}\n\n\t.esgst-gv-popout .esgst-panel-flexbox {\n\t\tflex-direction: column;\n\t}\n\n\t.esgst-gv-popout .esgst-panel-flexbox .esgst-giveaway-panel {\n\t\ttext-align: center;\n\t}\n\n\t.esgst-panel-flexbox {\n\t\tdisplay: flex;\n\t\tjustify-content: space-between;\n\t}\n\n\t.esgst-panel-flexbox .esgst-giveaway-panel {\n\t\talign-items: center;\n\t\ttext-align: right;\n\t}\n\n\t.esgst-panel-flexbox .esgst-giveaway-links >* {\n\t\twhite-space: nowrap;\n\t}\n\n\t.esgst-gesl >* {\n\t\tmargin-right: 5px;\n\t}\n\n\t.esgst-scb input {\n\t\tmin-width: 0;\n\t}\n\n\t.esgst-scb i.fa-times {\n\t\tcursor: pointer;\n\t\tmargin-left: 5px;\n\t}\n\n\t.page__heading .esgst-button-container,  .page_heading .esgst-button-container, .esgst-page-heading .esgst-button-container {\n\t\tborder: none;\n\t\tline-height: inherit;\n\t\tpadding: 0;\n\t\ttext-shadow: none;\n\t}\n\n\t.page__heading__button.esgst-button, .page_heading_btn.esgst-button {\n\t\tborder: 1px solid #d2d6e0;\n\t\tborder-radius: 4px;\n\t\tcolor: #4b72d4;\n\t\tcursor: pointer;\n\t\tdisplay: block;\n\t\tfont: 700 14px / 22px "Open Sans", sans-serif;\n\t\tpadding: 5px 10px;\n\t}\n\n\t.page__heading__button.esgst-button i, .page_heading_btn.esgst-button i {\n\t\tmargin: 0;\n\t}\n\n\t.esgst-element-ordering-box {\n\t\tborder: 2px solid #ccc;\n\t\tborder-radius: 5px;\n\t\tpadding: 5px;\n\t}\n\n\t.esgst-element-ordering-box >* {\n\t\tborder: 1px solid #ccc;\n\t\tborder-radius: 5px;\n\t\tcursor: move;\n\t\tdisplay: inline-block;\n\t\tmargin: 5px;\n\t\tpadding: 5px;\n\t}\n\n\t.esgst-page-heading-buttons {\n\t\tbackground: none;\n\t\tborder: none;\n\t\tmargin: 0 !important;\n\t\tpadding: 0;\n\t}\n\n\t\t.esgst-page-heading-buttons >* {\n\t\tmargin-right: 5px;\n\t}\n\n\t.esgst-inline-list >*:not(:last-child) {\n\t\tmargin-right: 15px;\n\t}\n\n\t.form_list_item_summary_name {\n\t\tdisplay: inline-block;\n\t}\n\n\t.esgst-tag-suggestions {\n\t\tbackground-color: #fff;\n\t\tborder: 1px solid #ccc;\n\t\tborder-radius: 5px;\n\t\tmax-height: 200px;\n\t\toverflow: auto;\n\t\tposition: absolute;\n\t\twidth: 300px;\n\t}\n\n\t.esgst-tag-suggestion {\n\t\tcursor: pointer;\n\t\tfont-weight: bold;\n\t\tpadding: 5px;\n\t\ttext-shadow: none;\n\t}\n\n\t.esgst-tag-suggestion:not(:last-child) {\n\t\tborder-bottom: 1px solid #ccc;\n\t}\n\n\t.esgst-tag-suggestion.esgst-selected {\n\t\tbackground-color: #465670;\n\t\tcolor: #fff;\n\t}\n\n\t.table__row-inner-wrap .esgst-heading-button, .table__row-inner-wrap .esgst-ct-count, .table__row-inner-wrap .esgst-gdttt-button, .table__row-inner-wrap .esgst-tds-button, .row_trade_comments .esgst-heading-button, .row_trade_comments .esgst-ct-count, .row_trade_comments .esgst-gdttt-button, .row_trade_comments .esgst-tds-button {\n\t\tmargin-left: 3px !important;\n\t}\n\n\t.esgst-gc-panel >*, .esgst-toggle-switch {\n\t\tmargin-right: 3px !important;\n\t}\n\n\t.esgst-ugd-input {\n\t\tbackground-color: inherit !important;\n\t\tborder-color: inherit !important;\n\t\tcolor: inherit;\n\t\tdisplay: inline-block;\n\t\tmargin: 0 5px;\n\t\tpadding: 0 2px !important;\n\t\twidth: 50px;\n\t}\n\n\t.esgst-hwlc-panel {\n\t\tdisplay: flex;\n\t\tjustify-items: space-between;\n\t}\n\n\t.esgst-hwlc-section {\n\t\tmargin: 25px;\n\t\twidth: 300px;\n\t}\n\n\t.esgst-hwlc-section textarea {\n\t\tmin-height: 200px;\n\t}\n\n\t@keyframes border-blink {\n\t\t50% {\n\t\t\tborder-color: transparent;\n\t\t}\n\t}\n\n\t.esgst-minimize-panel {\n\t\tleft: -198px;\n\t\tposition: fixed;\n\t\ttop: 0;\n\t\twidth: 200px;\n\t\tz-index: 999999999;\n\t}\n\n\t.esgst-minimize-panel:hover {\n\t\tpadding-left: 198px;\n\t}\n\n\t.esgst-minimize-container {\n\t\tbackground-color: #fff;\n\t\theight: 100vh;\n\t\toverflow-y: auto;\n\t\tpadding: 5px;\n\t\twidth: 188px;\n\t}\n\n\t.esgst-minimize-panel.alert {\n\t\tanimation: border-blink 1s ease-in-out infinite;\n\t\tborder-right: 10px solid #ff0000;\n\t\tleft: -200px;\n\t}\n\n\t.esgst-minimize-panel.alert:hover {\n\t\tborder: none;\n\t\tleft: -198px;\n\t}\n\n\t.esgst-minimize-item.alert {\n\t\tanimation: border-blink 1s ease-in-out infinite;\n\t\tborder: 2px solid #ff0000;\n\t}\n\n\t:root {\n\t\t--esgst-body-bg-color: ${c.esgst.sg?"#f0f2f5":"#ebedf0"};\n\t}\n\n\t.sticky_sentinel {\n\t\tleft: 0;\n\t\tposition: absolute;\n\t\tright: 0;\n\t\tvisibility: hidden;\n\t}\n\n\t.esgst-gf-basic-filters {\n\t\tdisplay: flex;\n\t\tjustify-content: space-between;\n\t}\n\n\t.esgst-gf-basic-filters input {\n\t\tdisplay: inline-block;\n\t\tpadding: 2px;\n\t\twidth: 100px;\n\t}\n\n\t.esgst-gf-basic-filters >* {\n\t\tmargin: 5px;\n\t}\n\n\t.esgst-gf-number-filters {\n\t\tflex: 1;\n\t}\n\n\t.esgst-gf-number-filters >*, .esgst-gf-string-filters >* {\n\t\talign-items: center;\n\t\tdisplay: flex;\n\t\tjustify-content: space-between;\n\t}\n\n\t.esgst-gf-boolean-filters {\n\t\tcolumn-count: 2;\n\t\tflex: 1;\n\t}\n\n\t.esgst-gf-basic-filters + div {\n\t\tfont-size: 14px;\n\t\tfont-weight: bold;\n\t}\n\n\t.esgst-gf-legend-panel {\n\t\tdisplay: block;\n\t\tfloat: right;\n\t\ttext-align: right;\n\t\tmargin-top: 50px;\n\t}\n\n\t.esgst-ns, .esgst-ns * {\n\t\tmax-width: 206px;\n\t}\n\n\t.esgst-clear-container {\n\t\tdisplay: flex;\n\t}\n\n\t.esgst-clear-button {\n\t\talign-self: center;\n\t\tcursor: pointer;\n\t\tpadding: 5px 10px;\n\t}\n\n\t.esgst-draggable-trash {\n\t\tbackground-color: #C11B17;\n\t\tborder-radius: 5px;\n\t\tcolor: #E77471;\n\t\tposition: absolute;\n\t\ttext-align: center;\n\t\ttext-shadow: none;\n\t}\n\n\t.esgst-draggable-trash i {\n\t\tfont-size: 25px;\n\t\tmargin: 5px;\n\t}\n\n\t.esgst-qiv-new {\n\t\tfloat: right;\n\t\tfont-weight: bold;\n\t\tmargin-right: 10px;\n\t}\n\n\t.esgst-mm-checkbox {\n\t\tdisplay: inline-block;\n\t\tmargin-right: 5px;\n\t}\n\n\t.esgst-mm-checkbox i {\n\t\tmargin: 0;\n\t}\n\n\t.esgst-mm-popout {\n\t\twidth: 550px;\n\t}\n\n\t.esgst-textarea-large {\n\t\theight: 400px !important;\n\t\toverflow-y: auto !important;\n\t}\n\n\t.esgst-mm-popout textarea, .esgst-textarea-small {\n\t\theight: 150px !important;\n\t\toverflow-y: auto !important;\n\t}\n\n\t.esgst-mm-button-group {\n\t\talign-items: center;\n\t\tdisplay: flex;\n\t}\n\n\t.esgst-mm-button-group .esgst-button-container {\n\t\tdisplay: inline-flex;\n\t}\n\n\t.esgst-mm-button-group .esgst-button {\n\t\tflex: 1;\n\t\tline-height: 25px;\n\t\tmargin: 2px;\n\t\tpadding-bottom: 0;\n\t\tpadding-top: 0;\n\t}\n\n\t.esgst-mm-headings {\n\t\tdisplay: flex;\n\t\tfont-size: 0;\n\t}\n\n\t.esgst-mm-headings >* {\n\t\tbackground-color: #eee;\n\t\tborder: 1px solid #ccc;\n\t\tcursor: pointer;\n\t\tflex: 1;\n\t\tfont-size: 12px;\n\t\tfont-weight: bold;\n\t\tpadding: 5px;\n\t\twidth: 150px;\n\t}\n\n\t.esgst-mm-headings .esgst-selected {\n\t\tbackground-color: #fff;\n\t\tborder-bottom: 0;\n\t}\n\n\t.esgst-mm-sections {\n\t\tborder-bottom: 1px solid #ccc;\n\t\tborder-left: 1px solid #ccc;\n\t\tborder-right: 1px solid #ccc;\n\t\tpadding: 5px;\n\t}\n\n\t.esgst-mm-sections >* {\n\t\tdisplay: none;\n\t}\n\n\t.esgst-mm-sections .esgst-selected {\n\t\tdisplay: block;\n\t}\n\n\t.esgst-rotate-90 {\n\t\ttransform: rotate(90deg);\n\t}\n\n\t.esgst-rotate-270 {\n\t\ttransform: rotate(270deg);\n\t}\n\n\t.esgst-chfl-compact {\n\t\tpadding: 8px 15px !important;\n\t}\n\n\t.footer__outer-wrap .esgst-chfl-panel, footer .esgst-chfl-panel {\n\t\tposition: static !important;\n\t}\n\n\t.esgst-chfl-panel {\n\t\tposition: absolute;\n\t\tright: 10px;\n\t}\n\n\t.esgst-chfl-panel i {\n\t\tbackground-color: #fff;\n\t\tborder: 1px solid #ccc;\n\t\tborder-radius: 5px;\n\t\tcolor: #555 !important;\n\t\tcursor: pointer;\n\t\tfont-size: 18px !important;\n\t\tmargin: 0 !important;\n\t\tpadding: 5px;\n\t\twidth: auto !important;\n\t}\n\n\t.esgst-chfl-small i {\n\t\tfont-size: 18px !important;\n\t\twidth: 36px;\n\t}\n\n\t.esgst-mgc-table * {\n\t\ttext-align: left;\n\t}\n\n\t.esgst-ochgb {\n\t\tdisplay: inline-block;\n\t}\n\n\t.featured__heading .esgst-ochgb i, .featured__heading .esgst-gf-hide-button i, .featured__heading .esgst-gf-unhide-button i, .featured__heading .esgst-gb-button i {\n\t\topacity: .6;\n\t\ttransition: opacity .2s;\n\t}\n\n\t.featured__heading .esgst-ochgb i:hover, .featured__heading .esgst-gf-hide-button i:hover, .featured__heading .esgst-gf-unhide-button i:hover, .featured__heading .esgst-gb-button i:hover {\n\t\topacity: 1;\n\t}\n\n\t@keyframes esgst-blinker {\n\t\t50% { opacity: 0; }\n\t}\n\n\t.esgst-blinking {\n\t\tanimation: esgst-blinker 1s linear infinite;\n\t}\n\n\t.esgst-qiv-popout {\n\t\tmax-height: 600px !important;\n\t\toverflow: hidden !important;\n\t\twidth: 600px;\n\t}\n\n\t.esgst-qiv-comments {\n\t\toverflow-y: auto;\n\t}\n\n\t.esgst-elgb-button .sidebar__error {\n\t\tmargin-bottom: 0;\n\t}\n\n\t.esgst-mgc-preview {\n\t\tborder: 1px solid #ccc;\n\t\tpadding: 25px;\n\t\twidth: 600px;\n\t}\n\n\t.esgst-mgc-input {\n\t\tdisplay: inline-block;\n\t\ttext-align: center;\n\t\twidth: 75px;\n\t}\n\n\t.esgst-relative {\n\t\tposition: relative;\n\t}\n\n\t.esgst-nm-icon {\n\t\tcolor: #ff0000 !important;\n\t}\n\n\t.esgst-disabled {\n\t\tcursor: default !important;\n\t\topacity: 0.5;\n\t}\n\n\t.esgst-changelog img {\n\t\tmax-width: 98%;\n\t}\n\n\t.esgst-radb-button {\n\t\tcursor: pointer;\n\t\tdisplay: inline-block;\n\t}\n\n\t.esgst-radb-button.block_header {\n\t\tfloat: right;\n\t\tline-height: 33px;\n\t\tmargin: 0 0 0 5px;\n\t}\n\n\t.esgst-radb-button.block_header > i {\n\t\tcolor: #bbb;\n\t}\n\n\t:not(.page__heading) > .esgst-radb-button:not(.block_header) {\n\t\tmargin-left: 5px;\n\t}\n\n\t.esgst-cfh-preview {\n\t\tmargin: 5px 0;\n\t\ttext-align: left;\n\t}\n\n\t.esgst-qgs-container i {\n\t\tcolor: #AAB5C6;\n\t}\n\n\t.esgst-qgs-container {\n\t\talign-items: center;\n\t\tbackground-color: #fff;\n\t\tborder-color: #c5cad7 #dee0e8 #dee0e8 #d2d4e0;\n\t\tborder-radius: 4px;\n\t\tborder-style: solid;\n\t\tborder-width: 1px;\n\t\tdisplay: flex;\n\t\tmargin-right: 5px;\n\t\tpadding: 5px 10px;\n\t}\n\n\t.esgst-qgs-container-expanded {\n\t\tposition: ${"0"===d.get("qgs_index")?"absolute":"static"};\n\t}\n\n\t.esgst-qgs-container-expanded .esgst-qgs-input {\n\t\twidth: 300px;\n\t}\n\n\t.esgst-qgs-container-expanded + .nav__button-container {\n\t\tmargin-left: 40px;\n\t}\n\n\t.esgst-qgs-input {\n\t\tborder: 0 !important;\n\t\theight: 100%;\n\t\tline-height: normal !important;\n\t\tpadding: 0 !important;\n\t\twidth: 0;\n\t}\n\n\t.esgst-sgc-results .table__row-outer-wrap {\n\t\tpadding: 10px 5px;\n\t}\n\n\t.esgst-glwc-results {\n\t\tdisplay: flex;\n\t}\n\n\t.esgst-glwc-results >* {\n\t\tflex: 1;\n\t\tmargin: 10px;\n\t}\n\n\t.esgst-glwc-heading {\n\t\tfont-family: "Open Sans";\n\t\tfont-size: 25px;\n\t\tmargin: 5px;\n\t\ttext-align: center;\n\t}\n\n\t.esgst-stbb-button, .esgst-sttb-button {\n\t\tcursor: pointer;\n\t}\n\n\t.esgst-stbb-button-fixed, .esgst-sttb-button-fixed {\n\t\tbottom: ${d.get("ff")?49:5}px;\n\t\tbackground-color: #fff;\n\t\tborder: 1px solid #d2d6e0;\n\t\tborder-radius: 4px;\n\t\tcolor: #4B72D4;\n\t\tpadding: 5px 15px;\n\t\tposition: fixed;\n\t\tright: 5px;\n\t}\n\n\t.esgst-stbb-button:not(.esgst-hidden) + .esgst-sttb-button {\n\t\tbottom: 79px;\n\t}\n\n\t.esgst-bold {\n\t\tfont-weight: bold;\n\t}\n\n\t.esgst-italic {\n\t\tfont-style: italic;\n\t}\n\n\t.esgst-es-page-divider {\n\t\tmargin: 5px 0;\n\t}\n\n\t.comment__parent .esgst-cerb-reply-button, .comment__child .esgst-cerb-reply-button {\n\t\tmargin-top: 54px;\n\t\tposition: absolute;\n\t\ttext-align: center;\n\t\twidth: 44px;\n\t}\n\n\t.comment_outer .esgst-cerb-reply-button, .comment_inner .esgst-cerb-reply-button {\n\t\tmargin-left: 21px;\n\t\tmargin-top: 34px;\n\t\tposition: absolute;\n\t\ttext-align: center;\n\t\twidth: 24px;\n\t}\n\n\t.esgst-page-heading {\n\t\tdisplay: flex;\n\t\talign-items: flex-start;\n\t\tword-wrap: break-word;\n\t}\n\n\t.esgst-page-heading >* {\n\t\tbackground-image: linear-gradient(#fff 0%, rgba(255,255,255,0.4) 100%);\n\t\tdisplay: flex;\n\t\tpadding: 5px 10px;\n\t\tborder: 1px solid #d2d6e0;\n\t\tborder-radius: 4px;\n\t\tcolor: #4B72D4;\n\t\tfont: 700 14px/22px "Open Sans", sans-serif;\n\t}\n\n\t.esgst-page-heading i {\n\t\tline-height: 22px;\n\t}\n\n\t.esgst-page-heading >*:not(.page__heading__breadcrumbs) {\n\t\talign-items: center;\n\t}\n\n\t.esgst-page-heading >*:not(:last-child) {\n\t\tmargin-right: 5px;\n\t}\n\n\t.esgst-form-row {\n\t\tmargin-bottom: 20px;\n\t}\n\n\t.esgst-form-row:first-of-type {\n\t\tmargin-top: 14px;\n\t}\n\n\t.esgst-form-heading {\n\t\talign-items: center;\n\t\tdisplay: flex;\n\t\tmargin-bottom: 5px;\n\t}\n\n\t.esgst-form-heading > div:not(:last-child) {\n\t\tmargin-right: 10px;\n\t}\n\n\t.esgst-form-heading-number {\n\t\tfont: 300 14px "Open Sans", sans-serif;\n\t\tcolor:#6b7a8c;\n\t}\n\n\t.esgst-form-heading-text {\n\t\tfont: 700 14px "Open Sans", sans-serif;\n\t\tcolor: #4B72D4;\n\t}\n\n\t.esgst-form-row-indent {\n\t\tpadding: 3px 0 3px 20px;\n\t\tmargin-left: 5px;\n\t\tborder-left: 1px solid #d2d6e0;\n\t\tbox-shadow: 1px 0 0 rgba(255,255,255,0.3) inset;\n\t}\n\n\t.esgst-form-sync {\n\t\tdisplay: flex;\n\t}\n\n\t.esgst-form-sync-data {\n\t\tflex: 1;\n\t}\n\n\t.esgst-notification {\n\t\tborder: 1px solid;\n\t\tborder-radius: 4px;\n\t\tpadding: 0 15px;\n\t\tfont-size: 11px;\n\t\tline-height: 32px;\n\t\toverflow: hidden;\n\t}\n\n\t.esgst-notification a {\n\t\ttext-decoration: underline;\n\t}\n\n\t.esgst-notification-success {\n\t\tbackground-image: linear-gradient(#f7fcf2 0%, #e7f6da 100%);\n\t\tborder-color: #C5E9A5;\n\t\tcolor:#8fa47b;\n\t}\n\n\t.esgst-notification-warning {\n\t\tbackground-image: linear-gradient(#F6F6E6 0px, #F5F5DF 20px);\n\t\tborder-color: #EDE5B2;\n\t\tcolor: #a59d7c;\n\t}\n\n\t.esgst-user-icon {\n\t\tdisplay: inline-block;\n\t\tline-height: normal;\n\t\tmargin: 0 5px 0 0;\n\t}\n\n\t.esgst-user-icon i {\n\t\tborder: 0;\n\t\tline-height: normal;\n\t\tmargin: 0;\n\t\ttext-shadow: none !important;\n\t}\n\n\t.esgst-whitelist {\n\t\tcolor: #556da9 !important;\n\t}\n\n\t.esgst-blacklist {\n\t\tcolor: #a95570 !important;\n\t}\n\n\t.esgst-positive {\n\t\tcolor: #96c468 !important;\n\t}\n\n\t.esgst-negative {\n\t\tcolor: #ec8583 !important;\n\t}\n\n\t.esgst-unknown {\n\t\tcolor: #77899a !important;\n\t}\n\n\t.esgst-ugd-table .table__rows .table__row-outer-wrap:hover {\n\t\tbackground-color: rgba(119, 137, 154, 0.1);\n\t}\n\n\t.esgst-ugd-table .table__column--width-small {\n\t\tmin-width: 0;\n\t\twidth: 12%;\n\t}\n\n\t.markdown {\n\t\tword-break: break-word;\n\t}\n\n\t.esgst-busy >* {\n\t\topacity: 0.2;\n\t}\n\n\t.comment__actions .esgst-rml-link {\n\t\tmargin: 0 0 0 10px;\n\t}\n\n\t.esgst-settings-menu .form__sync-default {\n\t\tmargin: 0 5px;\n\t}\n\n\t.esgst-uh-popup a {\n\t\tborder-bottom: 1px dotted;\n\t}\n\n\t.esgst-auto-sync {\n\t\tdisplay: inline-block;\n\t\tmargin: 0 5px 2px;\n\t\tpadding: 0 2px;\n\t\twidth: 50px;\n\t}\n\n\t.esgst-ap-popout .featured__table__row__left:not(.esgst-uh-title), .esgst-mr-reply, .esgst-mr-edit, .esgst-mr-delete, .esgst-mr-undelete {\n\t\tmargin: 0 10px 0 0;\n\t}\n\n\t.esgst-ugd-button {\n\t\tcursor: pointer;\n\t\tdisplay: inline-block;\n\t}\n\n\t.esgst-cfh-popout {\n\t\tfont: 700 12px "Open Sans", sans-serif;\n\t}\n\n\t.esgst-cfh-panel span >:first-child >* {\n\t\tmargin: 0 !important;\n\t}\n\n\t.esgst-cfh-popout input {\n\t\twidth: auto;\n\t}\n\n\t.esgst-namwc-highlight {\n\t\tfont-weight: bold;\n\t}\n\n\t.esgst-iwh-icon {\n\t\tmargin: 0 0 0 5px;\n\t}\n\n\t.esgst-ap-suspended >* {\n\t\tcolor: #e9202a;\n\t}\n\n\t.esgst-ap-popout {\n\t\tborder: none !important;\n\t\tborder-radius: 5px;\n\t\tbox-shadow: 0 0 10px 2px hsla(0, 0%, 0%, 0.8);\n\t\tmin-width: 400px;\n\t\tpadding: 0 !important;\n\t\ttext-shadow: none;\n\t}\n\n\t.ui-tooltip {\n\t\tz-index: 99999;\n\t}\n\n\t.esgst-ap-popout .featured__outer-wrap:not(.esgst-uh-box) {\n\t\tborder-radius: 5px;\n\t\tpadding: 5px;\n\t\twidth: auto;\n\t\twhite-space: normal;\n\t}\n\n\t.esgst-ap-popout .featured__inner-wrap {\n\t\talign-items: flex-start;\n\t\tpadding: 0 5px 0 0;\n\t}\n\n\t.esgst-ap-popout .featured__heading {\n\t\tmargin: 0;\n\t}\n\n\t.esgst-ap-popout .featured__heading__medium {\n\t\tfont-size: 18px;\n\t}\n\n\t.esgst-ap-link {\n\t\twidth: 100px;\n\t}\n\n\t.esgst-ap-link .global__image-outer-wrap--avatar-large {\n\t\tbox-sizing: content-box !important;\n\t\theight: 64px !important;\n\t\tmargin: 5px;\n\t\twidth: 64px !important;\n\t}\n\n\t.esgst-ap-popout .global__image-outer-wrap--avatar-large:hover {\n\t\tbackground-color: hsla(0, 0%, 25%, 0.2) !important;\n\t}\n\n\t.esgst-ap-link .global__image-inner-wrap {\n\t\tbackground-size: cover !important;\n\t}\n\n\t.esgst-ap-popout .sidebar__shortcut-outer-wrap {\n\t\tmargin: 10px 0;\n\t}\n\n\t.esgst-ap-popout .sidebar__shortcut-inner-wrap i {\n\t\theight: 18px;\n\t\tfont-size: 12px;\n\t}\n\n\t.esgst-ap-popout .sidebar__shortcut-inner-wrap * {\n\t\tline-height: 18px;\n\t\tvertical-align: middle;\n\t}\n\n\t.esgst-ap-popout .sidebar__shortcut-inner-wrap img {\n\t\theight: 16px;\n\t\tvertical-align: baseline !important;\n\t\twidth: 16px;\n\t}\n\n\t.esgst-ap-popout .featured__table {\n\t\tdisplay: inline-block;\n\t\twidth: 100%;\n\t}\n\n\t.esgst-ap-popout .featured__table__row {\n\t\tpadding: 2px;\n\t}\n\n\t.esgst-ap-popout .featured__table__row:nth-child(n + 3) {\n\t\tmargin-left: -95px;\n\t}\n\n\t.esgst-ap-popout .featured__table__row:last-of-type .featured__table__row__right * {\n\t\tfont-size: 11px;\n\t}\n\n\t.esgst-ct-comment-button {\n\t\tcursor: pointer;\n\t}\n\n\t.popup__keys__list .esgst-ggl-member, .esgst-dh-highlighted, .esgst-dh-highlighted.table__row-outer-wrap, .esgst-idb-highlight, .esgst-idb-highlight.table__row-outer-wrap {\n\t\tbackground-color: rgba(150, 196, 104, 0.2) !important;\n\t\tpadding: 5px !important;\n\t}\n\n\t.esgst-error-button, .esgst-error-button >*:hover {\n\t\tbackground-color: rgba(236, 133, 131, 0.8) !important;\n\t\tbackground-image: none !important;\n\t}\n\n\t.esgst-gb-highlighted.ending i {\n\t\tcolor: rgba(236, 133, 131, 0.8) !important;\n\t}\n\n\t.esgst-gb-highlighted.started i {\n\t\tcolor: rgba(150, 196, 104, 0.8) !important;\n\t}\n\n\t.esgst-gb-highlighted.ending.started i {\n\t\tcolor: rgba(193, 165, 118, 0.8) !important;\n\t}\n\n\t.esgst-ct-visited {\n\t\topacity: 0.5;\n\t}\n\n\t.esgst-ct-visited:hover {\n\t\topacity: 1;\n\t}\n\n\t.esgst-ct-comment-read {\n\t\topacity: 0.5;\n\t}\n\n\t.esgst-ct-comment-read:hover {\n\t\topacity: 1;\n\t}\n\n\t.esgst-ct-comment-read:hover, .esgst-ct-visited:hover {\n\t\tbackground-color: rgba(119, 137, 154, 0.1) !important;\n\t}\n\n\t.esgst-gf-hide-button, .esgst-gf-unhide-button, .esgst-gb-button, .esgst-gdttt-button, .esgst-tds-button {\n\t\tcursor: pointer;\n\t\tdisplay: inline-block;\n\t\tmargin: 0 5px 0 0;\n\t}\n\n\t.esgst-codb-button, .esgst-dh-button, .esgst-idb-button, .esgst-df-button {\n\t\tdisplay: inline-block;\n\t\tmargin: 0 5px 0 0;\n\t\tpadding: 0;\n\t}\n\n\t.page__heading .esgst-codb-button >*, .page__heading .esgst-dh-button >*, .page__heading .esgst-idb-button >*, .page__heading .esgst-df-button >* {\n\t\tpadding: 5px 10px;\n\t}\n\n\t.esgst-pm-button {\n\t\tmargin-left: -17px;\n\t\tposition: absolute;\n\t\ttop: calc(50% - 7px);\n\t}\n\n\t.esgst-dh-highlighted .esgst-pm-button, .esgst-idb-highlight .esgst-pm-button {\n\t\tmargin-left: -22px;\n\t}\n\n\t.page__heading .esgst-pm-button {\n\t\tdisplay: inline-block;\n\t\tmargin: 0 5px 0 0;\n\t\tpadding: 0;\n\t\tposition: static;\n\t}\n\n\t.page__heading .esgst-pm-button >* {\n\t\tpadding: 5px 10px;\n\t}\n\n\t.esgst-adots .esgst-pm-button {\n\t\tmargin-left: -58px;\n\t}\n\n\t.comment__actions .esgst-ct-comment-button {\n\t\tmargin: 0 0 0 10px;\n\t}\n\n\t.comment__actions >:first-child + .esgst-ct-comment-button {\n\t\tmargin: 0;\n\t}\n\n\t.esgst-ct-comment-button >:not(:last-child) {\n\t\tmargin: 0 10px 0 0;\n\t}\n\n\t.esgst-cfh-panel {\n\t\tmargin: 0 0 2px;\n\t\tposition: sticky;\n\t\ttext-align: left;\n\t}\n\n\t.esgst-cfh-panel >* {\n\t\tbackground-color: #fff;\n\t\tborder: 1px solid #ccc;\n\t\tborder-radius: 5px;\n\t\tcursor: pointer;\n\t\tdisplay: inline-block;\n\t\tmargin: 1px;\n\t\topacity: 0.5;\n\t\tpadding: 5px;\n\t}\n\n\t.esgst-cfh-panel >*:hover {\n\t\topacity: 1;\n\t}\n\n\t.esgst-cfh-panel span >:not(:first-child), .esgst-ded-status {\n\t\tdisplay: block;\n\t}\n\n\t.esgst-cfh-panel span i {\n\t\tline-height: 22px;\n\t}\n\n\t.esgst-cfh-panel .form__saving-button {\n\t\tdisplay: inline-block;\n\t\tmargin: 5px;\n\t\tmin-width:0;\n\t}\n\n\t.esgst-cfh-panel table {\n\t\tdisplay: block;\n\t\tmax-height: 200px;\n\t\tmax-width: 375px;\n\t\toverflow: auto;\n\t}\n\n\t.esgst-cfh-panel table td:first-child {\n\t\tmin-width: 25px;\n\t\ttext-align: center;\n\t}\n\n\t.esgst-cfh-panel table td:not(:first-child) {\n\t\tmin-width: 75px;\n\t\ttext-align: center;\n\t}\n\n\t.esgst-cfh-emojis {\n\t\tdisplay: block !important;\n\t\tfont-size: 18px;\n\t\tmax-height: 200px;\n\t\tmin-height: 30px;\n\t\toverflow: auto;\n\t\ttext-align: center;\n\t}\n\n\t.esgst-cfh-emojis >* {\n\t\tcursor: pointer;\n\t\tdisplay: inline-block;\n\t\tmargin: 2px;\n\t}\n\n\t.esgst-cfh-popout {\n\t\twhite-space: normal;\n\t\twidth: 300px;\n\t}\n\n\t.esgst-mpp-popup {\n\t\tposition: fixed !important;\n\t}\n\n\t.esgst-mpp-visible {\n\t\tpadding: 0;\n\t}\n\n\t.esgst-mpp-hidden {\n\t\tdisplay: none;\n\t\tmax-height: 75%;\n\t\toverflow: auto;\n\t\tpadding: 15px;\n\t\tposition: absolute;\n\t\twidth: 75%;\n\t}\n\n\t.esgst-ueg {\n\t\topacity: 1 !important;\n\t}\n\n\t.esgst-fh {\n\t\theight: auto !important;\n\t\tposition: sticky;\n\t\ttop: 0;\n\t\tz-index: 1000 !important;\n\t}\n\n\t.esgst-fs {\n\t\toverflow-y: auto;\n\t\tposition: sticky;\n\t}\n\n\t.esgst-fs .sidebar__mpu {\n\t\tdisplay: none !important;\n\t}\n\n\t.esgst-fmph {\n\t\tbackground-color: var(--esgst-body-bg-color);\n\t\tpadding: 5px 0;\n\t\tposition: sticky;\n\t\tz-index: 998;\n\t}\n\n\t.esgst-ff {\n\t\tbackground-color: inherit;\n\t\tbottom: 0;\n\t\tpadding: 0;\n\t\tposition: sticky;\n\t\tz-index: 999;\n\t}\n\n\t.esgst-ff.esgst-thin .footer_upper, .esgst-ff.esgst-thin .footer_columns {\n\t\tdisplay: none;\n\t}\n\n\t.esgst-ff.esgst-thin .footer_lower, .esgst-ff.esgst-thin .footer_lower .footer_inner_wrap {\n\t\tborder-top: none;\n\t\tbox-shadow: none;\n\t\tpadding: 12px 25px;\n\t}\n\n\t.esgst-ff.esgst-thin .footer_upper + .footer_lower .footer_inner_wrap {\n\t\tpadding: 0px;\n\t}\n\n\tfooter .footer_sites {\n\t\tgap: 15px;\n\t}\n\n\t.esgst-sgac-button, .esgst-sgg-button {\n\t\tmargin: 0 5px 0 0;\n\t}\n\n\t.esgst-ct-count {\n\t\tcolor: #e9202a;\n\t\tfont-weight: bold;\n\t}\n\n\t.esgst-uh-box {\n\t\tbackground: linear-gradient(to bottom, #555, #222);\n\t\tborder: 1px solid #888;\n\t\tmargin: 5px 0 0;\n\t\tpadding: 15px;\n\t\tposition: absolute;\n\t\ttext-align: center;\n\t}\n\n\t.esgst-uh-title {\n\t\tcolor: rgba(255, 255, 255, 0.6);\n\t\tfont-weight: bold;\n\t\tmargin: 0 0 15px;\n\t}\n\n\t.esgst-uh-list {\n\t\tcolor: rgba(255, 255, 255, 0.4);\n\t}\n\n\t.esgst-ugd-button, .esgst-wbc-button, .esgst-namwc-button, .esgst-nrf-button {\n\t\tcursor: pointer;\n\t\tmargin: 0 0 0 5px;\n\t}\n\n\t.esgst-luc-value {\n\t\tmargin: 0 0 0 5px;\n\t}\n\n\t.esgst-sgpb-container {\n\t\tdisplay: flex;\n\t}\n\n\t.esgst-sgpb-container >* {\n\t\tflex: 1;\n\t}\n\n\t.esgst-sgpb-button {\n\t\tbackground-image: linear-gradient(rgba(255, 255, 255, 0.8) 0%, rgba(255, 255, 255, 0.3) 100%);\n\t\tborder-color: #dde2ea #cdd4df #cbd1dc #d6dbe7;\n\t\tcolor: #6e7585;\n\t\ttext-shadow: 1px 1px 1px #fff;\n\t\ttransition: opacity 0.5s;\n\t\tborder-radius: 3px;\n\t\tfont: 700 13px 'Open Sans', sans-serif;\n\t\tmargin: 0 0 0 5px;\n\t\tpadding: 7px 15px;\n\t\tdisplay: flex;\n\t\talign-items: center;\n\t\tborder-width: 1px;\n\t\tborder-style: solid;\n\t\ttext-decoration: none;\n\t}\n\n\t.esgst-sgpb-button:active {\n\t\tbackground-image: linear-gradient(#e1e7eb 0%, #e6ebf0 50%, #ebeff2 100%) !important;\n\t\tbox-shadow: 2px 2px 5px #ccd4db inset;\n\t\ttext-shadow: 1px 1px 1px rgba(255, 255, 255, 0.6);\n\t\tmargin: 2px 0 0 7px !important;\n\t\tborder: 0;\n\t}\n\n\t.esgst-sgpb-button:hover {\n\t\tbackground-image: linear-gradient(rgba(255, 255, 255, 1) 0%, rgba(255, 255, 255, 0.3) 100%);\n\t}\n\n\t.esgst-sgpb-button i {\n\t\theight: 14px;\n\t\tmargin: 0 10px 0;\n\t\twidth: 14px;\n\t}\n\n\t.esgst-sgpb-button img {\n\t\theight: 14px;\n\t\tvertical-align: baseline;\n\t\twidth: 14px;\n\t}\n\n\t.esgst-stpb-button img {\n\t\tvertical-align: top;\n\t}\n\n\t.esgst-gh-highlight, .esgst-green-highlight {\n\t\tbackground-color: rgba(150, 196, 104, 0.2);\n\t}\n\n\t.esgst-pgb-button, .esgst-gf-button {\n\t\tborder: 1px solid #d2d6e0;\n\t\tborder-top: none;\n\t\tbackground-color: #e1e6ef;\n\t\tbackground-image: linear-gradient(rgba(255, 255, 255, 0.15) 0%, rgba(255, 255, 255, 0) 100%);color: #6b7a8c;\n\t\tcursor: pointer;\n\t\tmargin-bottom: 15px;\n\t\tpadding: 3px;\n\t\ttext-align: center;\n\t\tborder-radius: 0 0 4px 4px;\n\t}\n\n\t.esgst-gf-button {\n\t\tmargin-bottom: 0 !important;\n\t}\n\n\t.esgst-pgb-button:hover, .esgst-gf-button:hover {\n\t\tbackground-image:linear-gradient(rgba(255, 255, 255, 0.4) 0%, rgba(255, 255, 255, 0) 100%);\n\t}\n\n\t.esgst-gm-giveaway {\n\t\tbackground-color: #fff;\n\t\tborder: 1px solid;\n\t\tborder-radius: 4px;\n\t\tcursor: pointer;\n\t\tdisplay: inline-block;\n\t\tmargin: 5px 2px;\n\t\tpadding: 2px 5px;\n\t}\n\n\t.esgst-feature-description {\n\t\tbackground-color: #fff;\n\t\tcolor: #465670;\n\t\tpadding: 10px;\n\t\twidth: 420px;\n\t\tborder-radius: 4px;\n\t}\n\n\t.esgst-feature-description img {\n\t\tmax-width: 400px;\n\t}\n\n\t.esgst-feature-description.esgst-popout > a {\n\t    line-height: 18px;\n\t\tmargin: 2px;\n\t}\n\n\t.esgst-gm-giveaway.error {\n\t\tbackground-color: rgba(236, 133, 131, 0.5);\n\t}\n\n\t.esgst-gm-giveaway.success {\n\t\tbackground-color: rgba(150, 196, 104, 0.5);\n\t}\n\n\t.esgst-gm-giveaway.connected {\n\t\ttext-decoration: line-through;\n\t}\n\n\t.esgst-gm-giveaway.selected {\n\t\tbackground-color: rgba(104, 150, 196, 0.5)\n\t}\n\n\t.esgst-gts-section >*, .esgst-gm-section >* {\n\t\tmargin: 5px 0;\n\t}\n\n\t.esgst-gm-section .esgst-button {\n\t\tmargin: 5px;\n\t}\n\n\t.esgst-button.sidebar__entry-delete, .esgst-button.sidebar__error {\n\t\tdisplay: inline-block;\n\t}\n\n\t.sidebar .esgst-button {\n\t\tmargin-bottom: 5px;\n\t\tdisplay:block;\n\t}\n\n\t.sidebar__search-container {\n\t\tbackground-color: #fff;\n\t\tborder-radius: 4px;\n\t\tborder-width: 1px;\n\t\tborder-style: solid;\n\t\tborder-color: #c5cad7 #dee0e8 #dee0e8 #d2d4e0;\n\t\tline-height: 1.5em;\n\t\tpadding: 5px 10px;\n\t}\n\n\t.esgst-button-group {\n\t\tdisplay: block;\n\t}\n\n\t.esgst-button-group >* {\n\t\tdisplay: inline-block;\n\t}\n\n\t.esgst-button-group >*:not(:first-child) {\n\t\tmargin-left: 5px;\n\t}\n\n\t.esgst-ggl-panel {\n\t\tbackground: none;\n\t\tborder: none;\n\t\tbox-shadow: none !important;\n\t\tcolor: #6b7a8c;\n\t\tfont-size: 12px;\n\t\tpadding: 5px;\n\t\twhite-space: unset;\n\t}\n\n\t.esgst-ggl-panel >* {\n\t\tdisplay: inline-block;\n\t}\n\n\t.esgst-ggl-panel >*:not(:last-child) {\n\t\tmargin-right: 10px;\n\t}\n\n\t.esgst-ggl-panel a:last-child {\n\t\tborder-bottom: 1px dotted;\n\t}\n\n\t.esgst-ggl-panel .table_image_avatar {\n\t\tcursor: pointer;\n\t\tdisplay: inline-block;\n\t\theight: 12px;\n\t\twidth: 12px;\n\t\tvertical-align: middle;\n\t}\n\n\t.esgst-ggl-member {\n\t\tfont-weight: bold;\n\t}\n\n\t.esgst-ggl-heading {\n\t\tfont-weight: bold;\n\t\tline-weight: 22px;\n\t\tmargin: 10px;\n\t}\n\n\t.esgst-gcl-popout, .esgst-ggl-popout {\n\t\tpadding: 0 !important;\n\t}\n\n\t.esgst-gcl-popout .table__row-outer-wrap, .esgst-ggl-popout .table__row-outer-wrap {\n\t\tpadding: 10px 5px;\n\t}\n\n\t.esgst-hidden-buttons {\n\t\tpadding: 2px !important;\n\t}\n\n\t.esgst-popout {\n\t\tbackground-color: #fff;\n\t\tborder: 1px solid #d2d6e0;\n\t\tborder-radius: 4px;\n\t\tcolor: #465670;\n\t\tleft: 0;\n\t\toverflow: auto;\n\t\tpadding: 10px;\n\t\tposition: absolute;\n\t\ttop: 0;\n\t\tz-index: 999;\n\t}\n\n\t.esgst-aic-carousel {\n\t\talign-items: center;\n\t\tcursor: default !important;\n\t\tdisplay: flex;\n\t\tjustify-content: center;\n\t}\n\n\t.esgst-aic-carousel >:last-child {\n\t\tborder: 5px solid #fff;\n\t\tborder-radius: 5px;\n\t\tmax-width: 90%;\n\t}\n\n\t.esgst-aic-carousel img {\n\t\tdisplay: block;\n\t}\n\n\t.esgst-aic-panel {\n\t\tcolor: #fff;\n\t\tposition: absolute;\n\t\ttext-align: center;\n\t\ttop: 25px;\n\t}\n\n\t.esgst-aic-left-button, .esgst-aic-right-button {\n\t\tcursor: pointer;\n\t\tdisplay: inline-block;\n\t\tmargin: 10px;\n\t\ttext-align: center;\n\t\twidth: 25px;\n\t}\n\n\t.esgst-aic-left-button i, .esgst-aic-right-button i {\n\t\tfont-size: 25px;\n\t}\n\n\t.esgst-aic-source {\n\t\tfont-weight: bold;\n\t\tmargin-top: 10px;\n\t\ttext-decoration: underline;\n\t}\n\n\t.esgst-popup-modal {\n\t\tbackground-color: rgba(60, 66, 77, 0.7);\n\t\tbottom: 0;\n\t\tcursor: pointer;\n\t\tleft: 0;\n\t\tposition: fixed;\n\t\tright: 0;\n\t\ttop: 0;\n\t}\n\n\t.esgst-popup-large {\n\t\twidth: 75%;\n\t}\n\n\t.esgst-popup-layer {\n\t\talign-items: ${d.get("static_popups")?"baseline":"center"};\n\t\tbottom: 0;\n\t\tdisplay: flex;\n\t\tjustify-content: ${d.get("static_popups")?"left":"center"};\n\t\tleft: 0;\n\t\tpadding: 50px;\n\t\tposition: fixed;\n\t\tright: 0;\n\t\ttop: 0;\n\t}\n\n\t.esgst-popup {\n\t\tbackground-color: var(--esgst-body-bg-color);\n\t\tborder-radius: 4px;\n\t\tcolor: #465670;\n\t\tdisplay: flex;\n\t\tflex-direction: column;\n\t\tpadding: 25px;\n\t\tposition: relative;\n\t\ttext-align: center;\n\t\ttext-shadow: 1px 1px rgba(255,255,255,0.94);\n\t\ttransition: 500ms ease;\n\t\tz-index: 1;\n\t}\n\n\t.esgst-popout li:before, .esgst-popup li:before {\n\t\tmargin-left: 0;\n\t\tpadding-right: 10px;\n\t\tposition: static;\n\t\twidth: auto;\n\t\ttext-align: left;\n\t}\n\n\t.esgst-popup-description .page__heading, .esgst-popup-description .page_heading {\n\t\tpadding: 0;\n\t}\n\n\t.esgst-popup-description .page__heading, .esgst-popup-description .page_heading, .esgst-popup-description .esgst-notification-bar, .esgst-popup-description .esgst-gf-container {\n\t\tmargin: 0 0 5px 0 !important;\n\t}\n\n\t.esgst-popup-description >*:not(.esgst-tag-suggestions):not(.page__heading):not(.page_heading):not(.esgst-notification-bar):not(.esgst-gf-container), .esgst-popup-scrollable >* {\n\t\tmargin: 10px 0 0 !important;\n\t}\n\n\t.esgst-popup-description >*:not(.esgst-tag-suggestions):not(.page__heading):not(.page_heading):not(.esgst-notification-bar):not(.esgst-gf-container).esgst-button.form__submit-button, .esgst-popup-description >*:not(.esgst-tag-suggestions):not(.page__heading):not(.page_heading):not(.esgst-notification-bar):not(.esgst-gf-container).esgst-button.btn_action {\n\t\tmargin-right: 8px !important;\n\t}\n\n\t.esgst-popup-actions {\n\t\tcolor: #4b72d4;\n\t\tmargin-top: 15px;\n\t}\n\n\t.esgst-popup-actions a {\n\t\tborder-bottom: 1px dotted;\n\t\tbox-shadow: 0 1px 0 #fff;\n\t\tdisplay: inline-block;\n\t\tcursor: pointer;\n\t}\n\n\t.esgst-popup-actions >*, .esgst-popup .esgst-button {\n\t\tdisplay: inline-block;\n\t}\n\n\t.esgst-popup-actions >*:not(:last-child) {\n\t\tmargin-right: 15px;\n\t}\n\n\t.esgst-popup-scrollable {\n\t\toverflow: auto;\n\t}\n\n\t.esgst-popup .popup__keys__list {\n\t\tmax-height: none;\n\t}\n\n\t.esgst-heading-button {\n\t\tdisplay: inline-block;\n\t\tcursor: pointer;\n\t}\n\n\t.esgst-popup-heading {\n\t\tdisplay: flex;\n\t\talign-items: center;\n\t\tmargin-bottom: 5px;\n\t}\n\n\t.esgst-popup-icon {\n\t\tfont-size: 25px;\n\t\tmargin-right: 10px;\n\t}\n\n\t.esgst-popup-title {\n\t\tfont: 300 18px 'Open Sans', sans-serif;\n\t}\n\n\t.esgst-popup-title span {\n\t\tfont-weight: bold;\n\t}\n\n\t.esgst-text-left {\n\t\ttext-align: left;\n\t}\n\n\t.esgst-text-center {\n\t\ttext-align: center;\n\t}\n\n\t.esgst-hidden {\n\t\tdisplay: none !important;\n\t}\n\n\t.esgst-clickable {\n\t\tcursor: pointer;\n\t}\n\n\t.fa img {\n\t\theight: 14px;\n\t\twidth: 14px;\n\t\tvertical-align: middle;\n\t}\n\n\t.nav__left-container .fa img {\n\t\tvertical-align: baseline;\n\t}\n\n\t.nav__left-container .nav__button-container--notification .nav__button {\n\t\tpadding: 0 0 0 20px;\n\t}\n\n\t.esgst-checkbox, .esgst-hb-update, .esgst-hb-changelog {\n\t\tcursor: pointer;\n\t}\n\n\t.esgst-sm-small-number {\n\t\tfont-size: 12px;\n\t\tdisplay: inline-block;\n\t}\n\n\t.esgst-toggle-switch-container {\n\t\talign-items: center;\n\t\tdisplay: flex;\n\t\tmargin: 2px;\n\t}\n\n\t.esgst-toggle-switch-container.inline {\n\t\tdisplay: inline-flex;\n\t}\n\n\t.esgst-toggle-switch-container i {\n\t\tmargin: 0 5px;\n\t}\n\n\t.page__heading .esgst-toggle-switch-container.inline, .page_heading .esgst-toggle-switch-container.inline, .esgst-page-heading .esgst-toggle-switch-container.inline {\n\t\theight: 16px;\n\t\tmargin: 0 2px;\n\t\tline-height: normal;\n\t\tvertical-align: middle;\n\t}\n\n\t.esgst-toggle-switch {\n\t\tposition: relative;\n\t\twidth: 26px;\n\t\theight: 14px;\n\t}\n\n\t.esgst-toggle-switch input {\n\t\tdisplay: none !important;\n\t}\n\n\t.esgst-toggle-switch-slider {\n\t\tborder-radius: 20px;\n\t\tposition: absolute;\n\t\tcursor: pointer;\n\t\ttop: 0;\n\t\tleft: 0;\n\t\tright: 0;\n\t\tbottom: 0;\n\t\tbackground-color: #ccc;\n\t\t-webkit-transition: .4s;\n\t\ttransition: .4s;\n\t}\n\n\t.esgst-toggle-switch-slider:before {\n\t\tborder-radius: 50%;\n\t\tposition: absolute;\n\t\tcontent: "";\n\t\theight: 12px;\n\t\twidth: 12px;\n\t\tleft: 1px;\n\t\tbottom: 1px;\n\t\tbackground-color: white;\n\t\t-webkit-transition: .4s;\n\t\ttransition: .4s;\n\t}\n\n\tinput:checked + .esgst-toggle-switch-slider {\n\t\tbackground-color: #4B72D4;\n\t}\n\n\tinput:focus + .esgst-toggle-switch-slider {\n\t\tbox-shadow: 0 0 1px #4B72D4;\n\t}\n\n\tinput:checked + .esgst-toggle-switch-slider:before {\n\t\t-webkit-transform: translateX(12px);\n\t\t-ms-transform: translateX(12px);\n\t\ttransform: translateX(12px);\n\t}\n\n\t.esgst-adots, .esgst-rbot {\n\t\tmargin-bottom: 25px;\n\t}\n\n\t.esgst-float-left {\n\t\tfloat: left;\n\t}\n\n\t.esgst-float-right {\n\t\tfloat: right;\n\t}\n\n\t.esgst-clear {\n\t\tclear: both;\n\t}\n\n\t.esgst-rbot .reply_form .btn_cancel {\n\t\tdisplay: none;\n\t}\n\n\t.esgst-aas-button {\n\t\tcursor: pointer;\n\t\tdisplay: inline-block;\n\t}\n\n\t.esgst-es-page-heading {\n\t\tmargin-top: 25px;\n\t}\n\n\t.esgst-gc-border {\n\t\tdisplay: flex;\n\t\theight: 5px;\n\t\tmargin-left: 5px;\n\t\twidth: ${d.get("ib")?"186px":"174px"};\n\t}\n\n\t.esgst-gc-border >* {\n\t\tflex: 1;\n\t}\n\n\t.esgst-gc-panel {\n\t\ttext-align: left;\n\t}\n\n\t.esgst-gc-panel a {\n\t\ttext-decoration: none;\n\t}\n\n\t.esgst-gc-panel-inline {\n\t\tdisplay: inline-block;\n\t\tmargin: 0 0 0 5px;\n\t}\n\n\t.esgst-gch-highlight, .esgst-gc:not(.giveaway__column):not(.featured__column) {\n\t\tborder-radius: 4px;\n\t\tdisplay: inline-block;\n\t\tfont-size: 10px;\n\t\tline-height: 10px;\n\t\tmargin: 5px 0;\n\t\tpadding: 2px 3px;\n\t\ttext-shadow: none;\n\t}\n\n\t.esgst-gch-highlight {\n\t\tfont-size: 14px;\n\t\tline-height: 14px;\n\t\tmargin: 0 5px;\n\t}\n\n\t.esgst-glh-highlight {\n\t\tbackground-image: none !important;\n\t\ttext-shadow: none;\n\t}\n\n\ta.esgst-gc-genres {\n\t\tmax-width: 150px;\n\t\toverflow: hidden;\n\t\ttext-overflow: ellipsis;\n\t\tvertical-align: middle;\n\t\twhite-space: nowrap;\n\t}\n\n\t.esgst-popup .esgst-gf-container {\n\t\ttop: 0;\n\t}\n\n\t.esgst-gf-container {\n\t\ttext-align: left;\n\t\tz-index: 998;\n\t}\n\n\t.esgst-gf-container:not(.esgst-popup-scrollable) {\n\t\tbackground-color: #E8EAEF;\n\t\tborder-radius: 4px;\n\t}\n\n\t.esgst-gf-Shared.esgst-popup-scrollable {\n\t\tmin-width: 650px;\n\t}\n\n\t.esgst-gf-filters {\n\t\tdisplay: flex;\n\t\tjustify-content: space-between;\n\t\toverflow: auto;\n\t\tposition: relative;\n\t}\n\n\t.esgst-gf-left-panel {\n\t\tflex: 1;\n\t\tmax-height: 400px;\n\t\toverflow-y: auto;\n\t}\n\n\t.esgst-gf-right-panel .form__input-small {\n\t\twidth: 100px !important;\n\t}\n\n\t.esgst-gf-filters >* {\n\t\tmargin: 5px;\n\t}\n\n\t.esgst-gf-preset-panel {\n\t\tmargin: 5px;\n\t\ttext-align: right;\n\t}\n\n\t.esgst-gf-preset-panel >* {\n\t\tmargin: 5px;\n\t}\n\n\t.esgst-gf-filter-count {\n\t\tbackground-color: #ddd;\n\t\tborder-radius: 5px;\n\t\tfont-size: 10px;\n\t\tpadding: 2px;\n\t\tvertical-align: middle;\n\t}\n\n\t.esgst-gf-button {\n\t\tborder-top: 1px;\n\t}\n\n\t.esgst-wbh-highlight {\n\t\tborder: none !important;\n\t\tborder-radius: 4px;\n\t\tpadding: 2px 5px;\n\t\ttext-shadow: none;\n\t}\n\n\t.page__heading__breadcrumbs .esgst-wbh-highlight {\n\t\tpadding: 0 2px;\n\t}\n\n\t.esgst-sm-additional-option >*:not(.esgst-sm-additional-option) {\n\t\talign-items: center;\n\t\tdisplay: flex;\n\t\tmargin: 5px 0;\n\t}\n\n\t.esgst-sm-additional-option >* input, .esgst-sm-additional-option >* select, .esgst-sm-additional-option >* textarea {\n\t\tflex: 1;\n\t}\n\n\t.esgst-sm-additional-option >* >* {\n\t\tmargin: 0 5px;\n\t}\n\n\t.esgst-ged-icon {\n\t\tmargin: 0 0 0 10px;\n\t}\n\n\t.esgst-pgb-container {\n\t\tborder-radius: 0 !important;\n\t\tmargin: 0! important;\n\t}\n\n\t.esgst-gf-box {\n\t\tbackground-color: #E8EAEF;\n\t\tborder: 1px solid #d2d6e0;\n\t\tborder-radius: 0 !important;\n\t\tmargin: 0! important;\n\t\tpadding: 0 15px;\n\t}\n\n\t.esgst-gf-box.warning, .esgst-gf-button.warning {\n\t\tbackground-color: #FF0000;\n\t\tcolor: #FFFFFF;\n\t\tfont-weight: bold;\n\t\ttext-shadow: none;\n\t}\n\n\t.esgst-gf-box.warning .markdown li:before {\n\t\tcolor: #FFFFFF;\n\t}\n\n\t.esgst-gr-button {\n\t\tcursor: pointer;\n\t\tdisplay: inline-block;\n\t}\n\n\t.esgst-egh-icon {\n\t\tcursor: pointer;\n\t}\n\n\t.giveaway__row-outer-wrap .esgst-egh-button, .giveaway__row-outer-wrap .esgst-gr-button, .table__row-outer-wrap .esgst-egh-button, .table__row-outer-wrap .esgst-egh-button, .table__row-outer-wrap .esgst-gr-button {\n\t\tmargin-right: 5px;\n\t}\n\n\tp.table__column__heading {\n\t\tdisplay: inline-block;\n\t}\n\n\t.esgst-giveaway-links {\n\t\tmargin: 2px;\n\t}\n\n\t.esgst-gv-box .esgst-giveaway-panel:empty {\n\t\theight: 0;\n\t\twidth: 0;\n\t}\n\n\t.esgst-giveaway-panel:empty {\n\t\theight: 25px;\n\t\twidth: 250px;\n\t}\n\n\t.esgst-giveaway-panel.giveaway__columns {\n\t\tmargin: 2px;\n\t}\n\n\t.giveaway__row-outer-wrap .esgst-button-container {\n\t\tborder: 0;\n\t\tpadding: 0;\n\t}\n\n\t.giveaway__row-outer-wrap .esgst-button {\n\t\tline-height: inherit;\n\t\tmargin: 0;\n\t}\n\n\t.esgst-giveaway-panel >:first-child {\n\t\tmargin: 0;\n\t}\n\n\t.esgst-giveaway-panel >*:not(:first-child) {\n\t\tmargin: 0 0 0 5px;\n\t}\n\n\t.esgst-gv-popout .esgst-gwc, .esgst-gv-popout .esgst-gwr, .esgst-gv-popout .esgst-gptw, .esgst-gv-popout .esgst-ttec {\n\t\tdisplay: inline-block;\n\t\tmargin: 0 !important;\n\t\tpadding: 0 5px !important;\n\t\twidth: 67px !important;\n\t\tvertical-align: top;\n\t}\n\n\t.esgst-gv-popout .esgst-gp-button {\n\t\tdisplay: inline-block;\n\t\tmargin: 0 !important;\n\t\twidth: auto !important;\n\t\tvertical-align: top;\n\t}\n\n\t.esgst-gv-popout .esgst-gp-button >* {\n\t\tpadding: 0 5px !important;\n\t\twidth: 67px !important;\n\t}\n\n\t.esgst-giveaway-panel .form__submit-button, .esgst-giveaway-panel .form__saving-button {\n\t\tmargin-bottom: 0;\n\t\tmin-width: 0;\n\t}\n\n\t.esgst-ged-source {\n\t\tfont-weight: bold;\n\t\tmargin: 5px 0;\n\t}\n\n\t.table__column--width-small {\n\t\twidth: 8%;\n\t}\n\n\t.sidebar .table__row-outer-wrap {\n\t\tpadding: 5px 0;\n\t}\n\n\t.esgst-adots-tab-heading {\n\t\tbackground-color: #2f3540;\n\t\tborder-top-left-radius: 5px;\n\t\tborder-top-right-radius: 5px;\n\t\tcolor: #fff;\n\t\tcursor: pointer;\n\t\tdisplay: inline-block;\n\t\topacity: 0.5;\n\t\tpadding: 5px 10px;\n\t\ttext-shadow: none;\n\t}\n\n\t.esgst-adots-tab-heading.esgst-selected {\n\t\topacity: 1;\n\t}\n\n\t.sidebar .esgst-adots {\n\t\tmargin-bottom: 15px;\n\t\tmax-height: 300px;\n\t\tmax-width: 336px;\n\t\toverflow: auto;\n\t}\n\n\t.sidebar .esgst-adots .esgst-dh-highlighted, .sidebar .esgst-adots .esgst-idb-highlighted {\n\t\tpadding: 0 !important;\n\t\tpadding-bottom: 5px !important;\n\t}\n\n\t.sidebar .esgst-adots .table__column__heading, .esgst-adots .homepage_table_column_heading {\n\t\tdisplay: inline-block;\n\t\tmax-width: 225px;\n\t\toverflow: hidden;\n\t\ttext-overflow: ellipsis;\n\t\tvertical-align: middle;\n\t\twhite-space: nowrap;\n\t}\n\n\t.esgst-ns .esgst-adots .table__column__heading, .esgst-ns .esgst-adots .homepage_table_column_heading {\n\t\tmax-width: 100px;\n\t}\n\n\t.sidebar .esgst-adots .table__row-outer-wrap {\n\t\tpadding: 3px 0 !important;\n\t\tborder: 0;\n\t\tbox-shadow: none;\n\t}\n\n\t.sidebar .esgst-adots .table__row-inner-wrap {\n\t\tdisplay: block;\n\t}\n\n\t.sidebar .esgst-adots .table__row-inner-wrap >*:not(:last-child) {\n\t\tdisplay: inline-block;\n\t}\n\n\t.table__column__secondary-link {\n\t\tborder-bottom: 1px dotted;\n\t\tbox-shadow: 0 1px 0 rgba(255, 255, 255, .3);\n\t\tcolor: #4b72d4;\n\t}\n\n\t.form__row:first-of-type {\n\t\tmargin-top: 14px;\n\t}\n\n\t.form__row {\n\t\tmargin-bottom: 20px;\n\t}\n\n\t.form__heading {\n\t\talign-items: center;\n\t\tdisplay: flex;\n\t\tmargin-bottom: 5px;\n\t}\n\n\t.form__heading>div:not(:last-child) {\n\t\tmargin-right: 10px;\n\t}\n\n\t.form__heading__number, .form__heading__optional {\n\t\tfont: 300 14px "Open Sans", sans-serif;\n\t\tcolor: #6b7a8c;\n\t}\n\n\t.form__heading__text {\n\t\tcolor: #4b72d4;\n\t\tfont: 700 14px "Open Sans", sans-serif;\n\t}\n\n\t.form__row__indent {\n\t\tborder-left: 1px solid #d2d6e0;\n\t\tbox-shadow: 1px 0 0 rgba(255, 255, 255, .3) inset;\n\t\tmargin-left: 5px;\n\t\tpadding: 3px 0 3px 20px;\n\t}\n\n\t.icon_to_clipboard {\n\t\tcolor: #4b72d4;\n\t\tcursor: pointer;\n\t\tmargin-right: 5px;\n\t}\n\n\t.esgst-gv-icons [data-draggable-id="elgb"]:not(.esgst-button-set):not(.esgst-button-container) {\n\t\tfont-size: 12px;\n\t\tline-height: 16px;\n\t\tpadding: 0 8px;\n\t}\n\n\t.esgst-gv-icons [data-draggable-id="elgb"]:not(.esgst-button-set):not(.esgst-button-container).form__saving-button.is-disabled {\n\t\tmargin-bottom: -2px;\n\t\tmax-width: 8.5ch;\n\t\toverflow: hidden;\n\t\tpadding: 0 4px;\n\t\ttext-overflow: ellipsis;\n\t\twhite-space: nowrap;\n\t}\n\n\t.esgst-gv-icons [data-draggable-id="elgb"]:not(.esgst-button-set):not(.esgst-button-container) i {\n\t\tfont-size: 12px;\n\t\tvertical-align: baseline;\n\t}\n\n\t.esgst-popup .esgst-idb-button {\n\t\tdisplay: none;\n\t}\n\n\t.esgst-popup .esgst-df-button + .esgst-idb-button {\n\t\tdisplay: inline-block !important;\n\t}\n\n\t.fanatical_container, .bundle_container {\n\t\tfont-size: 12px;\n\t\ttext-align: left;\n\t}\n\n\t.esgst-fmph .page_heading_btn_container {\n\t\tz-index: 1000;\n\t}\n\n\t.esgst-fmph .page_heading_btn_dropdown.is_selected + .dropdown .dropdown_btn {\n\t\tpadding: 4px 15px;\n\t}\n\n\t.esgst-popup-description.esgst-text-left select, .esgst-popup-description.esgst-text-left input, .esgst-popup select, .esgst-auto-sync, .esgst-cfh-popout input, .esgst-switch-input {\n\t\tborder-radius: 4px;\n\t\tborder: 1px solid #d2d6e0;\n\t\tfont: inherit;\n\t\tline-height: 1.5em;\n\t}\n\n\theader.large ~ .esgst-popup-layer .esgst-popup .esgst-button i, header.small ~ .esgst-popup-layer .esgst-popup .esgst-button i {\n\t\tmargin-right: 3px;\n\t\tvertical-align: baseline;\n\t}\n\n\t.page_heading .esgst-button-container > .page_heading_btn.esgst-button i {\n\t\tline-height: 22px;\n\t\tmargin: 0 !important;\n\t} \n\n\theader ~ .esgst-popup-layer .esgst-popup .page_heading .esgst-button-container > .page_heading_btn.esgst-button i:nth-of-type(2), header ~ .esgst-popup-layer .esgst-popup .page_heading .esgst-button-container > .page_heading_btn.esgst-button i:nth-of-type(2) {\n\t\tmargin-left: 3px !important;\n\t}\n\n\t.esgst-gv-box .esgst-gv-icons .esgst-button-container [data-draggable-id] {\n\t\tline-height: 16px;\n\t\tfont-size: 12px;\n\t\tpadding: 0 4px;\n\t}\n\n\t.esgst-sync-warning ~ .esgst-text-left hr {\n\t\tborder-top: 1px solid #ccd6de; \n\t\tborder-bottom: 1px solid rgba(255, 255, 255, .3);\n\t\tmargin: 0.5em 0;\n\t}\n\n\t.esgst-faded {\n\t\topacity: 0.5;\n\t}\n\n\t.esgst-sm-faded >*:not(.SMFeatures) {\n\t\topacity: 0.5;\n\t}\n\n\t.esgst-blue {\n\t\tcolor: #9dd9e1 !important;\n\t}\n\n\t.esgst-green {\n\t\tcolor: #96c468 !important;\n\t}\n\n\t.esgst-grey {\n\t\tcolor: #77899a !important;\n\t}\n\n\t.esgst-orange {\n\t\tcolor: #c1a576 !important;\n\t}\n\n\t.esgst-red {\n\t\tcolor: #ec8583 !important;\n\t}\n\n\t.esgst-yellow {\n\t\tcolor: #fecc66 !important;\n\t}\n\n\t.esgst-warning {\n\t\tcolor: #e9202a !important;\n\t\tfont-weight: bold;\n\t}\n\n\t.esgst-sync-warning {\n\t\tfont-size: 20px;\n\t\tfont-weight: bold;\n\t}\n\n\t.esgst-toggle-switch-container .esgst-description, .esgst-button-group .esgst-description {\n\t\tdisplay: inline-block;\n\t\tmargin: 0;\n\t}\n\n\t.esgst-description {\n\t\tcolor: #6b7a8c;\n\t\tfont-size: 11px;\n\t\tfont-style: italic;\n\t\tmargin-top: 10px;\n\t}\n\n\t.esgst-progress-bar {\n\t\theight: 10px;\n\t\toverflow: hidden;\n\t\ttext-align: left;\n\t}\n\n\t.esgst-progress-bar .ui-progressbar-value {\n\t\tbackground-color: #96c468;\n\t\theight: 100%;\n\t\tmargin: -1px;\n\t}\n\n\t.esgst-ib-user {\n\t\tbackground-color: #fff;\n\t\tbackground-position: 5px 5px;\n\t\tbackground-size: 32px;\n\t\tborder: 1px solid #d2d6e0;\n\t\tborder-radius: 4px;\n\t\theight: 44px;\n\t\tpadding: 5px;\n\t\twidth: 44px;\n\t}\n\n\t.featured__outer-wrap .esgst-ib-user {\n\t\tbackground-color: transparent;\n\t\tborder: 1px solid rgba(255, 255, 255, 0.1);\n\t}\n\n\t.esgst-ib-game {\n\t\tbackground-color: #fff;\n\t\tbackground-position: 5px 5px;\n\t\tborder: 1px solid #d2d6e0;\n\t\tborder-radius: 4px;\n\t\tpadding: 5px;\n\t}\n\n\t.giveaway__row-outer-wrap .esgst-ib-game {\n\t\tbackground-size: 184px 69px;\n\t\theight: 81px;\n\t\twidth: 196px;\n\t}\n\n\t.table__row-outer-wrap .esgst-ib-game {\n\t\tbackground-size: 85px 32px;\n\t\theight: 44px;\n\t\twidth: 97px;\n\t}\n\n\t.esgst-oadd >* {\n\t\tpadding-left: 0 !important;\n\t\tmargin-left: 0 !important;\n\t\tborder-left: none !important;\n\t\tbox-shadow: none !important;\n\t}\n\n\t.esgst-gv-spacing {\n\t\tfont-weight: bold;\n\t\tpadding: 10px;\n\t\ttext-align: center;\n\t\twidth: 100px;\n\t}\n\n\t.esgst-gv-view {\n\t\tfont-size: 0;\n\t\tpadding: 5px 0;\n\t\ttext-align: center;\n\t}\n\n\t.esgst-gv-view.pinned-giveaways__inner-wrap--minimized .giveaway__row-outer-wrap:nth-child(-n + 10) {\n\t\tdisplay: inline-block;\n\t}\n\n\t.esgst-gv-container {\n\t\tborder: 0 !important;\n\t\tbox-shadow: none !important;\n\t\tdisplay: inline-block;\n\t\tfont-size: 12px;\n\t\tpadding: 0;\n\t\ttext-align: center;\n\t\tvertical-align: top;\n\t\twidth: ${d.get("ib")?"196px":"184px"};\n\t}\n\n\t.esgst-gv-box {\n\t\tdisplay: block;\n\t}\n\n\t.esgst-gv-box >*:not(.giveaway__summary):not(.esgst-gv-icons) {\n\t\tmargin: 0 !important;\n\t}\n\n\t.esgst-gv-box.is-faded:hover, .esgst-gv-box.esgst-faded:hover {\n\t\topacity: 1;\n\t}\n\n\t.esgst-gv-icons {\n\t\tfloat: right;\n\t\theight: 18px;\n\t\tmargin: -18px 0 0 !important;\n\t}\n\n\t.esgst-gv-icons .esgst-gc, .esgst-gv-icons .esgst-gwc, .esgst-gv-icons .esgst-gwr, .esgst-gv-icons .esgst-gptw, .esgst-gv-icons .esgst-ttec, .esgst-gv-time, .esgst-gv-icons .esgst-ged-source {\n\t\tbackground-color: #fff;\n\t\tpadding: 2px !important;\n\t}\n\n\t.esgst-gv-icons .esgst-gp-button, .esgst-elgb-button > .form__saving-button {\n\t\tbackground-color: #fff;\n\t}\n\n\t.esgst-ged-source {\n\t\tfont-weight: bold;\n\t}\n\n\t.esgst-gv-time i {\n\t\tfont-size: 12px;\n\t\tvertical-align: baseline;\n\t}\n\n\t.esgst-gv-icons >* {\n\t\tline-height: normal;\n\t\tmargin: 0 !important;\n\t}\n\n\t.esgst-gv-icons >*:not(.esgst-giveaway-column-button):not(.esgst-button-container) {\n\t\tpadding: 1px 3px;\n\t}\n\n\t.esgst-gv-icons .giveaway__column--contributor-level {\n\t\tpadding: 2px 5px !important;\n\t}\n\n\t.esgst-gv-popout {\n\t\tfont-size: 11px;\n\t\tmax-width: ${d.get("ib")?"174px":"162px"};\n\t\toverflow-x: hidden;\n\t\toverflow-y: auto;\n\t\tposition: absolute;\n\t\twidth: ${d.get("ib")?"174px":"162px"};\n\t\tz-index: 1;\n\t}\n\n\t.esgst-gv-popout .giveaway__heading {\n\t\tdisplay: flex;\n\t\tflex-wrap: wrap;\n\t\theight: auto;\n\t}\n\n\t.esgst-gv-popout .giveaway__heading__name {\n\t\tdisplay: inline-block;\n\t\tfont-size: 12px;\n\t\tmax-width: 150px;\n\t\toverflow: hidden;\n\t\ttext-overflow: ellipsis;\n\t\tvertical-align: middle;\n\t}\n\n\t.esgst-gv-popout .giveaway__heading__thin {\n\t\tfont-size: 11px;\n\t}\n\n\t.esgst-gv-popout .esgst-gc-panel {\n\t\tfont-size: 11px;\n\t\ttext-align: center;\n\t}\n\n\t.esgst-gv-popout .esgst-gc-panel i, .esgst-gv-popout .giveaway__links i, .esgst-gv-popout .esgst-gwc i, .esgst-gv-popout .esgst-gwr i, .esgst-gv-popout .esgst-gptw i, .esgst-gv-popout .esgst-ggl-panel, .esgst-gv-popout .esgst-ggl-panel i {\n\t\tfont-size: 11px;\n\t}\n\n\t.esgst-gv-popout .giveaway__columns:not(.esgst-giveaway-panel):not(.esgst-gv-icons) {\n\t\tdisplay: block;\n\t\tfloat: left;\n\t\twidth: calc(100% - 37px);\n\t}\n\n\t.esgst-gv-popout .giveaway__columns:not(.esgst-giveaway-panel):not(.esgst-gv-icons) >* {\n\t\tmargin: 0;\n\t\ttext-align: left;\n\t}\n\n\t.esgst-gv-popout .esgst-giveaway-panel {\n\t\tdisplay: block;\n\t\tfont-size: 11px;\n\t}\n\n\t.esgst-gv-popout .esgst-giveaway-panel >* {\n\t\tmargin: 0;\n\t\toverflow: hidden;\n\t}\n\n\t.esgst-gv-popout .esgst-button-container {\n\t\twidth: 100%;\n\t}\n\n\t.esgst-gv-popout .esgst-button {\n\t\tpadding: 0;\n\t\twidth: 100%;\n\t}\n\t.esgst-gv-popout .giveaway__links a:last-child {\n\t\tmargin: 0 !important;\n\t}\n\n\t.esgst-gv-popout .giveaway_image_avatar, .esgst-gv-popout .featured_giveaway_image_avatar {\n\t\tmargin: 5px;\n\t}\n\n\t.esgst-gv-popout .esgst-giveaway-links, .esgst-gv-popout .esgst-giveaway-panel {\n\t\tfloat: none;\n\t}\n\n\t.esgst-gv-popout [data-draggable-id="winners"] {\n\t\tmargin: 5px 0 0;\n\t}\n\n\t.esgst-ags-panel {\n\t\tmargin: 0 0 15px 0;\n\t\tmax-width: 316px;\n\t\ttext-align: center;\n\t}\n\n\t.esgst-ags-panel >* {\n\t\tdisplay: inline-block;\n\t}\n\n\t.esgst-ags-filter {\n\t\tdisplay: block;\n\t\tmargin: 5px;\n\t}\n\n\t.esgst-ags-filter >* {\n\t\tpadding: 0 5px !important;\n\t\twidth: 125px;\n\t}\n\n\t.esgst-ags-checkbox-filter {\n\t\tmargin: 5px;\n\t}\n\n\t.esgst-ugs-difference, .esgst-switch-input {\n\t\tdisplay: inline-block;\n\t\tpadding: 0 !important;\n\t\twidth: 50px;\n\t}\n\n\t.esgst-switch-input-large {\n\t\twidth: 150px;\n\t}\n\n\t.esgst-gas-popout {\n\t\tbackground-color: #fff;\n\t\tborder: 1px solid #d2d6e0;\n\t\tborder-radius: 4px;\n\t\tcolor: #465670;\n\t\tpadding: 10px;\n\t}\n\n\t.esgst-ds-popout {\n\t\tbackground-color: #fff;\n\t\tborder: 1px solid #d2d6e0;\n\t\tborder-radius: 4px;\n\t\tcolor: #465670;\n\t\tpadding: 10px;\n\t}\n\n\t.esgst-cfh-sr-container {\n\t\tmax-height: 234px;\n\t\toverflow-y: auto;\n\t}\n\n\t.esgst-cfh-sr-box {\n\t\tposition: relative;\n\t}\n\n\t.esgst-cfh-sr-summary {\n\t\tborder-radius: 5px;\n\t\tcursor: pointer;\n\t\tpadding: 5px;\n\t\twidth: 200px;\n\t}\n\n\t.esgst-cfh-sr-box:not(:first-child) {\n\t\tborder-top: 1px solid #ccc;\n\t}\n\n\t.esgst-cfh-sr-box:last-child) {\n\t\tborder-bottom: 1px solid #ccc;\n\t}\n\n\t.esgst-cfh-sr-summary:hover {\n\t\tbackground-color: #465670;\n\t\tcolor: #fff;\n\t}\n\n\t.esgst-cfh-sr-name {\n\t\tfont-size: 14px;\n\t\toverflow: hidden;\n\t\ttext-overflow: ellipsis;\n\t\twidth: 200px;\n\t\twhite-space: nowrap;\n\t}\n\n\t.esgst-cfh-sr-description {\n\t\topacity: 0.75;\n\t\toverflow: hidden;\n\t\ttext-overflow: ellipsis;\n\t\twidth: 200px;\n\t\twhite-space: nowrap;\n\t}\n\n\t.esgst-cfh-sr-controls {\n\t\tposition: absolute;\n\t\tright: 5px;\n\t\ttop: 10px;\n\t}\n\n\t.esgst-cfh-sr-controls >* {\n\t\tmargin: 2px;\n\t}\n\n\t.giveaway__row-outer-wrap .esgst-tag-button, .table__row-outer-wrap .esgst-tag-button {\n\t\tmargin-left: 5px;\n\t}\n\n\t.esgst-tag-list-button {\n\t\tpadding: 8px;\n\t\tright: 25px;\n\t\tposition: absolute;\n\t}\n\n\t.esgst-tag-list {\n\t\tfont-weight: bold;\n\t\ttext-align: left;\n\t\ttext-shadow: none;\n\t}\n\n\t.esgst-tag-preview .esgst-tags {\n\t\tdisplay: inline-block;\n\t}\n\n\t.esgst-tag-preview input[type=text] {\n\t\tdisplay: inline-block;\n\t\twidth: 100px;\n\t\theight: 15px;\n\t}\n\n\t.esgst-tag-preview input[type=color] {\n\t\tbox-sizing: unset;\n\t\theight: 13px;\n\t\tline-height: normal;\n\t\tmargin: 0;\n\t\tpadding: 0;\n\t\tvertical-align: top;\n\t\twidth: 15px;\n\t}\n\n\t.esgst-tag-button {\n\t\tborder: 0! important;\n\t\tcursor: pointer;\n\t\tdisplay: inline-block;\n\t\tline-height: normal;\n\t\tmargin: 0 0 0 5px;\n\t\ttext-decoration: none !important;\n\t\ttransition: opacity 0.2s;\n\t}\n\n\t.esgst-tag-button:hover {\n\t\topacity: 1;\n\t}\n\n\t.author_name + .esgst-tag-button {\n\t\tmargin: 0 5px 0 0;\n\t}\n\n\t.esgst-tag-button i {\n\t\tmargin: 0 !important;\n\t}\n\n\t.esgst-tags {\n\t\tfont-size: 10px;\n\t\tfont-weight: bold;\n\t}\n\n\t.esgst-tag {\n\t\tdisplay: inline-block !important;\n\t\theight: auto;\n\t\tmargin: 0;\n\t\tpadding: 1px 2px;\n\t\ttext-shadow: none;\n\t\twidth: auto;\n\t}\n\n\t.esgst-tag:not(:first-child) {\n\t\tmargin: 0 0 0 5px;\n\t}\n\n\t.esgst-gv-popout .esgst-tags, .esgst-adots .esgst-tags {\n\t\tdisplay: none;\n\t}\n\n\t.esgst-settings-menu-feature {\n\t\talign-self: flex-start;\n\t\tmargin-top: 14px;\n\t\tmin-height: 400px;\n\t\toverflow: auto;\n\t\tposition: sticky;\n\t\ttop: 24px;\n\t}\n\n\t.esgst-menu-split {\n\t\tdisplay: flex;\n\t}\n\n\t.esgst-menu-split >* {\n\t\tflex: 1;\n\t\toverflow: auto;\n\t\tword-wrap: break-word;\n\t}\n`,c.esgst.sg||(i+='\n\t\t\t.esgst-un-button, .page_heading .esgst-heading-button {\n\t\t\t\tbackground-image: linear-gradient(#fff 0%, rgba(255, 255, 255, 0.4) 100%);\n\t\t\t\tborder: 1px solid #d2d6e0;\n\t\t\t\tborder-radius: 3px;\n\t\t\t\tcolor: #4b72d4;\n\t\t\t\tcursor: pointer;\n\t\t\t\tdisplay: inline-block;\n\t\t\t\tfont: 700 14px/22px "Open Sans", sans-serif;\n\t\t\t\tpadding: 5px 15px;\n\t\t\t}\n\t\t'),c.esgst.style=c.common.createElements(document.head,"beforeend",[{attributes:{id:"esgst-style"},text:i,type:"style"}])}(),d.get("urlr")&&window.location.pathname.match(/^\/(giveaway|discussion|support\/ticket|trade)\/.{5}$/)&&(window.location.href=`${window.location.origin}${window.location.pathname.match(/\/(giveaway|discussion|support\/ticket|trade)\/.{5}$/)[0]}/`);for(const e in fm.paths)for(const t of fm.paths[e])t.pattern=t.pattern.replace(/%steamId%/,d.get("steamId"));fm.currentPaths=[];const s=e.getPath(window.location.href);for(const e of fm.paths[fm.name])s.match(e.pattern)&&fm.currentPaths.push(e.name);e.isCurrentPath("Account")&&(window.location.href.match(/state=dropbox/)?(await e.setValue("dropboxToken",window.location.hash.match(/access_token=(.+?)&/)[1]),window.close()):window.location.href.match(/state=google-drive/)?(await e.setValue("googleDriveToken",window.location.hash.match(/access_token=(.+?)&/)[1]),window.close()):window.location.href.match(/state=onedrive/)?(await e.setValue("oneDriveToken",window.location.hash.match(/access_token=(.+?)&/)[1]),window.close()):window.location.href.match(/state=imgur/)&&(await e.setValue("imgurToken",window.location.hash.match(/access_token=(.+?)&/)[1]),window.close())),Be.init();try{c.header=new Jt,c.header.parse(document.body),c.footer=new vm,c.footer.parse(document.body)}catch(e){dt.error(e.message)}if(Be.isLoggedIn&&(!fm.st||d.get("esgst_st"))){if(fm.lastPage=fm.modules.generalLastPageLink.lpl_getLastPage(document,!0),await e.getElements(),fm.sg&&e.checkSync(),d.get("autoBackup")&&e.checkBackup(),fm.profilePath&&d.get("autoSync")){const e=document.getElementsByClassName("form__sync-default")[0];e&&e.addEventListener("click",()=>Nt("Games=1&Groups=1"))}await e.addHeaderMenu(),e.checkNewVersion(),await e.loadFeatures(fm.modules),e.isCurrentPath("Browse Giveaways")&&!d.get("es").enabled&&e.moveAdsDown(document.body)}}window.NodeList.prototype[Symbol.iterator]||(window.NodeList.prototype[Symbol.iterator]=Array.prototype[Symbol.iterator]),window.HTMLCollection.prototype[Symbol.iterator]||(window.HTMLCollection.prototype[Symbol.iterator]=Array.prototype[Symbol.iterator]),async function(){document.getElementById("esgst")||(fm.markdownParser.setBreaksEnabled(!0),fm.markdownParser.setMarkupEscaped(!0),fm.name=fm.sg?"sg":"st",n.runtime.onMessage.addListener(t=>{switch((t=JSON.parse(t)).action){case"notify-tds":c.esgst.modules.generalThreadSubscription.updateItems(t.values);break;case"storageChanged":c.common.getChanges(t.values.changes,t.values.areaName);break;case"update":e.createConfirmation(`Hi! A new version of ESGST (${t.values.version}) is available. Do you want to force an update now? If you choose to force an update, ESGST will stop working in any SteamGifts/SteamTrades tab that is open, along with any operation that you might be performing (such as syncing, checking something etc), so you will have to refresh them. If you choose not to force an update, your browser will automatically update the extension when you are not using it (for example, when you restart the browser).`,()=>{n.runtime.sendMessage({action:"reload"}).then(()=>{})},()=>{})}}),await n.runtime.sendMessage({action:"register_tab",url:window.location.href}),fm.storage=await n.storage.local.get(null),n.storage.onChanged.addListener(c.common.getChanges.bind(c.common)),fm.features=e.getFeatures(),[fm.featuresById,fm.featuresAncestors]=e.getFeaturesById(),await Kt.upgrade(fm.storage,fm.storage.v),fm.decryptedGiveaways=JSON.parse(fm.storage.decryptedGiveaways),fm.delistedGames=JSON.parse(fm.storage.delistedGames),fm.discussions=JSON.parse(fm.storage.discussions),fm.emojis=JSON.parse(fm.storage.emojis),fm.games=JSON.parse(fm.storage.games),fm.giveaways=JSON.parse(fm.storage.giveaways),fm.groups=JSON.parse(fm.storage.groups),fm.requestLog=JSON.parse(fm.storage.requestLog),fm.rerolls=JSON.parse(fm.storage.rerolls),fm.settings=JSON.parse(fm.storage.settings),fm.tickets=JSON.parse(fm.storage.tickets),fm.trades=JSON.parse(fm.storage.trades),fm.users=JSON.parse(fm.storage.users),fm.winners=JSON.parse(fm.storage.winners),"loading"===document.readyState?document.addEventListener("DOMContentLoaded",(function e(){t(),document.removeEventListener("DOMContentLoaded",e)})):t())}().catch(e=>console.log(e))})(),(async()=>{document.head||await new Promise(e=>{const t=()=>{document.head?e():requestAnimationFrame(t)};t()});const e=document.createElement("link");e.rel="stylesheet",e.href=await GM.getResourceUrl("awesome-bootstrap-checkbox");const t=document.createElement("link");t.rel="stylesheet",t.href=await GM.getResourceUrl("jquery-query-builder"),document.head.appendChild(e),document.head.appendChild(t)})()}]);